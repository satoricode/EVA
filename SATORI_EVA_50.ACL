@ACL1100













































^LAYOUT   zHIST1_AP001_Dup_Amt_Dt_Inv_Vnd    1096 D.T,
!"VMF_Vnd_Master_File" "IDX_VndrSiteID" AT (32,283,134,300,10,10,134,157) Vndr_Site_ID
Flag           ASCII       1   1    
DUP_KEY        ASCII       2  72    
CREDIT_KEY     ASCII      74  40    
Vndr_Site_ID   ASCII     114  20    
Vndr_ID        ASCII     134  20    
Vchr_ID        ASCII     154  10    
ABS_INVAMT     ACL       164  12 0  
isPaid         ASCII     176   1    
Doc_Typ        ASCII     177  10    
Inv_Dt         DATETIME  187   8   PICTURE "YYYYMMDD"  
Inv_No         ASCII     195  50    
Inv_Amt        ACL       245  12 2  
Inv_Amt_Doc    ACL       257  12 2  
Curncy         ASCII     269  15    
Inv_Net_Amt    ACL       284  12 2  
GST_Amt        ACL       296  12 2  
Btch_No        ASCII     308  15    
Due_Dt         DATETIME  323   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     331  21    
PO_Net_Amt     ACL       352  12 2  
Descrp         ASCII     364  31    
Pd_Dt          DATETIME  395   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     403  21    
Modf_By        ASCII     424  15    
Modf_Dt        DATETIME  439   8   PICTURE "YYYYMMDD"  
Pst_Dt         DATETIME  447   8   PICTURE "YYYYMMDD"  
Ex_Rate        ACL       455  12 2  
VOIDED         ASCII     467   1    
Void_Dt        DATETIME  468   8   PICTURE "YYYYMMDD"  
Num_Field1     ACL       476  12 2  
Num_Field2     ACL       488  12 2  
Num_Field3     ACL       500  12 2  
Num_Field4     ACL       512  12 2  
Num_Field5     ACL       524  12 2  
Dt_Field1      DATETIME  536   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  544   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  552   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     560  20    
Cha_Field2     ASCII     580  20    
Cha_Field3     ASCII     600  20    
Cha_Field4     ASCII     620  20    
Cha_Field5     ASCII     640  20    
c_Inv_No       ASCII     660  20    Srt Inv_No
c_Inv_Dt       ASCII     680   8    
Vndr_Mstr_ID   ASCII     688  20    
Vndr_Nme       ASCII     708  73    
Vndr_Sts       ASCII     781   1    
Vndr_Typ       ASCII     782  11    
ABS_INVAMT_CENT ACL       793  12 4  
RANK           ASCII     805   1    
ID_KEY         ASCII     806  85    
SORT_KEY       ASCII     891  80    
SORT_KEY_Desc  ASCII     971  46    
Priority       ASCII    1017   1    
RptRunDate     DATETIME 1018   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Data_Range_Start_Date DATETIME 1026   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME 1034   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
TEST_NAME      ASCII    1042  55    
c_QUOTED_INV_ID COMPUTED             
 *C 52 1 
 "'"+ ALLTRIM(Inv_No) + "'"
c_SORT_KEY     COMPUTED             
 *C 64 1 
 SUBSTR(ZONED(ABS_INVAMT_CENT ,21) +"~"+ ALLTRIM(Flag) +"~"+ ALLTRIM(Vndr_ID) +"~"+ ALLTRIM(c_Inv_Dt),1,64)
^LAYOUT   zHIST1_AP002_Dup_Amt_Inv_Vndr      1091 D.T,
!"VMF_Vnd_Master_File" "IDX_VndrSiteID" AT (22,8,134,303,77,269,134,157) Vndr_Site_ID
Flag           ASCII       1   1    
DUP_KEY        ASCII       2  72    
CREDIT_KEY     ASCII      74  40    
Vndr_Site_ID   ASCII     114  20    
Vndr_ID        ASCII     134  20    
Vchr_ID        ASCII     154  10    
ABS_INVAMT     ACL       164  12 0  
isPaid         ASCII     176   1    
Doc_Typ        ASCII     177  10    
Inv_Dt         DATETIME  187   8   PICTURE "YYYYMMDD"  
Inv_No         ASCII     195  50    
Inv_Amt        ACL       245  12 2  
Inv_Amt_Doc    ACL       257  12 2  
Curncy         ASCII     269  15    
Inv_Net_Amt    ACL       284  12 2  
GST_Amt        ACL       296  12 2  
Btch_No        ASCII     308  15    
Due_Dt         DATETIME  323   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     331  21    
PO_Net_Amt     ACL       352  12 2  
Descrp         ASCII     364  31    
Pd_Dt          DATETIME  395   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     403  21    
Modf_By        ASCII     424  15    
Modf_Dt        DATETIME  439   8   PICTURE "YYYYMMDD"  
Pst_Dt         DATETIME  447   8   PICTURE "YYYYMMDD"  
Ex_Rate        ACL       455  12 2  
VOIDED         ASCII     467   1    
Void_Dt        DATETIME  468   8   PICTURE "YYYYMMDD"  
Num_Field1     ACL       476  12 2  
Num_Field2     ACL       488  12 2  
Num_Field3     ACL       500  12 2  
Num_Field4     ACL       512  12 2  
Num_Field5     ACL       524  12 2  
Dt_Field1      DATETIME  536   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  544   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  552   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     560  20    
Cha_Field2     ASCII     580  20    
Cha_Field3     ASCII     600  20    
Cha_Field4     ASCII     620  20    
Cha_Field5     ASCII     640  20    
c_Inv_No       ASCII     660  20    Srt Inv_No
c_Inv_Dt       ASCII     680   8    
Vndr_Mstr_ID   ASCII     688  20    
Vndr_Nme       ASCII     708  73    
Vndr_Sts       ASCII     781   1    
Vndr_Typ       ASCII     782  11    
RANK           ASCII     793   1    
SORT_KEY       ASCII     794  80    
SORT_KEY_Desc  ASCII     874  46    
Priority       ASCII     920   1    
RptRunDate     DATETIME  921   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Data_Range_Start_Date DATETIME  929   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME  937   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
ID_KEY         ASCII     945  85    
TEST_NAME      ASCII    1030  62    
c_QUOTED_INV_ID COMPUTED             
 *C 52 1 
 "'"+ ALLTRIM(Inv_No) + "'"
c_SORT_KEY     COMPUTED             
 *C 80 1 
 SUBSTR(ZONED(ABS_INVAMT ,21) +"~"+ ALLTRIM(Flag) +"~"+ ALLTRIM(Vndr_ID) +"~"+ ALLTRIM(c_Inv_Dt),1,80)
^LAYOUT   zHIST1_AP003_Dup_Amt_Dt_Inv        1091 D.T,
!"VMF_Vnd_Master_File" "IDX_VndrSiteID" AT (18,8,134,284,77,269,134,157) Vndr_Site_ID
Flag           ASCII       1   1    
DUP_KEY        ASCII       2  72    
CREDIT_KEY     ASCII      74  40    
Vndr_Site_ID   ASCII     114  20    
Vndr_ID        ASCII     134  20    
Vchr_ID        ASCII     154  10    
ABS_INVAMT     ACL       164  12 0  
isPaid         ASCII     176   1    
Doc_Typ        ASCII     177  10    
Inv_Dt         DATETIME  187   8   PICTURE "YYYYMMDD"  
Inv_No         ASCII     195  50    
Inv_Amt        ACL       245  12 2  
Inv_Amt_Doc    ACL       257  12 2  
Curncy         ASCII     269  15    
Inv_Net_Amt    ACL       284  12 2  
GST_Amt        ACL       296  12 2  
Btch_No        ASCII     308  15    
Due_Dt         DATETIME  323   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     331  21    
PO_Net_Amt     ACL       352  12 2  
Descrp         ASCII     364  31    
Pd_Dt          DATETIME  395   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     403  21    
Modf_By        ASCII     424  15    
Modf_Dt        DATETIME  439   8   PICTURE "YYYYMMDD"  
Pst_Dt         DATETIME  447   8   PICTURE "YYYYMMDD"  
Ex_Rate        ACL       455  12 2  
VOIDED         ASCII     467   1    
Void_Dt        DATETIME  468   8   PICTURE "YYYYMMDD"  
Num_Field1     ACL       476  12 2  
Num_Field2     ACL       488  12 2  
Num_Field3     ACL       500  12 2  
Num_Field4     ACL       512  12 2  
Num_Field5     ACL       524  12 2  
Dt_Field1      DATETIME  536   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  544   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  552   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     560  20    
Cha_Field2     ASCII     580  20    
Cha_Field3     ASCII     600  20    
Cha_Field4     ASCII     620  20    
Cha_Field5     ASCII     640  20    
c_Inv_No       ASCII     660  20    Srt Inv_No
c_Inv_Dt       ASCII     680   8    
Vndr_Mstr_ID   ASCII     688  20    
Vndr_Nme       ASCII     708  73    
Vndr_Sts       ASCII     781   1    
Vndr_Typ       ASCII     782  11    
RANK           ASCII     793   1    
SORT_KEY       ASCII     794  80    
SORT_KEY_Desc  ASCII     874  46    
Priority       ASCII     920   1    
RptRunDate     DATETIME  921   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Data_Range_Start_Date DATETIME  929   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME  937   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
ID_KEY         ASCII     945  85    
TEST_NAME      ASCII    1030  62    
c_QUOTED_INV_ID COMPUTED             
 *C 52 1 
 "'"+ ALLTRIM(Inv_No) + "'"
c_SORT_KEY     COMPUTED             
 *C 80 1 
 SUBSTR(ZONED(ABS_INVAMT ,21) +"~"+ ALLTRIM(Flag) +"~"+ ALLTRIM(Vndr_ID) +"~"+ ALLTRIM(c_Inv_Dt),1,80)
^LAYOUT   zHIST1_AP004_Dup_Amt_Dt_Vndr       1100 D.T,
!"VMF_Vnd_Master_File" "IDX_VndrSiteID" AT (18,8,134,316,77,269,134,157) Vndr_Site_ID
Flag           ASCII       1   1    
DUP_KEY        ASCII       2  72    
CREDIT_KEY     ASCII      74  40    
Vndr_Site_ID   ASCII     114  20    
Vndr_ID        ASCII     134  20    
Vchr_ID        ASCII     154  10    
ABS_INVAMT     ACL       164  12 0  
isPaid         ASCII     176   1    
Doc_Typ        ASCII     177  10    
Inv_Dt         DATETIME  187   8   PICTURE "YYYYMMDD"  
Inv_No         ASCII     195  50    
Inv_Amt        ACL       245  12 2  
Inv_Amt_Doc    ACL       257  12 2  
Curncy         ASCII     269  15    
Inv_Net_Amt    ACL       284  12 2  
GST_Amt        ACL       296  12 2  
Btch_No        ASCII     308  15    
Due_Dt         DATETIME  323   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     331  21    
PO_Net_Amt     ACL       352  12 2  
Descrp         ASCII     364  31    
Pd_Dt          DATETIME  395   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     403  21    
Modf_By        ASCII     424  15    
Modf_Dt        DATETIME  439   8   PICTURE "YYYYMMDD"  
Pst_Dt         DATETIME  447   8   PICTURE "YYYYMMDD"  
Ex_Rate        ACL       455  12 2  
VOIDED         ASCII     467   1    
Void_Dt        DATETIME  468   8   PICTURE "YYYYMMDD"  
Num_Field1     ACL       476  12 2  
Num_Field2     ACL       488  12 2  
Num_Field3     ACL       500  12 2  
Num_Field4     ACL       512  12 2  
Num_Field5     ACL       524  12 2  
Dt_Field1      DATETIME  536   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  544   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  552   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     560  20    
Cha_Field2     ASCII     580  20    
Cha_Field3     ASCII     600  20    
Cha_Field4     ASCII     620  20    
Cha_Field5     ASCII     640  20    
c_Inv_No       ASCII     660  20    Srt Inv_No
c_Inv_Dt       ASCII     680   8    
Vndr_Mstr_ID   ASCII     688  20    
Vndr_Nme       ASCII     708  73    
Vndr_Sts       ASCII     781   1    
Vndr_Typ       ASCII     782  11    
RANK           ASCII     793   1    
SORT_KEY_Desc  ASCII     874  46    
RptRunDate     DATETIME  921   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Data_Range_Start_Date DATETIME  929   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME  937   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
ID_KEY         ASCII     945  85    
TEST_NAME      ASCII    1030  71    
ABS_INVAMT_CENT COMPUTED             
 *N 4 2
 VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21)),4) IF OCCURS(ALLTRIM(STRING(ABS(Inv_Amt),21)),".")>=0
 VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21 )),4)
SORT_KEY       COMPUTED             
 *C 64 1 
 SUBSTR(ZONED(ABS_INVAMT_CENT,21) +"~"+ ALLTRIM(Flag) +"~"+ ALLTRIM(Vndr_ID) +"~"+ ALLTRIM(c_Inv_Dt),1,64)
Priority       COMPUTED             
 *C 1 1 
 "M"
c_QUOTED_INV_ID COMPUTED             
 *C 52 1 
 "'"+ ALLTRIM(Inv_No) + "'"
c_SORT_KEY     COMPUTED             
 *C 80 1 
 SUBSTR(ZONED(ABS_INVAMT ,21) +"~"+ ALLTRIM(Flag) +"~"+ ALLTRIM(Vndr_ID) +"~"+ ALLTRIM(c_Inv_Dt),1,80)
^LAYOUT   HIST1_VM002_Dup_Vnd_ABN            1290 D.T,
!"AP_Vnd_InvGst_Sum" "IDX_AP_Sum_VndrID" Vndr_ID
ABN_CLN        ASCII       1  20    
Vndr_Site_ID   ASCII      21  20    
Co             ASCII      41  20    
Vndr_ID        ASCII      61  20    
Vndr_Nme       ASCII      81  73    
ABN            ASCII     154  20    
Vndr_Sts       ASCII     174   1    
Vndr_Typ       ASCII     175  11    
Vndr_Add_Typ   ASCII     186  15    
ADD1           ASCII     201 125    
ADD2           ASCII     326  61    
ADD3           ASCII     387  61    
City           ASCII     448  35    
State          ASCII     483  29    
Pcode          ASCII     512  12    
Cntry          ASCII     524  61    
TEL1           ASCII     585  21    
TEL2           ASCII     606  21    
TEL3           ASCII     627  21    
FAX            ASCII     648  21    
Email1         ASCII     669  60    
Email2         ASCII     729  60    
Pymnt_Trm      ASCII     789  21    
Created_Dt     DATETIME  810   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  818   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  826   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     834  30    
Cha_Field2     ASCII     864  30    
Cha_Field3     ASCII     894   3    
Cha_Field4     ASCII     897  20    
Cha_Field5     ASCII     917  20    
Num_Field1     ACL       937  12 2  
Num_Field2     ACL       949  12 2  
Num_Field3     ACL       961  12 2  
Num_Field4     ACL       973  12 2  
Num_Field5     ACL       985  12 2  
Dt_Field1      DATETIME  997   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME 1005   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME 1013   8   PICTURE "YYYYMMDD"  
Max_Inv_Dt     DATETIME 1021   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1029  20    
DUP_KEY        ASCII    1049  20    
ID_KEY         ASCII    1069  85    
Vndr_Same_Diff ASCII    1154   1    
SORT_KEY       ASCII    1155  40    
SORT_KEY_Desc  ASCII    1195  33    
RptRunDate     DATETIME 1228   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Priority       ASCII    1236   1    
TEST_NAME      ASCII    1237  54    
^LAYOUT   HIST1_VM003_Dup_Vnd_Add            1838 D.T,
!"AP_Vnd_InvGst_Sum" "IDX_AP_Sum_VndrID" Vndr_ID
Vndr_Site_ID   ASCII       1  20    
Co             ASCII      21  20    
Vndr_ID        ASCII      41  20    
Vndr_Nme       ASCII      61  73    
ABN            ASCII     134  20    
Vndr_Sts       ASCII     154   1    
Vndr_Typ       ASCII     155  11    
Vndr_Add_Typ   ASCII     166  15    
ADD1           ASCII     181 125    
ADD2           ASCII     306  61    
ADD3           ASCII     367  61    
City           ASCII     428  35    
State          ASCII     463  29    
Pcode          ASCII     492  12    
Cntry          ASCII     504  61    
TEL1           ASCII     565  21    
TEL2           ASCII     586  21    
TEL3           ASCII     607  21    
FAX            ASCII     628  21    
Email1         ASCII     649  60    
Email2         ASCII     709  60    
Pymnt_Trm      ASCII     769  21    
Created_Dt     DATETIME  790   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  798   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  806   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     814  30    
Cha_Field2     ASCII     844  30    
Cha_Field3     ASCII     874   3    
Cha_Field4     ASCII     877  20    
Cha_Field5     ASCII     897  20    
Num_Field1     ACL       917  12 2  
Num_Field2     ACL       929  12 2  
Num_Field3     ACL       941  12 2  
Num_Field4     ACL       953  12 2  
Num_Field5     ACL       965  12 2  
Dt_Field1      DATETIME  977   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  985   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  993   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1001  20    
Max_Inv_Dt     DATETIME 1021   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1029  20    
DUP_KEY        ASCII    1049  62    
Add_KEY        ASCII    1111  82    
Dup_Vndr_Add_Typ ASCII    1193  15    
Dup_ADD1       ASCII    1208 125    
Dup_ADD2       ASCII    1333  61    
Dup_ADD3       ASCII    1394  61    
Dup_City       ASCII    1455  35    
Dup_State      ASCII    1490  29    
Dup_Pcode      ASCII    1519  12    
Dup_Cntry      ASCII    1531  61    
ID_KEY         ASCII    1592  85    
Vndr_Same_Diff ASCII    1677   1    
SORT_KEY       ASCII    1678  60    
SORT_KEY_Desc  ASCII    1738  48    
RptRunDate     DATETIME 1786   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
TEST_NAME      ASCII    1794  44    
Priority       ASCII    1838   1    
^LAYOUT   HIST1_VM005_Dup_Vnd_Name           1442 D.T,
!"AP_Vnd_InvGst_Sum" "IDX_AP_Sum_VndrID" Vndr_ID
c_Name         ASCII       1  76    
Vndr_Site_ID   ASCII      77  20    
Co             ASCII      97  20    
Vndr_ID        ASCII     117  20    
Vndr_Nme       ASCII     137  73    
ABN            ASCII     210  20    
Vndr_Sts       ASCII     230   1    
Vndr_Typ       ASCII     231  11    
Vndr_Add_Typ   ASCII     242  15    
ADD1           ASCII     257 125    
ADD2           ASCII     382  61    
ADD3           ASCII     443  61    
City           ASCII     504  35    
State          ASCII     539  29    
Pcode          ASCII     568  12    
Cntry          ASCII     580  61    
TEL1           ASCII     641  21    
TEL2           ASCII     662  21    
TEL3           ASCII     683  21    
FAX            ASCII     704  21    
Email1         ASCII     725  60    
Email2         ASCII     785  60    
Pymnt_Trm      ASCII     845  21    
Created_Dt     DATETIME  866   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  874   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  882   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     890  30    
Cha_Field2     ASCII     920  30    
Cha_Field3     ASCII     950   3    
Cha_Field4     ASCII     953  20    
Cha_Field5     ASCII     973  20    
Num_Field1     ACL       993  12 2  
Num_Field2     ACL      1005  12 2  
Num_Field3     ACL      1017  12 2  
Num_Field4     ACL      1029  12 2  
Num_Field5     ACL      1041  12 2  
Dt_Field1      DATETIME 1053   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME 1061   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME 1069   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1077  20    
Max_Inv_Dt     DATETIME 1097   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1105  20    
DUP_KEY        ASCII    1125  76    
ID_KEY         ASCII    1201  85    
Vndr_Same_Diff ASCII    1286   1    
SORT_KEY       ASCII    1287  60    
SORT_KEY_Desc  ASCII    1347  39    
RptRunDate     DATETIME 1386   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
TEST_NAME      ASCII    1394  48    
Priority       ASCII    1442   1    
^LAYOUT   HIST1_VM006_Mis_Details            1743 D.T,
!"VMF_BnkAcc" "IDX_BK_VndrSiteID1" SUBST(ALLTRIM(Vndr_Site_ID),1,20)
!"AP_Vnd_InvGst_Sum" "IDX_AP_Sum_VndrID" Vndr_ID
Vndr_Site_ID   ASCII       1  20    
Vndr_ID        ASCII      21  20    
TstCd          ACL        41  12 0  
COUNT2         ACL        53  12 0 WIDTH 8  
Co             ASCII      65  20    
Vndr_Nme       ASCII      85  73    
ABN            ASCII     158  20    
Vndr_Sts       ASCII     178   1    
Vndr_Typ       ASCII     179  11    
Vndr_Add_Typ   ASCII     190  15    
ADD1           ASCII     205 125    
ADD2           ASCII     330  61    
ADD3           ASCII     391  61    
City           ASCII     452  35    
State          ASCII     487  29    
Pcode          ASCII     516  12    
Cntry          ASCII     528  61    
TEL1           ASCII     589  21    
TEL2           ASCII     610  21    
TEL3           ASCII     631  21    
FAX            ASCII     652  21    
Email1         ASCII     673  60    
Email2         ASCII     733  60    
Pymnt_Trm      ASCII     793  21    
Created_Dt     DATETIME  814   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  822   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  830   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     838  30    
Cha_Field2     ASCII     868  30    
Cha_Field3     ASCII     898   3    
Cha_Field4     ASCII     901  20    
Cha_Field5     ASCII     921  20    
Num_Field1     ACL       941  12 2  
Num_Field2     ACL       953  12 2  
Num_Field3     ACL       965  12 2  
Num_Field4     ACL       977  12 2  
Num_Field5     ACL       989  12 2  
Dt_Field1      DATETIME 1001   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME 1009   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME 1017   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1025  20    
Max_Inv_Dt     DATETIME 1045   8   PICTURE "YYYYMMDD"  
c_Vndr_ID      ASCII    1053  20    
Inv_Amt        ACL      1073  12 2  
GST_Amt        ACL      1085  12 2  
COUNT          ACL      1097  12 0 WIDTH 8  
c_TstCd        ASCII    1109   4    
NEW_TstCd_1    ASCII    1113  15    NEW_TstCd_1
NEW_TstCd_2    ASCII    1128   6    NEW_TstCd_2
NEW_TstCd_3    ASCII    1134  10    NEW_TstCd_3
NEW_TstCd_4    ASCII    1144   6    NEW_TstCd_4
NEW_TstCd1     ASCII    1150 100    
NEW_TstCd2     ASCII    1250 100    
NEW_TstCd      ASCII    1350 100    NEW_TstCd
TEST_NAME      ASCII    1450 120    
SORT_KEY       ASCII    1570  39    
SORT_KEY_Desc  ASCII    1609  29    
RptRunDate     DATETIME 1638   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Priority       ASCII    1646   1    
ID_KEY         ASCII    1647  85    
c_VALID        ACL      1732  12 0  
^LAYOUT   HIST1_VM006D_Mis_Details           936 D.T,
!"HIST1_VM006_Mis_Details" "IDX_HVM006_VndrSiteID" Vndr_Site_ID
Vchr_ID        ASCII       1  10    
Vndr_Site_ID   ASCII      11  20    
Vndr_ID        ASCII      31  20    
Doc_Typ        ASCII      51  10    
Inv_Dt         DATETIME   61   8   PICTURE "YYYYMMDD" WIDTH 27  
Inv_No         ASCII      69  50    
Inv_Amt        ACL       119  12 2  
Inv_Amt_Doc    ACL       131  12 2  
Curncy         ASCII     143  15    
Ex_Rate        ACL       158  12 2  
Inv_Net_Amt    ACL       170  12 2  
GST_Amt        ACL       182  12 2  
Btch_No        ASCII     194  15    
Due_Dt         DATETIME  209   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     217  21    
PO_Net_Amt     ACL       238  12 2  
Descrp         ASCII     250  31    
Pd_Dt          DATETIME  281   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     289  21    
Modf_Dt        DATETIME  310   8   PICTURE "YYYYMMDD"  
Modf_By        ASCII     318  15    
Pst_Dt         DATETIME  333   8   PICTURE "YYYYMMDD"  
VOIDED         ASCII     341   1    
Void_Dt        DATETIME  342   8   PICTURE "YYYYMMDD"  
isPaid         ASCII     350   1    
Num_Field1     ACL       351  12 2  
Num_Field2     ACL       363  12 2  
Num_Field3     ACL       375  12 2  
Num_Field4     ACL       387  12 2  
Num_Field5     ACL       399  12 2  
Dt_Field1      DATETIME  411   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  419   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  427   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     435  20    
Cha_Field2     ASCII     455  20    
Cha_Field3     ASCII     475  20    
Cha_Field4     ASCII     495  20    
Cha_Field5     ASCII     515  20    
c_Inv_No2      ASCII     535  50    
c_Inv_No       ASCII     585  20    Srt Inv_No
ABS_INVAMT     ACL       605  12 0  
ABS_INVAMT_CENT ACL       617  12 4  
c_Inv_Dt       ASCII     629   8    
Vndr_Mstr_ID   ASCII     637  20    
Vndr_Nme       ASCII     657  73    
Vndr_Sts       ASCII     730   1    
Vndr_Typ       ASCII     731  11    
c_TstCd        ASCII     742   4    
TEST_NAME      ASCII     746 120    
SORT_KEY       ASCII     866  30    
SORT_KEY_Desc  ASCII     896  16    
RptRunDate     DATETIME  912   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Data_Range_Start_Date DATETIME  920   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME  928   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
Priority       ASCII     936   1    
^LAYOUT   HIST1_VM007D_Invld_Frmt_ABN        883 D.T,
Vchr_ID        ASCII       1  10    
Vndr_Site_ID   ASCII      11  20    
Vndr_ID        ASCII      31  20    
Doc_Typ        ASCII      51  10    
Inv_Dt         DATETIME   61   8   PICTURE "YYYYMMDD" WIDTH 27  
Inv_No         ASCII      69  50    
Inv_Amt        ACL       119  12 2  
Inv_Amt_Doc    ACL       131  12 2  
Curncy         ASCII     143  15    
Ex_Rate        ACL       158  12 2  
Inv_Net_Amt    ACL       170  12 2  
GST_Amt        ACL       182  12 2  
Btch_No        ASCII     194  15    
Due_Dt         DATETIME  209   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     217  21    
PO_Net_Amt     ACL       238  12 2  
Descrp         ASCII     250  31    
Pd_Dt          DATETIME  281   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     289  21    
Modf_Dt        DATETIME  310   8   PICTURE "YYYYMMDD"  
Modf_By        ASCII     318  15    
Pst_Dt         DATETIME  333   8   PICTURE "YYYYMMDD"  
VOIDED         ASCII     341   1    
Void_Dt        DATETIME  342   8   PICTURE "YYYYMMDD"  
isPaid         ASCII     350   1    
Num_Field1     ACL       351  12 2  
Num_Field2     ACL       363  12 2  
Num_Field3     ACL       375  12 2  
Num_Field4     ACL       387  12 2  
Num_Field5     ACL       399  12 2  
Dt_Field1      DATETIME  411   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  419   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  427   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     435  20    
Cha_Field2     ASCII     455  20    
Cha_Field3     ASCII     475  20    
Cha_Field4     ASCII     495  20    
Cha_Field5     ASCII     515  20    
c_Inv_No2      ASCII     535  50    
c_Inv_No       ASCII     585  20    Srt Inv_No
ABS_INVAMT     ACL       605  12 0  
ABS_INVAMT_CENT ACL       617  12 4  
c_Inv_Dt       ASCII     629   8    
Vndr_Mstr_ID   ASCII     637  20    
Vndr_Nme       ASCII     657  73    
Vndr_Sts       ASCII     730   1    
Vndr_Typ       ASCII     731  11    
SORT_KEY       ASCII     742  30    
SORT_KEY_Desc  ASCII     772  16    
RptRunDate     DATETIME  788   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Data_Range_Start_Date DATETIME  796   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME  804   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
Priority       ASCII     812   1    
TEST_NAME      ASCII     813  71    
^LAYOUT   HIST1_VM008_Can_ABN                1362 D.T,
!"HIST1_VM008Z_Can_ABN_Sum" "IDX_HVM008Z_VndrSiteID" Vndr_Site_ID
Vndr_Site_ID   ASCII       1  20    
Co             ASCII      21  20    
Vndr_ID        ASCII      41  20    
Vndr_Nme       ASCII      61  73    
ABN            ASCII     134  20    
Vndr_Sts       ASCII     154   1    
Vndr_Typ       ASCII     155  11    
Vndr_Add_Typ   ASCII     166  15    
ADD1           ASCII     181 125    
ADD2           ASCII     306  61    
ADD3           ASCII     367  61    
City           ASCII     428  35    
State          ASCII     463  29    
Pcode          ASCII     492  12    
Cntry          ASCII     504  61    
TEL1           ASCII     565  21    
TEL2           ASCII     586  21    
TEL3           ASCII     607  21    
FAX            ASCII     628  21    
Email1         ASCII     649  60    
Email2         ASCII     709  60    
Pymnt_Trm      ASCII     769  21    
Created_Dt     DATETIME  790   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  798   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  806   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     814  30    
Cha_Field2     ASCII     844  30    
Cha_Field3     ASCII     874   3    
Cha_Field4     ASCII     877  20    
Cha_Field5     ASCII     897  20    
Num_Field1     ACL       917  12 2  
Num_Field2     ACL       929  12 2  
Num_Field3     ACL       941  12 2  
Num_Field4     ACL       953  12 2  
Num_Field5     ACL       965  12 2  
Dt_Field1      DATETIME  977   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  985   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  993   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1001  20    
Max_Inv_Dt     DATETIME 1021   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1029  20    
ASIC_entityStatusCode ASCII    1049  21    
ASIC_entityStatusEF DATETIME 1070   8   PICTURE "YYYYMMDD"  
ASIC_GST_effFrom DATETIME 1078   8   PICTURE "YYYYMMDD"  
ASIC_GST_effTo DATETIME 1086   8   PICTURE "YYYYMMDD"  
ASIC_entityDescription ASCII    1094  50    
Inv_Amt        ACL      1144  12 2  
GST_Amt        ACL      1156  12 2  
COUNT          ACL      1168  12 0 WIDTH 8  
ID_KEY         ASCII    1180  85    
SORT_KEY       ASCII    1265  15    
SORT_KEY_Desc  ASCII    1280  32    
RptRunDate     DATETIME 1312   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Priority       ASCII    1320   1    
TEST_NAME      ASCII    1321  42    
^LAYOUT   HIST1_VM008D_Can_ABN               894 D.T,
Vchr_ID        ASCII       1  10    
Vndr_Site_ID   ASCII      11  20    
Vndr_ID        ASCII      31  20    
Doc_Typ        ASCII      51  10    
Inv_Dt         DATETIME   61   8   PICTURE "YYYYMMDD" WIDTH 27  
Inv_No         ASCII      69  50    
Inv_Amt        ACL       119  12 2  
Inv_Amt_Doc    ACL       131  12 2  
Curncy         ASCII     143  15    
Ex_Rate        ACL       158  12 2  
Inv_Net_Amt    ACL       170  12 2  
GST_Amt        ACL       182  12 2  
Btch_No        ASCII     194  15    
Due_Dt         DATETIME  209   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     217  21    
PO_Net_Amt     ACL       238  12 2  
Descrp         ASCII     250  31    
Pd_Dt          DATETIME  281   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     289  21    
Modf_Dt        DATETIME  310   8   PICTURE "YYYYMMDD"  
Modf_By        ASCII     318  15    
Pst_Dt         DATETIME  333   8   PICTURE "YYYYMMDD"  
VOIDED         ASCII     341   1    
Void_Dt        DATETIME  342   8   PICTURE "YYYYMMDD"  
isPaid         ASCII     350   1    
Num_Field1     ACL       351  12 2  
Num_Field2     ACL       363  12 2  
Num_Field3     ACL       375  12 2  
Num_Field4     ACL       387  12 2  
Num_Field5     ACL       399  12 2  
Dt_Field1      DATETIME  411   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  419   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  427   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     435  20    
Cha_Field2     ASCII     455  20    
Cha_Field3     ASCII     475  20    
Cha_Field4     ASCII     495  20    
Cha_Field5     ASCII     515  20    
c_Inv_No2      ASCII     535  50    
c_Inv_No       ASCII     585  20    Srt Inv_No
ABS_INVAMT     ACL       605  12 0  
ABS_INVAMT_CENT ACL       617  12 4  
c_Inv_Dt       ASCII     629   8    
Vndr_Mstr_ID   ASCII     637  20    
Vndr_Nme       ASCII     657  73    
Vndr_Sts       ASCII     730   1    
Vndr_Typ       ASCII     731  11    
SORT_KEY       ASCII     742  29    
SORT_KEY_Desc  ASCII     771  20    
Priority       ASCII     791   1    
RptRunDate     DATETIME  792   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Data_Range_Start_Date DATETIME  800   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME  808   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
TEST_NAME      ASCII     816  71    
ASIC_entityStatusEF DATETIME  887   8   PICTURE "YYYYMMDD"  
^LAYOUT   HIST1_VM008Z_Can_ABN_Sum           76 D.T,
Vndr_Site_ID   ASCII       1  20    
Vndr_ID        ASCII      21  20    
GST_Amt        ACL        41  12 2  
Inv_Amt        ACL        53  12 2  
COUNT          ACL        65  12 0 WIDTH 8  
^LAYOUT   HIST1_VM009_Invld_ABN_ABR          1375 D.T,
Vndr_Site_ID   ASCII       1  20    
Co             ASCII      21  20    
Vndr_ID        ASCII      41  20    
Vndr_Nme       ASCII      61  73    
ABN            ASCII     134  20    
Vndr_Sts       ASCII     154   1    
Vndr_Typ       ASCII     155  11    
Vndr_Add_Typ   ASCII     166  15    
ADD1           ASCII     181 125    
ADD2           ASCII     306  61    
ADD3           ASCII     367  61    
City           ASCII     428  35    
State          ASCII     463  29    
Pcode          ASCII     492  12    
Cntry          ASCII     504  61    
TEL1           ASCII     565  21    
TEL2           ASCII     586  21    
TEL3           ASCII     607  21    
FAX            ASCII     628  21    
Email1         ASCII     649  60    
Email2         ASCII     709  60    
Pymnt_Trm      ASCII     769  21    
Created_Dt     DATETIME  790   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  798   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  806   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     814  30    
Cha_Field2     ASCII     844  30    
Cha_Field3     ASCII     874   3    
Cha_Field4     ASCII     877  20    
Cha_Field5     ASCII     897  20    
Num_Field1     ACL       917  12 2  
Num_Field2     ACL       929  12 2  
Num_Field3     ACL       941  12 2  
Num_Field4     ACL       953  12 2  
Num_Field5     ACL       965  12 2  
Dt_Field1      DATETIME  977   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  985   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  993   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1001  20    
Max_Inv_Dt     DATETIME 1021   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1029  20    
ASIC_entityStatusCode ASCII    1049  21    
ASIC_entityStatusEF DATETIME 1070   8   PICTURE "YYYYMMDD"  
ASIC_GST_effFrom DATETIME 1078   8   PICTURE "YYYYMMDD"  
ASIC_GST_effTo DATETIME 1086   8   PICTURE "YYYYMMDD"  
ASIC_entityDescription ASCII    1094  50    
Inv_Amt        ACL      1144  12 2  
GST_Amt        ACL      1156  12 2  
COUNT          ACL      1168  12 0 WIDTH 8  
ID_KEY         ASCII    1180  85    
SORT_KEY       ASCII    1265  25    
SORT_KEY_Desc  ASCII    1290  20    
RptRunDate     DATETIME 1310   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Priority       ASCII    1318   1    
TEST_NAME      ASCII    1319  57    
^LAYOUT   HIST1_VM009D_Invld_ABN_ABR         897 D.T,
Vchr_ID        ASCII       1  10    
Vndr_Site_ID   ASCII      11  20    
Vndr_ID        ASCII      31  20    
Doc_Typ        ASCII      51  10    
Inv_Dt         DATETIME   61   8   PICTURE "YYYYMMDD" WIDTH 27  
Inv_No         ASCII      69  50    
Inv_Amt        ACL       119  12 2  
Inv_Amt_Doc    ACL       131  12 2  
Curncy         ASCII     143  15    
Ex_Rate        ACL       158  12 2  
Inv_Net_Amt    ACL       170  12 2  
GST_Amt        ACL       182  12 2  
Btch_No        ASCII     194  15    
Due_Dt         DATETIME  209   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     217  21    
PO_Net_Amt     ACL       238  12 2  
Descrp         ASCII     250  31    
Pd_Dt          DATETIME  281   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     289  21    
Modf_Dt        DATETIME  310   8   PICTURE "YYYYMMDD"  
Modf_By        ASCII     318  15    
Pst_Dt         DATETIME  333   8   PICTURE "YYYYMMDD"  
VOIDED         ASCII     341   1    
Void_Dt        DATETIME  342   8   PICTURE "YYYYMMDD"  
isPaid         ASCII     350   1    
Num_Field1     ACL       351  12 2  
Num_Field2     ACL       363  12 2  
Num_Field3     ACL       375  12 2  
Num_Field4     ACL       387  12 2  
Num_Field5     ACL       399  12 2  
Dt_Field1      DATETIME  411   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  419   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  427   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     435  20    
Cha_Field2     ASCII     455  20    
Cha_Field3     ASCII     475  20    
Cha_Field4     ASCII     495  20    
Cha_Field5     ASCII     515  20    
c_Inv_No2      ASCII     535  50    
c_Inv_No       ASCII     585  20    Srt Inv_No
ABS_INVAMT     ACL       605  12 0  
ABS_INVAMT_CENT ACL       617  12 4  
c_Inv_Dt       ASCII     629   8    
Vndr_Mstr_ID   ASCII     637  20    
Vndr_Nme       ASCII     657  73    
Vndr_Sts       ASCII     730   1    
Vndr_Typ       ASCII     731  11    
SORT_KEY       ASCII     742  29    
SORT_KEY_Desc  ASCII     771  20    
Priority       ASCII     791   1    
RptRunDate     DATETIME  792   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Data_Range_Start_Date DATETIME  800   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME  808   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
TEST_NAME      ASCII     816  74    
ASIC_entityStatusEF DATETIME  890   8   PICTURE "YYYYMMDD"  
^LAYOUT   HIST1_VM010D_DeReg_GST             849 D.T,
!"HIST1_VM010_DeReg_GST" "IDX_HVM010_VndrSiteID" Vndr_Site_ID
!"HIST1_VM010D_DeReg_GST_Sum" "IDX_HVM010D_Sum_VndrSiteID" Vndr_Site_ID
ASIC_GST_effTo DATETIME    1   8   PICTURE "YYYYMMDD"  
Vndr_Site_ID   ASCII       9  20    
Vndr_ID        ASCII      29  20    
Vchr_ID        ASCII      49  10    
ABS_INVAMT     ACL        59  12 0  
isPaid         ASCII      71   1    
Doc_Typ        ASCII      72  10    
Inv_Dt         DATETIME   82   8   PICTURE "YYYYMMDD"  
Inv_No         ASCII      90  50    
Inv_Amt        ACL       140  12 2  
Inv_Amt_Doc    ACL       152  12 2  
Curncy         ASCII     164  15    
Inv_Net_Amt    ACL       179  12 2  
GST_Amt        ACL       191  12 2  
Btch_No        ASCII     203  15    
Due_Dt         DATETIME  218   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     226  21    
PO_Net_Amt     ACL       247  12 2  
Descrp         ASCII     259  31    
Pd_Dt          DATETIME  290   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     298  21    
Modf_By        ASCII     319  15    
Modf_Dt        DATETIME  334   8   PICTURE "YYYYMMDD"  
Pst_Dt         DATETIME  342   8   PICTURE "YYYYMMDD"  
Ex_Rate        ACL       350  12 2  
VOIDED         ASCII     362   1    
Void_Dt        DATETIME  363   8   PICTURE "YYYYMMDD"  
Num_Field1     ACL       371  12 2  
Num_Field2     ACL       383  12 2  
Num_Field3     ACL       395  12 2  
Num_Field4     ACL       407  12 2  
Num_Field5     ACL       419  12 2  
Dt_Field1      DATETIME  431   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  439   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  447   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     455  20    
Cha_Field2     ASCII     475  20    
Cha_Field3     ASCII     495  20    
Cha_Field4     ASCII     515  20    
Cha_Field5     ASCII     535  20    
c_Inv_No       ASCII     555  20    Srt Inv_No
c_Inv_Dt       ASCII     575   8    
Vndr_Mstr_ID   ASCII     583  20    
Vndr_Nme       ASCII     603  73    
Vndr_Sts       ASCII     676   1    
Vndr_Typ       ASCII     677  11    
Priority       ASCII     688   1    
TEST_NAME      ASCII     689  91    
RptRunDate     DATETIME  780   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Data_Range_Start_Date DATETIME  788   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME  796   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
SORT_KEY       ASCII     804  30    
SORT_KEY_Desc  ASCII     834  16    
^LAYOUT   HIST1_VM010D_DeReg_GST_Sum         56 D.T,
Vndr_Site_ID   ASCII       1  20    
GST_Amt        ACL        21  12 2  
Inv_Amt        ACL        33  12 2  
COUNT          ACL        45  12 0 WIDTH 8  
^LAYOUT   HIST1_VM001_Dup_Vnd_BankAcc        1568 D.T,
!"AP_Vnd_InvGst_Sum" "IDX_AP_Sum_VndrID" AT (10,179,134,157,10,10,134,690) Vndr_ID
!"AP_VendorMaster_ALL_FMT" "AP_VendorMaster_ALL_FMT_on_VEND" AT (8,318,134,578) Vndr_Site_ID
Vndr_Site_ID   ASCII       1  20    
Co             ASCII      21  20    
Vndr_ID        ASCII      41  20    
Vndr_Nme       ASCII      61  73    
ABN            ASCII     134  20    
Vndr_Sts       ASCII     154   1    
Vndr_Typ       ASCII     155  11    
Vndr_Add_Typ   ASCII     166  15    
ADD1           ASCII     181 125    
ADD2           ASCII     306  61    
ADD3           ASCII     367  61    
City           ASCII     428  35    
State          ASCII     463  29    
Pcode          ASCII     492  12    
Cntry          ASCII     504  61    
TEL1           ASCII     565  21    
TEL2           ASCII     586  21    
TEL3           ASCII     607  21    
FAX            ASCII     628  21    
Email1         ASCII     649  60    
Email2         ASCII     709  60    
Pymnt_Trm      ASCII     769  21    
Created_Dt     DATETIME  790   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  798   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  806   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     814  30    
Cha_Field2     ASCII     844  30    
Cha_Field3     ASCII     874   3    
Cha_Field4     ASCII     877  20    
Cha_Field5     ASCII     897  20    
Num_Field1     ACL       917  12 2  
Num_Field2     ACL       929  12 2  
Num_Field3     ACL       941  12 2  
Num_Field4     ACL       953  12 2  
Num_Field5     ACL       965  12 2  
Dt_Field1      DATETIME  977   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  985   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  993   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1001  20    
Max_Inv_Dt     DATETIME 1021   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1029  20    
DUP_KEY        ASCII    1049  40    
DUP_KEY2       ASCII    1089  40    
Bnk_KEY        ASCII    1129  56    
Vndr_Site_ID2  ASCII    1185  16    
Vndr_ID2       ASCII    1201  11    
BSB            ASCII    1212  12    
Bnk_Acc_Num    ASCII    1224  28    
BSB_NAME       ASCII    1252  12    
Bnk_Acc_Name   ASCII    1264  48    
ID_KEY         ASCII    1312  85    
Vndr_Same_Diff ASCII    1397   1    
SORT_KEY       ASCII    1398  40    
SORT_KEY_Desc  ASCII    1438  41    
RptRunDate     DATETIME 1479   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
TEST_NAME      ASCII    1487  49    
Priority       ASCII    1536   1    
c_VALID        ACL      1557  12 0  c_VALID
cVndrSiteVndrID COMPUTED             
 *C 20 1 
 SUBSTR(ALLTRIM(Vndr_Site_ID),1,20)
^LAYOUT   HIST1_VM010_DeReg_GST              1312 D.T,
!"HIST1_VM010D_DeReg_GST_Sum" "IDX_HVM010D_Sum_VndrSiteID" Vndr_Site_ID
ASIC_entityStatusCode ASCII       1  21    
ASIC_entityStatusEF DATETIME   22   8   PICTURE "YYYYMMDD"  
ASIC_GST_effFrom DATETIME   30   8   PICTURE "YYYYMMDD"  
ASIC_GST_effTo DATETIME   38   8   PICTURE "YYYYMMDD"  
ASIC_entityDescription ASCII      46  50    
Inv_Amt        ACL        96  12 2  
GST_Amt        ACL       108  12 2  
COUNT          ACL       120  12 0 WIDTH 8  
Vndr_Site_ID   ASCII     132  20    
Co             ASCII     152  20    
Vndr_ID        ASCII     172  20    
Vndr_Nme       ASCII     192  73    
ABN            ASCII     265  20    
Vndr_Sts       ASCII     285   1    
Vndr_Typ       ASCII     286  11    
Vndr_Add_Typ   ASCII     297  15    
ADD1           ASCII     312 125    
ADD2           ASCII     437  61    
ADD3           ASCII     498  61    
City           ASCII     559  35    
State          ASCII     594  29    
Pcode          ASCII     623  12    
Cntry          ASCII     635  61    
TEL1           ASCII     696  21    
TEL2           ASCII     717  21    
TEL3           ASCII     738  21    
FAX            ASCII     759  21    
Email1         ASCII     780  60    
Email2         ASCII     840  60    
Pymnt_Trm      ASCII     900  21    
Created_Dt     DATETIME  921   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  929   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  937   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     945  30    
Cha_Field2     ASCII     975  30    
Cha_Field3     ASCII    1005   3    
Cha_Field4     ASCII    1008  20    
Cha_Field5     ASCII    1028  20    
Num_Field1     ACL      1048  12 2  
Num_Field2     ACL      1060  12 2  
Num_Field3     ACL      1072  12 2  
Num_Field4     ACL      1084  12 2  
Num_Field5     ACL      1096  12 2  
Dt_Field1      DATETIME 1108   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME 1116   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME 1124   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1132  20    
Max_Inv_Dt     DATETIME 1152   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1160  20    
Priority       ASCII    1180   1    
TEST_NAME      ASCII    1181  57    
RptRunDate     DATETIME 1238   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
SORT_KEY       ASCII    1246  32    
SORT_KEY_Desc  ASCII    1278  35    
^LAYOUT   GreyList_VM010                     80 D.T,
Vndr_ID        ASCII       1  20    
Vndr_Name      ASCII      21  60    
^LAYOUT   VM010_History                      1229 D.T,
Co             ASCII       1  20    
Vndr_Site_ID   ASCII      21  20    
Vndr_ID        ASCII      41  20    
Vndr_Nme       ASCII      61  73    
ABN            ASCII     134  20    
Vndr_Sts       ASCII     154   1    
Vndr_InvlDt    DATETIME  155   8   PICTURE "YYYYMMDD"  
Vndr_Typ       ASCII     163  11    
Vndr_Add_Typ   ASCII     174  15    
ADD1           ASCII     189 125    
ADD2           ASCII     314  61    
ADD3           ASCII     375  61    
City           ASCII     436  35    
State          ASCII     471  29    
Pcode          ASCII     500  12    
Cntry          ASCII     512  61    
TEL1           ASCII     573  21    
TEL2           ASCII     594  21    
TEL3           ASCII     615  21    
FAX            ASCII     636  21    
Email1         ASCII     657  60    
Email2         ASCII     717  60    
Pymnt_Trm      ASCII     777  21    
Created_Dt     DATETIME  798   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  806   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     814  30    
Cha_Field2     ASCII     844  30    
Cha_Field3     ASCII     874   3    
Cha_Field4     ASCII     877  20    
Cha_Field5     ASCII     897  20    
Num_Field1     ACL       917  12 2  
Num_Field2     ACL       929  12 2  
Num_Field3     ACL       941  12 2  
Num_Field4     ACL       953  12 2  
Num_Field5     ACL       965  12 2  
Dt_Field1      DATETIME  977   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field2      DATETIME  985   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field3      DATETIME  993   8   PICTURE "YYYYMMDD"  
c_Vndr_ID      ASCII    1001  20    
ABN_CLN        ASCII    1021  20    
Max_Inv_Dt     DATETIME 1041   8   PICTURE "YYYYMMDD" WIDTH 27  
InvABN         ASCII    1049   1    
ASIC_entityStatusCode ASCII    1050  21    
ASIC_entityStatusEF DATETIME 1071   8   PICTURE "YYYYMMDD"  
ASIC_GST_effFrom DATETIME 1079   8   PICTURE "YYYYMMDD"  
ASIC_GST_effTo DATETIME 1087   8   PICTURE "YYYYMMDD"  
ASIC_entityDescription ASCII    1095  50    
ID_KEY         ASCII    1145  85    
^LAYOUT   VM010D_DeReg_GST                   849 D.T,
!"VM010_DeReg_GST" "IDX_VM010_VndrSiteID" Vndr_Site_ID
ASIC_GST_effTo DATETIME    1   8   PICTURE "YYYYMMDD"  
Vndr_Site_ID   ASCII       9  20    
Vndr_ID        ASCII      29  20    
Vchr_ID        ASCII      49  10    
ABS_INVAMT     ACL        59  12 0  
isPaid         ASCII      71   1    
Doc_Typ        ASCII      72  10    
Inv_Dt         DATETIME   82   8   PICTURE "YYYYMMDD"  
Inv_No         ASCII      90  50    
Inv_Amt        ACL       140  12 2  
Inv_Amt_Doc    ACL       152  12 2  
Curncy         ASCII     164  15    
Inv_Net_Amt    ACL       179  12 2  
GST_Amt        ACL       191  12 2  
Btch_No        ASCII     203  15    
Due_Dt         DATETIME  218   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     226  21    
PO_Net_Amt     ACL       247  12 2  
Descrp         ASCII     259  31    
Pd_Dt          DATETIME  290   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     298  21    
Modf_By        ASCII     319  15    
Modf_Dt        DATETIME  334   8   PICTURE "YYYYMMDD"  
Pst_Dt         DATETIME  342   8   PICTURE "YYYYMMDD"  
Ex_Rate        ACL       350  12 2  
VOIDED         ASCII     362   1    
Void_Dt        DATETIME  363   8   PICTURE "YYYYMMDD"  
Num_Field1     ACL       371  12 2  
Num_Field2     ACL       383  12 2  
Num_Field3     ACL       395  12 2  
Num_Field4     ACL       407  12 2  
Num_Field5     ACL       419  12 2  
Dt_Field1      DATETIME  431   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  439   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  447   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     455  20    
Cha_Field2     ASCII     475  20    
Cha_Field3     ASCII     495  20    
Cha_Field4     ASCII     515  20    
Cha_Field5     ASCII     535  20    
c_Inv_No       ASCII     555  20    Srt Inv_No
c_Inv_Dt       ASCII     575   8    
Vndr_Mstr_ID   ASCII     583  20    
Vndr_Nme       ASCII     603  73    
Vndr_Sts       ASCII     676   1    
Vndr_Typ       ASCII     677  11    
Priority       ASCII     688   1    
TEST_NAME      ASCII     689  91    
RptRunDate     DATETIME  780   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Data_Range_Start_Date DATETIME  788   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME  796   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
SORT_KEY       ASCII     804  30    
SORT_KEY_Desc  ASCII     834  16    
^LAYOUT   VM010D_DeReg_GST_Sum               56 D.T,
Vndr_Site_ID   ASCII       1  20    
GST_Amt        ACL        21  12 2  
Inv_Amt        ACL        33  12 2  
COUNT          ACL        45  12 0 WIDTH 8  
^LAYOUT   GreyList_AP014                     80 D.T,
Vndr_Site_ID   ASCII       1  20    
Vndr_Name      ASCII      21  60    
^LAYOUT   AP014_History                      1133 D.T,
Vndr_Site_ID   ASCII       1  20    
Co             ASCII      21  20    
Vndr_ID        ASCII      41  20    
Vndr_Nme       ASCII      61  73    
ABN            ASCII     134  20    
Vndr_Sts       ASCII     154   1    
Vndr_Typ       ASCII     155  11    
Vndr_Add_Typ   ASCII     166  15    
ADD1           ASCII     181 125    
ADD2           ASCII     306  61    
ADD3           ASCII     367  61    
City           ASCII     428  35    
State          ASCII     463  29    
Pcode          ASCII     492  12    
Cntry          ASCII     504  61    
TEL1           ASCII     565  21    
TEL2           ASCII     586  21    
TEL3           ASCII     607  21    
FAX            ASCII     628  21    
Email1         ASCII     649  60    
Email2         ASCII     709  60    
Pymnt_Trm      ASCII     769  21    
Created_Dt     DATETIME  790   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  798   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  806   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     814  30    
Cha_Field2     ASCII     844  30    
Cha_Field3     ASCII     874   3    
Cha_Field4     ASCII     877  20    
Cha_Field5     ASCII     897  20    
Num_Field1     ACL       917  12 2  
Num_Field2     ACL       929  12 2  
Num_Field3     ACL       941  12 2  
Num_Field4     ACL       953  12 2  
Num_Field5     ACL       965  12 2  
Dt_Field1      DATETIME  977   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  985   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  993   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1001  20    
Max_Inv_Dt     DATETIME 1021   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1029  20    
ID_KEY         ASCII    1049  85    
^LAYOUT   AP014_No_Trans_18_Mon              1258 D.T,
!"VMF_Vnd_Master_File" "IDX_VMF1_VndrSiteID" Vndr_Site_ID
Vndr_Site_ID   ASCII       1  20    
Co             ASCII      21  20    
Vndr_ID        ASCII      41  20    
Vndr_Nme       ASCII      61  73    
ABN            ASCII     134  20    
Vndr_Sts       ASCII     154   1    
Vndr_Typ       ASCII     155  11    
Vndr_Add_Typ   ASCII     166  15    
ADD1           ASCII     181 125    
ADD2           ASCII     306  61    
ADD3           ASCII     367  61    
City           ASCII     428  35    
State          ASCII     463  29    
Pcode          ASCII     492  12    
Cntry          ASCII     504  61    
TEL1           ASCII     565  21    
TEL2           ASCII     586  21    
TEL3           ASCII     607  21    
FAX            ASCII     628  21    
Email1         ASCII     649  60    
Email2         ASCII     709  60    
Pymnt_Trm      ASCII     769  21    
Created_Dt     DATETIME  790   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  798   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  806   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     814  30    
Cha_Field2     ASCII     844  30    
Cha_Field3     ASCII     874   3    
Cha_Field4     ASCII     877  20    
Cha_Field5     ASCII     897  20    
Num_Field1     ACL       917  12 2  
Num_Field2     ACL       929  12 2  
Num_Field3     ACL       941  12 2  
Num_Field4     ACL       953  12 2  
Num_Field5     ACL       965  12 2  
Dt_Field1      DATETIME  977   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  985   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  993   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1001  20    
Max_Inv_Dt     DATETIME 1021   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1029  20    
ID_KEY         ASCII    1049  85    
SORT_KEY       ASCII    1134  20    
SORT_KEY_Desc  ASCII    1154   7    
Priority       ASCII    1161   1    
RptRunDate     DATETIME 1162   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Data_Range_Start_Date DATETIME 1170   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME 1178   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
TEST_NAME      ASCII    1186  73    
^LAYOUT   HIST1_VM007_Invld_Frmt_ABN         1281 D.T,
Vndr_Site_ID   ASCII       1  20    
Co             ASCII      21  20    
Vndr_ID        ASCII      41  20    
Vndr_Nme       ASCII      61  73    
ABN            ASCII     134  20    
Vndr_Sts       ASCII     154   1    
Vndr_Typ       ASCII     155  11    
Vndr_Add_Typ   ASCII     166  15    
ADD1           ASCII     181 125    
ADD2           ASCII     306  61    
ADD3           ASCII     367  61    
City           ASCII     428  35    
State          ASCII     463  29    
Pcode          ASCII     492  12    
Cntry          ASCII     504  61    
TEL1           ASCII     565  21    
TEL2           ASCII     586  21    
TEL3           ASCII     607  21    
FAX            ASCII     628  21    
Email1         ASCII     649  60    
Email2         ASCII     709  60    
Pymnt_Trm      ASCII     769  21    
Created_Dt     DATETIME  790   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  798   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  806   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     814  30    
Cha_Field2     ASCII     844  30    
Cha_Field3     ASCII     874   3    
Cha_Field4     ASCII     877  20    
Cha_Field5     ASCII     897  20    
Num_Field1     ACL       917  12 2  
Num_Field2     ACL       929  12 2  
Num_Field3     ACL       941  12 2  
Num_Field4     ACL       953  12 2  
Num_Field5     ACL       965  12 2  
Dt_Field1      DATETIME  977   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  985   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  993   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1001  20    
Max_Inv_Dt     DATETIME 1021   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1029  20    
Inv_Amt        ACL      1049  12 2  
GST_Amt        ACL      1061  12 2  
COUNT          ACL      1073  12 0 WIDTH 8  
ID_KEY         ASCII    1085  85    
SORT_KEY       ASCII    1170  35    
SORT_KEY_Desc  ASCII    1205  20    
Priority       ASCII    1225   1    
RptRunDate     DATETIME 1226   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
TEST_NAME      ASCII    1234  48    
^LAYOUT   VM010_DeReg_GST                    1312 D.T,
!"VM010D_DeReg_GST_Sum" "IDX_VM010D_Sum_VndrSiteID" Vndr_Site_ID
ASIC_entityStatusCode ASCII       1  21    
ASIC_entityStatusEF DATETIME   22   8   PICTURE "YYYYMMDD"  
ASIC_GST_effFrom DATETIME   30   8   PICTURE "YYYYMMDD"  
ASIC_GST_effTo DATETIME   38   8   PICTURE "YYYYMMDD"  
ASIC_entityDescription ASCII      46  50    
Inv_Amt        ACL        96  12 2  
GST_Amt        ACL       108  12 2  
COUNT          ACL       120  12 0 WIDTH 8  
Vndr_Site_ID   ASCII     132  20    
Co             ASCII     152  20    
Vndr_ID        ASCII     172  20    
Vndr_Nme       ASCII     192  73    
ABN            ASCII     265  20    
Vndr_Sts       ASCII     285   1    
Vndr_Typ       ASCII     286  11    
Vndr_Add_Typ   ASCII     297  15    
ADD1           ASCII     312 125    
ADD2           ASCII     437  61    
ADD3           ASCII     498  61    
City           ASCII     559  35    
State          ASCII     594  29    
Pcode          ASCII     623  12    
Cntry          ASCII     635  61    
TEL1           ASCII     696  21    
TEL2           ASCII     717  21    
TEL3           ASCII     738  21    
FAX            ASCII     759  21    
Email1         ASCII     780  60    
Email2         ASCII     840  60    
Pymnt_Trm      ASCII     900  21    
Created_Dt     DATETIME  921   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  929   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  937   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     945  30    
Cha_Field2     ASCII     975  30    
Cha_Field3     ASCII    1005   3    
Cha_Field4     ASCII    1008  20    
Cha_Field5     ASCII    1028  20    
Num_Field1     ACL      1048  12 2  
Num_Field2     ACL      1060  12 2  
Num_Field3     ACL      1072  12 2  
Num_Field4     ACL      1084  12 2  
Num_Field5     ACL      1096  12 2  
Dt_Field1      DATETIME 1108   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME 1116   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME 1124   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1132  20    
Max_Inv_Dt     DATETIME 1152   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1160  20    
Priority       ASCII    1180   1    
TEST_NAME      ASCII    1181  57    
RptRunDate     DATETIME 1238   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
SORT_KEY       ASCII    1246  32    
SORT_KEY_Desc  ASCII    1278  35    
^LAYOUT   TMP_2                              183 D.T,
VENDOR_ID__    ASCII       1  11    
_VENDOR_SITE_ID_ ASCII      12  16    
_VENDOR_BANK_ACCT_NAME_ ASCII      28  48    
_VENDOR_BSB_   ASCII      76  12    
_VENDOR_BANK_ACCOUNT_NUMBER_ ASCII      88  28    
_ACCT_START_DATE_ ASCII     116  22    
_ACCT_END_DATE ASCII     138  22    
LAST_UPDATE_DATE ASCII     160  22    
^LAYOUT   TMP_3                              193 D.T,
_VENDOR_SITE_ID_ ASCII       1  16    
VENDOR_ID__    ASCII      17  11    
_VENDOR_BSB_   ASCII      28  12    
_VENDOR_BANK_ACCOUNT_NUMBER_ ASCII      40  28    
COUNT          ACL        68  12 0 WIDTH 8  
_VENDOR_BANK_ACCT_NAME_ ASCII      80  48    
_ACCT_START_DATE_ ASCII     128  22    
_ACCT_END_DATE ASCII     150  22    
LAST_UPDATE_DATE ASCII     172  22    
^LAYOUT   AP_VendorMasterBnkAcc_ALL_New      243 D.T,
_VENDOR_SITE_ID_ ASCII       1  16    
VENDOR_ID__    ASCII      17  11    
_VENDOR_BSB_   ASCII      28  12    
_VENDOR_BANK_ACCOUNT_NUMBER_ ASCII      40  28    
COUNT          ACL        68  12 0 WIDTH 8  
_VENDOR_BANK_ACCT_NAME_ ASCII      80  48    
_ACCT_START_DATE_ ASCII     128  22    
_ACCT_END_DATE ASCII     150  22    
LAST_UPDATE_DATE ASCII     172  22    
File_Name      ASCII     194  50    
C_KEY          COMPUTED             
 *C 50 1 
 SUBSTR(ALLTRIM(_VENDOR_SITE_ID_)+ALLTRIM(VENDOR_ID__)+ALLTRIM(_VENDOR_BSB_)+ALLTRIM(_VENDOR_BANK_ACCOUNT_NUMBER_),1,50)
^LAYOUT   AP_VendorMasterBnkAcc_ALL_Old      243 D.T,
!"AP_VendorMasterBnkAcc_ALL_New" "IDX_NewVMBnk_Key" C_KEY
_VENDOR_SITE_ID_ ASCII       1  16    
VENDOR_ID__    ASCII      17  11    
_VENDOR_BSB_   ASCII      28  12    
_VENDOR_BANK_ACCOUNT_NUMBER_ ASCII      40  28    
COUNT          ACL        68  12 0 WIDTH 8  
_VENDOR_BANK_ACCT_NAME_ ASCII      80  48    
_ACCT_START_DATE_ ASCII     128  22    
_ACCT_END_DATE ASCII     150  22    
LAST_UPDATE_DATE ASCII     172  22    
File_Name      ASCII     194  50    
c_VENDOR_ID    COMPUTED             
 *C 11 1 
 REPLACE(ALLTRIM(VENDOR_ID__),'~','')
c_MONTH6       COMPUTED             
 *C 2 13 
 "01" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'JAN' AND  LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "02" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'FEB' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "03" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'MAR' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "04" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'APR' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "05" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'MAY' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "06" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'JUN' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "07" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'JUL' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "08" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'AUG' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "09" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'SEP' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "10" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'OCT' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "11" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'NOV' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "12" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'DEC' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "00"
c_DAY6         COMPUTED             
 *C 2 1 
 SUBSTR(_ACCT_START_DATE_,1,2)
c_YEAR6        COMPUTED             
 *C 4 3 
 "20"+ SUBSTR(_ACCT_START_DATE_,8,2) IF LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(_ACCT_START_DATE_,8,2),0) <= 30
 "19"+ SUBSTR(_ACCT_START_DATE_,8,2) IF LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(_ACCT_START_DATE_,8,2),0) > 30
 SUBSTR(_ACCT_START_DATE_,6,4)
c_ACCT_START_DATE_CLN COMPUTED             
 *C 10 1 
 c_DAY6 + '/' + c_MONTH6 + '/' + c_YEAR6
c_ACCT_START_DATE COMPUTED            WIDTH 27  
 *D 2 16
 CTOD(c_ACCT_START_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 CTOD(c_ACCT_START_DATE_CLN ,'DD/MM/YYYY' )
c_MONTH7       COMPUTED             
 *C 2 13 
 "01" IF SUBSTR(_ACCT_END_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "02" IF SUBSTR(_ACCT_END_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "03" IF SUBSTR(_ACCT_END_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "04" IF SUBSTR(_ACCT_END_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "05" IF SUBSTR(_ACCT_END_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "06" IF SUBSTR(_ACCT_END_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "07" IF SUBSTR(_ACCT_END_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "08" IF SUBSTR(_ACCT_END_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "09" IF SUBSTR(_ACCT_END_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "10" IF SUBSTR(_ACCT_END_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "11" IF SUBSTR(_ACCT_END_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "12" IF SUBSTR(_ACCT_END_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "00"
c_DAY7         COMPUTED             
 *C 2 1 
 SUBSTR(_ACCT_END_DATE,1,2)
c_YEAR7        COMPUTED             
 *C 4 3 
 "20"+ SUBSTR(_ACCT_END_DATE,8,2) IF LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(_ACCT_END_DATE,8,2),0) <= 30
 "19"+ SUBSTR(_ACCT_END_DATE,8,2) IF LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(_ACCT_END_DATE,8,2),0) > 30
 SUBSTR(_ACCT_END_DATE,6,4)
c_ACCT_END_DATE_CLN COMPUTED             
 *C 10 1 
 c_DAY7 + '/' + c_MONTH7 + '/' + c_YEAR7
c_ACCT_END_DATE COMPUTED            WIDTH 27  
 *D 2 16
 CTOD(c_ACCT_END_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 CTOD(c_ACCT_END_DATE_CLN ,'DD/MM/YYYY' )
c_MONTH10      COMPUTED             
 *C 2 13 
 "01" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "02" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "03" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "04" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "05" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "06" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "07" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "08" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "09" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "10" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "11" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "12" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "00"
c_DAY10        COMPUTED             
 *C 2 1 
 SUBSTR(LAST_UPDATE_DATE,1,2)
c_YEAR10       COMPUTED             
 *C 4 3 
 "20"+ SUBSTR(LAST_UPDATE_DATE,8,2) IF LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(LAST_UPDATE_DATE,8,2),0) <= 30
 "19"+ SUBSTR(LAST_UPDATE_DATE,8,2) IF LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(LAST_UPDATE_DATE,8,2),0) > 30
 SUBSTR(LAST_UPDATE_DATE,6,4)
c_LAST_UPDATE_DATE_CLN COMPUTED             
 *C 10 1 
 c_DAY10 + '/' + c_MONTH10 + '/' + c_YEAR10
c_LAST_UPDATE_DATE COMPUTED            WIDTH 27  
 *D 2 16
 CTOD(c_LAST_UPDATE_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 CTOD(c_LAST_UPDATE_DATE_CLN ,'DD/MM/YYYY' )
c_StartDate    COMPUTED             SPLIT(_ACCT_START_DATE_,"/",1)+"/"+SPLIT(_ACCT_START_DATE_,"/",2)+"/"+SUBSTRING(SPLIT(_ACCT_START_DATE_,"/",3),1,4) IF _ACCT_START_DATE_<>" "
 *C 1 1 
 " "
c_StartDate1   COMPUTED            WIDTH 27  
 *D 1 16
 CTOD(c_StartDate,"DD/MM/YYYY")
c_EndDate      COMPUTED             SPLIT(_ACCT_END_DATE,"/",1)+"/"+SPLIT(_ACCT_END_DATE,"/",2)+"/"+SUBSTRING(SPLIT(_ACCT_END_DATE,"/",3),1,4) IF _ACCT_END_DATE<>" "
 *C 1 1 
 " "
c_EndDate1     COMPUTED            WIDTH 27  
 *D 1 16
 CTOD(c_EndDate,"DD/MM/YYYY")
C_KEY          COMPUTED             
 *C 50 1 
 SUBSTR(ALLTRIM(_VENDOR_SITE_ID_)+ALLTRIM(VENDOR_ID__)+ALLTRIM(_VENDOR_BSB_)+ALLTRIM(_VENDOR_BANK_ACCOUNT_NUMBER_),1,50)
^LAYOUT   _DIR                               316 D.T,
FILE_NAME      ASCII       1 256   AS "FileName" WIDTH 35  
FILE_SIZE      ACL       257  12 0 AS "File;Size" WIDTH 16  
FILE_ATTRIBUTES ASCII     269   6   AS "Attributes"  
FILE_CREATE_DATE DATETIME  275   8   PICTURE "YYYYMMDD" AS "Create;Date"  
FILE_CREATE_TIME DATETIME  283   6   PICTURE "hhmmss" AS "Create;Time" WIDTH 14  
FILE_ACCESS_DATE DATETIME  289   8   PICTURE "YYYYMMDD" AS "Access;Date"  
FILE_ACCESS_TIME DATETIME  297   6   PICTURE "hhmmss" AS "Access;Time" WIDTH 14  
FILE_WRITE_DATE DATETIME  303   8   PICTURE "YYYYMMDD" AS "Modified;Date"  
FILE_WRITE_TIME DATETIME  311   6   PICTURE "hhmmss" AS "Modified;Time" WIDTH 14  
^LAYOUT   Invoice_fixed                      5000 D.T,
EXPR_0         ASCII       1 5000   AS 'REGEXREPLACE(ALLREC,"[(\x00-\x09)(\x0B-\x0C)(\x0E-\x1F)]",' ')'  
^LAYOUT   FIXED_5000                         5000 D.T,
ALLREC         ASCII       1 5000    
c_PIPE         COMPUTED             
 *N 0 1
 OCCURS(ALLREC,'|')
c_TILDE        COMPUTED             
 *N 0 1
 OCCURS(ALLREC,'~')
^LAYOUT   GENERIC                            5000 D.T,
ALLREC         ASCII       1 5000    
^LAYOUT   AP_INVOICES_ALL_New                822 D.T,
INVOICE_ID     ASCII       1  10    
COUNT          ACL        11  12 0 WIDTH 8  
VENDOR_ID      ASCII      23  20    
VENDOR_SITE_ID ASCII      43  20    
INVOICE_NUM    ASCII      63  50    
INVOICE_TYPE   ASCII     113  10    
INVOICE_DATE   ASCII     123  10    
INVOICE_AMOUNT ASCII     133  12    
DESCRIPTION    ASCII     145 500    
CHARGECODE     ASCII     645  35    
PAYMENT_STATUS_FLAG ASCII     680  20    
CANCELLED_DATE ASCII     700  20    
GST_STATUS     ASCII     720  20    
APPROVAL_STATUS ASCII     740  30    
SourceFlag     ASCII     770   3    
File_Name      ASCII     773  50    
C_KEY          COMPUTED             
 *C 20 1 
 SUBSTR(ALLTRIM(STRING(VALUE(INVOICE_ID,0),20,"9999999")),1,20)
^LAYOUT   AP_INVOICES_ALL_Old                822 D.T,
!"AP_INVOICES_ALL_New" "IDX_NewInv_Key" C_KEY
INVOICE_ID     ASCII       1  10    
COUNT          ACL        11  12 0 WIDTH 8  
VENDOR_ID      ASCII      23  20    
VENDOR_SITE_ID ASCII      43  20    
INVOICE_NUM    ASCII      63  50    
INVOICE_TYPE   ASCII     113  10    
INVOICE_DATE   ASCII     123  10    
INVOICE_AMOUNT ASCII     133  12    
DESCRIPTION    ASCII     145 500    
CHARGECODE     ASCII     645  35    
PAYMENT_STATUS_FLAG ASCII     680  20    
CANCELLED_DATE ASCII     700  20    
GST_STATUS     ASCII     720  20    
APPROVAL_STATUS ASCII     740  30    
SourceFlag     ASCII     770   3    
File_Name      ASCII     773  50    
c_INVOICE_AMOUNT COMPUTED             
 *N 2 1
 VALUE(INVOICE_AMOUNT,2)
c_MONTH1       COMPUTED             
 *C 2 13 
 "01" IF SUBSTR(CANCELLED_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "02" IF SUBSTR(CANCELLED_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "03" IF SUBSTR(CANCELLED_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "04" IF SUBSTR(CANCELLED_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "05" IF SUBSTR(CANCELLED_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "06" IF SUBSTR(CANCELLED_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "07" IF SUBSTR(CANCELLED_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "08" IF SUBSTR(CANCELLED_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "09" IF SUBSTR(CANCELLED_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "10" IF SUBSTR(CANCELLED_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "11" IF SUBSTR(CANCELLED_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "12" IF SUBSTR(CANCELLED_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "00"
c_DAY1         COMPUTED             
 *C 2 1 
 SUBSTR(CANCELLED_DATE,1,2)
c_YEAR1        COMPUTED             
 *C 4 3 
 "20"+ SUBSTR(CANCELLED_DATE,8,2) IF LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(INVOICE_DATE,8,2),0) <= 30
 "19"+ SUBSTR(CANCELLED_DATE,8,2) IF LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(INVOICE_DATE,8,2),0) > 30
 SUBSTR(CANCELLED_DATE,6,4)
c_CANCELLED_DATE_CLN COMPUTED             
 *C 10 1 
 c_DAY1 + '/' + c_MONTH1 + '/' + c_YEAR1
c_CANCELLED_DATE COMPUTED            WIDTH 27  
 *D 2 16
 CTOD(c_CANCELLED_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 CTOD(CANCELLED_DATE ,'DD/MM/YYYY' )
c_MONTH        COMPUTED             
 *C 2 13 
 "01" IF SUBSTR(INVOICE_DATE,4,3) = 'JAN'
 "02" IF SUBSTR(INVOICE_DATE,4,3) = 'FEB'
 "03" IF SUBSTR(INVOICE_DATE,4,3) = 'MAR'
 "04" IF SUBSTR(INVOICE_DATE,4,3) = 'APR'
 "05" IF SUBSTR(INVOICE_DATE,4,3) = 'MAY'
 "06" IF SUBSTR(INVOICE_DATE,4,3) = 'JUN'
 "07" IF SUBSTR(INVOICE_DATE,4,3) = 'JUL'
 "08" IF SUBSTR(INVOICE_DATE,4,3) = 'AUG'
 "09" IF SUBSTR(INVOICE_DATE,4,3) = 'SEP'
 "10" IF SUBSTR(INVOICE_DATE,4,3) = 'OCT'
 "11" IF SUBSTR(INVOICE_DATE,4,3) = 'NOV'
 "12" IF SUBSTR(INVOICE_DATE,4,3) = 'DEC'
 "00"
c_DAY          COMPUTED             
 *C 2 1 
 SUBSTR(INVOICE_DATE,1,2)
c_YEAR         COMPUTED             
 *C 4 1 
 "20"+ SUBSTR(INVOICE_DATE,8,2)
c_INVOICE_DATE_CLN COMPUTED             
 *C 10 1 
 c_DAY + '/' + c_MONTH + '/' + c_YEAR
c_INVOICE_DATE COMPUTED            WIDTH 27  
 *D 1 16
 CTOD(c_INVOICE_DATE_CLN ,'DD/MM/YYYY' )
C_KEY          COMPUTED             
 *C 20 1 
 SUBSTR(ALLTRIM(STRING(VALUE(INVOICE_ID,0),20,"9999999")),1,20)
^LAYOUT   GreyList_AP001                     80 D.T,
Vndr_Site_ID   ASCII       1  20    
Vndr_Name      ASCII      21  60    
^LAYOUT   GreyList_AP002                     80 D.T,
Vndr_Site_ID   ASCII       1  20    
Vndr_Name      ASCII      21  60    
^LAYOUT   TMP_AP002                          600 D.T,
Flag           ASCII       1   1    
Vendor_Site    ASCII       2  30   AS "Vendor Site"  
Vendor_Number  ASCII      32  20   AS "Vendor Number"  
Vendor_Name_in_VMF ASCII      52  73   AS "Vendor Name in VMF"  
Vendor_Status  ASCII     125   1   AS "Vendor Status"  
Invoice_Reference ASCII     126  53   AS "Invoice Reference"  
Invoice_Date   ASCII     179  12   AS "Invoice Date"  
Invoice_Amount ACL       191  12 2 AS "Invoice Amount"  
Payment_Status_Flag ASCII     203  20   AS "Payment Status Flag"  
Invoice_Type   ASCII     223  10    
Description    ASCII     233  20    
Trans_Number   ASCII     253  10   AS "Trans Number"  
GST_Status     ASCII     263  20   AS "GST Status"  
Priority       ASCII     283   1    
Vendor_Site_ID ASCII     284  20   AS "Vendor Site ID"  
Vendor_ID      ASCII     304  20   AS "Vendor ID"  
Invoice_ID     ASCII     324  50   AS "Invoice ID"  
SourceFlag     ASCII     374   3    
TEST_NAME      ASCII     377  62    
Test_Date      ASCII     439  12   AS "Test Date"  
Data_Range_Start_Date ASCII     451  12    
Data_Range_End_Date ASCII     463  12    
SORT_KEY       ASCII     475  80    
SORT_KEY_Desc  ASCII     555  46    
^LAYOUT   AP_Dups_Amt_Inv                    679 D.T,
!"VMF_Vnd_Master_File" "IDX_VndrSiteID" Vndr_Site_ID
c_Inv_No       ASCII       1  20    Srt Inv_No
ABS_INVAMT     ACL        21  12 0  
Vndr_Site_ID   ASCII      33  20    
Vndr_ID        ASCII      53  20    
Vchr_ID        ASCII      73  10    
isPaid         ASCII      83   1    
Doc_Typ        ASCII      84  10    
Inv_Dt         DATETIME   94   8   PICTURE "YYYYMMDD"  
Inv_No         ASCII     102  50    
Inv_Amt        ACL       152  12 2  
Inv_Amt_Doc    ACL       164  12 2  
Curncy         ASCII     176  15    
Inv_Net_Amt    ACL       191  12 2  
GST_Amt        ACL       203  12 2  
Btch_No        ASCII     215  15    
Due_Dt         DATETIME  230   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     238  21    
PO_Net_Amt     ACL       259  12 2  
Descrp         ASCII     271  31    
Pd_Dt          DATETIME  302   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     310  21    
Modf_By        ASCII     331  15    
Modf_Dt        DATETIME  346   8   PICTURE "YYYYMMDD"  
Pst_Dt         DATETIME  354   8   PICTURE "YYYYMMDD"  
Ex_Rate        ACL       362  12 2  
VOIDED         ASCII     374   1    
Void_Dt        DATETIME  375   8   PICTURE "YYYYMMDD"  
Num_Field1     ACL       383  12 2  
Num_Field2     ACL       395  12 2  
Num_Field3     ACL       407  12 2  
Num_Field4     ACL       419  12 2  
Num_Field5     ACL       431  12 2  
Dt_Field1      DATETIME  443   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  451   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  459   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     467  20    
Cha_Field2     ASCII     487  20    
Cha_Field3     ASCII     507  20    
Cha_Field4     ASCII     527  20    
Cha_Field5     ASCII     547  20    
c_Inv_Dt       ASCII     567   8    
Vndr_Mstr_ID   ASCII     575  20    
Vndr_Nme       ASCII     595  73    
Vndr_Sts       ASCII     668   1    
Vndr_Typ       ASCII     669  11    
ABS_INVAMT_CENT COMPUTED             
 *N 4 2
 VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21)),4) IF OCCURS(ALLTRIM(STRING(ABS(Inv_Amt),21)),".")>=0
 VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21 )),4)
^LAYOUT   GreyList_AP003                     80 D.T,
Vndr_Site_ID   ASCII       1  20    
Vndr_Name      ASCII      21  60    
^LAYOUT   TMP_AP003                          600 D.T,
Flag           ASCII       1   1    
Vendor_Site    ASCII       2  30   AS "Vendor Site"  
Vendor_Number  ASCII      32  20   AS "Vendor Number"  
Vendor_Name_in_VMF ASCII      52  73   AS "Vendor Name in VMF"  
Vendor_Status  ASCII     125   1   AS "Vendor Status"  
Invoice_Reference ASCII     126  53   AS "Invoice Reference"  
Invoice_Date   ASCII     179  12   AS "Invoice Date"  
Invoice_Amount ACL       191  12 2 AS "Invoice Amount"  
Payment_Status_Flag ASCII     203  20   AS "Payment Status Flag"  
Invoice_Type   ASCII     223  10    
Description    ASCII     233  20    
Trans_Number   ASCII     253  10   AS "Trans Number"  
GST_Status     ASCII     263  20   AS "GST Status"  
Priority       ASCII     283   1    
Vendor_Site_ID ASCII     284  20   AS "Vendor Site ID"  
Vendor_ID      ASCII     304  20   AS "Vendor ID"  
Invoice_ID     ASCII     324  50   AS "Invoice ID"  
SourceFlag     ASCII     374   3    
TEST_NAME      ASCII     377  62    
Test_Date      ASCII     439  12   AS "Test Date"  
Data_Range_Start_Date ASCII     451  12    
Data_Range_End_Date ASCII     463  12    
SORT_KEY       ASCII     475  80    
SORT_KEY_Desc  ASCII     555  46    
^LAYOUT   AP002_History                      1029 D.T,
Flag           ASCII       1   1    
DUP_KEY        ASCII       2  72    
CREDIT_KEY     ASCII      74  40    
Vndr_Site_ID   ASCII     114  20    
Vndr_ID        ASCII     134  20    
Vchr_ID        ASCII     154  10    
ABS_INVAMT     ACL       164  12 0  
isPaid         ASCII     176   1    
Doc_Typ        ASCII     177  10    
Inv_Dt         DATETIME  187   8   PICTURE "YYYYMMDD"  
Inv_No         ASCII     195  50    
Inv_Amt        ACL       245  12 2  
Inv_Amt_Doc    ACL       257  12 2  
Curncy         ASCII     269  15    
Inv_Net_Amt    ACL       284  12 2  
GST_Amt        ACL       296  12 2  
Btch_No        ASCII     308  15    
Due_Dt         DATETIME  323   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     331  21    
PO_Net_Amt     ACL       352  12 2  
Descrp         ASCII     364  31    
Pd_Dt          DATETIME  395   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     403  21    
Modf_By        ASCII     424  15    
Modf_Dt        DATETIME  439   8   PICTURE "YYYYMMDD"  
Pst_Dt         DATETIME  447   8   PICTURE "YYYYMMDD"  
Ex_Rate        ACL       455  12 2  
VOIDED         ASCII     467   1    
Void_Dt        DATETIME  468   8   PICTURE "YYYYMMDD"  
Num_Field1     ACL       476  12 2  
Num_Field2     ACL       488  12 2  
Num_Field3     ACL       500  12 2  
Num_Field4     ACL       512  12 2  
Num_Field5     ACL       524  12 2  
Dt_Field1      DATETIME  536   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  544   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  552   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     560  20    
Cha_Field2     ASCII     580  20    
Cha_Field3     ASCII     600  20    
Cha_Field4     ASCII     620  20    
Cha_Field5     ASCII     640  20    
c_Inv_No       ASCII     660  20    Srt Inv_No
c_Inv_Dt       ASCII     680   8    
Vndr_Mstr_ID   ASCII     688  20    
Vndr_Nme       ASCII     708  73    
Vndr_Sts       ASCII     781   1    
Vndr_Typ       ASCII     782  11    
RANK           ASCII     793   1    
SORT_KEY       ASCII     794  80    
SORT_KEY_Desc  ASCII     874  46    
Priority       ASCII     920   1    
RptRunDate     DATETIME  921   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Data_Range_Start_Date DATETIME  929   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME  937   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
ID_KEY         ASCII     945  85    
^LAYOUT   AP003_History                      1029 D.T,
Flag           ASCII       1   1    
DUP_KEY        ASCII       2  72    
CREDIT_KEY     ASCII      74  40    
Vndr_Site_ID   ASCII     114  20    
Vndr_ID        ASCII     134  20    
Vchr_ID        ASCII     154  10    
ABS_INVAMT     ACL       164  12 0  
isPaid         ASCII     176   1    
Doc_Typ        ASCII     177  10    
Inv_Dt         DATETIME  187   8   PICTURE "YYYYMMDD"  
Inv_No         ASCII     195  50    
Inv_Amt        ACL       245  12 2  
Inv_Amt_Doc    ACL       257  12 2  
Curncy         ASCII     269  15    
Inv_Net_Amt    ACL       284  12 2  
GST_Amt        ACL       296  12 2  
Btch_No        ASCII     308  15    
Due_Dt         DATETIME  323   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     331  21    
PO_Net_Amt     ACL       352  12 2  
Descrp         ASCII     364  31    
Pd_Dt          DATETIME  395   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     403  21    
Modf_By        ASCII     424  15    
Modf_Dt        DATETIME  439   8   PICTURE "YYYYMMDD"  
Pst_Dt         DATETIME  447   8   PICTURE "YYYYMMDD"  
Ex_Rate        ACL       455  12 2  
VOIDED         ASCII     467   1    
Void_Dt        DATETIME  468   8   PICTURE "YYYYMMDD"  
Num_Field1     ACL       476  12 2  
Num_Field2     ACL       488  12 2  
Num_Field3     ACL       500  12 2  
Num_Field4     ACL       512  12 2  
Num_Field5     ACL       524  12 2  
Dt_Field1      DATETIME  536   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  544   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  552   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     560  20    
Cha_Field2     ASCII     580  20    
Cha_Field3     ASCII     600  20    
Cha_Field4     ASCII     620  20    
Cha_Field5     ASCII     640  20    
c_Inv_No       ASCII     660  20    Srt Inv_No
c_Inv_Dt       ASCII     680   8    
Vndr_Mstr_ID   ASCII     688  20    
Vndr_Nme       ASCII     708  73    
Vndr_Sts       ASCII     781   1    
Vndr_Typ       ASCII     782  11    
RANK           ASCII     793   1    
SORT_KEY       ASCII     794  80    
SORT_KEY_Desc  ASCII     874  46    
Priority       ASCII     920   1    
RptRunDate     DATETIME  921   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Data_Range_Start_Date DATETIME  929   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME  937   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
ID_KEY         ASCII     945  85    
^LAYOUT   AP001_History                      954 D.T,
Flag           ASCII       1   1    
DUP_KEY        ASCII       2  72    
CREDIT_KEY     ASCII      74  40    
Vndr_Site_ID   ASCII     114  20    
Vndr_ID        ASCII     134  20    
Vchr_ID        ASCII     154  10    
ABS_INVAMT     ACL       164  12 0  
isPaid         ASCII     176   1    
Doc_Typ        ASCII     177  10    
Inv_Dt         DATETIME  187   8   PICTURE "YYYYMMDD"  
Inv_No         ASCII     195  50    
Inv_Amt        ACL       245  12 2  
Inv_Amt_Doc    ACL       257  12 2  
Curncy         ASCII     269  15    
Inv_Net_Amt    ACL       284  12 2  
GST_Amt        ACL       296  12 2  
Btch_No        ASCII     308  15    
Due_Dt         DATETIME  323   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     331  21    
PO_Net_Amt     ACL       352  12 2  
Descrp         ASCII     364  31    
Pd_Dt          DATETIME  395   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     403  21    
Modf_By        ASCII     424  15    
Modf_Dt        DATETIME  439   8   PICTURE "YYYYMMDD"  
Pst_Dt         DATETIME  447   8   PICTURE "YYYYMMDD"  
Ex_Rate        ACL       455  12 2  
VOIDED         ASCII     467   1    
Void_Dt        DATETIME  468   8   PICTURE "YYYYMMDD"  
Num_Field1     ACL       476  12 2  
Num_Field2     ACL       488  12 2  
Num_Field3     ACL       500  12 2  
Num_Field4     ACL       512  12 2  
Num_Field5     ACL       524  12 2  
Dt_Field1      DATETIME  536   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  544   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  552   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     560  20    
Cha_Field2     ASCII     580  20    
Cha_Field3     ASCII     600  20    
Cha_Field4     ASCII     620  20    
Cha_Field5     ASCII     640  20    
c_Inv_No       ASCII     660  20    Srt Inv_No
c_Inv_Dt       ASCII     680   8    
Vndr_Mstr_ID   ASCII     688  20    
Vndr_Nme       ASCII     708  73    
Vndr_Sts       ASCII     781   1    
Vndr_Typ       ASCII     782  11    
ABS_INVAMT_CENT ACL       793  12 4  
SORT_KEY       ASCII     805  64    
RANK           ASCII     869   1    
ID_KEY         ASCII     870  85    
^LAYOUT   TMP_AP001                          593 D.T,
Flag           ASCII       1   1    
Vendor_Site    ASCII       2  30   AS "Vendor Site"  
Vendor_Number  ASCII      32  20   AS "Vendor Number"  
Vendor_Name_in_VMF ASCII      52  73   AS "Vendor Name in VMF"  
Vendor_Status  ASCII     125   1   AS "Vendor Status"  
Invoice_Reference ASCII     126  53   AS "Invoice Reference"  
Invoice_Date   ASCII     179  12   AS "Invoice Date"  
Invoice_Amount ACL       191  12 2 AS "Invoice Amount"  
Payment_Status_Flag ASCII     203  20   AS "Payment Status Flag"  
Invoice_Type   ASCII     223  10    
Description    ASCII     233  20    
Trans_Number   ASCII     253  10   AS "Trans Number"  
GST_Status     ASCII     263  20   AS "GST Status"  
Priority       ASCII     283   1    
Vendor_Site_ID ASCII     284  20   AS "Vendor Site ID"  
Vendor_ID      ASCII     304  20   AS "Vendor ID"  
Invoice_ID     ASCII     324  50   AS "Invoice ID"  
SourceFlag     ASCII     374   3    
TEST_NAME      ASCII     377  55    
Test_Date      ASCII     432  12   AS "Test Date"  
Data_Range_Start_Date ASCII     444  12    
Data_Range_End_Date ASCII     456  12    
SORT_KEY       ASCII     468  80    
SORT_KEY_Desc  ASCII     548  46    
^LAYOUT   GreyList_AP004                     80 D.T,
Vndr_Site_ID   ASCII       1  20    
Vndr_Name      ASCII      21  60    
^LAYOUT   AP001_TMP                          792 D.T,
!"TMP_AP_Dups" "IDX_TMP_AP_Dups_ID" Vchr_ID
!"TMP_AP_Dups_1" "IDX_TMP_AP_Dups_1_DUP_KEY" DUP_KEY
Flag           ASCII       1   1    
DUP_KEY        ASCII       2  72    
CREDIT_KEY     ASCII      74  40    
Vndr_Site_ID   ASCII     114  20    
Vndr_ID        ASCII     134  20    
Vchr_ID        ASCII     154  10    
ABS_INVAMT     ACL       164  12 0  
isPaid         ASCII     176   1    
Doc_Typ        ASCII     177  10    
Inv_Dt         DATETIME  187   8   PICTURE "YYYYMMDD"  
Inv_No         ASCII     195  50    
Inv_Amt        ACL       245  12 2  
Inv_Amt_Doc    ACL       257  12 2  
Curncy         ASCII     269  15    
Inv_Net_Amt    ACL       284  12 2  
GST_Amt        ACL       296  12 2  
Btch_No        ASCII     308  15    
Due_Dt         DATETIME  323   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     331  21    
PO_Net_Amt     ACL       352  12 2  
Descrp         ASCII     364  31    
Pd_Dt          DATETIME  395   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     403  21    
Modf_By        ASCII     424  15    
Modf_Dt        DATETIME  439   8   PICTURE "YYYYMMDD"  
Pst_Dt         DATETIME  447   8   PICTURE "YYYYMMDD"  
Ex_Rate        ACL       455  12 2  
VOIDED         ASCII     467   1    
Void_Dt        DATETIME  468   8   PICTURE "YYYYMMDD"  
Num_Field1     ACL       476  12 2  
Num_Field2     ACL       488  12 2  
Num_Field3     ACL       500  12 2  
Num_Field4     ACL       512  12 2  
Num_Field5     ACL       524  12 2  
Dt_Field1      DATETIME  536   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  544   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  552   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     560  20    
Cha_Field2     ASCII     580  20    
Cha_Field3     ASCII     600  20    
Cha_Field4     ASCII     620  20    
Cha_Field5     ASCII     640  20    
c_Inv_No       ASCII     660  20    Srt Inv_No
c_Inv_Dt       ASCII     680   8    
Vndr_Mstr_ID   ASCII     688  20    
Vndr_Nme       ASCII     708  73    
Vndr_Sts       ASCII     781   1    
Vndr_Typ       ASCII     782  11    
ABS_INVAMT_CENT COMPUTED             
 *N 4 2
 VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21)),4) IF OCCURS(ALLTRIM(STRING(ABS(Inv_Amt),21)),".")>=0
 VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21 )),4)
SORT_KEY       COMPUTED             
 *C 64 1 
 SUBSTR(ZONED(ABS_INVAMT_CENT ,21) +"~"+ ALLTRIM(Flag) +"~"+ ALLTRIM(Vndr_ID) +"~"+ ALLTRIM(c_Inv_Dt),1,64)
^LAYOUT   AP_Dups_Rev                        765 D.T,
Dup_No         ASCII       1   5    
DUP_KEY        ASCII       6  72    
Flag           ASCII      78   1    
Vndr_Site_ID   ASCII      79  20    
Vndr_ID        ASCII      99  20    
Vchr_ID        ASCII     119  10    
ABS_INVAMT     ACL       129  12 0  
isPaid         ASCII     141   1    
Doc_Typ        ASCII     142  10    
Inv_Dt         DATETIME  152   8   PICTURE "YYYYMMDD"  
Inv_No         ASCII     160  50    
Inv_Amt        ACL       210  12 2  
Inv_Amt_Doc    ACL       222  12 2  
Curncy         ASCII     234  15    
Inv_Net_Amt    ACL       249  12 2  
GST_Amt        ACL       261  12 2  
Btch_No        ASCII     273  15    
Due_Dt         DATETIME  288   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     296  21    
PO_Net_Amt     ACL       317  12 2  
Descrp         ASCII     329  31    
Pd_Dt          DATETIME  360   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     368  21    
Modf_By        ASCII     389  15    
Modf_Dt        DATETIME  404   8   PICTURE "YYYYMMDD"  
Pst_Dt         DATETIME  412   8   PICTURE "YYYYMMDD"  
Ex_Rate        ACL       420  12 2  
VOIDED         ASCII     432   1    
Void_Dt        DATETIME  433   8   PICTURE "YYYYMMDD"  
Num_Field1     ACL       441  12 2  
Num_Field2     ACL       453  12 2  
Num_Field3     ACL       465  12 2  
Num_Field4     ACL       477  12 2  
Num_Field5     ACL       489  12 2  
Dt_Field1      DATETIME  501   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  509   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  517   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     525  20    
Cha_Field2     ASCII     545  20    
Cha_Field3     ASCII     565  20    
Cha_Field4     ASCII     585  20    
Cha_Field5     ASCII     605  20    
c_Inv_No       ASCII     625  20    Srt Inv_No
c_Inv_Dt       ASCII     645   8    
Vndr_Mstr_ID   ASCII     653  20    
Vndr_Nme       ASCII     673  73    
Vndr_Sts       ASCII     746   1    
Vndr_Typ       ASCII     747  11    
RptRunDate     DATETIME  758   8   PICTURE "YYYYMMDD"  
^LAYOUT   AP004_History                      1029 D.T,
Flag           ASCII       1   1    
DUP_KEY        ASCII       2  72    
CREDIT_KEY     ASCII      74  40    
Vndr_Site_ID   ASCII     114  20    
Vndr_ID        ASCII     134  20    
Vchr_ID        ASCII     154  10    
ABS_INVAMT     ACL       164  12 0  
isPaid         ASCII     176   1    
Doc_Typ        ASCII     177  10    
Inv_Dt         DATETIME  187   8   PICTURE "YYYYMMDD"  
Inv_No         ASCII     195  50    
Inv_Amt        ACL       245  12 2  
Inv_Amt_Doc    ACL       257  12 2  
Curncy         ASCII     269  15    
Inv_Net_Amt    ACL       284  12 2  
GST_Amt        ACL       296  12 2  
Btch_No        ASCII     308  15    
Due_Dt         DATETIME  323   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     331  21    
PO_Net_Amt     ACL       352  12 2  
Descrp         ASCII     364  31    
Pd_Dt          DATETIME  395   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     403  21    
Modf_By        ASCII     424  15    
Modf_Dt        DATETIME  439   8   PICTURE "YYYYMMDD"  
Pst_Dt         DATETIME  447   8   PICTURE "YYYYMMDD"  
Ex_Rate        ACL       455  12 2  
VOIDED         ASCII     467   1    
Void_Dt        DATETIME  468   8   PICTURE "YYYYMMDD"  
Num_Field1     ACL       476  12 2  
Num_Field2     ACL       488  12 2  
Num_Field3     ACL       500  12 2  
Num_Field4     ACL       512  12 2  
Num_Field5     ACL       524  12 2  
Dt_Field1      DATETIME  536   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  544   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  552   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     560  20    
Cha_Field2     ASCII     580  20    
Cha_Field3     ASCII     600  20    
Cha_Field4     ASCII     620  20    
Cha_Field5     ASCII     640  20    
c_Inv_No       ASCII     660  20    Srt Inv_No
c_Inv_Dt       ASCII     680   8    
Vndr_Mstr_ID   ASCII     688  20    
Vndr_Nme       ASCII     708  73    
Vndr_Sts       ASCII     781   1    
Vndr_Typ       ASCII     782  11    
RANK           ASCII     793   1    
SORT_KEY       ASCII     794  80    
SORT_KEY_Desc  ASCII     874  46    
Priority       ASCII     920   1    
RptRunDate     DATETIME  921   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Data_Range_Start_Date DATETIME  929   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME  937   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
ID_KEY         ASCII     945  85    
^LAYOUT   TMP_DUP_SUM                        96 D.T,
DUP_KEY        ASCII       1  72    
Inv_Amt        ACL        73  12 2  
COUNT          ACL        85  12 0 WIDTH 8  
^LAYOUT   TMP_AP004                          593 D.T,
Flag           ASCII       1   1    
Vendor_Site    ASCII       2  30   AS "Vendor Site"  
Vendor_Number  ASCII      32  20   AS "Vendor Number"  
Vendor_Name_in_VMF ASCII      52  73   AS "Vendor Name in VMF"  
Vendor_Status  ASCII     125   1   AS "Vendor Status"  
Invoice_Reference ASCII     126  53   AS "Invoice Reference"  
Invoice_Date   ASCII     179  12   AS "Invoice Date"  
Invoice_Amount ACL       191  12 2 AS "Invoice Amount"  
Payment_Status_Flag ASCII     203  20   AS "Payment Status Flag"  
Invoice_Type   ASCII     223  10    
Description    ASCII     233  20    
Trans_Number   ASCII     253  10   AS "Trans Number"  
GST_Status     ASCII     263  20   AS "GST Status"  
Priority       ASCII     283   1    
Vendor_Site_ID ASCII     284  20   AS "Vendor Site ID"  
Vendor_ID      ASCII     304  20   AS "Vendor ID"  
Invoice_ID     ASCII     324  50   AS "Invoice ID"  
SourceFlag     ASCII     374   3    
TEST_NAME      ASCII     377  71    
Test_Date      ASCII     448  12   AS "Test Date"  
Data_Range_Start_Date ASCII     460  12    
Data_Range_End_Date ASCII     472  12    
SORT_KEY       ASCII     484  64    
SORT_KEY_Desc  ASCII     548  46    
^LAYOUT   GreyList_AP006                     80 D.T,
Vndr_Site_ID   ASCII       1  20    
Vndr_Name      ASCII      21  60    
^LAYOUT   AP006_History                      826 D.T,
Vchr_ID        ASCII       1  10    
Vndr_Site_ID   ASCII      11  20    
Vndr_ID        ASCII      31  20    
Doc_Typ        ASCII      51  10    
Inv_Dt         DATETIME   61   8   PICTURE "YYYYMMDD" WIDTH 27  
Inv_No         ASCII      69  50    
Inv_Amt        ACL       119  12 2  
Inv_Amt_Doc    ACL       131  12 2  
Curncy         ASCII     143  15    
Ex_Rate        ACL       158  12 2  
Inv_Net_Amt    ACL       170  12 2  
GST_Amt        ACL       182  12 2  
Btch_No        ASCII     194  15    
Due_Dt         DATETIME  209   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     217  21    
PO_Net_Amt     ACL       238  12 2  
Descrp         ASCII     250  31    
Pd_Dt          DATETIME  281   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     289  21    
Modf_Dt        DATETIME  310   8   PICTURE "YYYYMMDD"  
Modf_By        ASCII     318  15    
Pst_Dt         DATETIME  333   8   PICTURE "YYYYMMDD"  
VOIDED         ASCII     341   1    
Void_Dt        DATETIME  342   8   PICTURE "YYYYMMDD"  
isPaid         ASCII     350   1    
Num_Field1     ACL       351  12 2  
Num_Field2     ACL       363  12 2  
Num_Field3     ACL       375  12 2  
Num_Field4     ACL       387  12 2  
Num_Field5     ACL       399  12 2  
Dt_Field1      DATETIME  411   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  419   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  427   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     435  20    
Cha_Field2     ASCII     455  20    
Cha_Field3     ASCII     475  20    
Cha_Field4     ASCII     495  20    
Cha_Field5     ASCII     515  20    
c_Inv_No2      ASCII     535  50    
c_Inv_No       ASCII     585  20    Srt Inv_No
ABS_INVAMT     ACL       605  12 0  
ABS_INVAMT_CENT ACL       617  12 4  
c_Inv_Dt       ASCII     629   8    
Vndr_Mstr_ID   ASCII     637  20    
Vndr_Nme       ASCII     657  73    
Vndr_Sts       ASCII     730   1    
Vndr_Typ       ASCII     731  11    
ID_KEY         ASCII     742  85    
^LAYOUT   AP001_Dup_Amt_Dt_Inv_Vndr          1096 D.T,
!"VMF_Vnd_Master_File" "IDX_VndrSiteID" Vndr_Site_ID
Flag           ASCII       1   1    
DUP_KEY        ASCII       2  72    
CREDIT_KEY     ASCII      74  40    
Vndr_Site_ID   ASCII     114  20    
Vndr_ID        ASCII     134  20    
Vchr_ID        ASCII     154  10    
ABS_INVAMT     ACL       164  12 0  
isPaid         ASCII     176   1    
Doc_Typ        ASCII     177  10    
Inv_Dt         DATETIME  187   8   PICTURE "YYYYMMDD"  
Inv_No         ASCII     195  50    
Inv_Amt        ACL       245  12 2  
Inv_Amt_Doc    ACL       257  12 2  
Curncy         ASCII     269  15    
Inv_Net_Amt    ACL       284  12 2  
GST_Amt        ACL       296  12 2  
Btch_No        ASCII     308  15    
Due_Dt         DATETIME  323   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     331  21    
PO_Net_Amt     ACL       352  12 2  
Descrp         ASCII     364  31    
Pd_Dt          DATETIME  395   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     403  21    
Modf_By        ASCII     424  15    
Modf_Dt        DATETIME  439   8   PICTURE "YYYYMMDD"  
Pst_Dt         DATETIME  447   8   PICTURE "YYYYMMDD"  
Ex_Rate        ACL       455  12 2  
VOIDED         ASCII     467   1    
Void_Dt        DATETIME  468   8   PICTURE "YYYYMMDD"  
Num_Field1     ACL       476  12 2  
Num_Field2     ACL       488  12 2  
Num_Field3     ACL       500  12 2  
Num_Field4     ACL       512  12 2  
Num_Field5     ACL       524  12 2  
Dt_Field1      DATETIME  536   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  544   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  552   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     560  20    
Cha_Field2     ASCII     580  20    
Cha_Field3     ASCII     600  20    
Cha_Field4     ASCII     620  20    
Cha_Field5     ASCII     640  20    
c_Inv_No       ASCII     660  20    Srt Inv_No
c_Inv_Dt       ASCII     680   8    
Vndr_Mstr_ID   ASCII     688  20    
Vndr_Nme       ASCII     708  73    
Vndr_Sts       ASCII     781   1    
Vndr_Typ       ASCII     782  11    
ABS_INVAMT_CENT ACL       793  12 4  
RANK           ASCII     805   1    
ID_KEY         ASCII     806  85    
SORT_KEY       ASCII     891  80    
SORT_KEY_Desc  ASCII     971  46    
Priority       ASCII    1017   1    
RptRunDate     DATETIME 1018   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Data_Range_Start_Date DATETIME 1026   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME 1034   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
TEST_NAME      ASCII    1042  55    
c_QUOTED_INV_ID COMPUTED             
 *C 52 1 
 "'"+ ALLTRIM(Inv_No) + "'"
^LAYOUT   AP002_Dup_Amt_Inv_Vndr             1091 D.T,
!"VMF_Vnd_Master_File" "IDX_VndrSiteID" Vndr_Site_ID
Flag           ASCII       1   1    
DUP_KEY        ASCII       2  72    
CREDIT_KEY     ASCII      74  40    
Vndr_Site_ID   ASCII     114  20    
Vndr_ID        ASCII     134  20    
Vchr_ID        ASCII     154  10    
ABS_INVAMT     ACL       164  12 0  
isPaid         ASCII     176   1    
Doc_Typ        ASCII     177  10    
Inv_Dt         DATETIME  187   8   PICTURE "YYYYMMDD"  
Inv_No         ASCII     195  50    
Inv_Amt        ACL       245  12 2  
Inv_Amt_Doc    ACL       257  12 2  
Curncy         ASCII     269  15    
Inv_Net_Amt    ACL       284  12 2  
GST_Amt        ACL       296  12 2  
Btch_No        ASCII     308  15    
Due_Dt         DATETIME  323   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     331  21    
PO_Net_Amt     ACL       352  12 2  
Descrp         ASCII     364  31    
Pd_Dt          DATETIME  395   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     403  21    
Modf_By        ASCII     424  15    
Modf_Dt        DATETIME  439   8   PICTURE "YYYYMMDD"  
Pst_Dt         DATETIME  447   8   PICTURE "YYYYMMDD"  
Ex_Rate        ACL       455  12 2  
VOIDED         ASCII     467   1    
Void_Dt        DATETIME  468   8   PICTURE "YYYYMMDD"  
Num_Field1     ACL       476  12 2  
Num_Field2     ACL       488  12 2  
Num_Field3     ACL       500  12 2  
Num_Field4     ACL       512  12 2  
Num_Field5     ACL       524  12 2  
Dt_Field1      DATETIME  536   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  544   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  552   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     560  20    
Cha_Field2     ASCII     580  20    
Cha_Field3     ASCII     600  20    
Cha_Field4     ASCII     620  20    
Cha_Field5     ASCII     640  20    
c_Inv_No       ASCII     660  20    Srt Inv_No
c_Inv_Dt       ASCII     680   8    
Vndr_Mstr_ID   ASCII     688  20    
Vndr_Nme       ASCII     708  73    
Vndr_Sts       ASCII     781   1    
Vndr_Typ       ASCII     782  11    
RANK           ASCII     793   1    
SORT_KEY       ASCII     794  80    
SORT_KEY_Desc  ASCII     874  46    
Priority       ASCII     920   1    
RptRunDate     DATETIME  921   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Data_Range_Start_Date DATETIME  929   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME  937   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
ID_KEY         ASCII     945  85    
TEST_NAME      ASCII    1030  62    
c_QUOTED_INV_ID COMPUTED             
 *C 52 1 
 "'"+ ALLTRIM(Inv_No) + "'"
^LAYOUT   AP003_Dup_Amt_Dt_Inv               1091 D.T,
!"VMF_Vnd_Master_File" "IDX_VndrSiteID" Vndr_Site_ID
Flag           ASCII       1   1    
DUP_KEY        ASCII       2  72    
CREDIT_KEY     ASCII      74  40    
Vndr_Site_ID   ASCII     114  20    
Vndr_ID        ASCII     134  20    
Vchr_ID        ASCII     154  10    
ABS_INVAMT     ACL       164  12 0  
isPaid         ASCII     176   1    
Doc_Typ        ASCII     177  10    
Inv_Dt         DATETIME  187   8   PICTURE "YYYYMMDD"  
Inv_No         ASCII     195  50    
Inv_Amt        ACL       245  12 2  
Inv_Amt_Doc    ACL       257  12 2  
Curncy         ASCII     269  15    
Inv_Net_Amt    ACL       284  12 2  
GST_Amt        ACL       296  12 2  
Btch_No        ASCII     308  15    
Due_Dt         DATETIME  323   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     331  21    
PO_Net_Amt     ACL       352  12 2  
Descrp         ASCII     364  31    
Pd_Dt          DATETIME  395   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     403  21    
Modf_By        ASCII     424  15    
Modf_Dt        DATETIME  439   8   PICTURE "YYYYMMDD"  
Pst_Dt         DATETIME  447   8   PICTURE "YYYYMMDD"  
Ex_Rate        ACL       455  12 2  
VOIDED         ASCII     467   1    
Void_Dt        DATETIME  468   8   PICTURE "YYYYMMDD"  
Num_Field1     ACL       476  12 2  
Num_Field2     ACL       488  12 2  
Num_Field3     ACL       500  12 2  
Num_Field4     ACL       512  12 2  
Num_Field5     ACL       524  12 2  
Dt_Field1      DATETIME  536   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  544   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  552   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     560  20    
Cha_Field2     ASCII     580  20    
Cha_Field3     ASCII     600  20    
Cha_Field4     ASCII     620  20    
Cha_Field5     ASCII     640  20    
c_Inv_No       ASCII     660  20    Srt Inv_No
c_Inv_Dt       ASCII     680   8    
Vndr_Mstr_ID   ASCII     688  20    
Vndr_Nme       ASCII     708  73    
Vndr_Sts       ASCII     781   1    
Vndr_Typ       ASCII     782  11    
RANK           ASCII     793   1    
SORT_KEY       ASCII     794  80    
SORT_KEY_Desc  ASCII     874  46    
Priority       ASCII     920   1    
RptRunDate     DATETIME  921   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Data_Range_Start_Date DATETIME  929   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME  937   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
ID_KEY         ASCII     945  85    
TEST_NAME      ASCII    1030  62    
c_QUOTED_INV_ID COMPUTED             
 *C 52 1 
 "'"+ ALLTRIM(Inv_No) + "'"
^LAYOUT   AP004_Dup_Amt_Dt_Vndr              1100 D.T,
!"VMF_Vnd_Master_File" "IDX_VndrSiteID" Vndr_Site_ID
Flag           ASCII       1   1    
DUP_KEY        ASCII       2  72    
CREDIT_KEY     ASCII      74  40    
Vndr_Site_ID   ASCII     114  20    
Vndr_ID        ASCII     134  20    
Vchr_ID        ASCII     154  10    
ABS_INVAMT     ACL       164  12 0  
isPaid         ASCII     176   1    
Doc_Typ        ASCII     177  10    
Inv_Dt         DATETIME  187   8   PICTURE "YYYYMMDD"  
Inv_No         ASCII     195  50    
Inv_Amt        ACL       245  12 2  
Inv_Amt_Doc    ACL       257  12 2  
Curncy         ASCII     269  15    
Inv_Net_Amt    ACL       284  12 2  
GST_Amt        ACL       296  12 2  
Btch_No        ASCII     308  15    
Due_Dt         DATETIME  323   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     331  21    
PO_Net_Amt     ACL       352  12 2  
Descrp         ASCII     364  31    
Pd_Dt          DATETIME  395   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     403  21    
Modf_By        ASCII     424  15    
Modf_Dt        DATETIME  439   8   PICTURE "YYYYMMDD"  
Pst_Dt         DATETIME  447   8   PICTURE "YYYYMMDD"  
Ex_Rate        ACL       455  12 2  
VOIDED         ASCII     467   1    
Void_Dt        DATETIME  468   8   PICTURE "YYYYMMDD"  
Num_Field1     ACL       476  12 2  
Num_Field2     ACL       488  12 2  
Num_Field3     ACL       500  12 2  
Num_Field4     ACL       512  12 2  
Num_Field5     ACL       524  12 2  
Dt_Field1      DATETIME  536   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  544   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  552   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     560  20    
Cha_Field2     ASCII     580  20    
Cha_Field3     ASCII     600  20    
Cha_Field4     ASCII     620  20    
Cha_Field5     ASCII     640  20    
c_Inv_No       ASCII     660  20    Srt Inv_No
c_Inv_Dt       ASCII     680   8    
Vndr_Mstr_ID   ASCII     688  20    
Vndr_Nme       ASCII     708  73    
Vndr_Sts       ASCII     781   1    
Vndr_Typ       ASCII     782  11    
RANK           ASCII     793   1    
SORT_KEY_Desc  ASCII     874  46    
RptRunDate     DATETIME  921   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Data_Range_Start_Date DATETIME  929   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME  937   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
ID_KEY         ASCII     945  85    
TEST_NAME      ASCII    1030  71    
ABS_INVAMT_CENT COMPUTED             
 *N 4 2
 VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21)),4) IF OCCURS(ALLTRIM(STRING(ABS(Inv_Amt),21)),".")>=0
 VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21 )),4)
SORT_KEY       COMPUTED             
 *C 64 1 
 SUBSTR(ZONED(ABS_INVAMT_CENT,21) +"~"+ ALLTRIM(Flag) +"~"+ ALLTRIM(Vndr_ID) +"~"+ ALLTRIM(c_Inv_Dt),1,64)
Priority       COMPUTED             
 *C 1 1 
 "M"
c_QUOTED_INV_ID COMPUTED             
 *C 52 1 
 "'"+ ALLTRIM(Inv_No) + "'"
^LAYOUT   AP006_Pay_Not_In_VMF               987 D.T,
Vchr_ID        ASCII       1  10    
Vndr_Site_ID   ASCII      11  20    
Vndr_ID        ASCII      31  20    
Doc_Typ        ASCII      51  10    
Inv_Dt         DATETIME   61   8   PICTURE "YYYYMMDD" WIDTH 27  
Inv_No         ASCII      69  50    
Inv_Amt        ACL       119  12 2  
Inv_Amt_Doc    ACL       131  12 2  
Curncy         ASCII     143  15    
Ex_Rate        ACL       158  12 2  
Inv_Net_Amt    ACL       170  12 2  
GST_Amt        ACL       182  12 2  
Btch_No        ASCII     194  15    
Due_Dt         DATETIME  209   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     217  21    
PO_Net_Amt     ACL       238  12 2  
Descrp         ASCII     250  31    
Pd_Dt          DATETIME  281   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     289  21    
Modf_Dt        DATETIME  310   8   PICTURE "YYYYMMDD"  
Modf_By        ASCII     318  15    
Pst_Dt         DATETIME  333   8   PICTURE "YYYYMMDD"  
VOIDED         ASCII     341   1    
Void_Dt        DATETIME  342   8   PICTURE "YYYYMMDD"  
isPaid         ASCII     350   1    
Num_Field1     ACL       351  12 2  
Num_Field2     ACL       363  12 2  
Num_Field3     ACL       375  12 2  
Num_Field4     ACL       387  12 2  
Num_Field5     ACL       399  12 2  
Dt_Field1      DATETIME  411   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  419   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  427   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     435  20    
Cha_Field2     ASCII     455  20    
Cha_Field3     ASCII     475  20    
Cha_Field4     ASCII     495  20    
Cha_Field5     ASCII     515  20    
c_Inv_No2      ASCII     535  50    
c_Inv_No       ASCII     585  20    Srt Inv_No
ABS_INVAMT     ACL       605  12 0  
ABS_INVAMT_CENT ACL       617  12 4  
c_Inv_Dt       ASCII     629   8    
Vndr_Mstr_ID   ASCII     637  20    
Vndr_Nme       ASCII     657  73    
Vndr_Sts       ASCII     730   1    
Vndr_Typ       ASCII     731  11    
ID_KEY         ASCII     742  85    
SORT_KEY       ASCII     827  42    
SORT_KEY_Desc  ASCII     869  29    
Priority       ASCII     898   1    
RptRunDate     DATETIME  899   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Data_Range_Start_Date DATETIME  907   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME  915   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
TEST_NAME      ASCII     923  65    
c_QUOTED_INV_ID COMPUTED             
 *C 52 1 
 "'"+ ALLTRIM(Inv_No) + "'"
^LAYOUT   Data_VMF_Lst                       316 D.T,
FILE_NAME      ASCII       1 256   AS "FileName" WIDTH 35  
FILE_SIZE      ACL       257  12 0 AS "File;Size" WIDTH 16  
FILE_ATTRIBUTES ASCII     269   6   AS "Attributes"  
FILE_CREATE_DATE DATETIME  275   8   PICTURE "YYYYMMDD" AS "Create;Date"  
FILE_CREATE_TIME DATETIME  283   6   PICTURE "hhmmss" AS "Create;Time" WIDTH 14  
FILE_ACCESS_DATE DATETIME  289   8   PICTURE "YYYYMMDD" AS "Access;Date"  
FILE_ACCESS_TIME DATETIME  297   6   PICTURE "hhmmss" AS "Access;Time" WIDTH 14  
FILE_WRITE_DATE DATETIME  303   8   PICTURE "YYYYMMDD" AS "Modified;Date"  
FILE_WRITE_TIME DATETIME  311   6   PICTURE "hhmmss" AS "Modified;Time" WIDTH 14  
^LAYOUT   Data_VMBnk_Lst                     316 D.T,
FILE_NAME      ASCII       1 256   AS "FileName" WIDTH 35  
FILE_SIZE      ACL       257  12 0 AS "File;Size" WIDTH 16  
FILE_ATTRIBUTES ASCII     269   6   AS "Attributes"  
FILE_CREATE_DATE DATETIME  275   8   PICTURE "YYYYMMDD" AS "Create;Date"  
FILE_CREATE_TIME DATETIME  283   6   PICTURE "hhmmss" AS "Create;Time" WIDTH 14  
FILE_ACCESS_DATE DATETIME  289   8   PICTURE "YYYYMMDD" AS "Access;Date"  
FILE_ACCESS_TIME DATETIME  297   6   PICTURE "hhmmss" AS "Access;Time" WIDTH 14  
FILE_WRITE_DATE DATETIME  303   8   PICTURE "YYYYMMDD" AS "Modified;Date"  
FILE_WRITE_TIME DATETIME  311   6   PICTURE "hhmmss" AS "Modified;Time" WIDTH 14  
^LAYOUT   Data_Inv_Lst                       316 D.T,
FILE_NAME      ASCII       1 256   AS "FileName" WIDTH 35  
FILE_SIZE      ACL       257  12 0 AS "File;Size" WIDTH 16  
FILE_ATTRIBUTES ASCII     269   6   AS "Attributes"  
FILE_CREATE_DATE DATETIME  275   8   PICTURE "YYYYMMDD" AS "Create;Date"  
FILE_CREATE_TIME DATETIME  283   6   PICTURE "hhmmss" AS "Create;Time" WIDTH 14  
FILE_ACCESS_DATE DATETIME  289   8   PICTURE "YYYYMMDD" AS "Access;Date"  
FILE_ACCESS_TIME DATETIME  297   6   PICTURE "hhmmss" AS "Access;Time" WIDTH 14  
FILE_WRITE_DATE DATETIME  303   8   PICTURE "YYYYMMDD" AS "Modified;Date"  
FILE_WRITE_TIME DATETIME  311   6   PICTURE "hhmmss" AS "Modified;Time" WIDTH 14  
^LAYOUT   Lst_Fld                            316 D.T,
FILE_NAME      ASCII       1 256   AS "FileName" WIDTH 35  
FILE_SIZE      ACL       257  12 0 AS "File;Size" WIDTH 16  
FILE_ATTRIBUTES ASCII     269   6   AS "Attributes"  
FILE_CREATE_DATE DATETIME  275   8   PICTURE "YYYYMMDD" AS "Create;Date"  
FILE_CREATE_TIME DATETIME  283   6   PICTURE "hhmmss" AS "Create;Time" WIDTH 14  
FILE_ACCESS_DATE DATETIME  289   8   PICTURE "YYYYMMDD" AS "Access;Date"  
FILE_ACCESS_TIME DATETIME  297   6   PICTURE "hhmmss" AS "Access;Time" WIDTH 14  
FILE_WRITE_DATE DATETIME  303   8   PICTURE "YYYYMMDD" AS "Modified;Date"  
FILE_WRITE_TIME DATETIME  311   6   PICTURE "hhmmss" AS "Modified;Time" WIDTH 14  
c_Folder       COMPUTED             
 *C 20 1 
 SUBSTR(REPLACE(ALLTRIM(REPLACE(FILE_NAME,'E:\Data\Invoices_','')),'.txt',''),1,20)
^LAYOUT   AP_INVOICES_ALL                    822 D.T,
INVOICE_ID     ASCII       1  10    
COUNT          ACL        11  12 0 WIDTH 8  
VENDOR_ID      ASCII      23  20    
VENDOR_SITE_ID ASCII      43  20    
INVOICE_NUM    ASCII      63  50    
INVOICE_TYPE   ASCII     113  10    
INVOICE_DATE   ASCII     123  10    
INVOICE_AMOUNT ASCII     133  12    
DESCRIPTION    ASCII     145 500    
CHARGECODE     ASCII     645  35    
PAYMENT_STATUS_FLAG ASCII     680  20    
CANCELLED_DATE ASCII     700  20    
GST_STATUS     ASCII     720  20    
APPROVAL_STATUS ASCII     740  30    
SourceFlag     ASCII     770   3    
File_Name      ASCII     773  50    
c_MONTH        COMPUTED             
 *C 2 13 
 "01" IF SUBSTR(INVOICE_DATE,4,3) = 'JAN' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "02" IF SUBSTR(INVOICE_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "03" IF SUBSTR(INVOICE_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "04" IF SUBSTR(INVOICE_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "05" IF SUBSTR(INVOICE_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "06" IF SUBSTR(INVOICE_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "07" IF SUBSTR(INVOICE_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "08" IF SUBSTR(INVOICE_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "09" IF SUBSTR(INVOICE_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "10" IF SUBSTR(INVOICE_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "11" IF SUBSTR(INVOICE_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "12" IF SUBSTR(INVOICE_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "00"
c_DAY          COMPUTED             
 *C 2 1 
 SUBSTR(INVOICE_DATE,1,2)
c_YEAR         COMPUTED             
 *C 4 2 
 "20"+ SUBSTR(INVOICE_DATE,8,2) IF  LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 SUBSTR(INVOICE_DATE,6,4)
c_INVOICE_DATE_CLN COMPUTED             
 *C 10 1 
 c_DAY + '/' + c_MONTH + '/' + c_YEAR
c_INVOICE_DATE COMPUTED            WIDTH 27  
 *D 2 16
 CTOD(c_INVOICE_DATE_CLN ,'DD/MM/YYYY' ) IF LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 CTOD(INVOICE_DATE ,'DD/MM/YYYY' )
c_INVOICE_AMOUNT COMPUTED             
 *N 2 1
 VALUE(INVOICE_AMOUNT,2)
c_MONTH1       COMPUTED             
 *C 2 13 
 "01" IF SUBSTR(CANCELLED_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "02" IF SUBSTR(CANCELLED_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "03" IF SUBSTR(CANCELLED_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "04" IF SUBSTR(CANCELLED_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "05" IF SUBSTR(CANCELLED_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "06" IF SUBSTR(CANCELLED_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "07" IF SUBSTR(CANCELLED_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "08" IF SUBSTR(CANCELLED_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "09" IF SUBSTR(CANCELLED_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "10" IF SUBSTR(CANCELLED_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "11" IF SUBSTR(CANCELLED_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "12" IF SUBSTR(CANCELLED_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "00"
c_DAY1         COMPUTED             
 *C 2 1 
 SUBSTR(CANCELLED_DATE,1,2)
c_YEAR1        COMPUTED             
 *C 4 3 
 "20"+ SUBSTR(CANCELLED_DATE,8,2) IF LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(INVOICE_DATE,8,2),0) <= 30
 "19"+ SUBSTR(CANCELLED_DATE,8,2) IF LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(INVOICE_DATE,8,2),0) > 30
 SUBSTR(CANCELLED_DATE,6,4)
c_CANCELLED_DATE_CLN COMPUTED             
 *C 10 1 
 c_DAY1 + '/' + c_MONTH1 + '/' + c_YEAR1
c_CANCELLED_DATE COMPUTED            WIDTH 27  
 *D 2 16
 CTOD(c_CANCELLED_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 CTOD(CANCELLED_DATE ,'DD/MM/YYYY' )
^LAYOUT   AP_VendorMaster_ALL                822 D.T,
VENDOR_ID_     ASCII       1  20    
VENDOR_NUMBER  ASCII      21  20    
VENDOR_NAME    ASCII      41 100    
VENDOR_SITE_ID ASCII     141  20    
VENDOR_SITE    ASCII     161  30    
VENDOR_ADDRESS ASCII     191 133    
CITY           ASCII     324  35    
STATE          ASCII     359  18    
POSTCODE       ASCII     377  13    
COUNTRY        ASCII     390  10    
HEADER_INACTIVE_DATE ASCII     400  20    
SITE_INACTIVE_DATE ASCII     420  20    
VENDOR_ABN     ASCII     440  20    
GST_REGISTRATION_STATUS ASCII     460  35    
AREA_CODE      ASCII     495  10    
PHONE          ASCII     505  25    
FAX            ASCII     530  25    
EMAIL_ADDRESS  ASCII     555 100    
VENDOR_TYPE    ASCII     655  23    
PAYMENT_METHOD ASCII     678  15    
HEADER_CREATION_DATE ASCII     693  20    
SITE_CREATION_DATE ASCII     713  20    
HEADER_LAST_UPDATE_DATE ASCII     733  20    
SITE_LAST_UPDATE_DATE ASCII     753  20    
File_Name      ASCII     773  50    
c_VENDOR_ID    COMPUTED             
 *C 20 1 
 REPLACE(ALLTRIM(VENDOR_ID_),'~','')
c_MONTH2       COMPUTED             
 *C 2 13 
 "01" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "02" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "03" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "04" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "05" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "06" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "07" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "08" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "09" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "10" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "11" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "12" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "00"
c_DAY2         COMPUTED             
 *C 2 1 
 SUBSTR(HEADER_INACTIVE_DATE,1,2)
c_YEAR2        COMPUTED             
 *C 4 3 
 "20"+ SUBSTR(HEADER_INACTIVE_DATE,8,2) IF LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(HEADER_INACTIVE_DATE,8,2),0) <= 30
 "19"+ SUBSTR(HEADER_INACTIVE_DATE,8,2) IF LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(HEADER_INACTIVE_DATE,8,2),0) > 30
 SUBSTR(HEADER_INACTIVE_DATE,6,4)
c_HEADER_INACTIVE_DATE_CLN COMPUTED             
 *C 10 1 
 c_DAY2 + '/' + c_MONTH2 + '/' + c_YEAR2
c_HEADER_INACTIVE_DATE COMPUTED            WIDTH 27  
 *D 2 16
 CTOD(c_HEADER_INACTIVE_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 CTOD(c_HEADER_INACTIVE_DATE_CLN ,'DD/MM/YYYY' )
c_MONTH3       COMPUTED             
 *C 2 13 
 "01" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "02" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "03" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "04" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "05" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "06" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "07" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "08" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "09" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "10" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "11" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "12" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "00"
c_DAY3         COMPUTED             
 *C 2 1 
 SUBSTR(SITE_INACTIVE_DATE,1,2)
c_YEAR3        COMPUTED             
 *C 4 3 
 "20"+ SUBSTR(SITE_INACTIVE_DATE,8,2) IF LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(SITE_INACTIVE_DATE,8,2),0) <= 30
 "19"+ SUBSTR(SITE_INACTIVE_DATE,8,2) IF LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(SITE_INACTIVE_DATE,8,2),0) > 30
 SUBSTR(SITE_INACTIVE_DATE,6,4)
c_SITE_INACTIVE_DATE_CLN COMPUTED             
 *C 10 1 
 c_DAY3 + '/' + c_MONTH3 + '/' + c_YEAR3
c_SITE_INACTIVE_DATE COMPUTED            WIDTH 27  
 *D 2 16
 CTOD(c_SITE_INACTIVE_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 CTOD(c_SITE_INACTIVE_DATE_CLN ,'DD/MM/YYYY' )
c_MONTH4       COMPUTED             
 *C 2 13 
 "01" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "02" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "03" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "04" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "05" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "06" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "07" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "08" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "09" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "10" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "11" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "12" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "00"
c_DAY4         COMPUTED             
 *C 2 1 
 SUBSTR(HEADER_CREATION_DATE,1,2)
c_YEAR4        COMPUTED             
 *C 4 3 
 "20"+ SUBSTR(HEADER_CREATION_DATE,8,2) IF LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(HEADER_CREATION_DATE,8,2),0) <= 30
 "19"+ SUBSTR(HEADER_CREATION_DATE,8,2) IF LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(HEADER_CREATION_DATE,8,2),0) > 30
 SUBSTR(HEADER_CREATION_DATE,6,4)
c_HEADER_CREATION_DATE_CLN COMPUTED             
 *C 10 1 
 c_DAY4 + '/' + c_MONTH4 + '/' + c_YEAR4
c_HEADER_CREATION_DATE COMPUTED            WIDTH 27  
 *D 2 16
 CTOD(c_HEADER_CREATION_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 CTOD(c_HEADER_CREATION_DATE_CLN ,'DD/MM/YYYY' )
c_MONTH5       COMPUTED             
 *C 2 13 
 "01" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "02" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "03" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "04" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "05" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "06" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "07" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "08" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "09" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "10" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "11" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "12" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "00"
c_DAY5         COMPUTED             
 *C 2 1 
 SUBSTR(SITE_CREATION_DATE,1,2)
c_YEAR5        COMPUTED             
 *C 4 3 
 "20"+ SUBSTR(SITE_CREATION_DATE,8,2) IF LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(SITE_CREATION_DATE,8,2),0) <= 30
 "19"+ SUBSTR(SITE_CREATION_DATE,8,2) IF LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(SITE_CREATION_DATE,8,2),0) > 30
 SUBSTR(SITE_CREATION_DATE,6,4)
c_SITE_CREATION_DATE_CLN COMPUTED             
 *C 10 1 
 c_DAY5 + '/' + c_MONTH5 + '/' + c_YEAR5
c_SITE_CREATION_DATE COMPUTED            WIDTH 27  
 *D 2 16
 CTOD(c_SITE_CREATION_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 CTOD(c_SITE_CREATION_DATE_CLN ,'DD/MM/YYYY' )
c_MONTH8       COMPUTED             
 *C 2 13 
 "01" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "02" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "03" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "04" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "05" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "06" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "07" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "08" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "09" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "10" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "11" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "12" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "00"
c_DAY8         COMPUTED             
 *C 2 1 
 SUBSTR(HEADER_LAST_UPDATE_DATE,1,2)
c_YEAR8        COMPUTED             
 *C 4 3 
 "20"+ SUBSTR(HEADER_LAST_UPDATE_DATE,8,2) IF LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(HEADER_LAST_UPDATE_DATE,8,2),0) <= 30
 "19"+ SUBSTR(HEADER_LAST_UPDATE_DATE,8,2) IF LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(HEADER_LAST_UPDATE_DATE,8,2),0) > 30
 SUBSTR(HEADER_LAST_UPDATE_DATE,6,4)
c_HEADER_LAST_UPDATE_DATE_CLN COMPUTED             
 *C 10 1 
 c_DAY8 + '/' + c_MONTH8 + '/' + c_YEAR8
c_HEADER_LAST_UPDATE_DATE COMPUTED            WIDTH 27  
 *D 2 16
 CTOD(c_HEADER_LAST_UPDATE_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 CTOD(c_HEADER_LAST_UPDATE_DATE_CLN ,'DD/MM/YYYY' )
c_MONTH9       COMPUTED             
 *C 2 13 
 "01" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "02" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "03" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "04" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "05" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "06" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "07" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "08" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "09" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "10" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "11" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "12" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "00"
c_DAY9         COMPUTED             
 *C 2 1 
 SUBSTR(SITE_LAST_UPDATE_DATE,1,2)
c_YEAR9        COMPUTED             
 *C 4 3 
 "20"+ SUBSTR(SITE_LAST_UPDATE_DATE,8,2) IF LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(SITE_LAST_UPDATE_DATE,8,2),0) <= 30
 "19"+ SUBSTR(SITE_LAST_UPDATE_DATE,8,2) IF LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(SITE_LAST_UPDATE_DATE,8,2),0) > 30
 SUBSTR(SITE_LAST_UPDATE_DATE,6,4)
c_SITE_LAST_UPDATE_DATE_CLN COMPUTED             
 *C 10 1 
 c_DAY9 + '/' + c_MONTH9 + '/' + c_YEAR9
c_SITE_LAST_UPDATE_DATE COMPUTED            WIDTH 27  
 *D 2 16
 CTOD(c_SITE_LAST_UPDATE_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 CTOD(c_SITE_LAST_UPDATE_DATE_CLN ,'DD/MM/YYYY' )
c_VENDOR_STATUS COMPUTED             c_VENDOR_STATUS
 *C 1 3 
 "A" IF c_HEADER_INACTIVE_DATE = `19000101` AND c_SITE_INACTIVE_DATE = `19000101`
 "A" IF (c_HEADER_INACTIVE_DATE > TODAY()) OR (c_SITE_INACTIVE_DATE > TODAY())
 "I"
c_Tel          COMPUTED             
 *C 35 1 
 INCLUDE(AREA_CODE,'0123456789') + INCLUDE(PHONE,'0123456789')
c_Fax          COMPUTED             
 *C 35 1 
 INCLUDE(AREA_CODE,'0123456789') + INCLUDE(FAX,'0123456789')
^LAYOUT   AP_VendorMasterBnkAcc_ALL          243 D.T,
_VENDOR_SITE_ID_ ASCII       1  16    
VENDOR_ID__    ASCII      17  11    
_VENDOR_BSB_   ASCII      28  12    
_VENDOR_BANK_ACCOUNT_NUMBER_ ASCII      40  28    
COUNT          ACL        68  12 0 WIDTH 8  
_VENDOR_BANK_ACCT_NAME_ ASCII      80  48    
_ACCT_START_DATE_ ASCII     128  22    
_ACCT_END_DATE ASCII     150  22    
LAST_UPDATE_DATE ASCII     172  22    
File_Name      ASCII     194  50    
c_VENDOR_ID    COMPUTED             
 *C 11 1 
 REPLACE(ALLTRIM(VENDOR_ID__),'~','')
c_MONTH6       COMPUTED             
 *C 2 13 
 "01" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'JAN' AND  LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "02" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'FEB' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "03" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'MAR' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "04" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'APR' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "05" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'MAY' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "06" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'JUN' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "07" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'JUL' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "08" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'AUG' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "09" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'SEP' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "10" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'OCT' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "11" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'NOV' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "12" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'DEC' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "00"
c_DAY6         COMPUTED             
 *C 2 1 
 SUBSTR(_ACCT_START_DATE_,1,2)
c_YEAR6        COMPUTED             
 *C 4 3 
 "20"+ SUBSTR(_ACCT_START_DATE_,8,2) IF LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(_ACCT_START_DATE_,8,2),0) <= 30
 "19"+ SUBSTR(_ACCT_START_DATE_,8,2) IF LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(_ACCT_START_DATE_,8,2),0) > 30
 SUBSTR(_ACCT_START_DATE_,6,4)
c_ACCT_START_DATE_CLN COMPUTED             
 *C 10 1 
 c_DAY6 + '/' + c_MONTH6 + '/' + c_YEAR6
c_ACCT_START_DATE COMPUTED            WIDTH 27  
 *D 2 16
 CTOD(c_ACCT_START_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 CTOD(c_ACCT_START_DATE_CLN ,'DD/MM/YYYY' )
c_MONTH7       COMPUTED             
 *C 2 13 
 "01" IF SUBSTR(_ACCT_END_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "02" IF SUBSTR(_ACCT_END_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "03" IF SUBSTR(_ACCT_END_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "04" IF SUBSTR(_ACCT_END_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "05" IF SUBSTR(_ACCT_END_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "06" IF SUBSTR(_ACCT_END_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "07" IF SUBSTR(_ACCT_END_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "08" IF SUBSTR(_ACCT_END_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "09" IF SUBSTR(_ACCT_END_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "10" IF SUBSTR(_ACCT_END_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "11" IF SUBSTR(_ACCT_END_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "12" IF SUBSTR(_ACCT_END_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "00"
c_DAY7         COMPUTED             
 *C 2 1 
 SUBSTR(_ACCT_END_DATE,1,2)
c_YEAR7        COMPUTED             
 *C 4 3 
 "20"+ SUBSTR(_ACCT_END_DATE,8,2) IF LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(_ACCT_END_DATE,8,2),0) <= 30
 "19"+ SUBSTR(_ACCT_END_DATE,8,2) IF LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(_ACCT_END_DATE,8,2),0) > 30
 SUBSTR(_ACCT_END_DATE,6,4)
c_ACCT_END_DATE_CLN COMPUTED             
 *C 10 1 
 c_DAY7 + '/' + c_MONTH7 + '/' + c_YEAR7
c_ACCT_END_DATE COMPUTED            WIDTH 27  
 *D 2 16
 CTOD(c_ACCT_END_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 CTOD(c_ACCT_END_DATE_CLN ,'DD/MM/YYYY' )
c_MONTH10      COMPUTED             
 *C 2 13 
 "01" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "02" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "03" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "04" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "05" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "06" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "07" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "08" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "09" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "10" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "11" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "12" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 "00"
c_DAY10        COMPUTED             
 *C 2 1 
 SUBSTR(LAST_UPDATE_DATE,1,2)
c_YEAR10       COMPUTED             
 *C 4 3 
 "20"+ SUBSTR(LAST_UPDATE_DATE,8,2) IF LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(LAST_UPDATE_DATE,8,2),0) <= 30
 "19"+ SUBSTR(LAST_UPDATE_DATE,8,2) IF LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(LAST_UPDATE_DATE,8,2),0) > 30
 SUBSTR(LAST_UPDATE_DATE,6,4)
c_LAST_UPDATE_DATE_CLN COMPUTED             
 *C 10 1 
 c_DAY10 + '/' + c_MONTH10 + '/' + c_YEAR10
c_LAST_UPDATE_DATE COMPUTED            WIDTH 27  
 *D 2 16
 CTOD(c_LAST_UPDATE_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
 CTOD(c_LAST_UPDATE_DATE_CLN ,'DD/MM/YYYY' )
^LAYOUT   AP_VendorMaster_ALL_FMT            1072 D.T,
VENDOR_ID_     ASCII       1  20    
VENDOR_NUMBER  ASCII      21  20    
VENDOR_NAME    ASCII      41 100    
VENDOR_SITE_ID ASCII     141  20    
VENDOR_SITE    ASCII     161  30    
VENDOR_ADDRESS ASCII     191 133    
CITY           ASCII     324  35    
STATE          ASCII     359  18    
POSTCODE       ASCII     377  13    
COUNTRY        ASCII     390  10    
HEADER_INACTIVE_DATE ASCII     400  20    
SITE_INACTIVE_DATE ASCII     420  20    
VENDOR_ABN     ASCII     440  20    
GST_REGISTRATION_STATUS ASCII     460  35    
AREA_CODE      ASCII     495  10    
PHONE          ASCII     505  25    
FAX            ASCII     530  25    
EMAIL_ADDRESS  ASCII     555 100    
VENDOR_TYPE    ASCII     655  23    
PAYMENT_METHOD ASCII     678  15    
HEADER_CREATION_DATE ASCII     693  20    
SITE_CREATION_DATE ASCII     713  20    
HEADER_LAST_UPDATE_DATE ASCII     733  20    
SITE_LAST_UPDATE_DATE ASCII     753  20    
File_Name      ASCII     773  50    
c_VENDOR_ID    ASCII     823  20    
c_MONTH2       ASCII     843   2    
c_DAY2         ASCII     845   2    
c_YEAR2        ASCII     847   4    
c_HEADER_INACTIVE_DATE_CLN ASCII     851  10    
c_HEADER_INACTIVE_DATE DATETIME  861   8   PICTURE "YYYYMMDD" WIDTH 27  
c_MONTH3       ASCII     869   2    
c_DAY3         ASCII     871   2    
c_YEAR3        ASCII     873   4    
c_SITE_INACTIVE_DATE_CLN ASCII     877  10    
c_SITE_INACTIVE_DATE DATETIME  887   8   PICTURE "YYYYMMDD" WIDTH 27  
c_MONTH4       ASCII     895   2    
c_DAY4         ASCII     897   2    
c_YEAR4        ASCII     899   4    
c_HEADER_CREATION_DATE_CLN ASCII     903  10    
c_HEADER_CREATION_DATE DATETIME  913   8   PICTURE "YYYYMMDD" WIDTH 27  
c_MONTH5       ASCII     921   2    
c_DAY5         ASCII     923   2    
c_YEAR5        ASCII     925   4    
c_SITE_CREATION_DATE_CLN ASCII     929  10    
c_SITE_CREATION_DATE DATETIME  939   8   PICTURE "YYYYMMDD" WIDTH 27  
c_MONTH8       ASCII     947   2    
c_DAY8         ASCII     949   2    
c_YEAR8        ASCII     951   4    
c_HEADER_LAST_UPDATE_DATE_CLN ASCII     955  10    
c_HEADER_LAST_UPDATE_DATE DATETIME  965   8   PICTURE "YYYYMMDD" WIDTH 27  
c_MONTH9       ASCII     973   2    
c_DAY9         ASCII     975   2    
c_YEAR9        ASCII     977   4    
c_SITE_LAST_UPDATE_DATE_CLN ASCII     981  10    
c_SITE_LAST_UPDATE_DATE DATETIME  991   8   PICTURE "YYYYMMDD" WIDTH 27  
c_VENDOR_STATUS ASCII     999   1    c_VENDOR_STATUS
c_Tel          ASCII    1000  35    
c_Fax          ASCII    1035  35    
SourceFlag     ASCII    1070   3    
^LAYOUT   AP_VendorMasterBnkAcc_ALL_FMT      227 D.T,
VENDOR_ID      ASCII       1  20    
VENDOR_SITE_ID ASCII      21  20    
VENDOR_BANK_ACCT_NAME ASCII      41  60    
VENDOR_BSB     ASCII     101  20    
VENDOR_BANK_ACCOUNT_NUMBER ASCII     121  30    
ACCT_START_DATE DATETIME  151   8   PICTURE "YYYYMMDD" WIDTH 27  
ACCT_END_DATE  DATETIME  159   8   PICTURE "YYYYMMDD" WIDTH 27  
LAST_UPDATE_DATE DATETIME  167   8   PICTURE "YYYYMMDD" WIDTH 27  
SourceFlag     ASCII     175   3    
File_Name      ASCII     178  50    
^LAYOUT   Tmp_Chg                            174 D.T,
Vndr_Site_ID   ASCII       1  16    
Vndr_ID        ASCII      17  11    
BSB            ASCII      28  12    
Bnk_Acc_Num    ASCII      40  28    
BSB_NAME       ASCII      68  12    
Bnk_Acc_Name   ASCII      80  48    
Bnk_Acc_Type   ASCII     128  20    
Chg_Dt         DATETIME  148   8   PICTURE "YYYYMMDD"  
RptRunDateTime ASCII     156  19    
^LAYOUT   VMF_BnkAcc_Chg_History             174 D.T,
Vndr_Site_ID   ASCII       1  16    
Vndr_ID        ASCII      17  11    
BSB            ASCII      28  12    
Bnk_Acc_Num    ASCII      40  28    
BSB_NAME       ASCII      68  12    
Bnk_Acc_Name   ASCII      80  48    
Bnk_Acc_Type   ASCII     128  20    
Chg_Dt         DATETIME  148   8   PICTURE "YYYYMMDD"  
RptRunDateTime ASCII     156  19    
^LAYOUT   AP_INVOICES_ALL_FMT                813 D.T,
VENDOR_ID      ASCII       1  20    
VENDOR_SITE_ID ASCII      21  20    
INVOICE_ID     ASCII      41  10    
INVOICE_DATE   DATETIME   51   8   PICTURE "YYYYMMDD" WIDTH 27  
INVOICE_NUM    ASCII      59  50    
INVOICE_AMOUNT ACL       109  12 2  
DESCRIPTION    ASCII     121 500    
INVOICE_TYPE   ASCII     621  10    
CHARGECODE     ASCII     631  40    
PAYMENT_STATUS_FLAG ASCII     671  20    
CANCELLED_DATE ASCII     691  20    
GST_STATUS     ASCII     711  20    
APPROVAL_STATUS ASCII     731  30    
SourceFlag     ASCII     761   3    
File_Name      ASCII     764  50    
^LAYOUT   AP_InvPO                           40 D.T,
Vchr_ID        ASCII       1  20    
PO_NO          ASCII      21  20    
^LAYOUT   AP_Invoice_Credits                 741 D.T,
Vchr_ID        ASCII       1  10    
Vndr_Site_ID   ASCII      11  20    
Vndr_ID        ASCII      31  20    
Doc_Typ        ASCII      51  10    
Inv_Dt         DATETIME   61   8   PICTURE "YYYYMMDD" WIDTH 27  
Inv_No         ASCII      69  50    
Inv_Amt        ACL       119  12 2  
Inv_Amt_Doc    ACL       131  12 2  
Curncy         ASCII     143  15    
Ex_Rate        ACL       158  12 2  
Inv_Net_Amt    ACL       170  12 2  
GST_Amt        ACL       182  12 2  
Btch_No        ASCII     194  15    
Due_Dt         DATETIME  209   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     217  21    
PO_Net_Amt     ACL       238  12 2  
Descrp         ASCII     250  31    
Pd_Dt          DATETIME  281   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     289  21    
Modf_Dt        DATETIME  310   8   PICTURE "YYYYMMDD"  
Modf_By        ASCII     318  15    
Pst_Dt         DATETIME  333   8   PICTURE "YYYYMMDD"  
VOIDED         ASCII     341   1    
Void_Dt        DATETIME  342   8   PICTURE "YYYYMMDD"  
isPaid         ASCII     350   1    
Num_Field1     ACL       351  12 2  
Num_Field2     ACL       363  12 2  
Num_Field3     ACL       375  12 2  
Num_Field4     ACL       387  12 2  
Num_Field5     ACL       399  12 2  
Dt_Field1      DATETIME  411   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  419   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  427   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     435  20    
Cha_Field2     ASCII     455  20    
Cha_Field3     ASCII     475  20    
Cha_Field4     ASCII     495  20    
Cha_Field5     ASCII     515  20    
c_Inv_No2      ASCII     535  50    
c_Inv_No       ASCII     585  20    Srt Inv_No
ABS_INVAMT     ACL       605  12 0  
ABS_INVAMT_CENT ACL       617  12 4  
c_Inv_Dt       ASCII     629   8    
Vndr_Mstr_ID   ASCII     637  20    
Vndr_Nme       ASCII     657  73    
Vndr_Sts       ASCII     730   1    
Vndr_Typ       ASCII     731  11    
^LAYOUT   AP_VndSite_InvGst_Sum              200 D.T,
Vndr_Site_ID   ASCII       1  20    
Vndr_ID        ASCII      21  20    
Inv_Amt        ACL        41  12 2  
GST_Amt        ACL        53  12 2  
InvAmt_Pos     ACL        65  12 2  
GSTAmt_Pos     ACL        77  12 2  
Cnt_Pos        ACL        89  12 0  
InvAmt_24M     ACL       101  12 2  
GSTAmt_24M     ACL       113  12 2  
Cnt_24M        ACL       125  12 0  
InvAmt_12M     ACL       137  12 2  
GSTAmt_12M     ACL       149  12 2  
Cnt_12M        ACL       161  12 0  
COUNT          ACL       173  12 0 WIDTH 8  
Inv_Dt         DATETIME  185   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Inv_Dt       ASCII     193   8    
^LAYOUT   AP_PO_Vnd_Sum                      137 D.T,
Vndr_Site_ID   ASCII       1  20    
Vndr_ID        ASCII      21  20    
PO_NO          ASCII      41  21    
Amount         ACL        62  12 2  
Rec_Amt        ACL        74  12 2  
PO_Qty         ACL        86  12 2  
Rec_Qty        ACL        98  12 2  
COUNT          ACL       110  12 0 WIDTH 8  
PO_Date        DATETIME  122   8   PICTURE "YYYYMMDD"  
Rec_Dt         DATETIME  130   8   PICTURE "YYYYMMDD"  
^LAYOUT   AP_Payments                        545 D.T,
!"VMF_Vnd_Master_File" "IDX_VndrSiteID" Vndr_Site_ID
Vchr_ID        ASCII       1  20    
Vndr_Site_ID   ASCII      21  20    
Vndr_ID        ASCII      41  20    
Doc_Typ        ASCII      61   2    
Pay_Dt         DATETIME   63   8   PICTURE "YYYYMMDD"  
Pay_No         ASCII      71  20    
Pay_Amt        ACL        91  12 2  
Pay_Amt_Doc    ACL       103  12 2  
Curncy         ASCII     115  15    
Ex_Rate        ACL       130  12 2  
Pay_Net_Amt    ACL       142  12 2  
GST_Amt        ACL       154  12 2  
Btch_No        ASCII     166  15    
Due_Dt         DATETIME  181   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     189  21    
PO_Net_Amt     ACL       210  12 2  
Descrp         ASCII     222  31    
Pd_Dt          DATETIME  253   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     261  21    
Modf_Dt        DATETIME  282   8   PICTURE "YYYYMMDD"  
Modf_By        ASCII     290  15    
Pst_Dt         DATETIME  305   8   PICTURE "YYYYMMDD"  
VOIDED         ASCII     313   1    
Void_Dt        DATETIME  314   8   PICTURE "YYYYMMDD"  
Chq_No         ASCII     322  20    
Pymnt_Mth      ASCII     342  20    
Num_Field1     ACL       362  12 2  
Num_Field2     ACL       374  12 2  
Num_Field3     ACL       386  12 2  
Num_Field4     ACL       398  12 2  
Num_Field5     ACL       410  12 2  
Dt_Field1      DATETIME  422   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  430   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  438   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     446  20    
Cha_Field2     ASCII     466  20    
Cha_Field3     ASCII     486  20    
Cha_Field4     ASCII     506  20    
Cha_Field5     ASCII     526  20    
c_Pay_No       COMPUTED             Srt Pay_No
 *C 20 2 
 ALLTRIM(STRING(VALUE(INCLUDE(Pay_No,"0123456789"),0),16)) IF LENGTH(ALLTRIM(INCLUDE(Pay_No,"0123456789")))>0
 ALLTRIM(INCLUDE(UPPER(Pay_No),"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"))
ABS_INVAMT     COMPUTED             
 *N 0 2
 VALUE(SPLIT(ALLTRIM(STRING(ABS(Pay_Amt),21)),".",1),0) IF OCCURS(ALLTRIM(STRING(ABS(Pay_Amt),21)),".")>=0
 VALUE(ALLTRIM(STRING(ABS(Pay_Amt),21 )),0)
c_Pay_Dt       COMPUTED             
 *C 8 1 
 ALLTRIM(SUBSTR(DATE(Pay_Dt),7,4))+ALLTRIM(SUBSTR(DATE(Pay_Dt),4,2))+ALLTRIM(SUBSTR(DATE(Pay_Dt),1,2))
Vndr_Mstr_ID   COMPUTED             
 *C 20 1 
 VMF_Vnd_Master_File.Vndr_Site_ID
Vndr_Nme       COMPUTED             
 *C 73 1 
 VMF_Vnd_Master_File.Vndr_Nme
Vndr_Sts       COMPUTED             
 *C 1 1 
 VMF_Vnd_Master_File.Vndr_Sts
Vndr_Typ       COMPUTED             
 *C 11 1 
 VMF_Vnd_Master_File.Vndr_Typ
^LAYOUT   AP_PO_Lines                        434 D.T,
!"VMF_Vnd_Master_File" "IDX_VndrSiteID" Vndr_Site_ID
Vndr_Site_ID   ASCII       1  20    
Vndr_ID        ASCII      21  20    
PO_NO          ASCII      41  21    
PO_Date        DATETIME   62   8   PICTURE "YYYYMMDD"  
Amount         ACL        70  12 2  
Net_Price      ACL        82  12 2  
PO_Qty         ACL        94  12 2  
Rec_Qty        ACL       106  12 2  
Rec_Amt        ACL       118  12 2  
Rec_Dt         DATETIME  130   8   PICTURE "YYYYMMDD"  
GST_AMT        ACL       138  12 2  
PO_Line_No     ASCII     150  21    
Item_Cd        ASCII     171  20    
Item_Desc      ASCII     191  60    
Num_Field1     ACL       251  12 2  
Num_Field2     ACL       263  12 2  
Num_Field3     ACL       275  12 2  
Num_Field4     ACL       287  12 2  
Num_Field5     ACL       299  12 2  
Dt_Field1      DATETIME  311   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  319   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  327   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     335  20    
Cha_Field2     ASCII     355  20    
Cha_Field3     ASCII     375  20    
Cha_Field4     ASCII     395  20    
Cha_Field5     ASCII     415  20    
^LAYOUT   GreyList_VM001                     80 D.T,
Vndr_ID        ASCII       1  20    
Vndr_Name      ASCII      21  60    
^LAYOUT   GreyList_VM002                     80 D.T,
Vndr_ID        ASCII       1  20    
Vndr_Name      ASCII      21  60    
^LAYOUT   GreyList_VM003                     80 D.T,
Vndr_ID        ASCII       1  20    
Vndr_Name      ASCII      21  60    
^LAYOUT   GreyList_VM005                     80 D.T,
Vndr_ID        ASCII       1  20    
Vndr_Name      ASCII      21  60    
^LAYOUT   VM001_History                      1396 D.T,
Vndr_Site_ID   ASCII       1  20    
Co             ASCII      21  20    
Vndr_ID        ASCII      41  20    
Vndr_Nme       ASCII      61  73    
ABN            ASCII     134  20    
Vndr_Sts       ASCII     154   1    
Vndr_Typ       ASCII     155  11    
Vndr_Add_Typ   ASCII     166  15    
ADD1           ASCII     181 125    
ADD2           ASCII     306  61    
ADD3           ASCII     367  61    
City           ASCII     428  35    
State          ASCII     463  29    
Pcode          ASCII     492  12    
Cntry          ASCII     504  61    
TEL1           ASCII     565  21    
TEL2           ASCII     586  21    
TEL3           ASCII     607  21    
FAX            ASCII     628  21    
Email1         ASCII     649  60    
Email2         ASCII     709  60    
Pymnt_Trm      ASCII     769  21    
Created_Dt     DATETIME  790   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  798   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  806   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     814  30    
Cha_Field2     ASCII     844  30    
Cha_Field3     ASCII     874   3    
Cha_Field4     ASCII     877  20    
Cha_Field5     ASCII     897  20    
Num_Field1     ACL       917  12 2  
Num_Field2     ACL       929  12 2  
Num_Field3     ACL       941  12 2  
Num_Field4     ACL       953  12 2  
Num_Field5     ACL       965  12 2  
Dt_Field1      DATETIME  977   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  985   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  993   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1001  20    
Max_Inv_Dt     DATETIME 1021   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1029  20    
DUP_KEY        ASCII    1049  40    
DUP_KEY2       ASCII    1089  40    
Bnk_KEY        ASCII    1129  56    
Vndr_Site_ID2  ASCII    1185  16    
Vndr_ID2       ASCII    1201  11    
BSB            ASCII    1212  12    
Bnk_Acc_Num    ASCII    1224  28    
BSB_NAME       ASCII    1252  12    
Bnk_Acc_Name   ASCII    1264  48    
ID_KEY         ASCII    1312  85    
^LAYOUT   VM002_History                      1153 D.T,
ABN_CLN        ASCII       1  20    
Vndr_Site_ID   ASCII      21  20    
Co             ASCII      41  20    
Vndr_ID        ASCII      61  20    
Vndr_Nme       ASCII      81  73    
ABN            ASCII     154  20    
Vndr_Sts       ASCII     174   1    
Vndr_Typ       ASCII     175  11    
Vndr_Add_Typ   ASCII     186  15    
ADD1           ASCII     201 125    
ADD2           ASCII     326  61    
ADD3           ASCII     387  61    
City           ASCII     448  35    
State          ASCII     483  29    
Pcode          ASCII     512  12    
Cntry          ASCII     524  61    
TEL1           ASCII     585  21    
TEL2           ASCII     606  21    
TEL3           ASCII     627  21    
FAX            ASCII     648  21    
Email1         ASCII     669  60    
Email2         ASCII     729  60    
Pymnt_Trm      ASCII     789  21    
Created_Dt     DATETIME  810   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  818   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  826   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     834  30    
Cha_Field2     ASCII     864  30    
Cha_Field3     ASCII     894   3    
Cha_Field4     ASCII     897  20    
Cha_Field5     ASCII     917  20    
Num_Field1     ACL       937  12 2  
Num_Field2     ACL       949  12 2  
Num_Field3     ACL       961  12 2  
Num_Field4     ACL       973  12 2  
Num_Field5     ACL       985  12 2  
Dt_Field1      DATETIME  997   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME 1005   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME 1013   8   PICTURE "YYYYMMDD"  
Max_Inv_Dt     DATETIME 1021   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1029  20    
DUP_KEY        ASCII    1049  20    
ID_KEY         ASCII    1069  85    
^LAYOUT   VM003_History                      1676 D.T,
Vndr_Site_ID   ASCII       1  20    
Co             ASCII      21  20    
Vndr_ID        ASCII      41  20    
Vndr_Nme       ASCII      61  73    
ABN            ASCII     134  20    
Vndr_Sts       ASCII     154   1    
Vndr_Typ       ASCII     155  11    
Vndr_Add_Typ   ASCII     166  15    
ADD1           ASCII     181 125    
ADD2           ASCII     306  61    
ADD3           ASCII     367  61    
City           ASCII     428  35    
State          ASCII     463  29    
Pcode          ASCII     492  12    
Cntry          ASCII     504  61    
TEL1           ASCII     565  21    
TEL2           ASCII     586  21    
TEL3           ASCII     607  21    
FAX            ASCII     628  21    
Email1         ASCII     649  60    
Email2         ASCII     709  60    
Pymnt_Trm      ASCII     769  21    
Created_Dt     DATETIME  790   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  798   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  806   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     814  30    
Cha_Field2     ASCII     844  30    
Cha_Field3     ASCII     874   3    
Cha_Field4     ASCII     877  20    
Cha_Field5     ASCII     897  20    
Num_Field1     ACL       917  12 2  
Num_Field2     ACL       929  12 2  
Num_Field3     ACL       941  12 2  
Num_Field4     ACL       953  12 2  
Num_Field5     ACL       965  12 2  
Dt_Field1      DATETIME  977   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  985   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  993   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1001  20    
Max_Inv_Dt     DATETIME 1021   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1029  20    
DUP_KEY        ASCII    1049  62    
Add_KEY        ASCII    1111  82    
Dup_Vndr_Add_Typ ASCII    1193  15    
Dup_ADD1       ASCII    1208 125    
Dup_ADD2       ASCII    1333  61    
Dup_ADD3       ASCII    1394  61    
Dup_City       ASCII    1455  35    
Dup_State      ASCII    1490  29    
Dup_Pcode      ASCII    1519  12    
Dup_Cntry      ASCII    1531  61    
ID_KEY         ASCII    1592  85    
^LAYOUT   VM005_History                      1285 D.T,
c_Name         ASCII       1  76    
Vndr_Site_ID   ASCII      77  20    
Co             ASCII      97  20    
Vndr_ID        ASCII     117  20    
Vndr_Nme       ASCII     137  73    
ABN            ASCII     210  20    
Vndr_Sts       ASCII     230   1    
Vndr_Typ       ASCII     231  11    
Vndr_Add_Typ   ASCII     242  15    
ADD1           ASCII     257 125    
ADD2           ASCII     382  61    
ADD3           ASCII     443  61    
City           ASCII     504  35    
State          ASCII     539  29    
Pcode          ASCII     568  12    
Cntry          ASCII     580  61    
TEL1           ASCII     641  21    
TEL2           ASCII     662  21    
TEL3           ASCII     683  21    
FAX            ASCII     704  21    
Email1         ASCII     725  60    
Email2         ASCII     785  60    
Pymnt_Trm      ASCII     845  21    
Created_Dt     DATETIME  866   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  874   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  882   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     890  30    
Cha_Field2     ASCII     920  30    
Cha_Field3     ASCII     950   3    
Cha_Field4     ASCII     953  20    
Cha_Field5     ASCII     973  20    
Num_Field1     ACL       993  12 2  
Num_Field2     ACL      1005  12 2  
Num_Field3     ACL      1017  12 2  
Num_Field4     ACL      1029  12 2  
Num_Field5     ACL      1041  12 2  
Dt_Field1      DATETIME 1053   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME 1061   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME 1069   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1077  20    
Max_Inv_Dt     DATETIME 1097   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1105  20    
DUP_KEY        ASCII    1125  76    
ID_KEY         ASCII    1201  85    
^LAYOUT   GreyList_VM006                     80 D.T,
Vndr_ID        ASCII       1  20    
Vndr_Name      ASCII      21  60    
^LAYOUT   VM006_History                      1731 D.T,
Vndr_Site_ID   ASCII       1  20    
Vndr_ID        ASCII      21  20    
TstCd          ACL        41  12 0  
COUNT2         ACL        53  12 0 WIDTH 8  
Co             ASCII      65  20    
Vndr_Nme       ASCII      85  73    
ABN            ASCII     158  20    
Vndr_Sts       ASCII     178   1    
Vndr_Typ       ASCII     179  11    
Vndr_Add_Typ   ASCII     190  15    
ADD1           ASCII     205 125    
ADD2           ASCII     330  61    
ADD3           ASCII     391  61    
City           ASCII     452  35    
State          ASCII     487  29    
Pcode          ASCII     516  12    
Cntry          ASCII     528  61    
TEL1           ASCII     589  21    
TEL2           ASCII     610  21    
TEL3           ASCII     631  21    
FAX            ASCII     652  21    
Email1         ASCII     673  60    
Email2         ASCII     733  60    
Pymnt_Trm      ASCII     793  21    
Created_Dt     DATETIME  814   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  822   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  830   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     838  30    
Cha_Field2     ASCII     868  30    
Cha_Field3     ASCII     898   3    
Cha_Field4     ASCII     901  20    
Cha_Field5     ASCII     921  20    
Num_Field1     ACL       941  12 2  
Num_Field2     ACL       953  12 2  
Num_Field3     ACL       965  12 2  
Num_Field4     ACL       977  12 2  
Num_Field5     ACL       989  12 2  
Dt_Field1      DATETIME 1001   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME 1009   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME 1017   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1025  20    
Max_Inv_Dt     DATETIME 1045   8   PICTURE "YYYYMMDD"  
c_Vndr_ID      ASCII    1053  20    
Inv_Amt        ACL      1073  12 2  
GST_Amt        ACL      1085  12 2  
COUNT          ACL      1097  12 0 WIDTH 8  
c_TstCd        ASCII    1109   4    
NEW_TstCd_1    ASCII    1113  15    NEW_TstCd_1
NEW_TstCd_2    ASCII    1128   6    NEW_TstCd_2
NEW_TstCd_3    ASCII    1134  10    NEW_TstCd_3
NEW_TstCd_4    ASCII    1144   6    NEW_TstCd_4
NEW_TstCd1     ASCII    1150 100    
NEW_TstCd2     ASCII    1250 100    
NEW_TstCd      ASCII    1350 100    NEW_TstCd
TEST_NAME      ASCII    1450 120    
SORT_KEY       ASCII    1570  39    
SORT_KEY_Desc  ASCII    1609  29    
RptRunDate     DATETIME 1638   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Priority       ASCII    1646   1    
ID_KEY         ASCII    1647  85    
^LAYOUT   TMP_VM006D                         465 D.T,
Vendor_Site    ASCII       1  30   AS "Vendor Site"  
Vendor_Number  ASCII      31  20   AS "Vendor Number"  
Vendor_Name    ASCII      51  73   AS "Vendor Name"  
Vendor_Type    ASCII     124  11   AS "Vendor Type"  
Vendor_Status  ASCII     135   1   AS "Vendor Status"  
Invoice_Number ASCII     136  51   AS "Invoice Number"  
Invoice_Date   ASCII     187  12   AS "Invoice Date"  
Invoice_Amount ACL       199  12 2 AS "Invoice Amount"  
Document_Type  ASCII     211  10   AS "Document Type"  
Description    ASCII     221  31    
Paid           ASCII     252   1    
Voucher_Number ASCII     253  10   AS "Voucher Number"  
Priority       ASCII     263   1    
TEST_NAME      ASCII     264 120    
Test_Date      ASCII     384  12   AS "Test Date"  
Data_Range_Start_Date ASCII     396  12    
Data_Range_End_Date ASCII     408  12    
SORT_KEY       ASCII     420  30    
SORT_KEY_Desc  ASCII     450  16    
^LAYOUT   GreyList_VM007                     80 D.T,
Vndr_ID        ASCII       1  20    
Vndr_Name      ASCII      21  60    
^LAYOUT   VM007_History                      1169 D.T,
Vndr_Site_ID   ASCII       1  20    
Co             ASCII      21  20    
Vndr_ID        ASCII      41  20    
Vndr_Nme       ASCII      61  73    
ABN            ASCII     134  20    
Vndr_Sts       ASCII     154   1    
Vndr_Typ       ASCII     155  11    
Vndr_Add_Typ   ASCII     166  15    
ADD1           ASCII     181 125    
ADD2           ASCII     306  61    
ADD3           ASCII     367  61    
City           ASCII     428  35    
State          ASCII     463  29    
Pcode          ASCII     492  12    
Cntry          ASCII     504  61    
TEL1           ASCII     565  21    
TEL2           ASCII     586  21    
TEL3           ASCII     607  21    
FAX            ASCII     628  21    
Email1         ASCII     649  60    
Email2         ASCII     709  60    
Pymnt_Trm      ASCII     769  21    
Created_Dt     DATETIME  790   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  798   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  806   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     814  30    
Cha_Field2     ASCII     844  30    
Cha_Field3     ASCII     874   3    
Cha_Field4     ASCII     877  20    
Cha_Field5     ASCII     897  20    
Num_Field1     ACL       917  12 2  
Num_Field2     ACL       929  12 2  
Num_Field3     ACL       941  12 2  
Num_Field4     ACL       953  12 2  
Num_Field5     ACL       965  12 2  
Dt_Field1      DATETIME  977   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  985   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  993   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1001  20    
Max_Inv_Dt     DATETIME 1021   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1029  20    
Inv_Amt        ACL      1049  12 2  
GST_Amt        ACL      1061  12 2  
COUNT          ACL      1073  12 0 WIDTH 8  
ID_KEY         ASCII    1085  85    
^LAYOUT   GreyList_VM008                     80 D.T,
Vndr_ID        ASCII       1  20    
Vndr_Name      ASCII      21  60    
^LAYOUT   VM008_History                      1264 D.T,
Vndr_Site_ID   ASCII       1  20    
Co             ASCII      21  20    
Vndr_ID        ASCII      41  20    
Vndr_Nme       ASCII      61  73    
ABN            ASCII     134  20    
Vndr_Sts       ASCII     154   1    
Vndr_Typ       ASCII     155  11    
Vndr_Add_Typ   ASCII     166  15    
ADD1           ASCII     181 125    
ADD2           ASCII     306  61    
ADD3           ASCII     367  61    
City           ASCII     428  35    
State          ASCII     463  29    
Pcode          ASCII     492  12    
Cntry          ASCII     504  61    
TEL1           ASCII     565  21    
TEL2           ASCII     586  21    
TEL3           ASCII     607  21    
FAX            ASCII     628  21    
Email1         ASCII     649  60    
Email2         ASCII     709  60    
Pymnt_Trm      ASCII     769  21    
Created_Dt     DATETIME  790   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  798   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  806   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     814  30    
Cha_Field2     ASCII     844  30    
Cha_Field3     ASCII     874   3    
Cha_Field4     ASCII     877  20    
Cha_Field5     ASCII     897  20    
Num_Field1     ACL       917  12 2  
Num_Field2     ACL       929  12 2  
Num_Field3     ACL       941  12 2  
Num_Field4     ACL       953  12 2  
Num_Field5     ACL       965  12 2  
Dt_Field1      DATETIME  977   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  985   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  993   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1001  20    
Max_Inv_Dt     DATETIME 1021   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1029  20    
ASIC_entityStatusCode ASCII    1049  21    
ASIC_entityStatusEF DATETIME 1070   8   PICTURE "YYYYMMDD"  
ASIC_GST_effFrom DATETIME 1078   8   PICTURE "YYYYMMDD"  
ASIC_GST_effTo DATETIME 1086   8   PICTURE "YYYYMMDD"  
ASIC_entityDescription ASCII    1094  50    
Inv_Amt        ACL      1144  12 2  
GST_Amt        ACL      1156  12 2  
COUNT          ACL      1168  12 0 WIDTH 8  
ID_KEY         ASCII    1180  85    
^LAYOUT   VM008Z_Can_ABN_Sum                 76 D.T,
Vndr_Site_ID   ASCII       1  20    
Vndr_ID        ASCII      21  20    
GST_Amt        ACL        41  12 2  
Inv_Amt        ACL        53  12 2  
COUNT          ACL        65  12 0 WIDTH 8  
^LAYOUT   VM008D_Can_ABN                     894 D.T,
!"VM008_can_ABN" "IDX_VM008_VndrSiteID" Vndr_Site_ID
Vchr_ID        ASCII       1  10    
Vndr_Site_ID   ASCII      11  20    
Vndr_ID        ASCII      31  20    
Doc_Typ        ASCII      51  10    
Inv_Dt         DATETIME   61   8   PICTURE "YYYYMMDD" WIDTH 27  
Inv_No         ASCII      69  50    
Inv_Amt        ACL       119  12 2  
Inv_Amt_Doc    ACL       131  12 2  
Curncy         ASCII     143  15    
Ex_Rate        ACL       158  12 2  
Inv_Net_Amt    ACL       170  12 2  
GST_Amt        ACL       182  12 2  
Btch_No        ASCII     194  15    
Due_Dt         DATETIME  209   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     217  21    
PO_Net_Amt     ACL       238  12 2  
Descrp         ASCII     250  31    
Pd_Dt          DATETIME  281   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     289  21    
Modf_Dt        DATETIME  310   8   PICTURE "YYYYMMDD"  
Modf_By        ASCII     318  15    
Pst_Dt         DATETIME  333   8   PICTURE "YYYYMMDD"  
VOIDED         ASCII     341   1    
Void_Dt        DATETIME  342   8   PICTURE "YYYYMMDD"  
isPaid         ASCII     350   1    
Num_Field1     ACL       351  12 2  
Num_Field2     ACL       363  12 2  
Num_Field3     ACL       375  12 2  
Num_Field4     ACL       387  12 2  
Num_Field5     ACL       399  12 2  
Dt_Field1      DATETIME  411   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  419   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  427   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     435  20    
Cha_Field2     ASCII     455  20    
Cha_Field3     ASCII     475  20    
Cha_Field4     ASCII     495  20    
Cha_Field5     ASCII     515  20    
c_Inv_No2      ASCII     535  50    
c_Inv_No       ASCII     585  20    Srt Inv_No
ABS_INVAMT     ACL       605  12 0  
ABS_INVAMT_CENT ACL       617  12 4  
c_Inv_Dt       ASCII     629   8    
Vndr_Mstr_ID   ASCII     637  20    
Vndr_Nme       ASCII     657  73    
Vndr_Sts       ASCII     730   1    
Vndr_Typ       ASCII     731  11    
SORT_KEY       ASCII     742  29    
SORT_KEY_Desc  ASCII     771  20    
Priority       ASCII     791   1    
RptRunDate     DATETIME  792   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Data_Range_Start_Date DATETIME  800   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME  808   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
TEST_NAME      ASCII     816  71    
ASIC_entityStatusEF DATETIME  887   8   PICTURE "YYYYMMDD"  
^LAYOUT   ABN_ASIC                           2962 D.T,
ABN_CLN        ASCII       1  20    
ASIC_entityStatusCode ASCII      21  21    
ASIC_entityStatusEF ASCII      42  19    
ASIC_entityStatusET ASCII      61  19    
RecordLastUpdatedDate ASCII      80  21    
ASIC_identifierValue ASCII     101  20    
ASIC_CurrentIndicator ASCII     121  21    
ASIC_Number    ASCII     142  20    
ASIC_entityTypeCode ASCII     162  19    
ASIC_entityDescription ASCII     181  50    
ASIC_GST_effFrom ASCII     231  16    
ASIC_GST_effTo ASCII     247  14    
ASIC_orgName   ASCII     261 100    
ASIC_effFrom   ASCII     361  12    
ASIC_mainbus_statec ASCII     373  19    
ASIC_mainbus_postc ASCII     392  18    
ASIC_mainbus_effFr ASCII     410  18    
ASIC_mainbus_effTo ASCII     428  18    
ASIC_TrdNameCnt ASCII     446  15    
ASIC_TrdName01 ASCII     461  50    
ASIC_TrdName02 ASCII     511  50    
ASIC_TrdName03 ASCII     561  50    
ASIC_TrdName04 ASCII     611  50    
ASIC_TrdName05 ASCII     661  50    
ASIC_TrdName06 ASCII     711  50    
ASIC_TrdName07 ASCII     761  50    
ASIC_TrdName08 ASCII     811  50    
ASIC_TrdName09 ASCII     861  50    
ASIC_TrdName10 ASCII     911  50    
ASIC_TrdName11 ASCII     961  50    
ASIC_TrdName12 ASCII    1011  50    
ASIC_TrdName13 ASCII    1061  50    
ASIC_TrdName14 ASCII    1111  50    
ASIC_TrdName15 ASCII    1161  50    
ASIC_TrdName16 ASCII    1211  50    
ASIC_TrdName17 ASCII    1261  50    
ASIC_TrdName18 ASCII    1311  50    
ASIC_TrdName19 ASCII    1361  50    
ASIC_TrdName20 ASCII    1411  50    
ASIC_TrdName21 ASCII    1461  50    
ASIC_TrdName22 ASCII    1511  50    
ASIC_TrdName23 ASCII    1561  50    
ASIC_TrdName24 ASCII    1611  50    
ASIC_TrdName25 ASCII    1661  50    
ASIC_TrdName26 ASCII    1711  50    
ASIC_TrdName27 ASCII    1761  50    
ASIC_TrdName28 ASCII    1811  50    
ASIC_TrdName29 ASCII    1861  50    
ASIC_TrdName30 ASCII    1911  50    
ASIC_TrdName31 ASCII    1961  50    
ASIC_TrdName32 ASCII    2011  50    
ASIC_TrdName33 ASCII    2061  50    
ASIC_TrdName34 ASCII    2111  50    
ASIC_TrdName35 ASCII    2161  50    
ASIC_TrdName36 ASCII    2211  50    
ASIC_TrdName37 ASCII    2261  50    
ASIC_TrdName38 ASCII    2311  50    
ASIC_TrdName39 ASCII    2361  50    
ASIC_TrdName40 ASCII    2411  50    
ASIC_TrdName41 ASCII    2461  50    
ASIC_TrdName42 ASCII    2511  50    
ASIC_TrdName43 ASCII    2561  50    
ASIC_TrdName44 ASCII    2611  50    
ASIC_TrdName45 ASCII    2661  50    
ASIC_TrdName46 ASCII    2711  50    
ASIC_TrdName47 ASCII    2761  50    
ASIC_TrdName48 ASCII    2811  50    
ASIC_TrdName49 ASCII    2861  50    
ASIC_TrdName50 ASCII    2911  50    
^LAYOUT   GreyList_VM009                     80 D.T,
Vndr_ID        ASCII       1  20    
Vndr_Name      ASCII      21  60    
^LAYOUT   VM009_History                      1264 D.T,
Vndr_Site_ID   ASCII       1  20    
Co             ASCII      21  20    
Vndr_ID        ASCII      41  20    
Vndr_Nme       ASCII      61  73    
ABN            ASCII     134  20    
Vndr_Sts       ASCII     154   1    
Vndr_Typ       ASCII     155  11    
Vndr_Add_Typ   ASCII     166  15    
ADD1           ASCII     181 125    
ADD2           ASCII     306  61    
ADD3           ASCII     367  61    
City           ASCII     428  35    
State          ASCII     463  29    
Pcode          ASCII     492  12    
Cntry          ASCII     504  61    
TEL1           ASCII     565  21    
TEL2           ASCII     586  21    
TEL3           ASCII     607  21    
FAX            ASCII     628  21    
Email1         ASCII     649  60    
Email2         ASCII     709  60    
Pymnt_Trm      ASCII     769  21    
Created_Dt     DATETIME  790   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  798   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  806   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     814  30    
Cha_Field2     ASCII     844  30    
Cha_Field3     ASCII     874   3    
Cha_Field4     ASCII     877  20    
Cha_Field5     ASCII     897  20    
Num_Field1     ACL       917  12 2  
Num_Field2     ACL       929  12 2  
Num_Field3     ACL       941  12 2  
Num_Field4     ACL       953  12 2  
Num_Field5     ACL       965  12 2  
Dt_Field1      DATETIME  977   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  985   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  993   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1001  20    
Max_Inv_Dt     DATETIME 1021   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1029  20    
ASIC_entityStatusCode ASCII    1049  21    
ASIC_entityStatusEF DATETIME 1070   8   PICTURE "YYYYMMDD"  
ASIC_GST_effFrom DATETIME 1078   8   PICTURE "YYYYMMDD"  
ASIC_GST_effTo DATETIME 1086   8   PICTURE "YYYYMMDD"  
ASIC_entityDescription ASCII    1094  50    
Inv_Amt        ACL      1144  12 2  
GST_Amt        ACL      1156  12 2  
COUNT          ACL      1168  12 0 WIDTH 8  
ID_KEY         ASCII    1180  85    
^LAYOUT   VM009Z_Invld_ABN_ABR_Sum           76 D.T,
Vndr_Site_ID   ASCII       1  20    
Vndr_ID        ASCII      21  20    
GST_Amt        ACL        41  12 2  
Inv_Amt        ACL        53  12 2  
COUNT          ACL        65  12 0 WIDTH 8  
^LAYOUT   AP_Invoices                        534 D.T,
!"VMF_Vnd_Master_File" "IDX_VndrSiteID" Vndr_Site_ID
Vchr_ID        ASCII       1  10    
Vndr_Site_ID   ASCII      11  20    
Vndr_ID        ASCII      31  20    
Doc_Typ        ASCII      51  10    
Inv_Dt         DATETIME   61   8   PICTURE "YYYYMMDD" WIDTH 27  
Inv_No         ASCII      69  50    
Inv_Amt        ACL       119  12 2  
Inv_Amt_Doc    ACL       131  12 2  
Curncy         ASCII     143  15    
Ex_Rate        ACL       158  12 2  
Inv_Net_Amt    ACL       170  12 2  
GST_Amt        ACL       182  12 2  
Btch_No        ASCII     194  15    
Due_Dt         DATETIME  209   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     217  21    
PO_Net_Amt     ACL       238  12 2  
Descrp         ASCII     250  31    
Pd_Dt          DATETIME  281   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     289  21    
Modf_Dt        DATETIME  310   8   PICTURE "YYYYMMDD"  
Modf_By        ASCII     318  15    
Pst_Dt         DATETIME  333   8   PICTURE "YYYYMMDD"  
VOIDED         ASCII     341   1    
Void_Dt        DATETIME  342   8   PICTURE "YYYYMMDD"  
isPaid         ASCII     350   1    
Num_Field1     ACL       351  12 2  
Num_Field2     ACL       363  12 2  
Num_Field3     ACL       375  12 2  
Num_Field4     ACL       387  12 2  
Num_Field5     ACL       399  12 2  
Dt_Field1      DATETIME  411   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  419   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  427   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     435  20    
Cha_Field2     ASCII     455  20    
Cha_Field3     ASCII     475  20    
Cha_Field4     ASCII     495  20    
Cha_Field5     ASCII     515  20    
c_Inv_No2      COMPUTED             
 *C 50 1 
 REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(UPPER(Inv_No),"JAN","01"),"FEB","02"),"MAR","03"),"APR","04"),"MAY","05"),"JUN","06"),"JUL","07"),"AUG","08"),"SEP","09"),"OCT","10"),"NOV","11"),"DEC","12")
c_Inv_No       COMPUTED             Srt Inv_No
 *C 20 2 
 SUBSTR(ALLTRIM(STRING(VALUE(INCLUDE(c_Inv_No2,"0123456789"),0),16)),1,20) IF LENGTH(ALLTRIM(INCLUDE(c_Inv_No2,"0123456789")))>0
 SUBSTR(ALLTRIM(INCLUDE(UPPER(c_Inv_No2),"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789")),1,20)
ABS_INVAMT     COMPUTED             
 *N 0 2
 VALUE(SPLIT(ALLTRIM(STRING(ABS(Inv_Amt),21)),".",1),0) IF OCCURS(ALLTRIM(STRING(ABS(Inv_Amt),21)),".")>=0
 VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21 )),0)
ABS_INVAMT_CENT COMPUTED             
 *N 4 2
 VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21)),4) IF OCCURS(ALLTRIM(STRING(ABS(Inv_Amt),21)),".")>=0
 VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21 )),4)
c_Inv_Dt       COMPUTED             
 *C 8 1 
 ALLTRIM(SUBSTR(DATE(Inv_Dt),7,4))+ALLTRIM(SUBSTR(DATE(Inv_Dt),4,2))+ALLTRIM(SUBSTR(DATE(Inv_Dt),1,2))
Vndr_Mstr_ID   COMPUTED             
 *C 20 1 
 VMF_Vnd_Master_File.Vndr_Site_ID
Vndr_Nme       COMPUTED             
 *C 73 1 
 VMF_Vnd_Master_File.Vndr_Nme
Vndr_Sts       COMPUTED             
 *C 1 1 
 VMF_Vnd_Master_File.Vndr_Sts
Vndr_Typ       COMPUTED             
 *C 11 1 
 VMF_Vnd_Master_File.Vndr_Typ
^LAYOUT   VM001_Dup_Vnd_BankAcc              1536 D.T,
!"AP_Vnd_InvGst_Sum" "IDX_AP_Sum_VndrID" Vndr_ID
!"VMF_BnkAcc" "IDX_BnkAcc" cVndrSiteVndrID
Vndr_Site_ID   ASCII       1  20    
Co             ASCII      21  20    
Vndr_ID        ASCII      41  20    
Vndr_Nme       ASCII      61  73    
ABN            ASCII     134  20    
Vndr_Sts       ASCII     154   1    
Vndr_Typ       ASCII     155  11    
Vndr_Add_Typ   ASCII     166  15    
ADD1           ASCII     181 125    
ADD2           ASCII     306  61    
ADD3           ASCII     367  61    
City           ASCII     428  35    
State          ASCII     463  29    
Pcode          ASCII     492  12    
Cntry          ASCII     504  61    
TEL1           ASCII     565  21    
TEL2           ASCII     586  21    
TEL3           ASCII     607  21    
FAX            ASCII     628  21    
Email1         ASCII     649  60    
Email2         ASCII     709  60    
Pymnt_Trm      ASCII     769  21    
Created_Dt     DATETIME  790   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  798   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  806   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     814  30    
Cha_Field2     ASCII     844  30    
Cha_Field3     ASCII     874   3    
Cha_Field4     ASCII     877  20    
Cha_Field5     ASCII     897  20    
Num_Field1     ACL       917  12 2  
Num_Field2     ACL       929  12 2  
Num_Field3     ACL       941  12 2  
Num_Field4     ACL       953  12 2  
Num_Field5     ACL       965  12 2  
Dt_Field1      DATETIME  977   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  985   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  993   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1001  20    
Max_Inv_Dt     DATETIME 1021   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1029  20    
DUP_KEY        ASCII    1049  40    
DUP_KEY2       ASCII    1089  40    
Bnk_KEY        ASCII    1129  56    
Vndr_Site_ID2  ASCII    1185  16    
Vndr_ID2       ASCII    1201  11    
BSB            ASCII    1212  12    
Bnk_Acc_Num    ASCII    1224  28    
BSB_NAME       ASCII    1252  12    
Bnk_Acc_Name   ASCII    1264  48    
ID_KEY         ASCII    1312  85    
Vndr_Same_Diff ASCII    1397   1    
SORT_KEY       ASCII    1398  40    
SORT_KEY_Desc  ASCII    1438  41    
RptRunDate     DATETIME 1479   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
TEST_NAME      ASCII    1487  49    
Priority       ASCII    1536   1    
cVndrSiteVndrID COMPUTED             
 *C 20 1 
 SUBSTR(ALLTRIM(Vndr_Site_ID),1,20)
c_VALID        COMPUTED             c_VALID
 *N 0 3
 1 IF VMF_BnkAcc.Dt_Field2 = `19000101` AND VMF_BnkAcc.Dt_Field1 <= _RptRunDate
 1 IF VMF_BnkAcc.Dt_Field2 >= _RptRunDate AND VMF_BnkAcc.Dt_Field1 <= _RptRunDate
 0
^LAYOUT   VM002_Dup_Vnd_ABN                  1290 D.T,
!"AP_Vnd_InvGst_Sum" "IDX_AP_Sum_VndrID" Vndr_ID
ABN_CLN        ASCII       1  20    
Vndr_Site_ID   ASCII      21  20    
Co             ASCII      41  20    
Vndr_ID        ASCII      61  20    
Vndr_Nme       ASCII      81  73    
ABN            ASCII     154  20    
Vndr_Sts       ASCII     174   1    
Vndr_Typ       ASCII     175  11    
Vndr_Add_Typ   ASCII     186  15    
ADD1           ASCII     201 125    
ADD2           ASCII     326  61    
ADD3           ASCII     387  61    
City           ASCII     448  35    
State          ASCII     483  29    
Pcode          ASCII     512  12    
Cntry          ASCII     524  61    
TEL1           ASCII     585  21    
TEL2           ASCII     606  21    
TEL3           ASCII     627  21    
FAX            ASCII     648  21    
Email1         ASCII     669  60    
Email2         ASCII     729  60    
Pymnt_Trm      ASCII     789  21    
Created_Dt     DATETIME  810   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  818   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  826   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     834  30    
Cha_Field2     ASCII     864  30    
Cha_Field3     ASCII     894   3    
Cha_Field4     ASCII     897  20    
Cha_Field5     ASCII     917  20    
Num_Field1     ACL       937  12 2  
Num_Field2     ACL       949  12 2  
Num_Field3     ACL       961  12 2  
Num_Field4     ACL       973  12 2  
Num_Field5     ACL       985  12 2  
Dt_Field1      DATETIME  997   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME 1005   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME 1013   8   PICTURE "YYYYMMDD"  
Max_Inv_Dt     DATETIME 1021   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1029  20    
DUP_KEY        ASCII    1049  20    
ID_KEY         ASCII    1069  85    
Vndr_Same_Diff ASCII    1154   1    
SORT_KEY       ASCII    1155  40    
SORT_KEY_Desc  ASCII    1195  33    
RptRunDate     DATETIME 1228   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Priority       ASCII    1236   1    
TEST_NAME      ASCII    1237  54    
^LAYOUT   VM003_Dup_Vnd_Add                  1838 D.T,
!"AP_Vnd_InvGst_Sum" "IDX_AP_Sum_VndrID" Vndr_ID
Vndr_Site_ID   ASCII       1  20    
Co             ASCII      21  20    
Vndr_ID        ASCII      41  20    
Vndr_Nme       ASCII      61  73    
ABN            ASCII     134  20    
Vndr_Sts       ASCII     154   1    
Vndr_Typ       ASCII     155  11    
Vndr_Add_Typ   ASCII     166  15    
ADD1           ASCII     181 125    
ADD2           ASCII     306  61    
ADD3           ASCII     367  61    
City           ASCII     428  35    
State          ASCII     463  29    
Pcode          ASCII     492  12    
Cntry          ASCII     504  61    
TEL1           ASCII     565  21    
TEL2           ASCII     586  21    
TEL3           ASCII     607  21    
FAX            ASCII     628  21    
Email1         ASCII     649  60    
Email2         ASCII     709  60    
Pymnt_Trm      ASCII     769  21    
Created_Dt     DATETIME  790   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  798   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  806   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     814  30    
Cha_Field2     ASCII     844  30    
Cha_Field3     ASCII     874   3    
Cha_Field4     ASCII     877  20    
Cha_Field5     ASCII     897  20    
Num_Field1     ACL       917  12 2  
Num_Field2     ACL       929  12 2  
Num_Field3     ACL       941  12 2  
Num_Field4     ACL       953  12 2  
Num_Field5     ACL       965  12 2  
Dt_Field1      DATETIME  977   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  985   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  993   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1001  20    
Max_Inv_Dt     DATETIME 1021   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1029  20    
DUP_KEY        ASCII    1049  62    
Add_KEY        ASCII    1111  82    
Dup_Vndr_Add_Typ ASCII    1193  15    
Dup_ADD1       ASCII    1208 125    
Dup_ADD2       ASCII    1333  61    
Dup_ADD3       ASCII    1394  61    
Dup_City       ASCII    1455  35    
Dup_State      ASCII    1490  29    
Dup_Pcode      ASCII    1519  12    
Dup_Cntry      ASCII    1531  61    
ID_KEY         ASCII    1592  85    
Vndr_Same_Diff ASCII    1677   1    
SORT_KEY       ASCII    1678  60    
SORT_KEY_Desc  ASCII    1738  48    
RptRunDate     DATETIME 1786   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
TEST_NAME      ASCII    1794  44    
Priority       ASCII    1838   1    
^LAYOUT   AP_Vnd_InvGst_Sum                  192 D.T,
Vndr_ID        ASCII       1  20    
Inv_Amt        ACL        21  12 2  
GST_Amt        ACL        33  12 2  
COUNT          ACL        45  12 0 WIDTH 8  
InvAmt_Pos     ACL        57  12 2  
GSTAmt_Pos     ACL        69  12 2  
Cnt_Pos        ACL        81  12 0  
InvAmt_24M     ACL        93  12 2  
GSTAmt_24M     ACL       105  12 2  
Cnt_24M        ACL       117  12 0  
InvAmt_12M     ACL       129  12 2  
GSTAmt_12M     ACL       141  12 2  
Cnt_12M        ACL       153  12 0  
COUNT2         ACL       165  12 0 WIDTH 8  
Inv_Dt         DATETIME  177   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Inv_Dt       ASCII     185   8    
^LAYOUT   VM005_Dup_Vnd_Name                 1442 D.T,
!"AP_Vnd_InvGst_Sum" "IDX_AP_Sum_VndrID" Vndr_ID
c_Name         ASCII       1  76    
Vndr_Site_ID   ASCII      77  20    
Co             ASCII      97  20    
Vndr_ID        ASCII     117  20    
Vndr_Nme       ASCII     137  73    
ABN            ASCII     210  20    
Vndr_Sts       ASCII     230   1    
Vndr_Typ       ASCII     231  11    
Vndr_Add_Typ   ASCII     242  15    
ADD1           ASCII     257 125    
ADD2           ASCII     382  61    
ADD3           ASCII     443  61    
City           ASCII     504  35    
State          ASCII     539  29    
Pcode          ASCII     568  12    
Cntry          ASCII     580  61    
TEL1           ASCII     641  21    
TEL2           ASCII     662  21    
TEL3           ASCII     683  21    
FAX            ASCII     704  21    
Email1         ASCII     725  60    
Email2         ASCII     785  60    
Pymnt_Trm      ASCII     845  21    
Created_Dt     DATETIME  866   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  874   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  882   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     890  30    
Cha_Field2     ASCII     920  30    
Cha_Field3     ASCII     950   3    
Cha_Field4     ASCII     953  20    
Cha_Field5     ASCII     973  20    
Num_Field1     ACL       993  12 2  
Num_Field2     ACL      1005  12 2  
Num_Field3     ACL      1017  12 2  
Num_Field4     ACL      1029  12 2  
Num_Field5     ACL      1041  12 2  
Dt_Field1      DATETIME 1053   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME 1061   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME 1069   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1077  20    
Max_Inv_Dt     DATETIME 1097   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1105  20    
DUP_KEY        ASCII    1125  76    
ID_KEY         ASCII    1201  85    
Vndr_Same_Diff ASCII    1286   1    
SORT_KEY       ASCII    1287  60    
SORT_KEY_Desc  ASCII    1347  39    
RptRunDate     DATETIME 1386   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
TEST_NAME      ASCII    1394  48    
Priority       ASCII    1442   1    
^LAYOUT   VM006_Mis_Details                  1743 D.T,
!"VMF_BnkAcc" "IDX_BK_VndrSiteID1" SUBST(ALLTRIM(Vndr_Site_ID),1,20)
!"AP_Vnd_InvGst_Sum" "IDX_AP_Sum_VndrID" Vndr_ID
Vndr_Site_ID   ASCII       1  20    
Vndr_ID        ASCII      21  20    
TstCd          ACL        41  12 0  
COUNT2         ACL        53  12 0 WIDTH 8  
Co             ASCII      65  20    
Vndr_Nme       ASCII      85  73    
ABN            ASCII     158  20    
Vndr_Sts       ASCII     178   1    
Vndr_Typ       ASCII     179  11    
Vndr_Add_Typ   ASCII     190  15    
ADD1           ASCII     205 125    
ADD2           ASCII     330  61    
ADD3           ASCII     391  61    
City           ASCII     452  35    
State          ASCII     487  29    
Pcode          ASCII     516  12    
Cntry          ASCII     528  61    
TEL1           ASCII     589  21    
TEL2           ASCII     610  21    
TEL3           ASCII     631  21    
FAX            ASCII     652  21    
Email1         ASCII     673  60    
Email2         ASCII     733  60    
Pymnt_Trm      ASCII     793  21    
Created_Dt     DATETIME  814   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  822   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  830   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     838  30    
Cha_Field2     ASCII     868  30    
Cha_Field3     ASCII     898   3    
Cha_Field4     ASCII     901  20    
Cha_Field5     ASCII     921  20    
Num_Field1     ACL       941  12 2  
Num_Field2     ACL       953  12 2  
Num_Field3     ACL       965  12 2  
Num_Field4     ACL       977  12 2  
Num_Field5     ACL       989  12 2  
Dt_Field1      DATETIME 1001   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME 1009   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME 1017   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1025  20    
Max_Inv_Dt     DATETIME 1045   8   PICTURE "YYYYMMDD"  
c_Vndr_ID      ASCII    1053  20    
Inv_Amt        ACL      1073  12 2  
GST_Amt        ACL      1085  12 2  
COUNT          ACL      1097  12 0 WIDTH 8  
c_TstCd        ASCII    1109   4    
NEW_TstCd_1    ASCII    1113  15    NEW_TstCd_1
NEW_TstCd_2    ASCII    1128   6    NEW_TstCd_2
NEW_TstCd_3    ASCII    1134  10    NEW_TstCd_3
NEW_TstCd_4    ASCII    1144   6    NEW_TstCd_4
NEW_TstCd1     ASCII    1150 100    
NEW_TstCd2     ASCII    1250 100    
NEW_TstCd      ASCII    1350 100    NEW_TstCd
TEST_NAME      ASCII    1450 120    
SORT_KEY       ASCII    1570  39    
SORT_KEY_Desc  ASCII    1609  29    
RptRunDate     DATETIME 1638   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Priority       ASCII    1646   1    
ID_KEY         ASCII    1647  85    
c_VALID        ACL      1732  12 0  
^LAYOUT   VM006D_Mis_Details                 936 D.T,
!"VM006_Mis_Details" "IDX_VM006_VndrSiteID" Vndr_Site_ID
Vchr_ID        ASCII       1  10    
Vndr_Site_ID   ASCII      11  20    
Vndr_ID        ASCII      31  20    
Doc_Typ        ASCII      51  10    
Inv_Dt         DATETIME   61   8   PICTURE "YYYYMMDD" WIDTH 27  
Inv_No         ASCII      69  50    
Inv_Amt        ACL       119  12 2  
Inv_Amt_Doc    ACL       131  12 2  
Curncy         ASCII     143  15    
Ex_Rate        ACL       158  12 2  
Inv_Net_Amt    ACL       170  12 2  
GST_Amt        ACL       182  12 2  
Btch_No        ASCII     194  15    
Due_Dt         DATETIME  209   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     217  21    
PO_Net_Amt     ACL       238  12 2  
Descrp         ASCII     250  31    
Pd_Dt          DATETIME  281   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     289  21    
Modf_Dt        DATETIME  310   8   PICTURE "YYYYMMDD"  
Modf_By        ASCII     318  15    
Pst_Dt         DATETIME  333   8   PICTURE "YYYYMMDD"  
VOIDED         ASCII     341   1    
Void_Dt        DATETIME  342   8   PICTURE "YYYYMMDD"  
isPaid         ASCII     350   1    
Num_Field1     ACL       351  12 2  
Num_Field2     ACL       363  12 2  
Num_Field3     ACL       375  12 2  
Num_Field4     ACL       387  12 2  
Num_Field5     ACL       399  12 2  
Dt_Field1      DATETIME  411   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  419   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  427   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     435  20    
Cha_Field2     ASCII     455  20    
Cha_Field3     ASCII     475  20    
Cha_Field4     ASCII     495  20    
Cha_Field5     ASCII     515  20    
c_Inv_No2      ASCII     535  50    
c_Inv_No       ASCII     585  20    Srt Inv_No
ABS_INVAMT     ACL       605  12 0  
ABS_INVAMT_CENT ACL       617  12 4  
c_Inv_Dt       ASCII     629   8    
Vndr_Mstr_ID   ASCII     637  20    
Vndr_Nme       ASCII     657  73    
Vndr_Sts       ASCII     730   1    
Vndr_Typ       ASCII     731  11    
c_TstCd        ASCII     742   4    
TEST_NAME      ASCII     746 120    
SORT_KEY       ASCII     866  30    
SORT_KEY_Desc  ASCII     896  16    
RptRunDate     DATETIME  912   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Data_Range_Start_Date DATETIME  920   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME  928   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
Priority       ASCII     936   1    
^LAYOUT   VM007_Invld_Frmt_ABN               1169 D.T,
!"AP_Vnd_InvGst_Sum" "IDX_AP_Sum_VndrID" Vndr_ID
Vndr_Site_ID   ASCII       1  20    
Co             ASCII      21  20    
Vndr_ID        ASCII      41  20    
Vndr_Nme       ASCII      61  73    
ABN            ASCII     134  20    
Vndr_Sts       ASCII     154   1    
Vndr_Typ       ASCII     155  11    
Vndr_Add_Typ   ASCII     166  15    
ADD1           ASCII     181 125    
ADD2           ASCII     306  61    
ADD3           ASCII     367  61    
City           ASCII     428  35    
State          ASCII     463  29    
Pcode          ASCII     492  12    
Cntry          ASCII     504  61    
TEL1           ASCII     565  21    
TEL2           ASCII     586  21    
TEL3           ASCII     607  21    
FAX            ASCII     628  21    
Email1         ASCII     649  60    
Email2         ASCII     709  60    
Pymnt_Trm      ASCII     769  21    
Created_Dt     DATETIME  790   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  798   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  806   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     814  30    
Cha_Field2     ASCII     844  30    
Cha_Field3     ASCII     874   3    
Cha_Field4     ASCII     877  20    
Cha_Field5     ASCII     897  20    
Num_Field1     ACL       917  12 2  
Num_Field2     ACL       929  12 2  
Num_Field3     ACL       941  12 2  
Num_Field4     ACL       953  12 2  
Num_Field5     ACL       965  12 2  
Dt_Field1      DATETIME  977   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  985   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  993   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1001  20    
Max_Inv_Dt     DATETIME 1021   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1029  20    
Inv_Amt        ACL      1049  12 2  
GST_Amt        ACL      1061  12 2  
COUNT          ACL      1073  12 0 WIDTH 8  
ID_KEY         ASCII    1085  85    
SORT_KEY       COMPUTED             
 *C 35 1 
 ALLTRIM(ZONED(Inv_Amt,15))+ALLTRIM(Vndr_ID)
SORT_KEY_Desc  COMPUTED             
 *C 20 1 
 "Total_InvAmt Vndr_ID"
Priority       COMPUTED             
 *C 1 1 
 "H"
RptRunDate     COMPUTED            AS "Report Run Date" WIDTH 27  
 *D 1 16
 _RptRunDate
TEST_NAME      COMPUTED             
 *C 48 1 
 "VM007. Identify Vendor with Incorrect ABN Format"
^LAYOUT   VM007D_Invld_Frmt_ABN              883 D.T,
!"VMF_Vnd_Master_File" "IDX_VndrSiteID" Vndr_Site_ID
Vchr_ID        ASCII       1  10    
Vndr_Site_ID   ASCII      11  20    
Vndr_ID        ASCII      31  20    
Doc_Typ        ASCII      51  10    
Inv_Dt         DATETIME   61   8   PICTURE "YYYYMMDD" WIDTH 27  
Inv_No         ASCII      69  50    
Inv_Amt        ACL       119  12 2  
Inv_Amt_Doc    ACL       131  12 2  
Curncy         ASCII     143  15    
Ex_Rate        ACL       158  12 2  
Inv_Net_Amt    ACL       170  12 2  
GST_Amt        ACL       182  12 2  
Btch_No        ASCII     194  15    
Due_Dt         DATETIME  209   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     217  21    
PO_Net_Amt     ACL       238  12 2  
Descrp         ASCII     250  31    
Pd_Dt          DATETIME  281   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     289  21    
Modf_Dt        DATETIME  310   8   PICTURE "YYYYMMDD"  
Modf_By        ASCII     318  15    
Pst_Dt         DATETIME  333   8   PICTURE "YYYYMMDD"  
VOIDED         ASCII     341   1    
Void_Dt        DATETIME  342   8   PICTURE "YYYYMMDD"  
isPaid         ASCII     350   1    
Num_Field1     ACL       351  12 2  
Num_Field2     ACL       363  12 2  
Num_Field3     ACL       375  12 2  
Num_Field4     ACL       387  12 2  
Num_Field5     ACL       399  12 2  
Dt_Field1      DATETIME  411   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  419   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  427   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     435  20    
Cha_Field2     ASCII     455  20    
Cha_Field3     ASCII     475  20    
Cha_Field4     ASCII     495  20    
Cha_Field5     ASCII     515  20    
c_Inv_No2      ASCII     535  50    
c_Inv_No       ASCII     585  20    Srt Inv_No
ABS_INVAMT     ACL       605  12 0  
ABS_INVAMT_CENT ACL       617  12 4  
c_Inv_Dt       ASCII     629   8    
Vndr_Mstr_ID   ASCII     637  20    
Vndr_Nme       ASCII     657  73    
Vndr_Sts       ASCII     730   1    
Vndr_Typ       ASCII     731  11    
SORT_KEY       ASCII     742  30    
SORT_KEY_Desc  ASCII     772  16    
RptRunDate     DATETIME  788   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Data_Range_Start_Date DATETIME  796   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME  804   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
Priority       ASCII     812   1    
TEST_NAME      ASCII     813  71    
^LAYOUT   VM008_Can_ABN                      1264 D.T,
!"VM008Z_Can_ABN_Sum" "IDX_VM008Z_VndrSiteID" Vndr_Site_ID
Vndr_Site_ID   ASCII       1  20    
Co             ASCII      21  20    
Vndr_ID        ASCII      41  20    
Vndr_Nme       ASCII      61  73    
ABN            ASCII     134  20    
Vndr_Sts       ASCII     154   1    
Vndr_Typ       ASCII     155  11    
Vndr_Add_Typ   ASCII     166  15    
ADD1           ASCII     181 125    
ADD2           ASCII     306  61    
ADD3           ASCII     367  61    
City           ASCII     428  35    
State          ASCII     463  29    
Pcode          ASCII     492  12    
Cntry          ASCII     504  61    
TEL1           ASCII     565  21    
TEL2           ASCII     586  21    
TEL3           ASCII     607  21    
FAX            ASCII     628  21    
Email1         ASCII     649  60    
Email2         ASCII     709  60    
Pymnt_Trm      ASCII     769  21    
Created_Dt     DATETIME  790   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  798   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  806   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     814  30    
Cha_Field2     ASCII     844  30    
Cha_Field3     ASCII     874   3    
Cha_Field4     ASCII     877  20    
Cha_Field5     ASCII     897  20    
Num_Field1     ACL       917  12 2  
Num_Field2     ACL       929  12 2  
Num_Field3     ACL       941  12 2  
Num_Field4     ACL       953  12 2  
Num_Field5     ACL       965  12 2  
Dt_Field1      DATETIME  977   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  985   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  993   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1001  20    
Max_Inv_Dt     DATETIME 1021   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1029  20    
ASIC_entityStatusCode ASCII    1049  21    
ASIC_entityStatusEF DATETIME 1070   8   PICTURE "YYYYMMDD"  
ASIC_GST_effFrom DATETIME 1078   8   PICTURE "YYYYMMDD"  
ASIC_GST_effTo DATETIME 1086   8   PICTURE "YYYYMMDD"  
ASIC_entityDescription ASCII    1094  50    
Inv_Amt        ACL      1144  12 2  
GST_Amt        ACL      1156  12 2  
COUNT          ACL      1168  12 0 WIDTH 8  
ID_KEY         ASCII    1180  85    
SORT_KEY       COMPUTED             
 *C 15 1 
 ZONED(VM008Z_Can_ABN_Sum.Inv_Amt,15)
SORT_KEY_Desc  COMPUTED             
 *C 32 1 
 "Total_InvAmt_Post_Cancelled_Date"
RptRunDate     COMPUTED            AS "Report Run Date" WIDTH 27  
 *D 1 16
 _RptRunDate
Priority       COMPUTED             
 *C 1 1 
 "H"
TEST_NAME      COMPUTED             
 *C 42 1 
 "VM008. Identify Deregistered/Cancelled ABN"
^LAYOUT   TMP_VM008D                         446 D.T,
Vendor_Site    ASCII       1  30   AS "Vendor Site"  
Vendor_Number  ASCII      31  20   AS "Vendor Number"  
Vendor_Name    ASCII      51  73   AS "Vendor Name"  
Vendor_Status  ASCII     124   1   AS "Vendor Status"  
Invoice_Reference ASCII     125  51   AS "Invoice Reference"  
Invoice_Date   ASCII     176  12   AS "Invoice Date"  
Invoice_Amount ACL       188  12 2 AS "Invoice Amount"  
Vendor_Site_ID ASCII     200  20   AS "Vendor Site ID"  
Vendor_ID      ASCII     220  20   AS "Vendor ID"  
Trans_Num      ASCII     240  10   AS "Trans Num"  
Pay_Method     ASCII     250  20   AS "Pay Method"  
Payment_Method ASCII     270  21   AS "Payment Method"  
TEST_NAME      ASCII     291  71    
Test_Date      ASCII     362  12   AS "Test Date"  
Data_Range_Start_Date ASCII     374  12    
Data_Range_End_Date ASCII     386  12    
SORT_KEY       ASCII     398  29    
SORT_KEY_Desc  ASCII     427  20    
^LAYOUT   VM009_Invld_ABN_ABR                1375 D.T,
!"VM009Z_Invld_ABN_ABR_Sum" "IDX_VM009Z_VndrSiteID" Vndr_Site_ID
!"AP_Vnd_InvGst_Sum" "IDX_AP_Sum_VndrID" Vndr_ID
Vndr_Site_ID   ASCII       1  20    
Co             ASCII      21  20    
Vndr_ID        ASCII      41  20    
Vndr_Nme       ASCII      61  73    
ABN            ASCII     134  20    
Vndr_Sts       ASCII     154   1    
Vndr_Typ       ASCII     155  11    
Vndr_Add_Typ   ASCII     166  15    
ADD1           ASCII     181 125    
ADD2           ASCII     306  61    
ADD3           ASCII     367  61    
City           ASCII     428  35    
State          ASCII     463  29    
Pcode          ASCII     492  12    
Cntry          ASCII     504  61    
TEL1           ASCII     565  21    
TEL2           ASCII     586  21    
TEL3           ASCII     607  21    
FAX            ASCII     628  21    
Email1         ASCII     649  60    
Email2         ASCII     709  60    
Pymnt_Trm      ASCII     769  21    
Created_Dt     DATETIME  790   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  798   8   PICTURE "YYYYMMDD"  
Vndr_InvlDt    DATETIME  806   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     814  30    
Cha_Field2     ASCII     844  30    
Cha_Field3     ASCII     874   3    
Cha_Field4     ASCII     877  20    
Cha_Field5     ASCII     897  20    
Num_Field1     ACL       917  12 2  
Num_Field2     ACL       929  12 2  
Num_Field3     ACL       941  12 2  
Num_Field4     ACL       953  12 2  
Num_Field5     ACL       965  12 2  
Dt_Field1      DATETIME  977   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  985   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  993   8   PICTURE "YYYYMMDD"  
ABN_CLN        ASCII    1001  20    
Max_Inv_Dt     DATETIME 1021   8   PICTURE "YYYYMMDD" WIDTH 27  
c_Vndr_ID      ASCII    1029  20    
ASIC_entityStatusCode ASCII    1049  21    
ASIC_entityStatusEF DATETIME 1070   8   PICTURE "YYYYMMDD"  
ASIC_GST_effFrom DATETIME 1078   8   PICTURE "YYYYMMDD"  
ASIC_GST_effTo DATETIME 1086   8   PICTURE "YYYYMMDD"  
ASIC_entityDescription ASCII    1094  50    
Inv_Amt        ACL      1144  12 2  
GST_Amt        ACL      1156  12 2  
COUNT          ACL      1168  12 0 WIDTH 8  
ID_KEY         ASCII    1180  85    
SORT_KEY       ASCII    1265  25    
SORT_KEY_Desc  ASCII    1290  20    
RptRunDate     DATETIME 1310   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Priority       ASCII    1318   1    
TEST_NAME      ASCII    1319  57    
^LAYOUT   VM009D_Invld_ABN_ABR               897 D.T,
!"VM009_Invld_ABN_ABR" "IDX_VM009_VndrSiteID" Vndr_Site_ID
Vchr_ID        ASCII       1  10    
Vndr_Site_ID   ASCII      11  20    
Vndr_ID        ASCII      31  20    
Doc_Typ        ASCII      51  10    
Inv_Dt         DATETIME   61   8   PICTURE "YYYYMMDD" WIDTH 27  
Inv_No         ASCII      69  50    
Inv_Amt        ACL       119  12 2  
Inv_Amt_Doc    ACL       131  12 2  
Curncy         ASCII     143  15    
Ex_Rate        ACL       158  12 2  
Inv_Net_Amt    ACL       170  12 2  
GST_Amt        ACL       182  12 2  
Btch_No        ASCII     194  15    
Due_Dt         DATETIME  209   8   PICTURE "YYYYMMDD"  
PO_No          ASCII     217  21    
PO_Net_Amt     ACL       238  12 2  
Descrp         ASCII     250  31    
Pd_Dt          DATETIME  281   8   PICTURE "YYYYMMDD"  
Pymnt_Trms     ASCII     289  21    
Modf_Dt        DATETIME  310   8   PICTURE "YYYYMMDD"  
Modf_By        ASCII     318  15    
Pst_Dt         DATETIME  333   8   PICTURE "YYYYMMDD"  
VOIDED         ASCII     341   1    
Void_Dt        DATETIME  342   8   PICTURE "YYYYMMDD"  
isPaid         ASCII     350   1    
Num_Field1     ACL       351  12 2  
Num_Field2     ACL       363  12 2  
Num_Field3     ACL       375  12 2  
Num_Field4     ACL       387  12 2  
Num_Field5     ACL       399  12 2  
Dt_Field1      DATETIME  411   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  419   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  427   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     435  20    
Cha_Field2     ASCII     455  20    
Cha_Field3     ASCII     475  20    
Cha_Field4     ASCII     495  20    
Cha_Field5     ASCII     515  20    
c_Inv_No2      ASCII     535  50    
c_Inv_No       ASCII     585  20    Srt Inv_No
ABS_INVAMT     ACL       605  12 0  
ABS_INVAMT_CENT ACL       617  12 4  
c_Inv_Dt       ASCII     629   8    
Vndr_Mstr_ID   ASCII     637  20    
Vndr_Nme       ASCII     657  73    
Vndr_Sts       ASCII     730   1    
Vndr_Typ       ASCII     731  11    
SORT_KEY       ASCII     742  29    
SORT_KEY_Desc  ASCII     771  20    
Priority       ASCII     791   1    
RptRunDate     DATETIME  792   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Data_Range_Start_Date DATETIME  800   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME  808   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
TEST_NAME      ASCII     816  74    
ASIC_entityStatusEF DATETIME  890   8   PICTURE "YYYYMMDD"  
^LAYOUT   Sales_orders                        81 D.T,
so_number      ASCII       1  12   AS "Sales Order;Number" WIDTH 10  
sales_order_amount NUMERIC    13  12 2 PICTURE "(9,999,999.99)" AS "Sales Order;Amount" WIDTH 12  
items_ordered  NUMERIC    25   6 0 PICTURE "(9,999,999)" AS "Items;Ordered" WIDTH 6  
so_date        DATETIME   31   8   PICTURE "YYYYMMDD" WIDTH 27  
customer_number ASCII      39   7   AS "Customer;Number" WIDTH 8  
created_by     ASCII      46  10   AS "Created;By" WIDTH 8  
created_on     DATETIME   56   8   PICTURE "YYYYMMDD" WIDTH 27  
approved_by    ASCII      64  10   AS "Approved;By" WIDTH 8  
approved_on    DATETIME   74   8   PICTURE "YYYYMMDD" WIDTH 27  
^LAYOUT   Sales_orders_items                  59 D.T,
so_number      ASCII       1  12   AS "Sales Order;Number" WIDTH 10  
item_number    ASCII      13   3   AS "Item;Number" WIDTH 5  
inventory_number ASCII      16  16   AS "Inventory;Number"  
purchase_quantity NUMERIC    32   6 0 PICTURE "(9,999,999)" AS "Purchase;Quantity" WIDTH 6  
unit_cost      NUMERIC    38  10 2 PICTURE "(9,999,999.99)" AS "Unit;Cost" WIDTH 10  
total_amount   NUMERIC    48  12 2 PICTURE "(9,999,999.99)" AS "Total;Cost" WIDTH 12  
^LAYOUT   Sales_cashiers                     81 D.T,
transaction_number ASCII       1  12   AS "Transaction;Number" WIDTH 10  
transaction_amount NUMERIC    13  12 2 PICTURE "(9,999,999.99)" AS "Transaction;Amount" WIDTH 12  
items_purchased NUMERIC    25   6 0 PICTURE "(9,999,999)" AS "Items;Purchased" WIDTH 6  
purchase_date  DATETIME   31   8   PICTURE "YYYYMMDD" WIDTH 27  
customer_number ASCII      39   7   AS "Customer;Number" WIDTH 8  
created_by     ASCII      46  10   AS "Created;By" WIDTH 8  
created_on     DATETIME   56   8   PICTURE "YYYYMMDD" WIDTH 27  
approved_by    ASCII      64  10   AS "Approved;By" WIDTH 8  
approved_on    DATETIME   74   8   PICTURE "YYYYMMDD" WIDTH 27  
^LAYOUT   Sales_cashiers_items               59 D.T,
transaction_number ASCII       1  12   AS "Transaction;Number" WIDTH 10  
item_number    ASCII      13   3   AS "Item;Number" WIDTH 5  
inventory_number ASCII      16  16   AS "Inventory;Number" WIDTH 12  
purchase_quantity NUMERIC    32   6 0 PICTURE "(9,999,999)" AS "Purchase;Quantity" WIDTH 6  
unit_cost      NUMERIC    38  10 2 PICTURE "(9,999,999.99)" AS "Unit;Cost" WIDTH 8  
total_amount   NUMERIC    48  12 2 PICTURE "(9,999,999.99)" AS "Total;Amount" WIDTH 10  
^LAYOUT   Payments                           111 D.T,
payment_number ASCII       1  12   AS "Payment;Number" WIDTH 10  
payment_date   DATETIME   13   8   PICTURE "YYYYMMDD" WIDTH 27  
payment_amount NUMERIC    21  14 2 PICTURE "(9,999,999.99)" AS "Payment;Amount" WIDTH 12  
vendor_number  ASCII      35  17   AS "Vendor;Number" WIDTH 10  
check_number   ASCII      52  12   AS "Check;Number" WIDTH 10  
voucher_number ASCII      64  12   AS "Voucher;Number" WIDTH 10  
created_by     ASCII      76  10   AS "Created;By" WIDTH 8  
created_on     DATETIME   86   8   PICTURE "YYYYMMDD" WIDTH 27  
approved_by    ASCII      94  10   AS "Approved;By" WIDTH 8  
approved_on    DATETIME  104   8   PICTURE "YYYYMMDD" WIDTH 27  
^LAYOUT   Purchase_orders                    99 D.T,
po_number      ASCII       1  12   AS "Purchase Order;Number" WIDTH 10  
po_date        DATETIME   13   8   PICTURE "YYYYMMDD" WIDTH 27  
vendor_number  ASCII      21  17   AS "Vendor;Number" WIDTH 10  
po_amount      NUMERIC    38  14 2 PICTURE "(9,999,999.99)" AS "Purchase Order;Amount" WIDTH 12  
requisition_number ASCII      52  12   AS "Requisition;Number" WIDTH 10  
created_on     DATETIME   64   8   PICTURE "YYYYMMDD" WIDTH 27  
created_by     ASCII      72  10   AS "Created;By" WIDTH 8  
approved_on    DATETIME   82   8   PICTURE "YYYYMMDD" WIDTH 27  
approved_by    ASCII      90  10   AS "Approved;By" WIDTH 8  
^LAYOUT   Purchase_orders_items              58 D.T,
po_number      ASCII       1  12   AS "Purchase Order;Number" WIDTH 10  
line_number    ACL        13  12 0 AS "Line;Number" WIDTH 5  
inventory_number ASCII      25  16   AS "Inventory;Number" WIDTH 12  
quantity       NUMERIC    41   8 0 PICTURE "(9,999,999)" AS ";Quantity" WIDTH 8  
unit_cost      NUMERIC    49  10 2 PICTURE "(9,999,999.99)" AS ";Unit Cost" WIDTH 10  
^LAYOUT   Vouchers                           113 D.T,
voucher_number ASCII       1  12   AS "Voucher;Number" WIDTH 10  
voucher_date   DATETIME   13   8   PICTURE "YYYYMMDD" WIDTH 27  
vendor_number  ASCII      21  17   AS "Vendor;Number" WIDTH 15  
po_number      ASCII      38  12   AS "Purchase Order;Number" WIDTH 10  
reference_number ASCII      50  12   AS "Reference;Number" WIDTH 10  
items_listed   NUMERIC    62   4 0 PICTURE "(9,999,999)" AS "Items;Listed" WIDTH 4  
voucher_amount NUMERIC    66  12 2 PICTURE "(9,999,999.99)" AS "Voucher;Amount" WIDTH 12  
created_by     ASCII      78  10   AS "Created;By" WIDTH 8  
created_on     DATETIME   88   8   PICTURE "YYYYMMDD" WIDTH 27  
approved_by    ASCII      96  10   AS "Approved;By" WIDTH 8  
approved_on    DATETIME  106   8   PICTURE "YYYYMMDD" WIDTH 27  
^LAYOUT   Vouchers_items                     56 D.T,
voucher_number ASCII       1  12   AS "Voucher;Number" WIDTH 10  
item_number    ACL        13  12 0 AS "Item;Number" WIDTH 5  
inventory_number ASCII      25  16   AS "Inventory;Number" WIDTH 15  
purchase_quantity NUMERIC    41   6 0 PICTURE "(9,999,999)" AS "Purchase;Quantity" WIDTH 6  
unit_cost      NUMERIC    47  10 2 PICTURE "(9,999,999.99)" AS "Unit;Cost" WIDTH 10  
^LAYOUT   FIL_TMP                            316 D.T,
FILE_NAME      ASCII       1 256   AS "FileName" WIDTH 35  
FILE_SIZE      ACL       257  12 0 AS "File;Size" WIDTH 16  
FILE_ATTRIBUTES ASCII     269   6   AS "Attributes"  
FILE_CREATE_DATE DATETIME  275   8   PICTURE "YYYYMMDD" AS "Create;Date"  
FILE_CREATE_TIME DATETIME  283   6   PICTURE "hhmmss" AS "Create;Time" WIDTH 14  
FILE_ACCESS_DATE DATETIME  289   8   PICTURE "YYYYMMDD" AS "Access;Date"  
FILE_ACCESS_TIME DATETIME  297   6   PICTURE "hhmmss" AS "Access;Time" WIDTH 14  
FILE_WRITE_DATE DATETIME  303   8   PICTURE "YYYYMMDD" AS "Modified;Date"  
FILE_WRITE_TIME DATETIME  311   6   PICTURE "hhmmss" AS "Modified;Time" WIDTH 14  
RECNUM         COMPUTED             
 *N 0 1
 RECNO()
^LAYOUT   TEMP_1234                          316 D.T,
FILE_NAME      ASCII       1 256   AS "FileName" WIDTH 35  
FILE_SIZE      ACL       257  12 0 AS "File;Size" WIDTH 16  
FILE_ATTRIBUTES ASCII     269   6   AS "Attributes"  
FILE_CREATE_DATE DATETIME  275   8   PICTURE "YYYYMMDD" AS "Create;Date"  
FILE_CREATE_TIME DATETIME  283   6   PICTURE "hhmmss" AS "Create;Time" WIDTH 14  
FILE_ACCESS_DATE DATETIME  289   8   PICTURE "YYYYMMDD" AS "Access;Date"  
FILE_ACCESS_TIME DATETIME  297   6   PICTURE "hhmmss" AS "Access;Time" WIDTH 14  
FILE_WRITE_DATE DATETIME  303   8   PICTURE "YYYYMMDD" AS "Modified;Date"  
FILE_WRITE_TIME DATETIME  311   6   PICTURE "hhmmss" AS "Modified;Time" WIDTH 14  
RECNUM         COMPUTED             
 *N 0 1
 RECNO()
^LAYOUT   Invoices                           122 D.T,
invoice_number ASCII       1  12   AS "Invoice;Number" WIDTH 10  
so_number      ASCII      13  12   AS "Sales Order;Number" WIDTH 10  
customer_number ASCII      25   7   AS "Customer;Number" WIDTH 5  
invoice_date   DATETIME   32   8   PICTURE "YYYYMMDD" WIDTH 27  
invoice_amount NUMERIC    40  14 2 PICTURE "(9,999,999.99)" AS "Invoice;Amount" WIDTH 14  
payment_status ASCII      54  11   AS "Payment;Status" WIDTH 8  
payment_date   DATETIME   65   8   PICTURE "YYYYMMDD" WIDTH 27  
payment_amount NUMERIC    73  14 2 PICTURE "(9,999,999.99)" AS "Payment;Amount" WIDTH 10  
created_by     ASCII      87  10   AS "Created;By" WIDTH 8  
created_on     DATETIME   97   8   PICTURE "YYYYMMDD" WIDTH 27  
approved_by    ASCII     105  10   AS "Approved;By" WIDTH 8  
approved_on    DATETIME  115   8   PICTURE "YYYYMMDD" WIDTH 27  
^LAYOUT   Shipments_items                    37 D.T,
shipping_number ASCII       1  12   AS "Shipping;Number" WIDTH 10  
item_number    ASCII      13   3   AS "Item;Number" WIDTH 5  
inventory_number ASCII      16  16   AS "Inventory;Number"  
ship_quantity  NUMERIC    32   6 0 PICTURE "(9,999,999)" AS "Ship;Quantity" WIDTH 8  
^LAYOUT   Shipments                          81 D.T,
shipping_number ASCII       1  12   AS "Shipping;Number" WIDTH 10  
so_number      ASCII      13  12   AS "Sales Order;Number" WIDTH 10  
ship_date      DATETIME   25   8   PICTURE "YYYYMMDD" WIDTH 27  
items_shipped  NUMERIC    33   6 0 PICTURE "(9,999,999)" AS "Items;Shipped" WIDTH 6  
customer_number ASCII      39   7   AS "Customer;Number" WIDTH 6  
created_by     ASCII      46  10   AS "Created;By" WIDTH 8  
created_on     DATETIME   56   8   PICTURE "YYYYMMDD" WIDTH 27  
approved_by    ASCII      64  10   AS "Approved;By" WIDTH 8  
approved_on    DATETIME   74   8   PICTURE "YYYYMMDD" WIDTH 27  
^LAYOUT   Inventory                          150 D.T,
inventory_number ASCII       1  16   AS "Inventory;Number" WIDTH 12  
sic            ASCII      17   4   AS ";SIC"  
description    ASCII      21  50   AS ";Description" WIDTH 40  
location       ASCII      71  15   AS ";Location" WIDTH 10  
standard_cost  NUMERIC    86   8 2 PICTURE "(9,999.99)" AS "Standard;Cost" WIDTH 6  
max_discount   NUMERIC    94   5 2 PICTURE "(9,999.99)" AS "Maximum;Discount" WIDTH 6  
minimum_level  NUMERIC    99   8 0 PICTURE "(9,999,999)" AS "Minimum;Level" WIDTH 8  
maximum_level  NUMERIC   107   8 0 PICTURE "(9,999,999)" AS "Maximum;Level" WIDTH 8  
created_by     ASCII     115  10   AS "Created;By" WIDTH 8  
created_on     DATETIME  125   8   PICTURE "YYYYMMDD" WIDTH 27  
approved_by    ASCII     133  10   AS "Approved;By" WIDTH 8  
approved_on    DATETIME  143   8   PICTURE "YYYYMMDD" WIDTH 27  
^LAYOUT   Authorizations                     71 D.T,
employee_number ASCII       1  10   AS "Employee;Number"  
system         ASCII      11   2   AS ";System" WIDTH 5  
process        ASCII      13   2   AS ";Process" WIDTH 5  
view           ASCII      15   1   AS ";View" WIDTH 7  
create         ASCII      16   1   AS ";Create" WIDTH 7  
approve        ASCII      17   1   AS ";Approve" WIDTH 7  
modify         ASCII      18   1   AS ";Modify" WIDTH 7  
delete         ASCII      19   1   AS ";Delete" WIDTH 7  
limit          NUMERIC    20  16 2 PICTURE "(9,999,999)" AS ";Limit" WIDTH 7  
created_by     ASCII      36  10   AS "Created;By" WIDTH 8  
created_on     DATETIME   46   8   PICTURE "YYYYMMDD" WIDTH 27  
approved_by    ASCII      54  10   AS "Approved;By" WIDTH 8  
approved_on    DATETIME   64   8   PICTURE "YYYYMMDD" WIDTH 27  
^LAYOUT   Customers                          109 D.T,
customer_number ASCII       1   7   AS "Customer;Number" WIDTH 8  
customer_name  ASCII       8  30   AS "Customer;Name" WIDTH 13  
type           ASCII      38  12   AS ";Type" WIDTH 6  
credit_limit   NUMERIC    50  16 2 PICTURE "(9,999,999)" AS "Credit;Limit" WIDTH 7  
start_date     DATETIME   66   8   PICTURE "YYYYMMDD" WIDTH 27  
created_by     ASCII      74  10   AS "Created;By" WIDTH 8  
created_on     DATETIME   84   8   PICTURE "YYYYMMDD" WIDTH 27  
approved_by    ASCII      92  10   AS "Approved;By" WIDTH 8  
approved_on    DATETIME  102   8   PICTURE "YYYYMMDD" WIDTH 27  
^LAYOUT   _OLD_EM001_History                 1433 D.T,
c_Tax_Fle_Num  ASCII       1  21    
Co_Emp_ID      ASCII      22  20    
Co             ASCII      42  20    
COST_CENTRE    ASCII      62  20    
EMP_Sts        ASCII      82   1    
Emp_ID         ASCII      83  20    
Tax_Fle_Num    ASCII     103  20    
Tax_Scale      ASCII     123   9    
Title          ASCII     132   5    
Frst_Nme       ASCII     137  20    
Second_Given_Name ASCII     157  20    
Sur_Nme        ASCII     177  20    
ADD1           ASCII     197  61    
ADD2           ASCII     258  61    
ADD3           ASCII     319  61    
City           ASCII     380  35    
State          ASCII     415  29    
Pcode          ASCII     444  11    
Cntry          ASCII     455  61    
TEL1           ASCII     516  21    
TEL2           ASCII     537  21    
TEL3           ASCII     558  21    
Fax            ASCII     579  21    
Email_Bus      ASCII     600  40    
Email_Privt    ASCII     640  36    
DOB            DATETIME  676   8   PICTURE "YYYYMMDD"  
Sex            ASCII     684   3    
Hire_Dt        DATETIME  687   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  695   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     703  30    
Mrtl_Sts       ASCII     733  14    
Pref_Nme       ASCII     747  22    
Prev_Sur_Nme   ASCII     769  16    
PAY_CLASS_CODE ASCII     785  14    
PAY_RATE       ACL       799  12 4  
AVG_TRANS_RATE ACL       811  12 2  
YEARLY_SALARY  ACL       823  12 2  
AUTOPAY_HOURS_DAYS ASCII     835  15    
Emp_Catg       ASCII     850  40    
Created_Dt     DATETIME  890   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  898   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     906  20    
Cha_Field2     ASCII     926  20    
Cha_Field3     ASCII     946  20    
Cha_Field4     ASCII     966  20    
Cha_Field5     ASCII     986  20    
Emp_Nme        ASCII    1006  65    
c_Hire_Dt      ASCII    1071   8    
BSB            ASCII    1079  20    
Bnk_Acc_Num    ASCII    1099  20    
BSB_NAME       ASCII    1119  60    
Bnk_Acc_Name   ASCII    1179  60    
Invalid_TFN    ASCII    1239   1    
Total_PayAmt   ACL      1240  12 2  
Total_Pay_Num  ACL      1252  12 0  
BSB2           ASCII    1264  20    
Bnk_Acc_Num2   ASCII    1284  20    
Total_PayAmt2  ACL      1304  12 2  
Total_Pay_Num2 ACL      1316  12 0  
Invalid_TFN2   ASCII    1328   1    
DUP_KEY        ASCII    1329  20    
ID_KEY         ASCII    1349  85    
^LAYOUT   _OLD_EM002_History                 1654 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        ASCII     985  65    
c_Hire_Dt      ASCII    1050   8    
BSB            ASCII    1058  20    
Bnk_Acc_Num    ASCII    1078  20    
BSB_NAME       ASCII    1098  60    
Bnk_Acc_Name   ASCII    1158  60    
Total_PayAmt   ACL      1218  12 2  
Total_Pay_Num  ACL      1230  12 0  
c_Tax_Fle_Num  ASCII    1242  21    
Invalid_TFN    ASCII    1263   1    
DUP_KEY        ASCII    1264  40    
Bnk_KEY        ASCII    1304  61    
Co_Emp_ID2     ASCII    1365  20    
BSB2           ASCII    1385  20    
Bnk_Acc_Num2   ASCII    1405  20    
BSB_NAME2      ASCII    1425  60    
Bnk_Acc_Name2  ASCII    1485  60    
Total_PayAmt2  ACL      1545  12 2  
Total_Pay_Num2 ACL      1557  12 0  
Invalid_TFN2   ASCII    1569   1    
ID_KEY         ASCII    1570  85    
^LAYOUT   _OLD_EM003_History                 1543 D.T,
c_Emp_Nme      ASCII       1  65    
Co_Emp_ID      ASCII      66  20    
Co             ASCII      86  20    
COST_CENTRE    ASCII     106  20    
EMP_Sts        ASCII     126   1    
Emp_ID         ASCII     127  20    
Tax_Fle_Num    ASCII     147  20    
Tax_Scale      ASCII     167   9    
Title          ASCII     176   5    
Frst_Nme       ASCII     181  20    
Second_Given_Name ASCII     201  20    
Sur_Nme        ASCII     221  20    
ADD1           ASCII     241  61    
ADD2           ASCII     302  61    
ADD3           ASCII     363  61    
City           ASCII     424  35    
State          ASCII     459  29    
Pcode          ASCII     488  11    
Cntry          ASCII     499  61    
TEL1           ASCII     560  21    
TEL2           ASCII     581  21    
TEL3           ASCII     602  21    
Fax            ASCII     623  21    
Email_Bus      ASCII     644  40    
Email_Privt    ASCII     684  36    
DOB            DATETIME  720   8   PICTURE "YYYYMMDD"  
Sex            ASCII     728   3    
Hire_Dt        DATETIME  731   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  739   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     747  30    
Mrtl_Sts       ASCII     777  14    
Pref_Nme       ASCII     791  22    
Prev_Sur_Nme   ASCII     813  16    
PAY_CLASS_CODE ASCII     829  14    
PAY_RATE       ACL       843  12 4  
AVG_TRANS_RATE ACL       855  12 2  
YEARLY_SALARY  ACL       867  12 2  
AUTOPAY_HOURS_DAYS ASCII     879  15    
Emp_Catg       ASCII     894  40    
Created_Dt     DATETIME  934   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  942   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     950  20    
Cha_Field2     ASCII     970  20    
Cha_Field3     ASCII     990  20    
Cha_Field4     ASCII    1010  20    
Cha_Field5     ASCII    1030  20    
Emp_Nme        ASCII    1050  65    
c_Hire_Dt      ASCII    1115   8    
BSB            ASCII    1123  20    
Bnk_Acc_Num    ASCII    1143  20    
BSB_NAME       ASCII    1163  60    
Bnk_Acc_Name   ASCII    1223  60    
Total_PayAmt   ACL      1283  12 2  
Total_Pay_Num  ACL      1295  12 0  
c_Tax_Fle_Num  ASCII    1307  21    
Invalid_TFN    ASCII    1328   1    
BSB2           ASCII    1329  20    
Bnk_Acc_Num2   ASCII    1349  20    
Total_PayAmt2  ACL      1369  12 2  
Total_Pay_Num2 ACL      1381  12 0  
Invalid_TFN2   ASCII    1393   1    
DUP_KEY        ASCII    1394  65    
ID_KEY         ASCII    1459  85    
^LAYOUT   _OLD_EM004_History                 1939 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        ASCII     985  65    
c_Hire_Dt      ASCII    1050   8    
BSB            ASCII    1058  20    
Bnk_Acc_Num    ASCII    1078  20    
BSB_NAME       ASCII    1098  60    
Bnk_Acc_Name   ASCII    1158  60    
Total_PayAmt   ACL      1218  12 2  
Total_Pay_Num  ACL      1230  12 0  
c_Tax_Fle_Num  ASCII    1242  21    
Invalid_TFN    ASCII    1263   1    
c_Emp_Nme      ASCII    1264  65    
DUP_KEY        ASCII    1329  61    
Add_KEY        ASCII    1390  81    
Dup_ADD1       ASCII    1471  61    
Dup_ADD2       ASCII    1532  61    
Dup_ADD3       ASCII    1593  61    
Dup_City       ASCII    1654  35    
Dup_State      ASCII    1689  29    
Dup_Pcode      ASCII    1718  11    
Dup_Cntry      ASCII    1729  61    
BSB2           ASCII    1790  20    
Bnk_Acc_Num2   ASCII    1810  20    
Total_PayAmt2  ACL      1830  12 2  
Total_Pay_Num2 ACL      1842  12 0  
Invalid_TFN2   ASCII    1854   1    
ID_KEY         ASCII    1855  85    
^LAYOUT   _OLD_EM005_History                 1604 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        ASCII     985  65    
c_Hire_Dt      ASCII    1050   8    
BSB            ASCII    1058  20    
Bnk_Acc_Num    ASCII    1078  20    
BSB_NAME       ASCII    1098  60    
Bnk_Acc_Name   ASCII    1158  60    
Total_PayAmt   ACL      1218  12 2  
Total_Pay_Num  ACL      1230  12 0  
c_Tax_Fle_Num  ASCII    1242  21    
Invalid_TFN    ASCII    1263   1    
c_Emp_Nme      ASCII    1264  65    
c_Tel1         ASCII    1329  21    
c_Tel2         ASCII    1350  21    
c_Tel3         ASCII    1371  21    
c_Fax          ASCII    1392  21    
DUP_KEY        ASCII    1413  21    
c_Tel          ASCII    1434  21    
BSB2           ASCII    1455  20    
Bnk_Acc_Num2   ASCII    1475  20    
Total_PayAmt2  ACL      1495  12 2  
Total_Pay_Num2 ACL      1507  12 0  
Invalid_TFN2   ASCII    1519   1    
ID_KEY         ASCII    1520  85    
^LAYOUT   _OLD_EM006_History                 2296 D.T,
EM006          ASCII       1   8    
Co_Emp_ID      ASCII       9  20    
Emp_ID         ASCII      29  20    
EM0062         ACL        49  12 0  
COUNT          ACL        61  12 0 WIDTH 8  
Co             ASCII      73  20    
COST_CENTRE    ASCII      93  20    
EMP_Sts        ASCII     113   1    
Tax_Fle_Num    ASCII     114  20    
Tax_Scale      ASCII     134   9    
Title          ASCII     143   5    
Frst_Nme       ASCII     148  20    
Second_Given_Name ASCII     168  20    
Sur_Nme        ASCII     188  20    
ADD1           ASCII     208  61    
ADD2           ASCII     269  61    
ADD3           ASCII     330  61    
City           ASCII     391  35    
State          ASCII     426  29    
Pcode          ASCII     455  11    
Cntry          ASCII     466  61    
TEL1           ASCII     527  21    
TEL2           ASCII     548  21    
TEL3           ASCII     569  21    
Fax            ASCII     590  21    
Email_Bus      ASCII     611  40    
Email_Privt    ASCII     651  36    
DOB            DATETIME  687   8   PICTURE "YYYYMMDD"  
Sex            ASCII     695   3    
Hire_Dt        DATETIME  698   8   PICTURE "YYYYMMDD"  
Trm_Dt         DATETIME  706   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     714  30    
Mrtl_Sts       ASCII     744  14    
Pref_Nme       ASCII     758  22    
Prev_Sur_Nme   ASCII     780  16    
PAY_CLASS_CODE ASCII     796  14    
PAY_RATE       ACL       810  12 4  
AVG_TRANS_RATE ACL       822  12 2  
YEARLY_SALARY  ACL       834  12 2  
AUTOPAY_HOURS_DAYS ASCII     846  15    
Emp_Catg       ASCII     861  40    
Created_Dt     DATETIME  901   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  909   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     917  20    
Cha_Field2     ASCII     937  20    
Cha_Field3     ASCII     957  20    
Cha_Field4     ASCII     977  20    
Cha_Field5     ASCII     997  20    
Emp_Nme        ASCII    1017  65    
c_Hire_Dt      ASCII    1082   8    
BSB            ASCII    1090  20    
Bnk_Acc_Num    ASCII    1110  20    
BSB_NAME       ASCII    1130  60    
Bnk_Acc_Name   ASCII    1190  60    
Total_PayAmt   ACL      1250  12 2  
Total_Pay_Num  ACL      1262  12 0  
Invalid_TFN    ASCII    1274   1    
c_Emp_Nme      ASCII    1275  65    
c_ADD          ASCII    1340 183    
c_Tel1         ASCII    1523  20    
c_Tel2         ASCII    1543  20    
c_Tel3         ASCII    1563  20    
c_Fax          ASCII    1583  20    
c_Tax_Fle_Num  ASCII    1603  20    
c_BSB          ASCII    1623  10    
c_Bnk_Acc_Num  ASCII    1633  20    
BSB2           ASCII    1653  20    
Bnk_Acc_Num2   ASCII    1673  20    
Total_PayAmt2  ACL      1693  12 2  
Total_Pay_Num2 ACL      1705  12 0  
Invalid_TFN2   ASCII    1717   1    
BSB3           ASCII    1718  20    
Bnk_Acc_Num3   ASCII    1738  20    
Total_PayAmt3  ACL      1758  12 2  
Total_Pay_Num3 ACL      1770  12 0  
Invalid_TFN3   ASCII    1782   1    
c_EM006        ASCII    1783   8    
Test_Name      ASCII    1791 170    
RptRunDate     DATETIME 1961   8   PICTURE "YYYYMMDD" WIDTH 27  
BSB4           ASCII    1969  20    
Bnk_Acc_Num4   ASCII    1989  20    
Total_PayAmt4  ACL      2009  12 2  
Total_Pay_Num4 ACL      2021  12 0  
Test_Name2     ASCII    2033 170    
RptRunDate2    DATETIME 2203   8   PICTURE "YYYYMMDD" WIDTH 27  
Invalid_TFN4   ASCII    2211   1    
ID_KEY         ASCII    2212  85    
^LAYOUT   Payroll                            90 D.T,
pay_period     ASCII       1   4   AS "Pay;Period" WIDTH 6  
payroll_date   DATETIME    5   8   PICTURE "YYYYMMDD" WIDTH 27  
gross_pay      NUMERIC    13  14 2 PICTURE "(9,999,999.99)" AS ";Gross Pay" WIDTH 14  
deducations    NUMERIC    27  14 2 PICTURE "(9,999,999.99)" AS ";Deductions" WIDTH 14  
net_pay        NUMERIC    41  14 2 PICTURE "(9,999,999.99)" AS ";Net Pay" WIDTH 14  
created_by     ASCII      55  10   AS "Created;By" WIDTH 8  
created_on     DATETIME   65   8   PICTURE "YYYYMMDD" WIDTH 27  
approved_by    ASCII      73  10   AS "Approved;By" WIDTH 8  
approved_on    DATETIME   83   8   PICTURE "YYYYMMDD" WIDTH 27  
^LAYOUT   Payroll_details                    56 D.T,
!"Payroll" "pay_period" pay_period
pay_period     ASCII       1   4   AS "Pay;Period" WIDTH 6  
employee_number ASCII       5  10   AS "Employee;Number" WIDTH 5  
gross_pay      NUMERIC    15  14 2 PICTURE "(9,999,999.99)" AS ";Gross Pay" WIDTH 14  
deducations    NUMERIC    29  14 2 PICTURE "(9,999,999.99)" AS ";Deductions" WIDTH 14  
net_pay        NUMERIC    43  14 2 PICTURE "(9,999,999.99)" AS ";Net Pay" WIDTH 14  
PayCode_Hours  COMPUTED             
 *N 0 1
 RAND(5678)
V_PAY_CDE      COMPUTED             
 *C 3 1 
 "001"
WEEKLY_HOURS   COMPUTED             
 *N 0 1
 40
V_PAY_CDE_DESC COMPUTED             
 *C 11 1 
 "MONTHLY PAY"
PER_YM         COMPUTED             
 *C 6 1 
 SUBSTR(DATE(Payroll.payroll_date) , 1 , 6)
Pay_Hrs        COMPUTED             
 *N 0 1
 RAND(5678)
^LAYOUT   DM_AP_Invoices                     76 D.T,
Std_Fld_Nme    ASCII       1  12    
Type           ASCII      13   7    
Length         NUMERIC    20   2 0  
Decimals       NUMERIC    22   1 0  
Field_explanation ASCII      23  34    
Src_File       ASCII      57  10    
Src_Fld_Nme    ASCII      67  10    
^LAYOUT   DM_AP_Payments                     76 D.T,
Std_Fld_Nme    ASCII       1  12    
Type           ASCII      13   7    
Length         NUMERIC    20   2 0  
Decimals       NUMERIC    22   1 0  
Field_explanation ASCII      23  34    
Src_File       ASCII      57  10    
Src_Fld_Nme    ASCII      67  10    
^LAYOUT   DM_AP_PO_Lines                     76 D.T,
Std_Fld_Nme    ASCII       1  12    
Type           ASCII      13   7    
Length         NUMERIC    20   2 0  
Decimals       NUMERIC    22   1 0  
Field_explanation ASCII      23  34    
Src_File       ASCII      57  10    
Src_Fld_Nme    ASCII      67  10    
^LAYOUT   DM_AP_InvPO                        76 D.T,
Std_Fld_Nme    ASCII       1   7    
Type           ASCII       8   5    
Length         NUMERIC    13   2 0  
Decimals       ASCII      15  10    
Field_explanation ASCII      25  32    
Src_File       ASCII      57  10    
Src_Fld_Nme    ASCII      67  10    
^LAYOUT   DM_VMF_Vnd_Master_File             80 D.T,
Std_Fld_Nme    ASCII       1  12    
Type           ASCII      13   7    
Length         NUMERIC    20   3 0  
Decimals       NUMERIC    23   1 0  
Field_explanation ASCII      24  37    
Src_File       ASCII      61   7    
Src_Fld_Nme    ASCII      68  13    
^LAYOUT   Vendors                            132 D.T,
vendor_number  ASCII       1  17   AS ";Vendor Number" WIDTH 15  
vendor_name    ASCII      18  30   AS ";Vendor Name" WIDTH 25  
address        ASCII      48  30   AS ";Vendor Address" WIDTH 20  
city           ASCII      78  15   AS ";Vendor City"  
sic            ASCII      93   4   AS ";SIC"  
created_by     ASCII      97  10   AS "Created;By" WIDTH 8  
created_on     DATETIME  107   8   PICTURE "YYYYMMDD" WIDTH 27  
approved_by    ASCII     115  10   AS "Approved;By" WIDTH 8  
approved_on    DATETIME  125   8   PICTURE "YYYYMMDD" WIDTH 27  
^LAYOUT   DM_VMF_Address                     84 D.T,
Std_Fld_Nme    ASCII       1  12    
Type           ASCII      13   5    
Length         NUMERIC    18   3 0  
Decimals       ASCII      21  10    
Field_explanation ASCII      31  34    
Src_File       ASCII      65  10    
Src_Fld_Nme    ASCII      75  10    
^LAYOUT   VMF_Address                        339 D.T,
Vndr_Site_ID   ASCII       1  20    
Vndr_ID        ASCII      21  20    
Vndr_Add_Typ   ASCII      41  15    
ADD1           ASCII      56  25    
ADD2           ASCII      81  61    
ADD3           ASCII     142  61    
City           ASCII     203  35    
State          ASCII     238  29    
Pcode          ASCII     267  12    
Cntry          ASCII     279  61    
^LAYOUT   DM_VMF_BnkAcc                      83 D.T,
Std_Fld_Nme    ASCII       1  12    
Type           ASCII      13   5    
Length         NUMERIC    18   2 0  
Decimals       ASCII      20  10    
Field_explanation ASCII      30  34    
Src_File       ASCII      64  10    
Src_Fld_Nme    ASCII      74  10    
^LAYOUT   DM_VMF_InterCompany                83 D.T,
Std_Fld_Nme    ASCII       1  12    
Type           ASCII      13   5    
Length         NUMERIC    18   2 0  
Decimals       ASCII      20  10    
Field_explanation ASCII      30  34    
Src_File       ASCII      64  10    
Src_Fld_Nme    ASCII      74  10    
^LAYOUT   DM_VMF_Vnd_OneTime                 83 D.T,
Std_Fld_Nme    ASCII       1  12    
Type           ASCII      13   5    
Length         NUMERIC    18   2 0  
Decimals       ASCII      20  10    
Field_explanation ASCII      30  34    
Src_File       ASCII      64  10    
Src_Fld_Nme    ASCII      74  10    
^LAYOUT   VMF_Chg_History                    699 D.T,
Vndr_Site_ID   ASCII       1  20    
Vndr_ID        ASCII      21  20    
Vndr_Nme       ASCII      41  73    
Vndr_Sts       ASCII     114   1    
Vndr_Typ       ASCII     115  11    
ABN            ASCII     126  20    
ABN_CLN        ASCII     146  20    
ADD1           ASCII     166 125    
ADD2           ASCII     291  61    
ADD3           ASCII     352  61    
City           ASCII     413  35    
State          ASCII     448  29    
TEL1           ASCII     477  21    
TEL2           ASCII     498  21    
TEL3           ASCII     519  21    
FAX            ASCII     540  21    
Email1         ASCII     561  60    
Email2         ASCII     621  60    
RptRunDateTime ASCII     681  19    
^LAYOUT   VMF_Vnd_OneTime                    105 D.T,
Vndr_Site_ID   ASCII       1  20    
Vndr_ID        ASCII      21  20    
Vndr_Nme       ASCII      41  65    
^LAYOUT   VMF_InterCompany                   105 D.T,
Vndr_Site_ID   ASCII       1  20    
Vndr_ID        ASCII      21  20    
Vndr_Nme       ASCII      41  65    
^LAYOUT   ABN_Temp                           32 D.T,
ABN_CLN        ASCII       1  20    
COUNT          ACL        21  12 0 WIDTH 8  
^LAYOUT   ABN                                20 D.T,
ABN_CLN        ASCII       1  20    
^LAYOUT   Employees                          301 D.T,
employee_number ASCII       1  10   AS "Employee;Number"  
first_name     ASCII      11  20   AS ";First Name" WIDTH 12  
last_name      ASCII      31  25   AS ";Last Name" WIDTH 12  
ssn            ASCII      56  12   AS ";SSN" WIDTH 8  
department     ASCII      68  30   AS ";Department" WIDTH 15  
position       ASCII      98  30   AS ";Position" WIDTH 18  
employee_type  ASCII     128   2   AS "Employee;Type" WIDTH 7  
hire_date      DATETIME  130   8   PICTURE "YYYYMMDD" WIDTH 27  
home_phone     ASCII     138  15   AS "Home;Phone" WIDTH 12  
home_address1  ASCII     153  50   AS "Home;Address" WIDTH 15  
home_city      ASCII     203  20   AS "Home;City" WIDTH 10  
home_state     ASCII     223   2   AS "Home;State" WIDTH 5  
home_zip       ASCII     225   5   AS "Home;Zip" WIDTH 7  
hourly_rate    NUMERIC   230   8 2 PICTURE "(9,999,999.99)" AS "Hourly;Rate" WIDTH 8  
salary         NUMERIC   238  10 0 PICTURE "(9,999,999)" AS ";Salary" WIDTH 10  
created_by     ASCII     248  10   AS "Created;By" WIDTH 8  
created_on     DATETIME  258   8   PICTURE "YYYYMMDD" WIDTH 27  
updated_by     ASCII     266  10   AS "Updated;By" WIDTH 8  
updated_on     DATETIME  276   8   PICTURE "YYYYMMDD" WIDTH 27  
approved_by    ASCII     284  10   AS "Approved;By" WIDTH 8  
approved_on    DATETIME  294   8   PICTURE "YYYYMMDD" WIDTH 27  
BANK_BSB       COMPUTED             
 *C 50 1 
 ALLTR(STRING(RAND(1234) , 50))
BANK_ACC       COMPUTED             
 *C 50 1 
 ALLTR(STRING(RAND(4321) , 50))
^LAYOUT   PAYROLL_DATA                       144 D.T,
WEEKLY_HOURS   ACL         1  12 0  
Pay_Hrs        ACL        13  12 0  
PER_YM         ASCII      25   6    
V_PAY_CDE_DESC ASCII      31  11    
V_PAY_CDE      ASCII      42   3    
pay_period     ASCII      45   4   AS "Pay;Period" WIDTH 6  
approved_by    ASCII      49  10   AS "Approved;By" WIDTH 8  
approved_on    DATETIME   59   8   PICTURE "YYYYMMDD" WIDTH 27  
created_by     ASCII      67  10   AS "Created;By" WIDTH 8  
created_on     DATETIME   77   8   PICTURE "YYYYMMDD" WIDTH 27  
employee_number ASCII      85  10   AS "Employee;Number" WIDTH 5  
gross_pay      NUMERIC    95  14 2 PICTURE "(9,999,999.99)" AS ";Gross Pay" WIDTH 14  
deducations    NUMERIC   109  14 2 PICTURE "(9,999,999.99)" AS ";Deductions" WIDTH 14  
net_pay        NUMERIC   123  14 2 PICTURE "(9,999,999.99)" AS ";Net Pay" WIDTH 14  
payroll_date   DATETIME  137   8   PICTURE "YYYYMMDD" WIDTH 27  
^LAYOUT   PayRoll_ForPrd_Sum                 597 D.T,
RUNID_ForPrd   ASCII       1  40    
PrdSalaryAmt   ACL        41  12 2  
ActPaidAmt     ACL        53  12 2  
PrdGrsAmt      ACL        65  12 2  
Prd_PayHrs     ACL        77  12 2  
COUNT          ACL        89  12 0 WIDTH 8  
Co_Emp_ID      ASCII     101  20    
Co             ASCII     121  20    
COST_CENTRE    ASCII     141  20    
Emp_ID         ASCII     161  20    
Period_Date    DATETIME  181   8   PICTURE "YYYYMMDD"  
PayCode        ASCII     189   7    
PayCode_Amount ACL       196  12 2  
Pay_Hrs        ACL       208  12 2  
LINE_NO        ASCII     220  20    
LINE_DESC      ASCII     240  60    
LINE_TYPE      ASCII     300  20    
PAY_GROUP      ASCII     320  20    
GL_Account_No  ASCII     340  20    
PERIOD         ASCII     360  20    
Standard_WeeklyHours ACL       380  12 2 WIDTH 20  
PayCode_Desc   ASCII     392  15    
Num_Field3     ACL       407  12 2  
Num_Field4     ACL       419  12 2  
Num_Field5     ACL       431  12 2  
Prd_Dt         DATETIME  443   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  451   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  459   8   PICTURE "YYYYMMDD"  
ForPrd         ASCII     467  20    
InPrd          ASCII     487  20    
Cha_Field3     ASCII     507  20    
Cha_Field4     ASCII     527  20    
Cha_Field5     ASCII     547  20    
Year           ASCII     567   4    
YM             ASCII     571   7    
c_Prd_Dt       ASCII     578   8    
ABS_PayCode_Amount ACL       586  12 0 WIDTH 18  
^LAYOUT   PayRoll_InPrd_Sum                  637 D.T,
RUNID_InPrd    ASCII       1  40    
PrdSalaryAmt   ACL        41  12 2  
ActPaidAmt     ACL        53  12 2  
PrdGrsAmt      ACL        65  12 2  
Prd_PayHrs     ACL        77  12 2  
COUNT          ACL        89  12 0 WIDTH 8  
Co_Emp_ID      ASCII     101  20    
Co             ASCII     121  20    
COST_CENTRE    ASCII     141  20    
Emp_ID         ASCII     161  20    
Period_Date    DATETIME  181   8   PICTURE "YYYYMMDD"  
PayCode        ASCII     189   7    
PayCode_Amount ACL       196  12 2  
Pay_Hrs        ACL       208  12 2  
LINE_NO        ASCII     220  20    
LINE_DESC      ASCII     240  60    
LINE_TYPE      ASCII     300  20    
PAY_GROUP      ASCII     320  20    
GL_Account_No  ASCII     340  20    
PERIOD         ASCII     360  20    
Standard_WeeklyHours ACL       380  12 2 WIDTH 20  
PayCode_Desc   ASCII     392  15    
Num_Field3     ACL       407  12 2  
Num_Field4     ACL       419  12 2  
Num_Field5     ACL       431  12 2  
Prd_Dt         DATETIME  443   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  451   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  459   8   PICTURE "YYYYMMDD"  
ForPrd         ASCII     467  20    
InPrd          ASCII     487  20    
Cha_Field3     ASCII     507  20    
Cha_Field4     ASCII     527  20    
Cha_Field5     ASCII     547  20    
Year           ASCII     567   4    
YM             ASCII     571   7    
c_Prd_Dt       ASCII     578   8    
ABS_PayCode_Amount ACL       586  12 0 WIDTH 18  
RUNID_ForPrd   ASCII     598  40    
^LAYOUT   EMF_Emp_Master_File                984 D.T,
!"EMF_BnkAcc" "IDX_Emp_BK_Co_Emp_ID" Co_Emp_ID
!"Payroll_Sum_12m" "IDX_Payroll_Sum_ID" Co_Emp_ID
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        COMPUTED             
 *C 65 1 
 SUBSTR(ALLTRIM(Sur_Nme)+" " + ALLTRIM(Second_Given_Name) +" "+ALLTRIM(Frst_Nme),1,65)
c_Hire_Dt      COMPUTED             
 *C 8 1 
 ALLTRIM(SUBSTR(DATE(Hire_Dt),7,4))+ALLTRIM(SUBSTR(DATE(Hire_Dt),4,2))+ALLTRIM(SUBSTR(DATE(Hire_Dt),1,2))
^LAYOUT   VMF_Vnd_Master_File                1000 D.T,
!"VMF_Vnd_OneTime" "IDX_VMF_OTV_VndrSiteID" Vndr_Site_ID
!"VMF_InterCompany" "IDX_VMF_InterCo_VndrSiteID" Vndr_Site_ID
!"VMF_BnkAcc" "IDX_VMFBK_VndrSiteID" Vndr_Site_ID
Co             ASCII       1  20    
Vndr_Site_ID   ASCII      21  20    
Vndr_ID        ASCII      41  20    
Vndr_Nme       ASCII      61  73    
ABN            ASCII     134  20    
Vndr_Sts       ASCII     154   1    
Vndr_InvlDt    DATETIME  155   8   PICTURE "YYYYMMDD"  
Vndr_Typ       ASCII     163  11    
Vndr_Add_Typ   ASCII     174  15    
ADD1           ASCII     189 125    
ADD2           ASCII     314  61    
ADD3           ASCII     375  61    
City           ASCII     436  35    
State          ASCII     471  29    
Pcode          ASCII     500  12    
Cntry          ASCII     512  61    
TEL1           ASCII     573  21    
TEL2           ASCII     594  21    
TEL3           ASCII     615  21    
FAX            ASCII     636  21    
Email1         ASCII     657  60    
Email2         ASCII     717  60    
Pymnt_Trm      ASCII     777  21    
Created_Dt     DATETIME  798   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  806   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     814  30    
Cha_Field2     ASCII     844  30    
Cha_Field3     ASCII     874   3    
Cha_Field4     ASCII     877  20    
Cha_Field5     ASCII     897  20    
Num_Field1     ACL       917  12 2  
Num_Field2     ACL       929  12 2  
Num_Field3     ACL       941  12 2  
Num_Field4     ACL       953  12 2  
Num_Field5     ACL       965  12 2  
Dt_Field1      DATETIME  977   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  985   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  993   8   PICTURE "YYYYMMDD"  
c_Vndr_ID      COMPUTED             
 *C 20 3 
 ALLTRIM(INCLUDE(Vndr_ID,"0123456789")) IF LENGTH(ALLTRIM(INCLUDE(Vndr_ID,"0123456789"))) > LENGTH(ALLTRIM(INCLUDE(UPPER(Vndr_ID),"ABCDEFGHIJKLMNOPQRSTUVWXYZ")))
 ALLTRIM(INCLUDE(UPPER(Vndr_ID),"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) IF LENGTH(ALLTRIM(INCLUDE(Vndr_ID,"0123456789"))) < LENGTH(ALLTRIM(INCLUDE(UPPER(Vndr_ID),"ABCDEFGHIJKLMNOPQRSTUVWXYZ")))
 Vndr_ID
InvABN         COMPUTED             
 *C 1 5 
 "T" IF (LAST( ALLTRIM( STRING( (1.00 * ((VALUE( SUBSTR(ABN_CLN, 1, 1), 0) - 1) * 10 + (VALUE( SUBSTR( ABN_CLN, 2, 1), 0) * 1) + (VALUE( SUBSTR( ABN_CLN, 3, 1), 0) * 3) + (VALUE( SUBSTR( ABN_CLN, 4, 1), 0) * 5) + (VALUE( SUBSTR( ABN_CLN, 5, 1), 0) * 7) + (VALUE( SUBSTR( ABN_CLN, 6, 1), 0) * 9) + (VALUE( SUBSTR( ABN_CLN, 7, 1), 0) * 11) + (VALUE( SUBSTR( ABN_CLN, 8, 1), 0) * 13) + (VALUE( SUBSTR( ABN_CLN, 9, 1), 0) * 15) + (VALUE( SUBSTR( ABN_CLN, 10, 1), 0) * 17) + (VALUE( SUBSTR( ABN_CLN, 11, 1), 0) * 19))) / 89.00, 12 )), 2) <> "00"  OR ((NOT MAP( ABN_CLN, "99999999999") OR (LENGTH( ALLTRIM( ABN_CLN)) <>11)))) AND LENGTH(ALLTRIM(ABN_CLN))>1 AND MATCH(UPPER(Cntry),"AU","AUST","AUS","AUSTRALIA"," ")
 "M" IF LENGTH(ALLTRIM(ABN_CLN))<=1 AND VALUE(ABN_CLN,0) =0 AND MATCH(UPPER(Cntry),"AU","AUST","AUS","AUSTRALIA"," ")
 "O" IF NOT MATCH(UPPER(Cntry),"AU","AUST","AUS","AUSTRALIA"," ")
 "E" IF MATCH(Vndr_Typ,"1E","2E","3E")
 "F"
ABN_CLN        COMPUTED             
 *C 20 1 
 SUBSTR(ALLTRIM(INCLUDE(ABN,"0123456789")),1,20)
Bnk_Acc_Num    COMPUTED             
 *C 28 1 
 VMF_BnkAcc.Bnk_Acc_Num
BSB            COMPUTED             
 *C 12 1 
 VMF_BnkAcc.BSB
Inv_Amt        COMPUTED             
 *N 2 1
 0.00
GST_Amt        COMPUTED             
 *N 2 1
 0.00
COUNT          COMPUTED             
 *N 0 1
 0
^LAYOUT   VMF_BnkAcc                         186 D.T,
!"VMF_Vnd_Master_File" "IDX_VndrSiteID" Vndr_Site_ID
Vndr_Site_ID   ASCII       1  16    
Vndr_ID        ASCII      17  11    
BSB            ASCII      28  12    
Bnk_Acc_Num    ASCII      40  28    
BSB_NAME       ASCII      68  12    
Bnk_Acc_Name   ASCII      80  48    
Bnk_Acc_Type   ASCII     128  20    
Chg_Dt         DATETIME  148   8   PICTURE "YYYYMMDD"  
Dt_Field1      DATETIME  156   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  164   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     172   3    
COUNT          ACL       175  12 0 WIDTH 8  
^LAYOUT   Vnd_Emp_Master                     788 D.T,
VM_EM          ASCII       1   2    
Vndr_Site_ID   ASCII       3  20    
Vndr_Sts       ASCII      23   2    
Vndr_ID        ASCII      25  20    
Vndr_Nme       ASCII      45  65    
Vndr_Typ       ASCII     110  20    
ADD1           ASCII     130  61    
ADD2           ASCII     191  61    
ADD3           ASCII     252  61    
City           ASCII     313  35    
State          ASCII     348  29    
PCode          ASCII     377  11    
Cntry          ASCII     388  61    
TEL1           ASCII     449  21    
TEL2           ASCII     470  21    
TEL3           ASCII     491  21    
FAX            ASCII     512  21    
ABN            ASCII     533  20    
BSB            ASCII     553  20    
Bnk_Acc_Num    ASCII     573  20    
Email1         ASCII     593  60    
Email2         ASCII     653  60    
Inv_Amt        ACL       713  12 2  
GST_Amt        ACL       725  12 2  
COUNT          ACL       737  12 0  
Hire_Dt        ASCII     749  10    
Trm_Dt         ASCII     759  10    
Created_Dt     ASCII     769  10    
Modf_Dt        ASCII     779  10    
KEY1           COMPUTED             
 *C 22 1 
 SUBSTR(ALLTRIM(VM_EM)+ALLTRIM(Vndr_ID),1,22)
KEY            COMPUTED             
 *C 22 1 
 SUBSTR(ALLTRIM(VM_EM)+ALLTRIM(Vndr_Site_ID),1,22)
^LAYOUT   EM001_History                      1433 D.T,
c_Tax_Fle_Num  ASCII       1  21    
Co_Emp_ID      ASCII      22  20    
Co             ASCII      42  20    
COST_CENTRE    ASCII      62  20    
EMP_Sts        ASCII      82   1    
Emp_ID         ASCII      83  20    
Tax_Fle_Num    ASCII     103  20    
Tax_Scale      ASCII     123   9    
Title          ASCII     132   5    
Frst_Nme       ASCII     137  20    
Second_Given_Name ASCII     157  20    
Sur_Nme        ASCII     177  20    
ADD1           ASCII     197  61    
ADD2           ASCII     258  61    
ADD3           ASCII     319  61    
City           ASCII     380  35    
State          ASCII     415  29    
Pcode          ASCII     444  11    
Cntry          ASCII     455  61    
TEL1           ASCII     516  21    
TEL2           ASCII     537  21    
TEL3           ASCII     558  21    
Fax            ASCII     579  21    
Email_Bus      ASCII     600  40    
Email_Privt    ASCII     640  36    
DOB            DATETIME  676   8   PICTURE "YYYYMMDD"  
Sex            ASCII     684   3    
Hire_Dt        DATETIME  687   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  695   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     703  30    
Mrtl_Sts       ASCII     733  14    
Pref_Nme       ASCII     747  22    
Prev_Sur_Nme   ASCII     769  16    
PAY_CLASS_CODE ASCII     785  14    
PAY_RATE       ACL       799  12 4  
AVG_TRANS_RATE ACL       811  12 2  
YEARLY_SALARY  ACL       823  12 2  
AUTOPAY_HOURS_DAYS ASCII     835  15    
Emp_Catg       ASCII     850  40    
Created_Dt     DATETIME  890   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  898   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     906  20    
Cha_Field2     ASCII     926  20    
Cha_Field3     ASCII     946  20    
Cha_Field4     ASCII     966  20    
Cha_Field5     ASCII     986  20    
Emp_Nme        ASCII    1006  65    
c_Hire_Dt      ASCII    1071   8    
BSB            ASCII    1079  20    
Bnk_Acc_Num    ASCII    1099  20    
BSB_NAME       ASCII    1119  60    
Bnk_Acc_Name   ASCII    1179  60    
Invalid_TFN    ASCII    1239   1    
Total_PayAmt   ACL      1240  12 2  
Total_Pay_Num  ACL      1252  12 0  
BSB2           ASCII    1264  20    
Bnk_Acc_Num2   ASCII    1284  20    
Total_PayAmt2  ACL      1304  12 2  
Total_Pay_Num2 ACL      1316  12 0  
Invalid_TFN2   ASCII    1328   1    
DUP_KEY        ASCII    1329  20    
ID_KEY         ASCII    1349  85    
^LAYOUT   EMF_BnkAcc                         228 D.T,
!"EMF_Emp_Master_File" "IDX_Co_Emp_ID" Co_Emp_ID
!"EMF_TMP_EMP" "IDX_EMF_Co_Emp_ID" Co_Emp_ID
Co_Emp_ID      ASCII       1  20    
Emp_ID         ASCII      21  20    
BSB            ASCII      41  20    
Bnk_Acc_Num    ASCII      61  20    
BSB_NAME       ASCII      81  60    
Bnk_Acc_Name   ASCII     141  60    
Bnk_Acc_Type   ASCII     201  20    
Chg_Dt         DATETIME  221   8   PICTURE "YYYYMMDD"  
^LAYOUT   EM002_History                      1654 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        ASCII     985  65    
c_Hire_Dt      ASCII    1050   8    
BSB            ASCII    1058  20    
Bnk_Acc_Num    ASCII    1078  20    
BSB_NAME       ASCII    1098  60    
Bnk_Acc_Name   ASCII    1158  60    
Total_PayAmt   ACL      1218  12 2  
Total_Pay_Num  ACL      1230  12 0  
c_Tax_Fle_Num  ASCII    1242  21    
Invalid_TFN    ASCII    1263   1    
DUP_KEY        ASCII    1264  40    
Bnk_KEY        ASCII    1304  61    
Co_Emp_ID2     ASCII    1365  20    
BSB2           ASCII    1385  20    
Bnk_Acc_Num2   ASCII    1405  20    
BSB_NAME2      ASCII    1425  60    
Bnk_Acc_Name2  ASCII    1485  60    
Total_PayAmt2  ACL      1545  12 2  
Total_Pay_Num2 ACL      1557  12 0  
Invalid_TFN2   ASCII    1569   1    
ID_KEY         ASCII    1570  85    
^LAYOUT   EM003_History                      1543 D.T,
c_Emp_Nme      ASCII       1  65    
Co_Emp_ID      ASCII      66  20    
Co             ASCII      86  20    
COST_CENTRE    ASCII     106  20    
EMP_Sts        ASCII     126   1    
Emp_ID         ASCII     127  20    
Tax_Fle_Num    ASCII     147  20    
Tax_Scale      ASCII     167   9    
Title          ASCII     176   5    
Frst_Nme       ASCII     181  20    
Second_Given_Name ASCII     201  20    
Sur_Nme        ASCII     221  20    
ADD1           ASCII     241  61    
ADD2           ASCII     302  61    
ADD3           ASCII     363  61    
City           ASCII     424  35    
State          ASCII     459  29    
Pcode          ASCII     488  11    
Cntry          ASCII     499  61    
TEL1           ASCII     560  21    
TEL2           ASCII     581  21    
TEL3           ASCII     602  21    
Fax            ASCII     623  21    
Email_Bus      ASCII     644  40    
Email_Privt    ASCII     684  36    
DOB            DATETIME  720   8   PICTURE "YYYYMMDD"  
Sex            ASCII     728   3    
Hire_Dt        DATETIME  731   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  739   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     747  30    
Mrtl_Sts       ASCII     777  14    
Pref_Nme       ASCII     791  22    
Prev_Sur_Nme   ASCII     813  16    
PAY_CLASS_CODE ASCII     829  14    
PAY_RATE       ACL       843  12 4  
AVG_TRANS_RATE ACL       855  12 2  
YEARLY_SALARY  ACL       867  12 2  
AUTOPAY_HOURS_DAYS ASCII     879  15    
Emp_Catg       ASCII     894  40    
Created_Dt     DATETIME  934   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  942   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     950  20    
Cha_Field2     ASCII     970  20    
Cha_Field3     ASCII     990  20    
Cha_Field4     ASCII    1010  20    
Cha_Field5     ASCII    1030  20    
Emp_Nme        ASCII    1050  65    
c_Hire_Dt      ASCII    1115   8    
BSB            ASCII    1123  20    
Bnk_Acc_Num    ASCII    1143  20    
BSB_NAME       ASCII    1163  60    
Bnk_Acc_Name   ASCII    1223  60    
Total_PayAmt   ACL      1283  12 2  
Total_Pay_Num  ACL      1295  12 0  
c_Tax_Fle_Num  ASCII    1307  21    
Invalid_TFN    ASCII    1328   1    
BSB2           ASCII    1329  20    
Bnk_Acc_Num2   ASCII    1349  20    
Total_PayAmt2  ACL      1369  12 2  
Total_Pay_Num2 ACL      1381  12 0  
Invalid_TFN2   ASCII    1393   1    
DUP_KEY        ASCII    1394  65    
ID_KEY         ASCII    1459  85    
^LAYOUT   EMF_Address                        359 D.T,
!"EMF_TMP_Emp" "IDX_EMF_Co_Emp_ID" Co_Emp_ID
Co_Emp_ID      ASCII       1  20    
Emp_ID         ASCII      21  20    
ADD1           ASCII      41  61    
ADD2           ASCII     102  61    
ADD3           ASCII     163  61    
Pcode          ASCII     224  11    
State          ASCII     235  29    
City           ASCII     264  35    
Cntry          ASCII     299  61    
^LAYOUT   EM004_History                      1939 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        ASCII     985  65    
c_Hire_Dt      ASCII    1050   8    
BSB            ASCII    1058  20    
Bnk_Acc_Num    ASCII    1078  20    
BSB_NAME       ASCII    1098  60    
Bnk_Acc_Name   ASCII    1158  60    
Total_PayAmt   ACL      1218  12 2  
Total_Pay_Num  ACL      1230  12 0  
c_Tax_Fle_Num  ASCII    1242  21    
Invalid_TFN    ASCII    1263   1    
c_Emp_Nme      ASCII    1264  65    
DUP_KEY        ASCII    1329  61    
Add_KEY        ASCII    1390  81    
Dup_ADD1       ASCII    1471  61    
Dup_ADD2       ASCII    1532  61    
Dup_ADD3       ASCII    1593  61    
Dup_City       ASCII    1654  35    
Dup_State      ASCII    1689  29    
Dup_Pcode      ASCII    1718  11    
Dup_Cntry      ASCII    1729  61    
BSB2           ASCII    1790  20    
Bnk_Acc_Num2   ASCII    1810  20    
Total_PayAmt2  ACL      1830  12 2  
Total_Pay_Num2 ACL      1842  12 0  
Invalid_TFN2   ASCII    1854   1    
ID_KEY         ASCII    1855  85    
^LAYOUT   EM001_Dup_TFN                      1569 D.T,
c_Tax_Fle_Num  ASCII       1  21    
Co_Emp_ID      ASCII      22  20    
Co             ASCII      42  20    
COST_CENTRE    ASCII      62  20    
EMP_Sts        ASCII      82   1    
Emp_ID         ASCII      83  20    
Tax_Fle_Num    ASCII     103  20    
Tax_Scale      ASCII     123   9    
Title          ASCII     132   5    
Frst_Nme       ASCII     137  20    
Second_Given_Name ASCII     157  20    
Sur_Nme        ASCII     177  20    
ADD1           ASCII     197  61    
ADD2           ASCII     258  61    
ADD3           ASCII     319  61    
City           ASCII     380  35    
State          ASCII     415  29    
Pcode          ASCII     444  11    
Cntry          ASCII     455  61    
TEL1           ASCII     516  21    
TEL2           ASCII     537  21    
TEL3           ASCII     558  21    
Fax            ASCII     579  21    
Email_Bus      ASCII     600  40    
Email_Privt    ASCII     640  36    
DOB            DATETIME  676   8   PICTURE "YYYYMMDD"  
Sex            ASCII     684   3    
Hire_Dt        DATETIME  687   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  695   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     703  30    
Mrtl_Sts       ASCII     733  14    
Pref_Nme       ASCII     747  22    
Prev_Sur_Nme   ASCII     769  16    
PAY_CLASS_CODE ASCII     785  14    
PAY_RATE       ACL       799  12 4  
AVG_TRANS_RATE ACL       811  12 2  
YEARLY_SALARY  ACL       823  12 2  
AUTOPAY_HOURS_DAYS ASCII     835  15    
Emp_Catg       ASCII     850  40    
Created_Dt     DATETIME  890   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  898   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     906  20    
Cha_Field2     ASCII     926  20    
Cha_Field3     ASCII     946  20    
Cha_Field4     ASCII     966  20    
Cha_Field5     ASCII     986  20    
Emp_Nme        ASCII    1006  65    
c_Hire_Dt      ASCII    1071   8    
BSB            ASCII    1079  20    
Bnk_Acc_Num    ASCII    1099  20    
BSB_NAME       ASCII    1119  60    
Bnk_Acc_Name   ASCII    1179  60    
Invalid_TFN    ASCII    1239   1    
Total_PayAmt   ACL      1240  12 2  
Total_Pay_Num  ACL      1252  12 0  
BSB2           ASCII    1264  20    
Bnk_Acc_Num2   ASCII    1284  20    
Total_PayAmt2  ACL      1304  12 2  
Total_Pay_Num2 ACL      1316  12 0  
Invalid_TFN2   ASCII    1328   1    
DUP_KEY        ASCII    1329  20    
ID_KEY         ASCII    1349  85    
SORT_KEY       ASCII    1434  52    
SORT_KEY_Desc  ASCII    1486  31    
Priority       ASCII    1517   1    
RptRunDate     DATETIME 1518   8   PICTURE "YYYYMMDD" WIDTH 27  
TEST_NAME      ASCII    1526  44    
^LAYOUT   EM002_Dup_BnkAcc                   1797 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        ASCII     985  65    
c_Hire_Dt      ASCII    1050   8    
BSB            ASCII    1058  20    
Bnk_Acc_Num    ASCII    1078  20    
BSB_NAME       ASCII    1098  60    
Bnk_Acc_Name   ASCII    1158  60    
Total_PayAmt   ACL      1218  12 2  
Total_Pay_Num  ACL      1230  12 0  
c_Tax_Fle_Num  ASCII    1242  21    
Invalid_TFN    ASCII    1263   1    
DUP_KEY        ASCII    1264  40    
Bnk_KEY        ASCII    1304  61    
Co_Emp_ID2     ASCII    1365  20    
BSB2           ASCII    1385  20    
Bnk_Acc_Num2   ASCII    1405  20    
BSB_NAME2      ASCII    1425  60    
Bnk_Acc_Name2  ASCII    1485  60    
Total_PayAmt2  ACL      1545  12 2  
Total_Pay_Num2 ACL      1557  12 0  
Invalid_TFN2   ASCII    1569   1    
ID_KEY         ASCII    1570  85    
SORT_KEY       ASCII    1655  52    
SORT_KEY_Desc  ASCII    1707  29    
Priority       ASCII    1736   1    
RptRunDate     DATETIME 1737   8   PICTURE "YYYYMMDD" WIDTH 27  
TEST_NAME      ASCII    1745  53    
^LAYOUT   EM003_Dup_Nme                      1671 D.T,
c_Emp_Nme      ASCII       1  65    
Co_Emp_ID      ASCII      66  20    
Co             ASCII      86  20    
COST_CENTRE    ASCII     106  20    
EMP_Sts        ASCII     126   1    
Emp_ID         ASCII     127  20    
Tax_Fle_Num    ASCII     147  20    
Tax_Scale      ASCII     167   9    
Title          ASCII     176   5    
Frst_Nme       ASCII     181  20    
Second_Given_Name ASCII     201  20    
Sur_Nme        ASCII     221  20    
ADD1           ASCII     241  61    
ADD2           ASCII     302  61    
ADD3           ASCII     363  61    
City           ASCII     424  35    
State          ASCII     459  29    
Pcode          ASCII     488  11    
Cntry          ASCII     499  61    
TEL1           ASCII     560  21    
TEL2           ASCII     581  21    
TEL3           ASCII     602  21    
Fax            ASCII     623  21    
Email_Bus      ASCII     644  40    
Email_Privt    ASCII     684  36    
DOB            DATETIME  720   8   PICTURE "YYYYMMDD"  
Sex            ASCII     728   3    
Hire_Dt        DATETIME  731   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  739   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     747  30    
Mrtl_Sts       ASCII     777  14    
Pref_Nme       ASCII     791  22    
Prev_Sur_Nme   ASCII     813  16    
PAY_CLASS_CODE ASCII     829  14    
PAY_RATE       ACL       843  12 4  
AVG_TRANS_RATE ACL       855  12 2  
YEARLY_SALARY  ACL       867  12 2  
AUTOPAY_HOURS_DAYS ASCII     879  15    
Emp_Catg       ASCII     894  40    
Created_Dt     DATETIME  934   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  942   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     950  20    
Cha_Field2     ASCII     970  20    
Cha_Field3     ASCII     990  20    
Cha_Field4     ASCII    1010  20    
Cha_Field5     ASCII    1030  20    
Emp_Nme        ASCII    1050  65    
c_Hire_Dt      ASCII    1115   8    
BSB            ASCII    1123  20    
Bnk_Acc_Num    ASCII    1143  20    
BSB_NAME       ASCII    1163  60    
Bnk_Acc_Name   ASCII    1223  60    
Total_PayAmt   ACL      1283  12 2  
Total_Pay_Num  ACL      1295  12 0  
c_Tax_Fle_Num  ASCII    1307  21    
Invalid_TFN    ASCII    1328   1    
BSB2           ASCII    1329  20    
Bnk_Acc_Num2   ASCII    1349  20    
Total_PayAmt2  ACL      1369  12 2  
Total_Pay_Num2 ACL      1381  12 0  
Invalid_TFN2   ASCII    1393   1    
DUP_KEY        ASCII    1394  65    
ID_KEY         ASCII    1459  85    
SORT_KEY       ASCII    1544  52    
SORT_KEY_Desc  ASCII    1596  23    
Priority       ASCII    1619   1    
RptRunDate     DATETIME 1620   8   PICTURE "YYYYMMDD" WIDTH 27  
TEST_NAME      ASCII    1628  44    
^LAYOUT   EM004_Dup_Add                      2070 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        ASCII     985  65    
c_Hire_Dt      ASCII    1050   8    
BSB            ASCII    1058  20    
Bnk_Acc_Num    ASCII    1078  20    
BSB_NAME       ASCII    1098  60    
Bnk_Acc_Name   ASCII    1158  60    
Total_PayAmt   ACL      1218  12 2  
Total_Pay_Num  ACL      1230  12 0  
c_Tax_Fle_Num  ASCII    1242  21    
Invalid_TFN    ASCII    1263   1    
c_Emp_Nme      ASCII    1264  65    
DUP_KEY        ASCII    1329  61    
Add_KEY        ASCII    1390  81    
Dup_ADD1       ASCII    1471  61    
Dup_ADD2       ASCII    1532  61    
Dup_ADD3       ASCII    1593  61    
Dup_City       ASCII    1654  35    
Dup_State      ASCII    1689  29    
Dup_Pcode      ASCII    1718  11    
Dup_Cntry      ASCII    1729  61    
BSB2           ASCII    1790  20    
Bnk_Acc_Num2   ASCII    1810  20    
Total_PayAmt2  ACL      1830  12 2  
Total_Pay_Num2 ACL      1842  12 0  
Invalid_TFN2   ASCII    1854   1    
ID_KEY         ASCII    1855  85    
SORT_KEY       ASCII    1940  52    
SORT_KEY_Desc  ASCII    1992  23    
Priority       ASCII    2015   1    
RptRunDate     DATETIME 2016   8   PICTURE "YYYYMMDD" WIDTH 27  
TEST_NAME      ASCII    2024  47    
^LAYOUT   EM005_History                      1604 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        ASCII     985  65    
c_Hire_Dt      ASCII    1050   8    
BSB            ASCII    1058  20    
Bnk_Acc_Num    ASCII    1078  20    
BSB_NAME       ASCII    1098  60    
Bnk_Acc_Name   ASCII    1158  60    
Total_PayAmt   ACL      1218  12 2  
Total_Pay_Num  ACL      1230  12 0  
c_Tax_Fle_Num  ASCII    1242  21    
Invalid_TFN    ASCII    1263   1    
c_Emp_Nme      ASCII    1264  65    
c_Tel1         ASCII    1329  21    
c_Tel2         ASCII    1350  21    
c_Tel3         ASCII    1371  21    
c_Fax          ASCII    1392  21    
DUP_KEY        ASCII    1413  21    
c_Tel          ASCII    1434  21    
BSB2           ASCII    1455  20    
Bnk_Acc_Num2   ASCII    1475  20    
Total_PayAmt2  ACL      1495  12 2  
Total_Pay_Num2 ACL      1507  12 0  
Invalid_TFN2   ASCII    1519   1    
ID_KEY         ASCII    1520  85    
^LAYOUT   EM005_Dup_Tel                      1757 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        ASCII     985  65    
c_Hire_Dt      ASCII    1050   8    
BSB            ASCII    1058  20    
Bnk_Acc_Num    ASCII    1078  20    
BSB_NAME       ASCII    1098  60    
Bnk_Acc_Name   ASCII    1158  60    
Total_PayAmt   ACL      1218  12 2  
Total_Pay_Num  ACL      1230  12 0  
c_Tax_Fle_Num  ASCII    1242  21    
Invalid_TFN    ASCII    1263   1    
c_Emp_Nme      ASCII    1264  65    
c_Tel1         ASCII    1329  21    
c_Tel2         ASCII    1350  21    
c_Tel3         ASCII    1371  21    
c_Fax          ASCII    1392  21    
DUP_KEY        ASCII    1413  21    
c_Tel          ASCII    1434  21    
BSB2           ASCII    1455  20    
Bnk_Acc_Num2   ASCII    1475  20    
Total_PayAmt2  ACL      1495  12 2  
Total_Pay_Num2 ACL      1507  12 0  
Invalid_TFN2   ASCII    1519   1    
ID_KEY         ASCII    1520  85    
SORT_KEY       ASCII    1605  64    
SORT_KEY_Desc  ASCII    1669  28    
Priority       ASCII    1697   1    
RptRunDate     DATETIME 1698   8   PICTURE "YYYYMMDD" WIDTH 27  
TEST_NAME      ASCII    1706  52    
^LAYOUT   EM006_History                      2088 D.T,
EM006          ASCII       1   8    
Co_Emp_ID      ASCII       9  20    
Emp_ID         ASCII      29  20    
EM0062         ACL        49  12 0  
COUNT          ACL        61  12 0 WIDTH 8  
Co             ASCII      73  20    
COST_CENTRE    ASCII      93  20    
EMP_Sts        ASCII     113   1    
Tax_Fle_Num    ASCII     114  20    
Tax_Scale      ASCII     134   9    
Title          ASCII     143   5    
Frst_Nme       ASCII     148  20    
Second_Given_Name ASCII     168  20    
Sur_Nme        ASCII     188  20    
ADD1           ASCII     208  61    
ADD2           ASCII     269  61    
ADD3           ASCII     330  61    
City           ASCII     391  35    
State          ASCII     426  29    
Pcode          ASCII     455  11    
Cntry          ASCII     466  61    
TEL1           ASCII     527  21    
TEL2           ASCII     548  21    
TEL3           ASCII     569  21    
Fax            ASCII     590  21    
Email_Bus      ASCII     611  40    
Email_Privt    ASCII     651  36    
DOB            DATETIME  687   8   PICTURE "YYYYMMDD"  
Sex            ASCII     695   3    
Hire_Dt        DATETIME  698   8   PICTURE "YYYYMMDD"  
Trm_Dt         DATETIME  706   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     714  30    
Mrtl_Sts       ASCII     744  14    
Pref_Nme       ASCII     758  22    
Prev_Sur_Nme   ASCII     780  16    
PAY_CLASS_CODE ASCII     796  14    
PAY_RATE       ACL       810  12 4  
AVG_TRANS_RATE ACL       822  12 2  
YEARLY_SALARY  ACL       834  12 2  
AUTOPAY_HOURS_DAYS ASCII     846  15    
Emp_Catg       ASCII     861  40    
Created_Dt     DATETIME  901   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  909   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     917  20    
Cha_Field2     ASCII     937  20    
Cha_Field3     ASCII     957  20    
Cha_Field4     ASCII     977  20    
Cha_Field5     ASCII     997  20    
Emp_Nme        ASCII    1017  65    
c_Hire_Dt      ASCII    1082   8    
BSB            ASCII    1090  20    
Bnk_Acc_Num    ASCII    1110  20    
BSB_NAME       ASCII    1130  60    
Bnk_Acc_Name   ASCII    1190  60    
Total_PayAmt   ACL      1250  12 2  
Total_Pay_Num  ACL      1262  12 0  
c_Tax_Fle_Num  ASCII    1274  21    
Invalid_TFN    ASCII    1295   1    
c_Emp_Nme      ASCII    1296  65    
c_Tel1         ASCII    1361  21    
c_Tel2         ASCII    1382  21    
c_Tel3         ASCII    1403  21    
c_Fax          ASCII    1424  21    
BSB2           ASCII    1445  20    
Bnk_Acc_Num2   ASCII    1465  20    
Total_PayAmt2  ACL      1485  12 2  
Total_Pay_Num2 ACL      1497  12 0  
Invalid_TFN2   ASCII    1509   1    
BSB3           ASCII    1510  20    
Bnk_Acc_Num3   ASCII    1530  20    
Total_PayAmt3  ACL      1550  12 2  
Total_Pay_Num3 ACL      1562  12 0  
Invalid_TFN3   ASCII    1574   1    
c_EM006        ASCII    1575   8    
Test_Name      ASCII    1583 170    
RptRunDate     DATETIME 1753   8   PICTURE "YYYYMMDD" WIDTH 27  
BSB4           ASCII    1761  20    
Bnk_Acc_Num4   ASCII    1781  20    
Total_PayAmt4  ACL      1801  12 2  
Total_Pay_Num4 ACL      1813  12 0  
Test_Name2     ASCII    1825 170    
RptRunDate2    DATETIME 1995   8   PICTURE "YYYYMMDD" WIDTH 27  
Invalid_TFN4   ASCII    2003   1    
ID_KEY         ASCII    2004  85    
^LAYOUT   EM007_History                      1770 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        ASCII     985  65    
c_Hire_Dt      ASCII    1050   8    
BSB            ASCII    1058  20    
Bnk_Acc_Num    ASCII    1078  20    
BSB_NAME       ASCII    1098  60    
Bnk_Acc_Name   ASCII    1158  60    
Total_PayAmt   ACL      1218  12 2  
Total_Pay_Num  ACL      1230  12 0  
Invalid_TFN    ASCII    1242   1    
c_Emp_Nme      ASCII    1243  65    
c_ADD          ASCII    1308 183    
c_Tel1         ASCII    1491  20    
c_Tel2         ASCII    1511  20    
c_Tel3         ASCII    1531  20    
c_Fax          ASCII    1551  20    
c_Tax_Fle_Num  ASCII    1571  20    
c_BSB          ASCII    1591  10    
c_Bnk_Acc_Num  ASCII    1601  20    
BSB2           ASCII    1621  20    
Bnk_Acc_Num2   ASCII    1641  20    
Total_PayAmt2  ACL      1661  12 2  
Total_Pay_Num2 ACL      1673  12 0  
Invalid_TFN2   ASCII    1685   1    
ID_KEY         ASCII    1686  85    
^LAYOUT   EM007_StartDt_Bf_DOB               1899 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        ASCII     985  65    
c_Hire_Dt      ASCII    1050   8    
BSB            ASCII    1058  20    
Bnk_Acc_Num    ASCII    1078  20    
BSB_NAME       ASCII    1098  60    
Bnk_Acc_Name   ASCII    1158  60    
Total_PayAmt   ACL      1218  12 2  
Total_Pay_Num  ACL      1230  12 0  
Invalid_TFN    ASCII    1242   1    
c_Emp_Nme      ASCII    1243  65    
c_ADD          ASCII    1308 183    
c_Tel1         ASCII    1491  20    
c_Tel2         ASCII    1511  20    
c_Tel3         ASCII    1531  20    
c_Fax          ASCII    1551  20    
c_Tax_Fle_Num  ASCII    1571  20    
c_BSB          ASCII    1591  10    
c_Bnk_Acc_Num  ASCII    1601  20    
BSB2           ASCII    1621  20    
Bnk_Acc_Num2   ASCII    1641  20    
Total_PayAmt2  ACL      1661  12 2  
Total_Pay_Num2 ACL      1673  12 0  
Invalid_TFN2   ASCII    1685   1    
ID_KEY         ASCII    1686  85    
SORT_KEY       ASCII    1771  32    
SORT_KEY_Desc  ASCII    1803  20    
Priority       ASCII    1823   1    
RptRunDate     DATETIME 1824   8   PICTURE "YYYYMMDD" WIDTH 27  
TEST_NAME      ASCII    1832  68    
^LAYOUT   EM008_History                      1730 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        ASCII     985  65    
c_Hire_Dt      ASCII    1050   8    
BSB            ASCII    1058  20    
Bnk_Acc_Num    ASCII    1078  20    
BSB_NAME       ASCII    1098  60    
Bnk_Acc_Name   ASCII    1158  60    
Total_PayAmt   ACL      1218  12 2  
Total_Pay_Num  ACL      1230  12 0  
Invalid_TFN    ASCII    1242   1    
c_Emp_Nme      ASCII    1243  65    
c_ADD          ASCII    1308 183    
c_Tel1         ASCII    1491  20    
c_Tel2         ASCII    1511  20    
c_Tel3         ASCII    1531  20    
c_Fax          ASCII    1551  20    
c_Tax_Fle_Num  ASCII    1571  20    
c_BSB          ASCII    1591  10    
c_Bnk_Acc_Num  ASCII    1601  20    
Total_PayAmt2  ACL      1621  12 2  
Total_Pay_Num2 ACL      1633  12 0  
Invalid_TFN2   ASCII    1645   1    
ID_KEY         ASCII    1646  85    
^LAYOUT   EM008_unKnown_CstCtr               1884 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        ASCII     985  65    
c_Hire_Dt      ASCII    1050   8    
BSB            ASCII    1058  20    
Bnk_Acc_Num    ASCII    1078  20    
BSB_NAME       ASCII    1098  60    
Bnk_Acc_Name   ASCII    1158  60    
Total_PayAmt   ACL      1218  12 2  
Total_Pay_Num  ACL      1230  12 0  
Invalid_TFN    ASCII    1242   1    
c_Emp_Nme      ASCII    1243  65    
c_ADD          ASCII    1308 183    
c_Tel1         ASCII    1491  20    
c_Tel2         ASCII    1511  20    
c_Tel3         ASCII    1531  20    
c_Fax          ASCII    1551  20    
c_Tax_Fle_Num  ASCII    1571  20    
c_BSB          ASCII    1591  10    
c_Bnk_Acc_Num  ASCII    1601  20    
Total_PayAmt2  ACL      1621  12 2  
Total_Pay_Num2 ACL      1633  12 0  
Invalid_TFN2   ASCII    1645   1    
ID_KEY         ASCII    1646  85    
SORT_KEY       ASCII    1731  50    
SORT_KEY_Desc  ASCII    1781  32    
Priority       ASCII    1813   1    
RptRunDate     DATETIME 1814   8   PICTURE "YYYYMMDD" WIDTH 27  
TEST_NAME      ASCII    1822  63    
^LAYOUT   EM009_History                      1790 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        ASCII     985  65    
c_Hire_Dt      ASCII    1050   8    
BSB            ASCII    1058  20    
Bnk_Acc_Num    ASCII    1078  20    
BSB_NAME       ASCII    1098  60    
Bnk_Acc_Name   ASCII    1158  60    
Total_PayAmt   ACL      1218  12 2  
Total_Pay_Num  ACL      1230  12 0  
Invalid_TFN    ASCII    1242   1    
c_Emp_Nme      ASCII    1243  65    
c_ADD          ASCII    1308 183    
c_Tel1         ASCII    1491  20    
c_Tel2         ASCII    1511  20    
c_Tel3         ASCII    1531  20    
c_Fax          ASCII    1551  20    
c_Tax_Fle_Num  ASCII    1571  20    
c_BSB          ASCII    1591  10    
c_Bnk_Acc_Num  ASCII    1601  20    
BSB2           ASCII    1621  20    
Bnk_Acc_Num2   ASCII    1641  20    
Total_PayAmt2  ACL      1661  12 2  
Total_Pay_Num2 ACL      1673  12 0  
Invalid_TFN2   ASCII    1685   1    
c_Tax_Fle_Num2 ASCII    1686  20    
ID_KEY         ASCII    1706  85    
^LAYOUT   EM010_History                      1890 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        ASCII     985  65    
c_Hire_Dt      ASCII    1050   8    
BSB            ASCII    1058  20    
Bnk_Acc_Num    ASCII    1078  20    
BSB_NAME       ASCII    1098  60    
Bnk_Acc_Name   ASCII    1158  60    
Total_PayAmt   ACL      1218  12 2  
Total_Pay_Num  ACL      1230  12 0  
Invalid_TFN    ASCII    1242   1    
c_Emp_Nme      ASCII    1243  65    
c_ADD          ASCII    1308 183    
c_Tel1         ASCII    1491  20    
c_Tel2         ASCII    1511  20    
c_Tel3         ASCII    1531  20    
c_Fax          ASCII    1551  20    
c_Tax_Fle_Num  ASCII    1571  20    
c_BSB          ASCII    1591  10    
c_Bnk_Acc_Num  ASCII    1601  20    
BSB2           ASCII    1621  20    
Bnk_Acc_Num2   ASCII    1641  20    
Total_PayAmt2  ACL      1661  12 2  
Total_Pay_Num2 ACL      1673  12 0  
Invalid_TFN2   ASCII    1685   1    
c_Tax_Fle_Num2 ASCII    1686  20    
TEST_NAME      ASCII    1706 100    
ID_KEY         ASCII    1806  85    
^LAYOUT   EM010_TFN_Valid                    1986 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        ASCII     985  65    
c_Hire_Dt      ASCII    1050   8    
BSB            ASCII    1058  20    
Bnk_Acc_Num    ASCII    1078  20    
BSB_NAME       ASCII    1098  60    
Bnk_Acc_Name   ASCII    1158  60    
Total_PayAmt   ACL      1218  12 2  
Total_Pay_Num  ACL      1230  12 0  
Invalid_TFN    ASCII    1242   1    
c_Emp_Nme      ASCII    1243  65    
c_ADD          ASCII    1308 183    
c_Tel1         ASCII    1491  20    
c_Tel2         ASCII    1511  20    
c_Tel3         ASCII    1531  20    
c_Fax          ASCII    1551  20    
c_Tax_Fle_Num  ASCII    1571  20    
c_BSB          ASCII    1591  10    
c_Bnk_Acc_Num  ASCII    1601  20    
BSB2           ASCII    1621  20    
Bnk_Acc_Num2   ASCII    1641  20    
Total_PayAmt2  ACL      1661  12 2  
Total_Pay_Num2 ACL      1673  12 0  
Invalid_TFN2   ASCII    1685   1    
c_Tax_Fle_Num2 ASCII    1686  20    
TEST_NAME      ASCII    1706 100    
ID_KEY         ASCII    1806  85    
SORT_KEY       ASCII    1891  45    
SORT_KEY_Desc  ASCII    1936  42    
Priority       ASCII    1978   1    
RptRunDate     DATETIME 1979   8   PICTURE "YYYYMMDD" WIDTH 27  
^LAYOUT   EM011_History                      344 D.T,
Co_Emp_ID      ASCII       1  20    
Emp_ID         ASCII      21  20    
BSB            ASCII      41  20    
Bnk_Acc_Num    ASCII      61  20    
BSB_NAME       ASCII      81  60    
Bnk_Acc_Name   ASCII     141  60    
Bnk_Acc_Type   ASCII     201  20    
Chg_Dt         DATETIME  221   8   PICTURE "YYYYMMDD"  
RptRunDateTime ASCII     229  19    
COUNT          ACL       248  12 0 WIDTH 8  
ID_KEY         ASCII     260  85    
^LAYOUT   EM011_BnkAcc_Valid                 517 D.T,
!"EMF_TMP_Emp" "IDX_EMF_Co_Emp_ID" Co_Emp_ID
Co_Emp_ID      ASCII       1  20    
Emp_ID         ASCII      21  20    
BSB            ASCII      41  20    
Bnk_Acc_Num    ASCII      61  20    
BSB_NAME       ASCII      81  60    
Bnk_Acc_Name   ASCII     141  60    
Bnk_Acc_Type   ASCII     201  20    
Chg_Dt         DATETIME  221   8   PICTURE "YYYYMMDD"  
RptRunDateTime ASCII     229  19    
COUNT          ACL       248  12 0 WIDTH 8  
ID_KEY         ASCII     260  85    
SORT_KEY       ASCII     345  40    
SORT_KEY_Desc  ASCII     385  24    
Priority       ASCII     409   1    
RptRunDate     DATETIME  410   8   PICTURE "YYYYMMDD" AS "Report Run Date" WIDTH 27  
Data_Range_Start_Date DATETIME  418   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME  426   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
TEST_NAME      ASCII     434  84    
^LAYOUT   EMF_BnkAcc_Chg_History             247 D.T,
Co_Emp_ID      ASCII       1  20    
Emp_ID         ASCII      21  20    
BSB            ASCII      41  20    
Bnk_Acc_Num    ASCII      61  20    
BSB_NAME       ASCII      81  60    
Bnk_Acc_Name   ASCII     141  60    
Bnk_Acc_Type   ASCII     201  20    
Chg_Dt         DATETIME  221   8   PICTURE "YYYYMMDD"  
RptRunDateTime ASCII     229  19    
^LAYOUT   EM012_History                      1717 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        ASCII     985  65    
c_Hire_Dt      ASCII    1050   8    
BSB            ASCII    1058  20    
Bnk_Acc_Num    ASCII    1078  20    
BSB_NAME       ASCII    1098  60    
Bnk_Acc_Name   ASCII    1158  60    
Total_PayAmt   ACL      1218  12 2  
Total_Pay_Num  ACL      1230  12 0  
Invalid_TFN    ASCII    1242   1    
c_Emp_Nme      ASCII    1243  65    
c_ADD          ASCII    1308 183    
c_Tel1         ASCII    1491  20    
c_Tel2         ASCII    1511  20    
c_Tel3         ASCII    1531  20    
c_Fax          ASCII    1551  20    
c_Tax_Fle_Num  ASCII    1571  20    
c_BSB          ASCII    1591  10    
c_Bnk_Acc_Num  ASCII    1601  20    
Ages           ACL      1621  12 0  
ID_KEY         ASCII    1633  85    
^LAYOUT   EM012_DOB_Valid                    1935 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        ASCII     985  65    
c_Hire_Dt      ASCII    1050   8    
BSB            ASCII    1058  20    
Bnk_Acc_Num    ASCII    1078  20    
BSB_NAME       ASCII    1098  60    
Bnk_Acc_Name   ASCII    1158  60    
Total_PayAmt   ACL      1218  12 2  
Total_Pay_Num  ACL      1230  12 0  
Invalid_TFN    ASCII    1242   1    
c_Emp_Nme      ASCII    1243  65    
c_ADD          ASCII    1308 183    
c_Tel1         ASCII    1491  20    
c_Tel2         ASCII    1511  20    
c_Tel3         ASCII    1531  20    
c_Fax          ASCII    1551  20    
c_Tax_Fle_Num  ASCII    1571  20    
c_BSB          ASCII    1591  10    
c_Bnk_Acc_Num  ASCII    1601  20    
Ages           ACL      1621  12 0  
ID_KEY         ASCII    1633  85    
SORT_KEY       ASCII    1718  50    
SORT_KEY_Desc  ASCII    1768  39    
Priority       ASCII    1807   1    
RptRunDate     DATETIME 1808   8   PICTURE "YYYYMMDD" WIDTH 27  
TEST_NAME      ASCII    1816 120    
^LAYOUT   EM013_History                      1741 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        ASCII     985  65    
c_Hire_Dt      ASCII    1050   8    
BSB            ASCII    1058  20    
Bnk_Acc_Num    ASCII    1078  20    
BSB_NAME       ASCII    1098  60    
Bnk_Acc_Name   ASCII    1158  60    
Total_PayAmt   ACL      1218  12 2  
Total_Pay_Num  ACL      1230  12 0  
c_Emp_Nme      ASCII    1242  65    
c_ADD          ASCII    1307 183    
c_Tel1         ASCII    1490  20    
c_Tel2         ASCII    1510  20    
c_Tel3         ASCII    1530  20    
c_Fax          ASCII    1550  20    
c_Tax_Fle_Num  ASCII    1570  20    
c_BSB          ASCII    1590  10    
c_Bnk_Acc_Num  ASCII    1600  20    
Ages           ACL      1620  12 0  
Invalid_TFN    ASCII    1632   1    
EmployAge      ACL      1633  12 0  
EmployAge2     ACL      1645  12 0  
ID_KEY         ASCII    1657  85    
^LAYOUT   EM013_StarDt_Valid                 1989 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        ASCII     985  65    
c_Hire_Dt      ASCII    1050   8    
BSB            ASCII    1058  20    
Bnk_Acc_Num    ASCII    1078  20    
BSB_NAME       ASCII    1098  60    
Bnk_Acc_Name   ASCII    1158  60    
Total_PayAmt   ACL      1218  12 2  
Total_Pay_Num  ACL      1230  12 0  
c_Emp_Nme      ASCII    1242  65    
c_ADD          ASCII    1307 183    
c_Tel1         ASCII    1490  20    
c_Tel2         ASCII    1510  20    
c_Tel3         ASCII    1530  20    
c_Fax          ASCII    1550  20    
c_Tax_Fle_Num  ASCII    1570  20    
c_BSB          ASCII    1590  10    
c_Bnk_Acc_Num  ASCII    1600  20    
Ages           ACL      1620  12 0  
Invalid_TFN    ASCII    1632   1    
EmployAge      ACL      1633  12 0  
EmployAge2     ACL      1645  12 0  
ID_KEY         ASCII    1657  85    
SORT_KEY       ASCII    1742  50    
SORT_KEY_Desc  ASCII    1792  39    
Priority       ASCII    1831   1    
RptRunDate     DATETIME 1832   8   PICTURE "YYYYMMDD" WIDTH 27  
TEST_NAME      ASCII    1840 150    
^LAYOUT   EM014_History                      1741 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        ASCII     985  65    
c_Hire_Dt      ASCII    1050   8    
BSB            ASCII    1058  20    
Bnk_Acc_Num    ASCII    1078  20    
BSB_NAME       ASCII    1098  60    
Bnk_Acc_Name   ASCII    1158  60    
Total_PayAmt   ACL      1218  12 2  
Total_Pay_Num  ACL      1230  12 0  
c_Emp_Nme      ASCII    1242  65    
c_ADD          ASCII    1307 183    
c_Tel1         ASCII    1490  20    
c_Tel2         ASCII    1510  20    
c_Tel3         ASCII    1530  20    
c_Fax          ASCII    1550  20    
c_Tax_Fle_Num  ASCII    1570  20    
c_BSB          ASCII    1590  10    
c_Bnk_Acc_Num  ASCII    1600  20    
Ages           ACL      1620  12 0  
Invalid_TFN    ASCII    1632   1    
EmployAge      ACL      1633  12 0  
EmployAge2     ACL      1645  12 0  
ID_KEY         ASCII    1657  85    
^LAYOUT   EM014_Tmp_No_EndDt                 1898 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        ASCII     985  65    
c_Hire_Dt      ASCII    1050   8    
BSB            ASCII    1058  20    
Bnk_Acc_Num    ASCII    1078  20    
BSB_NAME       ASCII    1098  60    
Bnk_Acc_Name   ASCII    1158  60    
Total_PayAmt   ACL      1218  12 2  
Total_Pay_Num  ACL      1230  12 0  
c_Emp_Nme      ASCII    1242  65    
c_ADD          ASCII    1307 183    
c_Tel1         ASCII    1490  20    
c_Tel2         ASCII    1510  20    
c_Tel3         ASCII    1530  20    
c_Fax          ASCII    1550  20    
c_Tax_Fle_Num  ASCII    1570  20    
c_BSB          ASCII    1590  10    
c_Bnk_Acc_Num  ASCII    1600  20    
Ages           ACL      1620  12 0  
Invalid_TFN    ASCII    1632   1    
EmployAge      ACL      1633  12 0  
EmployAge2     ACL      1645  12 0  
ID_KEY         ASCII    1657  85    
SORT_KEY       ASCII    1742  50    
SORT_KEY_Desc  ASCII    1792  39    
Priority       ASCII    1831   1    
RptRunDate     ASCII    1832  12    
TEST_NAME      ASCII    1844  55    
^LAYOUT   PR001_History                      1335 D.T,
Co_Emp_ID      ASCII       1  20    
c_Prd_Dt       ASCII      21   8    
ABS_PayCode_Amount ACL        29  12 0  
Co             ASCII      41  20    
COST_CENTRE    ASCII      61  20    
Emp_ID         ASCII      81  20    
Period_Date    DATETIME  101   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode        ASCII     109   7    
PayCode_Amount ACL       116  12 2  
Pay_Hrs        ACL       128  12 2  
LINE_NO        ASCII     140  20    
LINE_DESC      ASCII     160  60    
LINE_TYPE      ASCII     220  20    
PAY_GROUP      ASCII     240  20    
GL_Account_No  ASCII     260  20    
PERIOD         ASCII     280  20    
Standard_WeeklyHours ACL       300  12 2  
PayCode_Desc   ASCII     312  15    
Num_Field3     ACL       327  12 2  
Num_Field4     ACL       339  12 2  
Num_Field5     ACL       351  12 2  
Prd_Dt         DATETIME  363   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field2      DATETIME  371   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  379   8   PICTURE "YYYYMMDD"  
ForPrd         ASCII     387  20    
InPrd          ASCII     407  20    
Cha_Field3     ASCII     427  20    
Cha_Field4     ASCII     447  20    
Cha_Field5     ASCII     467  20    
Year           ASCII     487   4    
YM             ASCII     491   7    
PrdSalaryAmt   ACL       498  12 2  
ActPaidAmt     ACL       510  12 2  
PrdGrsAmt      ACL       522  12 2  
RUNID_ForPrd   ASCII     534  40    
RUNID_InPrd    ASCII     574  40    
Co2            ASCII     614  20    
COST_CENTRE2   ASCII     634  20    
Emp_ID2        ASCII     654  20    
Period_Date2   DATETIME  674   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode2       ASCII     682   7    
PayCode_Amount2 ACL       689  12 2  
Pay_Hrs2       ACL       701  12 2  
LINE_NO2       ASCII     713  20    
LINE_DESC2     ASCII     733  60    
LINE_TYPE2     ASCII     793  20    
PAY_GROUP2     ASCII     813  20    
GL_Account_No2 ASCII     833  20    
PERIOD2        ASCII     853  20    
Standard_WeeklyHours2 ACL       873  12 2  
PayCode_Desc2  ASCII     885  15    
Num_Field32    ACL       900  12 2  
Num_Field42    ACL       912  12 2  
Num_Field52    ACL       924  12 2  
Prd_Dt2        DATETIME  936   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field22     DATETIME  944   8   PICTURE "YYYYMMDD"  
Dt_Field32     DATETIME  952   8   PICTURE "YYYYMMDD"  
ForPrd2        ASCII     960  20    
InPrd2         ASCII     980  20    
Cha_Field32    ASCII    1000  20    
Cha_Field42    ASCII    1020  20    
Cha_Field52    ASCII    1040  20    
Year2          ASCII    1060   4    
YM2            ASCII    1064   7    
PrdSalaryAmt2  ACL      1071  12 2  
ActPaidAmt2    ACL      1083  12 2  
PrdGrsAmt2     ACL      1095  12 2  
RUNID_ForPrd2  ASCII    1107  40    
RUNID_InPrd2   ASCII    1147  40    
DUP_KEY        ASCII    1187  64    
ID_KEY         ASCII    1251  85    
^LAYOUT   PR001_Mul_Paid                     1546 D.T,
Co_Emp_ID      ASCII       1  20    
c_Prd_Dt       ASCII      21   8    
ABS_PayCode_Amount ACL        29  12 0  
Co             ASCII      41  20    
COST_CENTRE    ASCII      61  20    
Emp_ID         ASCII      81  20    
Period_Date    DATETIME  101   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode        ASCII     109   7    
PayCode_Amount ACL       116  12 2  
Pay_Hrs        ACL       128  12 2  
LINE_NO        ASCII     140  20    
LINE_DESC      ASCII     160  60    
LINE_TYPE      ASCII     220  20    
PAY_GROUP      ASCII     240  20    
GL_Account_No  ASCII     260  20    
PERIOD         ASCII     280  20    
Standard_WeeklyHours ACL       300  12 2  
PayCode_Desc   ASCII     312  15    
Num_Field3     ACL       327  12 2  
Num_Field4     ACL       339  12 2  
Num_Field5     ACL       351  12 2  
Prd_Dt         DATETIME  363   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field2      DATETIME  371   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  379   8   PICTURE "YYYYMMDD"  
ForPrd         ASCII     387  20    
InPrd          ASCII     407  20    
Cha_Field3     ASCII     427  20    
Cha_Field4     ASCII     447  20    
Cha_Field5     ASCII     467  20    
Year           ASCII     487   4    
YM             ASCII     491   7    
PrdSalaryAmt   ACL       498  12 2  
ActPaidAmt     ACL       510  12 2  
PrdGrsAmt      ACL       522  12 2  
RUNID_ForPrd   ASCII     534  40    
RUNID_InPrd    ASCII     574  40    
Co2            ASCII     614  20    
COST_CENTRE2   ASCII     634  20    
Emp_ID2        ASCII     654  20    
Period_Date2   DATETIME  674   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode2       ASCII     682   7    
PayCode_Amount2 ACL       689  12 2  
Pay_Hrs2       ACL       701  12 2  
LINE_NO2       ASCII     713  20    
LINE_DESC2     ASCII     733  60    
LINE_TYPE2     ASCII     793  20    
PAY_GROUP2     ASCII     813  20    
GL_Account_No2 ASCII     833  20    
PERIOD2        ASCII     853  20    
Standard_WeeklyHours2 ACL       873  12 2  
PayCode_Desc2  ASCII     885  15    
Num_Field32    ACL       900  12 2  
Num_Field42    ACL       912  12 2  
Num_Field52    ACL       924  12 2  
Prd_Dt2        DATETIME  936   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field22     DATETIME  944   8   PICTURE "YYYYMMDD"  
Dt_Field32     DATETIME  952   8   PICTURE "YYYYMMDD"  
ForPrd2        ASCII     960  20    
InPrd2         ASCII     980  20    
Cha_Field32    ASCII    1000  20    
Cha_Field42    ASCII    1020  20    
Cha_Field52    ASCII    1040  20    
Year2          ASCII    1060   4    
YM2            ASCII    1064   7    
PrdSalaryAmt2  ACL      1071  12 2  
ActPaidAmt2    ACL      1083  12 2  
PrdGrsAmt2     ACL      1095  12 2  
RUNID_ForPrd2  ASCII    1107  40    
RUNID_InPrd2   ASCII    1147  40    
DUP_KEY        ASCII    1187  64    
ID_KEY         ASCII    1251  85    
SORT_KEY       ASCII    1336  80    
SORT_KEY_Desc  ASCII    1416  28    
Priority       ASCII    1444   1    
RptRunDate     ASCII    1445  12    
Data_Range_Start_Date ASCII    1457  12    
Data_Range_End_Date ASCII    1469  12    
TEST_NAME      ASCII    1481  66    
^LAYOUT   PR002_History                      698 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
Emp_ID         ASCII      61  20    
Period_Date    DATETIME   81   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode        ASCII      89   7    
PayCode_Amount ACL        96  12 2  
Pay_Hrs        ACL       108  12 2  
LINE_NO        ASCII     120  20    
LINE_DESC      ASCII     140  60    
LINE_TYPE      ASCII     200  20    
PAY_GROUP      ASCII     220  20    
GL_Account_No  ASCII     240  20    
PERIOD         ASCII     260  20    
Standard_WeeklyHours ACL       280  12 2  
PayCode_Desc   ASCII     292  15    
Num_Field3     ACL       307  12 2  
Num_Field4     ACL       319  12 2  
Num_Field5     ACL       331  12 2  
Prd_Dt         DATETIME  343   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field2      DATETIME  351   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  359   8   PICTURE "YYYYMMDD"  
ForPrd         ASCII     367  20    
InPrd          ASCII     387  20    
Cha_Field3     ASCII     407  20    
Cha_Field4     ASCII     427  20    
Cha_Field5     ASCII     447  20    
Year           ASCII     467   4    
YM             ASCII     471   7    
c_Prd_Dt       ASCII     478   8    
ABS_PayCode_Amount ACL       486  12 0  
PrdSalaryAmt   ACL       498  12 2  
ActPaidAmt     ACL       510  12 2  
PrdGrsAmt      ACL       522  12 2  
RUNID_ForPrd   ASCII     534  40    
RUNID_InPrd    ASCII     574  40    
ID_KEY         ASCII     614  85    
^LAYOUT   PR002_Not_in_Emf                   896 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
Emp_ID         ASCII      61  20    
Period_Date    DATETIME   81   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode        ASCII      89   7    
PayCode_Amount ACL        96  12 2  
Pay_Hrs        ACL       108  12 2  
LINE_NO        ASCII     120  20    
LINE_DESC      ASCII     140  60    
LINE_TYPE      ASCII     200  20    
PAY_GROUP      ASCII     220  20    
GL_Account_No  ASCII     240  20    
PERIOD         ASCII     260  20    
Standard_WeeklyHours ACL       280  12 2  
PayCode_Desc   ASCII     292  15    
Num_Field3     ACL       307  12 2  
Num_Field4     ACL       319  12 2  
Num_Field5     ACL       331  12 2  
Prd_Dt         DATETIME  343   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field2      DATETIME  351   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  359   8   PICTURE "YYYYMMDD"  
ForPrd         ASCII     367  20    
InPrd          ASCII     387  20    
Cha_Field3     ASCII     407  20    
Cha_Field4     ASCII     427  20    
Cha_Field5     ASCII     447  20    
Year           ASCII     467   4    
YM             ASCII     471   7    
c_Prd_Dt       ASCII     478   8    
ABS_PayCode_Amount ACL       486  12 0  
PrdSalaryAmt   ACL       498  12 2  
ActPaidAmt     ACL       510  12 2  
PrdGrsAmt      ACL       522  12 2  
RUNID_ForPrd   ASCII     534  40    
RUNID_InPrd    ASCII     574  40    
ID_KEY         ASCII     614  85    
SORT_KEY       ASCII     699  52    
SORT_KEY_Desc  ASCII     751  48    
Priority       ASCII     799   1    
RptRunDate     ASCII     800  12    
Data_Range_Start_Date ASCII     812  12    
Data_Range_End_Date ASCII     824  12    
TEST_NAME      ASCII     836  61    
^LAYOUT   PR003_History                      1347 D.T,
Trm_Prd_Days   ACL         1  12 0  
Co_Emp_ID      ASCII      13  20    
Co             ASCII      33  20    
COST_CENTRE    ASCII      53  20    
Emp_ID         ASCII      73  20    
Period_Date    DATETIME   93   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode        ASCII     101   7    
PayCode_Amount ACL       108  12 2  
Pay_Hrs        ACL       120  12 2  
LINE_NO        ASCII     132  20    
LINE_DESC      ASCII     152  60    
LINE_TYPE      ASCII     212  20    
PAY_GROUP      ASCII     232  20    
GL_Account_No  ASCII     252  20    
PERIOD         ASCII     272  20    
Standard_WeeklyHours ACL       292  12 2  
PayCode_Desc   ASCII     304  15    
Num_Field3     ACL       319  12 2  
Num_Field4     ACL       331  12 2  
Num_Field5     ACL       343  12 2  
Prd_Dt         DATETIME  355   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field2      DATETIME  363   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  371   8   PICTURE "YYYYMMDD"  
ForPrd         ASCII     379  20    
InPrd          ASCII     399  20    
Cha_Field3     ASCII     419  20    
Cha_Field4     ASCII     439  20    
Cha_Field5     ASCII     459  20    
Year           ASCII     479   4    
YM             ASCII     483   7    
c_Prd_Dt       ASCII     490   8    
ABS_PayCode_Amount ACL       498  12 0  
PrdSalaryAmt   ACL       510  12 2  
ActPaidAmt     ACL       522  12 2  
PrdGrsAmt      ACL       534  12 2  
RUNID_ForPrd   ASCII     546  40    
RUNID_InPrd    ASCII     586  40    
Trm_Prd_Days2  ACL       626  12 0  
Co_Emp_ID2     ASCII     638  20    
Co2            ASCII     658  20    
COST_CENTRE2   ASCII     678  20    
Emp_ID2        ASCII     698  20    
Period_Date2   DATETIME  718   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode2       ASCII     726   7    
PayCode_Amount2 ACL       733  12 2  
Pay_Hrs2       ACL       745  12 2  
LINE_NO2       ASCII     757  20    
LINE_DESC2     ASCII     777  60    
LINE_TYPE2     ASCII     837  20    
PAY_GROUP2     ASCII     857  20    
GL_Account_No2 ASCII     877  20    
PERIOD2        ASCII     897  20    
Standard_WeeklyHours2 ACL       917  12 2  
PayCode_Desc2  ASCII     929  15    
Num_Field32    ACL       944  12 2  
Num_Field42    ACL       956  12 2  
Num_Field52    ACL       968  12 2  
Prd_Dt2        DATETIME  980   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field22     DATETIME  988   8   PICTURE "YYYYMMDD"  
Dt_Field32     DATETIME  996   8   PICTURE "YYYYMMDD"  
ForPrd2        ASCII    1004  20    
InPrd2         ASCII    1024  20    
Cha_Field32    ASCII    1044  20    
Cha_Field42    ASCII    1064  20    
Cha_Field52    ASCII    1084  20    
Year2          ASCII    1104   4    
YM2            ASCII    1108   7    
c_Prd_Dt2      ASCII    1115   8    
ABS_PayCode_Amount2 ACL      1123  12 0  
PrdSalaryAmt2  ACL      1135  12 2  
ActPaidAmt2    ACL      1147  12 2  
PrdGrsAmt2     ACL      1159  12 2  
RUNID_ForPrd2  ASCII    1171  40    
RUNID_InPrd2   ASCII    1211  40    
Trm_Prd_Days3  ACL      1251  12 0  
ID_KEY         ASCII    1263  85    
^LAYOUT   PR003_Pay_30D_Aft_Trm              1527 D.T,
Trm_Prd_Days   ACL         1  12 0  
Co_Emp_ID      ASCII      13  20    
Co             ASCII      33  20    
COST_CENTRE    ASCII      53  20    
Emp_ID         ASCII      73  20    
Period_Date    DATETIME   93   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode        ASCII     101   7    
PayCode_Amount ACL       108  12 2  
Pay_Hrs        ACL       120  12 2  
LINE_NO        ASCII     132  20    
LINE_DESC      ASCII     152  60    
LINE_TYPE      ASCII     212  20    
PAY_GROUP      ASCII     232  20    
GL_Account_No  ASCII     252  20    
PERIOD         ASCII     272  20    
Standard_WeeklyHours ACL       292  12 2  
PayCode_Desc   ASCII     304  15    
Num_Field3     ACL       319  12 2  
Num_Field4     ACL       331  12 2  
Num_Field5     ACL       343  12 2  
Prd_Dt         DATETIME  355   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field2      DATETIME  363   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  371   8   PICTURE "YYYYMMDD"  
ForPrd         ASCII     379  20    
InPrd          ASCII     399  20    
Cha_Field3     ASCII     419  20    
Cha_Field4     ASCII     439  20    
Cha_Field5     ASCII     459  20    
Year           ASCII     479   4    
YM             ASCII     483   7    
c_Prd_Dt       ASCII     490   8    
ABS_PayCode_Amount ACL       498  12 0  
PrdSalaryAmt   ACL       510  12 2  
ActPaidAmt     ACL       522  12 2  
PrdGrsAmt      ACL       534  12 2  
RUNID_ForPrd   ASCII     546  40    
RUNID_InPrd    ASCII     586  40    
Trm_Prd_Days2  ACL       626  12 0  
Co_Emp_ID2     ASCII     638  20    
Co2            ASCII     658  20    
COST_CENTRE2   ASCII     678  20    
Emp_ID2        ASCII     698  20    
Period_Date2   DATETIME  718   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode2       ASCII     726   7    
PayCode_Amount2 ACL       733  12 2  
Pay_Hrs2       ACL       745  12 2  
LINE_NO2       ASCII     757  20    
LINE_DESC2     ASCII     777  60    
LINE_TYPE2     ASCII     837  20    
PAY_GROUP2     ASCII     857  20    
GL_Account_No2 ASCII     877  20    
PERIOD2        ASCII     897  20    
Standard_WeeklyHours2 ACL       917  12 2  
PayCode_Desc2  ASCII     929  15    
Num_Field32    ACL       944  12 2  
Num_Field42    ACL       956  12 2  
Num_Field52    ACL       968  12 2  
Prd_Dt2        DATETIME  980   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field22     DATETIME  988   8   PICTURE "YYYYMMDD"  
Dt_Field32     DATETIME  996   8   PICTURE "YYYYMMDD"  
ForPrd2        ASCII    1004  20    
InPrd2         ASCII    1024  20    
Cha_Field32    ASCII    1044  20    
Cha_Field42    ASCII    1064  20    
Cha_Field52    ASCII    1084  20    
Year2          ASCII    1104   4    
YM2            ASCII    1108   7    
c_Prd_Dt2      ASCII    1115   8    
ABS_PayCode_Amount2 ACL      1123  12 0  
PrdSalaryAmt2  ACL      1135  12 2  
ActPaidAmt2    ACL      1147  12 2  
PrdGrsAmt2     ACL      1159  12 2  
RUNID_ForPrd2  ASCII    1171  40    
RUNID_InPrd2   ASCII    1211  40    
Trm_Prd_Days3  ACL      1251  12 0  
ID_KEY         ASCII    1263  85    
SORT_KEY       ASCII    1348  40    
SORT_KEY_Desc  ASCII    1388  36    
Priority       ASCII    1424   1    
RptRunDate     ASCII    1425  12    
Data_Range_Start_Date ASCII    1437  12    
Data_Range_End_Date ASCII    1449  12    
TEST_NAME      ASCII    1461  67    
^LAYOUT   PR004_History                      223 D.T,
Co_Emp_ID      ASCII       1  20    
c_Prd_Dt       ASCII      21   8    
Pay_Hrs        ACL        29  12 2  
PayCode_Amount ACL        41  12 2  
COUNT          ACL        53  12 0 WIDTH 8  
Prd_Dt         DATETIME   65   8   PICTURE "YYYYMMDD" WIDTH 27  
ID             ACL        73  12 0  
Consec1        ACL        85  12 0  
Consec2        ACL        97  12 0  
KEY            ASCII     109  30    
ID_KEY         ASCII     139  85    
^LAYOUT   PR004_Spec_Leave_3Mon              1515 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
Emp_ID         ASCII      61  20    
Period_Date    DATETIME   81   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode        ASCII      89   7    
PayCode_Amount ACL        96  12 2  
Pay_Hrs        ACL       108  12 2  
LINE_NO        ASCII     120  20    
LINE_DESC      ASCII     140  60    
LINE_TYPE      ASCII     200  20    
PAY_GROUP      ASCII     220  20    
GL_Account_No  ASCII     240  20    
PERIOD         ASCII     260  20    
Standard_WeeklyHours ACL       280  12 2  
PayCode_Desc   ASCII     292  15    
Num_Field3     ACL       307  12 2  
Num_Field4     ACL       319  12 2  
Num_Field5     ACL       331  12 2  
Prd_Dt         DATETIME  343   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field2      DATETIME  351   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  359   8   PICTURE "YYYYMMDD"  
ForPrd         ASCII     367  20    
InPrd          ASCII     387  20    
Cha_Field3     ASCII     407  20    
Cha_Field4     ASCII     427  20    
Cha_Field5     ASCII     447  20    
Year           ASCII     467   4    
YM             ASCII     471   7    
c_Prd_Dt       ASCII     478   8    
ABS_PayCode_Amount ACL       486  12 0  
PrdSalaryAmt   ACL       498  12 2  
ActPaidAmt     ACL       510  12 2  
PrdGrsAmt      ACL       522  12 2  
RUNID_ForPrd   ASCII     534  40    
RUNID_InPrd    ASCII     574  40    
Trm_Prd_Days   ACL       614  12 0  
KEY            ASCII     626  30    
Co_Emp_ID2     ASCII     656  20    
Co2            ASCII     676  20    
COST_CENTRE2   ASCII     696  20    
Emp_ID2        ASCII     716  20    
Period_Date2   DATETIME  736   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode2       ASCII     744   7    
PayCode_Amount2 ACL       751  12 2  
Pay_Hrs2       ACL       763  12 2  
LINE_NO2       ASCII     775  20    
LINE_DESC2     ASCII     795  60    
LINE_TYPE2     ASCII     855  20    
PAY_GROUP2     ASCII     875  20    
GL_Account_No2 ASCII     895  20    
PERIOD2        ASCII     915  20    
Standard_WeeklyHours2 ACL       935  12 2  
PayCode_Desc2  ASCII     947  15    
Num_Field32    ACL       962  12 2  
Num_Field42    ACL       974  12 2  
Num_Field52    ACL       986  12 2  
Prd_Dt2        DATETIME  998   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field22     DATETIME 1006   8   PICTURE "YYYYMMDD"  
Dt_Field32     DATETIME 1014   8   PICTURE "YYYYMMDD"  
ForPrd2        ASCII    1022  20    
InPrd2         ASCII    1042  20    
Cha_Field32    ASCII    1062  20    
Cha_Field42    ASCII    1082  20    
Cha_Field52    ASCII    1102  20    
Year2          ASCII    1122   4    
YM2            ASCII    1126   7    
c_Prd_Dt2      ASCII    1133   8    
ABS_PayCode_Amount2 ACL      1141  12 0  
PrdSalaryAmt2  ACL      1153  12 2  
ActPaidAmt2    ACL      1165  12 2  
PrdGrsAmt2     ACL      1177  12 2  
RUNID_ForPrd2  ASCII    1189  40    
RUNID_InPrd2   ASCII    1229  40    
Trm_Prd_Days2  ACL      1269  12 0  
KEY2           ASCII    1281  30    
SORT_KEY       ASCII    1311  30    
SORT_KEY_Desc  ASCII    1341  18    
Priority       ASCII    1359   1    
RptRunDate     ASCII    1360  12    
Data_Range_Start_Date ASCII    1372  12    
Data_Range_End_Date ASCII    1384  12    
TEST_NAME      ASCII    1396 120    
^LAYOUT   PR005_History                      1395 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
Emp_ID         ASCII      61  20    
Period_Date    DATETIME   81   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode        ASCII      89   7    
PayCode_Amount ACL        96  12 2  
Pay_Hrs        ACL       108  12 2  
LINE_NO        ASCII     120  20    
LINE_DESC      ASCII     140  60    
LINE_TYPE      ASCII     200  20    
PAY_GROUP      ASCII     220  20    
GL_Account_No  ASCII     240  20    
PERIOD         ASCII     260  20    
Standard_WeeklyHours ACL       280  12 2  
PayCode_Desc   ASCII     292  15    
Num_Field3     ACL       307  12 2  
Num_Field4     ACL       319  12 2  
Num_Field5     ACL       331  12 2  
Prd_Dt         DATETIME  343   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field2      DATETIME  351   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  359   8   PICTURE "YYYYMMDD"  
ForPrd         ASCII     367  20    
InPrd          ASCII     387  20    
Cha_Field3     ASCII     407  20    
Cha_Field4     ASCII     427  20    
Cha_Field5     ASCII     447  20    
Year           ASCII     467   4    
YM             ASCII     471   7    
c_Prd_Dt       ASCII     478   8    
ABS_PayCode_Amount ACL       486  12 0  
PrdSalaryAmt   ACL       498  12 2  
ActPaidAmt     ACL       510  12 2  
PrdGrsAmt      ACL       522  12 2  
RUNID_ForPrd   ASCII     534  40    
RUNID_InPrd    ASCII     574  40    
Trm_Prd_Days   ACL       614  12 0  
KEY            ASCII     626  30    
Co_Emp_ID2     ASCII     656  20    
Co2            ASCII     676  20    
COST_CENTRE2   ASCII     696  20    
Emp_ID2        ASCII     716  20    
Period_Date2   DATETIME  736   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode2       ASCII     744   7    
PayCode_Amount2 ACL       751  12 2  
Pay_Hrs2       ACL       763  12 2  
LINE_NO2       ASCII     775  20    
LINE_DESC2     ASCII     795  60    
LINE_TYPE2     ASCII     855  20    
PAY_GROUP2     ASCII     875  20    
GL_Account_No2 ASCII     895  20    
PERIOD2        ASCII     915  20    
Standard_WeeklyHours2 ACL       935  12 2  
PayCode_Desc2  ASCII     947  15    
Num_Field32    ACL       962  12 2  
Num_Field42    ACL       974  12 2  
Num_Field52    ACL       986  12 2  
Prd_Dt2        DATETIME  998   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field22     DATETIME 1006   8   PICTURE "YYYYMMDD"  
Dt_Field32     DATETIME 1014   8   PICTURE "YYYYMMDD"  
ForPrd2        ASCII    1022  20    
InPrd2         ASCII    1042  20    
Cha_Field32    ASCII    1062  20    
Cha_Field42    ASCII    1082  20    
Cha_Field52    ASCII    1102  20    
Year2          ASCII    1122   4    
YM2            ASCII    1126   7    
c_Prd_Dt2      ASCII    1133   8    
ABS_PayCode_Amount2 ACL      1141  12 0  
PrdSalaryAmt2  ACL      1153  12 2  
ActPaidAmt2    ACL      1165  12 2  
PrdGrsAmt2     ACL      1177  12 2  
RUNID_ForPrd2  ASCII    1189  40    
RUNID_InPrd2   ASCII    1229  40    
Trm_Prd_Days2  ACL      1269  12 0  
KEY2           ASCII    1281  30    
ID_KEY         ASCII    1311  85    
^LAYOUT   PR005_Pay_TrmAmt_Sleeper           1552 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
Emp_ID         ASCII      61  20    
Period_Date    DATETIME   81   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode        ASCII      89   7    
PayCode_Amount ACL        96  12 2  
Pay_Hrs        ACL       108  12 2  
LINE_NO        ASCII     120  20    
LINE_DESC      ASCII     140  60    
LINE_TYPE      ASCII     200  20    
PAY_GROUP      ASCII     220  20    
GL_Account_No  ASCII     240  20    
PERIOD         ASCII     260  20    
Standard_WeeklyHours ACL       280  12 2  
PayCode_Desc   ASCII     292  15    
Num_Field3     ACL       307  12 2  
Num_Field4     ACL       319  12 2  
Num_Field5     ACL       331  12 2  
Prd_Dt         DATETIME  343   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field2      DATETIME  351   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  359   8   PICTURE "YYYYMMDD"  
ForPrd         ASCII     367  20    
InPrd          ASCII     387  20    
Cha_Field3     ASCII     407  20    
Cha_Field4     ASCII     427  20    
Cha_Field5     ASCII     447  20    
Year           ASCII     467   4    
YM             ASCII     471   7    
c_Prd_Dt       ASCII     478   8    
ABS_PayCode_Amount ACL       486  12 0  
PrdSalaryAmt   ACL       498  12 2  
ActPaidAmt     ACL       510  12 2  
PrdGrsAmt      ACL       522  12 2  
RUNID_ForPrd   ASCII     534  40    
RUNID_InPrd    ASCII     574  40    
Trm_Prd_Days   ACL       614  12 0  
KEY            ASCII     626  30    
Co_Emp_ID2     ASCII     656  20    
Co2            ASCII     676  20    
COST_CENTRE2   ASCII     696  20    
Emp_ID2        ASCII     716  20    
Period_Date2   DATETIME  736   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode2       ASCII     744   7    
PayCode_Amount2 ACL       751  12 2  
Pay_Hrs2       ACL       763  12 2  
LINE_NO2       ASCII     775  20    
LINE_DESC2     ASCII     795  60    
LINE_TYPE2     ASCII     855  20    
PAY_GROUP2     ASCII     875  20    
GL_Account_No2 ASCII     895  20    
PERIOD2        ASCII     915  20    
Standard_WeeklyHours2 ACL       935  12 2  
PayCode_Desc2  ASCII     947  15    
Num_Field32    ACL       962  12 2  
Num_Field42    ACL       974  12 2  
Num_Field52    ACL       986  12 2  
Prd_Dt2        DATETIME  998   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field22     DATETIME 1006   8   PICTURE "YYYYMMDD"  
Dt_Field32     DATETIME 1014   8   PICTURE "YYYYMMDD"  
ForPrd2        ASCII    1022  20    
InPrd2         ASCII    1042  20    
Cha_Field32    ASCII    1062  20    
Cha_Field42    ASCII    1082  20    
Cha_Field52    ASCII    1102  20    
Year2          ASCII    1122   4    
YM2            ASCII    1126   7    
c_Prd_Dt2      ASCII    1133   8    
ABS_PayCode_Amount2 ACL      1141  12 0  
PrdSalaryAmt2  ACL      1153  12 2  
ActPaidAmt2    ACL      1165  12 2  
PrdGrsAmt2     ACL      1177  12 2  
RUNID_ForPrd2  ASCII    1189  40    
RUNID_InPrd2   ASCII    1229  40    
Trm_Prd_Days2  ACL      1269  12 0  
KEY2           ASCII    1281  30    
ID_KEY         ASCII    1311  85    
SORT_KEY       ASCII    1396  30    
SORT_KEY_Desc  ASCII    1426  18    
Priority       ASCII    1444   1    
RptRunDate     ASCII    1445  12    
Data_Range_Start_Date ASCII    1457  12    
Data_Range_End_Date ASCII    1469  12    
TEST_NAME      ASCII    1481  72    
^LAYOUT   PR006_History                      1660 D.T,
Ttl_PayAmt     ACL         1  12 2  
PayCode        ASCII      13   7    
RUNID_InPrd    ASCII      20  40    
Ttl_SuperAmt   ACL        60  12 2  
COUNT          ACL        72  12 0 WIDTH 8  
Co_Emp_ID      ASCII      84  20    
Co             ASCII     104  20    
COST_CENTRE    ASCII     124  20    
Emp_ID         ASCII     144  20    
Period_Date    DATETIME  164   8   PICTURE "YYYYMMDD"  
PayCode_Amount ACL       172  12 2  
Pay_Hrs        ACL       184  12 2  
LINE_NO        ASCII     196  20    
LINE_DESC      ASCII     216  60    
LINE_TYPE      ASCII     276  20    
PAY_GROUP      ASCII     296  20    
GL_Account_No  ASCII     316  20    
PERIOD         ASCII     336  20    
Standard_WeeklyHours ACL       356  12 2 WIDTH 20  
PayCode_Desc   ASCII     368  15    
Num_Field3     ACL       383  12 2  
Num_Field4     ACL       395  12 2  
Num_Field5     ACL       407  12 2  
Prd_Dt         DATETIME  419   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  427   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  435   8   PICTURE "YYYYMMDD"  
ForPrd         ASCII     443  20    
InPrd          ASCII     463  20    
Cha_Field3     ASCII     483  20    
Cha_Field4     ASCII     503  20    
Cha_Field5     ASCII     523  20    
Year           ASCII     543   4    
YM             ASCII     547   7    
c_Prd_Dt       ASCII     554   8    
ABS_PayCode_Amount ACL       562  12 0 WIDTH 18  
PrdSalaryAmt   ACL       574  12 2  
ActPaidAmt     ACL       586  12 2  
PrdGrsAmt      ACL       598  12 2  
RUNID_ForPrd   ASCII     610  40    
Trm_Prd_Days   ACL       650  12 0  
KEY            ASCII     662  30    
Co_Emp_ID2     ASCII     692  20    
Co2            ASCII     712  20    
COST_CENTRE2   ASCII     732  20    
Emp_ID2        ASCII     752  20    
Period_Date2   DATETIME  772   8   PICTURE "YYYYMMDD"  
PayCode2       ASCII     780   7    
PayCode_Amount2 ACL       787  12 2  
Pay_Hrs2       ACL       799  12 2  
LINE_NO2       ASCII     811  20    
LINE_DESC2     ASCII     831  60    
LINE_TYPE2     ASCII     891  20    
PAY_GROUP2     ASCII     911  20    
GL_Account_No2 ASCII     931  20    
PERIOD2        ASCII     951  20    
Standard_WeeklyHours2 ACL       971  12 2 WIDTH 20  
PayCode_Desc2  ASCII     983  15    
Num_Field32    ACL       998  12 2  
Num_Field42    ACL      1010  12 2  
Num_Field52    ACL      1022  12 2  
Prd_Dt2        DATETIME 1034   8   PICTURE "YYYYMMDD"  
Dt_Field22     DATETIME 1042   8   PICTURE "YYYYMMDD"  
Dt_Field32     DATETIME 1050   8   PICTURE "YYYYMMDD"  
ForPrd2        ASCII    1058  20    
InPrd2         ASCII    1078  20    
Cha_Field32    ASCII    1098  20    
Cha_Field42    ASCII    1118  20    
Cha_Field52    ASCII    1138  20    
Year2          ASCII    1158   4    
YM2            ASCII    1162   7    
c_Prd_Dt2      ASCII    1169   8    
ABS_PayCode_Amount2 ACL      1177  12 0 WIDTH 18  
PrdSalaryAmt2  ACL      1189  12 2  
ActPaidAmt2    ACL      1201  12 2  
PrdGrsAmt2     ACL      1213  12 2  
RUNID_ForPrd2  ASCII    1225  40    
Trm_Prd_Days2  ACL      1265  12 0  
KEY2           ASCII    1277  30    
Ttl_SuperPaidAmt ACL      1307  12 2  
SGC_Pct        ACL      1319  12 2  
ID_KEY         ASCII    1331  85    
RptRunDate     ASCII    1416  12    
SORT_KEY       ASCII    1428  55    
SORT_KEY_Desc  ASCII    1483  33    
Priority       ASCII    1516   1    
Data_Range_Start_Date ASCII    1517  12    
Data_Range_End_Date ASCII    1529  12    
TEST_NAME      ASCII    1541 120    
^LAYOUT   PR006_Unusual_Super                1660 D.T,
Ttl_PayAmt     ACL         1  12 2  
PayCode        ASCII      13   7    
RUNID_InPrd    ASCII      20  40    
Ttl_SuperAmt   ACL        60  12 2  
COUNT          ACL        72  12 0 WIDTH 8  
Co_Emp_ID      ASCII      84  20    
Co             ASCII     104  20    
COST_CENTRE    ASCII     124  20    
Emp_ID         ASCII     144  20    
Period_Date    DATETIME  164   8   PICTURE "YYYYMMDD"  
PayCode_Amount ACL       172  12 2  
Pay_Hrs        ACL       184  12 2  
LINE_NO        ASCII     196  20    
LINE_DESC      ASCII     216  60    
LINE_TYPE      ASCII     276  20    
PAY_GROUP      ASCII     296  20    
GL_Account_No  ASCII     316  20    
PERIOD         ASCII     336  20    
Standard_WeeklyHours ACL       356  12 2 WIDTH 20  
PayCode_Desc   ASCII     368  15    
Num_Field3     ACL       383  12 2  
Num_Field4     ACL       395  12 2  
Num_Field5     ACL       407  12 2  
Prd_Dt         DATETIME  419   8   PICTURE "YYYYMMDD"  
Dt_Field2      DATETIME  427   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  435   8   PICTURE "YYYYMMDD"  
ForPrd         ASCII     443  20    
InPrd          ASCII     463  20    
Cha_Field3     ASCII     483  20    
Cha_Field4     ASCII     503  20    
Cha_Field5     ASCII     523  20    
Year           ASCII     543   4    
YM             ASCII     547   7    
c_Prd_Dt       ASCII     554   8    
ABS_PayCode_Amount ACL       562  12 0 WIDTH 18  
PrdSalaryAmt   ACL       574  12 2  
ActPaidAmt     ACL       586  12 2  
PrdGrsAmt      ACL       598  12 2  
RUNID_ForPrd   ASCII     610  40    
Trm_Prd_Days   ACL       650  12 0  
KEY            ASCII     662  30    
Co_Emp_ID2     ASCII     692  20    
Co2            ASCII     712  20    
COST_CENTRE2   ASCII     732  20    
Emp_ID2        ASCII     752  20    
Period_Date2   DATETIME  772   8   PICTURE "YYYYMMDD"  
PayCode2       ASCII     780   7    
PayCode_Amount2 ACL       787  12 2  
Pay_Hrs2       ACL       799  12 2  
LINE_NO2       ASCII     811  20    
LINE_DESC2     ASCII     831  60    
LINE_TYPE2     ASCII     891  20    
PAY_GROUP2     ASCII     911  20    
GL_Account_No2 ASCII     931  20    
PERIOD2        ASCII     951  20    
Standard_WeeklyHours2 ACL       971  12 2 WIDTH 20  
PayCode_Desc2  ASCII     983  15    
Num_Field32    ACL       998  12 2  
Num_Field42    ACL      1010  12 2  
Num_Field52    ACL      1022  12 2  
Prd_Dt2        DATETIME 1034   8   PICTURE "YYYYMMDD"  
Dt_Field22     DATETIME 1042   8   PICTURE "YYYYMMDD"  
Dt_Field32     DATETIME 1050   8   PICTURE "YYYYMMDD"  
ForPrd2        ASCII    1058  20    
InPrd2         ASCII    1078  20    
Cha_Field32    ASCII    1098  20    
Cha_Field42    ASCII    1118  20    
Cha_Field52    ASCII    1138  20    
Year2          ASCII    1158   4    
YM2            ASCII    1162   7    
c_Prd_Dt2      ASCII    1169   8    
ABS_PayCode_Amount2 ACL      1177  12 0 WIDTH 18  
PrdSalaryAmt2  ACL      1189  12 2  
ActPaidAmt2    ACL      1201  12 2  
PrdGrsAmt2     ACL      1213  12 2  
RUNID_ForPrd2  ASCII    1225  40    
Trm_Prd_Days2  ACL      1265  12 0  
KEY2           ASCII    1277  30    
Ttl_SuperPaidAmt ACL      1307  12 2  
SGC_Pct        ACL      1319  12 2  
ID_KEY         ASCII    1331  85    
RptRunDate     ASCII    1416  12    
SORT_KEY       ASCII    1428  55    
SORT_KEY_Desc  ASCII    1483  33    
Priority       ASCII    1516   1    
Data_Range_Start_Date ASCII    1517  12    
Data_Range_End_Date ASCII    1529  12    
TEST_NAME      ASCII    1541 120    
^LAYOUT   PR006D_Unusual_Super               1346 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
Emp_ID         ASCII      61  20    
Period_Date    DATETIME   81   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode        ASCII      89   7    
PayCode_Amount ACL        96  12 2  
Pay_Hrs        ACL       108  12 2  
LINE_NO        ASCII     120  20    
LINE_DESC      ASCII     140  60    
LINE_TYPE      ASCII     200  20    
PAY_GROUP      ASCII     220  20    
GL_Account_No  ASCII     240  20    
PERIOD         ASCII     260  20    
Standard_WeeklyHours ACL       280  12 2  
PayCode_Desc   ASCII     292  15    
Num_Field3     ACL       307  12 2  
Num_Field4     ACL       319  12 2  
Num_Field5     ACL       331  12 2  
Prd_Dt         DATETIME  343   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field2      DATETIME  351   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  359   8   PICTURE "YYYYMMDD"  
ForPrd         ASCII     367  20    
InPrd          ASCII     387  20    
Cha_Field3     ASCII     407  20    
Cha_Field4     ASCII     427  20    
Cha_Field5     ASCII     447  20    
Year           ASCII     467   4    
YM             ASCII     471   7    
c_Prd_Dt       ASCII     478   8    
ABS_PayCode_Amount ACL       486  12 0  
PrdSalaryAmt   ACL       498  12 2  
ActPaidAmt     ACL       510  12 2  
PrdGrsAmt      ACL       522  12 2  
RUNID_ForPrd   ASCII     534  40    
RUNID_InPrd    ASCII     574  40    
Trm_Prd_Days   ACL       614  12 0  
KEY            ASCII     626  30    
Co_Emp_ID2     ASCII     656  20    
Co2            ASCII     676  20    
COST_CENTRE2   ASCII     696  20    
Emp_ID2        ASCII     716  20    
Period_Date2   DATETIME  736   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode2       ASCII     744   7    
PayCode_Amount2 ACL       751  12 2  
Pay_Hrs2       ACL       763  12 2  
LINE_NO2       ASCII     775  20    
LINE_DESC2     ASCII     795  60    
LINE_TYPE2     ASCII     855  20    
PAY_GROUP2     ASCII     875  20    
GL_Account_No2 ASCII     895  20    
PERIOD2        ASCII     915  20    
Standard_WeeklyHours2 ACL       935  12 2  
PayCode_Desc2  ASCII     947  15    
Num_Field32    ACL       962  12 2  
Num_Field42    ACL       974  12 2  
Num_Field52    ACL       986  12 2  
Prd_Dt2        DATETIME  998   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field22     DATETIME 1006   8   PICTURE "YYYYMMDD"  
Dt_Field32     DATETIME 1014   8   PICTURE "YYYYMMDD"  
ForPrd2        ASCII    1022  20    
InPrd2         ASCII    1042  20    
Cha_Field32    ASCII    1062  20    
Cha_Field42    ASCII    1082  20    
Cha_Field52    ASCII    1102  20    
Year2          ASCII    1122   4    
YM2            ASCII    1126   7    
c_Prd_Dt2      ASCII    1133   8    
ABS_PayCode_Amount2 ACL      1141  12 0  
PrdSalaryAmt2  ACL      1153  12 2  
ActPaidAmt2    ACL      1165  12 2  
PrdGrsAmt2     ACL      1177  12 2  
RUNID_ForPrd2  ASCII    1189  40    
RUNID_InPrd2   ASCII    1229  40    
Trm_Prd_Days2  ACL      1269  12 0  
KEY2           ASCII    1281  30    
RptRunDate     ASCII    1311  12    
Data_Range_Start_Date ASCII    1323  12    
Data_Range_End_Date ASCII    1335  12    
SORT_KEY       COMPUTED             
 *C 60 1 
 SUBSTR(ALLTRIM(RUNID_InPrd)+'~'+ALLTRIM(PayCode),1,60)
TEST_NAME      COMPUTED             
 *C 120 1 
 SUBSTR("PR006D. Unusual superannuation contribution  where superannuation is 9.5% of taxable income  - Details",1,120)
^LAYOUT   PR007_History                      1395 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
Emp_ID         ASCII      61  20    
Period_Date    DATETIME   81   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode        ASCII      89   7    
PayCode_Amount ACL        96  12 2  
Pay_Hrs        ACL       108  12 2  
LINE_NO        ASCII     120  20    
LINE_DESC      ASCII     140  60    
LINE_TYPE      ASCII     200  20    
PAY_GROUP      ASCII     220  20    
GL_Account_No  ASCII     240  20    
PERIOD         ASCII     260  20    
Standard_WeeklyHours ACL       280  12 2  
PayCode_Desc   ASCII     292  15    
Num_Field3     ACL       307  12 2  
Num_Field4     ACL       319  12 2  
Num_Field5     ACL       331  12 2  
Prd_Dt         DATETIME  343   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field2      DATETIME  351   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  359   8   PICTURE "YYYYMMDD"  
ForPrd         ASCII     367  20    
InPrd          ASCII     387  20    
Cha_Field3     ASCII     407  20    
Cha_Field4     ASCII     427  20    
Cha_Field5     ASCII     447  20    
Year           ASCII     467   4    
YM             ASCII     471   7    
c_Prd_Dt       ASCII     478   8    
ABS_PayCode_Amount ACL       486  12 0  
PrdSalaryAmt   ACL       498  12 2  
ActPaidAmt     ACL       510  12 2  
PrdGrsAmt      ACL       522  12 2  
RUNID_ForPrd   ASCII     534  40    
RUNID_InPrd    ASCII     574  40    
Trm_Prd_Days   ACL       614  12 0  
KEY            ASCII     626  30    
Co_Emp_ID2     ASCII     656  20    
Co2            ASCII     676  20    
COST_CENTRE2   ASCII     696  20    
Emp_ID2        ASCII     716  20    
Period_Date2   DATETIME  736   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode2       ASCII     744   7    
PayCode_Amount2 ACL       751  12 2  
Pay_Hrs2       ACL       763  12 2  
LINE_NO2       ASCII     775  20    
LINE_DESC2     ASCII     795  60    
LINE_TYPE2     ASCII     855  20    
PAY_GROUP2     ASCII     875  20    
GL_Account_No2 ASCII     895  20    
PERIOD2        ASCII     915  20    
Standard_WeeklyHours2 ACL       935  12 2  
PayCode_Desc2  ASCII     947  15    
Num_Field32    ACL       962  12 2  
Num_Field42    ACL       974  12 2  
Num_Field52    ACL       986  12 2  
Prd_Dt2        DATETIME  998   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field22     DATETIME 1006   8   PICTURE "YYYYMMDD"  
Dt_Field32     DATETIME 1014   8   PICTURE "YYYYMMDD"  
ForPrd2        ASCII    1022  20    
InPrd2         ASCII    1042  20    
Cha_Field32    ASCII    1062  20    
Cha_Field42    ASCII    1082  20    
Cha_Field52    ASCII    1102  20    
Year2          ASCII    1122   4    
YM2            ASCII    1126   7    
c_Prd_Dt2      ASCII    1133   8    
ABS_PayCode_Amount2 ACL      1141  12 0  
PrdSalaryAmt2  ACL      1153  12 2  
ActPaidAmt2    ACL      1165  12 2  
PrdGrsAmt2     ACL      1177  12 2  
RUNID_ForPrd2  ASCII    1189  40    
RUNID_InPrd2   ASCII    1229  40    
Trm_Prd_Days2  ACL      1269  12 0  
KEY2           ASCII    1281  30    
ID_KEY         ASCII    1311  85    
^LAYOUT   PR007_Hourly_Emp                   1557 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
Emp_ID         ASCII      61  20    
Period_Date    DATETIME   81   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode        ASCII      89   7    
PayCode_Amount ACL        96  12 2  
Pay_Hrs        ACL       108  12 2  
LINE_NO        ASCII     120  20    
LINE_DESC      ASCII     140  60    
LINE_TYPE      ASCII     200  20    
PAY_GROUP      ASCII     220  20    
GL_Account_No  ASCII     240  20    
PERIOD         ASCII     260  20    
Standard_WeeklyHours ACL       280  12 2  
PayCode_Desc   ASCII     292  15    
Num_Field3     ACL       307  12 2  
Num_Field4     ACL       319  12 2  
Num_Field5     ACL       331  12 2  
Prd_Dt         DATETIME  343   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field2      DATETIME  351   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  359   8   PICTURE "YYYYMMDD"  
ForPrd         ASCII     367  20    
InPrd          ASCII     387  20    
Cha_Field3     ASCII     407  20    
Cha_Field4     ASCII     427  20    
Cha_Field5     ASCII     447  20    
Year           ASCII     467   4    
YM             ASCII     471   7    
c_Prd_Dt       ASCII     478   8    
ABS_PayCode_Amount ACL       486  12 0  
PrdSalaryAmt   ACL       498  12 2  
ActPaidAmt     ACL       510  12 2  
PrdGrsAmt      ACL       522  12 2  
RUNID_ForPrd   ASCII     534  40    
RUNID_InPrd    ASCII     574  40    
Trm_Prd_Days   ACL       614  12 0  
KEY            ASCII     626  30    
Co_Emp_ID2     ASCII     656  20    
Co2            ASCII     676  20    
COST_CENTRE2   ASCII     696  20    
Emp_ID2        ASCII     716  20    
Period_Date2   DATETIME  736   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode2       ASCII     744   7    
PayCode_Amount2 ACL       751  12 2  
Pay_Hrs2       ACL       763  12 2  
LINE_NO2       ASCII     775  20    
LINE_DESC2     ASCII     795  60    
LINE_TYPE2     ASCII     855  20    
PAY_GROUP2     ASCII     875  20    
GL_Account_No2 ASCII     895  20    
PERIOD2        ASCII     915  20    
Standard_WeeklyHours2 ACL       935  12 2  
PayCode_Desc2  ASCII     947  15    
Num_Field32    ACL       962  12 2  
Num_Field42    ACL       974  12 2  
Num_Field52    ACL       986  12 2  
Prd_Dt2        DATETIME  998   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field22     DATETIME 1006   8   PICTURE "YYYYMMDD"  
Dt_Field32     DATETIME 1014   8   PICTURE "YYYYMMDD"  
ForPrd2        ASCII    1022  20    
InPrd2         ASCII    1042  20    
Cha_Field32    ASCII    1062  20    
Cha_Field42    ASCII    1082  20    
Cha_Field52    ASCII    1102  20    
Year2          ASCII    1122   4    
YM2            ASCII    1126   7    
c_Prd_Dt2      ASCII    1133   8    
ABS_PayCode_Amount2 ACL      1141  12 0  
PrdSalaryAmt2  ACL      1153  12 2  
ActPaidAmt2    ACL      1165  12 2  
PrdGrsAmt2     ACL      1177  12 2  
RUNID_ForPrd2  ASCII    1189  40    
RUNID_InPrd2   ASCII    1229  40    
Trm_Prd_Days2  ACL      1269  12 0  
KEY2           ASCII    1281  30    
ID_KEY         ASCII    1311  85    
SORT_KEY       ASCII    1396  30    
SORT_KEY_Desc  ASCII    1426  18    
Priority       ASCII    1444   1    
RptRunDate     ASCII    1445  12    
Data_Range_Start_Date ASCII    1457  12    
Data_Range_End_Date ASCII    1469  12    
TEST_NAME      ASCII    1481  77    
^LAYOUT   PR008_Top_50_Over_3_Mon            330 D.T,
Co_Emp_ID      ASCII       1  20    
COST_CENTRE    ASCII      21  20    
PayCode_Amount ACL        41  12 2  
Pay_Hrs        ACL        53  12 2  
COUNT          ACL        65  12 0 WIDTH 8  
Co_Emp_ID2     ASCII      77  20    
COST_CENTRE2   ASCII      97  20    
PayCode_Amount2 ACL       117  12 2  
Pay_Hrs2       ACL       129  12 2  
COUNT2         ACL       141  12 0 WIDTH 8  
SORT_KEY       ASCII     153  15    
SORT_KEY_Desc  ASCII     168  14    
Priority       ASCII     182   1    
RptRunDate     ASCII     183  12   AS "Report Run Date"  
Data_Range_Start_Date DATETIME  195   8   PICTURE "YYYYMMDD" AS "Data Range Start Date" WIDTH 27  
Data_Range_End_Date DATETIME  203   8   PICTURE "YYYYMMDD" AS "Date Range End Date" WIDTH 27  
TEST_NAME      ASCII     211 120    
^LAYOUT   PR008D_Top_50_Over_3_Mon           1439 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
Emp_ID         ASCII      61  20    
Period_Date    DATETIME   81   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode        ASCII      89   7    
PayCode_Amount ACL        96  12 2  
Pay_Hrs        ACL       108  12 2  
LINE_NO        ASCII     120  20    
LINE_DESC      ASCII     140  60    
LINE_TYPE      ASCII     200  20    
PAY_GROUP      ASCII     220  20    
GL_Account_No  ASCII     240  20    
PERIOD         ASCII     260  20    
Standard_WeeklyHours ACL       280  12 2  
PayCode_Desc   ASCII     292  15    
Num_Field3     ACL       307  12 2  
Num_Field4     ACL       319  12 2  
Num_Field5     ACL       331  12 2  
Prd_Dt         DATETIME  343   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field2      DATETIME  351   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  359   8   PICTURE "YYYYMMDD"  
ForPrd         ASCII     367  20    
InPrd          ASCII     387  20    
Cha_Field3     ASCII     407  20    
Cha_Field4     ASCII     427  20    
Cha_Field5     ASCII     447  20    
Year           ASCII     467   4    
YM             ASCII     471   7    
c_Prd_Dt       ASCII     478   8    
ABS_PayCode_Amount ACL       486  12 0  
PrdSalaryAmt   ACL       498  12 2  
ActPaidAmt     ACL       510  12 2  
PrdGrsAmt      ACL       522  12 2  
RUNID_ForPrd   ASCII     534  40    
RUNID_InPrd    ASCII     574  40    
Trm_Prd_Days   ACL       614  12 0  
KEY            ASCII     626  30    
Co_Emp_ID2     ASCII     656  20    
Co2            ASCII     676  20    
COST_CENTRE2   ASCII     696  20    
Emp_ID2        ASCII     716  20    
Period_Date2   DATETIME  736   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode2       ASCII     744   7    
PayCode_Amount2 ACL       751  12 2  
Pay_Hrs2       ACL       763  12 2  
LINE_NO2       ASCII     775  20    
LINE_DESC2     ASCII     795  60    
LINE_TYPE2     ASCII     855  20    
PAY_GROUP2     ASCII     875  20    
GL_Account_No2 ASCII     895  20    
PERIOD2        ASCII     915  20    
Standard_WeeklyHours2 ACL       935  12 2  
PayCode_Desc2  ASCII     947  15    
Num_Field32    ACL       962  12 2  
Num_Field42    ACL       974  12 2  
Num_Field52    ACL       986  12 2  
Prd_Dt2        DATETIME  998   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field22     DATETIME 1006   8   PICTURE "YYYYMMDD"  
Dt_Field32     DATETIME 1014   8   PICTURE "YYYYMMDD"  
ForPrd2        ASCII    1022  20    
InPrd2         ASCII    1042  20    
Cha_Field32    ASCII    1062  20    
Cha_Field42    ASCII    1082  20    
Cha_Field52    ASCII    1102  20    
Year2          ASCII    1122   4    
YM2            ASCII    1126   7    
c_Prd_Dt2      ASCII    1133   8    
ABS_PayCode_Amount2 ACL      1141  12 0  
PrdSalaryAmt2  ACL      1153  12 2  
ActPaidAmt2    ACL      1165  12 2  
PrdGrsAmt2     ACL      1177  12 2  
RUNID_ForPrd2  ASCII    1189  40    
RUNID_InPrd2   ASCII    1229  40    
Trm_Prd_Days2  ACL      1269  12 0  
KEY2           ASCII    1281  30    
SORT_KEY       ASCII    1311  30    
SORT_KEY_Desc  ASCII    1341  16    
Priority       ASCII    1357   1    
RptRunDate     ASCII    1358  12   AS "Report Run Date"  
Data_Range_Start_Date ASCII    1370  12   AS "Data Range Start Date"  
Data_Range_End_Date ASCII    1382  12   AS "Date Range End Date"  
TEST_NAME      ASCII    1394  46    
^LAYOUT   Payroll_Payments                   466 D.T,
!"EMF_Emp_Master_File" "IDX_Co_Emp_ID" Co_Emp_ID
!"EMF_TMP_Emp" "IDX_EMF_Co_Emp_ID" Co_Emp_ID
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
Emp_ID         ASCII      61  20    
Period_Date    DATETIME   81   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode        ASCII      89   7    
PayCode_Amount ACL        96  12 2  
Pay_Hrs        ACL       108  12 2  
LINE_NO        ASCII     120  20    
LINE_DESC      ASCII     140  60    
LINE_TYPE      ASCII     200  20    
PAY_GROUP      ASCII     220  20    
GL_Account_No  ASCII     240  20    
PERIOD         ASCII     260  20    
Standard_WeeklyHours ACL       280  12 2  
PayCode_Desc   ASCII     292  15    
Num_Field3     ACL       307  12 2  
Num_Field4     ACL       319  12 2  
Num_Field5     ACL       331  12 2  
Prd_Dt         DATETIME  343   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field2      DATETIME  351   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  359   8   PICTURE "YYYYMMDD"  
ForPrd         ASCII     367  20    
InPrd          ASCII     387  20    
Cha_Field3     ASCII     407  20    
Cha_Field4     ASCII     427  20    
Cha_Field5     ASCII     447  20    
Year           COMPUTED             
 *C 4 1 
 LAST(ALLTRIM(DATE(Prd_Dt)),4)
YM             COMPUTED             
 *C 7 1 
 SUBSTR(ALLTRIM(DATE(Prd_Dt)),4,2)+"/"+LAST(ALLTRIM(DATE(Prd_Dt)),4)
c_Prd_Dt       COMPUTED             
 *C 8 1 
 ALLTRIM(SUBSTR(DATE(Prd_Dt),7,4))+ALLTRIM(SUBSTR(DATE(Prd_Dt),4,2))+ALLTRIM(SUBSTR(DATE(Prd_Dt),1,2))
ABS_PayCode_Amount COMPUTED             
 *N 0 2
 VALUE(SPLIT(ALLTRIM(STRING(ABS(PayCode_Amount),21)),".",1),0) IF OCCURS(ALLTRIM(STRING(ABS(PayCode_Amount),21)),".")>=0
 VALUE(ALLTRIM(STRING(ABS(PayCode_Amount),21 )),0)
PrdSalaryAmt   COMPUTED             
 *N 2 2
 PayCode_Amount IF PayCode='SAL'
 0.00
ActPaidAmt     COMPUTED             
 *N 2 2
 PayCode_Amount IF NOT FIND('Payroll Tax',PayCode_Desc) AND NOT FIND('Superannuation',PayCode_Desc) AND NOT FIND('Loading',PayCode_Desc)
 0.00
PrdGrsAmt      COMPUTED             
 *N 2 2
 PayCode_Amount IF NOT FIND('Payroll Tax',PayCode_Desc) AND NOT FIND('Superannuation',PayCode_Desc) AND NOT FIND('Loading',PayCode_Desc)
 0.00
RUNID_ForPrd   COMPUTED             
 *C 40 1 
 SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ ALLTRIM(ForPrd),1,40)
RUNID_InPrd    COMPUTED             
 *C 40 1 
 SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ ALLTRIM(InPrd),1,40)
Trm_Prd_Days   COMPUTED             
 *N 0 1
 AGE(EMF_TMP_Emp.Trm_Dt,Prd_Dt)
KEY            COMPUTED             
 *C 30 1 
 SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(c_Prd_Dt),1,30)
^LAYOUT   PR009_History                      263 D.T,
Co             ASCII       1  20    
Co_Emp_ID      ASCII      21  20    
Emp_ID         ASCII      41  20    
c_Prd_Dt       ASCII      61   8    
PayCode_Amount ACL        69  12 2  
Pay_Hrs        ACL        81  12 2  
COUNT          ACL        93  12 0 WIDTH 8  
Prd_Dt         DATETIME  105   8   PICTURE "YYYYMMDD" WIDTH 27  
Avg_PayCode_Amount ACL       113  12 2  
Avg_PayCode_Hours ACL       125  12 2  
TIMES          ACL       137  12 0  
KEY            ASCII     149  30    
ID_KEY         ASCII     179  85    
^LAYOUT   PR009D_Pay_2_Times_Avg             1310 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
Emp_ID         ASCII      61  20    
Period_Date    DATETIME   81   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode        ASCII      89   7    
PayCode_Amount ACL        96  12 2  
Pay_Hrs        ACL       108  12 2  
LINE_NO        ASCII     120  20    
LINE_DESC      ASCII     140  60    
LINE_TYPE      ASCII     200  20    
PAY_GROUP      ASCII     220  20    
GL_Account_No  ASCII     240  20    
PERIOD         ASCII     260  20    
Standard_WeeklyHours ACL       280  12 2  
PayCode_Desc   ASCII     292  15    
Num_Field3     ACL       307  12 2  
Num_Field4     ACL       319  12 2  
Num_Field5     ACL       331  12 2  
Prd_Dt         DATETIME  343   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field2      DATETIME  351   8   PICTURE "YYYYMMDD"  
Dt_Field3      DATETIME  359   8   PICTURE "YYYYMMDD"  
ForPrd         ASCII     367  20    
InPrd          ASCII     387  20    
Cha_Field3     ASCII     407  20    
Cha_Field4     ASCII     427  20    
Cha_Field5     ASCII     447  20    
Year           ASCII     467   4    
YM             ASCII     471   7    
c_Prd_Dt       ASCII     478   8    
ABS_PayCode_Amount ACL       486  12 0  
PrdSalaryAmt   ACL       498  12 2  
ActPaidAmt     ACL       510  12 2  
PrdGrsAmt      ACL       522  12 2  
RUNID_ForPrd   ASCII     534  40    
RUNID_InPrd    ASCII     574  40    
Trm_Prd_Days   ACL       614  12 0  
Co_Emp_ID2     ASCII     626  20    
Co2            ASCII     646  20    
COST_CENTRE2   ASCII     666  20    
Emp_ID2        ASCII     686  20    
Period_Date2   DATETIME  706   8   PICTURE "YYYYMMDD" WIDTH 27  
PayCode2       ASCII     714   7    
PayCode_Amount2 ACL       721  12 2  
Pay_Hrs2       ACL       733  12 2  
LINE_NO2       ASCII     745  20    
LINE_DESC2     ASCII     765  60    
LINE_TYPE2     ASCII     825  20    
PAY_GROUP2     ASCII     845  20    
GL_Account_No2 ASCII     865  20    
PERIOD2        ASCII     885  20    
Standard_WeeklyHours2 ACL       905  12 2  
PayCode_Desc2  ASCII     917  15    
Num_Field32    ACL       932  12 2  
Num_Field42    ACL       944  12 2  
Num_Field52    ACL       956  12 2  
Prd_Dt2        DATETIME  968   8   PICTURE "YYYYMMDD" WIDTH 27  
Dt_Field22     DATETIME  976   8   PICTURE "YYYYMMDD"  
Dt_Field32     DATETIME  984   8   PICTURE "YYYYMMDD"  
ForPrd2        ASCII     992  20    
InPrd2         ASCII    1012  20    
Cha_Field32    ASCII    1032  20    
Cha_Field42    ASCII    1052  20    
Cha_Field52    ASCII    1072  20    
Year2          ASCII    1092   4    
YM2            ASCII    1096   7    
c_Prd_Dt2      ASCII    1103   8    
ABS_PayCode_Amount2 ACL      1111  12 0  
PrdSalaryAmt2  ACL      1123  12 2  
ActPaidAmt2    ACL      1135  12 2  
PrdGrsAmt2     ACL      1147  12 2  
RUNID_ForPrd2  ASCII    1159  40    
RUNID_InPrd2   ASCII    1199  40    
Trm_Prd_Days2  ACL      1239  12 0  
KEY2           ASCII    1251  30    
KEY            ASCII    1281  30    
SORT_KEY       COMPUTED             
 *C 30 1 
 SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(c_Prd_Dt),1,30)
SORT_KEY_Desc  COMPUTED             
 *C 18 1 
 "Co_Emp_ID c_Prd_Dt"
Priority       COMPUTED             
 *C 1 1 
 "M"
RptRunDate     COMPUTED             
 *C 12 1 
 DATE(_RptRunDate)
Data_Range_Start_Date COMPUTED             
 *C 12 1 
 DATE(_PR_Data_Start_Date)
Data_Range_End_Date COMPUTED             
 *C 12 1 
 DATE(_PR_Data_End_Date)
TEST_NAME      COMPUTED             
 *C 120 1 
 SUBSTR("PR009D. 2 Ratio Test on Payments to staff where payment is 2 times great than average payment -Details",1,120)
^LAYOUT   PR009_Pay_2_Times_Avg              702 D.T,
Co             ASCII       1  20    
Co_Emp_ID      ASCII      21  20    
Emp_ID         ASCII      41  20    
c_Prd_Dt       ASCII      61   8    
PayCode_Amount ACL        69  12 2  
Pay_Hrs        ACL        81  12 2  
COUNT          ACL        93  12 0 WIDTH 8  
Prd_Dt         DATETIME  105   8   PICTURE "YYYYMMDD" WIDTH 27  
Avg_PayCode_Amount ACL       113  12 2  
Avg_PayCode_Hours ACL       125  12 2  
TIMES          ACL       137  12 0  
KEY            ASCII     149  30    
ID_KEY         ASCII     179  85    
Co2            ASCII     264  20    
Co_Emp_ID2     ASCII     284  20    
Emp_ID2        ASCII     304  20    
c_Prd_Dt2      ASCII     324   8    
PayCode_Amount2 ACL       332  12 2  
Pay_Hrs2       ACL       344  12 2  
COUNT2         ACL       356  12 0 WIDTH 8  
Prd_Dt2        DATETIME  368   8   PICTURE "YYYYMMDD" WIDTH 27  
Avg_PayCode_Amount2 ACL       376  12 2  
Avg_PayCode_Hours2 ACL       388  12 2  
TIMES2         ACL       400  12 0  
KEY2           ASCII     412  30    
ID_KEY2        ASCII     442  85    
SORT_KEY       ASCII     527  29    
SORT_KEY_Desc  ASCII     556  18    
Priority       ASCII     574   1    
RptRunDate     ASCII     575  12    
Data_Range_Start_Date ASCII     587  12    
Data_Range_End_Date ASCII     599  12    
TEST_NAME      ASCII     611  92    
^LAYOUT   EMF_TMP_Emp                        1217 D.T,
!"Payroll_Sum_12m" "IDX_Payroll_Sum_ID" Co_Emp_ID
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        ASCII     985  65    
c_Hire_Dt      ASCII    1050   8    
BSB            ASCII    1058  20    
Bnk_Acc_Num    ASCII    1078  20    
BSB_NAME       ASCII    1098  60    
Bnk_Acc_Name   ASCII    1158  60    
Standard_WeeklyHours COMPUTED             
 *N 0 1
 40
Total_PayAmt   COMPUTED             
 *N 2 1
 Payroll_Sum_12m.ActPaidAmt
Total_Pay_Num  COMPUTED             
 *N 0 1
 Payroll_Sum_12m.COUNT
c_Emp_Nme      COMPUTED             
 *C 65 1 
 ALLTRIM(INCLUDE(UPPER(Emp_Nme),"ABCDEFGHIJKLMNOPQRSTUVWXYZ"))
c_ADD          COMPUTED             
 *C 183 1 
 ALLTRIM(INCLUDE(UPPER(CLEAN(ADD1+ADD2+ADD3)),"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"))
c_Tel1         COMPUTED             
 *C 20 1 
 ALLTRIM(STRING(VALUE(INCLUDE(TEL1, "0123456789"),0),20))
c_Tel2         COMPUTED             
 *C 20 1 
 ALLTRIM(STRING(VALUE(INCLUDE(TEL2, "0123456789"),0),20))
c_Tel3         COMPUTED             
 *C 20 1 
 ALLTRIM(STRING(VALUE(INCLUDE(TEL3, "0123456789"),0),20))
c_Fax          COMPUTED             
 *C 20 1 
 ALLTRIM(STRING(VALUE(INCLUDE(FAX, "0123456789"),0),20))
c_Tax_Fle_Num  COMPUTED             
 *C 20 1 
 ALLTRIM(STRING(VALUE(INCLUDE(Tax_Fle_Num,"0123456789"),0),20))
c_BSB          COMPUTED             
 *C 10 1 
 ALLTRIM(STRING(VALUE(INCLUDE(BSB,"0123456789"),0),10))
c_Bnk_Acc_Num  COMPUTED             
 *C 20 1 
 ALLTRIM(STRING(VALUE(INCLUDE(Bnk_Acc_Num,"0123456789"),0),20))
Ages           COMPUTED             
 *N 0 1
 AGE(DOB,CTOD(DATE(),"DD/MM/YYYY"))/365
Invalid_TFN    COMPUTED             
 *C 1 3 
 "F" IF MOD( (((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 1 , 1 ),0)*1)) + ((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 2 , 1 ),0)*4)) + ((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 3 , 1 ),0)*3)) + ((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 4 , 1 ),0)*7)) + ((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 5 , 1 ),0)*5)) + ((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 6 , 1 ),0)*8)) + ((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 7 , 1 ),0)*6)) + ((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 8 , 1 ),0)*9)) + ((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 9 , 1 ),0)*10))) , 11 ) = 0
 "F" IF c_Tax_Fle_Num = "111111111"
 "T"
EmployAge      COMPUTED             
 *N 0 1
 AGE( DOB,Hire_Dt )
EmployAge2     COMPUTED             
 *N 0 1
 AGE(Hire_Dt,CTOD(DATE(),"DD/MM/YYYY"))
^LAYOUT   Payroll_Sum_12m                    120 D.T,
Co_Emp_ID      ASCII       1  20    
PrdSalaryAmt   ACL        21  12 2  
ActPaidAmt     ACL        33  12 2  
PrdGrsAmt      ACL        45  12 2  
Prd_PayHrs     ACL        57  12 2  
COUNT          ACL        69  12 0 WIDTH 8  
Early_InPrd    ASCII      81  20    
Lst_InPrd      ASCII     101  20    
^LAYOUT   EM009_TFN_Invld_Frmt               2017 D.T,
Co_Emp_ID      ASCII       1  20    
Co             ASCII      21  20    
COST_CENTRE    ASCII      41  20    
EMP_Sts        ASCII      61   1    
Emp_ID         ASCII      62  20    
Tax_Fle_Num    ASCII      82  20    
Tax_Scale      ASCII     102   9    
Title          ASCII     111   5    
Frst_Nme       ASCII     116  20    
Second_Given_Name ASCII     136  20    
Sur_Nme        ASCII     156  20    
ADD1           ASCII     176  61    
ADD2           ASCII     237  61    
ADD3           ASCII     298  61    
City           ASCII     359  35    
State          ASCII     394  29    
Pcode          ASCII     423  11    
Cntry          ASCII     434  61    
TEL1           ASCII     495  21    
TEL2           ASCII     516  21    
TEL3           ASCII     537  21    
Fax            ASCII     558  21    
Email_Bus      ASCII     579  40    
Email_Privt    ASCII     619  36    
DOB            DATETIME  655   8   PICTURE "YYYYMMDD"  
Sex            ASCII     663   3    
Hire_Dt        DATETIME  666   8   PICTURE "YYYYMMDD" WIDTH 27  
Trm_Dt         DATETIME  674   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     682  30    
Mrtl_Sts       ASCII     712  14    
Pref_Nme       ASCII     726  22    
Prev_Sur_Nme   ASCII     748  16    
PAY_CLASS_CODE ASCII     764  14    
PAY_RATE       ACL       778  12 4  
AVG_TRANS_RATE ACL       790  12 2  
YEARLY_SALARY  ACL       802  12 2  
AUTOPAY_HOURS_DAYS ASCII     814  15    
Emp_Catg       ASCII     829  40    
Created_Dt     DATETIME  869   8   PICTURE "YYYYMMDD" WIDTH 27  
Modf_Dt        DATETIME  877   8   PICTURE "YYYYMMDD" WIDTH 27  
Cha_Field1     ASCII     885  20    
Cha_Field2     ASCII     905  20    
Cha_Field3     ASCII     925  20    
Cha_Field4     ASCII     945  20    
Cha_Field5     ASCII     965  20    
Emp_Nme        ASCII     985  65    
c_Hire_Dt      ASCII    1050   8    
BSB            ASCII    1058  20    
Bnk_Acc_Num    ASCII    1078  20    
BSB_NAME       ASCII    1098  60    
Bnk_Acc_Name   ASCII    1158  60    
Standard_WeeklyHours ACL      1218  12 0  
Total_PayAmt   ACL      1230  12 2  
Total_Pay_Num  ACL      1242  12 0  
c_Emp_Nme      ASCII    1254  65    
c_ADD          ASCII    1319 183    
c_Tel1         ASCII    1502  20    
c_Tel2         ASCII    1522  20    
c_Tel3         ASCII    1542  20    
c_Fax          ASCII    1562  20    
c_Tax_Fle_Num  ASCII    1582  20    
c_BSB          ASCII    1602  10    
c_Bnk_Acc_Num  ASCII    1612  20    
Ages           ACL      1632  12 0  
Invalid_TFN    ASCII    1644   1    
EmployAge      ACL      1645  12 0  
EmployAge2     ACL      1657  12 0  
BSB2           ASCII    1669  20    
Bnk_Acc_Num2   ASCII    1689  20    
Total_PayAmt2  ACL      1709  12 2  
Total_Pay_Num2 ACL      1721  12 0  
Invalid_TFN2   ASCII    1733   1    
c_Tax_Fle_Num2 ASCII    1734  20    
ID_KEY         ASCII    1754  85    
SORT_KEY       ASCII    1839  45    
SORT_KEY_Desc  ASCII    1884  42    
Priority       ASCII    1926   1    
RptRunDate     DATETIME 1927   8   PICTURE "YYYYMMDD" WIDTH 27  
TEST_NAME      ASCII    1935  83    
^LAYOUT   EM006_Mis_Details                  2201 D.T,
EM006          ASCII       1   8    
Co_Emp_ID      ASCII       9  20    
Emp_ID         ASCII      29  20    
EM0062         ACL        49  12 0  
COUNT          ACL        61  12 0 WIDTH 8  
Co             ASCII      73  20    
COST_CENTRE    ASCII      93  20    
EMP_Sts        ASCII     113   1    
Tax_Fle_Num    ASCII     114  20    
Tax_Scale      ASCII     134   9    
Title          ASCII     143   5    
Frst_Nme       ASCII     148  20    
Second_Given_Name ASCII     168  20    
Sur_Nme        ASCII     188  20    
ADD1           ASCII     208  61    
ADD2           ASCII     269  61    
ADD3           ASCII     330  61    
City           ASCII     391  35    
State          ASCII     426  29    
Pcode          ASCII     455  11    
Cntry          ASCII     466  61    
TEL1           ASCII     527  21    
TEL2           ASCII     548  21    
TEL3           ASCII     569  21    
Fax            ASCII     590  21    
Email_Bus      ASCII     611  40    
Email_Privt    ASCII     651  36    
DOB            DATETIME  687   8   PICTURE "YYYYMMDD"  
Sex            ASCII     695   3    
Hire_Dt        DATETIME  698   8   PICTURE "YYYYMMDD"  
Trm_Dt         DATETIME  706   8   PICTURE "YYYYMMDD"  
Term_Reason_Desc ASCII     714  30    
Mrtl_Sts       ASCII     744  14    
Pref_Nme       ASCII     758  22    
Prev_Sur_Nme   ASCII     780  16    
PAY_CLASS_CODE ASCII     796  14    
PAY_RATE       ACL       810  12 4  
AVG_TRANS_RATE ACL       822  12 2  
YEARLY_SALARY  ACL       834  12 2  
AUTOPAY_HOURS_DAYS ASCII     846  15    
Emp_Catg       ASCII     861  40    
Created_Dt     DATETIME  901   8   PICTURE "YYYYMMDD"  
Modf_Dt        DATETIME  909   8   PICTURE "YYYYMMDD"  
Cha_Field1     ASCII     917  20    
Cha_Field2     ASCII     937  20    
Cha_Field3     ASCII     957  20    
Cha_Field4     ASCII     977  20    
Cha_Field5     ASCII     997  20    
Emp_Nme        ASCII    1017  65    
c_Hire_Dt      ASCII    1082   8    
BSB            ASCII    1090  20    
Bnk_Acc_Num    ASCII    1110  20    
BSB_NAME       ASCII    1130  60    
Bnk_Acc_Name   ASCII    1190  60    
Total_PayAmt   ACL      1250  12 2  
Total_Pay_Num  ACL      1262  12 0  
c_Tax_Fle_Num  ASCII    1274  21    
Invalid_TFN    ASCII    1295   1    
c_Emp_Nme      ASCII    1296  65    
c_Tel1         ASCII    1361  21    
c_Tel2         ASCII    1382  21    
c_Tel3         ASCII    1403  21    
c_Fax          ASCII    1424  21    
BSB2           ASCII    1445  20    
Bnk_Acc_Num2   ASCII    1465  20    
Total_PayAmt2  ACL      1485  12 2  
Total_Pay_Num2 ACL      1497  12 0  
Invalid_TFN2   ASCII    1509   1    
BSB3           ASCII    1510  20    
Bnk_Acc_Num3   ASCII    1530  20    
Total_PayAmt3  ACL      1550  12 2  
Total_Pay_Num3 ACL      1562  12 0  
Invalid_TFN3   ASCII    1574   1    
c_EM006        ASCII    1575   8    
Test_Name      ASCII    1583 170    
RptRunDate     DATETIME 1753   8   PICTURE "YYYYMMDD" WIDTH 27  
BSB4           ASCII    1761  20    
Bnk_Acc_Num4   ASCII    1781  20    
Total_PayAmt4  ACL      1801  12 2  
Total_Pay_Num4 ACL      1813  12 0  
Test_Name2     ASCII    1825 170    
RptRunDate2    DATETIME 1995   8   PICTURE "YYYYMMDD" WIDTH 27  
Invalid_TFN4   ASCII    2003   1    
ID_KEY         ASCII    2004  85    
SORT_KEY       ASCII    2089  64    
SORT_KEY_Desc  ASCII    2153  48    
Priority       ASCII    2201   1    
^LAYOUT   DM_Payroll_Payments                71 D.T,
Std_Fld_Nme    ASCII       1  14    
Type           ASCII      15   7    
Length         NUMERIC    22   2 0  
Decimals       NUMERIC    24   1 0  
Field_explanation ASCII      25  28    
Src_File       ASCII      53   6    
Src_Fld_Nme    ASCII      59  13    
^LAYOUT   DM_EMF_BnkAcc                      68 D.T,
Std_Fld_Nme    ASCII       1  12    
Type           ASCII      13   5    
Length         NUMERIC    18   2 0  
Decimals       ASCII      20  10    
Field_explanation ASCII      30  19    
Src_File       ASCII      49   8    
Src_Fld_Nme    ASCII      57  12    
^LAYOUT   DM_EMF_Leaves                      77 D.T,
Std_Fld_Nme    ASCII       1  14    
Type           ASCII      15   7    
Length         NUMERIC    22   2 0  
Decimals       NUMERIC    24   1 0  
Field_explanation ASCII      25  24    
Src_File       ASCII      49  16    
Src_Fld_Nme    ASCII      65  13    
^LAYOUT   DM_EMF_Emp_Master_File             99 D.T,
F1             NUMERIC     1   2 0  
Std_Fld_Nme    ASCII       3  18    
Type           ASCII      21   7    
Length         NUMERIC    28   2 0  
Decimals       NUMERIC    30   1 0  
Field_explanation ASCII      31  30    
Src_File       ASCII      61   8    
Src_Fld_Nme    ASCII      69  13    
F9             ASCII      82  18    
^REPORT   Test2_View                         Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
InvoiceNumber        WIDTH 11 PICTURE ""
[LINE] 1
AmountExcl           WIDTH 8 PICTURE ""
[LINE] 1
InvoiceDate          WIDTH 8
[LINE] 1
Vendor_Number        WIDTH 11 PICTURE ""
[LINE] 1
VENDOR_NAME          WIDTH 36 PICTURE ""
[LINE] 1
AmountInc            WIDTH 7 PICTURE ""
[LINE] 1
GSTAmount            WIDTH 8 PICTURE ""
[LINE] 1
PaymentStatus        WIDTH 10 PICTURE ""
[LINE] 1
PO_Number            WIDTH 8 PICTURE ""
[LINE] 1
InvoiceID            PICTURE ""
^REPORT   Test3_view                         Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
VENDOR_ID            WIDTH 9 PICTURE ""
[LINE] 1
BANK_ACCOUNT_NAME    WIDTH 16 PICTURE ""
[LINE] 1
BANK_ACCOUNT_NUM     WIDTH 15 PICTURE ""
[LINE] 1
BANK_BSB             WIDTH 8 PICTURE ""
^REPORT   Test4_View                         Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
VENDOR_NAME          WIDTH 31 PICTURE ""
[LINE] 1
Vendor_ID            WIDTH 7 PICTURE ""
[LINE] 1
Vendor_Number        WIDTH 11 PICTURE ""
[LINE] 1
END_DATE_ACTIVE      WIDTH 13
[LINE] 1
ABN                  WIDTH 9 PICTURE ""
^REPORT   Test5_View                         Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
ABN                  WIDTH 9 PICTURE ""
[LINE] 1
Vendor_ID            WIDTH 7 PICTURE ""
[LINE] 1
VENDOR_NAME          WIDTH 42 PICTURE ""
[LINE] 1
Vendor_Number        WIDTH 11 PICTURE ""
[LINE] 1
END_DATE_ACTIVE      WIDTH 13
^REPORT   Test6_View                         Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Vendor_ID            WIDTH 7 PICTURE ""
[LINE] 1
ADDRESS1             WIDTH 18 PICTURE ""
[LINE] 1
ADDRESS2             WIDTH 8 PICTURE ""
[LINE] 1
ADDRESS3             WIDTH 8 PICTURE ""
[LINE] 1
ADDRESS4             WIDTH 8 PICTURE ""
[LINE] 1
CITY                 WIDTH 12 PICTURE ""
[LINE] 1
STATE                WIDTH 5 PICTURE ""
[LINE] 1
ZIP                  WIDTH 4 PICTURE ""
[LINE] 1
VENDOR_SITE_ID       WIDTH 12 PICTURE ""
^REPORT   Test7_View                         Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
ABN                  WIDTH 8 PICTURE ""
[LINE] 1
Vendor_ID            PICTURE ""
[LINE] 1
VENDOR_NAME          WIDTH 37 PICTURE ""
[LINE] 1
Vendor_Number        PICTURE ""
[LINE] 1
END_DATE_ACTIVE      WIDTH 13
^REPORT   Test8_View                         Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
ABN                  WIDTH 10 PICTURE ""
[LINE] 1
Vendor_ID            PICTURE ""
[LINE] 1
VENDOR_NAME          WIDTH 38 PICTURE ""
[LINE] 1
Vendor_Number        PICTURE ""
[LINE] 1
END_DATE_ACTIVE      WIDTH 15
^REPORT   Test9_View                         Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Vendor_ID            WIDTH 7 PICTURE ""
[LINE] 1
ADDRESS1             WIDTH 8 PICTURE ""
[LINE] 1
ADDRESS2             WIDTH 8 PICTURE ""
[LINE] 1
ADDRESS3             WIDTH 8 PICTURE ""
[LINE] 1
ADDRESS4             WIDTH 8 PICTURE ""
[LINE] 1
VENDOR_NAME          WIDTH 22 PICTURE ""
[LINE] 1
CITY                 WIDTH 12 PICTURE ""
[LINE] 1
STATE                WIDTH 5 PICTURE ""
[LINE] 1
VENDOR_SITE_ID       WIDTH 12 PICTURE ""
[LINE] 1
ZIP                  WIDTH 4 PICTURE ""
^REPORT   Report_Test1                       Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
InvoiceNumber        WIDTH 16 PICTURE ""
[LINE] 1
AmountExcl           WIDTH 8 PICTURE ""
[LINE] 1
InvoiceDate          WIDTH 8
[LINE] 1
Vendor_Number        WIDTH 11 PICTURE ""
[LINE] 1
VENDOR_NAME          WIDTH 9 PICTURE ""
[LINE] 1
AmountInc            WIDTH 7 PICTURE ""
[LINE] 1
GSTAmount            WIDTH 8 PICTURE ""
[LINE] 1
PaymentStatus        WIDTH 10 PICTURE ""
[LINE] 1
PO_Number            WIDTH 8 PICTURE ""
[LINE] 1
InvoiceID            WIDTH 6 PICTURE ""
^REPORT   Report_View                        Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
InvoiceID            WIDTH 6 PICTURE ""
[LINE] 1
Vendor_Number        WIDTH 11 PICTURE ""
[LINE] 1
InvoiceNumber        WIDTH 13 PICTURE ""
[LINE] 1
InvoiceDate          WIDTH 8
[LINE] 1
PaymentStatus        WIDTH 10 PICTURE ""
[LINE] 1
AmountExcl           WIDTH 8 PICTURE ""
[LINE] 1
GSTAmount            WIDTH 8 PICTURE ""
[LINE] 1
AmountInc            WIDTH 7 PICTURE ""
^REPORT   Results_View                       Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Vendor_Number        WIDTH 11 PICTURE ""
[LINE] 1
Vendor_Name          WIDTH 29 PICTURE ""
[LINE] 1
ABN                  WIDTH 9 PICTURE ""
[LINE] 1
Vendor_Status        WIDTH 10 PICTURE ""
[LINE] 1
ACL_Run_Date
[LINE] 1
ACL_Exception        WIDTH 20 PICTURE ""
^REPORT   Results_View2                      Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Vendor_Number        WIDTH 11 PICTURE ""
[LINE] 1
Vendor_Name          WIDTH 35 PICTURE ""
[LINE] 1
ABN                  WIDTH 9 PICTURE ""
[LINE] 1
Vendor_Status        WIDTH 10 PICTURE ""
[LINE] 1
BANK_ACCOUNT_NAME    WIDTH 32 PICTURE ""
[LINE] 1
BANK_ACCOUNT_NUM     WIDTH 15 PICTURE ""
[LINE] 1
VENDOR_ID            PICTURE ""
[LINE] 1
ACL_Run_Date         WIDTH 10
[LINE] 1
ACL_Exception        WIDTH 24 PICTURE ""
[LINE] 1
BANK_BSB             WIDTH 8 PICTURE ""
[LINE] 1
BANK_ACCT_NUM        WIDTH 12 PICTURE ""
^REPORT   TEmpVN01_Same_Bank_Account         TEMPVN01_Same_Bank_Account       KIP] 0 D.T,
[TLINES] 1
[RLINES] 1
[LINE] 1
Vendor_Number        WIDTH 11 PICTURE ""
[LINE] 1
Vendor_Name          WIDTH 24 PICTURE ""
[LINE] 1
ABN                  WIDTH 9 PICTURE ""
[LINE] 1
Vendor_Status        WIDTH 10 PICTURE ""
[LINE] 1
BANK_BSB             WIDTH 8 PICTURE ""
[LINE] 1
BANK_ACCOUNT_NUM     WIDTH 15 PICTURE ""
[LINE] 1
BANK_ACCOUNT_NAME    WIDTH 24 PICTURE ""
[LINE] 1
EmployeeID           WIDTH 8 PICTURE ""
[LINE] 1
EmployeeFirstName    WIDTH 13 PICTURE ""
[LINE] 1
EmployeeLastName     WIDTH 13 PICTURE ""
[LINE] 1
ActiveEmployee       WIDTH 10 PICTURE ""
[LINE] 1
BankBSB              WIDTH 6 PICTURE ""
[LINE] 1
BankAccountNumber    WIDTH 13 PICTURE ""
[LINE] 1
BankAccountName      WIDTH 26 PICTURE ""
[LINE] 1
ACL_Run_Date         WIDTH 10
[LINE] 1
Priority             WIDTH 5 PICTURE ""
[LINE] 1
ACL_Exception        WIDTH 33 PICTURE ""
^FOLDER   Sources                             1340159548
[PARENT_FOLDER_ID] 0
^FOLDER   Scripts                             1340167351
[PARENT_FOLDER_ID] 0
^FOLDER   Main                                1340167442
[PARENT_FOLDER_ID] 1340167351
^FOLDER   Tests                               1340167481
[PARENT_FOLDER_ID] 1340167351
^FOLDER   VMF                                 1340167398
[PARENT_FOLDER_ID] 1340167481
^FOLDER   Payroll                             1340167415
[PARENT_FOLDER_ID] 1340167481
^FOLDER   EMF                                 1340167410
[PARENT_FOLDER_ID] 1340167481
^FOLDER   AP                                  1340167380
[PARENT_FOLDER_ID] 1340167481
^FOLDER   Statistics                          1340633015
[PARENT_FOLDER_ID] 1340167351
^BATCH    PA004_CHK_All_T                    
[PARENT_FOLDER_ID] 1340167415
CHK_PR001=T
CHK_PR002=T
CHK_PR003=T
CHK_PR004=T
CHK_PR005=T
CHK_PR006=T
CHK_PR007=T
CHK_PR008=T
CHK_PR009=T


^REPORT   View_Employee_Master               Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
EmployeeID           WIDTH 8 PICTURE ""
[LINE] 1
First_Name           WIDTH 8 PICTURE ""
[LINE] 1
Last_Name            WIDTH 8 PICTURE ""
[LINE] 1
Emp_Address1         WIDTH 15 PICTURE ""
[LINE] 1
Emp_Address3         PICTURE ""
[LINE] 1
Emp_City             WIDTH 15 PICTURE ""
[LINE] 1
Emp_State            WIDTH 7 PICTURE ""
[LINE] 1
Emp_Postcode         WIDTH 10 PICTURE ""
[LINE] 1
Hire_Date            WIDTH 8
[LINE] 1
Termination_Date
[LINE] 1
TFN                  WIDTH 8 PICTURE ""
[LINE] 1
DOB                  WIDTH 8
^REPORT   Working_View                       Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
PONumber             WIDTH 7 PICTURE ""
[LINE] 1
PODate               WIDTH 8
[LINE] 1
VendorID             WIDTH 6 PICTURE ""
[LINE] 1
VendorName           WIDTH 20 PICTURE ""
[LINE] 1
ExtendedPriceExcl    WIDTH 12 PICTURE ""
[LINE] 1
Creator              WIDTH 7 PICTURE ""
[LINE] 1
Approver             WIDTH 7 PICTURE ""
[LINE] 1
POStatus             WIDTH 6 PICTURE ""
[LINE] 1
Authorisation_Schema.AuthorisationAmount WIDTH 13 PICTURE ""
^REPORT   Results_View3                      Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Vendor_Number        WIDTH 11 PICTURE ""
[LINE] 1
Vendor_Name          WIDTH 35 PICTURE ""
[LINE] 1
ABN                  WIDTH 9 PICTURE ""
[LINE] 1
Vendor_Status        WIDTH 10 PICTURE ""
[LINE] 1
ACL_Run_Date         WIDTH 10
[LINE] 1
Priority             WIDTH 8 PICTURE ""
[LINE] 1
ACL_Exception        WIDTH 24 PICTURE ""
[LINE] 1
BANK_BSB             WIDTH 8 PICTURE ""
[LINE] 1
BANK_ACCOUNT_NUM     WIDTH 15 PICTURE ""
[LINE] 1
BANK_ACCOUNT_NAME    WIDTH 32 PICTURE ""
^REPORT   Results_View4                      Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Vendor_Number        WIDTH 11 PICTURE ""
[LINE] 1
Vendor_Name          WIDTH 29 PICTURE ""
[LINE] 1
ABN                  WIDTH 9 PICTURE ""
[LINE] 1
Vendor_Status        WIDTH 10 PICTURE ""
[LINE] 1
ACL_Run_Date
[LINE] 1
Priority             WIDTH 8 PICTURE ""
[LINE] 1
ACL_Exception        WIDTH 20 PICTURE ""
^REPORT   Results_View5                      Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Vendor_Number        WIDTH 11 PICTURE ""
[LINE] 1
Vendor_Name          WIDTH 29 PICTURE ""
[LINE] 1
ABN                  PICTURE ""
[LINE] 1
Vendor_Status        WIDTH 13 PICTURE ""
[LINE] 1
ACL_Run_Date
[LINE] 1
Priority             WIDTH 8 PICTURE ""
[LINE] 1
ACL_Exception        WIDTH 19 PICTURE ""
^REPORT   Results_View6                      Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Vendor_Number        WIDTH 11 PICTURE ""
[LINE] 1
Vendor_Name          WIDTH 28 PICTURE ""
[LINE] 1
ABN                  WIDTH 9 PICTURE ""
[LINE] 1
Vendor_Status        WIDTH 10 PICTURE ""
[LINE] 1
ACL_Run_Date         WIDTH 10
[LINE] 1
Priority             WIDTH 5 PICTURE ""
[LINE] 1
ACL_Exception        WIDTH 19 PICTURE ""
[LINE] 1
Address1             WIDTH 17 PICTURE ""
[LINE] 1
Address2             WIDTH 18 PICTURE ""
[LINE] 1
Address3             WIDTH 14 PICTURE ""
[LINE] 1
City                 WIDTH 13 PICTURE ""
[LINE] 1
State                WIDTH 4 PICTURE ""
[LINE] 1
Zip                  WIDTH 4 PICTURE ""
^REPORT   Results_View7                      Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Vendor_Number        WIDTH 11 PICTURE ""
[LINE] 1
Vendor_Name          WIDTH 23 PICTURE ""
[LINE] 1
ABN                  PICTURE ""
[LINE] 1
Vendor_Status        WIDTH 10 PICTURE ""
[LINE] 1
ACL_Run_Date
[LINE] 1
Priority             WIDTH 8 PICTURE ""
[LINE] 1
ACL_Exception        PICTURE ""
^REPORT   Results_View8                      Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Vendor_Number        WIDTH 11 PICTURE ""
[LINE] 1
Vendor_Name          WIDTH 31 PICTURE ""
[LINE] 1
ABN                  WIDTH 9 PICTURE ""
[LINE] 1
Vendor_Status        WIDTH 10 PICTURE ""
[LINE] 1
Vendor_ID            WIDTH 7 PICTURE ""
[LINE] 1
ACL_Run_Date         WIDTH 10
[LINE] 1
Priority             WIDTH 5 PICTURE ""
[LINE] 1
ACL_Exception        WIDTH 21 PICTURE ""
[LINE] 1
Address1             WIDTH 6 PICTURE ""
[LINE] 1
Address2             WIDTH 6 PICTURE ""
[LINE] 1
Address3             WIDTH 6 PICTURE ""
[LINE] 1
City                 WIDTH 9 PICTURE ""
[LINE] 1
State                WIDTH 4 PICTURE ""
[LINE] 1
Zip                  WIDTH 4 PICTURE ""
^REPORT   Results_View9                      Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Vendor_Number        WIDTH 11 PICTURE ""
[LINE] 1
Vendor_Name          WIDTH 25 PICTURE ""
[LINE] 1
ABN                  WIDTH 12 PICTURE ""
[LINE] 1
Vendor_Status        WIDTH 13 PICTURE ""
[LINE] 1
ACL_Run_Date
[LINE] 1
Priority             WIDTH 8 PICTURE ""
[LINE] 1
ACL_Exception        PICTURE ""
^REPORT   Results_View10                     Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Vendor_Number        WIDTH 11 PICTURE ""
[LINE] 1
Vendor_Name          WIDTH 27 PICTURE ""
[LINE] 1
ABN                  WIDTH 9 PICTURE ""
[LINE] 1
Vendor_Status        WIDTH 10 PICTURE ""
[LINE] 1
ABN_STATUS           WIDTH 9 PICTURE ""
[LINE] 1
ACL_Run_Date         WIDTH 10
[LINE] 1
Priority             WIDTH 5 PICTURE ""
[LINE] 1
ACL_Exception        WIDTH 25 PICTURE ""
^REPORT   Report_VM02b_View                  Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Vendor_Number        WIDTH 11 PICTURE ""
[LINE] 1
Vendor_Name          WIDTH 24 PICTURE ""
[LINE] 1
ABN                  WIDTH 9 PICTURE ""
[LINE] 1
Vendor_Status        WIDTH 10 PICTURE ""
[LINE] 1
BANK_BSB             WIDTH 8 PICTURE ""
[LINE] 1
BANK_ACCOUNT_NUM     WIDTH 15 PICTURE ""
[LINE] 1
BANK_ACCOUNT_NAME    WIDTH 27 PICTURE ""
[LINE] 1
ACL_Run_Date         WIDTH 10
[LINE] 1
Priority             WIDTH 5 PICTURE ""
[LINE] 1
ACL_Exception        WIDTH 24 PICTURE ""
^REPORT   DupInv_VdInvAmt_View               Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Vendor_ID            WIDTH 7 PICTURE ""
[LINE] 1
Vendor_Name          WIDTH 19 PICTURE ""
[LINE] 1
InvoiceID            WIDTH 8 PICTURE ""
[LINE] 1
InvoiceNumber        WIDTH 10 PICTURE ""
[LINE] 1
InvoiceDate          WIDTH 8
[LINE] 1
AmountExcl           WIDTH 8 PICTURE ""
[LINE] 1
AmountInc            WIDTH 8 PICTURE ""
[LINE] 1
GSTAmount            WIDTH 8 PICTURE ""
[LINE] 1
PaymentStatus        WIDTH 10 PICTURE ""
[LINE] 1
ACL_Run_Date         WIDTH 12
[LINE] 1
Priority             WIDTH 8 PICTURE ""
[LINE] 1
ACL_Exception        WIDTH 47 PICTURE ""
^REPORT   DupInv_VdDateAmt_View              Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Vendor_ID            WIDTH 7 PICTURE ""
[LINE] 1
Vendor_Name          WIDTH 24 PICTURE ""
[LINE] 1
InvoiceID            WIDTH 8 PICTURE ""
[LINE] 1
InvoiceNumber        WIDTH 10 PICTURE ""
[LINE] 1
InvoiceDate          WIDTH 8
[LINE] 1
AmountExcl           WIDTH 8 PICTURE ""
[LINE] 1
AmountInc            WIDTH 8 PICTURE ""
[LINE] 1
GSTAmount            WIDTH 8 PICTURE ""
[LINE] 1
PaymentStatus        WIDTH 10 PICTURE ""
[LINE] 1
ACL_Run_Date         WIDTH 12
[LINE] 1
Priority             WIDTH 8 PICTURE ""
[LINE] 1
ACL_Exception        WIDTH 44 PICTURE ""
^REPORT   DupInv_InvAmtDte_View              Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Vendor_ID            WIDTH 7 PICTURE ""
[LINE] 1
Vendor_Name          WIDTH 19 PICTURE ""
[LINE] 1
InvoiceID            WIDTH 8 PICTURE ""
[LINE] 1
InvoiceNumber        WIDTH 10 PICTURE ""
[LINE] 1
InvoiceDate          WIDTH 8
[LINE] 1
AmountExcl           WIDTH 8 PICTURE ""
[LINE] 1
AmountInc            WIDTH 8 PICTURE ""
[LINE] 1
GSTAmount            WIDTH 8 PICTURE ""
[LINE] 1
PaymentStatus        WIDTH 10 PICTURE ""
[LINE] 1
ACL_Run_Date         WIDTH 12
[LINE] 1
Priority             WIDTH 8 PICTURE ""
[LINE] 1
ACL_Exception        WIDTH 45 PICTURE ""
^REPORT   DupInv_VdInvAmtDte_View            Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Vendor_ID            WIDTH 7 PICTURE ""
[LINE] 1
Vendor_Name          WIDTH 19 PICTURE ""
[LINE] 1
InvoiceID            WIDTH 8 PICTURE ""
[LINE] 1
InvoiceNumber        WIDTH 10 PICTURE ""
[LINE] 1
InvoiceDate          WIDTH 8
[LINE] 1
AmountExcl           WIDTH 8 PICTURE ""
[LINE] 1
AmountInc            WIDTH 8 PICTURE ""
[LINE] 1
GSTAmount            WIDTH 8 PICTURE ""
[LINE] 1
PaymentStatus        WIDTH 10 PICTURE ""
[LINE] 1
ACL_Run_Date         WIDTH 12
[LINE] 1
Priority             WIDTH 8 PICTURE ""
[LINE] 1
ACL_Exception        WIDTH 33 PICTURE ""
^REPORT   EMP05_Emp_Same_Bank_Acc_View       Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
EmployeeID           WIDTH 8 PICTURE ""
[LINE] 1
EmployeeFirstName    WIDTH 13 PICTURE ""
[LINE] 1
EmployeeLastName     WIDTH 13 PICTURE ""
[LINE] 1
Emp_Status           WIDTH 8 PICTURE ""
[LINE] 1
BankAccountName      WIDTH 24 PICTURE ""
[LINE] 1
BankAccountNumber    WIDTH 13 PICTURE ""
[LINE] 1
BankBSB              WIDTH 6 PICTURE ""
[LINE] 1
ACL_Run_Date         WIDTH 10
[LINE] 1
Priority             WIDTH 5 PICTURE ""
[LINE] 1
ACL_Exception        WIDTH 25 PICTURE ""
^REPORT   PO02_Approved_Over_Limit           Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
PONumber             WIDTH 7 PICTURE ""
[LINE] 1
PODate               WIDTH 8
[LINE] 1
VendorID             WIDTH 6 PICTURE ""
[LINE] 1
VendorName           WIDTH 36 PICTURE ""
[LINE] 1
ExtendedPriceExcl    WIDTH 12 PICTURE ""
[LINE] 1
Creator              WIDTH 8 PICTURE ""
[LINE] 1
Approver             WIDTH 8 PICTURE ""
[LINE] 1
POStatus             WIDTH 6 PICTURE ""
[LINE] 1
ACL_Run_Date         WIDTH 10
[LINE] 1
Priority             WIDTH 5 PICTURE ""
[LINE] 1
ACL_Exception        WIDTH 17 PICTURE ""
[LINE] 1
AuthorisationAmount  WIDTH 13 PICTURE ""
^REPORT   PO01_Creator_EQ_Approver           Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
PONumber             WIDTH 7 PICTURE ""
[LINE] 1
PODate               WIDTH 8
[LINE] 1
VendorID             WIDTH 6 PICTURE ""
[LINE] 1
VendorName           WIDTH 28 PICTURE ""
[LINE] 1
ExtendedPriceExcl    WIDTH 12 PICTURE ""
[LINE] 1
Creator              WIDTH 7 PICTURE ""
[LINE] 1
Approver             WIDTH 7 PICTURE ""
[LINE] 1
POStatus             WIDTH 6 PICTURE ""
[LINE] 1
ACL_Run_Date         WIDTH 10
[LINE] 1
Priority             WIDTH 5 PICTURE ""
[LINE] 1
ACL_Exception        WIDTH 27 PICTURE ""
[LINE] 1
AuthorisationAmount  WIDTH 13 PICTURE ""
^REPORT   PO03_Order_After_Invoice           Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
PONumber             WIDTH 7 PICTURE ""
[LINE] 1
PODate               WIDTH 8
[LINE] 1
VendorID             WIDTH 6 PICTURE ""
[LINE] 1
VendorName           WIDTH 32 PICTURE ""
[LINE] 1
ExtendedPriceExcl    WIDTH 12 PICTURE ""
[LINE] 1
Creator              WIDTH 8 PICTURE ""
[LINE] 1
Approver             WIDTH 8 PICTURE ""
[LINE] 1
POStatus             WIDTH 6 PICTURE ""
[LINE] 1
ACL_Run_Date         WIDTH 10
[LINE] 1
Priority             WIDTH 5 PICTURE ""
[LINE] 1
ACL_Exception        WIDTH 16 PICTURE ""
[LINE] 1
InvoiceDate          WIDTH 8
[LINE] 1
InvoiceNumber        WIDTH 10 PICTURE ""
^REPORT   PO04_PO_Splits_Same_Month          Untitled                         D.T,
[SKIP] 0
[TLINES] 2
[RLINES] 1
[LINE] 1
PONumber             WIDTH 7 PICTURE ""
[LINE] 1
PODate               WIDTH 8
[LINE] 1
VendorID             WIDTH 6 PICTURE ""
[LINE] 1
VendorName           WIDTH 23 PICTURE ""
[LINE] 1
ExtendedPriceExcl    WIDTH 12 PICTURE ""
[LINE] 1
Creator              WIDTH 7 PICTURE ""
[LINE] 1
Approver             WIDTH 7 PICTURE ""
[LINE] 1
POStatus             WIDTH 6 PICTURE ""
[LINE] 1
PO_Month_Year        WIDTH 10 PICTURE ""
[LINE] 1
ACL_Run_Date         WIDTH 10
[LINE] 1
Priority             WIDTH 5 PICTURE ""
[LINE] 1
ACL_Exception        WIDTH 19 PICTURE ""
[LINE] 1
COUNT                WIDTH 5 PICTURE ""
[LINE] 1
ExtendedPriceExcl2   WIDTH 13 AS "ExtendedPriceExcl;Total" PICTURE ""
^REPORT   Working_View2                      Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
PONumber             PICTURE ""
[LINE] 1
POBackOrderNo        PICTURE ""
[LINE] 1
PODate
[LINE] 1
VendorID             PICTURE ""
[LINE] 1
Vendor_Master_Data.VendorName PICTURE ""
[LINE] 1
Creator              PICTURE ""
[LINE] 1
Approver             PICTURE ""
[LINE] 1
LineID               PICTURE ""
[LINE] 1
Qty                  PICTURE ""
[LINE] 1
UnitPriceExcl        PICTURE ""
[LINE] 1
ExtendedPriceExcl    PICTURE ""
[LINE] 1
POStatus             PICTURE ""
^FOLDER   Custom_ImportDemo                   1341537122
[PARENT_FOLDER_ID] 1340167351
^BATCH    VA004_CHK_All_T                    
[PARENT_FOLDER_ID] 1340167398
CHK_VM001=T
CHK_VM002=T
CHK_VM003=T
CHK_VM004=T
CHK_VM005=T
CHK_VM006=T
CHK_VM007=T
CHK_VM008=T
CHK_VM009=T
CHK_VM010=T
CHK_VM011=T
CHK_VM012=T
CHK_VM013=T
CHK_VM014=T
CHK_VM015=T
CHK_VM016=T
CHK_VM017=T
^FOLDER   Utilities                           1349217412
[PARENT_FOLDER_ID] 1340167351
^BATCH    ST006_Distr_Top_xx_Vnd             
[PARENT_FOLDER_ID] 1340633015
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Vendor Ranking Report 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************
^BATCH    EZ006_Test_Name                    
[PARENT_FOLDER_ID] 1340167410
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EM006. Identify Employees with missing: Employee No.; Address; Telephone No.; Tax File No.; Hire Date; Bank Account; Cost Centre / Department
COMM *** GET the test description for the TEST_NAME  
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF

OPEN TMP2
V_REPEAT=BLANKS(250) 
V_NEW_EM006_1=BLANKS(30) 


GROUP 
 Counter = 1 

 LOOP WHILE Counter <= 8 
  V_EM006 = SUBSTRING(c_EM006,Counter,1) 
  ASSIGN V_NEW_EM006_1="ComCd/Emp No." IF counter=1 AND V_EM006="1" 
  ASSIGN V_NEW_EM006_1="Address." IF counter=2 AND V_EM006="1" 
  ASSIGN V_NEW_EM006_1="Tel No." IF counter=3 AND V_EM006="1" 
  ASSIGN V_NEW_EM006_1="Tax File No." IF counter=4 AND V_EM006="1" 
  ASSIGN V_NEW_EM006_1="Hire Date." IF counter=5 AND V_EM006="1" 
  ASSIGN V_NEW_EM006_1="Bank Account." IF counter=6 AND V_EM006="1" 
  ASSIGN V_NEW_EM006_1="Basic Pay." IF counter=7 AND V_EM006="1" 
  ASSIGN V_NEW_EM006_1="Cost Centre/Department" IF counter=8 AND V_EM006="1" 
  ASSIGN V_NEW_EM006_1="." IF V_EM006="0" 

  V_REPEAT=ALLTRIM(V_REPEAT)+ALLTRIM(V_NEW_EM006_1) 
  Counter = Counter + 1 
 END 
 
 EXTRACT FIELDS c_EM006 V_REPEAT SUBSTR(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(ALLTRIM(REPLACE(V_REPEAT,".","  ")),"  ","/"),"//","/"),"//","/"),"//","/"),"/"," / "),1,80) AS "NEW_EM006" TO "%fld_Tmps%TMP_TEST" 
 V_REPEAT=BLANKS(250) 
END 

OPEN TMP_TEST
INDEX ON c_EM006 TO TMP_TEST_EMOO2
OPEN TMP2
DEFINE RELATION c_EM006 WITH TMP_TEST INDEX TMP_TEST_EMOO2
^BATCH    SA002_CHK_All_T                    
[PARENT_FOLDER_ID] 1340633015
CHK_ST001=T 
CHK_ST002=T 
CHK_ST003=T 
CHK_ST004=T 
CHK_ST005=T 
CHK_ST006=T 
^BATCH    CB004_Imp_PR_Sub                   
[PARENT_FOLDER_ID] 1341537122
SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

LOCATE RECORD v_counter

v_FileName=ALLTRIM(FILE_NAME)

IMPORT DELIMITED TO TMP1 "%fld_Tmps%TMP1.FIL" FROM "%v_FileName%" 0 SEPARATOR TAB QUALIFIER NONE CONSECUTIVE STARTLINE 1 KEEPTITLE FIELD "ocs_posting_period" C AT 1 DEC 0 WID 18 PIC "" AS "" FIELD "ocs_business_code" C AT 19 DEC 0 WID 17 PIC "" AS "" FIELD "ocs_unit_code" C AT 36 DEC 0 WID 13 PIC "" AS "" FIELD "ocs_service_code" C AT 49 DEC 0 WID 16 PIC "" AS "" FIELD "ocs_cost_centre_code" C AT 65 DEC 0 WID 20 PIC "" AS "" FIELD "ocs_account_code" C AT 85 DEC 0 WID 16 PIC "" AS "" FIELD "record_type" C AT 101 DEC 0 WID 11 PIC "" AS "" FIELD "ledger_name" C AT 112 DEC 0 WID 11 PIC "" AS "" FIELD "posting_period" D AT 123 DEC 0 WID 23 PIC "YYYY-MM-DD" AS "" FIELD "currency_code" C AT 146 DEC 0 WID 13 PIC "" AS "" FIELD "journal_category" C AT 159 DEC 0 WID 18 PIC "" AS "" FIELD "journal_source" C AT 177 DEC 0 WID 14 PIC "" AS "" FIELD "chris_db_instance" C AT 191 DEC 0 WID 17 PIC "" AS "" FIELD "entity_code" C AT 208 DEC 0 WID 11 PIC "" AS "" FIELD "cost_centre_code" C AT 219 DEC 0 WID 16 PIC "" AS "" FIELD "account_code" C AT 235 DEC 0 WID 12 PIC "" AS "" FIELD "activity_code" C AT 247 DEC 0 WID 13 PIC "" AS "" FIELD "master_sk" C AT 260 DEC 0 WID 9 PIC "" AS "" FIELD "original_entity_code" C AT 269 DEC 0 WID 20 PIC "" AS "" FIELD "original_cost_centre_code" C AT 289 DEC 0 WID 25 PIC "" AS "" FIELD "original_account_code" C AT 314 DEC 0 WID 21 PIC "" AS "" FIELD "entered_dr" N AT 335 DEC 2 WID 10 PIC "" AS "" FIELD "entered_cr" N AT 345 DEC 2 WID 10 PIC "" AS "" FIELD "batch_name" C AT 355 DEC 0 WID 19 PIC "" AS "" FIELD "batch_desc" C AT 374 DEC 0 WID 21 PIC "" AS "" FIELD "journal_name" C AT 395 DEC 0 WID 19 PIC "" AS "" FIELD "journal_desc" C AT 414 DEC 0 WID 21 PIC "" AS "" FIELD "legacy_reference" C AT 435 DEC 0 WID 10 PIC "" AS "" FIELD "hours_worked" N AT 445 DEC 2 WID 12 PIC "" AS "" FIELD "original_hours_worked" N AT 457 DEC 2 WID 21 PIC "" AS "" FIELD "accrual_identifier" C AT 478 DEC 0 WID 18 PIC "" AS "" FIELD "accrual_posting_period" C AT 496 DEC 0 WID 22 PIC "" AS "" FIELD "chris_employee_id" C AT 518 DEC 0 WID 17 PIC "" AS "" FIELD "employee_position_id" C AT 535 DEC 0 WID 20 PIC "" AS "" FIELD "allowance_code" C AT 555 DEC 0 WID 14 PIC "" AS "" FIELD "account_string" C AT 569 DEC 0 WID 14 PIC "" AS "" FIELD "cost_group_code" C AT 583 DEC 0 WID 15 PIC "" AS "" FIELD "allowance_code_type" C AT 598 DEC 0 WID 19 PIC "" AS "" FIELD "account_type" N AT 617 DEC 0 WID 12 PIC "" AS "" FIELD "rate_to_pay" N AT 629 DEC 2 WID 11 PIC "" AS "" FIELD "salary_class" C AT 640 DEC 0 WID 12 PIC "" AS "" FIELD "company_code" C AT 652 DEC 0 WID 12 PIC "" AS "" FIELD "pay_run_identifier" C AT 664 DEC 0 WID 18 PIC "" AS "" FIELD "pay_run_date" D AT 682 DEC 0 WID 23 PIC "YYYY-MM-DD" AS "" FIELD "nwahs_site_identifier" C AT 705 DEC 0 WID 21 PIC "" AS "" FIELD "source_system" C AT 726 DEC 0 WID 18 PIC "" AS "" FIELD "extract_date" D AT 744 DEC 0 WID 23 PIC "YYYY-MM-DD" AS "" 

SET FOLDER /%fld_Sources%
OPEN TMP1 
DELETE FIELD RptRunDateTime
DEFINE FIELD RptRunDateTime COMPUTED _RptRunDateTime
DELETE FIELD REC_KEY
DEFINE FIELD REC_KEY COMPUTED SUBSTR(ALLTRIM(ocs_posting_period)+ALLTRIM(ocs_business_code),1,20)

IF v_counter=1 EXTRACT FIELDS ALL SUBSTR("%v_FileName%",1,50) AS 'File_Name' TO %fld_Sources%SAH_Payroll 

SET FOLDER /%fld_Tmps%
IF v_counter>1 OPEN SAH_Payroll
IF v_counter>1 EXTRACT FIELDS ALL TO %fld_Tmps%TMP2 OPEN
IF v_counter>1 INDEX ON REC_KEY TO IDX_TMP2
IF v_counter>1 OPEN TMP1 
IF v_counter>1 DEFINE RELATION REC_KEY WITH TMP2 INDEX IDX_TMP2
IF v_counter>1 EXTRACT FIELDS ALL SUBSTR("%v_FileName%",1,50) AS 'File_Name' IF ISBLANK(TMP2.REC_KEY) TO %fld_Sources%SAH_Payroll Append

OPEN Data_PR_Lst
v_counter=v_counter+1


^BATCH    CB008_Imp_Pay_Sub                  
[PARENT_FOLDER_ID] 1341537122
SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

LOCATE RECORD v_counter

v_FileName=ALLTRIM(FILE_NAME)

COMM *** Source: AP Payment Listing ***
IMPORT DELIMITED TO TMP1 "%fld_Tmps%TMP1.FIL" FROM "%v_FileName%" 0 SEPARATOR TAB QUALIFIER NONE CONSECUTIVE STARTLINE 1 KEEPTITLE FIELD "INVOICE_ID" C AT 1 DEC 0 WID 10 PIC "" AS "" FIELD "INVOICE_PAYMENT_ID" C AT 11 DEC 0 WID 18 PIC "" AS "" FIELD "CHECK_NUMBER" C AT 29 DEC 0 WID 12 PIC "" AS "" FIELD "INVOICING_VENDOR_SITE_ID" C AT 41 DEC 0 WID 24 PIC "" AS "" FIELD "REMIT_TO_SUPPLIER_SITE_ID" C AT 65 DEC 0 WID 25 PIC "" AS "" FIELD "STATUS_LOOKUP_CODE" C AT 90 DEC 0 WID 22 PIC "" AS "" FIELD "AMOUNT" N AT 112 DEC 2 WID 11 PIC "" AS "" FIELD "CHECK_DATE" D AT 123 DEC 0 WID 16 PIC "DD/MM/YYYY" AS "" FIELD "PAYMENT_METHOD_CODE" C AT 139 DEC 0 WID 19 PIC "" AS "" FIELD "BUSINESS" C AT 158 DEC 0 WID 8 PIC "" AS "" 


SET FOLDER /%fld_Sources%
OPEN TMP1 
DELETE FIELD RptRunDateTime
DEFINE FIELD RptRunDateTime COMPUTED _RptRunDateTime
DELETE FIELD REC_KEY
DEFINE FIELD REC_KEY COMPUTED SUBSTR(ALLTRIM(INVOICE_ID)+ALLTRIM(INVOICE_PAYMENT_ID)+ALLTRIM(INVOICING_VENDOR_SITE_ID),1,60)

IF v_counter=1 EXTRACT FIELDS ALL SUBSTR("%v_FileName%",1,50) AS 'File_Name' TO %fld_Sources%AP_PaymentListing 

SET FOLDER /%fld_Tmps%
IF v_counter>1 OPEN AP_PaymentListing
IF v_counter>1 EXTRACT FIELDS ALL TO %fld_Tmps%TMP2 OPEN
IF v_counter>1 INDEX ON REC_KEY TO IDX_TMP2
IF v_counter>1 OPEN TMP1 
IF v_counter>1 DEFINE RELATION REC_KEY WITH TMP2 INDEX IDX_TMP2
IF v_counter>1 EXTRACT FIELDS ALL SUBSTR("%v_FileName%",1,50) AS 'File_Name' IF ISBLANK(TMP2.REC_KEY) TO %fld_Sources%AP_PaymentListing Append


OPEN Data_Pay_Lst
v_counter=v_counter+1


^BATCH    CB009_Imp_PO_Sub                   
[PARENT_FOLDER_ID] 1341537122
SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

LOCATE RECORD v_counter

v_FileName=ALLTRIM(FILE_NAME)

COMM *** Purchase Orders ***
IMPORT DELIMITED TO  TMP1 "%fld_Tmps%TMP1.FIL"  FROM  "%v_FileName%" 0 SEPARATOR TAB QUALIFIER NONE CONSECUTIVE STARTLINE 1 KEEPTITLE FIELD "PO_NUMBER" C AT 1 DEC 0 WID 9 PIC "" AS "" FIELD "VENDOR_NUMBER" C AT 10 DEC 0 WID 13 PIC "" AS "" FIELD "APPROVED_DATE" D AT 23 DEC 0 WID 16 PIC "DD/MM/YYYY" AS "" FIELD "VENDOR_SITE_CODE" C AT 39 DEC 0 WID 16 PIC "" AS "" FIELD "VENDOR_NAME" C AT 55 DEC 0 WID 71 PIC "" AS "" FIELD "ITEM_NUMBER" C AT 126 DEC 0 WID 11 PIC "" AS "" FIELD "LINE_NUM" C AT 137 DEC 0 WID 10 PIC "" AS "" FIELD "ITEM_DESCRIPTION" C AT 147 DEC 0 WID 155 PIC "" AS "" FIELD "QUANTITY_ORDERED" N AT 302 DEC 0 WID 16 PIC "" AS "" FIELD "QUANTITY_BILLED" N AT 318 DEC 0 WID 15 PIC "" AS "" FIELD "QUANTITY_CANCELLED" N AT 333 DEC 0 WID 18 PIC "" AS "" FIELD "AMOUNT_BILLED" N AT 351 DEC 2 WID 43 PIC "" AS "" FIELD "QUANTITY_DELIVERED" N AT 394 DEC 0 WID 18 PIC "" AS "" FIELD "UNIT_PRICE" N AT 412 DEC 2 WID 10 PIC "" AS "" FIELD "CANCEL_FLAG" C AT 422 DEC 1 WID 11 PIC "" AS "" FIELD "CANCEL_DATE" D AT 433 DEC 2 WID 16 PIC "DD/MM/YYYY" AS "" FIELD "ITEM_AMOUNT" N AT 449 DEC 2 WID 11 PIC "" AS "" FIELD "TAX_CODE" C AT 460 DEC 2 WID 9 PIC "" AS "" FIELD "BUSINESS" C AT 469 DEC 0 WID 8 PIC "" AS "" FIELD "LAST_RECEIVED_DATE" D AT 477 DEC 0 WID 18 PIC "DD/MM/YYYY" AS "" FIELD "Field_21" N AT 495 DEC 2 WID 6 PIC "" AS "" FIELD "Field_22" C AT 501 DEC 0 WID 5 PIC "" AS "" FIELD "Field_23" N AT 506 DEC 0 WID 2 PIC "" AS "" FIELD "Field_24" C AT 508 DEC 0 WID 10 PIC "" AS "" FIELD "Field_25" N AT 518 DEC 0 WID 3 PIC "" AS "" FIELD "Field_26" C AT 521 DEC 0 WID 5 PIC "" AS "" FIELD "Field_27" N AT 526 DEC 0 WID 2 PIC "" AS "" 


SET FOLDER /%fld_Sources%
OPEN TMP1 
DELETE FIELD RptRunDateTime
DEFINE FIELD RptRunDateTime COMPUTED _RptRunDateTime
DELETE FIELD REC_KEY
DEFINE FIELD REC_KEY COMPUTED SUBSTR(ALLTRIM(PO_NUMBER)+ALLTRIM(VENDOR_NUMBER)+ALLTRIM(VENDOR_SITE_CODE)+ALLTRIM(LINE_NUM)+ALLTRIM(ITEM_NUMBER),1,90)

IF v_counter=1 EXTRACT FIELDS ALL SUBSTR("%v_FileName%",1,50) AS 'File_Name' TO %fld_Sources%AP_PO_Items 

SET FOLDER /%fld_Tmps%
IF v_counter>1 OPEN AP_PO_Items
IF v_counter>1 EXTRACT FIELDS ALL TO %fld_Tmps%TMP2 OPEN
IF v_counter>1 INDEX ON REC_KEY TO IDX_TMP2
IF v_counter>1 OPEN TMP1 
IF v_counter>1 DEFINE RELATION REC_KEY WITH TMP2 INDEX IDX_TMP2
IF v_counter>1 EXTRACT FIELDS ALL SUBSTR("%v_FileName%",1,50) AS 'File_Name' IF ISBLANK(TMP2.REC_KEY) TO %fld_Sources%AP_PO_Items Append

OPEN Data_PO_Lst
v_counter=v_counter+1


^BATCH    AA004_CHK_All_T                    
[PARENT_FOLDER_ID] 1340167380
CHK_AP000=T
CHK_AP004=T
CHK_AP005=T
CHK_AP006=T
CHK_AP007=T
CHK_AP008=T
CHK_AP009=T
CHK_AP010=T
CHK_AP011=T
CHK_AP012=T
CHK_AP013=T
CHK_AP014=T
CHK_AP015=T
CHK_AP016=T
CHK_AP017=T
CHK_AP018=T
CHK_AP019=T
CHK_AP020=T
CHK_AP021=T
CHK_AP022=T
CHK_AP023=T
CHK_AP024=T
CHK_AP025=T
^REPORT   Default_View2                      Untitled                         D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
TRANS_NBR            WIDTH 9 PICTURE ""
[LINE] 1
ALLOC_TRANS_NBR      WIDTH 15 PICTURE ""
[LINE] 1
TRANS_NBR2           WIDTH 9 AS "TRANS_NBR2" PICTURE ""
^BATCH    AZ004_Dup_FixedUp_Rev              
[PARENT_FOLDER_ID] 1340167380
SET SAFETY OFF

OPEN AP_Dups_Rev
INDEX Vchr_ID TO IDX_AP_Dups_Rev_Vchr_ID

OPEN TMP_AP_DUPS_1
DEFINE RELATION Vchr_ID WITH AP_Dups_Rev INDEX IDX_AP_Dups_Rev_Vchr_ID

EXTRACT FIELDS v_TestNo AS "Dup_No" DUP_KEY Flag %v_flds_AP_Inv% _RptRunDate AS "RptRunDate" IF ISBLANK(Dup_Keys.DUP_KEY) AND ISBLANK(AP_Dups_Rev.Vchr_ID) TO "%fld_Tmps%AP_TMP1" OPEN

IF v_TestNo<>"AP001" EXTRACT FIELDS Dup_No DUP_KEY Flag %v_flds_AP_Inv% _RptRunDate TO "%fld_Tmps%AP_Dups_Rev" APPEND


^BATCH    CB004_Imp_PR                       
[PARENT_FOLDER_ID] 1341537122
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** User can customize data after importing source data
COMM *** Prepare the data for the mapping/conversion  -- Payroll
COMM *** DATE: 10/10/2012
COMM***************************************************************************


IF FTYPE("fld_Sources")="U" OR FTYPE("fld_Data")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "YYYY-MM-DD"
SET FOLDER /%fld_Tmps%

COMM *** List Table Names ***
CLOSE
DIR %fld_Data%Payroll\SAH*.txt TO "%fld_Tmps%TMP4"

OPEN TMP4
SORT ON FILE_CREATE_DATE D FILE_CREATE_TIME D TO "%fld_Tmps%Data_PR_Lst"

SET DATE "DD/MM/YYYY"
OPEN Data_PR_Lst
COUNT
v_counter=1
DO CB004_Imp_PR_Sub WHILE v_counter<=COUNT1

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    CB008_Imp_Pay                      
[PARENT_FOLDER_ID] 1341537122
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** User can customize data after importing source data
COMM *** DATE: 06/10/2012
COMM***************************************************************************


IF FTYPE("fld_Sources")="U" OR FTYPE("fld_Data")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "YYYY-MM-DD"
SET FOLDER /%fld_Tmps%

COMM *** List Table Names ***
CLOSE
DIR %fld_Data%Payments\AP_Pay*.txt TO "%fld_Tmps%TMP4"

OPEN TMP4
SORT ON FILE_CREATE_DATE D FILE_CREATE_TIME D TO "%fld_Tmps%Data_Pay_Lst"

SET DATE "DD/MM/YYYY"
OPEN Data_Pay_Lst
COUNT
v_counter=1
DO CB008_Imp_Pay_Sub WHILE v_counter<=COUNT1

DO AE003_Del_Tmp
SET SAFETY ON
^BATCH    CB009_Imp_PO                       
[PARENT_FOLDER_ID] 1341537122
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** User can customize data after importing source data
COMM *** DATE: 06/10/2012
COMM***************************************************************************


IF FTYPE("fld_Sources")="U" OR FTYPE("fld_Data")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

COMM *** List Table Names ***
CLOSE
DIR %fld_Data%POs\Purcha*.txt TO "%fld_Tmps%TMP4"

OPEN TMP4
SORT ON FILE_CREATE_DATE D FILE_CREATE_TIME D TO "%fld_Tmps%Data_PO_Lst"

SET DATE "DD/MM/YYYY"

OPEN Data_PO_Lst
COUNT
v_counter=1
DO CB009_Imp_PO_Sub WHILE v_counter<=COUNT1

DO AE003_Del_Tmp
SET SAFETY ON
^BATCH    SA001_Menu                         
[PARENT_FOLDER_ID] 1340633015
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Statistical Summary Report Menu
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("_Version")="v" OR FTYPE("_Version")="U" OR FTYPE("fld_Sources")="U" OR FTYPE("fld_DataMapping")="U" DO AA002_Variable_Setting

ASSIGN CHK_ST_ALL=F
ASSIGN CHK_ST001=F 
ASSIGN CHK_ST002=F 
ASSIGN CHK_ST003=F 
ASSIGN CHK_ST004=F 
ASSIGN CHK_ST005=F 
ASSIGN CHK_ST006=F 
IF FTYPE("TXT_ST006_Top") ="U" ASSIGN TXT_ST006_Top=10

exit=F

COMM *** DIALOG ***
IF FILESIZE("Dialogs\Dialog_SA001_Menu.txt") <=0 ESCAPE
DELETE SCRIPT Dialog_SA001_Menu OK
%v_CCMJob% DO "Dialogs\Dialog_SA001_Menu.txt"
DELETE SCRIPT Dialog_SA001_Menu OK

IF exit=T ESCAPE

IF CHK_ST_ALL=T DO SA002_CHK_All_T 

IF CHK_ST001=T DO ST001_Vnd_Tst_Sum
IF CHK_ST002=T DO ST002_Rev_Sum_RevDays
IF CHK_ST003=T DO ST003_Rev_Vnd_Dup
IF CHK_ST004=T DO ST004_Vnd_Ranking
IF CHK_ST005=T DO ST005_Distr_Inv_Mon
IF CHK_ST006=T DO ST006_Distr_Top_xx_Vnd


%v_CCMJob% PAUSE "Statistical Summary Reports have been run successfully."
^BATCH    ST001_Vnd_Tst_Sum                  
[PARENT_FOLDER_ID] 1340633015
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Vendor Tests Summary Report 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("fld_Tmps")="U"  DO AA002_Variable_Setting
IF FILESIZE("%fld_Tmps%AP_Dups_Rev.fil") <= 0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

IF FILESIZE("%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr.fil")>0 OPEN AP001_Dup_Amt_Dt_Inv_Vndr
IF FILESIZE("%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr.fil")>0 SUMMARIZE ON SUBSTR(Vndr_ID,1,20) AS 'Vndr_ID' SUBSTR(Vndr_Nme,1,60) AS 'Vndr_Nme' SUBSTR(TEST_NAME,1,130) AS 'TEST_NAME' TO "%fld_Tmps%TMP_Test_Sum.FIL" PRESORT

IF FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil")>0 OPEN AP002_Dup_Amt_Inv_Vndr
IF FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil")>0 SUMMARIZE ON SUBSTR(Vndr_ID,1,20) AS 'Vndr_ID' SUBSTR(Vndr_Nme,1,60) AS 'Vndr_Nme' SUBSTR(TEST_NAME,1,130) AS 'TEST_NAME' TO "%fld_Tmps%TMP_Test_Sum.FIL" APPEND PRESORT

IF FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil")>0 OPEN AP003_Dup_Amt_Dt_Inv
IF FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil")>0 SUMMARIZE ON SUBSTR(Vndr_ID,1,20) AS 'Vndr_ID' SUBSTR(Vndr_Nme,1,60) AS 'Vndr_Nme' SUBSTR(TEST_NAME,1,130) AS 'TEST_NAME' TO "%fld_Tmps%TMP_Test_Sum.FIL" APPEND PRESORT

IF FILESIZE("%fld_Results%AP004_Dup_Amt_Dt_Vndr.fil")>0 OPEN AP004_Dup_Amt_Dt_Vndr
IF FILESIZE("%fld_Results%AP004_Dup_Amt_Dt_Vndr.fil")>0 SUMMARIZE ON SUBSTR(Vndr_ID,1,20) AS 'Vndr_ID' SUBSTR(Vndr_Nme,1,60) AS 'Vndr_Nme' SUBSTR(TEST_NAME,1,130) AS 'TEST_NAME' IF Inv_Amt>0.00 TO "%fld_Tmps%TMP_Test_Sum.FIL" APPEND PRESORT

IF FILESIZE("%fld_Results%AP016_Mis_ABN.fil")>0 OPEN AP016_Mis_ABN
IF FILESIZE("%fld_Results%AP016_Mis_ABN.fil")>0 SUMMARIZE ON SUBSTR(Vndr_ID,1,20) AS 'Vndr_ID' SUBSTR(Vndr_Nme,1,60) AS 'Vndr_Nme' SUBSTR(TEST_NAME,1,130) AS 'TEST_NAME' IF Inv_Amt>0.00 TO "%fld_Tmps%TMP_Test_Sum.FIL" APPEND PRESORT

IF FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil")>0 OPEN VM002_Dup_Vnd_ABN
IF FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil")>0 SUMMARIZE ON SUBSTR(Vndr_ID,1,20) AS 'Vndr_ID' SUBSTR(Vndr_Nme,1,60) AS 'Vndr_Nme' SUBSTR(TEST_NAME,1,130) AS 'TEST_NAME' IF AP_Vnd_InvGst_Sum.Inv_Amt>0.00 TO "%fld_Tmps%TMP_Test_Sum.FIL" APPEND PRESORT

IF FILESIZE("%fld_Results%VM005_Dup_Vnd_Name.fil")>0 OPEN VM005_Dup_Vnd_Name
IF FILESIZE("%fld_Results%VM005_Dup_Vnd_Name.fil")>0 SUMMARIZE ON SUBSTR(Vndr_ID,1,20) AS 'Vndr_ID' SUBSTR(Vndr_Nme,1,60) AS 'Vndr_Nme' SUBSTR(TEST_NAME,1,130) AS 'TEST_NAME' IF AP_Vnd_InvGst_Sum.Inv_Amt>0.00 TO "%fld_Tmps%TMP_Test_Sum.FIL" APPEND PRESORT

IF FILESIZE("%fld_Results%VM007_Invld_Frmt_ABN.fil")>0 OPEN VM007_Invld_Frmt_ABN
IF FILESIZE("%fld_Results%VM007_Invld_Frmt_ABN.fil")>0 SUMMARIZE ON SUBSTR(Vndr_ID,1,20) AS 'Vndr_ID' SUBSTR(Vndr_Nme,1,60) AS 'Vndr_Nme' SUBSTR(TEST_NAME,1,130) AS 'TEST_NAME' IF Inv_Amt>0.00 TO "%fld_Tmps%TMP_Test_Sum.FIL" APPEND PRESORT

IF FILESIZE("%fld_Results%VM008_Can_ABN.fil")>0 OPEN VM008_Can_ABN
IF FILESIZE("%fld_Results%VM008_Can_ABN.fil")>0 SUMMARIZE ON SUBSTR(Vndr_ID,1,20) AS 'Vndr_ID' SUBSTR(Vndr_Nme,1,60) AS 'Vndr_Nme' SUBSTR(TEST_NAME,1,130) AS 'TEST_NAME' IF Inv_Amt>0.00 TO "%fld_Tmps%TMP_Test_Sum.FIL" APPEND PRESORT

IF FILESIZE("%fld_Results%VM009_Invld_ABN_ABR.fil")>0 OPEN VM009_Invld_ABN_ABR
IF FILESIZE("%fld_Results%VM009_Invld_ABN_ABR.fil")>0 SUMMARIZE ON SUBSTR(Vndr_ID,1,20) AS 'Vndr_ID' SUBSTR(Vndr_Nme,1,60) AS 'Vndr_Nme' SUBSTR(TEST_NAME,1,130) AS 'TEST_NAME' IF Inv_Amt>0.00 TO "%fld_Tmps%TMP_Test_Sum.FIL" APPEND PRESORT

IF FILESIZE("%fld_Results%VM010_DeReg_GST.fil")>0 OPEN VM010_DeReg_GST
IF FILESIZE("%fld_Results%VM010_DeReg_GST.fil")>0 SUMMARIZE ON SUBSTR(Vndr_ID,1,20) AS 'Vndr_ID' SUBSTR(Vndr_Nme,1,60) AS 'Vndr_Nme' SUBSTR(TEST_NAME,1,130) AS 'TEST_NAME' IF Inv_Amt>0.00 TO "%fld_Tmps%TMP_Test_Sum.FIL" APPEND PRESORT

COMM *** Vendor Summary Report ***
OPEN TMP_Test_Sum

SUMMARIZE ON Vndr_ID Vndr_Nme SUBTOTAL COUNT AS 'Ttl_Issues' TO "%fld_Tmps%TMP_SUM.FIL" OPEN PRESORT

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ZONED(Ttl_Issues,5)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Total Issues Found"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "INFO"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%ST001_Vnd_Tst_Sum" OPEN

COMM *** Details ***
OPEN TMP_Test_Sum

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ALLTRIM(Vndr_ID)+ZONED(COUNT,5)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Vndr_ID Total Issues Found in the Test"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "INFO"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%ST001D_Vnd_Tst_Sum" OPEN


DELETE FORMAT TMP_SUM OK
DELETE "%fld_Tmps%TMP_SUM.FIL" OK
DELETE FORMAT TMP_Test_Sum OK
DELETE "%fld_Tmps%TMP_Test_Sum.FIL" OK


SET SAFETY ON
^BATCH    ST002_Rev_Sum_RevDays              
[PARENT_FOLDER_ID] 1340633015
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Summarize the reversal information by days for reference
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("fld_Tmps")="U"  DO AA002_Variable_Setting
IF FILESIZE("%fld_Tmps%AP_Dups_Rev.fil") <= 0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

OPEN AP_Dups_Rev

DELETE FIELD REV_KEY OK
DEFINE FIELD REV_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+ALLTRIM(c_Inv_No)+ALLTRIM(DATE(Inv_Dt))+ALLTRIM(STRING(ABS_INVAMT,21)),1,54)

SORT ON REV_KEY c_Inv_Dt TO "%fld_Tmps%AP_Dups_Dev_1" OPEN

GROUP IF REV_KEY <> RECOFFSET(REV_KEY,-1)
 EXTRACT FIELDS REV_KEY Inv_Amt Inv_Dt Pd_Dt Doc_Typ IF recno()<>1 TO "%fld_Tmps%Rev_TMP1" EOF
ELSE IF REV_KEY <> RECOFFSET(REV_KEY,1)
 EXTRACT FIELDS REV_KEY Inv_Amt Inv_Dt Pd_Dt Doc_Typ IF recno()<>1 TO "%fld_Tmps%Rev_TMP2" EOF
END

OPEN Rev_TMP2 
INDEX ON REV_KEY TO IDX_Rev_TMP2_REV_KEY

OPEN Rev_TMP1
DEFINE RELATION REV_KEY WITH Rev_TMP2 INDEX IDX_Rev_TMP2_REV_KEY

EXTRACT FIELDS REV_KEY Inv_Amt Inv_Dt Pd_Dt Doc_Typ Rev_TMP2.Inv_Amt AS "Inv_Amt1" Rev_TMP2.Inv_Dt AS "Inv_Dt1" Rev_TMP2.Pd_Dt AS "Pd_Dt1" Rev_TMP2.Doc_Typ AS "Doc_Typ1" IF NOT ISBLANK(Rev_TMP2.REV_KEY) TO "%fld_Tmps%Rev_TMP3" open

OPEN Rev_TMP3
DELETE FIELD Rev_Days OK
DEFINE FIELD Rev_Days COMPUTED 

ABS(AGE(Pd_Dt,CTOD(DATE(),"DD/MM/YYYY"))) IF NOT ISBLANK(DATE(Pd_Dt)) AND ISBLANK(DATE(Pd_Dt1))
ABS(AGE(Pd_Dt1,CTOD(DATE(),"DD/MM/YYYY"))) IF ISBLANK(DATE(Pd_Dt)) AND NOT ISBLANK(DATE(Pd_Dt1))
0 IF ISBLANK(DATE(Pd_Dt)) AND ISBLANK(DATE(Pd_Dt1))
ABS(AGE(Pd_Dt,Pd_Dt1))

SET FOLDER /%fld_Results%
STRATIFY ON Rev_Days SUBTOTAL ABS(Inv_Amt) AS "ABS_InvAmt" FREE 0,1,8,31,91,181,366,1000 IF Rev_Days>=0 TO "%fld_Results%ST002_Rev_Sum_RevDays.FIL" OPEN

OPEN ST002_Rev_Sum_RevDays

DELETE FIELDS Rev_Days_1 OK
DEFINE FIELDS Rev_Days_1 COMPUTED 

"0" IF Rev_Days=1
"1-7" IF Rev_Days=8
"8-30" IF Rev_Days=31
"31-90" IF Rev_Days=91
"91-180" IF Rev_Days=181
"181-365" IF Rev_Days=366
"356-1000" IF Rev_Days=1000
"0"

DELETE FORMAT Rev_TMP1 OK
DELETE "%fld_Tmps%Rev_TMP1.FIL" OK
DELETE FORMAT Rev_TMP2 OK
DELETE "%fld_Tmps%Rev_TMP2.FIL" OK
DELETE FORMAT Rev_TMP3 OK
DELETE "%fld_Tmps%Rev_TMP3.FIL" OK

SET SAFETY ON
^BATCH    ST003_Monthly_Sum                  
[PARENT_FOLDER_ID] 1340633015
COMM***************************************************************************
COMM *** Summarize monthly transactions, dups, reversals and issues, by company total and by vendor
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 07/08/2012
COMM***************************************************************************


SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /Working_Tables

OPEN AP_Invoices

DELETE FIELD YM OK
DEFINE FIELD YM COMPUTED LAST(ALLTRIM(DATE(Inv_Dt)),4)+"-"+SUBSTR(ALLTRIM(DATE(Inv_Dt)),4,2)

SUMMARIZE ON YM SUBTOTAL Inv_Amt  TO "TMP_ST.FIL" PRESORT
SUMMARIZE ON YM Vndr_ID Vndr_Name Vndr_Typ Vendor_Master_File.InActive SUBTOTAL Inv_Amt  TO "TMP_ST_Vnd.FIL" PRESORT

OPEN AP_Dups_Rev
EXTRACT FIELDS DUP_KEY Vndr_ID Vndr_Name Vchr_ID Pd_Dt Inv_No Inv_Dt Curncy c_Inv_No c_Inv_Dt Inv_Amt*-1 AS "Inv_Amt" ABS_INVAMT "Rev" AS "Type" IF Inv_Amt < 0.00 AND MATCH(Dup_No,"AP001A","AP001B","AP001C") TO Rev_Dups 
OPEN AP_Dups_01_B
EXTRACT FIELDS DUP_KEY Vndr_ID Vndr_Name Vchr_ID Pd_Dt Inv_No Inv_Dt Curncy c_Inv_No c_Inv_Dt Inv_Amt ABS_INVAMT "Dup" AS "Type" IF Inv_Amt>0.00 TO Rev_Dups APPEND
OPEN AP_Dups_02
EXTRACT FIELDS DUP_KEY Vndr_ID Vndr_Name Vchr_ID Pd_Dt Inv_No Inv_Dt Curncy c_Inv_No c_Inv_Dt Inv_Amt ABS_INVAMT "Dup" AS "Type" IF Inv_Amt>0.00 TO Rev_Dups APPEND
OPEN AP_Dups_04
EXTRACT FIELDS DUP_KEY Vndr_ID Vndr_Name Vchr_ID Pd_Dt Inv_No Inv_Dt Curncy c_Inv_No c_Inv_Dt Inv_Amt ABS_INVAMT "Dup" AS "Type" IF Inv_Amt>0.00 TO Rev_Dups APPEND

OPEN Rev_Dups
DELETE FIELD YM OK
DEFINE FIELD YM COMPUTED LAST(ALLTRIM(DATE(Inv_Dt)),4)+"-"+SUBSTR(ALLTRIM(DATE(Inv_Dt)),4,2)
DELETE FIELD Vndr_ID_YM OK
DEFINE FIELD Vndr_ID_YM COMPUTED ALLTRIM(Vndr_ID)+ALLTRIM(YM)

SUMMARIZE ON YM SUBTOTAL Inv_Amt IF Type="Dup" TO "TMP_ST_Dup.FIL" PRESORT
SUMMARIZE ON YM SUBTOTAL Inv_Amt IF Type="Rev" TO "TMP_ST_Rev.FIL" PRESORT

SUMMARIZE ON Vndr_ID_YM YM Vndr_ID SUBTOTAL Inv_Amt IF Type="Dup" TO "TMP_ST_Vnd_Dup.FIL" PRESORT
SUMMARIZE ON Vndr_ID_YM YM Vndr_ID SUBTOTAL Inv_Amt IF Type="Rev" TO "TMP_ST_Vnd_Rev.FIL" PRESORT

COMM *** create the relationships/links between the monthly summary tables *** 

OPEN TMP_ST_Dup
INDEX ON YM TO IDX_TMP_ST_Dup
OPEN TMP_ST_Rev
INDEX ON YM TO IDX_TMP_ST_Rev
OPEN TMP_ST_Vnd_Rev
INDEX ON Vndr_ID_YM TO IDX_TMP_ST_Vnd_Rev
OPEN TMP_ST_Vnd_Dup
INDEX ON Vndr_ID_YM TO IDX_TMP_ST_Vnd_Dup

OPEN TMP_ST
DEFINE RELATION YM WITH TMP_ST_Dup INDEX IDX_TMP_ST_Dup 
DEFINE RELATION YM WITH TMP_ST_Rev INDEX IDX_TMP_ST_Rev

OPEN TMP_ST_Vnd
DELETE FIELD Vndr_ID_YM OK
DEFINE FIELD Vndr_ID_YM COMPUTED ALLTRIM(Vndr_ID)+ALLTRIM(YM)

DEFINE RELATION Vndr_ID_YM WITH TMP_ST_Vnd_Dup INDEX IDX_TMP_ST_Vnd_Dup  
DEFINE RELATION Vndr_ID_YM WITH TMP_ST_Vnd_Rev INDEX IDX_TMP_ST_Vnd_Rev  

SET FOLDER /Results

COMM *** Finalize the results - by Total***
OPEN TMP_ST
EXTRACT FIELDS YM Inv_Amt AS 'Ttl_InvAmt' COUNT AS 'Ttl_Cnt' TMP_ST_Dup.Inv_Amt AS 'Dup_InvAmt' TMP_ST_Dup.COUNT AS 'Dup_Cnt' TMP_ST_Rev.Inv_Amt AS 'Rev_InvAmt' TMP_ST_Rev.COUNT AS 'Rev_Cnt' TO ST001 OPEN
DELETE FIELD PCT_Dup_Cnt OK
DEFINE FIELD PCT_Dup_Cnt COMPUTED DEC((DEC(Dup_Cnt,4)/DEC(Ttl_Cnt,4)),4)

DELETE FIELD PCT_Dup_Amt OK
DEFINE FIELD PCT_Dup_Amt COMPUTED DEC((Dup_InvAmt/Ttl_InvAmt),4)


COMM *** Finalize the results - by Vendor***
OPEN TMP_ST_Vnd
EXTRACT FIELDS Vndr_ID Vndr_Name Vndr_Typ InActive YM Inv_Amt AS 'Ttl_InvAmt' COUNT AS 'Ttl_Cnt' TMP_ST_Vnd_Dup.Inv_Amt AS 'Dup_InvAmt' TMP_ST_Vnd_Dup.COUNT AS 'Dup_Cnt' TMP_ST_Vnd_Rev.Inv_Amt AS 'Rev_InvAmt' TMP_ST_Vnd_Rev.COUNT AS 'Rev_Cnt' TO ST001_Vnd OPEN

DELETE FIELD PCT_Dup_Cnt OK
DEFINE FIELD PCT_Dup_Cnt COMPUTED DEC((DEC(Dup_Cnt,4)/DEC(Ttl_Cnt,4)),4)

DELETE FIELD PCT_Dup_Amt OK
DEFINE FIELD PCT_Dup_Amt COMPUTED DEC((Dup_InvAmt/Ttl_InvAmt),4)

OPEN ST001
EXPORT FIELDS YM Ttl_InvAmt Ttl_Cnt Dup_InvAmt Dup_Cnt Rev_InvAmt Rev_Cnt PCT_Dup_Amt PCT_Dup_Cnt DELIMITED TO "%fld_Reports%TXT\ST001.DEL" KEEPTITLE  SEPARATOR TAB QUALIFIER NONE
OPEN ST001_Vnd
EXPORT FIELDS Vndr_ID Vndr_Name Vndr_Typ InActive YM Ttl_InvAmt Ttl_Cnt Dup_InvAmt Dup_Cnt Rev_InvAmt Rev_Cnt PCT_Dup_Amt PCT_Dup_Cnt DELIMITED TO "%fld_Reports%TXT\ST001_Vnd" KEEPTITLE SEPARATOR TAB QUALIFIER NONE


DELETE FORMAT TMP_ST OK
DELETE TMP_ST.FIL OK
DELETE FORMAT TMP_ST_Vnd OK
DELETE TMP_ST.FIL OK
DELETE FORMAT TMP_ST_Vnd_Dup OK
DELETE TMP_ST_Vnd_Dup.FIL OK
DELETE FORMAT TMP_ST_Vnd_Rev OK
DELETE TMP_ST_Vnd_Rev.FIL OK
DELETE FORMAT TMP_ST_Dup OK
DELETE TMP_ST_Dup.FIL OK
DELETE FORMAT TMP_ST_Rev OK
DELETE TMP_ST_Rev.FIL OK

SET SAFETY ON
^BATCH    ST003_Rev_Vnd_Dup                  
[PARENT_FOLDER_ID] 1340633015
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Summarize the reversal information for reference: Total Amt and Volumne for the Reversals and Invoices, By Vendor and all
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("fld_Tmps")="U"  DO AA002_Variable_Setting
IF FILESIZE("%fld_Tmps%AP_Dups_Rev.fil") <= 0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

OPEN AP_Dups_Rev
COMM *** do not take AP004 into account***
EXTRACT FIELDS Vndr_Site_ID Vndr_ID Vndr_Nme Vndr_Sts Vndr_Typ Vchr_ID Pd_Dt Inv_No Inv_Dt Curncy c_Inv_No c_Inv_Dt Inv_Amt*-1 AS "Inv_Amt" ABS_INVAMT "Rev" AS "Type" IF Inv_Amt < 0.00 AND MATCH(Dup_No,"AP001","AP002","AP003") TO "%fld_Tmps%Rev_Dups" 
OPEN AP001_Dup_Amt_Dt_Inv_Vndr
EXTRACT FIELDS Vndr_Site_ID Vndr_ID Vndr_Nme Vndr_Sts Vndr_Typ Vchr_ID Pd_Dt Inv_No Inv_Dt Curncy c_Inv_No c_Inv_Dt Inv_Amt ABS_INVAMT "Dup" AS "Type" IF Inv_Amt>0.00 TO "%fld_Tmps%Rev_Dups" APPEND
OPEN AP002_Dup_Amt_Inv_Vndr
EXTRACT FIELDS Vndr_Site_ID Vndr_ID Vndr_Nme Vndr_Sts Vndr_Typ Vchr_ID Pd_Dt Inv_No Inv_Dt Curncy c_Inv_No c_Inv_Dt Inv_Amt ABS_INVAMT "Dup" AS "Type" IF Inv_Amt>0.00 TO "%fld_Tmps%Rev_Dups" APPEND
OPEN AP003_Dup_Amt_Dt_Inv
EXTRACT FIELDS Vndr_Site_ID Vndr_ID Vndr_Nme Vndr_Sts Vndr_Typ Vchr_ID Pd_Dt Inv_No Inv_Dt Curncy c_Inv_No c_Inv_Dt Inv_Amt ABS_INVAMT "Dup" AS "Type" IF Inv_Amt>0.00 TO "%fld_Tmps%Rev_Dups" APPEND
OPEN AP004_Dup_Amt_Dt_Vndr
EXTRACT FIELDS Vndr_Site_ID Vndr_ID Vndr_Nme Vndr_Sts Vndr_Typ Vchr_ID Pd_Dt Inv_No Inv_Dt Curncy c_Inv_No c_Inv_Dt Inv_Amt ABS_INVAMT "Dup" AS "Type" IF Inv_Amt>0.00 TO "%fld_Tmps%Rev_Dups" APPEND

OPEN Rev_Dups
SUMMARIZE ON Vndr_Site_ID Vndr_ID Vndr_Nme Vndr_Sts Vndr_Typ SUBTOTAL Inv_Amt TO "Rev_Sum_Vnd.FIL" PRESORT
SUMMARIZE ON Vndr_Site_ID Vndr_ID Vndr_Nme Vndr_Sts Vndr_Typ SUBTOTAL Inv_Amt IF Type="Rev" TO "%fld_Tmps%Rev_Sum_Vnd_Rev.FIL" PRESORT
SUMMARIZE ON Vndr_Site_ID Vndr_ID Vndr_Nme Vndr_Sts Vndr_Typ SUBTOTAL Inv_Amt IF Type="Dup" TO "%fld_Tmps%Rev_Sum_Vnd_Dup.FIL" PRESORT

OPEN Rev_Sum_Vnd_Rev
INDEX ON Vndr_Site_ID  TO IDX_Rev_Sum_Vnd_Rev
OPEN Rev_Sum_Vnd_Dup
INDEX ON Vndr_Site_ID  TO IDX_Rev_Sum_Vnd_Dup
OPEN Rev_Sum_Vnd
INDEX ON Vndr_Site_ID  TO IDX_Rev_Sum_Vnd

OPEN Rev_Sum_Vnd_Inv
DEFINE RELATION Vndr_Site_ID  WITH Rev_Sum_Vnd INDEX IDX_Rev_Sum_Vnd
DEFINE RELATION Vndr_Site_ID  WITH Rev_Sum_Vnd_Rev INDEX IDX_Rev_Sum_Vnd_Rev 
DEFINE RELATION Vndr_Site_ID  WITH Rev_Sum_Vnd_Dup INDEX IDX_Rev_Sum_Vnd_Dup  
DEFINE RELATION Vndr_Site_ID  WITH VMF_Vnd_Master_File INDEX IDX_VndrSIteID

EXTRACT FIELDS  Vndr_Site_ID Vndr_ID VMF_Vnd_Master_File.Vndr_Nme VMF_Vnd_Master_File.Vndr_Sts VMF_Vnd_Master_File.Vndr_Typ Rev_Sum_Vnd_Inv.Inv_Amt AS "Total_InvAmt" Rev_Sum_Vnd_Inv.COUNT AS "Trns_Num" Rev_Sum_Vnd.Inv_Amt AS "Dup_InvAmt" Rev_Sum_Vnd.COUNT AS "Dup_Num" Rev_Sum_Vnd_Dup.Inv_Amt AS "Cln_Dup_InvAmt" Rev_Sum_Vnd_Dup.COUNT AS "Cln_Dup_Num" Rev_Sum_Vnd_Rev.Inv_Amt AS "Rev_InvAmt" Rev_Sum_Vnd_Rev.COUNT AS "Rev_Num" TO "%fld_Tmps%Rev_TMP" OPEN


DELETE FIELD PCT_Rev_Dup_Num OK
DEFINE FIELD PCT_Rev_Dup_Num COMPUTED DEC((DEC(Rev_Num,4)/DEC(Dup_Num,4)),4)

DELETE FIELD PCT_Cln_Dup_Trns_Num OK
DEFINE FIELD PCT_Cln_Dup_Trns_Num COMPUTED DEC((DEC(Cln_Dup_Num,4)/DEC(Trns_Num,4)),4)

DELETE FIELD PCT_Rev_Dup_Amt OK
DEFINE FIELD PCT_Rev_Dup_Amt COMPUTED DEC((Rev_InvAmt/Dup_InvAmt),2)

DELETE FIELD PCT_Cln_Dup_Trns_Amt OK
DEFINE FIELD PCT_Cln_Dup_Trns_Amt COMPUTED DEC((Cln_Dup_InvAmt/Total_InvAmt),4)

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ZONED(Trns_Num,5)+ZONED(Cln_Dup_InvAmt,15)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Trns_Num"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "INFO"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%ST003_Rev_Vnd_Dup" OPEN

DELETE FORMAT Rev_Sum_Vnd_Rev OK
DELETE "%fld_Tmps%Rev_Sum_Vnd_Rev.FIL" OK
DELETE FORMAT Rev_Sum_Vnd_Dup OK
DELETE "%fld_Tmps%Rev_Sum_Vnd_Dup.FIL" OK
DELETE FORMAT Rev_Sum_Vnd OK
DELETE "%fld_Tmps%Rev_Sum_Vnd.FIL" OK
DELETE FORMAT Rev_TMP OK
DELETE "%fld_Tmps%Rev_TMP.FIL" OK

SET SAFETY OFF
^BATCH    ST004_Vnd_Ranking                  
[PARENT_FOLDER_ID] 1340633015
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Vendor Ranking Report 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("_Version")="v" OR FTYPE("_Version")="U" OR FTYPE("fld_Sources")="U" OR FTYPE("fld_DataMapping")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

IF FILESIZE("%fld_Workings%AP_Invoices.fil")<=0 ESCAPE

OPEN AP_Invoices
CLASSIFY ON Vndr_Site_ID SUBTOTAL Inv_Amt GST_Amt TO "%fld_Tmps%TMP1.FIL" OPEN

DEFINE RELATION Vndr_Site_ID WITH %trg_VMF% INDEX IDX_VndrSiteID

DELETE FIELD Vndr_Nme OK
DEFINE FIELD Vndr_Nme COMPUTED %trg_VMF%.Vndr_Nme

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "ST"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ZONED(Inv_Amt,10)+ZONED(FIELD_PERCENTAGE,10)

SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%ST004_Vnd_Ranking" OPEN

DELETE FORMAT TMP1 OK
DELETE "%fld_Tmps%TMP1.FIL" OK

SET SAFETY ON
^BATCH    ST005_Distr_Inv_Mon                
[PARENT_FOLDER_ID] 1340633015
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Vendor Ranking Report 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("_Version")="v" OR FTYPE("_Version")="U" OR FTYPE("fld_Sources")="U" OR FTYPE("fld_DataMapping")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

IF FILESIZE("%fld_Workings%AP_Invoices.fil")<=0 ESCAPE

OPEN AP_Invoices
DELETE FIELD YM OK
DEFINE FIELD YM COMPUTED LAST(ALLTRIM(DATE(Inv_Dt)),4)+"-"+SUBSTR(ALLTRIM(DATE(Inv_Dt)),4,2)

CLASSIFY ON YM SUBTOTAL Inv_Amt GST_Amt TO "%fld_Tmps%TMP1.FIL" OPEN

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "ST"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ALLTRIM(YM)

SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%ST005_Distr_Inv_Mon" OPEN

DELETE FORMAT TMP1 OK
DELETE "%fld_Tmps%TMP1.FIL" OK

SET SAFETY ON
^BATCH    AE007_Nor_CCM                      
[PARENT_FOLDER_ID] 1349217412
COMM***************************************************************************
COMM *** EVA CCM
COMM *** Check the issue status on CaseWare, remove dups that still open in CCM or closed but no Action taken or greylisted
COMM *** for Normal Test, input variables: v_ID_KEY,v_TEST_NO
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0424 689 470
COMM *** DATE: 22/11/2012
COMM***************************************************************************


SET SAFETY OFF

IF v_ID_KEY="" OR v_TEST_NO="" OR FTYPE("vw_CCM_RPT_Issues_Status")<>"y" ESCAPE

SET FOLDER /%fld_Tmps%
EXTRACT FIELDS ALL TO TMP_Cur OPEN

SET FOLDER /%fld_History%
IF FTYPE("%v_TEST_NO%_History")<>"y" EXTRACT FIELDS ALL TO "%fld_History%%v_TEST_NO%_History" OPEN

SET FOLDER /%fld_Tmps%

COMM ***BPI ACTION CODES: A01- No Action Taken, A03 - Grey List *** 
COMM ***Issue Status: currentStatusID (1:Open,2:Reviewed, 3:Closed) *** 

OPEN vw_CCM_RPT_Issues_Status
EXTRACT FIELDS ALL IF FIND("%v_TEST_NO%",Report_Desc)=T AND (currentStatusID<>3 OR FIND("A03",bpiName) OR FIND("A01",bpiName)) TO TMP_CCM OPEN

INDEX ON %v_ID_KEY% TO IDX_CCM_%v_ID_KEY%

OPEN TMP_Cur
DEFINE RELATION %v_ID_KEY% WITH TMP_CCM INDEX IDX_CCM_%v_ID_KEY%

EXTRACT FIELDS ALL IF %v_ID_KEY%<> TMP_CCM.%v_ID_KEY% TO TMP_Cur1 OPEN 

COMM *** keep the result into ACL history ***
OPEN "%v_TEST_NO%_History"

DEFINE RELATION %v_ID_KEY% WITH TMP_CCM INDEX IDX_CCM_%v_ID_KEY%

EXTRACT FIELDS ALL IF  %v_ID_KEY%=TMP_CCM.%v_ID_KEY% TO TMP_File

OPEN TMP_Cur1

EXTRACT FIELDS ALL TO TMP_File OPEN APPEND

SET FOLDER /%fld_History%
EXTRACT FIELDS ALL TO "%fld_History%%v_TEST_NO%_History"

SET FOLDER /%fld_Tmps%
OPEn TMP_Cur1 

^BATCH    AE008_Imp_CCM                      
[PARENT_FOLDER_ID] 1349217412
COMM***************************************************************************
COMM *** Import Exceptions data from CaseWare Database
COMM *** Daily
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 10/07/2013
COMM***************************************************************************


SET SAFETY OFF
SET FOLDER /%fld_Sources%

COMM
SET ECHO NONE
SET PASSWORD 3 TO "*CSOc$5UH7"
SET ECHO ON

IMPORT ODBC SOURCE "CCM_SQL" TABLE "vw_CCM_RPT_Issues_Status" OWNER "dbo" USERID "svc-ccm-prd-acl" PASSWORD 3 TO "%fld_Sources%TMP11.FIL" WIDTH 200 MAXIMUM 250 FIELDS "ReportName","recordID","ID_KEY","SORT_KEY","Report_Desc","recordDate","currentStatusID","dateLastUpdated","statusId","bpiName","BPI_Desc"

OPEN TMP11

EXTRACT FIELDS ReportName recordID SUBSTR(ALLTRIM(ID_KEY),1,86) AS 'ID_KEY' SORT_KEY Report_Desc recordDate currentStatusID dateLastUpdated statusId bpiName BPI_Desc TO "%fld_Sources%vw_CCM_RPT_Issues_Status" OPEN




^BATCH    VMZ01_Prepare_ABN                  
[PARENT_FOLDER_ID] 1349217412
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Prepare data for ABN test against ASIC 
COMM *** After prepare the ABN list, run ABNLookupConfig.exe (e.g. C:\ABN\ABNLookup\App\)
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 23/05/2012
COMM***************************************************************************


IF FTYPE("_Version")="v" OR FTYPE("fld_Data")="U" DO AA002_Variable_Setting

SET SAFETY OFF

SET DATE "DD/MM/YYYY"

SET FOLDER /%fld_Tmps%

OPEN VMF_Vnd_Master_File

DELETE FIELD ABN_CLN OK 
DEFINE FIELD ABN_CLN COMPUTED SUBSTR(ALLTRIM(INCLUDE(ABN,"0123456789")),1,20)

SUMMARIZE ON ABN_CLN IF NOT ISBLANK(ABN_CLN) TO "%fld_Workings%ABN_Temp.FIL" OPEN PRESORT

EXTRACT FIELDS ABN_CLN  IF LENGTH(ALLTRIM(ABN_CLN))>1  TO "ABN" OPEN

EXPORT FIELDS ABN_CLN TO "%fld_Data%ABN" 

SET SAFETY ON
QUIT
^BATCH    AC004_Exe_Tst                      
[PARENT_FOLDER_ID] 1340167481
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Run Tests Scripts
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 15/01/2013
COMM***************************************************************************


IF FTYPE("v_Script")="U" ESCAPE
IF FILESIZE("Scripts\%v_Script%.txt") <=0 ESCAPE
DELETE SCRIPT "%v_Script%" OK
DO "Scripts\%v_Script%.txt"
DELETE SCRIPT "%v_Script%" OK
^BATCH    AA001_Menu                         
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Accounts Payable Exception Tests
COMM *** Menu 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


Errmsg=""
SET DATE "DD/MM/YYYY"
v_Exc_History=F
IF FTYPE("_Version")="v" OR FTYPE("fld_Workings")="U" DO AA002_Variable_Setting
ASSIGN CHK_TEST_AP=T

%v_CCMJob% IF FTYPE("AP_Invoices")<>"y" OR FILESIZE("%fld_Workings%AP_Invoices.FIL")<=0  PAUSE "AP Invoices table is empty, please make sure you have imported and converted the source file into EVA first."
IF FTYPE("AP_Invoices")<>"y" OR FILESIZE("%fld_Workings%AP_Invoices.FIL")<=0  ESCAPE

COMM *** DIALOG ***
IF FILESIZE("Dialogs\Dialog_AA001_Menu.txt") <=0 ESCAPE
DELETE SCRIPT Dialog_AA001_Menu OK
%v_CCMJob% DO "Dialogs\Dialog_AA001_Menu.txt"
DELETE SCRIPT Dialog_AA001_Menu OK

IF RAD_AP=1 v_Exc_History=F
IF RAD_AP=2 v_Exc_History=T

IF CHK_AP_ALL=T DO AA004_CHK_All_T 

IF CHK_AP000=T DO AP000_Dup_All_123 

IF CHK_AP004=T DO AP004_Dup_Amt_Dt_Vndr

IF CHK_AP005=T DO AP005_3Cons_InvNo

IF CHK_AP006=T DO AP006_Pay_Not_In_VMF

IF CHK_AP007=T DO AP007_Not_Reg_GST

IF CHK_AP008=T DO AP008_Exc_Alw_Limit

IF CHK_AP009=T DO AP009_GST_Over_Char

IF CHK_AP010=T DO AP010_Large_Inv

IF CHK_AP011=T DO AP011_PODt_Aft_InvDt

IF CHK_AP012=T DO AP012_POs_No_Goods

IF CHK_AP013=T DO AP013_PO_Mul_Diff_Vnd

IF CHK_AP014=T DO AP014_No_Trans_xx_Mon

IF CHK_AP015=T DO AP015_Mul_Trans_OneTim_Vnd

IF CHK_AP016=T DO AP016_Mis_Invld_ABN

IF CHK_AP017=T DO AP017_Top_xx_Vnd_xx_Mon

IF CHK_AP018=T DO AP018_Near_Alw_Limit

IF CHK_AP019=T DO AP019_CreditNt_Paid

IF CHK_AP020=T DO AP020_Mul_Paid_Mon

IF CHK_AP021=T DO AP021_Chq_Out_Seq

IF CHK_AP022=T DO AP022_Disc_Mis

IF CHK_AP023=T DO AP023_Disc_Not_Awd

IF CHK_AP024=T DO AP024_Low_Act_Vnd

COMM Jeffrey Alvin 12/04/2013 Modified to capture any error message.
%v_CCMJob% IF NOT ISBLANK(Errmsg) PAUSE "Accounts Payable Exception Tests have been run, but some tests haven't been processed because of missing source data:" + Errmsg
%v_CCMJob% IF ISBLANK(Errmsg) PAUSE "Accounts Payable Exception Tests have been run successfully."

^BATCH    AP022_Disc_Mis                     
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP022. Identify discounts missed based on invoice and payment date and terms
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 25/07/2012
COMM***************************************************************************


IF FTYPE("v_flds_AP_Inv")="U" OR FTYPE("trg_AP_Inv")="U" DO AA002_Variable_Setting
IF FTYPE("TXT_AP018_AllowLimit")="U" DO AC002_Test_Var_Input
IF FTYPE("AP_Invoices")<>"y" OR FILESIZE("%fld_Workings%AP_Invoices.FIL")<0  ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%


SET SAFETY ON
^BATCH    AP023_Disc_Not_Awd                 
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP023.Identify discounts achieved but not awarded based on invoice and payment date and terms
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 25/07/2012
COMM***************************************************************************


IF FTYPE("v_flds_AP_Inv")="U" OR FTYPE("trg_AP_Inv")="U" DO AA002_Variable_Setting
IF FTYPE("TXT_AP018_AllowLimit")="U" DO AC002_Test_Var_Input
IF FTYPE("AP_Invoices")<>"y" OR FILESIZE("%fld_Workings%AP_Invoices.FIL")<0  ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%


SET SAFETY ON
^BATCH    AZ002_Dup_DelTmp                   
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Delete All the TMP files for Dups processing
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF

DELETE FORMAT AP_TMP OK
DELETE "%fld_Tmps%AP_TMP.FIL" OK
DELETE FORMAT AP_TMP1 OK
DELETE "%fld_Tmps%AP_TMP1.FIL" OK
DELETE FORMAT AP_TMP2 OK
DELETE "%fld_Tmps%AP_TMP2.FIL" OK
DELETE FORMAT AP_TMP3 OK
DELETE "%fld_Tmps%AP_TMP3.FIL" OK

DELETE FORMAT TMP_DUP_unPaid OK
DELETE "%fld_Tmps%TMP_DUP_unPaid.FIL" OK
DELETE FORMAT TMP_AP_unPaid OK
DELETE "%fld_Tmps%TMP_AP_unPaid.FIL" OK
DELETE FORMAT TMP_AP_Paid OK
DELETE "%fld_Tmps%TMP_AP_Paid.FIL" OK

DELETE FORMAT TMP_AP_Dup OK
DELETE "%fld_Tmps%TMP_AP_Dup.FIL" OK
DELETE FORMAT TMP_AP_Dup2 OK
DELETE "%fld_Tmps%TMP_AP_Dup2.FIL" OK
DELETE FORMAT TMP_AP_02 OK
DELETE FORMAT TMP_AP_Dup2 OK
DELETE "%fld_Tmps%TMP_AP_02.FIL" OK
DELETE "%fld_Tmps%TMP_AP_Dup2.FIL" OK
DELETE FORMAT TMP_AP_DUPS_2 OK
DELETE "%fld_Tmps%TMP_AP_DUPS_2.FIL" OK
DELETE FORMAT TMP_AP_DUPS_3 OK
DELETE "%fld_Tmps%TMP_AP_DUPS_3.FIL" OK
DELETE FORMAT TMP_AP_DUPS OK
DELETE "%fld_Tmps%TMP_AP_DUPS.FIL" OK


DELETE FORMAT Dup_Pos OK
DELETE "%fld_Tmps%Dup_Pos.FIL" OK
DELETE FORMAT Dup_Neg OK
DELETE "%fld_Tmps%Dup_Neg.FIL" OK
DELETE FORMAT Dup_RevF OK
DELETE "%fld_Tmps%Dup_RevF.FIL" OK
DELETE FORMAT Dup_RevF_Sum OK
DELETE "%fld_Tmps%Dup_RevF_Sum.FIL" OK
DELETE FORMAT TMP_AP_CREDIT OK
DELETE "%fld_Tmps%TMP_AP_CREDIT.FIL" OK
DELETE FORMAT TMP_AP_DUPS OK
DELETE "%fld_Tmps%TMP_AP_DUPS.FIL" OK
DELETE FORMAT TMP_AP_DUPS_1 OK
DELETE "%fld_Tmps%TMP_AP_DUPS_1.FIL" OK
DELETE FORMAT TMP_AP_DUPS_3 OK
DELETE "%fld_Tmps%TMP_AP_DUPS_3.FIL" OK
DELETE FORMAT Dup_Keys OK
DELETE "%fld_Tmps%Dup_Keys.FIL" OK
DELETE FORMAT TMP_AP_DUPS_4 OK
DELETE "%fld_Tmps%TMP_AP_DUPS_4.FIL" OK
DELETE FORMAT TMP_AP_DUPS_5 OK
DELETE "%fld_Tmps%TMP_AP_DUPS_5.FIL" OK
DELETE FORMAT TMP_AP_DUPS_6 OK
DELETE "%fld_Tmps%TMP_AP_DUPS_6.FIL" OK

DELETE FORMAT TMP_AP_CREDIT1 OK
DELETE "%fld_Tmps%TMP_AP_CREDIT1.FIL" OK




^BATCH    AP000_Dup_All_123                  
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** follow the orders below to run the dups 1,2 and 3 ***
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("_Version")="U" OR FTYPE("trg_VMF")="U" DO AA002_Variable_Setting

DO AP000_Dup_Amt_Inv

DO AP001_Dup_Amt_Dt_Inv_Vndr

DO AP002_Dup_Amt_Inv_Vndr

DO AP003_Dup_Amt_Dt_Inv

DO AP001_Dup_Clean_Dup_Aft_23

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp
^BATCH    AP016_Mis_Invld_ABN                
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP016. Identify transactions against vendors with missing or invalid ABN
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/05/2012
COMM***************************************************************************


COMM ***Missing ABN, including Vendor Report and Details Report**
DO VM006_Mis_Details

COMM *** Invalid ABN Format, including Vendor Report and Details Report ***
DO VM007_Invld_Frmt_ABN

COMM *** Invalid ABN Against ABR, including Vendor Report and Details Report ***
DO VM009_Invld_ABN_ABR

COMM *** Cancelled ABN, including Vendor Report and Details Report ***
DO VM008_Can_ABN

COMM*** Combine the Invalid ABN Format, Invalid ABN Against ABR and Cancelled ABN into AP016 & AP016D ***

SET SAFETY OFF
SET FOLDER /%fld_Results%
OPEN VM006_Mis_Details
EXTRACT FIELD ALL IF FIND("ABN",TEST_NAME) TO "%fld_Results%AP016_Mis_ABN" OPEN
DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP016. Identify Vendors with missing ABN"


OPEN VM006D_Mis_Details
EXTRACT FIELD ALL IF FIND("ABN",TEST_NAME) TO "%fld_Results%AP016D_Mis_ABN" OPEN
DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP016D. Identify transactions against vendors with missing ABN"

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON


^BATCH    PA001_Menu                         
[PARENT_FOLDER_ID] 1340167415
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Payroll Exception Tests
COMM *** Menu 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 21/06/2012
COMM***************************************************************************


IF FTYPE("_Version")="v" OR FTYPE("fld_Workings")="U" DO AA002_Variable_Setting

Errmsg=""
SET SAFETY OFF
SET DATE "DD/MM/YYYY"

%v_CCMJob% IF FTYPE("Payroll_Payments")<>"y" OR FILESIZE("%fld_Workings%Payroll_Payments.fil")<=0  PAUSE "Employee Payroll file is empty, please make sure you have imported and converted the source file into EVA first."
IF FTYPE("Payroll_Payments")<>"y" OR FILESIZE("%fld_Workings%Payroll_Payments.fil")<=0 ESCAPE
SET DATE "YYYY-MM-DD"
v_Exc_History=F
ASSIGN CHK_TEST_PR=T

COMM *** DIALOG ***
IF FILESIZE("Dialogs\Dialog_PA001_Menu.txt") <=0 ESCAPE
DELETE SCRIPT Dialog_PA001_Menu OK
%v_CCMJob% DO "Dialogs\Dialog_PA001_Menu.txt"
DELETE SCRIPT Dialog_PA001_Menu OK

IF RAD_PR=1 v_Exc_History=F
IF RAD_PR=2 v_Exc_History=T

IF CHK_PR_ALL=T DO PA004_CHK_All_T

IF CHK_PR001=T DO PR001_Mul_Paid

IF CHK_PR002=T DO PR002_Not_in_Emf

IF CHK_PR003=T DO PR003_Pay_30D_Af_Trm

IF CHK_PR004=T DO PR004_Spec_Leave_3Mon

IF CHK_PR005=T DO PR005_Pay_TrmAmt_Sleeper

IF CHK_PR006=T DO PR006_Unusual_Super

IF CHK_PR007=T DO PR007_Hourly_Emp

IF CHK_PR008=T DO PR008_Top_xx_Over_xx_Mon

IF CHK_PR009=T DO PR009_Pay_x_Times_Avg

COMM Jeffrey Alvin 12/04/2013 Modified to capture any error message.
%v_CCMJob% IF NOT ISBLANK(Errmsg) PAUSE "Payroll Exception Tests have been run, but some tests haven't been processed because of missing source data:" + Errmsg
%v_CCMJob% IF ISBLANK(Errmsg) PAUSE "Payroll Exception Tests have been run successfully."

^BATCH    VA001_Menu                         
[PARENT_FOLDER_ID] 1340167398
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Vendor Master File Exception Tests
COMM *** Menu 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 21/06/2012
COMM***************************************************************************


IF FTYPE("_Version")="v" OR FTYPE("fld_Workings")="U" DO AA002_Variable_Setting

Errmsg=""
SET SAFETY OFF
SET DATE "DD/MM/YYYY"

%v_CCMJob% IF FTYPE("%trg_VMF%")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF%.FIL")<=0  PAUSE "Vendor master file is empty, please make sure you have imported and converted the source file into EVA first."
IF FTYPE("%trg_VMF%")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF%.FIL")<=0  ESCAPE

v_Exc_History=F
ASSIGN CHK_TEST_VMF=T

COMM *** DIALOG ***
IF FILESIZE("Dialogs\Dialog_VA001_Menu.txt") <=0 ESCAPE
DELETE SCRIPT Dialog_VA001_Menu OK
%v_CCMJob% DO "Dialogs\Dialog_VA001_Menu.txt"
DELETE SCRIPT Dialog_VA001_Menu OK

IF RAD_VM=1 v_Exc_History=F
IF RAD_VM=2 v_Exc_History=T

IF CHK_VM_ALL=T DO VA004_CHK_All_T

IF CHK_VM001=T DO VM001_Dup_Vnd_BankAcc

IF CHK_VM002=T DO VM002_Dup_Vnd_ABN

IF CHK_VM003=T DO VM003_Dup_Vnd_Add

IF CHK_VM004=T DO VM004_Dup_Vnd_Tel

IF CHK_VM005=T DO VM005_Dup_Vnd_Name

IF CHK_VM006=T DO VM006_Mis_Details

IF CHK_VM007=T DO VM007_Invld_Frmt_ABN

IF CHK_VM008=T DO VM008_Can_ABN

IF CHK_VM009=T DO VM009_Invld_ABN_ABR

IF CHK_VM010=T DO VM010_DeReg_GST

IF CHK_VM011=T DO VM011_Upd_Mul_xx_Mon

IF CHK_VM012=T DO VM012_Inac_xx_Mon

IF CHK_VM013=T DO VM013_OneTim_Vnd_Spend

IF CHK_VM014=T DO VM014_VndEmp_BankAcc

IF CHK_VM015=T DO VM015_VndEmp_Add

IF CHK_VM016=T DO VM016_VndEmp_Tel

IF CHK_VM017=T DO VM017_Dup_Vnd_Email

COMM Jeffrey Alvin 12/04/2013 Modified to capture any error message.
%v_CCMJob% IF NOT ISBLANK(Errmsg) PAUSE "Vendor Master Exception Tests have been run, but some tests haven't been processed because of missing source data:" + Errmsg
%v_CCMJob% IF ISBLANK(Errmsg) PAUSE "Vendor Master File Exception Tests have been run successfully."
^BATCH    AC002_Test_Var_Input               
[PARENT_FOLDER_ID] 1340167481
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Default User Inputs for the Tests
COMM *** Menu 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 21/06/2012
COMM***************************************************************************


IF FTYPE("_RptRunDate")="v" DO AA002_Variable_Setting

exit=F

COMM *** Main Menu ***
ASSIGN CHK_TEST_VMF=F
ASSIGN CHK_TEST_AP=F
ASSIGN CHK_TEST_EMF=F
ASSIGN CHK_TEST_PR=F


COMM *** Accounts Payable ***
RAD_AP=1
ASSIGN CHK_AP_ALL=F
ASSIGN CHK_AP000=F
ASSIGN CHK_AP004=F
ASSIGN CHK_AP005=F
ASSIGN CHK_AP006=F
ASSIGN CHK_AP007=F
ASSIGN CHK_AP008=F
ASSIGN CHK_AP009=F
ASSIGN CHK_AP010=F
ASSIGN CHK_AP011=F
ASSIGN CHK_AP012=F
ASSIGN CHK_AP013=F
ASSIGN CHK_AP014=F
ASSIGN CHK_AP015=F
ASSIGN CHK_AP016=F
ASSIGN CHK_AP017=F
ASSIGN CHK_AP018=F
ASSIGN CHK_AP019=F
ASSIGN CHK_AP020=F
ASSIGN CHK_AP021=F
ASSIGN CHK_AP022=F
ASSIGN CHK_AP023=F
ASSIGN CHK_AP024=F

ASSIGN TXT_AP008_AllowLimit ="250000" 
ASSIGN TXT_AP010_Pct="75"
ASSIGN TXT_AP010_Cnt="5"
ASSIGN TXT_AP014_Months="12"
ASSIGN TXT_AP017_Top="50" 
ASSIGN TXT_AP017_Months="24"
ASSIGN TXT_AP018_AllowLimit ="10000;25000;50000;100000;250000" 
ASSIGN TXT_AP018_AllowLimit_Pct="5"
ASSIGN v_AP005_Consec=3
ASSIGN TXT_AP024_Trans_Num=2
ASSIGN TXT_AP024_Mon=""
ASSIGN TXT_AP024_Created_Mon="3"

COMM *** Vendor Master File ***
RAD_VM=1
ASSIGN CHK_VM_ALL=F
ASSIGN CHK_VM001=F
ASSIGN CHK_VM002=F
ASSIGN CHK_VM003=F
ASSIGN CHK_VM004=F
ASSIGN CHK_VM005=F
ASSIGN CHK_VM006=F
ASSIGN CHK_VM007=F
ASSIGN CHK_VM008=F
ASSIGN CHK_VM009=F
ASSIGN CHK_VM010=F
ASSIGN CHK_VM011=F
ASSIGN CHK_VM012=F
ASSIGN CHK_VM013=F
ASSIGN CHK_VM014=F
ASSIGN CHK_VM015=F
ASSIGN CHK_VM016=F
ASSIGN CHK_VM017=F

ASSIGN TXT_VM011_Mon="3"
ASSIGN TXT_VM012_Mon="3"

COMM *** Employee Master File ***
RAD_EM=1
ASSIGN CHK_EM_ALL=F
ASSIGN CHK_EM001=F
ASSIGN CHK_EM002=F
ASSIGN CHK_EM003=F
ASSIGN CHK_EM004=F
ASSIGN CHK_EM005=F
ASSIGN CHK_EM006=F
ASSIGN CHK_EM007=F
ASSIGN CHK_EM008=F
ASSIGN CHK_EM009=F
ASSIGN CHK_EM010=F
ASSIGN CHK_EM011=F
ASSIGN CHK_EM012=F
ASSIGN CHK_EM013=F
ASSIGN CHK_EM014=F
ASSIGN CHK_EM015=F

ASSIGN TXT_EM011_Months="3"
ASSIGN TXT_EM011_Chg_Times="2"

COMM *** Payroll ***
RAD_PR=1
ASSIGN CHK_PR_ALL=F
ASSIGN CHK_PR001=F
ASSIGN CHK_PR002=F
ASSIGN CHK_PR003=F
ASSIGN CHK_PR004=F
ASSIGN CHK_PR005=F
ASSIGN CHK_PR006=F
ASSIGN CHK_PR007=F
ASSIGN CHK_PR008=F
ASSIGN CHK_PR009=F

ASSIGN TXT_PR003_Days="30"
ASSIGN TXT_PR004_Months="3"
ASSIGN TXT_PR008_Top="50"
ASSIGN TXT_PR008_Months="3"
ASSIGN TXT_PR009_Times="2"

^BATCH    AE006_Dup_CCM                      
[PARENT_FOLDER_ID] 1349217412
COMM***************************************************************************
COMM *** EVA CCM
COMM *** Check the issue status on CaseWare, remove dups that still open in CCM or closed but no Action taken or greylisted
COMM *** for Dup test, input variables: v_ID_KEY,v_TEST_NO,v_DUP_KEY
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0424 689 470
COMM *** DATE: 22/11/2012
COMM***************************************************************************


SET SAFETY OFF

IF v_ID_KEY="" OR v_TEST_NO="" ESCAPE

IF FTYPE("vw_CCM_RPT_Issues_Status")<>"y" ESCAPE

SET FOLDER /%fld_Tmps%
EXTRACT FIELDS ALL TO TMP_Cur OPEN

SET FOLDER /%fld_History%
IF FTYPE("%v_TEST_NO%_History")<>"y" EXTRACT FIELDS ALL TO "%fld_History%%v_TEST_NO%_History" OPEN

SET FOLDER /%fld_Tmps%

COMM *** BPI ACTION CODES: A01- No Action Taken, A03 - Grey List *** 
COMM *** Issue Status: currentStatusID (1:Open,2:Reviewed, 3:Closed) *** 

OPEN vw_CCM_RPT_Issues_Status
EXTRACT FIELDS ALL IF FIND("%v_TEST_NO%",Report_Desc)=T AND (currentStatusID<>3 OR FIND("A03",bpiName) OR FIND("A01",bpiName)) TO TMP_CCM OPEN

INDEX ON %v_ID_KEY% TO IDX_CCM_%v_ID_KEY%

OPEN TMP_Cur
DEFINE RELATION %v_ID_KEY% WITH TMP_CCM INDEX IDX_CCM_%v_ID_KEY%
SUMMARIZE ON %v_DUP_KEY% IF %v_ID_KEY%<>TMP_CCM.%v_ID_KEY% %v_Filter%  TO "TMP_His.FIL" OPEN PRESORT


INDEX ON %v_DUP_KEY% TO IDX_TMP_His_DUP_KEY

OPEN TMP_Cur

DEFINE RELATION %v_DUP_KEY% WITH TMP_His INDEX IDX_TMP_His_DUP_KEY

EXTRACT FIELDS ALL IF %v_DUP_KEY%= TMP_His.%v_DUP_KEY% TO TMP_Cur1 OPEN 

COMM *** keep the result into ACL history ***
OPEN "%v_TEST_NO%_History"
DEFINE RELATION %v_ID_KEY% WITH TMP_CCM INDEX IDX_CCM_%v_ID_KEY%

EXTRACT FIELDS ALL IF  %v_ID_KEY%=TMP_CCM.%v_ID_KEY% TO TMP_File

OPEN TMP_Cur1
EXTRACT FIELDS ALL TO TMP_File OPEN APPEND 

SET FOLDER /%fld_History%
EXTRACT FIELDS ALL TO "%fld_History%%v_TEST_NO%_History"

SET FOLDER /%fld_Tmps%
OPEn TMP_Cur1 

^BATCH    VZ006_Test_Name                    
[PARENT_FOLDER_ID] 1349217412
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** VM006. Identify Vendors with missing or incomplete: Address, Telephone or ABN 
COMM *** GET the test description for the TEST_NAME  
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF

OPEN TMP_TstCd


DEFINE FIELD NEW_TstCd_1 COMPUTED
NEW_TstCd_1
"Bank Account /*" IF SUBSTRING(c_TstCd,1,1)="1"
""

DEFINE FIELD NEW_TstCd_2 COMPUTED
NEW_TstCd_2
"ABN /*" IF SUBSTRING(c_TstCd,2,1)="1"
""

DEFINE FIELD NEW_TstCd_3 COMPUTED
NEW_TstCd_3
"Address /*" IF SUBSTRING(c_TstCd,3,1)="1"
""

DEFINE FIELD NEW_TstCd_4 COMPUTED
NEW_TstCd_4
"Tel No" IF SUBSTRING(c_TstCd,4,1)="1"
""

DEFINE FIELD NEW_TstCd1 COMPUTED SUB(ALL(NEW_TstCd_1)+ALL(NEW_TstCd_2)+ALL(NEW_TstCd_3)+ALL(NEW_TstCd_4),1,100)

DEFINE FIELD NEW_TstCd2 COMPUTED REPLACE(NEW_TstCd1, "*", " ")

DEFINE FIELD NEW_TstCd COMPUTED 
NEW_TstCd
SUB(ALL(NEW_TstCd2),1,LENGTH(ALL(NEW_TstCd2))-1 ) IF SUB(ALL(NEW_TstCd2),LENGTH(ALL(NEW_TstCd2)),1) = "/"
ALL(NEW_TstCd2)

EXTRACT FIELDS c_TstCd NEW_TstCd TO "%fld_Tmps%TMP_TEST" 

OPEN TMP_TEST
INDEX ON c_TstCd TO IDX_TMP_TEST

ESCAPE

COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** VM006. Identify Vendors with missing or incomplete: Bank, Address, Telephone or ABN 
COMM *** GET the test description for the TEST_NAME  
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF

V_REPEAT=BLANKS(100) 
V_NEW_VM006_1 =BLANKS(20) 


GROUP 
 Counter = 1 

 LOOP WHILE Counter <= 4 
  V_VM006 = SUBSTRING(c_TstCd ,Counter,1) 
  ASSIGN V_NEW_VM006_1="Bank Account." IF counter=1 AND V_VM006="1" 
  ASSIGN V_NEW_VM006_1="ABN." IF counter=2 AND V_VM006="1" 
  ASSIGN V_NEW_VM006_1="Address." IF counter=3 AND V_VM006="1" 
  ASSIGN V_NEW_VM006_1="Tel No." IF counter=4 AND V_VM006="1" 
  ASSIGN V_NEW_VM006_1="." IF V_VM006="0" 

  V_REPEAT=ALLTRIM(V_REPEAT)+ALLTRIM(V_NEW_VM006_1) 
  Counter = Counter + 1 
 END 
 
 EXTRACT FIELDS c_TstCd V_REPEAT SUBSTR(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(ALLTRIM(REPLACE(V_REPEAT,".","  ")),"  ","/"),"//","/"),"//","/"),"//","/"),"/"," / "),1,100) AS "NEW_TstCd" TO "%fld_Tmps%TMP_TEST" 
 V_REPEAT=BLANKS(100) 
END 

OPEN TMP_TEST
INDEX ON c_TstCd TO IDX_TMP_TEST
^BATCH    AZ001_Dup_DeDup                    
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** DeDup: compare to AP001_TMP, identify DIFF date
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


OPEN AP001_TMP
EXTRACT FIELDS Vchr_ID TO "%fld_Tmps%TMP_AP_Dups_4"
OPEN AP_Dups_Rev
EXTRACT FIELDS Vchr_ID TO "%fld_Tmps%TMP_AP_Dups_4" APPEND
OPEN TMP_AP_Dups_4
INDEX ON Vchr_ID TO IDX_TMP_AP_Dups4_ID

OPEN TMP_AP_DUPS_2
DEFINE RELATION Vchr_ID WITH TMP_AP_Dups_4 INDEX IDX_TMP_AP_Dups4_ID

SUMMARIZE ON DUP_KEY IF Vchr_ID<> TMP_AP_Dups_4.Vchr_ID TO "%fld_Tmps%TMP_AP_Dup2.FIL" OPEN PRESORT
INDEX ON DUP_KEY TO IDX_TMP_AP_Dup2_DUP_KEY

OPEN TMP_AP_DUPS_2
DEFINE RELATION DUP_KEY WITH TMP_AP_Dup2 INDEX IDX_TMP_AP_Dup2_DUP_KEY

EXTRACT RECORD IF DUP_KEY= TMP_AP_Dup2.DUP_KEY TO "%fld_Tmps%TMP_AP_02" OPEN 

SUMMARIZE ON DUP_KEY SUBTOTAL Inv_Amt TO "%fld_Tmps%TMP_DUP_SUM.FIL" OPEN PRESORT 
INDEX ON DUP_KEY TO IDX_TMP_DUP_SUM_DUP_KEY

OPEN TMP_AP_02
DEFINE RELATION DUP_KEY WITH TMP_DUP_SUM INDEX IDX_TMP_DUP_SUM_DUP_KEY

DELETE FIELD RANK OK
DEFINE FIELD RANK COMPUTED

"2" IF TMP_DUP_SUM.Inv_Amt>0
"1" IF TMP_DUP_SUM.Inv_Amt<0
"0" 

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(RANK)+ZONED(ABS_INVAMT,21)+ALLTRIM(DUP_KEY)+ALLTRIM(Flag) +ALLTRIM(c_Inv_Dt),1,80)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "DupAmt_Rank ABS_InvAmt Flag DUP_KEY Inv_Date D"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "H"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

^FOLDER   CCM_AX                              1426733072
[PARENT_FOLDER_ID] 1340167351
^FOLDER   CCM_CWM                             1426733080
[PARENT_FOLDER_ID] 1340167351
^BATCH    AE003_Del_Tmp                      
[PARENT_FOLDER_ID] 1349217412
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Delete All the TMP files for Dups processing
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0424 689 470
COMM *** DATE: 22/06/2012
COMM***************************************************************************

SET SAFETY OFF

DELETE FORMAT TMP_Cur OK
DELETE "%fld_Tmps%TMP_Cur.FIL" OK
DELETE FORMAT TMP_Cur1 OK
DELETE "%fld_Tmps%TMP_Cur1.FIL" OK
DELETE FORMAT TMP_His OK
DELETE "%fld_Tmps%TMP_His.FIL" OK

DELETE FORMAT TMP_Credit OK
DELETE "%fld_Tmps%TMP_Credit.FIL" OK
DELETE FORMAT TMP_Pay OK
DELETE "%fld_Tmps%TMP_Pay.FIL" OK
DELETE FORMAT TMP_Credit_Pay OK
DELETE "%fld_Tmps%TMP_Credit_Pay.FIL" OK

DELETE FORMAT TMP1_Large OK
DELETE "%fld_Tmps%TMP1_Large.FIL" OK
DELETE FORMAT TMP1_Second OK
DELETE "%fld_Tmps%TMP1_Second.FIL" OK
DELETE FORMAT TMP1_Small OK
DELETE "%fld_Tmps%TMP1_Small.FIL" OK

DELETE FORMAT TMP1 OK
DELETE "%fld_Tmps%TMP1.FIL" OK
DELETE FORMAT TMP11 OK
DELETE "%fld_Tmps%TMP11.FIL" OK
DELETE FORMAT TMP2 OK
DELETE "%fld_Tmps%TMP2.FIL" OK
DELETE FORMAT TMP22 OK
DELETE "%fld_Tmps%TMP22.FIL" OK
DELETE FORMAT TMP3 OK
DELETE "%fld_Tmps%TMP3.FIL" OK
DELETE FORMAT TMP4 OK
DELETE "%fld_Tmps%TMP4.FIL" OK
DELETE FORMAT TMP5 OK
DELETE "%fld_Tmps%TMP5.FIL" OK
DELETE FORMAT TMP5_1 OK
DELETE "%fld_Tmps%TMP5_1.FIL" OK
DELETE FORMAT TMP5_2 OK
DELETE "%fld_Tmps%TMP5_2.FIL" OK
DELETE FORMAT TMP6 OK
DELETE "%fld_Tmps%TMP6.FIL" OK
DELETE FORMAT TMP_MSF232 OK
DELETE "%fld_Tmps%TMP_MSF232.FIL" OK
DELETE FORMAT TMP_NEW OK
DELETE "%fld_Tmps%TMP_NEW.FIL" OK
DELETE FORMAT TMP_OLD OK
DELETE "%fld_Tmps%TMP_OLD.FIL" OK

DELETE FORMAT TMP_Address OK
DELETE "%fld_Tmps%TMP_Address.FIL" OK
DELETE FORMAT TMP_TEL OK
DELETE "%fld_Tmps%TMP_TEL.FIL" OK
DELETE FORMAT TMP_BnkAcc OK
DELETE "%fld_Tmps%TMP_BnkAcc.FIL" OK

DELETE FORMAT TMP_Vnd_Dup OK
DELETE "%fld_Tmps%TMP_Vnd_Dup.FIL" OK
DELETE FORMAT TMP_Vnd_Dup_2 OK
DELETE "%fld_Tmps%TMP_Vnd_Dup_2.FIL" OK
DELETE FORMAT TMP_Vnd_Dup_3 OK
DELETE "%fld_Tmps%TMP_Vnd_Dup_3.FIL" OK
DELETE FORMAT TMP_Vnd_Dup_4 OK
DELETE "%fld_Tmps%TMP_Vnd_Dup_4.FIL" OK
DELETE FORMAT TMP_Vnd_Dups OK
DELETE "%fld_Tmps%TMP_Vnd_Dups.FIL" OK
DELETE FORMAT TMP_Vnd_Dup_41 OK
DELETE "%fld_Tmps%TMP_Vnd_Dup_41.FIL" OK
DELETE FORMAT TMP_Vnd_Dup_42 OK
DELETE "%fld_Tmps%TMP_Vnd_Dup_42.FIL" OK
DELETE FORMAT TMP_Vnd_Dup_5 OK
DELETE "%fld_Tmps%TMP_Vnd_Dup_5.FIL" OK
DELETE FORMAT TMP_Vnd_Dup_6 OK
DELETE "%fld_Tmps%TMP_Vnd_Dup_6.FIL" OK

DELETE FORMAT AP_TMP OK
DELETE "%fld_Tmps%AP_TMP.FIL" OK
DELETE FORMAT AP_TMP1 OK
DELETE "%fld_Tmps%AP_TMP1.FIL" OK
DELETE FORMAT AP_TMP2 OK
DELETE "%fld_Tmps%AP_TMP2.FIL" OK
DELETE FORMAT AP_TMP3 OK
DELETE "%fld_Tmps%AP_TMP3.FIL" OK
DELETE FORMAT AP_TMP4 OK
DELETE "%fld_Tmps%AP_TMP4.FIL" OK
DELETE FORMAT AP_TMP5 OK
DELETE "%fld_Tmps%AP_TMP5.FIL" OK
DELETE FORMAT AP005_TMP OK
DELETE "%fld_Tmps%AP005_TMP.FIL" OK
DELETE FORMAT AP_TMP6 OK
DELETE "%fld_Tmps%AP_TMP6.FIL" OK
DELETE FORMAT AP_TMP7 OK
DELETE "%fld_Tmps%AP_TMP7.FIL" OK
DELETE FORMAT AP005_TMP OK
DELETE "%fld_Tmps%AP005_TMP.FIL" OK

DELETE FORMAT TMP1 OK
DELETE "%fld_Tmps%TMP1.FIL" OK
DELETE FORMAT TMP2 OK
DELETE "%fld_Tmps%TMP2.FIL" OK
DELETE FORMAT TMP3 OK
DELETE "%fld_Tmps%TMP3.FIL" OK
DELETE FORMAT TMP34 OK
DELETE "%fld_Tmps%TMP34.FIL" OK
DELETE FORMAT TMP4 OK
DELETE "%fld_Tmps%TMP4.FIL" OK
DELETE FORMAT TMP5 OK
DELETE "%fld_Tmps%TMP5.FIL" OK
DELETE FORMAT TMP6 OK
DELETE "%fld_Tmps%TMP6.FIL" OK
DELETE FORMAT TMP7 OK
DELETE "%fld_Tmps%TMP7.FIL" OK
DELETE FORMAT TMP8 OK
DELETE "%fld_Tmps%TMP8.FIL" OK
DELETE FORMAT TMP9 OK
DELETE "%fld_Tmps%TMP9.FIL" OK
DELETE FORMAT TMP10 OK
DELETE "%fld_Tmps%TMP10.FIL" OK
DELETE FORMAT TMP11 OK
DELETE "%fld_Tmps%TMP11.FIL" OK
DELETE FORMAT TMP_Dups OK
DELETE "%fld_Tmps%TMP_Dups.FIL" OK
DELETE FORMAT TMP_Address OK
DELETE "%fld_Tmps%TMP_Address.FIL" OK
DELETE FORMAT SUM_Address OK
DELETE "%fld_Tmps%SUM_Address.FIL" OK

DELETE FORMAT TMP_TEL OK
DELETE "%fld_Tmps%TMP_TEL.FIL" OK
DELETE FORMAT TMP_TEST OK
DELETE "%fld_Tmps%TMP_TEST.fil" OK
DELETE FORMAT TMP_VM008 OK
DELETE "%fld_Tmps%TMP_VM008.FIL" OK
DELETE FORMAT TMP_Vnd OK
DELETE "%fld_Tmps%TMP_Vnd.FIL" OK
DELETE FORMAT TMP_Vnd OK
DELETE "%fld_Tmps%TMP_Vnd.FIL" OK
DELETE FORMAT TMP_VM010 OK
DELETE "%fld_Tmps%TMP_VM010.FIL" OK
DELETE FORMAT TMP_VM010D OK
DELETE "%fld_Tmps%TMP_VM010D.FIL" OK

DELETE FORMAT TMP_Dups OK
DELETE "%fld_Tmps%TMP_Dups.FIL" OK
DELETE FORMAT TMP1 OK
DELETE "%fld_Tmps%TMP1.FIL" OK
DELETE FORMAT TMP2 OK
DELETE "%fld_Tmps%TMP2.FIL" OK
DELETE FORMAT TMP3 OK
DELETE "%fld_Tmps%TMP3.FIL" OK
DELETE FORMAT TMP31 OK
DELETE "%fld_Tmps%TMP31.FIL" OK
DELETE FORMAT TMP32 OK
DELETE "%fld_Tmps%TMP32.FIL" OK
DELETE FORMAT TMP33 OK
DELETE "%fld_Tmps%TMP33.FIL" OK
DELETE FORMAT TMP34 OK
DELETE "%fld_Tmps%TMP34.FIL" OK
DELETE FORMAT TMP4 OK
DELETE "%fld_Tmps%TMP4.FIL" OK
DELETE FORMAT TMP5 OK
DELETE "%fld_Tmps%TMP5.FIL" OK
DELETE FORMAT TMP6 OK
DELETE "%fld_Tmps%TMP6.FIL" OK
DELETE FORMAT TMP_TEL OK
DELETE "%fld_Tmps%TMP_TEL.FIL" OK

DELETE FORMAT TMP OK
DELETE "%fld_Tmps%TMP.FIL" OK
DELETE FORMAT TMP_1 OK
DELETE "%fld_Tmps%TMP_1.FIL" OK
DELETE FORMAT TMP_AP013_PO OK
DELETE "%fld_Tmps%TMP_AP013_PO.FIL" OK
DELETE FORMAT TMP_TstCd OK
DELETE "%fld_Tmps%TMP_TstCd.FIL" OK
DELETE FORMAT TMP_VM006 OK
DELETE "%fld_Tmps%TMP_VM006.FIL" OK

DELETE FORMAT TMP_GL OK
DELETE "TMP_GL.FIL" OK
DELETE FORMAT TMP_1 OK
DELETE "TMP_1.FIL" OK
DELETE FORMAT TMP_GL1 OK
DELETE "TMP_GL1.FIL" OK

DELETE FORMAT "%fld_Tmps%AXTmp1" OK
DELETE "%fld_Tmps%AXTmp1.FIL" OK
DELETE FORMAT "%fld_Tmps%AXTmp2" OK
DELETE "%fld_Tmps%AXTmp2.FIL" OK
DELETE FORMAT "%fld_Tmps%AXTmp3" OK
DELETE "%fld_Tmps%AXTmp3.FIL" OK
DELETE FORMAT "%fld_Tmps%AXTmp4" OK
DELETE "%fld_Tmps%AXTmp4.FIL" OK
^BATCH    Z_Quit                             
[PARENT_FOLDER_ID] 1349217412
CLOSE
QUIT
^BATCH    CMC01_Run_Tests_VM                 
[PARENT_FOLDER_ID] 1426733072
^BATCH    CMC02_Run_Tests_AP                 
[PARENT_FOLDER_ID] 1426733072
^BATCH    CMC03_Run_Tests_EM                 
[PARENT_FOLDER_ID] 1426733072
^BATCH    CMC04_Run_Tests_PR                 
[PARENT_FOLDER_ID] 1426733072
^BATCH    CMB02_PreData_PR                   
[PARENT_FOLDER_ID] 1426733072
COMMENT
//ANALYTIC CMD02_Pre_Data_PR
 Analytic Description: Prepare and convert data for the tests
 CREATED BY Ian Craigen FROM SATORIGROUP (www.satorigroup.com.au) 2 9667 3866
//FILE  DataMapping.xlsx
//DATA  EMF_Emp_Master_File
//DATA  EMF_TMP_Emp
//DATA  Payroll_Payments
//DATA  Payroll_Sum_12m
//DATA  Vnd_Emp_Master
//RESULT LOG
//RESULT FILE  *.mdb
//RESULT FILE  *.LOG
END

COMM***************************************************************************
COMM *** NewCrest CCM
COMM *** Prepare data
COMM *** Created by Ian Craigen (2 9667 3866) ON 5/04/2014 
COMM***************************************************************************

SET SAFETY OFF
IF FTYPE("_Version")="v" OR FTYPE("_Version")="U" OR FTYPE("fld_Sources")="U" OR FTYPE("v_AX")="U" DO AA002_Variable_Setting

SET DATE "DD/MM/YYYY"


COMM *** decrypt and remove the extention .FIL***
%v_AX% DO CMC02_Decrypt_All

COMM *** get excel mapping table ***
Errmsg=""
DM_Flag=F
DO LE003_Imp_Mapping

COMM *** Prepare data for CCM ***


COMM *** Convert Source data into ACL application ***
DO MP004_Convert_Payroll

COMM *** encrypt the tables after finishing the tests***



SET SAFETY ON
^BATCH    ZA001_CreateFlds                   
[PARENT_FOLDER_ID] 1349217412
COMM *************************************************************
COMM *** EVA Application
COMM *** Create all working folders for the ACL projects
COMM *** Created By Nancy Li on 17/11/2014
COMM **************************************************************


SET SAFETY OFF
CLOSE 

DIR "*.ACL" TO "TMP1"
OPEN TMP1 


v_path_new=substr(FILE_NAME 1 AT(OCCURS(FILE_NAME "\") "\" FILE_NAME))

COMMENT
fld_Sources="Sources\"
fld_Workings="Workings\"
fld_Tmps="Tmps\"
fld_Results="Results\"
fld_Reports="Reports\"
fld_History="History\"
fld_Greylist="Greylist\"
fld_Data="Data\"
fld_DataMapping="DataMapping\
fld_Logs="Logs\"
fld_ABN="ABN\"
END
CLOSE 

DIR "%v_path_new%*" SUBDIRECTORY TO "TMP1"
OPEN TMP1 

v_COMMENT="COMMENT"
SET FILTER TO FILE_NAME=SUBSTR(ALLTRIM("%v_path_new%%fld_Sources%"),1,LEN(ALLTRIM("%v_path_new%%fld_Sources%"))-1)
COUNT
IF COUNT1=0 v_COMMENT=""
%v_COMMENT% OPEN TMP1
%v_COMMENT% CLASSIFY ON FILE_ATTRIBUTES TO GRAPH
%v_COMMENT% SAVE GRAPH to "%v_path_new%%fld_Sources%test.bmp"
%v_COMMENT% del "%v_path_new%%fld_Sources%test.bmp" ok

v_COMMENT="COMMENT"
SET FILTER TO  FILE_NAME=SUBSTR(ALLTRIM("%v_path_new%%fld_Workings%"),1,LEN(ALLTRIM("%v_path_new%%fld_Workings%"))-1)
COUNT
IF COUNT1=0 v_COMMENT=""
%v_COMMENT% OPEN TMP1
%v_COMMENT% CLASSIFY ON FILE_ATTRIBUTES TO GRAPH
%v_COMMENT% SAVE GRAPH to "%v_path_new%%fld_Workings%test.bmp"
%v_COMMENT% del "%v_path_new%%fld_Workings%test.bmp" ok

v_COMMENT="COMMENT"
SET FILTER TO  FILE_NAME=SUBSTR(ALLTRIM("%v_path_new%%fld_Tmps%"),1,LEN(ALLTRIM("%v_path_new%%fld_Tmps%"))-1)
COUNT
IF COUNT1=0 v_COMMENT=""
%v_COMMENT% OPEN TMP1
%v_COMMENT% CLASSIFY ON FILE_ATTRIBUTES TO GRAPH
%v_COMMENT% SAVE GRAPH to "%v_path_new%%fld_Tmps%test.bmp"
%v_COMMENT% del "%v_path_new%%fld_Tmps%test.bmp" ok

v_COMMENT="COMMENT"
SET FILTER TO  FILE_NAME=SUBSTR(ALLTRIM("%v_path_new%%fld_Results%"),1,LEN(ALLTRIM("%v_path_new%%fld_Results%"))-1)
COUNT
IF COUNT1=0 v_COMMENT=""
%v_COMMENT% OPEN TMP1
%v_COMMENT% CLASSIFY ON FILE_ATTRIBUTES TO GRAPH
%v_COMMENT% SAVE GRAPH to "%v_path_new%%fld_Results%test.bmp"
%v_COMMENT% del "%v_path_new%%fld_Results%test.bmp" ok

v_COMMENT="COMMENT"
SET FILTER TO  FILE_NAME=SUBSTR(ALLTRIM("%v_path_new%%fld_Reports%"),1,LEN(ALLTRIM("%v_path_new%%fld_Reports%"))-1)
COUNT
IF COUNT1=0 v_COMMENT=""
%v_COMMENT% OPEN TMP1
%v_COMMENT% CLASSIFY ON FILE_ATTRIBUTES TO GRAPH
%v_COMMENT% SAVE GRAPH to "%v_path_new%%fld_Reports%test.bmp"
%v_COMMENT% del "%v_path_new%%fld_Reports%test.bmp" ok


v_COMMENT="COMMENT"
SET FILTER TO  FILE_NAME=SUBSTR(ALLTRIM("%v_path_new%%fld_History%"),1,LEN(ALLTRIM("%v_path_new%%fld_History%"))-1)
COUNT
IF COUNT1=0 v_COMMENT=""
%v_COMMENT% OPEN TMP1
%v_COMMENT% CLASSIFY ON FILE_ATTRIBUTES TO GRAPH
%v_COMMENT% SAVE GRAPH to "%v_path_new%%fld_History%test.bmp"
%v_COMMENT% del "%v_path_new%%fld_History%test.bmp" ok

v_COMMENT="COMMENT"
SET FILTER TO  FILE_NAME=SUBSTR(ALLTRIM("%v_path_new%%fld_Greylist%"),1,LEN(ALLTRIM("%v_path_new%%fld_Greylist%"))-1)
COUNT
IF COUNT1=0 v_COMMENT=""
%v_COMMENT% OPEN TMP1
%v_COMMENT%  CLASSIFY ON FILE_ATTRIBUTES TO GRAPH
%v_COMMENT% SAVE GRAPH to "%v_path_new%%fld_Greylist%test.bmp"
%v_COMMENT% del "%v_path_new%%fld_Greylist%test.bmp" ok

v_COMMENT="COMMENT"
SET FILTER TO  FILE_NAME=SUBSTR(ALLTRIM("%v_path_new%%fld_Data%"),1,LEN(ALLTRIM("%v_path_new%%fld_Data%"))-1)
COUNT
IF COUNT1=0 v_COMMENT=""
%v_COMMENT% OPEN TMP1
%v_COMMENT%  CLASSIFY ON FILE_ATTRIBUTES TO GRAPH
%v_COMMENT% SAVE GRAPH to "%v_path_new%%fld_Data%test.bmp"
%v_COMMENT% del "%v_path_new%%fld_Data%test.bmp" ok

v_COMMENT="COMMENT"
SET FILTER TO  FILE_NAME=SUBSTR(ALLTRIM("%v_path_new%%fld_DataMapping%"),1,LEN(ALLTRIM("%v_path_new%%fld_DataMapping%"))-1)
COUNT
IF COUNT1=0 v_COMMENT=""
%v_COMMENT% OPEN TMP1
%v_COMMENT%  CLASSIFY ON FILE_ATTRIBUTES TO GRAPH
%v_COMMENT% SAVE GRAPH to "%v_path_new%%fld_DataMapping%test.bmp"
%v_COMMENT% del "%v_path_new%%fld_DataMapping%test.bmp" ok

v_COMMENT="COMMENT"
SET FILTER TO  FILE_NAME=SUBSTR(ALLTRIM("%v_path_new%%fld_Logs%"),1,LEN(ALLTRIM("%v_path_new%%Fld_Logs%"))-1)
COUNT
IF COUNT1=0 v_COMMENT=""
%v_COMMENT% OPEN TMP1
%v_COMMENT%  CLASSIFY ON FILE_ATTRIBUTES TO GRAPH
%v_COMMENT% SAVE GRAPH to "%v_path_new%%fld_Logs%test.bmp"
%v_COMMENT% del "%v_path_new%%fld_Logs%test.bmp" ok

v_COMMENT="COMMENT"
SET FILTER TO  FILE_NAME=SUBSTR(ALLTRIM("%v_path_new%%fld_ABN%"),1,LEN(ALLTRIM("%v_path_new%%fld_ABN%"))-1)
COUNT
IF COUNT1=0 v_COMMENT=""
%v_COMMENT% OPEN TMP1
%v_COMMENT%  CLASSIFY ON FILE_ATTRIBUTES TO GRAPH
%v_COMMENT% SAVE GRAPH to "%v_path_new%%fld_ABN%test.bmp"
%v_COMMENT% del "%v_path_new%%fld_ABN%test.bmp" ok


DELETE FORMAT TMP1 OK
DELETE TMP1.fil OK
^BATCH    VMZ02_Import_ABR                   
[PARENT_FOLDER_ID] 1349217412
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Importing data For ABN tests
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 23/05/2012
COMM***************************************************************************


IF FTYPE("v_ABNChecker3")="U" OR FTYPE("v_ABNChecker_Version")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Workings%

COMM *** check the filesize of ABN_ASIC.TXT, to make sure the user have run ABN Checker first***
%v_CCMJob% IF FILESIZE("%fld_ABN%ABN_ASIC.TXT")<=0 PAUSE "Please run the ABN Checker to capture the ABN(s) information from ABR website first!" 
IF FILESIZE("%fld_ABN%ABN_ASIC.TXT")<=0 DELETE FORMAT ABN_ASIC OK
IF FILESIZE("%fld_ABN%ABN_ASIC.TXT")<=0 ESCAPE

COMM *** ABN Checker 3 ***
%v_ABNChecker3% IMPORT DELIMITED TO ABN_ASIC "%fld_Workings%ABN_ASIC.fil" FROM "%fld_ABN%ABN_ASIC.TXT" 0 SEPARATOR "|" QUALIFIER NONE CONSECUTIVE STARTLINE 1 FIELD "ABN_CLN" C AT 1 DEC 0 WID 20 PIC "" AS "" FIELD "ASIC_entityStatusCode" C AT 21 DEC 0 WID 20 PIC "" AS "" FIELD "ASIC_entityStatusEF" C AT 41 DEC 0 WID 10 PIC "" AS "" FIELD "ASIC_entityStatusET" C AT 51 DEC 0 WID 10 PIC "" AS "" FIELD "ASIC_identifierValue" C AT 61 DEC 0 WID 15 PIC "" AS "" FIELD "ASIC_CurrentIndicator" C AT 76 DEC 0 WID 5 PIC "" AS "" FIELD "ASIC_Number" C AT 81 DEC 0 WID 20 PIC "" AS "" FIELD "ASIC_entityTypeCode" C AT 101 DEC 0 WID 5 PIC "" AS "" FIELD "ASIC_entityDescription" C AT 106 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_GST_effFrom" C AT 156 DEC 0 WID 10 PIC "" AS "" FIELD "ASIC_GST_effTo" C AT 166 DEC 0 WID 10 PIC "" AS "" FIELD "ASIC_orgName" C AT 176 DEC 0 WID 100 PIC "" AS "" FIELD "ASIC_effFrom" C AT 276 DEC 0 WID 10 PIC "" AS "" FIELD "ASIC_mainbus_statec" C AT 286 DEC 0 WID 10 PIC "" AS "" FIELD "ASIC_mainbus_postc" C AT 296 DEC 0 WID 10 PIC "" AS "" FIELD "ASIC_mainbus_effFr" C AT 306 DEC 0 WID 10 PIC "" AS "" FIELD "ASIC_mainbus_effTo" C AT 316 DEC 0 WID 10 PIC "" AS "" FIELD "ASIC_TrdNameCnt" C AT 326 DEC 0 WID 5 PIC "" AS "" FIELD "ASIC_TrdName01" C AT 331 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName02" C AT 381 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName03" C AT 431 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName04" C AT 481 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName05" C AT 531 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName06" C AT 581 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName07" C AT 631 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName08" C AT 681 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName09" C AT 731 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName10" C AT 781 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName11" C AT 831 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName12" C AT 881 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName13" C AT 931 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName14" C AT 981 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName15" C AT 1031 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName16" C AT 1081 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName17" C AT 1131 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName18" C AT 1181 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName19" C AT 1231 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName20" C AT 1281 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName21" C AT 1331 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName22" C AT 1381 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName23" C AT 1431 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName24" C AT 1481 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName25" C AT 1531 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName26" C AT 1581 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName27" C AT 1631 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName28" C AT 1681 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName29" C AT 1731 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName30" C AT 1781 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName31" C AT 1831 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName32" C AT 1881 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName33" C AT 1931 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName34" C AT 1981 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName35" C AT 2031 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName36" C AT 2081 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName37" C AT 2131 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName38" C AT 2181 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName39" C AT 2231 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName40" C AT 2281 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName41" C AT 2331 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName42" C AT 2381 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName43" C AT 2431 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName44" C AT 2481 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName45" C AT 2531 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName46" C AT 2581 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName47" C AT 2631 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName48" C AT 2681 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName49" C AT 2731 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName50" C AT 2781 DEC 0 WID 50 PIC "" AS "" 


COMM *** ABN Checker 3.1 ***
%v_ABNChecker31% IMPORT DELIMITED TO ABN_ASIC "%fld_Workings%ABN_ASIC.fil" FROM "%fld_ABN%ABN_ASIC.TXT" 0 SEPARATOR "|" QUALIFIER NONE CONSECUTIVE STARTLINE 1 FIELD "ABN_CLN" C AT 1 DEC 0 WID 20 PIC "" AS "" FIELD "ASIC_entityStatusCode" C AT 21 DEC 0 WID 21 PIC "" AS "" FIELD "ASIC_entityStatusEF" C AT 42 DEC 0 WID 19 PIC "" AS "" FIELD "ASIC_entityStatusET" C AT 61 DEC 0 WID 19 PIC "" AS "" FIELD "RecordLastUpdatedDate" C AT 80 DEC 0 WID 21 PIC "" AS "" FIELD "ASIC_identifierValue" C AT 101 DEC 0 WID 20 PIC "" AS "" FIELD "ASIC_CurrentIndicator" C AT 121 DEC 0 WID 21 PIC "" AS "" FIELD "ASIC_Number" C AT 142 DEC 0 WID 20 PIC "" AS "" FIELD "ASIC_entityTypeCode" C AT 162 DEC 0 WID 19 PIC "" AS "" FIELD "ASIC_entityDescription" C AT 181 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_GST_effFrom" C AT 231 DEC 0 WID 16 PIC "" AS "" FIELD "ASIC_GST_effTo" C AT 247 DEC 0 WID 14 PIC "" AS "" FIELD "ASIC_orgName" C AT 261 DEC 0 WID 100 PIC "" AS "" FIELD "ASIC_effFrom" C AT 361 DEC 0 WID 12 PIC "" AS "" FIELD "ASIC_mainbus_statec" C AT 373 DEC 0 WID 19 PIC "" AS "" FIELD "ASIC_mainbus_postc" C AT 392 DEC 0 WID 18 PIC "" AS "" FIELD "ASIC_mainbus_effFr" C AT 410 DEC 0 WID 18 PIC "" AS "" FIELD "ASIC_mainbus_effTo" C AT 428 DEC 0 WID 18 PIC "" AS "" FIELD "ASIC_TrdNameCnt" C AT 446 DEC 0 WID 15 PIC "" AS "" FIELD "ASIC_TrdName01" C AT 461 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName02" C AT 511 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName03" C AT 561 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName04" C AT 611 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName05" C AT 661 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName06" C AT 711 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName07" C AT 761 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName08" C AT 811 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName09" C AT 861 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName10" C AT 911 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName11" C AT 961 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName12" C AT 1011 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName13" C AT 1061 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName14" C AT 1111 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName15" C AT 1161 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName16" C AT 1211 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName17" C AT 1261 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName18" C AT 1311 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName19" C AT 1361 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName20" C AT 1411 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName21" C AT 1461 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName22" C AT 1511 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName23" C AT 1561 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName24" C AT 1611 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName25" C AT 1661 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName26" C AT 1711 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName27" C AT 1761 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName28" C AT 1811 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName29" C AT 1861 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName30" C AT 1911 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName31" C AT 1961 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName32" C AT 2011 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName33" C AT 2061 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName34" C AT 2111 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName35" C AT 2161 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName36" C AT 2211 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName37" C AT 2261 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName38" C AT 2311 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName39" C AT 2361 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName40" C AT 2411 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName41" C AT 2461 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName42" C AT 2511 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName43" C AT 2561 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName44" C AT 2611 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName45" C AT 2661 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName46" C AT 2711 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName47" C AT 2761 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName48" C AT 2811 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName49" C AT 2861 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName50" C AT 2911 DEC 0 WID 50 PIC "" AS "" 


OPEN ABN_ASIC
INDEX ON ABN_CLN TO INXABN

^BATCH    VMZ03_Prepare_ABN                  
[PARENT_FOLDER_ID] 1349217412
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Prepare data for ABN test against ASIC 
COMM *** After prepare the ABN list, run ABNLookupConfig.exe (e.g. C:\ABN\ABNLookup\App\)
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 23/05/2012
COMM***************************************************************************


IF FTYPE("_Version")="v" OR FTYPE("fld_ABN")="U" DO AA002_Variable_Setting

SET SAFETY OFF

SET DATE "DD/MM/YYYY"

SET FOLDER /%fld_Tmps%

OPEN VMF_Vnd_Master_File

DELETE FIELD ABN_CLN OK 
DEFINE FIELD ABN_CLN COMPUTED SUBSTR(ALLTRIM(INCLUDE(ABN,"0123456789")),1,20)

SUMMARIZE ON ABN_CLN IF NOT ISBLANK(ABN_CLN) TO "%fld_Workings%ABN_Temp.FIL" OPEN PRESORT

EXTRACT FIELDS ABN_CLN  IF LENGTH(ALLTRIM(ABN_CLN))>1  TO "ABN" OPEN

EXPORT FIELDS ABN_CLN TO "%fld_ABN%ABN" 

SET SAFETY ON
^BATCH    CMB01_PreData_AP                   
[PARENT_FOLDER_ID] 1426733072
COMMENT
//ANALYTIC CMB01_PreData_AP
 Analytic Description: Prepare and convert data for the AP & VM tests
 CREATED BY NANCY LI FROM SATORIGROUP (www.satorigroup.com.au) 0431 057 135
//FILE  DataMapping.xlsx
//DATA  VMF_BnkAcc_Chg_History
//DATA  VMF_Chg_History
//DATA  AP_Invoice_Credits
//DATA  AP_Invoices
//DATA  AP_InvPO
//DATA  AP_Payments
//DATA  AP_PO_Lines
//DATA  AP_PO_Vnd_Sum
//DATA  AP_Vnd_InvGst_Sum
//DATA  AP_VndSite_InvGst_Sum
//DATA  VMF_Address
//DATA  VMF_BnkAcc
//DATA  VMF_Emails
//DATA  VMF_InterCompany
//DATA  VMF_Vnd_Master_File
//DATA  VMF_Vnd_OneTime
//DATA  Vnd_Emp_Master
//DATA  ABN_ASIC
//DATA  EMF_BnkAcc
//DATA  EMF_Emp_Master_File
//DATA  EMF_TMP_Emp
//DATA  Employee_Address
//DATA  Employee_Bank
//DATA  Employee_Tel
//DATA  EMF_BnkAcc_Chg_History
//RESULT LOG
//RESULT FILE  *.XML
//RESULT FILE  *.LOG
//RESULT FILE  *.csv
END

COMM***************************************************************************
COMM *** NewCrest CCM
COMM *** Prepare data
COMM *** Created by Nancy Li (0431 057 135) ON 10/07/2013 
COMM***************************************************************************

SET SAFETY OFF
IF FTYPE("_Version")="v" OR FTYPE("_Version")="U" OR FTYPE("fld_Sources")="U" OR FTYPE("v_AX")="U" DO AA002_Variable_Setting

SET DATE "DD/MM/YYYY"

COMM *** decrypt and remove the extention .FIL***

%v_AX% DO CMC02_Decrypt_All

COMM *** Combine / append the AP transactions ***

DO CB004_Com_BSAK

DO CB005_Com_BSEG

DO CB006_Com_BSET

DO CB007_Com_EKPO

DO CB008_Com_MSEG

DO CB012_Com_EBAN

DO CB013_Com_RSEG

DO CB015_Com_BSEC

DO CB016_Com_COAS

DO CB014_Com_BKPF

COMM *** get excel mapping table ***

Errmsg=""
DM_Flag=F
DO LE003_Imp_Mapping

COMM *** Prepare data for CCM ***

DO CB001_Pre_Data

COMM *** Convert Source data into ACL application ***
DO MP001_Convert_VMF

DO MP002_Convert_AP

DO MP003_Convert_EMF

COMM *** Combine the Vnd and Emp together ***
DO MZ003_Com_VndEmp

COMM *** generate ABN txt file***
DO VMZ01_Prepare_ABN

COMM *** encrypt the tables after finishing the tests***



SET SAFETY ON
^BATCH    CMB03_RunABNChecker                
[PARENT_FOLDER_ID] 1426733072
COMMENT
//ANALYTIC CMB03_RunABNChecker
 Analytic Description: Execute ABN Checker job to retrieve the ABN status information from ABR Webside
 CREATED BY NANCY LI FROM SATORIGROUP (www.satorigroup.com.au) 0431 057 135
//RESULT LOG
END

COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION FOR CCM (AX)
COMM *** Run ABN Checker to update the ABN status from ABR websit 
COMM *** This scripts normally run after the VM data preparation
COMM *** Created by Nancy Li (0431 057 135) on 23/03/2015
COMM***************************************************************************

IF FTYPE("fld_ABN")="U" OR FTYPE("v_App_Path")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Workings%

COMM *** check the filesize of ABN_ASIC.TXT, to make sure the user have run ABN Checker first***
IF FILESIZE("%fld_ABN%ABN.TXT")<=0 ESCAPE

EXECUTE '%v_ABNChecker_Path%App\ABNLookup.exe' 

SET SAFETY ON
^BATCH    AE001_Dup_History                  
[PARENT_FOLDER_ID] 1349217412
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Remove dups that have been shown in History
COMM *** for Dup test, input variables: v_ID_KEY,v_TEST_NO,v_DUP_KEY
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************
IF FTYPE("v_AppAX")="U" DO AA002_Variable_Setting
SET FOLDER /%fld_History%

%v_CCMJob% IF v_ID_KEY="" PAUSE "Please set a Unique Key of the record to the variable ID_KEY (e.g. Vchr_ID, Vndr_ID)."
%v_CCMJob% IF v_TEST_NO="" PAUSE "Please set a Test Name to the variable TEST_NO (e.e. AP001, VM001)."
IF v_ID_KEY="" OR v_TEST_NO="" ESCAPE

SET FOLDER /%fld_Tmps%
EXTRACT RECORD TO %fld_Tmps%TMP_Cur OPEN

SET FOLDER /%fld_History%
IF FTYPE("%v_TEST_NO%_History")<>"y" OR FILESIZE("%fld_History%%v_TEST_NO%_History.fil") <0 EXTRACT FIELDS ALL IF 1<>1 TO "%fld_History%%v_TEST_NO%_History" OPEN
IF FTYPE("%v_TEST_NO%_History")="y" AND FILESIZE("%fld_History%%v_TEST_NO%_History.fil") >=0 OPEN "%fld_History%%v_TEST_NO%_History"
%v_AppAX% IF FTYPE("%v_TEST_NO%_History")="y" EXTRACT FIELDS ALL TO "%fld_Tmps%AXTmp1"
%v_AppAX% IF FTYPE("%v_TEST_NO%_History")="y" EXTRACT FIELDS ALL TO "%fld_History%%v_TEST_NO%_History" OPEN
INDEX ON %v_ID_KEY% TO IDX_%v_TEST_NO%_History_%v_ID_KEY%

EXPORT FIELDS ALL DELIMITED TO "Field_names.del" KEEPTITLE SEPARATOR SPACE QUALIFIER NONE FIRST 0
EXTRACT BLANKS(1000) AS "Allrec" TO FIELD_Names FIRST 0
OPEN Field_names.del FORMAT FIELD_Names CRLF
v_HisField_Names = ALL(allrec)
CLOSE PRIMARY SECONDARY
DELETE FORMAT FIELD_Names OK
DELETE Fieldnames.del OK

SET FOLDER /%fld_Tmps%
OPEN TMP_Cur
DEFINE RELATION %v_ID_KEY% WITH %v_TEST_NO%_History INDEX IDX_%v_TEST_NO%_History_%v_ID_KEY%

SUMMARIZE ON %v_DUP_KEY% IF %v_ID_KEY%<>%v_TEST_NO%_History.%v_ID_KEY% TO "%fld_Tmps%TMP_His.FIL" OPEN PRESORT
INDEX ON %v_DUP_KEY% TO IDX_TMP_His_DUP_KEY

OPEN TMP_Cur
DEFINE RELATION %v_DUP_KEY% WITH TMP_His INDEX IDX_TMP_His_DUP_KEY

EXTRACT FIELDS %v_HisField_Names% IF %v_DUP_KEY%= TMP_His.%v_DUP_KEY% TO %fld_Tmps%TMP_Cur1 OPEN 

SET FOLDER /%fld_History%
EXTRACT FIELDS %v_HisField_Names% TO "%fld_History%%v_TEST_NO%_History" APPEND

SET FOLDER /%fld_Tmps%
^BATCH    AE002_Nor_History                  
[PARENT_FOLDER_ID] 1349217412
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Remove dups that have been shown in History
COMM *** for Normal Test, input variables: v_ID_KEY,v_TEST_NO
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************

SET FOLDER /%fld_History%

%v_CCMJob% IF v_ID_KEY="" PAUSE "Please set a Unique Key of the record to the variable ID_KEY (e.g. Vchr_ID, Vndr_ID)."
%v_CCMJob% IF v_TEST_NO="" PAUSE "Please set a Test Name to the variable TEST_NO (e.e. AP001, VM001)."
IF v_ID_KEY="" OR v_TEST_NO="" ESCAPE

SET FOLDER /%fld_Tmps%

EXTRACT FIELDS ALL TO %fld_Tmps%TMP_Cur OPEN

SET FOLDER /%fld_History%
IF FTYPE("%v_TEST_NO%_History")<>"y" OR FILESIZE("%fld_History%%v_TEST_NO%_History.fil") <0 EXTRACT FIELDS ALL FIRST 0 TO "%fld_History%%v_TEST_NO%_History" OPEN
IF FTYPE("%v_TEST_NO%_History")="y" AND FILESIZE("%fld_History%%v_TEST_NO%_History.fil") >=0 OPEN %fld_History%%v_TEST_NO%_History
%v_AppAX% IF FTYPE("%v_TEST_NO%_History")="y" EXTRACT FIELDS ALL TO "%fld_Tmps%AXTmp1"
%v_AppAX% IF FTYPE("%v_TEST_NO%_History")="y" EXTRACT FIELDS ALL TO "%fld_History%%v_TEST_NO%_History" OPEN

INDEX ON %v_ID_KEY% TO IDX_%v_TEST_NO%_History_%v_ID_KEY%

EXPORT FIELDS ALL DELIMITED TO "Field_names.del" KEEPTITLE SEPARATOR SPACE QUALIFIER NONE FIRST 0
EXTRACT BLANKS(1000) AS "Allrec" TO FIELD_Names FIRST 0
OPEN Field_names.del FORMAT FIELD_Names CRLF
v_HisField_Names = ALL(allrec)
CLOSE PRIMARY SECONDARY
DELETE FORMAT FIELD_Names OK
DELETE Fieldnames.del OK

SET FOLDER /%fld_Tmps%

OPEN TMP_Cur
DEFINE RELATION %v_ID_KEY% WITH %v_TEST_NO%_History IDX_%v_TEST_NO%_History_%v_ID_KEY%

EXTRACT FIELDS %v_HisField_Names% IF %v_ID_KEY%<> %v_TEST_NO%_History.%v_ID_KEY% TO %fld_Tmps%TMP_Cur1 OPEN 

SET FOLDER /%fld_History%
EXTRACT FIELDS %v_HisField_Names% TO "%fld_History%%v_TEST_NO%_History"APPEND

SET FOLDER /%fld_Tmps%



^BATCH    AE004_GreyList                     
[PARENT_FOLDER_ID] 1349217412
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Exclude record from Grey List e.g. Vendor Number
COMM *** for Normal Test, input variables: v_ID_KEY_GL,v_TEST_NO_GL
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 02/10/2012
COMM***************************************************************************


SET FOLDER /%fld_Tmps%

IF v_ID_KEY_GL="" OR v_TEST_NO_GL="" ESCAPE

EXTRACT FIELDS ALL TO TMP_GL OPEN

SET FOLDER /%fld_GL%

DO AE005_Imp_GL_Test

IF FTYPE("GreyList_%v_TEST_NO_GL%")<>"y" OPEN TMP_GL
IF FTYPE("GreyList_%v_TEST_NO_GL%")<>"y" ESCAPE

IF FTYPE("GreyList_%v_TEST_NO_GL%")="y" OPEN "GreyList_%v_TEST_NO_GL%"
INDEX ON %v_ID_KEY_GL% TO IDX_GreyList_%v_TEST_NO_GL%_%v_ID_KEY_GL%

OPEN TMP_GL
DEFINE RELATION %v_ID_KEY_GL% WITH GreyList_%v_TEST_NO_GL% INDEX IDX_GreyList_%v_TEST_NO_GL%_%v_ID_KEY_GL%

EXTRACT FIELDS ALL IF %v_ID_KEY_GL%<> GreyList_%v_TEST_NO_GL%.%v_ID_KEY_GL% TO TMP_GL1 OPEN 

^BATCH    AE005_Imp_GL_Test                  
[PARENT_FOLDER_ID] 1349217412
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Import Grey List
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/11/2012
COMM***************************************************************************
SET SAFETY OFF

IF v_ID_KEY_GL="" OR v_TEST_NO_GL="" ESCAPE

COMM *** Grey List for TS011***
IMPORT EXCEL TO TMP2 "TMP2.fil" FROM "%fld_GL_Path%%v_TEST_NO_GL%.xls" TABLE "Sheet1$"  CHARMAX 200 
OPEN TMP2


v_Name1=ALLTRIM(F1)
v_Name2=ALLTRIM(F2)

IF FTYPE("v_ID_KEY_GLLen")="U" v_ID_KEY_GLLen="20"

EXTRACT FIELDS SUBSTR(ALLTRIM(F1),1,%v_ID_KEY_GLLen%) AS '%v_Name1%' SUBSTR(ALLTRIM(F2),1,60) AS '%v_Name2%' IF NOT ISBLANK(F1) AND RECNO()>1 TO "%fld_Workings%GreyList_%v_TEST_NO_GL%.fil" 
^BATCH    AP015_Mul_Trans_OneTim_Vnd_SAP     
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP015.Identify multiple transactions against the same one-time vendor
COMM *** This is only for ERP: <<Finance Tech One>>
COMM *** One time vendor number: 99999 for AUS, 49999 for NZL
COMM *** Apply fuzzy logic to identify the once time vendor by similar sub vendor name(GLF_LDG_ACC_TRANS.NARR1) + Address(GLF_LDG_ACC_TRANS.NARR2+GLF_LDG_ACC_TRANS.NARR3)
COMM *** Upgraded by Nancy Li (0431 057 135) on 23/03/2015
COMM *** DATE: 22/06/2012
COMM***************************************************************************

IF FTYPE("v_flds_VMF")="U" OR FTYPE("trg_AP_Inv")="U" OR  FTYPE("trg_VMF_OTV")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="AP015"
IF FTYPE("TXT_AP015_TransNum")="U" TXT_AP015_TransNum="2"

COMM *** Customize this Test for SAP ***
OPEN BSEC_All

DELETE FIELD DocKey OK
DEFINE FIELD DocKey COMPUTED SUBSTR(ALLTRIM(BSEC_MANDT)+ALLTRIM(BSEC_BUKRS)+ALLTRIM(BSEC_BELNR)+ALLTRIM(BSEC_GJAHR),1,30)

INDEX ON IDKey TO IDX_BSEC_IDKey

OPEN SAP_Invoice_Lines

DEFINE RELATION IDKey WITH BSEC_All INDEX IDX_BSEC_IDKey

EXTRACT FIELDS BSEC_All.IDKey BSEC_All.BSEC_XCPDK BSEC_All.BSEC_BKREF BSEC_All.BSEC_NAME1 BSEC_All.BSEC_BANKL BSEC_All.BSEC_BANKN BSEC_All.BSEC_BANKS BSEC_All.BSEC_NAME2 BSEC_All.BSEC_NAME3 BSEC_All.BSEC_NAME4 BSEC_All.BSEC_PSTLZ BSEC_All.BSEC_ORT01 BSEC_All.BSEC_STRAS BSEC_All.BSEC_PFACH BSEC_All.BSEC_PSTL2 BSEC_All.BSEC_STCD1 BSEC_All.BSEC_REGIO BSEC_All.BSEC_EMPFG BSEC_All.DocKey SUBSTR(BSAK_LIFNR,1,20) AS 'Vndr_Site_ID' SUBSTR(BSAK_LIFNR,1,20) AS 'Vndr_ID' IDKey AS 'Vchr_ID' Paid AS 'isPaid' BSAK_BLART AS 'Doc_Typ' CTOD(DATETIME(BSAK_BLDAT,'DD/MM/YYYY'),'DD/MM/YYYY') AS 'Inv_Dt' BSAK_XBLNR AS 'Inv_No' InvAmt_Doc AS 'Inv_Amt' InvAmt_Doc AS 'Inv_Amt_Doc' InvAmt_Loc AS 'Inv_Amt_Loc' BSAK_WAERS AS 'Curncy' BSAK_BELNR AS 'Btch_No' BSAK_EBELN AS 'PO_No' BSAK_SGTXT AS 'Descrp' CTOD(DATETIME(BSAK_AUGDT,'DD/MM/YYYY'),'DD/MM/YYYY') AS 'Pd_Dt' BSAK_ZTERM AS 'Pymnt_Trms' CTOD(DATETIME(BSAK_BUDAT),'DD/MM/YYYY') AS 'Pst_Dt' Void AS 'VOIDED' BSAK_GJAHR AS 'Cha_Field1' BSAK_AUGBL AS 'Cha_Field2' BSAK_XSTOV AS 'Cha_Field3' BSAK_BUKRS AS 'Cha_Field4' IDKey AS 'Cha_Field5' IF NOT ISBLANK(BSEC_All.IDKey) AND BSEC_All.BSEC_XCPDK= "X" TO "%fld_Tmps%TMP1" OPEN

COMM *** Find out the possible Vendor Group - Bank Account, Name, Address ***
COMM *** Clean Bank Account ***
DELETE FIELD c_Bank OK
DEFINE FIELD c_Bank COMPUTED SUBSTR(ALLTRIM(INCLUDE(BSEC_BANKL,"0123456789"))+ALLTRIM(INCLUDE(BSEC_BANKN,"0123456789")),1,20)

COMM *** Clean Name ***
DELETE FIELD c_Name1 OK
DEFINE FIELD c_Name1 COMPUTED INCLUDE(UPPER(BSEC_NAME1)," ABCDEFGHIJKLMNOPQRSTUVWXYZ")
DELETE FIELD c_Name2 OK
DEFINE FIELD c_Name2 COMPUTED REPLACE(c_Name1+" "," LTD ","")
DELETE FIELD c_Name3 OK
DEFINE FIELD c_Name3 COMPUTED REPLACE(c_Name2+ " "," CO ","")
DELETE FIELD c_Name OK
DEFINE FIELD c_Name COMPUTED ALLTRIM(REPLACE(c_Name3+ " "," PL ",""))

DELETE FIELD LEN_Name OK
DEFINE FIELD LEN_Name COMPUTED LENGTH(ALLTRIM(c_Name))

DUPLICATES ON c_Bank OTHER ALL PRESORT OPEN TO "%fld_Tmps%TMP2.FIL"

INDEX ON IDKey TO IDX_TMP2

OPEN TMP1

EXTRACT FIELDS ALL TO TMP3

COMM *** LOOK FOR Name IS SAME OR INCLUDING ***
OPEN TMP3 SECONDARY
JOIN PKEY Vndr_ID  FIELDS Vndr_ID Vchr_ID IDKey c_Name BSEC_BANKL BSEC_BANKN BSEC_BANKS BSEC_ORT01 BSEC_STRAS Inv_No Btch_No SKEY Vndr_ID  WITH Vndr_ID Vchr_ID IDKey c_Name BSEC_BANKL BSEC_BANKN BSEC_BANKS BSEC_ORT01 BSEC_STRAS Inv_No Btch_No Cha_Field4 Curncy IF TMP1.IDKey<>TMP3.IDKey AND ((ALLTRIM(TMP1.c_Name)=SUBSTR(ALLTRIM(TMP3.c_Name),1,TMP1.LEN_Name)) OR (FIND(ALLTRIM(TMP1.c_Name),ALLTRIM(TMP3.c_Name)) AND LEN_Name>1) OR (ALLTRIM(TMP1.c_Name)=ALLTRIM(TMP3.c_Name)))  TO "%fld_Tmps%TMP4" OPEN PRESORT MANY SECSORT 

CLOSE SECONDARY

OPEN TMP4

DELETE FIELD DUP_Name OK
DEFINE FIELD DUP_Name COMPUTED 

c_Name2 IF LEN(ALLTRIM(c_Name))=LEN(ALLTRIM(c_Name2))
c_Name2 IF LEN(ALLTRIM(c_Name))>LEN(ALLTRIM(c_Name2)) AND LEN(ALLTRIM(c_Name))<>LEN(ALLTRIM(c_Name2))
c_Name

EXTRACT Vndr_ID DUP_Name IDKey TO "%fld_Tmps%TMP5"
EXTRACT Vndr_ID DUP_Name IDKey2 TO "%fld_Tmps%TMP5" APPEND

OPEN TMP5

SORT ON Vndr_ID IDKey DUP_Name TO "%fld_Tmps%TMP6" OPEN

INDEX ON IDKey TO IDX_TMP6

SUMMARIZE ON Vndr_ID IDKey TO "%fld_Tmps%TMP7.FIL" OPEN PRESORT

INDEX ON IDKey TO IDX_TMP7

OPEN TMP1

DEFINE RELATION IDKey WITH TMP7 INDEX IDX_TMP7
DEFINE RELATION IDKey WITH TMP2 INDEX IDX_TMP2
DEFINE RELATION IDKey WITH TMP6 INDEX IDX_TMP6

SUMMARIZE ON TMP2.c_Bank TMP6.DUP_Name IF NOT ISBLANK(TMP2.IDKey) AND NOT ISBLANK(TMP7.IDKey) TO "%fld_Tmps%TMP10.FIL" PRESORT

OPEN TMP10

INDEX ON DUP_Name TO IDX_TMP101
INDEX ON c_Bank TO IDX_TMP102

OPEN TMP1

DEFINE RELATION c_Bank WITH TMP10 INDEX IDX_TMP102
DEFINE RELATION TMP6.DUP_Name WITH TMP10 INDEX IDX_TMP101 AS TMP11 

DELETE FIELD Grp_KEY OK
DEFINE FIELD Grp_KEY COMPUTED 

SUBSTR(SUBSTR(ALLTRIM(Vndr_ID),1,20)+'~'+SUBSTR(TMP10.DUP_Name,1,30)+'~'+SUBSTR(ALLTRIM(TMP10.c_Bank),1,30),1,80) IF NOT ISBLANK(TMP10.c_Bank) 
SUBSTR(SUBSTR(ALLTRIM(Vndr_ID),1,20)+'~'+SUBSTR(TMP11.DUP_Name,1,30)+'~'+SUBSTR(ALLTRIM(TMP11.c_Bank),1,30),1,80) IF ISBLANK(TMP10.c_Bank) AND NOT ISBLANK(TMP11.DUP_Name) 
SUBSTR(ALLTRIM(Vndr_ID)+'  '+SUBSTR(TMP1.c_Name,1,30)+'~'+SUBSTR(ALLTRIM(TMP1.c_Bank),1,30),1,80)


COMM *** Summarize the Invoice by Doc Nbr ***

SUMMARIZE ON Grp_KEY DocKey SUBTOTAL Inv_Amt Inv_Amt_Loc Inv_Amt_Doc OTHER Vndr_ID isPaid Inv_No Inv_Dt Doc_Typ Descrp Curncy Cha_Field5 Cha_Field4 Cha_Field3 Cha_Field2 Cha_Field1 c_Name3 c_Name2 c_Name1 c_Name BSEC_XCPDK BSEC_STRAS BSEC_STCD1 BSEC_REGIO BSEC_PSTLZ BSEC_PSTL2 BSEC_PFACH BSEC_ORT01 BSEC_NAME4 BSEC_NAME3 BSEC_NAME2 BSEC_NAME1 BSEC_EMPFG BSEC_BKREF BSEC_BANKS BSEC_BANKN BSEC_BANKL Cha_Field4 Curncy TO "%fld_Tmps%TMP2.FIL" OPEN PRESORT

SUMMARIZE ON Grp_KEY SUBTOTAL Inv_Amt Inv_Amt_Loc Inv_Amt_Doc OTHER Vndr_ID isPaid Inv_No Inv_Dt Doc_Typ  Descrp Curncy Cha_Field5 Cha_Field4 Cha_Field3 Cha_Field2 Cha_Field1 c_Name3 c_Name2 c_Name1 c_Name BSEC_XCPDK BSEC_STRAS BSEC_STCD1 BSEC_REGIO BSEC_PSTLZ BSEC_PSTL2 BSEC_PFACH BSEC_ORT01 BSEC_NAME4 BSEC_NAME3 BSEC_NAME2 BSEC_NAME1 BSEC_EMPFG BSEC_BKREF BSEC_BANKS BSEC_BANKN BSEC_BANKL DocKey Cha_Field4 Curncy TO "%fld_Tmps%TMP8.FIL" OPEN PRESORT

EXTRACT FIELDS ALL COUNT AS 'Doc_Num' IF COUNT>VALUE(TXT_AP015_TransNum,0) AND Inv_Amt<>0.00 TO "%fld_Tmps%TMP2.FIL" OPEN

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ZONED(Doc_Num,5)+"~"+ZONED(Inv_Amt,10)+"~"+ALLTRIM(Grp_KEY),1,85)

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

COMM *** Finalize the results ***
COMM *** One Time Vendor Summary Report ***
DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ID_KEY

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Doc_Num Total_Inv_Amt Grp_KEY D"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "L"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED DATE(_RptRunDate,'DD/MM/YYYY')

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  DATE(_Data_Range_Start_Date,'DD/MM/YYYY')

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  DATE(_Data_Range_End_Date,'DD/MM/YYYY')

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED SUBSTR("AP015.Identify multiple (>%TXT_AP015_TransNum%) transactions against the same one-time vendor",1,120)

DEFINE RELATION Vndr_ID WITH VMF_Vnd_Master_File INDEX IDX_Vndr_ID


EXTRACT FIELDS ALL VMF_Vnd_Master_File.Vndr_ID AS 'Vndr_Mstr_ID' VMF_Vnd_Master_File.Vndr_Nme AS 'Vndr_Nme' VMF_Vnd_Master_File.Vndr_Sts AS 'Vndr_Sts' VMF_Vnd_Master_File.Vndr_Typ AS 'Vndr_Typ' TO "%fld_Tmps%TMP9" OPEN

OPEN TMP9

INDEX ON Grp_KEY TO IDX_TMP9_Grp_KEY


SET FOLDER /%fld_Results%

OPEN TMP9

SORT ON SORT_KEY D TO "%fld_Results%AP015_Mul_Trans_OneTim_Vnd" OPEN

COMM *** Details Report*** 

COMM *** One time spend Details ***
OPEN TMP1

DEFINE RELATION Grp_KEY WITH TMP9 INDEX IDX_TMP9_Grp_KEY
EXTRACT FIELDS ALL TMP9.Vndr_Nme TMP9.Vndr_Sts TMP9.Vndr_Typ IF NOT ISBLANK(TMP9.Grp_KEY) TO "%fld_Tmps%TMP12" OPEN

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ALLTRIM(Grp_KEY)+ ZONED(Inv_Amt,15)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Grp_KEY Inv_Amt D"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "L"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED DATE(_RptRunDate,'DD/MM/YYYY')

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  DATE(_Data_Range_Start_Date,'DD/MM/YYYY')

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  DATE(_Data_Range_End_Date,'DD/MM/YYYY')

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED SUBSTR("AP015D.Identify multiple (>%TXT_AP015_TransNum%) transactions against the same one-time vendor - Details",1,120)

EXTRACT FIELDS ALL TO  "%fld_Tmps%TMP2" OPEN

SET FOLDER /%fld_Results%

SORT ON SORT_KEY D TO "%fld_Results%AP015D_Mul_Trans_OneTim_Vnd" OPEN


COMM *** Delete temporary tables ***
OPEN SAP_Invoice_Lines

DELETE RELATION BSEC_All OK

DO AE003_Del_Tmp


SET SAFETY ON
^BATCH    AP015_Mul_Trans_OneTim_Vnd_F1      
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION FOR CCM (AX)
COMM *** AP015.Identify multiple (>2) transactions against the same one-time vendor 
COMM *** This is only for ERP: <<Finance Tech One>>
COMM *** One time vendor number: 99999 for AUS, 49999 for NZL
COMM *** Apply fuzzy logic to identify the once time vendor by similar sub vendor name(GLF_LDG_ACC_TRANS.NARR1) + Address(GLF_LDG_ACC_TRANS.NARR2+GLF_LDG_ACC_TRANS.NARR3)
COMM *** Upgraded by Nancy Li (0431 057 135) on 23/03/2015
COMM***************************************************************************

IF FTYPE("v_flds_VMF")="U" OR FTYPE("trg_AP_Inv")="U" OR  FTYPE("trg_VMF_OTV")="U"  DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="AP015"
IF FTYPE("TXT_AP015_TransNum")="U" TXT_AP015_TransNum="2"

COMM *** Customize this Test for FinanceOne ***
OPEN TGG_Invoices_Clean
DEFINE RELATION ACCNBRI WITH GLF_CHART_ACCT INDEX IDX_GLF_CHART_ACCT
DEFINE RELATION DOC_TYPE WITH GLF_DOC_TYPE INDEX IDX_GLF_DOC_TYPE

SET FILTER TO MATCH(ACCNBRI,"99999","49999")
EXTRACT FIELDS isPaid SUBSTR(ALLTRIM(ACCNBRI),1,20) AS 'Vndr_ID' GLF_CHART_ACCT.DESCR1 AS 'Vndr_Nme' GLF_CHART_ACCT.STAT_IND AS 'Vndr_Sts' GLF_CHART_ACCT.SELN_TYPE2_CODE AS 'Vndr_Typ' NARR1 AS 'Sub_Vnd_Nme' NARR2 AS 'ADD' NARR3 AS 'City_PCode' c_AMT1 AS 'Inv_Amt' c_VAT_AMT AS 'Gst_Amt' c_Inv_NetAmt AS 'Inv_NetAmt' DOC_REF1 AS 'Inv_No' DOC_DATEI1 AS 'Inv_Dt' PDATEI AS 'Pst_Dt' DOC_TYPE AS 'Doc_Typ' GLF_DOC_TYPE.TRANS_TYPE AS 'Trans_Typ' TrType_Desc CCY_CODE AS 'Currency' PORDNBR AS 'PO_NO' Pay_DOC_REF1 AS 'Pay_DocNbr' Pay_PDATEI AS 'Pay_Date' Pay_DOC_TYPE AS 'Pay_DocTyp' TRANS_NBR AS 'Trans_Nbr' GLF_LDG_TRN_ALLOC_ALL.TRANS_NBR AS 'Alloc_Trans_Nbr' PERIOD AS 'Period' POST_USER AS 'Pst_User' GLF_CHART_ACCT.ADDR1 GLF_CHART_ACCT.ADDR2 GLF_CHART_ACCT.ADDR3 GLF_CHART_ACCT.CITY GLF_CHART_ACCT.STATE GLF_CHART_ACCT.POST_CODE GLF_CHART_ACCT.ADDR_COUNTRY_CODE AS 'Country' GLF_CHART_ACCT.PHONE_NBR AS 'Tel1' GLF_CHART_ACCT.Contact_Phone AS 'Tel2' GLF_CHART_ACCT.FAX_NBR AS 'Fax'  GLF_CHART_ACCT.EMAIL_ADDR AS 'Email1' GLF_CHART_ACCT.Contract_Email AS 'Email2' Vchr_ID TO "%fld_Tmps%TMP10" OPEN
 
COMM *** Start GreyList ***
v_ID_KEY_GL="Sub_Vnd_Nme"
v_TEST_NO_GL="%v_TestNo%"
v_ID_KEY_GLLen="40"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP1" OPEN

COMM *** Find out the possible Vendor Group - Bank Account, Name, Address ***
COMM *** Clean Name ***
DELETE FIELD c_Name1 OK
DEFINE FIELD c_Name1 COMPUTED INCLUDE(UPPER(Sub_Vnd_Nme)," ABCDEFGHIJKLMNOPQRSTUVWXYZ")
DELETE FIELD c_Name2 OK
DEFINE FIELD c_Name2 COMPUTED REPLACE(c_Name1+" "," LTD ","")
DELETE FIELD c_Name3 OK
DEFINE FIELD c_Name3 COMPUTED REPLACE(c_Name2+ " "," CO ","")
DELETE FIELD c_Name OK
DEFINE FIELD c_Name COMPUTED ALLTRIM(INCLUDE(REPLACE(c_Name3+ " "," PL ",""),"ABCDEFGHIJKLMNOPQRSTUVWXYZ"))

DELETE FIELD LEN_Name OK
DEFINE FIELD LEN_Name COMPUTED LENGTH(ALLTRIM(c_Name))

COMM *** Clean Post Code and Address ***
DELETE FIELD c_PCode OK
DEFINE FIELD c_PCode COMPUTED 

INCLUDE(City_PCode,"0123456789") IF LENGTH(INCLUDE(City_PCode,"0123456789"))=4
INCLUDE(UPPER(City_PCode),"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ")

DELETE FIELD c_Add1 OK
DEFINE FIELD c_Add1 COMPUTED

REPLACE(UPPER(ADD), "STREET", " ST ") IF FIND("STREET", UPPER(ADD))
REPLACE(UPPER(ADD), "ROAD", " RD ") IF FIND("ROAD", UPPER(ADD))
REPLACE(UPPER(ADD), "AVENUE", " AVE ") IF FIND("AVENUE", UPPER(ADD))
REPLACE(UPPER(ADD), "CRESCENT", " CRES ") IF FIND("CRESCENT", UPPER(ADD))
REPLACE(UPPER(ADD), "DRIVE", " DR ") IF FIND("DRIVE", UPPER(ADD))
REPLACE(UPPER(ADD), "COURT", " CRT ") IF FIND("COURT", UPPER(ADD))
REPLACE(UPPER(ADD), "CIRCUIT", " CCT ") IF FIND("CIRCUIT", UPPER(ADD))
REPLACE(UPPER(ADD), "PLACE", " PL ") IF FIND("PLACE", UPPER(ADD))
UPPER(ADD)

DELETE FIELD c_Add1F OK
DEFINE FIELD c_Add1F COMPUTED 

"PO" IF FIND(" BAG ", c_Add1) OR FIND(" BOX ", c_Add1)  
"ST" IF FIND("HIGHWAY", c_Add1) OR FIND(" WAY", c_Add1) OR FIND(" ST ", c_Add1) OR FIND(" RD ", c_Add1) OR FIND(" AVE ", c_Add1) OR FIND(" CRES ", c_Add1) OR FIND(" DR ", c_Add1) OR FIND(" CRT ", c_Add1) OR FIND(" CCT ",c_Add1) OR FIND(" PL ", c_Add1)
" "

DELETE FIELD c_Add OK
DEFINE FIELD c_Add COMPUTED 

SUBSTR(ALLTRIM(INCLUDE(c_Add1, "0123456789"))+ALLTRIM(c_PCode),1,60) IF c_Add1F="PO"
SUBSTR(ALLTRIM(INCLUDE(c_Add1,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"))+ALLTRIM(c_PCode),1,60) 


DUPLICATES ON c_Add OTHER ALL IF Add<>"" PRESORT OPEN TO "%fld_Tmps%TMP2.FIL"
INDEX ON Vchr_ID TO IDX_TMP2

COMM *** FUZZY DUP ON Name IS SAME OR INCLUDING ***
OPEN TMP1
FUZZYDUP ON c_Name OTHER Vndr_Typ Vndr_Sts Vndr_Nme Vndr_ID TrType_Desc Trans_Typ Trans_Nbr Tel2 Tel1 Sub_Vnd_Nme STATE Pst_User Pst_Dt POST_CODE PO_NO Period Pay_DocTyp Pay_DocNbr Pay_Date LEN_Name isPaid Inv_No Inv_NetAmt Inv_Dt Inv_Amt Gst_Amt Fax Email2 Email1 Doc_Typ Currency Country City_PCode CITY c_PCode c_Name3 c_Name2 c_Name1 c_Name c_Add1F c_Add1 c_Add Alloc_Trans_Nbr ADDR3 ADDR2 ADDR1 ADD Vchr_ID LEVDISTANCE 1 DIFFPCT 99 RESULTSIZE 100 EXACT TO "TMP3" OPEN

DELETE FIELD c_GROUP_NUM OK
DEFINE FIELD c_GROUP_NUM COMPUTED ALLTRIM(STRING(TMP3.GROUP_NUM,10))

INDEX ON Vchr_ID TO IDX_TMP3

OPEN TMP1
DEFINE RELATION Vchr_ID WITH TMP3 INDEX IDX_TMP3
DEFINE RELATION Vchr_ID WITH TMP2 INDEX IDX_TMP2

SUMMARIZE ON TMP2.c_Add  IF Vchr_ID=TMP2.Vchr_ID TO "%fld_Tmps%TMP4_1.FIL" PRESORT
SUMMARIZE ON TMP3.c_GROUP_NUM IF Vchr_ID=TMP3.Vchr_ID TO "%fld_Tmps%TMP4_2.FIL" PRESORT
SUMMARIZE ON TMP2.c_Add  TMP3.c_GROUP_NUM IF Vchr_ID=TMP2.Vchr_ID OR Vchr_ID=TMP3.Vchr_ID TO "%fld_Tmps%TMP4.FIL" PRESORT

OPEN TMP4_1
INDEX ON c_Add TO IDX_TMP4_1
OPEN TMP4_2
INDEX ON c_GROUP_NUM TO IDX_TMP4_2

OPEN TMP4
INDEX ON c_GROUP_NUM TO IDX_TMP41
INDEX ON c_Add TO IDX_TMP42

OPEN TMP1
DEFINE RELATION c_Add WITH TMP4_1 INDEX IDX_TMP4_1
DEFINE RELATION c_Add WITH TMP4 INDEX IDX_TMP42
DEFINE RELATION TMP3.c_GROUP_NUM WITH TMP4_2 INDEX IDX_TMP4_2
DEFINE RELATION TMP3.c_GROUP_NUM WITH TMP4 INDEX IDX_TMP41 AS TMP41 

DELETE FIELD Grp_KEY OK
DEFINE FIELD Grp_KEY COMPUTED 

SUBSTR(SUBSTR(ALLTRIM(Vndr_ID),1,20)+'~'+SUBSTR(TMP4.c_GROUP_NUM,1,30)+'~'+BLANKS(30),1,80) IF c_Add=TMP4.c_Add AND TMP3.c_GROUP_NUM= TMP41.c_GROUP_NUM  AND TMP4_1.COUNT<TMP4_2.COUNT
SUBSTR(SUBSTR(ALLTRIM(Vndr_ID),1,20)+'~'+BLANKS(30)+'~'+SUBSTR(ALLTRIM(TMP4.c_Add),1,30),1,80) IF c_Add=TMP4.c_Add AND TMP3.c_GROUP_NUM= TMP41.c_GROUP_NUM  AND TMP4_1.COUNT>=TMP4_2.COUNT
SUBSTR(SUBSTR(ALLTRIM(Vndr_ID),1,20)+'~'+BLANKS(30)+'~'+SUBSTR(ALLTRIM(TMP4.c_Add),1,30),1,80) IF c_Add=TMP4.c_Add AND TMP4_1.COUNT>TMP4_2.COUNT 
SUBSTR(SUBSTR(ALLTRIM(Vndr_ID),1,20)+'~'+SUBSTR(TMP41.c_GROUP_NUM,1,30)+'~'+BLANKS(30),1,80) IF TMP3.c_GROUP_NUM= TMP41.c_GROUP_NUM AND TMP4_1.COUNT<TMP4_2.COUNT
SUBSTR(ALLTRIM(Vndr_ID)+'~'+SUBSTR(c_Name,1,30)+'~'+SUBSTR(ALLTRIM(c_Add),1,30),1,80)


COMM *** Summarize the Invoice by Doc Nbr ***
SET FILTER TO (TMP3.c_GROUP_NUM<>"0" AND TMP3.c_GROUP_NUM= TMP41.c_GROUP_NUM) OR (c_Add=TMP4.c_Add AND c_Add<>"")
SUMMARIZE ON Grp_KEY SUBTOTAL Inv_Amt OTHER ALL TO "%fld_Tmps%TMP6.FIL" OPEN PRESORT

EXTRACT FIELDS ALL COUNT AS 'Tran_Num'  IF COUNT>VALUE(TXT_AP015_TransNum,0) AND Inv_Amt<>0.00 TO "%fld_Tmps%TMP7.FIL" OPEN

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ZONED(Tran_Num,5)+"~"+ZONED(Inv_Amt,15)+"~"+ALLTRIM(Grp_KEY),1,85)

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

COMM *** Finalize the results ***
COMM *** One Time Vendor Summary Report ***
DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ID_KEY

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Tran_Num Total_Inv_Amt Grp_KEY D"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "L"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED DATE(_RptRunDate,'DD/MM/YYYY')

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  DATE(_Data_Range_Start_Date,'DD/MM/YYYY')

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  DATE(_Data_Range_End_Date,'DD/MM/YYYY')

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED SUBSTR("AP015.Identify multiple (>%TXT_AP015_TransNum%) transactions against the same one-time vendor",1,120)

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

INDEX ON Grp_KEY TO IDX_TMP10_Grp_KEY


SET FOLDER /%fld_Results%
OPEN TMP10
SORT ON SORT_KEY D TO "%fld_Results%AP015_Mul_Trans_OneTim_Vnd" OPEN

COMM *** Details Report*** 

COMM *** One time spend Details ***
OPEN TMP1
DEFINE RELATION Grp_KEY WITH TMP10 INDEX IDX_TMP10_Grp_KEY

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(TMP10.SORT_KEY)+'~' +ZONED(TMP4_1.COUNT,5)+ZONED(TMP4_2.COUNT,5)+'~'+ALLTRIM(c_Add)+'~'+ALLTRIM(Sub_Vnd_Nme)+ ZONED(Inv_Amt,15),1,100)

EXTRACT FIELDS ALL IF Grp_KEY=TMP10.Grp_KEY TO "%fld_Tmps%TMP11" OPEN

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Grp_KEY Inv_Amt D"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "L"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED DATE(_RptRunDate,'DD/MM/YYYY')

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  DATE(_Data_Range_Start_Date,'DD/MM/YYYY')

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  DATE(_Data_Range_End_Date,'DD/MM/YYYY')

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED SUBSTR("AP015D.Identify multiple (>%TXT_AP015_TransNum%) transactions against the same one-time vendor - Details",1,120)

EXTRACT FIELDS ALL TO  "%fld_Tmps%TMP12" OPEN

SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%AP015D_Mul_Trans_OneTim_Vnd" OPEN

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

DELETE  v_ID_KEY_GLLen OK

SET SAFETY ON
^BATCH    AP015_Mul_Trans_OneTim_Vnd_org     
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP015.Identify multiple (>2) transactions against the same one-time vendor
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_VMF")="U" OR FTYPE("trg_AP_Inv")="U" OR  FTYPE("trg_VMF_OTV")="U" DO AA002_Variable_Setting
IF FTYPE("AP_Invoices")<>"y" OR FILESIZE("%fld_Workings%AP_Invoices.FIL")<=0 OR FILESIZE("%fld_Workings%%trg_VMF_OTV%.FIL")<=0 Errmsg=Errmsg+" AP015"
IF FTYPE("AP_Invoices")<>"y" OR FILESIZE("%fld_Workings%AP_Invoices.FIL")<=0 OR FILESIZE("%fld_Workings%%trg_VMF_OTV%.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="AP015"

OPEN VMF_Vnd_Master_FIle

SET FILTER TO AP_Vnd_InvGst_Sum.COUNT>1 AND NOT ISBLANK(VMF_Vnd_OneTime.Vndr_ID)
EXTRACT FIELDS AP_Vnd_InvGst_Sum.COUNT AP_Vnd_InvGst_Sum.GST_Amt AS "Ttl_GST_Amt" AP_Vnd_InvGst_Sum.Inv_Amt AS "Ttl_Inv_Amt" %v_flds_VMF% TO "%fld_Tmps%TMP4" OPEN

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_Site_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ZONED(COUNT,9)+"~"+ALLTRIM(Vndr_Site_ID),1,85)
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP1" OPEN
INDEX ON Vndr_Site_ID TO IDX_TMP1_VndrSiteID

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

COMM *** Invoice Details ***
OPEN AP_Invoices
DEFINE RELATION Vndr_Site_ID WITH TMP1 INDEX IDX_TMP1_VndrSiteID

EXTRACT FIELDS %v_flds_AP_Inv% TMP1.Priority TMP1.RptRunDate TMP1.Data_Range_Start_Date TMP1.Data_Range_End_Date IF NOT ISBLANK(TMP1.Vndr_ID) TO "%fld_Tmps%TMP2" OPEN


COMM *** Finalize the results ***
SET FOLDER /%fld_Results%
OPEN TMP1
DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(ZONED(Ttl_Inv_Amt,15))+ALLTRIM(Vndr_ID),1,35)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Ttl_Inv_Amt Vndr_ID"

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP015. Identify multiple transactions against the same one-time vendor"

SORT ON SORT_KEY TO "%fld_Results%AP015_Mul_Trans_OneTim_Vnd"

OPEN TMP2
DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ZONED(Inv_Amt,15)+"~"+ALLTRIM(Vndr_ID),1,35)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Inv_Amt Vndr_ID"

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP015D. Identify multiple transactions against the same one-time vendor - Invoices"

SORT ON SORT_KEY TO "%fld_Results%AP015D_Mul_Trans_OneTim_Vnd"

OPEN AP_Invoices
DELETE RELATION TMP1 OK

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    AP024_Low_Act_Vnd                  
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP024. Identify Low activity vendor <xx transactions within xx months
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 25/07/2012
COMM***************************************************************************


IF FTYPE("v_flds_VMF")="U" OR FTYPE("trg_VMF")="U" DO AA002_Variable_Setting
IF FTYPE("TXT_AP024_Trans_Num")="U" DO AC002_Test_Var_Input
IF FTYPE("TXT_AP024_Created_Mon")="U" DO AC002_Test_Var_Input
IF FTYPE("TXT_AP024_Mon")="U" DO AC002_Test_Var_Input
IF FTYPE("%trg_VMF%")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF%.FIL")<=0  Errmsg=Errmsg+" AP024"
IF FTYPE("%trg_VMF%")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF%.FIL")<=0  ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="AP024"

OPEN %trg_VMF%
DELETE FIELD Months OK
DEFINE FIELD Months COMPUTED 

AGE( _Data_Range_Start_Date,_RptRunDate)/30 IF ISBLANK(DATE(Max_Inv_Dt))
AGE( Max_Inv_Dt,_RptRunDate)/30

ASSIGN sFilter="Vndr_Sts='A' AND AP_Vnd_InvGst_Sum.COUNT <=VALUE('%TXT_AP024_Trans_Num%',0)"

IF INCLUDE(TXT_AP024_Mon,"0123456789")<>"" sFilter=ALLTRIM(sFilter)+"AND Months<=VALUE('%TXT_AP024_Mon%',0)"
IF INCLUDE(TXT_AP024_Created_Mon,"0123456789")<>"" sFilter=ALLTRIM(sFilter)+"AND Created_Dt<=CTOD(DATE(_RptRunDate-VALUE('%TXT_AP024_Created_Mon%',0)*30),'DD/MM/YYYY')"
SET FILTER TO %sFilter%
EXTRACT Months AP_Vnd_InvGst_Sum.COUNT AS 'Trans_Num' AP_Vnd_InvGst_Sum.Inv_Amt AP_Vnd_InvGst_Sum.GST_Amt %v_flds_VMF% TO "%fld_Tmps%TMP1" OPEN

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_Site_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ZONED(Trans_Num,10)+"~"+ALLTRIM(Vndr_Site_ID),1,85)
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ZONED(Months,5)+ZONED(Inv_Amt,15)+ALLTRIM(Vndr_Site_ID),1,40)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Trans_Num Low_Months Total_Inv_Amt Vndr_Site_ID D"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "L"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP024. Identify Low activity vendor <%TXT_AP024_Trans_Num% transactions (vendor created date >=%TXT_AP024_Created_Mon% months)"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP2" OPEN
SET FOLDER /%fld_Results%
SORT ON Trans_Num SORT_KEY D TO "%fld_Results%AP024_Low_Act_Vnd" OPEN

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    VM012_Inac_xx_Mon                  
[PARENT_FOLDER_ID] 1340167398
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Vendor Master File Exception Tests
COMM *** VM012. List vendors that have been made inactive in the last x months
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_VMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_VMF")="U" DO AA002_Variable_Setting
IF FTYPE("%trg_VMF%")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF%.FIL")<=0 ESCAPE
IF FTYPE("TXT_VM012_Mon")="U" DO AC002_Test_Var_Input

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%
v_TestNo="VM012"

OPEN VMF_Vnd_Master_File

EXTRACT FIELDS %v_flds_VMF% IF NOT ISBLANK(DATE(Vndr_InvlDt)) AND Vndr_InvlDt>=CTOD(DATE(_RptRunDate- VALUE(INCLUDE(TXT_VM012_Mon,'1234567890'),0)*30),"DD/MM/YYYY") TO "%fld_Tmps%TMP1" OPEN

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_Site_ID),1,85)

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP_Vnd" OPEN

COMM *** VM012D. Identify invoices with Inv_Dt >=Vndr_InvlDt ***
INDEX ON Vndr_Site_ID TO IDX_TMP_Vnd_VndrSiteID

OPEN AP_Invoices
DEFINE RELATION Vndr_Site_ID WITH TMP_Vnd INDEX IDX_TMP_Vnd_VndrSiteID

SORT ON Vndr_ID c_Inv_Dt D IF Inv_Amt <> 0.00 AND NOT ISBLANK(TMP_Vnd.Vndr_ID) AND NOT ISBLANK(DATE(TMP_Vnd.Vndr_InvlDt)) AND (Inv_Dt >= TMP_Vnd.Vndr_InvlDt) TO "%fld_Tmps%TMP_VndD" OPEN

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+ALLTRIM(c_Inv_Dt),1,30)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Vndr_ID Inv_Date"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "L"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
CTOD(DATE(_RptRunDate- VALUE(ALLTRIM(TXT_VM012_Mon),0)*30),"DD/MM/YYYY")


DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "VM012D. Identify transactions by inactive vendors where Inv_Dt >= InActive Date"

SET FOLDER /%fld_Results%

SUMMARIZE ON Vndr_Site_ID SUBTOTAL GST_Amt Inv_Amt TO "%fld_Results%TMP_VndD_Sum.FIL" OPEN PRESORT
INDEX ON Vndr_Site_ID TO IDX_TMP_VndD_Sum_VndrSiteID

SET FOLDER /%fld_Tmps%

OPEN TMP_Vnd
DEFINE RELATION Vndr_Site_ID WITH TMP_VndD_Sum INDEX IDX_TMP_VndD_Sum_VndrSiteID

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ALLTRIM(ZONED(TMP_VndD_Sum.Inv_Amt,12))+ALLTRIM(Vndr_ID)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Total_InvAmt_Pst_InActDt Vndr_ID"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "L"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate  

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "VM012. Identify vendors that have been made inactive in the last %TXT_VM012_Mon% months"

SORT ON SORT_KEY D TO "%fld_Tmps%TMP_VM" OPEN
DEFINE RELATION Vndr_Site_ID WITH TMP_VndD_Sum INDEX IDX_TMP_VndD_Sum_VndrSiteID

COMM *** Finalize results ***
SET FOLDER /%fld_Results%
OPEN TMP_VM
DEFINE RELATION Vndr_Site_ID WITH VMF_Vnd_Master_File INDEX IDX_VndrSiteID
EXTRACT FIELDS TMP_VndD_Sum.Inv_Amt TMP_VndD_Sum.GST_Amt TMP_VndD_Sum.COUNT %v_flds_VMF% Priority TEST_NAME RptRunDate SORT_KEY SORT_KEY_Desc TO "%fld_Results%VM012_Inac_xx_Mon" OPEN
INDEX ON Vndr_Site_ID TO IDX_VM012_VndrSiteID
  
OPEN TMP_VndD
EXTRACT FIELDS %v_flds_AP_Inv% Priority TEST_NAME RptRunDate Data_Range_Start_Date Data_Range_End_Date SORT_KEY SORT_KEY_Desc TO "%fld_Results%VM012D_Inac_%TXT_VM012_Mon%_Mon" OPEN
DEFINE RELATION Vndr_Site_ID WITH VM012_Inac_xx_Mon INDEX IDX_VM012_VndrSiteID

OPEN AP_Invoices
DELETE RELATION TMP_Vnd OK


DELETE FORMAT TMP_Vnd OK
DELETE "%fld_Tmps%TMP_Vnd.FIL" OK
DELETE FORMAT TMP_VM OK
DELETE "%fld_Tmps%TMP_VM.FIL" OK
DELETE FORMAT TMP_VndD_Sum OK
DELETE "%fld_Tmps%TMP_VndD_Sum.FIL" OK
DELETE FORMAT TMP_VndD OK
DELETE "%fld_Tmps%TMP_VndD.FIL" OK

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    EA001_Menu                         
[PARENT_FOLDER_ID] 1340167410
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Employee Master File Exception Tests
COMM *** Menu 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("_Version")="v" OR FTYPE("fld_Workings")="U" DO AA002_Variable_Setting

Errmsg=""
SET SAFETY OFF
SET DATE "DD/MM/YYYY"

%v_CCMJob% IF FTYPE("%trg_EMF%")<>"y" OR FILESIZE("%fld_Workings%%trg_EMF%.FIL")<=0  PAUSE "Employee master file is empty, please make sure you have imported and converted the source file into EVA first."
IF FTYPE("%trg_EMF%")<>"y" OR FILESIZE("%fld_Workings%%trg_EMF%.FIL")<=0  ESCAPE

v_Exc_History=F

ASSIGN CHK_TEST_EMF=T

COMM *** DIALOG ***
IF FILESIZE("Dialogs\Dialog_EA001_Menu.txt") <=0 ESCAPE
DELETE SCRIPT Dialog_EA001_Menu OK
%v_CCMJob% DO "Dialogs\Dialog_EA001_Menu.txt"
DELETE SCRIPT Dialog_EA001_Menu OK



IF RAD_EM=1 v_Exc_History=F
IF RAD_EM=2 v_Exc_History=T

IF CHK_EM_ALL=T DO EA004_CHK_All_T

IF CHK_EM001=T DO EM001_Dup_TFN

IF CHK_EM002=T DO EM002_Dup_BnkAcc

IF CHK_EM003=T DO EM003_Dup_Nme

IF CHK_EM004=T DO EM004_Dup_Add

IF CHK_EM005=T DO EM005_Dup_Tel

IF CHK_EM006=T DO EM006_Mis_Details

IF CHK_EM007=T DO EM007_StartDt_Bf_DOB

IF CHK_EM008=T DO EM008_unKnown_CstCtr

IF CHK_EM009=T DO EM009_TFN_Invld_Frmt

IF CHK_EM010=T DO EM010_TFN_Valid

IF CHK_EM011=T DO EM011_BnkAcc_Valid

IF CHK_EM012=T DO EM012_DOB_Valid

IF CHK_EM013=T DO EM013_StartDt_Valid

IF CHK_EM014=T DO EM014_Tmp_No_EndDt

IF CHK_EM015=T DO EM015_Not_Taken_Leave

IF CHK_EM016=T DO EM016_TooMuch_SickLv

IF CHK_EM017=T DO EM017_Neg_SickLv

COMM Jeffrey Alvin 12/04/2013 Modified to capture any error message.
%v_CCMJob% IF NOT ISBLANK(Errmsg) PAUSE "Employee Master File Exception Tests have been run, but some tests haven't been processed because of missing source data:" + Errmsg
%v_CCMJob% IF ISBLANK(Errmsg) PAUSE "Employee Master File Exception Tests have been run successfully."

^BATCH    EA004_CHK_All_T                    
[PARENT_FOLDER_ID] 1340167410
CHK_EM001=T
CHK_EM002=T
CHK_EM003=T
CHK_EM004=T
CHK_EM005=T
CHK_EM006=T
CHK_EM007=T
CHK_EM008=T
CHK_EM009=T
CHK_EM010=T
CHK_EM011=T
CHK_EM012=T
CHK_EM013=T
CHK_EM014=T
CHK_EM015=T
CHK_EM016=T
CHK_EM017=T
^BATCH    CB003_Imp_EM                       
[PARENT_FOLDER_ID] 1341537122
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** User can customize data after importing source data
COMM *** Prepare the data for the mapping/conversion  -- Employee Master File 
COMM *** DATE: 10/10/2012
COMM***************************************************************************


IF FTYPE("fld_Sources")="U" OR FTYPE("fld_Data")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Sources%

COMM *** Deduction Codes ***
IMPORT PRINT TO DeductionCodes "%fld_Sources%DeductionCodes.FIL" FROM "%fld_Data%DeductionCodes.TXT" 0 RECORD "Detail" 0 1 0 TEST 0 0 AT 1,71,0 7 "." FIELD "CODE" C AT 1,4 SIZE 6,1 DEC 0 WID 6 FB PIC "" AS "" FIELD "DESCRIPTION" C AT 1,11 SIZE 27,1 DEC 0 WID 27  PIC "" AS "" FIELD "SHORT_NAME" C AT 1,38 SIZE 14,1 DEC 0 WID 14  PIC "" AS "" FIELD "CATEG" C AT 1,52 SIZE 7,1 DEC 0 WID 7  PIC "" AS "" FIELD "AMT_TYPE" C AT 1,59 SIZE 4,1 DEC 0 WID 4  PIC "" AS "" FIELD "AMOUNT" X AT 1,63 SIZE 14,1 DEC 5 WID 12  PIC "-9,999,999.99999" AS "" FIELD "ACCOUNT_TYPE" C AT 1,82 SIZE 1,1 DEC 0 WID 1  PIC "" AS "" FIELD "ACCOUNT" C AT 1,89 SIZE 20,1 DEC 0 WID 20  PIC "" AS "" FIELD "PTY" C AT 1,110 SIZE 1,1 DEC 0 WID 1  PIC "" AS "" FIELD "EXT_DEST" C AT 1,116 SIZE 1,1 DEC 0 WID 1  PIC "" AS "" FIELD "INC_TAX" C AT 1,123 SIZE 1,1 DEC 0 WID 1  PIC "" AS "" FIELD "PERC_BASE" C AT 1,129 SIZE 2,1 DEC 0 WID 2  PIC "" AS "" 

COMM *** Allowance Codes ***
IMPORT PRINT TO AllowanceCodes "%fld_Sources%AllowanceCodes.FIL" FROM "%fld_Data%AllowanceCodes.TXT" 0 RECORD "Detail" 0 1 0 TEST 0 0 AT 1,54,0 7 "." FIELD "CODE" C AT 1,1 SIZE 5,1 DEC 0 WID 5  PIC "" AS "" FIELD "DESCRIPTION" C AT 1,6 SIZE 25,1 DEC 0 WID 25  PIC "" AS "" FIELD "SHORT_NAME" C AT 1,31 SIZE 11,1 DEC 0 WID 11  PIC "" AS "" FIELD "CATEGORY" C AT 1,42 SIZE 3,1 DEC 0 WID 1  PIC "" AS "" FIELD "AMT" X AT 1,49 SIZE 11,1 DEC 2 WID 11  PIC "-9,999,999.99999" AS "" FIELD "AMT_TYPE" C AT 1,62 SIZE 3,1 DEC 0 WID 3  PIC "" AS "" FIELD "ACC_TYPE" C AT 1,67 SIZE 1,1 DEC 0 WID 1  PIC "" AS "" FIELD "ACCOUNT" C AT 1,70 SIZE 18,1 DEC 0 WID 18  PIC "" AS "" FIELD "SUPER_SALARY" C AT 1,91 SIZE 6,1 DEC 0 WID 6  PIC "" AS "" FIELD "GROSS" C AT 1,101 SIZE 2,1 DEC 0 WID 2  PIC "" AS "" FIELD "INCOME_TAX" C AT 1,108 SIZE 1,1 DEC 0 WID 1  PIC "" AS "" FIELD "PAY_TAX" C AT 1,113 SIZE 1,1 DEC 0 WID 1  PIC "" AS "" FIELD "LVLD_SAL" C AT 1,119 SIZE 1,1 DEC 0 WID 1  PIC "" AS "" FIELD "PAID_ON_LVE" C AT 1,124 SIZE 1,1 DEC 0 WID 1  PIC "" AS "" FIELD "ALW_TYPE" C AT 1,131 SIZE 1,1 DEC 0 WID 1  PIC "" AS "" 

COMM *** OCS Account Code ***
IMPORT EXCEL TO OCS_Account_Codes "%fld_Sources%OCS_Account_Codes.fil" FROM "%fld_Data%Ocs_Account_Codes.xls" TABLE "Account_Codes$" KEEPTITLE FIELD "Ocs_Account_Code" C WID 5 AS "" FIELD "Desc" C WID 109 AS "" FIELD "F3" C WID 10 AS ""


COMM *** Employee TFN and Bank Accounts ***
IMPORT EXCEL TO EMF_Bank_Master_Data "%fld_Sources%EMF_Bank_Master_Data.fil" FROM "%fld_Data%EMF Bank Master Data.xlsx" TABLE "SAH BnkDet Final$" FIELD "Emp_Number" C WID 28 AS "" FIELD "Tax_File_Number" C WID 9 AS "" FIELD "BSB_Details" C WID 40 AS "" FIELD "BSB_Number" C WID 7 AS "" FIELD "Bank_Acct_Number" C WID 12 AS "" FIELD "Bnk_Ded" C WID 9 AS "" FIELD "Last_Day_of_Service" D WID 10 PIC "DD-MMM-YY" AS ""

COMM *** Employee Master File ***
IMPORT DELIMITED TO Employee_Master_Rpt "%fld_Sources%Employee_Master_Rpt.fil" FROM "%fld_Data%employee_master.txt" 0 SEPARATOR TAB QUALIFIER NONE CONSECUTIVE STARTLINE 1 KEEPTITLE FIELD "Employee_Identifier" C AT 1 DEC 0 WID 19 PIC "" AS "" FIELD "Surname" C AT 20 DEC 0 WID 11 PIC "" AS "" FIELD "First_Given_Name" C AT 31 DEC 0 WID 16 PIC "" AS "" FIELD "Gender_Code" C AT 47 DEC 0 WID 11 PIC "" AS "" FIELD "Birth_Date" D AT 58 DEC 0 WID 10 PIC "  YYYYMMDD" AS "" FIELD "Postal_Address_Line_1" C AT 68 DEC 0 WID 22 PIC "" AS "" FIELD "Postal_Address_Line_2" C AT 90 DEC 0 WID 10 PIC "" AS "" FIELD "Postal_State" C AT 100 DEC 0 WID 12 PIC "" AS "" FIELD "Postal_Post_Code" C AT 112 DEC 0 WID 16 PIC "" AS "" FIELD "Termination_Date" D AT 128 DEC 0 WID 16 PIC "  YYYYMMDD" AS "" FIELD "Termination_Reason_Description" C AT 144 DEC 0 WID 10 PIC "" AS "" FIELD "Position_Description" C AT 154 DEC 0 WID 30 PIC "" AS "" FIELD "Cal_Year_Month" C AT 184 DEC 0 WID 14 PIC "" AS "" FIELD "Position_Number" C AT 198 DEC 0 WID 15 PIC "" AS "" FIELD "Public_Service_Start_Date" D AT 213 DEC 0 WID 25 PIC "  YYYYMMDD" AS "" FIELD "Employee_Position_Start_Date" D AT 238 DEC 0 WID 28 PIC "  YYYYMMDD" AS "" FIELD "Employee_Position_End_Date" D AT 266 DEC 0 WID 26 PIC "  YYYYMMDD" AS "" FIELD "Employment_Status_Code_Descript" C AT 292 DEC 0 WID 34 PIC "" AS "" FIELD "Occupancy_Code" C AT 326 DEC 0 WID 14 PIC "" AS "" FIELD "Annual_Salary_Amount" N AT 340 DEC 2 WID 20 PIC "" AS "" FIELD "Leave_Group_Description" C AT 360 DEC 0 WID 24 PIC "" AS "" FIELD "Employee_Salary_Start_Date" D AT 384 DEC 0 WID 26 PIC "  YYYYMMDD" AS "" FIELD "Org_Level_2_Description" C AT 410 DEC 0 WID 26 PIC "" AS "" FIELD "Postal_Location_Name" C AT 436 DEC 0 WID 20 PIC "" AS "" FIELD "Home_Email_Address" C AT 456 DEC 0 WID 30 PIC "" AS "" FIELD "Home_Mobile_Phone_Number" C AT 486 DEC 0 WID 24 PIC "" AS "" FIELD "Work_Email_Address" C AT 510 DEC 0 WID 33 PIC "" AS "" FIELD "Work_Mobile_Phone_Number" C AT 543 DEC 0 WID 24 PIC "" AS "" 

COMM *** Employee Leaves
IMPORT DELIMITED TO EmplLeaveRequest "%fld_Sources%EmplLeaveRequest.fil" FROM "%fld_Data%EmplLeaveRequest.del" 0 SEPARATOR "," QUALIFIER '"' CONSECUTIVE STARTLINE 1 KEEPTITLE FIELD "EmployeeCode" C AT 1 DEC 0 WID 71 PIC "" AS "" FIELD "RequestDate" D AT 72 DEC 0 WID 19 PIC "DD/MM/YYYY" AS "" FIELD "LeaveType" C AT 91 DEC 0 WID 47 PIC "" AS "" FIELD "LeaveCreditCode" C AT 138 DEC 0 WID 15 PIC "" AS "" FIELD "ReasonCode" C AT 153 DEC 0 WID 10 PIC "" AS "" FIELD "StartDate" D AT 163 DEC 0 WID 10 PIC "DD/MM/YYYY" AS "" FIELD "EndDate" D AT 173 DEC 0 WID 10 PIC "DD/MM/YYYY" AS "" FIELD "UnitsRequested" N AT 183 DEC 2 WID 14 PIC "" AS "" FIELD "TypeOfUnits" C AT 197 DEC 0 WID 11 PIC "" AS "" FIELD "ApprovedByCode" C AT 208 DEC 0 WID 14 PIC "" AS "" FIELD "ApprovedDate" D AT 222 DEC 0 WID 12 PIC "DD/MM/YYYY" AS "" FIELD "ProcessedDate" D AT 234 DEC 0 WID 13 PIC "DD/MM/YYYY" AS "" FIELD "ModifiedDate" D AT 247 DEC 0 WID 12 PIC "DD/MM/YYYY" AS "" FIELD "ModifiedTime" N AT 259 DEC 2 WID 12 PIC "" AS "" FIELD "LastUser" C AT 271 DEC 0 WID 9 PIC "" AS "" FIELD "Module" C AT 280 DEC 0 WID 6 PIC "" AS "" FIELD "WorkflowLeaveID" N AT 286 DEC 0 WID 15 PIC "" AS "" FIELD "Notes" C AT 301 DEC 0 WID 100 PIC "" AS "" FIELD "EmplLeaveRequestID" N AT 401 DEC 0 WID 18 PIC "" AS "" FIELD "WAPCode" C AT 419 DEC 0 WID 10 PIC "" AS "" FIELD "StartTime" N AT 429 DEC 0 WID 9 PIC "" AS "" 


SET SAFETY ON
^BATCH    CA003_Imp_PR_EM_Main               
[PARENT_FOLDER_ID] 1341537122
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** User can customize data after importing source data
COMM *** Prepare the data for the mapping/conversion  -- Main Script
COMM *** Created by Nancy ON 30/07/2012 
COMM***************************************************************************

IF FTYPE("_Version")="v" OR FTYPE("_Version")="U" OR FTYPE("fld_Sources")="U" OR FTYPE("fld_DataMapping")="U" DO AA002_Variable_Setting

SET DATE "DD/MM/YYYY"

COMM *** Importing Payroll and Employee Master File ***

DO CB003_Imp_EM

DO CB004_Imp_PR

DO CB005_Pre_PR_EM


^FOLDER   DataMapping                         1427250162
[PARENT_FOLDER_ID] 0
^FOLDER   GreyList                            1427252735
[PARENT_FOLDER_ID] 0
^FOLDER   Results                             1427252816
[PARENT_FOLDER_ID] 0
^BATCH    AP015_Mul_Trans_OneTim_Vnd         
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION FOR CCM (AX)
COMM *** AP015.Identify multiple transactions against the same one-time vendor 
COMM *** As in normal, client uses special vendor number to lodge all invoices for all one time vendors(e.g. Tech One uses 9999 or 4999, SAP uses BSEC), to identify one time vendor, should look at relevant fields such as sub vendor name, address, bank account ect. depends on business logics from client.  here, created the standard test for Finance/Tech One, SAP individually. if for other system, need to refer to the scope spec doc.
COMM *** Upgraded by Nancy Li (0431 057 135) on 23/03/2015
COMM***************************************************************************

v_ERP=""

COMM *** Tech One /Finance One ***
IF v_ERP="TechOne" DO AP015_Mul_Trans_OneTim_Vnd_F1

COMM *** SAP ***
IF v_ERP="SAP" DO AP015_Mul_Trans_OneTim_Vnd_SAP

COMM *** other ***
v_ERP="" AP015_Mul_Trans_OneTim_Vnd
^BATCH    EM016_TooMuch_SickLv               
[PARENT_FOLDER_ID] 1340167410
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Employee Master File Exception Tests
COMM *** EM016.taken too much sick leave>10 days 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 10/09/2014
COMM***************************************************************************
IF FTYPE("v_flds_EMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_EMF")="U" DO AA002_Variable_Setting
IF FTYPE("EMF_Leaves")<>"y" OR FILESIZE("%fld_Workings%EMF_Leaves.FIL")<=0 ESCAPE
IF FTYPE("EMF_TMP_Emp")<>"y" OR FILESIZE("%fld_Workings%EMF_TMP_Emp.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%
v_TestNo="EM016"
IF FTYPE("TXT_EM016_Mths")="U" TXT_EM016_Mths="12"
IF ISBLANK(TXT_EM016_Mths) TXT_EM016_Mths="12"
IF FTYPE("TXT_EM016_SLvDays")="U" TXT_EM016_SLvDays="10"
IF ISBLANK(TXT_EM016_SLvDays) TXT_EM016_SLvDays="10"
IF FTYPE("TXT_EM016_LeaveCodes")="U" TXT_EM016_LeaveCodes="'SICK'"

COMM *** Get Sick Leave Codes ***
OPEN EMF_Leaves

SET FILTER TO MATCH(LeaveType,%TXT_EM016_LeaveCodes%)
SORT ON Co_Emp_ID EndDate D TO "%fld_Tmps%TMP4" OPEN

COMM *** have not taken any annual leave within 12 months ***
OPEN TMP4
DEFINE RELATION Co_Emp_ID WITH EMF_TMP_Emp INDEX IDX_EMF_Co_Emp_ID

COMM *** logic is based on the Employee Anniversary Date/Hire Date for the current and previous year ***
DELETE FIELD c_Hire_Dt ok
DEFINE FIELD c_Hire_Dt COMPUTED 

SUBSTR(ALLTRIM(EMF_TMP_Emp.c_Hire_Dt),1,4) +"0301" IF SUBSTR(EMF_TMP_Emp.c_Hire_Dt,5,4)="0229"
EMF_TMP_Emp.c_Hire_Dt

DELETE FIELD AnnYear1 OK
DEFINE FIELD AnnYear1 COMPUTED 

_RptRunDate -365 IF ISBLANK(c_Hire_Dt)
CTOD(SUBSTR(ALLTRIM(DATE(_RptRunDate-365)),7,4) +SUBSTR(c_Hire_Dt,5,4),'YYYYMMDD') IF CTOD(SUBSTR(ALLTRIM(DATE(_RptRunDate)),7,4) +SUBSTR(c_Hire_Dt,5,4),'YYYYMMDD')>_RptRunDate 
CTOD(SUBSTR(ALLTRIM(DATE(_RptRunDate)),7,4) +SUBSTR(c_Hire_Dt,5,4),'YYYYMMDD') 

DELETE FIELD AnnYear2 OK
DEFINE FIELD AnnYear2 COMPUTED 

_RptRunDate -365*2 IF ISBLANK(c_Hire_Dt)
CTOD(SUBSTR(ALLTRIM(DATE(_RptRunDate-365*2)),7,4) +SUBSTR(c_Hire_Dt,5,4),'YYYYMMDD') IF CTOD(SUBSTR(ALLTRIM(DATE(_RptRunDate)),7,4) +SUBSTR(c_Hire_Dt,5,4),'YYYYMMDD')>_RptRunDate
CTOD(SUBSTR(ALLTRIM(DATE(_RptRunDate-365)),7,4) +SUBSTR(c_Hire_Dt,5,4),'YYYYMMDD')

DELETE FIELD AnnYear1_Lv_Days_Taken OK
DEFINE FIELD AnnYear1_Lv_Days_Taken COMPUTED 

Units/7.60 IF BETWEEN(StartDate,AnnYear1,_RptRunDate) OR BETWEEN(EndDate,AnnYear1,_RptRunDate)
0.00

DELETE FIELD AnnYear2_Lv_Days_Taken OK
DEFINE FIELD AnnYear2_Lv_Days_Taken COMPUTED 

Units/7.60 IF BETWEEN(StartDate,AnnYear2,AnnYear1) OR BETWEEN(EndDate,AnnYear2,AnnYear1-1)
0.00

DELETE FIELD AnnYear1_Cal_Days_Taken OK
DEFINE FIELD AnnYear1_Cal_Days_Taken COMPUTED 

AGE(StartDate,EndDate)+1 IF BETWEEN(StartDate,AnnYear1,_RptRunDate) OR BETWEEN(EndDate,AnnYear1,_RptRunDate)
0

DELETE FIELD AnnYear2_Cal_Days_Taken OK
DEFINE FIELD AnnYear2_Cal_Days_Taken COMPUTED 

AGE(StartDate,EndDate)+1 IF BETWEEN(StartDate,AnnYear2,AnnYear1) OR BETWEEN(EndDate,AnnYear2,AnnYear1-1)
0.00

SUMMARIZE ON Co_Emp_ID SUBTOTAL AnnYear1_Lv_Days_Taken AnnYear1_Cal_Days_Taken AnnYear2_Lv_Days_Taken AnnYear2_Cal_Days_Taken OTHER LeaveType AS 'Lv_Code' AnnYear1 AnnYear2 TO  "%fld_Tmps%TMP1.FIL" OPEN PRESORT

INDEX ON Co_Emp_ID TO IDX_TMP1

OPEN EMF_TMP_Emp
DEFINE RELATION Co_Emp_ID WITH TMP1 INDEX IDX_TMP1

COMM ***  apply logics***
EXTRACT FIELDS TMP1.Lv_Code TMP1.AnnYear1_Lv_Days_Taken TMP1.AnnYear1_Cal_Days_Taken TMP1.AnnYear2_Lv_Days_Taken TMP1.AnnYear2_Cal_Days_Taken TMP1.AnnYear1 TMP1.AnnYear2 ALL IF  Emp_Sts="A" AND (TMP1.AnnYear1_Lv_Days_Taken>VALUE(TXT_EM016_SLvDays,2) OR TMP1.AnnYear2_Lv_Days_Taken>VALUE(TXT_EM016_SLvDays,2)) TO "%fld_Tmps%TMP2" OPEN

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ZONED(AnnYear1_Cal_Days_Taken,8)+'~'+ZONED(AnnYear1_Cal_Days_Taken,8),1,85)

COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED _RptRunDate 

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED SUBSTR("EM016. Identify employees who have taken too many sick leave (>%TXT_EM016_SLvDays%Days) in recent Anniversary Year 1 or Year 2.",1,120)

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ZONED(AnnYear1_Cal_Days_Taken,8)+'~'+ZONED(AnnYear1_Cal_Days_Taken,8),1,40)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Lv_Days_Taken Emp_No"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN
INDEX ON Co_Emp_ID TO IDX_TMP10

COMM *** details report ***
OPEN TMP4
DEFINE RELATION Co_Emp_ID WITH TMP10 INDEX IDX_TMP10
DEFINE RELATION Co_Emp_ID WITH EMF_TMP_Emp INDEX IDX_EMF_Co_Emp_ID

DELETE FIELD ExceptionAnnYear OK
DEFINE FIELD ExceptionAnnYear COMPUTED 

"AnnYear12" IF (TMP10.AnnYear1_Lv_Days_Taken>VALUE(TXT_EM016_SLvDays,0) AND AnnYear1_Lv_Days_Taken<>0.00) AND (TMP10.AnnYear2_Lv_Days_Taken>VALUE(TXT_EM016_SLvDays,0) AND AnnYear2_Lv_Days_Taken<>0.00)
"AnnYear1" IF (TMP10.AnnYear1_Lv_Days_Taken>VALUE(TXT_EM016_SLvDays,0) AND AnnYear1_Lv_Days_Taken<>0.00)
"AnnYear2" IF (TMP10.AnnYear2_Lv_Days_Taken>VALUE(TXT_EM016_SLvDays,0) AND AnnYear2_Lv_Days_Taken<>0.00)
BLANKS(10)

SET FILTER TO TMP10.Co_Emp_ID=Co_Emp_ID AND ((TMP10.AnnYear1_Lv_Days_Taken>VALUE(TXT_EM016_SLvDays,0) AND AnnYear1_Lv_Days_Taken<>0.00) OR (TMP10.AnnYear2_Lv_Days_Taken>VALUE(TXT_EM016_SLvDays,0) AND AnnYear2_Lv_Days_Taken<>0.00))
EXTRACT FIELDS ALL %v_flds_EMF1% TO  "%fld_Tmps%TMP5" OPEN

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED _RptRunDate 

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED SUBSTR("EM016D. Identify employees who have taken too many sick leave (>%TXT_EM016_SLvDays%Days) in recent Anniversary Year 1 or Year 2 - Details",1,120)

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+'~'+SUBSTR(ALLTRIM(DATE(StartDate)),7,4)+SUBSTR(ALLTRIM(DATE(StartDate)),4,2)+SUBSTR(ALLTRIM(DATE(StartDate)),1,2),1,30)

DELETE FIELD c_Notes OK
DEFINE FIELD c_Notes COMPUTED INCLUDE(Notes,"01234567890ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz ,;/-[])(*&^%$#@!~;:'?")

COMM *** Finalize the results ***
SET FOLDER /%fld_Results%
OPEN TMP10
SORT ON SORT_KEY D TO "%fld_Results%EM016_Too_Much_SickLv" OPEN

OPEN TMP5
SORT ON SORT_KEY D TO "%fld_Results%EM016D_Too_Much_SickLv" OPEN

COMM *** Delete the temperary files***
OPEN EMF_TMP_Emp
DELETE RELATION TMP1 OK


DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    EM017_Neg_SickLv                   
[PARENT_FOLDER_ID] 1340167410
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Employee Master File Exception Tests
COMM *** EM016.Identify active employee with Negative sick leave 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 31/10/2014
COMM***************************************************************************
IF FTYPE("v_flds_EMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_EMF")="U" DO AA002_Variable_Setting
IF FTYPE("EMF_TMP_Emp")<>"y" OR FILESIZE("%fld_Workings%EMF_TMP_Emp.FIL")<=0 ESCAPE
IF FTYPE("EMF_Leaves")<>"y" OR FILESIZE("%fld_Workings%EMF_Leaves.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%
v_TestNo="EM016"
IF FTYPE("TXT_ThreadholdHours")="U" TXT_ThreadholdHours="-0.01"
IF ISBLANK(TXT_ThreadholdHours) TXT_ThreadholdHours="-0.01"
IF FTYPE("TXT_EM017_LeaveCodes")="U" TXT_EM017_LeaveCodes="'SICK'"

COMM *** get employees with negative sick leave balance ***
OPEN EMF_TMP_Emp
SET FILTER TO EMP_Sts ="A" AND SLTotalUnits<%TXT_ThreadholdHours%
EXTRACT FIELDS %v_flds_EMF% TO "%fld_Tmps%TMP1" OPEN 
INDEX ON Co_Emp_ID TO IDX_TMP1 

DELETE FIELD HiredDays OK
DEFINE FIELD HiredDays COMPUTED  AGE(Hire_Dt,_RptRunDate) -1

DELETE FIELD TtlSLHrs_Entitled OK
DEFINE FIELD TtlSLHrs_Entitled COMPUTED  HiredDays*2.92/14.00
 
COMM *** Get Sick Leave details ***
OPEN EMF_Leaves

DEFINE RELATION Co_Emp_ID WITH TMP1 INDEX IDX_TMP1

SET FILTER TO Co_Emp_ID=TMP1.Co_Emp_ID AND MATCH(LeaveType,%TXT_EM017_LeaveCodes%) 
EXTRACT FIELDS ALL TO "%fld_Tmps%TMP2" OPEN

DELETE FIELD c_EndDate OK
DEFINE FIELD c_EndDate COMPUTED DATE(EndDate,"YYYYMMDD") 

SORT ON Co_Emp_ID c_EndDate D TO "%fld_Tmps%TMP3" OPEN
INDEX ON Co_Emp_ID TO IDX_TMP3

SUMMARIZE ON Co_Emp_ID SUBTOTAL Units AS 'TtlSLHrs_Taken' TO "%fld_Tmps%TMP4" OPEN
INDEX ON Co_Emp_ID TO IDX_TMP4

OPEN TMP1
DEFINE RELATION Co_Emp_ID WITH TMP3 INDEX IDX_TMP3
DEFINE RELATION Co_Emp_ID WITH TMP4 INDEX IDX_TMP4

EXTRACT FIELDS TMP4.TtlSLHrs_Taken TMP3.StartDate TMP3.EndDate TMP3.ApprovedByCode TMP3.ApprovedDate TMP3.Notes ALL TO "%fld_Tmps%TMP5" OPEN

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+'~'+ZONED(ABS(SLTotalUnits),8)+'~'+DATE(EndDate,'YYYYMMDD'),1,85)

COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD c_Notes OK
DEFINE FIELD c_Notes COMPUTED INCLUDE(Notes,"01234567890ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz ,;/-[])(*&^%$#@!~;:'?")

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED _RptRunDate 

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED SUBSTR("EM016. Identify active employees with negative sick leave (threadhoud hours>%TXT_ThreadholdHours% Hours)",1,120)

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ID_KEY

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Lv_Hrs_Balance Lst_Lv_Dt"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN
INDEX ON Emp_ID TO IDX_TMP10

COMM *** details report ***
OPEN TMP3
DEFINE RELATION Co_Emp_ID WITH TMP10 INDEX IDX_TMP10
DEFINE RELATION Co_Emp_ID WITH EMF_TMP_Emp INDEX IDX_EMF_Co_Emp_ID

SET FILTER TO TMP10.Co_Emp_ID=Co_Emp_ID 
EXTRACT FIELDS %v_flds_EMF1% ALL TO  "%fld_Tmps%TMP6" OPEN

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED _RptRunDate 

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED SUBSTR("EM016D. Identify active employees with negative sick leave (threadhoud hours>%TXT_ThreadholdHours% Hours) - Details",1,120)

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(EMP_ID)+'~'+DATE(StartDate,'YYYYMMDD'),1,30)

DELETE FIELD c_Notes OK
DEFINE FIELD c_Notes COMPUTED INCLUDE(Notes,"01234567890ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz ,;/-[])(*&^%$#@!~;:'?")

COMM *** Finalize the results ***
SET FOLDER /%fld_Results%
OPEN TMP10
SORT ON SORT_KEY D TO "%fld_Results%EM016_Neg_SickLv" OPEN

OPEN TMP6
SORT ON SORT_KEY D TO "%fld_Results%EM016D_Neg_SickLv" OPEN


COMM *** Delete the temperary files***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    CB005_Pre_PR_EM                    
[PARENT_FOLDER_ID] 1341537122
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** User can customize data after importing source data
COMM *** Prepare the data for the mapping/conversion  -- Payroll, Employee Master and its Bank Accounts
COMM *** DATE: 10/10/2012
COMM***************************************************************************


IF FTYPE("fld_Sources")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET FOLDER /%fld_Sources%
SET DATE "DD/MM/YYYY"

COMM *** Employee Master Bank Accounts ***
OPEN EMF_Bank_Master_Data
DELETE FIELD ID OK
DEFINE FIELD ID COMPUTED RECNO()

EXTRACT FIELDS Emp_Number Tax_File_Number BSB_Details BSB_Number Bnk_Ded Bank_Acct_Number Last_Day_of_Service IF ID>4 TO "%fld_Sources%Employee_TFN_BankAccounts" OPEN

DELETE FIELD Employee_ID OK
DEFINE FIELD Employee_ID COMPUTED SUBSTR(ALLTRIM(Emp_Number),1,20)

INDEX ON Employee_ID TO IDX_TMP_BK_EMPID

OPEN Employee_Master_Rpt
DELETE FIELD Employee_ID OK
DEFINE FIELD Employee_ID COMPUTED SUBSTR(ALLTRIM(Employee_Identifier),1,20)
DELETE FIELD EMP_Sts OK
DEFINE FIELD EMP_Sts COMPUTED 
"Employee Status"
"I" IF NOT ISBLANK(DATE(Termination_Date)) AND Termination_Date <=_CurrentDate+365
"A"
DEFINE RELATION Employee_ID WITH Employee_TFN_BankAccounts INDEX IDX_TMP_BK_EMPID
DELETE FIELD Tax_File_Number OK
DEFINE FIELD Tax_File_Number COMPUTED SUBSTR(ALLTRIM(Employee_TFN_BankAccounts.Tax_File_Number),1,20)

COMM *** Payroll ***
OPEN OCS_Account_Codes
DELETE FIELD c_Ocs_Account_Code OK
DEFINE FIELD c_Ocs_Account_Code COMPUTED SUBSTR(Ocs_Account_Code,1,7)

INDEX ON c_Ocs_Account_Code TO IDX_OCS_ACC_CD
SET FOLDER /%fld_Tmps%

OPEN SAH_Payroll
DELETE FIELD Employee_No OK
DEFINE FIELD Employee_No COMPUTED SUBSTR(chris_employee_id,1,20)

SUMMARIZE ON posting_period SUBTOTAL entered_cr entered_dr hours_worked TO "%fld_Tmps%TMP_PAYROLL_SUM.FIL" PRESORT

DELETE FIELD c_Ocs_Account_Code OK
DEFINE FIELD c_Ocs_Account_Code COMPUTED SUBSTR(ocs_account_code,1,7)

DEFINE RELATION c_Ocs_Account_Code WITH OCS_Account_Codes INDEX IDX_OCS_ACC_CD

COMM *** Allowance Codes & Deduction Codes ***
OPEN AllowanceCodes
EXTRACT FIELDS SUBSTR(ALLTRIM(CODE),1,10) AS 'CODE' SUBSTR(ALLTRIM(DESCRIPTION),1,30) AS 'DESCRIPTION' SUBSTR(ALLTRIM(SHORT_NAME),1,20) AS 'SHORT_NAME' SUBSTR(ALLTRIM(AMT_TYPE),1,4) AS 'AMT_TYPE' BLANK(2) AS 'PERC_BASE' SUBSTR(ALLTRIM(ACCOUNT),1,20) AS 'ACCOUNT' IF NOT ISBLANK(CODE) TO %fld_Tmps%TMP1 

OPEN DeductionCodes
EXTRACT FIELDS SUBSTR(ALLTRIM(CODE),1,10) AS 'CODE' SUBSTR(ALLTRIM(DESCRIPTION),1,30) AS 'DESCRIPTION' SUBSTR(ALLTRIM(SHORT_NAME),1,20) AS 'SHORT_NAME' SUBSTR(ALLTRIM(AMT_TYPE),1,4) AS 'AMT_TYPE' SUBSTR(ALLTRIM(PERC_BASE),1,2) AS 'PERC_BASE' SUBSTR(ALLTRIM(ACCOUNT),1,20) AS 'ACCOUNT' IF NOT ISBLANK(CODE) TO %fld_Tmps%TMP1 APPEND 

SET FOLDER /%fld_Sources%
OPEN TMP1
SUMMARIZE ON CODE DESCRIPTION SHORT_NAME ACCOUNT PERC_BASE TO "%fld_Sources%PR_AllowDedu_Codes.FIL" OPEN PRESORT
INDEX ON CODE TO IDX_AllowDedu_Code

OPEN SAH_Payroll
DELETE FIELD c_Code OK
DEFINE FIELD c_Code COMPUTED SUBSTR(allowance_code,1,10)

DELETE FIELD CostCenter OK
DEFINE FIELD CostCenter COMPUTED SUBSTR(ALLTRIM(ocs_service_code)+ALLTRIM(ocs_unit_code)+ALLTRIM(original_cost_centre_code),1,20)

DELETE FIELD c_CostCenter OK
DEFINE FIELD c_CostCenter COMPUTED 

"" IF ALLTRIM(REPLACE(CostCenter,"0",""))=""
CostCenter

DELETE FIELD UKEY OK
DEFINE FIELD UKEY COMPUTED ZONED(RECNO(),10)

DEFINE RELATION c_Code WITH PR_AllowDedu_Codes INDEX IDX_AllowDedu_Code

SET FOLDER /%fld_Sources%
EXTRACT FIELDS ALL OCS_Account_Codes.Desc AS 'OscAccount_Code_Desc' PR_AllowDedu_Codes.DESCRIPTION AS 'Allow_Code_Desc' PR_AllowDedu_Codes.PERC_BASE AS 'Deduction_Perc_Base' SUBSTR(ALLTRIM(OCS_Account_Codes.Desc) +'; '+ ALLTRIM(PR_AllowDedu_Codes.DESCRIPTION),1,60) AS 'Line_Desc' IF NOT ISBLANK(Employee_No) AND (SUBSTR(ALLTRIM(ocs_account_code),1,1)="7" OR entered_dr<>0.00) TO "%fld_Sources%PR_Payroll_Run_File" OPEN

SUMMARIZE ON Employee_No c_CostCenter TO "%fld_Tmps%TMP2.FIL" OPEN PRESORT
INDEX ON Employee_No TO IDX_TMP2
OPEN Employee_Master_Rpt
DEFINE RELATION Employee_ID WITH TMP2 INDEX IDX_TMP2

SET FOLDER /%fld_Sources%
OPEN Employee_Master_Rpt
EXTRACT FIELDS ALL TMP2.c_CostCenter IF Employee_ID <> " " TO %fld_Sources%Employee_Master OPEN


COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON

^BATCH    VZ001_DeDup                        
[PARENT_FOLDER_ID] 1340167398
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Please use this for duplicate tests with multiple values per record 
COMM *** (e.g. address, bank account, name, etc.)
COMM *** 
COMM *** Sorting duplicates (based on total number of records in the duplicates)
COMM *** and removing multiple duplicates on the same duplicate group
COMM ***
COMM *** Input variable: v_Dupl_Table
COMM *** CREATED BY: ALVIN ANWAR FROM SATORI GROUP
COMM *** DATE: 16/02/2015
COMM***************************************************************************

IF FTYPE("v_Dupl_Table")<>"c" OR ISBLANK(v_Dupl_Table) OR FTYPE("%v_Dupl_Table%")<>"y" ESCAPE

COMM *** Get the total count of each duplicate group
OPEN %v_Dupl_Table%
SUMMARIZE ON DUP_KEY TO "%fld_Tmps%TMP_Dupl_Summ.FIL" OPEN PRESORT
INDEX ON DUP_KEY TO IDX_DUPKEY_Counter

COMM *** Sort the records based on total duplicate records (in desc order)
OPEN %v_Dupl_Table%
DEFINE RELATION DUP_KEY WITH TMP_Dupl_Summ INDEX IDX_DUPKEY_Counter
SORT ON TMP_Dupl_Summ.COUNT D DUP_KEY TO "%fld_Tmps%TMP_Dupl_SortSumm.FIL" OPEN
INDEX ON Vndr_ID TO IDX_Sorted_DUPKEY

COMM *** Get the alternative duplicate key of the record (the alt. duplicate key is based on the sorted duplicate records)
COMM *** This is to remove any repeated duplicate groups
OPEN %v_Dupl_Table%
DEFINE RELATION Vndr_ID WITH TMP_Dupl_SortSumm INDEX IDX_Sorted_DUPKEY
DUPLICATES ON DUP_KEY TMP_Dupl_SortSumm.DUP_KEY AS 'Main_DUP_KEY' OTHER Vndr_ID TO "%fld_Tmps%TMP_Dupl_Mult.FIL" IF DUP_KEY <> TMP_Dupl_SortSumm.DUP_KEY OPEN PRESORT
INDEX ON ALLTRIM(Vndr_ID)+'~'+ALLTRIM(DUP_KEY) TO IDX_Multiple_Dup
COMM *** Get the total records in the repeated duplicate groups
SUMMARIZE ON DUP_KEY TO "%fld_Tmps%TMP_Dupl_MultSumm.FIL" PRESORT OPEN
INDEX ON DUP_KEY TO IDX_Multiple_Dup_Cnt

COMM *** Only remove multiple duplicates if at least one alternative duplicate group consisting all duplicate records
OPEN %v_Dupl_Table%
DEFINE RELATION ALLTRIM(Vndr_ID)+'~'+ALLTRIM(DUP_KEY) WITH TMP_Dupl_Mult INDEX IDX_Multiple_Dup
DEFINE RELATION DUP_KEY WITH TMP_Dupl_MultSumm INDEX IDX_Multiple_Dup_Cnt
EXTRACT FIELDS ALL IF ISBLANK(TMP_Dupl_Mult.Main_DUP_KEY) OR TMP_Dupl_MultSumm.COUNT <> TMP_Dupl_Summ.COUNT TO "%fld_Tmps%TMP_Cleaned_Dupl.FIL" OPEN

EXTRACT FIELDS ALL TO "%fld_Tmps%%v_Dupl_Table%" OPEN

COMM *** Cleanup
COMM *** Tables cleanup
DELETE FORMAT TMP_Dupl_Summ OK
DELETE "%fld_Tmps%TMP_Dupl_Summ.FIL" OK
DELETE FORMAT TMP_Dupl_SortSumm OK
DELETE "%fld_Tmps%TMP_Dupl_SortSumm.FIL" OK
DELETE FORMAT TMP_Dupl_Mult OK
DELETE "%fld_Tmps%TMP_Dupl_Mult.FIL" OK
DELETE FORMAT TMP_Dupl_MultSumm OK
DELETE "%fld_Tmps%TMP_Dupl_MultSumm.FIL" OK

COMM *** Variables cleanup
DELETE v_Dupl_Table OK
^BATCH    VM017_Dup_Vnd_Email                
[PARENT_FOLDER_ID] 1340167398
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Vendor Master File Exception Tests
COMM *** VM017. Identify Duplicate Vendors by Email
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 03/08/2012
COMM***************************************************************************


IF FTYPE("v_flds_VMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_VMF")="U" DO AA002_Variable_Setting
IF FTYPE("%trg_VMF%")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF%.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%
v_TestNo="VM017"

OPEN VMF_Vnd_Master_File

EXTRACT FIELDS Vndr_Site_ID Vndr_ID Email1 AS "Email" IF NOT ISBLANK(Email1) AND FIND("@",Email1) AND Vndr_Sts="A"  TO "%fld_Tmps%TMP1" 
EXTRACT FIELDS Vndr_Site_ID Vndr_ID Email2 AS "Email" IF NOT ISBLANK(Email2) AND FIND("@",Email1) AND Vndr_Sts="A" TO "%fld_Tmps%TMP1" APPEND

OPEN TMP1
DELETE FIELD Email0 OK
DEFINE FIELD Email0 COMPUTED ALLTRIM(REPLACE(Email," ",";"))

DELETE FIELD Email1 OK
DEFINE FIELD Email1 COMPUTED trim(split(Email0,";",1))
DELETE FIELD Email2 OK
DEFINE FIELD Email2 COMPUTED trim(split(Email0,";",2))
DELETE FIELD Email3 OK
DEFINE FIELD Email3 COMPUTED trim(split(Email0,";",3))

EXTRACT FIELDS Vndr_Site_ID Vndr_ID Email IF OCCURS(Email0,";")=0 TO "%fld_Tmps%TMP2"
EXTRACT FIELDS Vndr_Site_ID Vndr_ID Email1 IF find("@",trim(EMAIL1)) and OCCURS(Email0,";")>0 TO "%fld_Tmps%TMP2" APPEND
EXTRACT FIELDS Vndr_Site_ID Vndr_ID Email2 IF find("@",trim(EMAIL2)) and OCCURS(Email0,";")>0 TO "%fld_Tmps%TMP2" APPEND
EXTRACT FIELDS Vndr_Site_ID Vndr_ID Email3 IF find("@",trim(EMAIL3)) and OCCURS(Email0,";")>0 TO "%fld_Tmps%TMP2" APPEND

OPEN TMP2
DELETE FIELD c_eMail
DEFINE FIELD c_eMail COMPUTED SUBSTR(ALLTRIM(INCLUDE(UPPER(Email),"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ@")),1,40)

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMMENT Fine for ACL 11
SUMMARIZE ON Vndr_ID c_eMail OTHER Vndr_Site_ID TO "%fld_Tmps%TMP3.FIL" OPEN PRESORT

DUPLICATES ON c_eMail OTHER Vndr_Site_ID Vndr_ID c_Email PRESORT IF FIND( "@",c_eMail ) TO "%fld_Tmps%TMP31.FIL" OPEN

DELETE FIELD DUP_KEY OK
DEFINE FIELD DUP_KEY COMPUTED ALLTRIM(c_eMail)

COMM *** Begin Clean Dup Bank Acc exists in dup Address ***
EXTRACT FIELDS Vndr_Site_ID FIRST 0 TO "%fld_Tmps%TMP_Dups"

IF FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil")>=0 AND (FILESIZE("%fld_History%VM001_History.fil") >0 AND FTYPE("VM001_History")="y") OPEN VM001_History
IF FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil")>=0 AND (FILESIZE("%fld_History%VM001_History.fil") <=0 OR FTYPE("VM001_History")<>"y") OPEN VM001_Dup_Vnd_BankAcc
IF FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil")>=0 AND (FTYPE("VM001_History")="y" OR FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil")>=0) EXTRACT Vndr_ID TO "%fld_Tmps%TMP_Dups" APPEND

IF FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil")>=0 AND (FILESIZE("%fld_History%VM002_History.fil") >0 AND FTYPE("VM002_History")="y") OPEN VM002_History
IF FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil")>=0 AND (FILESIZE("%fld_History%VM002_History.fil") <=0 OR FTYPE("VM002_History")<>"y") OPEN VM002_Dup_Vnd_ABN
IF FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil")>=0 AND (FTYPE("VM002_History")="y" OR FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil")>=0) EXTRACT Vndr_ID TO "%fld_Tmps%TMP_Dups" APPEND

IF FILESIZE("%fld_Results%VM003_Dup_Vnd_Add.fil")>=0 AND (FILESIZE("%fld_History%VM003_History.fil") >0 AND FTYPE("VM003_History")="y") OPEN VM003_History
IF FILESIZE("%fld_Results%VM003_Dup_Vnd_Add.fil")>=0 AND (FILESIZE("%fld_History%VM003_History.fil") <=0 OR FTYPE("VM003_History")<>"y") OPEN VM003_Dup_Vnd_Add
IF FILESIZE("%fld_Results%VM003_Dup_Vnd_Add.fil")>=0 AND (FTYPE("VM003_History")="y" OR FILESIZE("%fld_Results%VM003_Dup_Vnd_Add.fil")>=0) EXTRACT Vndr_ID TO "%fld_Tmps%TMP_Dups" APPEND

IF FILESIZE("%fld_Results%VM004_Dup_Vnd_Tel.fil")>=0 AND (FILESIZE("%fld_History%VM004_History.fil") >0 AND FTYPE("VM004_History")="y") OPEN VM004_History
IF FILESIZE("%fld_Results%VM004_Dup_Vnd_Tel.fil")>=0 AND (FILESIZE("%fld_History%VM004_History.fil") <=0 OR FTYPE("VM004_History")<>"y") OPEN VM004_Dup_Vnd_Tel
IF FILESIZE("%fld_Results%VM004_Dup_Vnd_Tel.fil")>=0 AND (FTYPE("VM004_History")="y" OR FILESIZE("%fld_Results%VM004_Dup_Vnd_Tel.fil")>=0) EXTRACT Vndr_ID TO "%fld_Tmps%TMP_Dups" APPEND

IF FILESIZE("%fld_Results%VM005_Dup_Vnd_Name.fil")>=0 AND (FILESIZE("%fld_History%VM005_History.fil") >0 AND FTYPE("VM005_History")="y") OPEN VM005_History
IF FILESIZE("%fld_Results%VM005_Dup_Vnd_Name.fil")>=0 AND (FILESIZE("%fld_History%VM005_History.fil") <=0 OR FTYPE("VM005_History")<>"y") OPEN VM005_Dup_Vnd_Name
IF FILESIZE("%fld_Results%VM005_Dup_Vnd_Name.fil")>=0 AND (FTYPE("VM005_History")="y" OR FILESIZE("%fld_Results%VM005_Dup_Vnd_Name.fil")>=0) EXTRACT Vndr_ID TO "%fld_Tmps%TMP_Dups" APPEND


OPEN TMP_Dups
INDEX ON Vndr_Site_ID TO IDX_VND_DUP_A

OPEN TMP31
DEFINE RELATION Vndr_Site_ID WITH TMP_Dups INDEX IDX_VND_DUP_A

SUMMARIZE ON DUP_KEY IF Vndr_Site_ID  <> TMP_Dups.Vndr_Site_ID  TO "%fld_Tmps%TMP32.FIL" OPEN PRESORT

INDEX ON DUP_KEY TO IDX_TMP32_Dup_KEY

OPEN TMP31
DEFINE RELATION DUP_KEY WITH TMP32 INDEX IDX_TMP32_Dup_KEY

EXTRACT FIELDS ALL IF DUP_KEY=TMP32.DUP_KEY TO "%fld_Tmps%TMP33" OPEN
DELETE FIELD Vnd_DUP_Key OK
DEFINE FIELD Vnd_DUP_Key COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+"~"+ALLTRIM(DUP_KEY),1,50)

COMM *** End clean***
INDEX ON Vnd_DUP_Key TO IDX_TMP33_VndrID

COMM *** Emilinate the duplicate dups ***
SUMMARIZE ON Vnd_DUP_Key OTHER DUP_KEY Vndr_ID Vndr_Site_ID TO "%fld_Tmps%TMP34.FIL" OPEN PRESORT
DEFINE RELATION Vnd_DUP_Key WITH TMP33 INDEX IDX_TMP33_VndrID
DEFINE RELATION Vndr_Site_ID WITH VMF_Vnd_Master_File INDEX IDX_VndrSiteID

EXTRACT FIELDS %v_flds_VMF% TMP33.DUP_KEY TMP33.c_Email IF NOT ISBLANK(TMP33.Vndr_ID) AND NOT ISBLANK(VMF_Vnd_Master_File.Vndr_Site_ID) TO "%fld_Tmps%TMP4" OPEN


COMM *** Start - eliminate the duplicate dups by Alvin  ***
v_Dupl_Table="TMP4"
DO VZ001_DeDup
COMM *** End - eliminate the duplicate dups by Alvin ***

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+"~"+ALLTRIM(DUP_KEY),1,85)

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
v_DUP_KEY="DUP_KEY"
v_Filter=""
IF v_Exc_History =T DO AE001_Dup_History
IF v_Chk_CCM=T DO AE006_Dup_CCM
COMM *** End ***

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP1" OPEN

COMM *** Identify the same or difference of the clean Vendor Number on the same dup ***
DUPLICATES ON DUP_KEY c_Vndr_ID OTHER Vndr_Site_ID Vndr_ID PRESORT OPEN TO "%fld_Tmps%TMP5.FIL"

INDEX ON DUP_KEY TO IDX_TMP5_DUP_KEY

COMM Should we OPEN TMP4 or OPEN TMP1 ???
OPEN TMP4
DEFINE RELATION DUP_KEY WITH TMP5 INDEX IDX_TMP5_DUP_KEY

DELETE FIELD Vndr_Same_Diff OK
DEFINE FIELD Vndr_Same_Diff COMPUTED 

"Y" IF DUP_KEY=TMP5.DUP_KEY
"N"

COMM *** Put the dup with difference clean Vendor Number on the Top of the report ***
DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_Same_Diff)+"~"+ALLTRIM(DUP_KEY)+"~"+ALLTRIM(Vndr_Site_ID) ,1,60)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Vndr_ID_Same_Diff Email_CLN Vndr_Site_ID"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "VM017. Identify Duplicate Vendors by Email"

SORT ON SORT_KEY TO "%fld_Tmps%TMP6" OPEN

COMM *** Finalize the results ***
SET FOLDER /%fld_Results%
EXTRACT FIELDS ALL TO "%fld_Results%VM017_Dup_Vnd_Email" OPEN
DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum IDX_AP_Sum_VndrID

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    PR006_Unusual_Super                
[PARENT_FOLDER_ID] 1340167415
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** PR006. Unusual superannuation contribution  where superannuation is < XX% of taxable income
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 28/10/2013
COMM***************************************************************************
IF FTYPE("Payroll_Payments")<>"y" ESCAPE
IF FTYPE("fld_Tmps")="U" OR FTYPE("v_flds_PR")="U" OR FTYPE("v_SuperPayCodes")="U" OR FTYPE("v_IsSuperablePayCodes")="U" DO AA002_Variable_Setting
IF FTYPE("TXT_PR006_SpRt")="U" DO  AC002_Test_Var_Input

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%
v_TestNo="PR006"

IF FTYPE("TXT_PR006_SpRt")="U" TXT_PR006_SpRt="9.5"
IF ISBLANK(v_SuperPayCodes) or ISBLANK(v_IsSuperablePayCodes) ESCAPE

COMM *** employee superable amount ***
OPEN Payroll_Payments
DEFINE RELATION Co_Emp_ID WITH EMF_TMP_Emp INDEX IDX_EMF_Co_Emp_ID

SET FILTER TO %v_IsSuperablePayCodes% 
SUMMARIZE ON RUNID_InPrd SUBTOTAL PayCode_Amount AS 'Ttl_SuperAmt' OTHER ALL %v_flds_EMF1% IF EMF_TMP_Emp.EMP_Sts <> "I" AND ABS(PayCode_Amount) > 0.00 TO "%fld_Tmps%TMP1.FIL" OPEN  PRESORT
INDEX ON RUNID_InPrd TO IDX_TMP1

COMM *** super company contrib ***
OPEN Payroll_Payments
DEFINE RELATION RUNID_InPrd WITH TMP1 INDEX IDX_TMP1

SET FILTER TO %v_SuperPayCodes% 
SUMMARIZE ON RUNID_InPrd SUBTOTAL PayCode_Amount AS 'Ttl_PayAmt' OTHER PayCode IF TMP1.Ttl_SuperAmt<>0.00 TO "%fld_Tmps%TMP2" OPEN PRESORT
INDEX ON RUNID_InPrd TO IDX_TMP2

OPEN TMP1
DEFINE RELATION RUNID_InPrd WITH TMP2 INDEX IDX_TMP2

DELETE FIELD Ttl_SuperPaidAmt OK
DEFINE FIELD Ttl_SuperPaidAmt COMPUTED  TMP2.Ttl_PayAmt

DELETE FIELD SGC_Pct OK
DEFINE FIELD SGC_Pct COMPUTED  

(DEC(Ttl_SuperPaidAmt,4)/DEC(Ttl_SuperAmt,4))*100.00 IF Ttl_SuperAmt<>0.00
100.00


COMM SET FILTER TO ABS(SGC_Pct) <= VALUE(TXT_PR006_SpRt,2) 
SET FILTER TO ABS(Ttl_SuperAmt)>0.00 AND ABS(Ttl_SuperPaidAmt) <= VALUE(TXT_PR006_SpRt,2) 
EXTRACT FIELDS TMP2.Ttl_PayAmt TMP2.PayCode ALL TO "%fld_Tmps%TMP3" OPEN

COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(RUNID_InPrd)+'~'+ZONED(Ttl_SuperAmt,15)+'~'+ZONED(COUNT,5),1,85)

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  DATE(_RptRunDate) 

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(ID_KEY),1,55)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Co_Emp_ID Period Ttl_SuperAmt Cnt"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  DATE(_PR_Data_Start_Date)

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  DATE(_PR_Data_End_Date)

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED SUBSTR(SUBSTR("PR006. Unusual superannuation contribution  where superannuation is %TXT_PR006_SpRt%% of taxable income ",1,90),1,120)

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN
INDEX ON RUNID_InPrd TO IDX_TMP10

OPEN Payroll_Payments
DEFINE RELATION RUNID_InPrd WITH TMP10 INDEX IDX_TMP10

SET FILTER TO %v_SuperPayCodes% OR %v_IsSuperablePayCodes%
EXTRACT FIELDS ALL %v_flds_EMF1% TMP10.RptRunDate TMP10.Data_Range_Start_Date TMP10.Data_Range_End_Date  IF NOT ISBLANK(TMP10.RUNID_InPrd) AND ABS(PayCode_Amount) > 0.00 TO "%fld_Tmps%TMP8" OPEN

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(RUNID_InPrd)+'~'+ALLTRIM(PayCode),1,60)

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED SUBSTR("PR006D. Unusual superannuation contribution  where superannuation is %TXT_PR006_SpRt%% of taxable income  - Details",1,120)

COMM *** Finalize the result***
SET FOLDER /%fld_Results%
OPEN TMP10
SORT ON SORT_KEY TO "%fld_Results%PR006_Unusual_Super" 

COMM *** RUNID_InPrd is the link key***
OPEN TMP8
SORT ON SORT_KEY D  TO "%fld_Results%PR006D_Unusual_Super" 

COMM *** delete the temperary files and relations ***
OPEN Payroll_Payments
DELETE RELATION TMP1 OK
DELETE RELATION TMP10 OK


DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    EM004_Dup_Add                      
[PARENT_FOLDER_ID] 1340167410
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Employee Master File Exception Tests
COMM *** EM004. Identify duplicate employees: by Address
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 05/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_EMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_EMF")="U" DO AA002_Variable_Setting
IF FTYPE("EMF_TMP_Emp")<>"y" OR FILESIZE("%fld_Workings%EMF_TMP_Emp.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Workings%

v_TestNo="EM004"

OPEN EMF_TMP_Emp
EXTRACT FIELDS Co_Emp_ID Emp_ID ADD1 ADD2 ADD3 Pcode State City Cntry IF LENGTH(ALLTRIM(CLEAN(ADD1+ADD2+ADD3)))>5 TO %fld_Workings%EMF_Address OPEN

SET FOLDER /%fld_Tmps%
OPEN EMF_Address
DEFINE RELATION Co_Emp_ID WITH EMF_TMP_Emp INDEX IDX_EMF_Co_Emp_ID

EXTRACT FIELDS ALL IF EMF_TMP_Emp.Emp_Sts="A" TO "%fld_Tmps%TMP_Address" OPEN

DELETE FIELD Add_ID OK
DEFINE FIELD Add_ID COMPUTED ALLTRIM(STRING(RECNO(),20))

INDEX ON Add_ID TO IDX_TMP_Address_Add_ID

DELETE FIELD c_Pcode OK
DEFINE FIELD c_Pcode COMPUTED 

"" IF LENGTH(trim(Pcode))<2
ALLTRIM(INCLUDE(Pcode, "0123456789"))

DELETE FIELD c_Add1 OK
DEFINE FIELD c_Add1 COMPUTED

REPLACE(UPPER(Add1), "STREET", " ST ") IF FIND("STREET", UPPER(Add1))
REPLACE(UPPER(Add1), "ROAD", " RD ") IF FIND("ROAD", UPPER(Add1))
REPLACE(UPPER(Add1), "AVENUE", " AVE ") IF FIND("AVENUE", UPPER(Add1))
REPLACE(UPPER(Add1), "CRESCENT", " CRES ") IF FIND("CRESCENT", UPPER(Add1))
REPLACE(UPPER(Add1), "DRIVE", " DR ") IF FIND("DRIVE", UPPER(Add1))
REPLACE(UPPER(Add1), "COURT", " CRT ") IF FIND("COURT", UPPER(Add1))
REPLACE(UPPER(Add1), "CIRCUIT", " CCT ") IF FIND("CIRCUIT", UPPER(Add1))
REPLACE(UPPER(Add1), "PLACE", " PL ") IF FIND("PLACE", UPPER(Add1))
UPPER(Add1)

DELETE FIELD c_Add1F OK
DEFINE FIELD c_Add1F COMPUTED 

"PO" IF FIND(" BAG ", c_Add1) OR FIND(" BOX ", c_Add1)  
"ST" IF FIND("HIGHWAY", c_Add1) OR FIND(" WAY", c_Add1) OR FIND(" ST ", c_Add1) OR FIND(" RD ", c_Add1) OR FIND(" AVE ", c_Add1) OR FIND(" CRES ", c_Add1) OR FIND(" DR ", c_Add1) OR FIND(" CRT ", c_Add1) OR FIND(" CCT ",c_Add1) OR FIND(" PL ", c_Add1)
" "

DELETE FIELD c_Add2 OK
DEFINE FIELD c_Add2 COMPUTED

REPLACE(UPPER(Add2), "STREET", " ST ") IF FIND("STREET", UPPER(Add2))
REPLACE(UPPER(Add2), "ROAD", " RD ") IF FIND("ROAD", UPPER(Add2))
REPLACE(UPPER(Add2), "AVENUE", " AVE ") IF FIND("AVENUE", UPPER(Add2))
REPLACE(UPPER(Add2), "CRESCENT", " CRES ") IF FIND("CRESCENT", UPPER(Add2))
REPLACE(UPPER(Add2), "DRIVE", " DR ") IF FIND("DRIVE", UPPER(Add2))
REPLACE(UPPER(Add2), "COURT", " CRT ") IF FIND("COURT", UPPER(Add2))
REPLACE(UPPER(Add2), "CIRCUIT", " CCT ") IF FIND("CIRCUIT", UPPER(Add2))
REPLACE(UPPER(Add2), "PLACE", " PL ") IF FIND("PLACE", UPPER(Add2))
UPPER(Add2)

DELETE FIELD c_Add2F OK
DEFINE FIELD c_Add2F COMPUTED 

"PO" IF FIND(" BAG ", c_Add2) OR FIND(" BOX ", c_Add2)  
"ST" IF FIND("HIGHWAY", c_Add2) OR FIND(" WAY", c_Add2) OR FIND(" ST ", c_Add2) OR FIND(" RD ", c_Add2) OR FIND(" AVE ", c_Add2) OR FIND(" CRES ", c_Add2) OR FIND(" DR ", c_Add2) OR FIND(" CRT ", c_Add2) OR FIND(" CCT ",c_Add2) OR FIND(" PL ", c_Add2)
" "

DELETE FIELD c_Add3 OK
DEFINE FIELD c_Add3 COMPUTED

REPLACE(UPPER(Add3), "STREET", " ST ") IF FIND("STREET", UPPER(Add3))
REPLACE(UPPER(Add3), "ROAD", " RD ") IF FIND("ROAD", UPPER(Add3))
REPLACE(UPPER(Add3), "AVENUE", " AVE ") IF FIND("AVENUE", UPPER(Add3))
REPLACE(UPPER(Add3), "CRESCENT", " CRES ") IF FIND("CRESCENT", UPPER(Add3))
REPLACE(UPPER(Add3), "DRIVE", " DR ") IF FIND("DRIVE", UPPER(Add3))
REPLACE(UPPER(Add3), "COURT", " CRT ") IF FIND("COURT", UPPER(Add3))
REPLACE(UPPER(Add3), "CIRCUIT", " CCT ") IF FIND("CIRCUIT", UPPER(Add3))
REPLACE(UPPER(Add3), "PLACE", " PL ") IF FIND("PLACE", UPPER(Add3))
UPPER(Add3)

DELETE FIELD c_Add3F OK
DEFINE FIELD c_Add3F COMPUTED 

"PO" IF FIND(" BAG ", c_Add3) OR FIND(" BOX ", c_Add3)  
"ST" IF FIND("HIGHWAY", c_Add3) OR FIND(" WAY", c_Add3) OR FIND(" ST ", c_Add3) OR FIND(" RD ", c_Add3) OR FIND(" AVE ", c_Add3) OR FIND(" CRES ", c_Add3) OR FIND(" DR ", c_Add3) OR FIND(" CRT ", c_Add3) OR FIND(" CCT ",c_Add3) OR FIND(" PL ", c_Add3)
" "

EXTRACT FIELDS Add_ID Co_Emp_ID Emp_ID c_Pcode SUBSTR(INCLUDE(c_Add1, "0123456789"),1,50) AS "Address" "PO" AS "Type" IF  c_Add1F="PO" TO "%fld_Tmps%TMP1" OPEN
OPEN TMP_Address
EXTRACT FIELDS Add_ID Co_Emp_ID Emp_ID c_Pcode SUBSTR(INCLUDE(c_Add2, "0123456789"),1,50) AS "Address" "PO" AS "Type" IF c_Add2F="PO" TO "%fld_Tmps%TMP1" OPEN APPEND
OPEN TMP_Address
EXTRACT FIELDS Add_ID Co_Emp_ID Emp_ID c_Pcode SUBSTR(INCLUDE(c_Add3, "0123456789"),1,50) AS "Address" "PO" AS "Type" IF c_Add3F="PO" TO "%fld_Tmps%TMP1" OPEN APPEND

OPEN TMP_Address
EXTRACT FIELDS Add_ID Co_Emp_ID Emp_ID c_Pcode SUBSTR(INCLUDE(c_Add1 +c_Add2+c_Add3,"QWERTYUIOPASDFGHJKLZXCVBNM0123456789"),1,50) AS "Address" "ST" AS "Type" IF c_Add1F<>"PO" AND c_Add2F<>"PO" AND c_Add3F<>"PO" TO "%fld_Tmps%TMP1" OPEN APPEND

OPEN TMP1

DELETE FIELD Add_KEY OK
DEFINE FIELD Add_KEY COMPUTED ALLTRIM(Co_Emp_ID)+ALLTRIM(c_Pcode) + ALLTRIM(Address)

INDEX ON Add_KEY TO IDX_TMP1_Add_KEY

SUMMARIZE ON Co_Emp_ID Add_KEY Emp_ID c_Pcode Address Type IF LENGTH(ALLTRIM(Address))>0 TO "%fld_Tmps%TMP10.FIL" OPEN PRESORT

COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

EXTRACT FIELDS ALL TO "%fld_Tmps%SUM_Address" OPEN

DUPLICATES ON Address c_Pcode OTHER Type Co_Emp_ID Emp_ID Address c_Pcode PRESORT IF Type = "PO" AND ALLTRIM(Address)<>"" OPEN TO "%fld_Tmps%TMP2.FIL"
OPEN SUM_Address
DUPLICATES ON Address c_Pcode OTHER Type Co_Emp_ID Emp_ID Address c_Pcode PRESORT IF Type <> "PO" AND ALLTRIM(Address)<>"" APPEND OPEN TO "%fld_Tmps%TMP2.FIL"

DELETE FIELD DUP_KEY OK
DEFINE FIELD DUP_KEY COMPUTED ALLTRIM(c_Pcode)+ALLTRIM(Address) 

DELETE FIELD Add_KEY OK
DEFINE FIELD Add_KEY COMPUTED ALLTRIM(Co_Emp_ID)+ALLTRIM(c_Pcode) + ALLTRIM(Address)

DEFINE RELATION Add_KEY WITH TMP1 INDEX IDX_TMP1_Add_KEY

EXTRACT FIELDS DUP_KEY Add_KEY Co_Emp_ID TMP1.Add_ID IF NOT ISBLANK(TMP1.Add_KEY) TO "%fld_Tmps%TMP3" OPEN
DEFINE RELATION Add_ID WITH TMP_Address INDEX IDX_TMP_Address_Add_ID

EXTRACT FIELDS DUP_KEY Add_KEY Co_Emp_ID TMP_Address.ADD1 TMP_Address.ADD2 TMP_Address.ADD3 TMP_Address.City TMP_Address.State TMP_Address.Pcode TMP_Address.Cntry TO "%fld_Tmps%TMP7" OPEN 

COMM *** Begin Clean Dup Bank Acc exists in dup Address ***
EXTRACT FIELDS Co_Emp_ID FIRST 0 TO "%fld_Tmps%TMP_Dups"

IF FILESIZE("%fld_Results%EM001_Dup_TFN.fil")>=0 AND (FILESIZE("%fld_History%EM001_History.fil") >0 AND FTYPE("EM001_History")="y") OPEN EM001_History
IF FILESIZE("%fld_Results%EM001_Dup_TFN.fil")>=0 AND (FILESIZE("%fld_History%EM001_History.fil") <=0 OR FTYPE("EM001_History")<>"y") OPEN EM001_Dup_TFN
IF FILESIZE("%fld_Results%EM001_Dup_TFN.fil")>=0 AND (FTYPE("EM001_History")="y" OR FILESIZE("%fld_Results%EM001_Dup_TFN.fil")>=0) EXTRACT FIELDS Co_Emp_ID TO "%fld_Tmps%TMP_Dups" APPEND

IF FILESIZE("%fld_Results%EM002_Dup_BnkAcc.fil")>=0 AND (FILESIZE("%fld_History%EM002_History.fil") >0 AND FTYPE("EM002_History")="y") OPEN EM002_History
IF FILESIZE("%fld_Results%EM002_Dup_BnkAcc.fil")>=0 AND (FILESIZE("%fld_History%EM002_History.fil") <=0 OR FTYPE("EM002_History")<>"y") OPEN EM002_Dup_BnkAcc
IF FILESIZE("%fld_Results%EM002_Dup_BnkAcc.fil")>=0 AND (FTYPE("EM002_History")="y" OR FILESIZE("%fld_Results%EM002_Dup_BnkAcc.fil")>=0) EXTRACT FIELDS Co_Emp_ID TO "%fld_Tmps%TMP_Dups" APPEND

IF FILESIZE("%fld_Results%EM003_Dup_Nme.fil")>=0 AND (FILESIZE("%fld_History%EM003_History.fil") >0 AND FTYPE("EM003_History")="y") OPEN EM003_History
IF FILESIZE("%fld_Results%EM003_Dup_Nme.fil")>=0 AND (FILESIZE("%fld_History%EM003_History.fil") <=0 OR FTYPE("EM003_History")<>"y") OPEN EM003_Dup_Nme
IF FILESIZE("%fld_Results%EM003_Dup_Nme.fil")>=0 AND (FTYPE("EM003_History")="y" OR FILESIZE("%fld_Results%EM003_Dup_Nme.fil")>=0) EXTRACT FIELDS Co_Emp_ID TO "%fld_Tmps%TMP_Dups" APPEND

OPEN TMP_Dups
INDEX ON Co_Emp_ID TO IDX_VND_DUP_A

OPEN TMP7
DEFINE RELATION Co_Emp_ID WITH TMP_Dups INDEX IDX_VND_DUP_A

SUMMARIZE ON DUP_KEY IF Co_Emp_ID  <> TMP_Dups.Co_Emp_ID  TO "%fld_Tmps%TMP8.FIL" OPEN PRESORT

OPEN TMP8
INDEX ON DUP_KEY TO IDX_TMP8_Dup_KEY

OPEN TMP7
DEFINE RELATION DUP_KEY WITH TMP8 INDEX IDX_TMP8_Dup_KEY

EXTRACT FIELDS ALL IF NOT ISBLANK(TMP8.DUP_KEY) TO "%fld_Tmps%TMP9" OPEN
COMM *** End clean***
INDEX ON Co_Emp_ID TO IDX_TMP
OPEN EMF_TMP_Emp
DEFINE RELATION Co_Emp_ID WITH TMP9 INDEX IDX_TMP

EXTRACT FIELDS %v_flds_EMF% TMP9.DUP_KEY TMP9.Add_KEY TMP9.ADD1 AS 'Dup_ADD1' TMP9.ADD2 AS 'Dup_ADD2' TMP9.ADD3 AS 'Dup_ADD3' TMP9.City AS 'Dup_City' TMP9.State AS 'Dup_State' TMP9.Pcode AS 'Dup_Pcode' TMP9.Cntry AS 'Dup_Cntry' BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN IF NOT ISBLANK(TMP9.Co_Emp_ID) AND NOT ISBLANK(EMF_TMP_Emp.Co_Emp_ID) TO "%fld_Tmps%TMP4" OPEN

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(DUP_KEY),1,85)

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
v_DUP_KEY="DUP_KEY"
v_Filter=""
IF v_Exc_History =T DO AE001_Dup_History
IF v_Chk_CCM=T DO AE006_Dup_CCM
COMM *** End ***

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP1" OPEN

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(DUP_KEY)+ZONED(Total_PayAmt,12)+ALLTRIM(Co_Emp_ID),1,52)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Name Total_PayAmt EmpCd"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  _RptRunDate 

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "EM004. Identify duplicate employees: by Address"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%EM004_Dup_Add" 

OPEN EMF_TMP_Emp
DELETE RELATION TMP9 OK

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp


SET SAFETY ON
^BATCH    EM003_Dup_Nme                      
[PARENT_FOLDER_ID] 1340167410
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Employee Master File Exception Tests
COMM *** EM003. Identify duplicate employees: by name
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 05/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_EMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_EMF")="U" DO AA002_Variable_Setting
IF FTYPE("EMF_TMP_Emp")<>"y" OR FILESIZE("%fld_Workings%EMF_TMP_Emp.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

OPEN EMF_TMP_Emp

v_TestNo="EM003"
COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

DELETE FIELD c_Emp_Nme OK
DEFINE FIELD c_Emp_Nme COMPUTED ALLTRIM(INCLUDE(UPPER(Emp_Nme),"ABCDEFGHIJKLMNOPQRSTUVWXYZ"))

DUPLICATES ON c_Emp_Nme OTHER %v_flds_EMF% BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN PRESORT IF Emp_Sts<>"I" AND c_Emp_Nme<>" " OPEN TO "%fld_Tmps%TMP1.FIL"

DELETE FIELD DUP_KEY OK
DEFINE FIELD DUP_KEY COMPUTED ALLTRIM(c_Emp_Nme)

COMM *** Begin Clean Dup Bank Acc exists in dup Address ***
EXTRACT FIELDS Co_Emp_ID FIRST 0 TO "%fld_Tmps%TMP_Dups"

IF FILESIZE("%fld_Results%EM001_Dup_TFN.fil")>=0 AND (FILESIZE("%fld_History%EM001_History.fil") >0 AND FTYPE("EM001_History")="y") OPEN EM001_History
IF FILESIZE("%fld_Results%EM001_Dup_TFN.fil")>=0 AND (FILESIZE("%fld_History%EM001_History.fil") <=0 OR FTYPE("EM001_History")<>"y") OPEN EM001_Dup_TFN
IF FILESIZE("%fld_Results%EM001_Dup_TFN.fil")>=0 AND (FTYPE("EM001_History")="y" OR FILESIZE("%fld_Results%EM001_Dup_TFN.fil")>=0) EXTRACT FIELDS Co_Emp_ID TO "%fld_Tmps%TMP_Dups" APPEND

IF FILESIZE("%fld_Results%EM002_Dup_BnkAcc.fil")>=0 AND (FILESIZE("%fld_History%EM002_History.fil") >0 AND FTYPE("EM002_History")="y") OPEN EM002_History
IF FILESIZE("%fld_Results%EM002_Dup_BnkAcc.fil")>=0 AND (FILESIZE("%fld_History%EM002_History.fil") <=0 OR FTYPE("EM002_History")<>"y") OPEN EM002_Dup_BnkAcc
IF FILESIZE("%fld_Results%EM002_Dup_BnkAcc.fil")>=0 AND (FTYPE("EM002_History")="y" OR FILESIZE("%fld_Results%EM002_Dup_BnkAcc.fil")>=0) EXTRACT FIELDS Co_Emp_ID TO "%fld_Tmps%TMP_Dups" APPEND

OPEN TMP_Dups
INDEX ON Co_Emp_ID TO IDX_VND_DUP_A

OPEN TMP1
DEFINE RELATION Co_Emp_ID WITH TMP_Dups INDEX IDX_VND_DUP_A

SUMMARIZE ON DUP_KEY IF Co_Emp_ID  <> TMP_Dups.Co_Emp_ID  TO "%fld_Tmps%TMP2.FIL" OPEN PRESORT

OPEN TMP2
INDEX ON DUP_KEY TO IDX_TMP2_Dup_KEY

OPEN TMP1
DEFINE RELATION DUP_KEY WITH TMP2 INDEX IDX_TMP2_Dup_KEY

EXTRACT FIELDS ALL IF NOT ISBLANK(TMP2.DUP_KEY) TO "%fld_Tmps%TMP4" OPEN
COMM *** End clean***

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(DUP_KEY),1,85)

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
v_DUP_KEY="DUP_KEY"
v_Filter=""
IF v_Exc_History =T DO AE001_Dup_History
IF v_Chk_CCM=T DO AE006_Dup_CCM
COMM *** End ***

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP1" OPEN

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(DUP_KEY)+ZONED(Total_PayAmt,12)+ALLTRIM(Co_Emp_ID),1,52)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Name Total_PayAmt EmpCd"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  _RptRunDate 

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "EM003. Identify duplicate employees: By Name"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%EM003_Dup_Nme" 

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    EM002_Dup_BnkAcc                   
[PARENT_FOLDER_ID] 1340167410
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Employee Master File Exception Tests
COMM *** EM002. Identify duplicate employees: by Bank Account
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 05/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_EMF_BK")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_EMF_BK")="U" DO AA002_Variable_Setting
IF FTYPE("%trg_EMF_BK%")<>"y" OR FILESIZE("%fld_Workings%%trg_EMF_BK%.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="EM002"

OPEN EMF_BnkAcc
DEFINE RELATION Co_Emp_ID WITH EMF_TMP_EMP INDEX IDX_EMF_Co_Emp_ID

EXTRACT FIELDS ALL IF EMF_TMP_EMP.Emp_Sts="A" TO "%fld_Tmps%TMP_BnkAcc" OPEN

DELETE FIELD c_Bank OK
DEFINE FIELD c_Bank COMPUTED ALLTRIM(INCLUDE(BSB,"0123456789"))+ALLTRIM(INCLUDE(Bnk_Acc_Num,"0123456789"))

DELETE FIELD Bnk_KEY OK
DEFINE FIELD Bnk_KEY COMPUTED ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(c_Bank)

INDEX ON Bnk_KEY TO IDX_EMF_BnkAcc_Bnk_KEY

COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

SUMMARIZE ON Co_Emp_ID c_Bank Bnk_KEY IF LENGTH(ALLTRIM(c_Bank))>3 AND VALUE(c_Bank,0)<>0   TO "%fld_Tmps%TMP1.FIL" OPEN PRESORT

INDEX ON Bnk_KEY TO IDX_TMP1_Bnk_KEY
DUPLICATES ON c_Bank OTHER Co_Emp_ID c_Bank Bnk_KEY PRESORT OPEN TO "%fld_Tmps%TMP2.FIL"

DELETE FIELD DUP_KEY OK
DEFINE FIELD DUP_KEY COMPUTED ALLTRIM(c_Bank)

DEFINE RELATION Bnk_KEY WITH TMP_BnkAcc INDEX IDX_EMF_BnkAcc_Bnk_KEY

EXTRACT FIELDS DUP_KEY Bnk_KEY Co_Emp_ID TMP_BnkAcc.Co_Emp_ID TMP_BnkAcc.BSB TMP_BnkAcc.Bnk_Acc_Num TMP_BnkAcc.BSB_NAME TMP_BnkAcc.Bnk_Acc_Name IF NOT ISBLANK(TMP_BnkAcc.Bnk_KEY) TO "%fld_Tmps%TMP3" OPEN

INDEX ON Co_Emp_ID TO IDX_TMP3
OPEN EMF_TMP_Emp
DEFINE RELATION Co_Emp_ID WITH TMP3 INDEX IDX_TMP3

EXTRACT FIELDS %v_flds_EMF% TMP3.DUP_KEY TMP3.Bnk_KEY Co_Emp_ID TMP3.BSB TMP3.Bnk_Acc_Num TMP3.BSB_NAME TMP3.Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN IF NOT ISBLANK(TMP3.Co_Emp_ID) TO "%fld_Tmps%TMP1" OPEN

COMM *** Begin Clean Dup Bank Acc exists in dup Address ***
EXTRACT FIELDS Co_Emp_ID FIRST 0 TO "%fld_Tmps%TMP_Dups"

IF FILESIZE("%fld_Results%EM001_Dup_TFN.fil")>=0 AND (FILESIZE("%fld_History%EM001_History.fil") >0 AND FTYPE("EM001_History")="y") OPEN EM001_History
IF FILESIZE("%fld_Results%EM001_Dup_TFN.fil")>=0 AND (FILESIZE("%fld_History%EM001_History.fil") <=0 OR FTYPE("EM001_History")<>"y") OPEN EM001_Dup_TFN
IF FILESIZE("%fld_Results%EM001_Dup_TFN.fil")>=0 AND (FTYPE("EM001_History")="y" OR FILESIZE("%fld_Results%EM001_Dup_TFN.fil")>=0) EXTRACT FIELDS Co_Emp_ID TO "%fld_Tmps%TMP_Dups" APPEND

OPEN TMP_Dups
INDEX ON Co_Emp_ID TO IDX_VND_DUP_A

OPEN TMP1
DEFINE RELATION Co_Emp_ID WITH TMP_Dups INDEX IDX_VND_DUP_A

SUMMARIZE ON DUP_KEY IF Co_Emp_ID  <> TMP_Dups.Co_Emp_ID  TO "%fld_Tmps%TMP2.FIL" OPEN PRESORT

OPEN TMP2
INDEX ON DUP_KEY TO IDX_TMP2_Dup_KEY

OPEN TMP1
DEFINE RELATION DUP_KEY WITH TMP2 INDEX IDX_TMP2_Dup_KEY

EXTRACT FIELDS ALL IF NOT ISBLANK(TMP2.DUP_KEY) TO "%fld_Tmps%TMP4" OPEN
COMM *** End clean***

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(DUP_KEY),1,85)

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
v_DUP_KEY="DUP_KEY"
v_Filter=""
IF v_Exc_History =T DO AE001_Dup_History
IF v_Chk_CCM=T DO AE006_Dup_CCM
COMM *** End ***

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP1" OPEN

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(DUP_KEY)+ZONED(Total_PayAmt,12)+ALLTRIM(Co_Emp_ID)1,52)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "BnkAcc Total_PayAmt Co_Emp_ID"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  _RptRunDate 

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "EM002. Identify duplicate employees: By Bank Account."

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%EM002_Dup_BnkAcc" 

OPEN EMF_TMP_Emp
DELETE RELATION TMP3 OK

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    EM001_Dup_TFN                      
[PARENT_FOLDER_ID] 1340167410
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Employee Master File Exception Tests
COMM *** EM001. Identify duplicate employees: by Tax File No.
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 05/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_EMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_EMF")="U" DO AA002_Variable_Setting
IF FTYPE("EMF_TMP_Emp")<>"y" OR FILESIZE("%fld_Workings%EMF_TMP_Emp.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%


OPEN EMF_TMP_Emp

v_TestNo="EM001"
COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

DELETE FIELD c_Tax_Fle_Num OK
DEFINE FIELD c_Tax_Fle_Num COMPUTED ALLTRIM(STRING(VALUE(INCLUDE(Tax_Fle_Num, "0123456789"),0),21))

DUPLICATES ON c_Tax_Fle_Num OTHER %v_flds_EMF% BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN PRESORT IF Emp_Sts<>"I" AND LENGTH(ALLTRIM(c_Tax_Fle_Num))>1  OPEN TO "%fld_Tmps%TMP_Dups.FIL" OPEN

DELETE FIELD DUP_KEY OK
DEFINE FIELD DUP_KEY COMPUTED ALLTRIM(Tax_Fle_Num)

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(DUP_KEY),1,85)

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
v_DUP_KEY="DUP_KEY"
v_Filter=""
IF v_Exc_History =T DO AE001_Dup_History
IF v_Chk_CCM=T DO AE006_Dup_CCM
COMM *** End ***

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP1" OPEN

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(DUP_KEY)+ZONED(Total_PayAmt,12)+ALLTRIM(Co_Emp_ID),1,52)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Tax_File_Num Total_PayAmt EmpCd"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  _RptRunDate 

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "EM001. Identify duplicate employees: By TFN."

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%EM001_Dup_TFN" 

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    EM007_StartDt_Bf_DOB               
[PARENT_FOLDER_ID] 1340167410
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Employee Master File Exception Tests
COMM *** EM007. Identify employees with start date before their date of birth
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_EMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_EMF")="U" DO AA002_Variable_Setting
IF FTYPE("EMF_TMP_Emp")<>"y" OR FILESIZE("%fld_Workings%EMF_TMP_Emp.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%
v_TestNo="EM007"

OPEN EMF_TMP_Emp
SET FILTER TO NOT ISBLANK(c_Hire_Dt)
COUNT
IF COUNT1=0 ESCAPE
EXTRACT FIELDS %v_flds_EMF% BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN IF Hire_Dt<=DOB TO %fld_Tmps%TMP1 OPEN

COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(c_Hire_Dt),1,85)
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP4" OPEN
DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ZONED(Total_PayAmt,12)+"~"+ALLTRIM(Co_Emp_ID),1,32)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Total_PayAmt Emp_ID "

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  _RptRunDate 

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "EM007. Identify employees with start date before their date of birth"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%EM007_StartDt_Bf_DOB" OPEN

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp


SET SAFETY ON
^BATCH    EM008_unKnown_CstCtr               
[PARENT_FOLDER_ID] 1340167410
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Employee Master File Exception Tests
COMM *** EM008. Identify employees with unknown cost centre / department
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_EMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_EMF")="U" DO AA002_Variable_Setting
IF FTYPE("EMF_TMP_Emp")<>"y" OR FILESIZE("%fld_Workings%EMF_TMP_Emp.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="EM008"

OPEN EMF_TMP_Emp

EXTRACT %v_flds_EMF% Total_PayAmt Total_Pay_Num Invalid_TFN IF Emp_Sts<>"I" AND ISBLANK(COST_CENTRE)  TO "%fld_Tmps%TMP1" OPEN

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID),1,85)

COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Co)+"~"+ALLTRIM(COST_CENTRE)+"~"+ALLTRIM(Emp_ID)+"~"+ALLTRIM(c_Hire_Dt),1,50)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Co COST_CENTRE Emp_ID Hired_Date"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  _RptRunDate

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "EM008. Identify employees with unknown cost centre / department"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY TO "%fld_Results%EM008_unKnown_CstCtr" OPEN

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    EM009_TFN_Invld_Frmt               
[PARENT_FOLDER_ID] 1340167410
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Employee Master File Exception Tests
COMM *** EM009. Identify Employees with Tax File No that does NOT conform with ATO algorithm
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_EMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_EMF")="U" DO AA002_Variable_Setting
IF FTYPE("EMF_TMP_Emp")<>"y" OR FILESIZE("%fld_Workings%EMF_TMP_Emp.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%
v_TestNo="EM009"

OPEN EMF_TMP_Emp

EXTRACT %v_flds_EMF% BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN c_Tax_Fle_Num IF Emp_Sts<>"I" AND LENGTH(ALLTRIM(c_Tax_Fle_Num))>1 AND (LENGTH(ALLTRIM(c_Tax_Fle_Num))<>9 OR Invalid_TFN="T" ) TO "%fld_Tmps%TMP1" OPEN

COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(c_Tax_Fle_Num),1,85)
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ZONED(Total_PayAmt,15)+"~"+ALLTRIM(COST_CENTRE)+"~"+ALLTRIM(Emp_ID)+"~"+ALLTRIM(c_Hire_Dt),1,45)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Total_PayAmt COST_CENTRE Emp_ID Hired_Date"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  _RptRunDate

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "EM009. Identify Employees with Tax File No that does NOT conform with ATO algorithm"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%EM009_TFN_Invld_Frmt" OPEN

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    EM010_TFN_Valid                    
[PARENT_FOLDER_ID] 1340167410
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Employee Master File Exception Tests
COMM *** EM010. Identify Employees with Tax File No that is: 
COMM *** . Blank TFN and or ( 11111111 the employment date is > 28 days)
COMM *** . the tax is not the marginal rate   (e.g. scale  42.5%)
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_EMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_EMF")="U" DO AA002_Variable_Setting
IF FTYPE("EMF_TMP_Emp")<>"y" OR FILESIZE("%fld_Workings%EMF_TMP_Emp.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="EM010"

OPEN EMF_TMP_Emp

COMM *** Blank TFN *** 
EXTRACT %v_flds_EMF% BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN c_Tax_Fle_Num SUBSTR("EM010. Tax File No. validation: Blank TFN",1,100) AS 'TEST_NAME' IF Emp_Sts<>"I" AND LENGTH(ALLTRIM(c_Tax_Fle_Num))<=1  TO "%fld_Tmps%TMP1" 

COMM *** Identify TFNs with incorrect character length*** 
EXTRACT %v_flds_EMF% BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN c_Tax_Fle_Num SUBSTR("EM010. Tax File No. validation: 11111111 the started date is >28 days",1,100) AS 'TEST_NAME' IF c_Tax_Fle_Num = "111111111" AND AGE(Hire_Dt,_RptRunDate)>28 TO "%fld_Tmps%TMP1" APPEND

OPEN TMP1

COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(c_Tax_Fle_Num),1,85)
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ZONED(Total_PayAmt,15)+"~"+ALLTRIM(COST_CENTRE)+"~"+ALLTRIM(Emp_ID)+"~"+ALLTRIM(c_Hire_Dt),1,45)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Total_PayAmt COST_CENTRE Emp_ID Hired_Date"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  _RptRunDate

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%EM010_TFN_Valid" OPEN

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    EM011_BnkAcc_Valid                 
[PARENT_FOLDER_ID] 1340167410
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EM011. Employee bank account validation:
COMM ***   If change data or 2 static master files over a period available 
COMM ***  More than x changes to employee bank account details over xx months 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_EMF_BK")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_EMF_BK")="U" DO AA002_Variable_Setting
IF FTYPE("%trg_EMF_BK%")<>"y" OR FILESIZE("%fld_Workings%%trg_EMF_BK%.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="EM011"
IF FTYPE("TXT_EM011_Months")="U" TXT_EM011_Months="3"
IF FTYPE("TXT_EM011_Chg_Times")="U" TXT_EM011_Chg_Times="2"

OPEN EMF_BnkAcc_Chg_History

IF FTYPE("TXT_EM011_Months")="U" DO AC002_Test_Var_Input
IF FTYPE("TXT_EM011_Chg_Times")="U" DO AC002_Test_Var_Input

SUMMARIZE ON Co_Emp_ID RptRunDateTime TO TMP11 OPEN

SUMMARIZE ON Co_Emp_ID IF CTOD(SUBSTR(RptRunDateTime,1,10),"DD/MM/YYYY") >= _RptRunDate- VALUE(ALLTRIM(TXT_EM011_Months),0)*30 TO "%fld_Tmps%TMP1.FIL" OPEN PRESORT
INDEX ON Co_Emp_ID TO IDX_TMP

OPEN EMF_BnkAcc_Chg_History
DEFINE RELATION Co_Emp_ID WITH TMP1 INDEX IDX_TMP

EXTRACT FIELDS ALL  TMP1.COUNT IF TMP1.COUNT>VALUE(ALLTRIM(TXT_EM011_Chg_Times),0) TO %fld_Tmps%TMP2 OPEN

COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ZONED(COUNT,6),1,85)
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(RptRunDateTime),1,40)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Co_Emp_ID RptRunDateTime"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "H"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_RptRunDate- VALUE(ALLTRIM(TXT_EM011_Months),0)*30


DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "EM011. Employee bank account details have been changed more than %TXT_EM011_Chg_Times% times in %TXT_EM011_Months% months"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /%fld_Results%

SORT ON SORT_KEY D TO "%fld_Results%EM011_BnkAcc_Valid" OPEN 
DEFINE RELATION Co_Emp_ID WITH EMF_TMP_Emp INDEX IDX_EMF_Co_Emp_ID

OPEN EMF_BnkAcc_Chg_History
DELETE RELATION TMP1 OK

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp
^BATCH    EM012_DOB_Valid                    
[PARENT_FOLDER_ID] 1340167410
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Employee Master File Exception Tests
COMM *** EM012. Date of birth and age validation: Blank date of birth, employee >70 years or employee < 16 years.
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_EMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_EMF")="U" DO AA002_Variable_Setting
IF FTYPE("EMF_TMP_Emp")<>"y" OR FILESIZE("%fld_Workings%EMF_TMP_Emp.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="EM012"

IF FTYPE("TXT_EM012_MaxAge")="U" TXT_EM012_MaxAge="70"
IF FTYPE("TXT_EM012_MinAge")="U" TXT_EM012_MinAge="16"

OPEN EMF_TMP_Emp

DELETE FIELD Ages OK
DEFINE FIELD Ages COMPUTED AGE(DOB,CTOD(DATE(),"DD/MM/YYYY"))/365

EXTRACT FIELDS ALL IF Emp_Sts="A" AND (Ages > VALUE(TRIM(TXT_EM012_MaxAge),0) OR Ages < VALUE(TRIM(TXT_EM012_MinAge),0) OR ISBLANK(DATE(DOB))) TO "%fld_Tmps%TMP1" OPEN

COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ZONED(Ages,6),1,85)
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ZONED(DEC(Total_PayAmt,0),12)+"~"+ ALLTRIM(Co)+"~"+ALLTRIM(COST_CENTRE)+"~"+ALLTRIM(Emp_ID)+"~"+ALLTRIM(c_Hire_Dt),1,50)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "PayAmt Co COST_CENTRE Emp_ID Hired_Date"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  _RptRunDate

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED SUBSTR("EM012. Date of birth and age validation: Blank date of birth, employee >%TXT_EM012_MaxAge% years or employee < %TXT_EM012_MinAge% years",1,120)

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%EM012_DOB_Valid" OPEN

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    EM013_StartDt_Valid                
[PARENT_FOLDER_ID] 1340167410
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Employee Master File Exception Tests
COMM *** EM013. Start date validation:Blank start date, start date<>birth date<>50 years, 
COMM ***        employment days <30 days a or employment days >15,000 days
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_EMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_EMF")="U" DO AA002_Variable_Setting
IF FTYPE("EMF_TMP_Emp")<>"y" OR FILESIZE("%fld_Workings%EMF_TMP_Emp.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="EM013"
IF FTYPE("TXT_EM013_MaxYear")="U" TXT_EM013_MaxYear="50"
IF FTYPE("TXT_EM013_EmpMinDays")="U" TXT_EM013_EmpMinDays="30"
IF FTYPE("TXT_EM013_EmpMaxDays")="U" TXT_EM013_EmpMaxDays="15000"

OPEN EMF_TMP_Emp

DELETE FIELD EmployAge OK
DEFINE FIELD EmployAge COMPUTED AGE( DOB,Hire_Dt )

DELETE FIELD EmployAge2 OK
DEFINE FIELD EmployAge2 COMPUTED AGE(Hire_Dt,CTOD(DATE(),"DD/MM/YYYY"))

EXTRACT FIELDS ALL IF Emp_Sts="A" AND (Hire_Dt<=DOB OR ISBLANK(DATE(Hire_Dt)) OR EmployAge/365 > VALUE(TRIM(TXT_EM013_MaxYear),0) OR EmployAge2 < VALUE(TRIM(TXT_EM013_EmpMinDays),0) OR EmployAge2 > VALUE(TRIM(TXT_EM013_EmpMaxDays),0)) TO "%fld_Tmps%TMP1" OPEN

COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ZONED(EmployAge2,3)+ZONED(EmployAge,3),1,85)
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ZONED(DEC(Total_PayAmt,0),12)+"~"+ ALLTRIM(Co)+"~"+ALLTRIM(COST_CENTRE)+"~"+ALLTRIM(Emp_ID)+"~"+ALLTRIM(c_Hire_Dt),1,50)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "PayAmt Co COST_CENTRE Emp_ID Hired_Date"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "L"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED _RptRunDate

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED SUBSTR("EM013. Start date validation:Blank start date, start date<>birth date>%TXT_EM013_MaxYear% years,employment days <%TXT_EM013_EmpMinDays% days a or employment days >%TXT_EM013_EmpMaxDays% days",1,150)

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY TO "%fld_Results%EM013_StarDt_Valid" OPEN

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    EM014_Tmp_No_EndDt                 
[PARENT_FOLDER_ID] 1340167410
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Employee Master File Exception Tests
COMM *** EM014. Identify employees in temporary position without end date
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_EMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_EMF")="U" DO AA002_Variable_Setting
IF FTYPE("EMF_TMP_Emp")<>"y" OR FILESIZE("%fld_Workings%EMF_TMP_Emp.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /Tmp_Files

v_TestNo="EM014"
comm *** No End Date information ***

OPEN EMF_TMP_Emp

SET FILTER TO Emp_Sts="A" AND NOT FIND("full time", Emp_Catg) AND NOT FIND("ONGOING",Emp_Catg) AND NOT FIND("PERM",Emp_Catg) 
EXTRACT FIELDS ALL IF ISBLANK(DATE(Trm_Dt)) TO "%fld_Tmps%TMP1" OPEN

COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID),1,85)

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ZONED(DEC(Total_PayAmt,0),12)+"~"+ ALLTRIM(Co)+"~"+ALLTRIM(COST_CENTRE)+"~"+ALLTRIM(Emp_ID)+"~"+ALLTRIM(c_Hire_Dt),1,50)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "PayAmt Co COST_CENTRE Emp_ID Hired_Date"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  DATE()

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "EM010A. Tax File No. validation: Blank TFN and tax%<45%"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /Results
SORT ON SORT_KEY TO "%fld_Results%EM014_Tmp_No_EndDt" OPEN

DELETE FORMAT TMP_EM010 OK
DELETE %fld_Tmps%TMP_EM010.FIL OK

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    EM015_Not_Taken_Leave              
[PARENT_FOLDER_ID] 1340167410
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Employee Master File Exception Tests
COMM *** EM015. List employees that have not taken any annual leave or sick leave
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************

IF FTYPE("v_flds_EMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_EMF")="U" DO AA002_Variable_Setting
IF FTYPE("EMF_Leaves")<>"y" OR FILESIZE("%fld_Workings%EMF_Leaves.FIL")<=0 ESCAPE
IF FTYPE("EMF_TMP_Emp")<>"y" OR FILESIZE("%fld_Workings%EMF_TMP_Emp.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%
v_TestNo="EM015"

COMM *** input: rolling Days/years?
IF FTYPE("TXT_EM015_Mths")="U" TXT_EM015_Mths="12"
IF ISBLANK(TXT_EM015_Mths) TXT_EM015_Mths="12"
IF FTYPE("TXT_EM015_LeaveCodes")="U" TXT_EM015_LeaveCodes="'ANNUAL'"

COMM *** have not taken any annual leave within 12 months ***
OPEN EMF_Leaves

SORT ON Co_Emp_ID EndDate D TO "%fld_Tmps%TMP1" OPEN
INDEX ON Co_Emp_ID TO IDX_TMP1

SET FILTER TO MATCH(LeaveType,%TXT_EM015_LeaveCodes%) AND (AGE(EndDate,_RptRunDate)<=30.0*VALUE(TXT_EM015_Mths,1) OR AGE(StartDate,_RptRunDate)<=30.0*VALUE(TXT_EM015_Mths,1))  
SUMMARIZE ON Co_Emp_ID SUBTOTAL Units AS 'Lv_Hrs_Taken'  AGE(StartDate,EndDate) AS 'Cal_Days_Taken' OTHER ALL TO  "%fld_Tmps%TMP2.FIL" OPEN PRESORT

DELETE FIELD Lv_Days_Taken OK
DEFINE FIELD Lv_Days_Taken COMPUTED Lv_Hrs_Taken/7.6

INDEX ON Co_Emp_ID TO IDX_TMP2

OPEN EMF_TMP_Emp
DEFINE RELATION Co_Emp_ID WITH TMP1 INDEX IDX_TMP1
DEFINE RELATION Co_Emp_ID WITH TMP2 INDEX IDX_TMP2

COMM ***  employee have been hired more than xx month ***
SET FILTER TO Emp_Sts="A" AND TMP2.Lv_Days_Taken<=0.00 AND Hire_Dt<_RptRunDate-30.0*VALUE(TXT_EM015_Mths,1)
EXTRACT FIELDS TMP2.Lv_Hrs_Taken TMP2.Lv_Days_Taken TMP2.Cal_Days_Taken TMP2.LeaveType AS 'Lv_Code' TMP2.LeaveTypeDesc TMP2.Cal_Days_Taken TMP1.StartDate AS 'Lst_Lv_StartDt' TMP1.EndDate AS 'Lst_Lv_EndDt' TMP1.LeaveType As 'Lst_LvCode' TMP1.Units AS 'Lst_LvHrs'  ALL  TO "%fld_Tmps%TMP3" OPEN

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ZONED(Lv_Days_Taken,8),1,85)

COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  _RptRunDate 

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED SUBSTR("EM015. Identify employees who have not taken any annual leave during a rolling %TXT_EM015_Mths% months period",1,100)

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ZONED(Lv_Days_Taken,8)+"~"+ALLTRIM(Co_Emp_ID),1,30)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Lv_Days_Taken Emp_No"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10.FIL" OPEN

COMM *** Finalize the results ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%EM015_Not_Taken_AL" OPEN


COMM *** Delete the temperary files***
OPEN EMF_TMP_Emp
DELETE RELATION TMP1 OK
DELETE RELATION TMP2 OK

DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    PR001_Mul_Paid                     
[PARENT_FOLDER_ID] 1340167415
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** PR001. Identify employees who received > one payment in the period
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************
IF FTYPE("Payroll_Payments")<>"y" OR FILESIZE("%fld_Workings%Payroll_Payments.fil")<=0 ESCAPE
IF FTYPE("v_PeriodGrossAmount")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="PR001"

OPEN Payroll_Payments

DEFINE RELATION Co_Emp_ID WITH EMF_TMP_Emp INDEX IDX_EMF_Co_Emp_ID

COMM *** find out duplicates ***
SET FILTER TO %v_PeriodGrossAmount%
DUPLICATES ON Co_Emp_ID c_Prd_Dt ABS_PayCode_Amount OTHER %v_flds_PR% %v_flds_EMF1% PRESORT IF ABS_PayCode_Amount<>0 OPEN TO "%fld_Tmps%TMP1.FIL"

OPEN TMP1
DELETE FIELD DUP_KEY OK
DEFINE FIELD DUP_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(PayCode)+"~"+ALLTRIM(c_Prd_Dt)+"~"+ALLTRIM(STRING(ABS_PayCode_Amount,21)),1,64)

COMM *** remove reversals ***
SUMMARIZE ON DUP_KEY SUBTOTAL PayCode_Amount TO "%fld_Tmps%TMP2.FIL" OPEN PRESORT

INDEX ON DUP_KEY TO IDX_TMP2

OPEN TMP1

DEFINE RELATION DUP_KEY WITH TMP2 INDEX IDX_TMP2
EXTRACT FIELDS ALL IF PayCode_Amount>0.01 TO %fld_Tmps%TMP3 OPEN

COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(DUP_KEY)+"~"+ALLTRIM(CO),1,85)

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
v_DUP_KEY="DUP_KEY"
v_Filter=""
IF v_Exc_History =T DO AE001_Dup_History
IF v_Chk_CCM=T DO AE006_Dup_CCM
COMM *** End ***

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ZONED(ABS_PayCode_Amount,15)+"~"+ALLTRIM(DUP_KEY),1,80)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Telephone Total_PayAmt EmpCd"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  DATE(_RptRunDate)

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  DATE(_PR_Data_Start_Date)

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  DATE(_PR_Data_End_Date)

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "PR001. Identify employees who received > one payment in the period"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%PR001_Mul_Paid" 

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp


SET SAFETY ON
^BATCH    PR002_Not_in_Emf                   
[PARENT_FOLDER_ID] 1340167415
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** PR002. Identify payments made to employees not in master file
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************
IF FTYPE("Payroll_Payments")<>"y" OR FILESIZE("%fld_Workings%Payroll_Payments.fil")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="PR002"

OPEN Payroll_Payments
DEFINE RELATION Co_Emp_ID WITH EMF_TMP_Emp INDEX IDX_EMF_Co_Emp_ID

EXTRACT FIELDS ALL IF ISBLANK(EMF_TMP_Emp.Co_Emp_ID) TO "%fld_Tmps%TMP1" OPEN

COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(c_Prd_Dt),1,85)
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Co)+"~"+ALLTRIM(Co_Emp_ID) +"~"+ALLTRIM(c_Prd_Dt)+"~"+ALLTRIM(ZONED(ABS_PAYCODE_AMOUNT,12)),1,52)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "BUSINESS Co_Emp_ID c_Prd_Dt ABS_PAYCODE_AMOUNT D"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "H"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  DATE(_RptRunDate) 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  DATE(_PR_Data_Start_Date)

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  DATE(_PR_Data_End_Date)

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "PR002. Identify payments made to employees not in master file"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%PR002_Not_in_Emf" 

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp


SET SAFETY ON
^BATCH    PR003_Pay_30D_Af_Trm               
[PARENT_FOLDER_ID] 1340167415
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** PR003.Identify payments to employees x days after termination date
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************
IF FTYPE("Payroll_Payments")<>"y" OR FILESIZE("%fld_Workings%Payroll_Payments.fil")<=0 ESCAPE
IF FTYPE("v_PeriodGrossAmount")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%
v_TestNo="PR003"
IF FTYPE("TXT_PR003_Days")="U" TXT_PR003_Days="30"

OPEN PayRoll_Payments
DEFINE RELATION Co_Emp_ID WITH EMF_TMP_Emp INDEX IDX_EMF_Co_Emp_ID

DELETE FIELD Trm_Prd_Days OK
DEFINE FIELD Trm_Prd_Days COMPUTED AGE(EMF_TMP_Emp.Trm_Dt,Prd_Dt)

SET FILTER TO %v_PeriodGrossAmount% 
EXTRACT FIELDS Trm_Prd_Days %v_flds_PR% %v_flds_EMF1% IF EMF_TMP_Emp.Emp_Sts = "I" AND Trm_Prd_Days > VALUE(ALLTRIM(TXT_PR003_Days),0) AND ABS_PAYCODE_AMOUNT<>0 TO "%fld_Tmps%TMP1" OPEN

COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(Co)+"~"+ALLTRIM(c_Prd_Dt),1,85)
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(Co)+"~"+ALLTRIM(COST_CENTRE)+"~"+ZONED(Trm_Prd_Days,5),1,40)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Co Emp_Code Cost_Centre Trm_Prd_Days"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  DATE(_RptRunDate)

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  DATE(_PR_Data_Start_Date)

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  DATE(_PR_Data_End_Date)

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "PR003.Identify payments to employees %TXT_PR003_Days% days after termination date"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY TO "%fld_Results%PR003_Pay_%TXT_PR003_Days%D_Aft_Trm" 

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    PR004_Spec_Leave_3Mon              
[PARENT_FOLDER_ID] 1340167415
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** PR004. Identify employees on special leave with pay for more than x months
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************
IF FTYPE("Payroll_Payments")<>"y" OR FILESIZE("%fld_Workings%Payroll_Payments.fil")<=0 ESCAPE
IF FTYPE("v_SpecialLeave")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%
v_TestNo="PR004"

IF FTYPE("TXT_PR004_Months")="U" TXT_PR004_Months="3"

OPEN Payroll_Payments
COMMENT Fine for ACL 11 because c_Prd_Dt is derived from Prd_Dt
SET FILTER TO %v_SpecialLeave%
SUMMARIZE ON Co_Emp_ID c_Prd_Dt OTHER Prd_Dt SUBTOTAL Pay_Hrs PAYCODE_AMOUNT IF PAYCODE_AMOUNT<>0  TO "%fld_Tmps%TMP1.FIL" OPEN PRESORT

SORT ON Co_Emp_ID c_Prd_Dt IF PAYCODE_AMOUNT>0 TO "%fld_Tmps%TMP2" OPEN
DELETE FIELD ID OK
DEFINE FIELD ID COMPUTED RECNO()

DELETE FIELD Consec1 OK
DEFINE FIELD Consec1 COMPUTED

1 IF Co_Emp_ID=RECOFFSET(Co_Emp_ID,1) AND ABS(VALUE(SUBSTR(RECOFFSET(c_Prd_Dt,1),1,6),0) - VALUE(SUBSTR(c_Prd_Dt,1,6),0))<= 1 
0

DELETE FIELD Consec2 OK
DEFINE FIELD Consec2 COMPUTED

1 IF Co_Emp_ID=RECOFFSET(Co_Emp_ID,-1) AND ABS(VALUE(SUBSTR(RECOFFSET(c_Prd_Dt,-1),1,6),0) - VALUE(SUBSTR(c_Prd_Dt,1,6),0))<= 1  
0

EXTRACT FIELDS ALL IF Consec1 =1 OR Consec2=1 TO "%fld_Tmps%TMP3" OPEN

SUMMARIZE ON Co_Emp_ID TO "%fld_Tmps%TMP4.FIL" OPEN PRESORT

COMM CTOD(SUBSTR(RptRunDateTime,1,10),"DD/MM/YYYY") >= _RptRunDate- 3*30
EXTRACT FIELDS ALL IF COUNT>=VALUE(ALLTRIM(TXT_PR004_Months),0) TO %fld_Tmps%TMP5 OPEN
INDEX ON Co_Emp_ID TO IDX_TMP
OPEN TMP2
DEFINE RELATION Co_Emp_ID WITH TMP5 INDEX IDX_TMP
EXTRACT FIELDS ALL IF NOT ISBLANK(TMP5.Co_Emp_ID) TO %fld_Tmps%TMP1 OPEN

DELETE FIELD KEY OK
DEFINE FIELD KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(c_Prd_Dt),1,30)

COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(c_Prd_Dt),1,85)

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***
EXTRACT FIELDS ALL TO %fld_Tmps%TMP2 OPEN

INDEX ON KEY TO IDX_TMP

OPEN Payroll_Payments
DELETE FIELD KEY OK
DEFINE FIELD KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+ALLTRIM(c_Prd_Dt),1,30)
DEFINE RELATION KEY WITH TMP2 INDEX IDX_TMP
DEFINE RELATION Co_Emp_ID WITH EMF_TMP_Emp INDEX IDX_EMF_Co_Emp_ID

COMM IF PAYCODE_AMOUNT<>0 AND FIND("special leave",LINE_DESC)
EXTRACT FIELDS ALL %v_flds_EMF1% IF NOT ISBLANK(TMP2.Co_Emp_ID) TO %fld_Tmps%TMP3 OPEN

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(c_Prd_Dt),1,30)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Co_Emp_ID c_Prd_Dt"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  DATE(_RptRunDate)

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  DATE(_PR_Data_Start_Date)

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  DATE(_PR_Data_End_Date)

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED SUBSTR("PR004. Identify employees on special leave with pay for more than %TXT_PR004_Months% months",1,120)

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
COMM *** RESULTS ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%PR004_Spec_Leave_%TXT_PR004_Months%Mon" 

OPEN Payroll_Payments
DELETE RELATION TMP2 OK

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp



SET SAFETY ON
^BATCH    PR005_Pay_TrmAmt_Sleeper           
[PARENT_FOLDER_ID] 1340167415
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** PR005. Identify employees who have been paid termination amount but employee has a sleeper status and is not terminated
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************
IF FTYPE("Payroll_Payments")<>"y" OR FILESIZE("%fld_Workings%Payroll_Payments.fil")<=0 ESCAPE
IF FTYPE("v_TerminationAmount")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="PR005"


OPEN Payroll_Payments
DEFINE RELATION Co_Emp_ID WITH EMF_TMP_Emp INDEX IDX_EMF_Co_Emp_ID

SET FILTER TO %v_TerminationAmount%
EXTRACT FIELDS %v_flds_PR% %v_flds_EMF1%  IF (EMF_TMP_Emp.Emp_Sts = "A")  TO "%fld_Tmps%TMP1" OPEN

COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(Co)+"~"+ALLTRIM(c_Prd_Dt),1,85)
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(c_Prd_Dt),1,30)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Co_Emp_ID c_Prd_Dt"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  DATE(_RptRunDate)

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  DATE(_PR_Data_Start_Date)

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  DATE(_PR_Data_End_Date)

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "PR011. Identify Active but Sleeper Employees who have been paid Trm Amt."

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%PR005_Pay_TrmAmt_Sleeper" 

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    PR007_Hourly_Emp                   
[PARENT_FOLDER_ID] 1340167415
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** PR007. List all hourly employees working > the total hours available in week
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************

IF FTYPE("Payroll_Payments")<>"y" OR FILESIZE("%fld_Workings%Payroll_Payments.fil")<=0 ESCAPE
IF FTYPE("v_PeriodGrossAmount")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="PR007"

IF FTYPE("TXT_PR007_Hrs_Tolerance")="U" TXT_PR007_Hrs_Tolerance=""
IF ISBLANK(TXT_PR007_Hrs_Tolerance) TXT_PR007_Hrs_Tolerance="0"
IF FTYPE("TXT_PR007_Filter")="U" TXT_PR007_Filter=" AND NOT MATCH(EMF_TMP_Emp.Emp_Catg,'full time','ONGOING','PERM') AND PayCode <> '71861' AND NOT FIND('Payroll Tax',PayCode_Desc)"

OPEN Payroll_Payments
DEFINE RELATION Co_Emp_ID WITH EMF_TMP_Emp INDEX IDX_EMF_Co_Emp_ID

COMMENT Fine for ACL 11 because c_Prd_Dt is derived from Prd_Dt

SET FILTER TO %v_PeriodGrossAmount% %TXT_PR007_Filter%
EXTRACT FIELDS ALL IF PayCode_Amount<>0 TO "%fld_Tmps%TMP1" OPEN

SUMMARIZE ON CO Co_Emp_ID COST_CENTRE c_Prd_Dt OTHER Prd_Dt SUBTOTAL PayCode_Amount Pay_Hrs  TO "%fld_Tmps%TMP3.FIL" OPEN PRESORT

DELETE FIELD KEY OK
DEFINE FIELD KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(c_Prd_Dt),1,30)

DEFINE RELATION Co_Emp_ID WITH EMF_TMP_Emp INDEX IDX_EMF_Co_Emp_ID

COMM VALUE(INCLUDE(EMF_TMP_Emp.AUTOPAY_HOURS_DAYS,"123456789"),2)
EXTRACT FIELDS ALL %v_flds_EMF1% IF Pay_Hrs>EMF_TMP_Emp.Standard_WeeklyHours*2 TO %fld_Tmps%TMP4 OPEN
INDEX ON KEY TO IDX_TMP4

OPEN Payroll_Payments
DELETE FIELD KEY OK
DEFINE FIELD KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(c_Prd_Dt),1,30)
DEFINE RELATION Co_Emp_ID WITH EMF_TMP_Emp INDEX IDX_EMF_Co_Emp_ID

DEFINE RELATION KEY WITH TMP4 INDEX IDX_TMP4
EXTRACT FIELDS ALL %v_flds_EMF1%  IF NOT ISBLANK(TMP4.KEY) TO %fld_Tmps%\TMP5 OPEN

COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(c_Prd_Dt),1,85)

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(c_Prd_Dt),1,30)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Co_Emp_ID c_Prd_Dt"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  DATE(_RptRunDate)

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  DATE(_PR_Data_Start_Date)

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  DATE(_PR_Data_End_Date)

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "PR007. List all hourly employees working > the total hours available in week."

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
COMM *** RESULTS ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%PR007_Hourly_Emp" 

OPEN Payroll_Payments
DELETE RELATION TMP4 OK

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp


SET SAFETY ON
^BATCH    PR009_Pay_x_Times_Avg              
[PARENT_FOLDER_ID] 1340167415
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** PR009. 2 Ratio Test on Payments to staff where payment is x times great than average payment
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************
IF FTYPE("Payroll_Payments")<>"y" OR FILESIZE("%fld_Workings%Payroll_Payments.fil")<=0 ESCAPE
IF FTYPE("v_PeriodGrossAmount")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%
v_TestNo="PR009"

IF FTYPE("TXT_PR009_Times")="U" TXT_PR009_Times="2"
IF FTYPE("TXT_PR009_Filter")="U" TXT_PR009_Filter=" AND NOT MATCH(EMF_TMP_Emp.Emp_Catg,'full time','ONGOING','PERM') AND PayCode <> '71861' AND NOT FIND('Payroll Tax',PayCode_Desc)"

OPEN Payroll_Payments
COMM (SUBSTR(LINE_DESC,1,11)=  "Payroll Tax") AND (PayCode = "71861")
COMMENT Fine for ACL 11 because c_Prd_Dt is derived from Prd_Dt
SET FILTER TO %v_PeriodGrossAmount% %TXT_PR009_Filter%
EXTRACT FIELDS ALL %v_flds_EMF1% IF PayCode_Amount<>0 TO "%fld_Tmps%TMP1" OPEN
SUMMARIZE ON CO Co_Emp_ID Emp_ID c_Prd_Dt OTHER Prd_Dt SUBTOTAL PayCode_Amount Pay_Hrs TO "%fld_Tmps%TMP2.FIL" OPEN PRESORT

SUMMARIZE ON CO Co_Emp_ID Emp_ID SUBTOTAL PayCode_Amount Pay_Hrs TO "%fld_Tmps%TMP3.FIL" OPEN PRESORT
DELETE FIELD Avg_PayCode_Amount OK
DEFINE FIELD Avg_PayCode_Amount COMPUTED DEC(PayCode_Amount/COUNT,2)
DELETE FIELD Avg_PayCode_Hours OK
DEFINE FIELD Avg_PayCode_Hours COMPUTED DEC(PayCode_Amount/COUNT,2)
INDEX ON Co_Emp_ID TO IDX_TMP3

OPEN TMP2
DEFINE RELATION Co_Emp_ID WITH TMP3 INDEX IDX_TMP3
SET FILTER TO TMP3.Avg_PayCode_Amount<>0
EXTRACT FIELDS ALL TMP3.Avg_PayCode_Amount TMP3.Avg_PayCode_Hours DEC(PayCode_Amount/TMP3.Avg_PayCode_Amount,0) AS 'TIMES' IF DEC(PayCode_Amount/TMP3.Avg_PayCode_Amount,0) >=VALUE(ALLTRIM(TXT_PR009_Times),0) TO %fld_Tmps%TMP4 OPEN

DELETE FIELD KEY OK
DEFINE FIELD KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(c_Prd_Dt),1,30)

COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(c_Prd_Dt),1,85)

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DEFINE RELATION Co_Emp_ID WITH EMF_TMP_Emp INDEX IDX_EMF_Co_Emp_ID

EXTRACT FIELDS ALL %v_flds_EMF1% TO %fld_Tmps%TMP5 OPEN

INDEX ON KEY TO IDX_TMP5

COMM *** GET THE DETAILS ***
OPEN TMP1
DELETE FIELD KEY OK
DEFINE FIELD KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(c_Prd_Dt),1,30)
DEFINE RELATION KEY WITH TMP5 INDEX IDX_TMP5

EXTRACT FIELDS ALL   IF KEY=TMP5.KEY TO %fld_Tmps%TMP6 OPEN 

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(c_Prd_Dt),1,30)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Co_Emp_ID c_Prd_Dt"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  DATE(_RptRunDate)

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  DATE(_PR_Data_Start_Date)

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  DATE(_PR_Data_End_Date)

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED SUBSTR("PR009D. 2 Ratio Test on Payments to staff where payment is %TXT_PR009_Times% times great than average payment -Details",1,120)

COMM *** RESULTS ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%PR009D_Pay_%TXT_PR009_Times%_Times_Avg" 

OPEN TMP5
DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(c_Prd_Dt)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Co_Emp_ID c_Prd_Dt"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  DATE(_RptRunDate)

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  DATE(_PR_Data_Start_Date)

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  DATE(_PR_Data_End_Date)

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "PR009. 2 Ratio Test on Payments to staff where payment is %TXT_PR009_Times% times great than average payment"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SORT ON SORT_KEY D TO "%fld_Results%PR009_Pay_%TXT_PR009_Times%_Times_Avg" 


COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    PR008_Top_xx_Over_xx_Mon           
[PARENT_FOLDER_ID] 1340167415
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** PR008. Top x paid employees over xx months. (e.g. 1 month, 3 months, 6 months, 18 months)
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************
IF FTYPE("Payroll_Payments")<>"y" OR FILESIZE("%fld_Workings%Payroll_Payments.fil")<=0 ESCAPE

IF FTYPE("v_PaidAmount")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

IF FTYPE("TXT_PR008_Top")="U"  TXT_PR008_Top="30"
IF FTYPE("TXT_PR008_Months")="U" TXT_PR008_Months="1"
IF FTYPE("TXT_PR008_Filter")="U" TXT_PR008_Filter="AND NOT FIND('Payroll Tax',PayCode_Desc)"

OPEN Payroll_Payments

COMM (SUBSTR(LINE_DESC,1,11)=  "Payroll Tax") AND (PayCode = "71861")
SET FILTER TO %v_PaidAmount% %TXT_PR008_Filter%
EXTRACT FIELDS ALL %v_flds_EMF1% IF PayCode_Amount<>0 AND Prd_Dt >=CTOD(DATE(_PR_Data_Start_Date- VALUE(ALLTRIM(TXT_PR008_Months),0)*30,"DD/MM/YYYY")) TO "%fld_Tmps%TMP1" OPEN

SUMMARIZE ON Co_Emp_ID COST_CENTRE SUBTOTAL PayCode_Amount Pay_Hrs TO "%fld_Tmps%TMP2.FIL" OPEN PRESORT

COUNT
IF COUNT1<=0 Errmsg=Errmsg+" PR008"
IF COUNT1<=0 ESCAPE

DEFINE RELATION Co_Emp_ID WITH EMF_TMP_Emp INDEX IDX_EMF_Co_Emp_ID

STATISTICS ON PayCode_Amount TO SCREEN NUMBER VALUE(TXT_PR008_Top,0)

IF FTYPE("HIGH1")="U" ESCAPE
EXTRACT FIELDS ALL %v_flds_EMF1% IF PayCode_Amount>=HIGH1 TO "%fld_Tmps%TMP3" OPEN
INDEX ON Co_Emp_ID TO IDX_TMP3_Co_Emp_ID


COMM *** Results Top xx  ***

SET FOLDER /%fld_Tmps%
OPEN TMP3
DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ZONED(PayCode_Amount,15)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "PayCode_Amount"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
DATE(_RptRunDate)

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
CTOD(DATE(_Data_Range_End_Date- VALUE(ALLTRIM(TXT_PR008_Months),0)*30,"DD/MM/YYYY"))

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED SUBSTR("PR008. Top %TXT_PR008_Top% paid employees over %TXT_PR008_Months%  months",1,120)

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO %fld_Results%PR008_Top_%TXT_PR008_Top%_Over_%TXT_PR008_Months%_Mon

COMM *** Get the Details for the TOP xx***
SET FOLDER /%fld_Tmps%

OPEN TMP1
DEFINE RELATION Co_Emp_ID WITH TMP3 INDEX  IDX_TMP3_Co_Emp_ID

EXTRACT FIELDS ALL  IF Co_Emp_ID=TMP3.Co_Emp_ID TO %fld_Tmps%TMP4 OPEN 

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(c_Prd_Dt),1,30)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Co_Emp_ID Prd_Dt"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
DATE(_RptRunDate) 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
DATE(_PR_Data_Start_Date- VALUE(ALLTRIM(TXT_PR008_Months),0)*30,"DD/MM/YYYY")


DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
DATE(_PR_Data_Start_Date)

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "PR008D. Top %TXT_PR008_Top% Vendors over %TXT_PR008_Months% months - Details"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO %fld_Results%PR008D_Top_%TXT_PR008_Top%_Over_%TXT_PR008_Months%_Mon OPEN


COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    VM011_Upd_Mul_xx_Mon               
[PARENT_FOLDER_ID] 1340167398
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Vendor Master File Exception Tests
COMM *** VM011. List vendors who details have been updated more than once in x months
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_VMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_VMF")="U" DO AA002_Variable_Setting
IF FTYPE("%trg_VMF%")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF%.FIL")<=0 ESCAPE
IF FTYPE("TXT_VM011_Mon")="U" DO AC002_Test_Var_Input

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%
v_TestNo="VM011"

OPEN VMF_Chg_History

SUMMARIZE ON Vndr_Site_ID IF CTOD(SUBSTR(RptRunDateTime,1,10),"DD/MM/YYYY") >= _RptRunDate- 30*VALUE(INCLUDE("%TXT_VM011_Mon%","1234567890"),0) TO "%fld_Tmps%TMP1.FIL" OPEN PRESORT
INDEX ON Vndr_Site_ID TO IDX_TMP1

OPEN VMF_Chg_History
DEFINE RELATION Vndr_Site_ID WITH TMP1 INDEX IDX_TMP1

EXTRACT FIELDS ALL  TMP1.COUNT IF TMP1.COUNT>1 TO %fld_Tmps%TMP2 OPEN

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_Site_ID)+"~"+ZONED(COUNT,6),1,85)
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+"~"+ALLTRIM(RptRunDateTime),1,40)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Vndr_ID RptRunDateTime"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "L"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_RptRunDate- 30*VALUE(INCLUDE("%TXT_VM011_Mon%","1234567890"),0)


DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "VM011. List vendors who details have been updated more than once in %TXT_VM011_Mon% months"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /%fld_Results%

SORT ON SORT_KEY D TO "%fld_Results%VM011_Upd_Mul_%TXT_VM011_Mon%_Mon" OPEN 
DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum INDEX IDX_AP_Sum_VndrID

OPEN VMF_Chg_History
DELETE RELATION TMP1 OK

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    VM013_OneTim_Vnd_Spend             
[PARENT_FOLDER_ID] 1340167398
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Vendor Master File Exception Tests
COMM *** VM013. List of one time vendors and associated spend
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_VMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_VMF")="U" DO AA002_Variable_Setting
IF FTYPE("VMF_Vnd_OneTime")<>"y" OR FILESIZE("%fld_Workings%VMF_Vnd_OneTime.FIL")<=0 Errmsg=Errmsg+" VM013"
IF FTYPE("VMF_Vnd_OneTime")<>"y" OR FILESIZE("%fld_Workings%VMF_Vnd_OneTime.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="VM013"

OPEN VMF_Vnd_Master_File
DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum INDEX IDX_AP_Sum_VndrID

SET FILTER TO Vndr_Sts='A' AND NOT ISBLANK(VMF_Vnd_OneTime.Vndr_Site_ID)
EXTRACT AP_Vnd_InvGst_Sum.COUNT AS 'Trans_Num' AP_Vnd_InvGst_Sum.Inv_Amt AP_Vnd_InvGst_Sum.GST_Amt %v_flds_VMF% TO "%fld_Tmps%TMP" OPEN

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_Site_ID),1,85)

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP1" OPEN
INDEX ON Vndr_Site_ID TO IDX_TMP1_VndrSIteID

COMM *** Invoice Details ***
OPEN AP_Invoices
DEFINE RELATION Vndr_Site_ID WITH TMP1 INDEX IDX_TMP1_VndrSIteID
EXTRACT FIELDS %v_flds_AP_Inv% IF Vndr_Site_ID=TMP1.Vndr_Site_ID TO "%fld_Tmps%TMP2"

COMM *** Finalize the results ***
COMM *** Vendor Summary Report ***
OPEN TMP1
DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ZONED(Inv_Amt,15)+"~"+ALLTRIM(Vndr_Site_ID) ,1,35)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Total_Inv_Amt Vndr_Site_ID D"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "L"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "VM013. List of one time vendors and associated spend"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP3" OPEN

SET FOLDER /%fld_Results%
OPEN TMP3
SORT ON Trans_Num SORT_KEY D TO "%fld_Results%VM013_OneTim_Vnd_Spend" OPEN

COMM *** Details Report*** 
OPEN TMP2
DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ALLTRIM(Vndr_Site_ID)+"~"+ ALLTRIM(ZONED(Inv_Amt,15))

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Vndr_Site_ID Inv_Amt D"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "L"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "VM013D. List of one time vendors and associated spend - Details"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%VM013D_OneTim_Vnd_Spend" OPEN

COMM *** Delete temporary tables ***
OPEN AP_Invoices
DELETE RELATION  TMP1 OK
DELETE FORMAT TMP1 OK
DELETE "%fld_Tmps%TMP1.fil" OK
DELETE FORMAT TMP2 OK
DELETE "%fld_Tmps%TMP2.fil" OK

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    VM014_VndEmp_BankAcc               
[PARENT_FOLDER_ID] 1340167398
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Vendor Master File Exception Tests
COMM *** VM014. Vendor details matching employee details on Bank Account
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_VMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_VMF")="U" DO AA002_Variable_Setting
IF FTYPE("Vnd_Emp_Master")<>"y" OR FILESIZE("%fld_Workings%Vnd_Emp_Master.FIL")<=0 DO MZ003_Com_VndEmp
IF FTYPE("Vnd_Emp_Master")<>"y" OR FILESIZE("%fld_Workings%Vnd_Emp_Master.FIL")<=0 Errmsg=Errmsg+" VM014"
IF FTYPE("Vnd_Emp_Master")<>"y" OR FILESIZE("%fld_Workings%Vnd_Emp_Master.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%
v_TestNo="VM014"

COMM *** Combine the Vendors and Employees' bank accouts ***
OPEN VMF_BnkAcc
EXTRACT FIELDS SUBSTR('VM',1,2) AS 'VM_EM' SUBSTR(Vndr_Site_ID,1,20) AS 'Vndr_Site_ID' SUBSTR(Vndr_ID,1,20) AS 'Vndr_ID' SUBSTR(BSB,1,20) AS 'BSB' SUBSTR(Bnk_Acc_Num,1,20) AS 'Bnk_Acc_Num' IF VMF_Vnd_Master_File.Vndr_Sts='A' TO "%fld_Tmps%TMP1"

OPEN EMF_BnkAcc
DEFINE RELATION Co_Emp_ID WITH EMF_TMP_Emp INDEX IDX_EMF_Co_Emp_ID
EXTRACT FIELDS SUBSTR('EM',1,2) AS 'VM_EM' SUBSTR(Co_Emp_ID,1,20) AS 'Co_Emp_ID' SUBSTR(EMP_ID,1,20) AS 'Emp_ID' SUBSTR(BSB,1,20) AS 'BSB' SUBSTR(Bnk_Acc_Num,1,20) AS 'Bnk_Acc_Num' IF EMF_TMP_Emp.EMP_Sts='A' TO "%fld_Tmps%TMP1" OPEN APPEN

DELETE FIELD KEY OK
DEFINE FIELD KEY COMPUTED SUBSTR(ALLTRIM(VM_EM)+ALLTRIM(Vndr_ID),1,22)

DELETE FIELD c_Bank OK
DEFINE FIELD c_Bank COMPUTED ALLTRIM(INCLUDE(BSB,"0123456789"))+ALLTRIM(INCLUDE(Bnk_Acc_Num,"0123456789"))

COMMENT Fine for ACL 11
SUMMARIZE ON KEY c_Bank OTHER VM_EM Vndr_ID BSB Bnk_Acc_Num IF LENGTH(ALLTRIM(c_Bank))>3 AND VALUE(c_Bank,0)<>0 TO "%fld_Tmps%TMP2" OPEN PRESORT

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP_BnkAcc" OPEN 

DELETE FIELD Bnk_KEY OK
DEFINE FIELD Bnk_KEY COMPUTED ALLTRIM(KEY)+ALLTRIM(c_Bank)

INDEX ON Bnk_KEY TO IDX_c_BANK
DUPLICATES ON c_Bank OTHER Bnk_KEY KEY c_Bank PRESORT OPEN TO "%fld_Tmps%TMP2.FIL"

OPEN TMP2
DELETE FIELD DUP_KEY OK
DEFINE FIELD DUP_KEY COMPUTED ALLTRIM(c_Bank)

DEFINE RELATION Bnk_KEY WITH TMP_BnkAcc INDEX IDX_c_BANK
DEFINE RELATION KEY WITH Vnd_Emp_Master INDEX IDX_VNDEMP_KEY

EXTRACT FIELDS DUP_KEY KEY Vnd_Emp_Master.VM_EM Vnd_Emp_Master.Vndr_Site_ID Vnd_Emp_Master.Vndr_ID Vnd_Emp_Master.Vndr_Nme Vnd_Emp_Master.ABN Vnd_Emp_Master.Vndr_Sts Vnd_Emp_Master.Vndr_Typ TMP_BnkAcc.BSB TMP_BnkAcc.Bnk_Acc_Num Vnd_Emp_Master.ADD1 Vnd_Emp_Master.ADD2 Vnd_Emp_Master.ADD3 Vnd_Emp_Master.City Vnd_Emp_Master.State Vnd_Emp_Master.Pcode Vnd_Emp_Master.Cntry Vnd_Emp_Master.TEL1 Vnd_Emp_Master.TEL2 Vnd_Emp_Master.TEL3 Vnd_Emp_Master.FAX Vnd_Emp_Master.Email1 Vnd_Emp_Master.Email2 Vnd_Emp_Master.Inv_Amt Vnd_Emp_Master.GST_AMT Vnd_Emp_Master.COUNT Vnd_Emp_Master.Hire_Dt Vnd_Emp_Master.Trm_Dt Vnd_Emp_Master.Created_Dt Vnd_Emp_Master.Modf_Dt IF NOT ISBLANK(Vnd_Emp_Master.KEY) TO %fld_Tmps%TMP3 OPEN

COMM *** Only show dups across Vendor and HR Employee
SUMMARIZE ON DUP_KEY IF VM_EM="EM" TO "%fld_Tmps%TMP5_1.FIL" PRESORT
SUMMARIZE ON DUP_KEY IF VM_EM<>"EM" AND Vndr_Typ<>"EM" TO "%fld_Tmps%TMP5_2.FIL" PRESORT

OPEN TMP5_1
OPEN TMP5_2 SECONDARY
JOIN PKEY DUP_KEY FIELDS DUP_KEY SKEY DUP_KEY WITH DUP_KEY TO "%fld_Tmps%TMP4" OPEN PRESORT MANY SECSORT
CLOSE SECONDARY

INDEX ON DUP_KEY TO IDX_TMP4_DUP_KEY

OPEN TMP3
DEFINE RELATION DUP_KEY WITH TMP4 INDEX IDX_TMP4_DUP_KEY

EXTRACT FIELDS ALL IF NOT ISBLANK(TMP4.DUP_KEY) TO "%fld_Tmps%TMP5" OPEN

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(KEY)+"~"+ALLTRIM(DUP_KEY),1,85)

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
v_DUP_KEY="DUP_KEY"
v_Filter=""
IF v_Exc_History =T DO AE001_Dup_History
IF v_Chk_CCM=T DO AE006_Dup_CCM
COMM *** End ***

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "VM014. Vendor details matching employee details on Bank Account"

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(DUP_KEY)+ALLTRIM(VM_EM)+ALLTRIM(Vndr_Site_ID) ,1,50)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "c_BankAcc VM_EM Vndr_Site_ID"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /Results
SORT ON SORT_KEY D  TO "%fld_Results%VM014_VndEmp_BankAcc" OPEN

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp


SET SAFETY ON
^BATCH    VM015_VndEmp_Add                   
[PARENT_FOLDER_ID] 1340167398
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Vendor Master File Exception Tests
COMM *** VM015. Vendor details matching employee details by Address
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_VMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_VMF")="U" DO AA002_Variable_Setting
IF FTYPE("Vnd_Emp_Master")<>"y" OR FILESIZE("%fld_Workings%Vnd_Emp_Master.FIL")<=0 DO MZ003_Com_VndEmp
IF FTYPE("Vnd_Emp_Master")<>"y" OR FILESIZE("%fld_Workings%Vnd_Emp_Master.FIL")<=0 Errmsg=Errmsg+" VM015"
IF FTYPE("Vnd_Emp_Master")<>"y" OR FILESIZE("%fld_Workings%Vnd_Emp_Master.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="VM015"

OPEN VMF_Address
DEFINE RELATION Vndr_Site_ID WITH VMF_Vnd_Master_File INDEX IDX_VndrSiteID
EXTRACT FIELDS SUBSTR('VM',1,2) AS 'VM_EM' SUBSTR(Vndr_Site_ID,1,20) AS 'Vndr_Site_ID' SUBSTR(Vndr_ID,1,20) AS 'Vndr_ID' SUBSTR(ADD1,1,61) AS 'ADD1' SUBSTR(ADD2,1,60) AS 'ADD2' SUBSTR(ADD3,1,60) AS 'ADD3' SUBSTR(Pcode,1,11) AS 'PCode' SUBSTR(City,1,35) AS 'City' SUBSTR(State,1,29) AS 'State' SUBSTR(Cntry,1,61) AS 'Cntry' IF VMF_Vnd_Master_File.Vndr_Sts='A' TO "%fld_Tmps%TMP1"

OPEN EMF_TMP_Emp
EXTRACT FIELDS SUBSTR('EM',1,2) AS 'VM_EM' SUBSTR(Co_Emp_ID,1,20) AS 'Vndr_Site_ID'  SUBSTR(Emp_ID,1,20) AS 'Vndr_ID' SUBSTR(ADD1,1,61) AS 'ADD1' SUBSTR(ADD2,1,60) AS 'ADD2' SUBSTR(ADD3,1,60) AS 'ADD3' SUBSTR(Pcode,1,11) AS 'PCode' SUBSTR(City,1,35) AS 'City' SUBSTR(State,1,29) AS 'State' SUBSTR(Cntry,1,61) AS 'Cntry' IF EMP_Sts='A' TO "%fld_Tmps%TMP1" APPEND 

OPEN TMP1
DELETE FIELD c_Pcode OK
DEFINE FIELD c_Pcode COMPUTED 

"" IF LENGTH(trim(Pcode))<2
ALLTRIM(INCLUDE(Pcode, "0123456789"))

DELETE FIELD c_Add1 OK
DEFINE FIELD c_Add1 COMPUTED

REPLACE(UPPER(Add1), "STREET", " ST ") IF FIND("STREET", UPPER(Add1))
REPLACE(UPPER(Add1), "ROAD", " RD ") IF FIND("ROAD", UPPER(Add1))
REPLACE(UPPER(Add1), "AVENUE", " AVE ") IF FIND("AVENUE", UPPER(Add1))
REPLACE(UPPER(Add1), "CRESCENT", " CRES ") IF FIND("CRESCENT", UPPER(Add1))
REPLACE(UPPER(Add1), "DRIVE", " DR ") IF FIND("DRIVE", UPPER(Add1))
REPLACE(UPPER(Add1), "COURT", " CRT ") IF FIND("COURT", UPPER(Add1))
REPLACE(UPPER(Add1), "CIRCUIT", " CCT ") IF FIND("CIRCUIT", UPPER(Add1))
REPLACE(UPPER(Add1), "PLACE", " PL ") IF FIND("PLACE", UPPER(Add1))
UPPER(Add1)

DELETE FIELD c_Add1F OK
DEFINE FIELD c_Add1F COMPUTED 

"PO" IF FIND(" BAG ", c_Add1) OR FIND(" BOX ", c_Add1)  
"ST" IF FIND("HIGHWAY", c_Add1) OR FIND(" WAY", c_Add1) OR FIND(" ST ", c_Add1) OR FIND(" RD ", c_Add1) OR FIND(" AVE ", c_Add1) OR FIND(" CRES ", c_Add1) OR FIND(" DR ", c_Add1) OR FIND(" CRT ", c_Add1) OR FIND(" CCT ",c_Add1) OR FIND(" PL ", c_Add1)
" "

DELETE FIELD c_Add2 OK
DEFINE FIELD c_Add2 COMPUTED

REPLACE(UPPER(Add2), "STREET", " ST ") IF FIND("STREET", UPPER(Add2))
REPLACE(UPPER(Add2), "ROAD", " RD ") IF FIND("ROAD", UPPER(Add2))
REPLACE(UPPER(Add2), "AVENUE", " AVE ") IF FIND("AVENUE", UPPER(Add2))
REPLACE(UPPER(Add2), "CRESCENT", " CRES ") IF FIND("CRESCENT", UPPER(Add2))
REPLACE(UPPER(Add2), "DRIVE", " DR ") IF FIND("DRIVE", UPPER(Add2))
REPLACE(UPPER(Add2), "COURT", " CRT ") IF FIND("COURT", UPPER(Add2))
REPLACE(UPPER(Add2), "CIRCUIT", " CCT ") IF FIND("CIRCUIT", UPPER(Add2))
REPLACE(UPPER(Add2), "PLACE", " PL ") IF FIND("PLACE", UPPER(Add2))
UPPER(Add2)

DELETE FIELD c_Add2F OK
DEFINE FIELD c_Add2F COMPUTED 

"PO" IF FIND(" BAG ", c_Add2) OR FIND(" BOX ", c_Add2)  
"ST" IF FIND("HIGHWAY", c_Add2) OR FIND(" WAY", c_Add2) OR FIND(" ST ", c_Add2) OR FIND(" RD ", c_Add2) OR FIND(" AVE ", c_Add2) OR FIND(" CRES ", c_Add2) OR FIND(" DR ", c_Add2) OR FIND(" CRT ", c_Add2) OR FIND(" CCT ",c_Add2) OR FIND(" PL ", c_Add2)
" "

DELETE FIELD c_Add3 OK
DEFINE FIELD c_Add3 COMPUTED

REPLACE(UPPER(Add3), "STREET", " ST ") IF FIND("STREET", UPPER(Add3))
REPLACE(UPPER(Add3), "ROAD", " RD ") IF FIND("ROAD", UPPER(Add3))
REPLACE(UPPER(Add3), "AVENUE", " AVE ") IF FIND("AVENUE", UPPER(Add3))
REPLACE(UPPER(Add3), "CRESCENT", " CRES ") IF FIND("CRESCENT", UPPER(Add3))
REPLACE(UPPER(Add3), "DRIVE", " DR ") IF FIND("DRIVE", UPPER(Add3))
REPLACE(UPPER(Add3), "COURT", " CRT ") IF FIND("COURT", UPPER(Add3))
REPLACE(UPPER(Add3), "CIRCUIT", " CCT ") IF FIND("CIRCUIT", UPPER(Add3))
REPLACE(UPPER(Add3), "PLACE", " PL ") IF FIND("PLACE", UPPER(Add3))
UPPER(Add3)

DELETE FIELD c_Add3F OK
DEFINE FIELD c_Add3F COMPUTED 

"PO" IF FIND(" BAG ", c_Add3) OR FIND(" BOX ", c_Add3)  
"ST" IF FIND("HIGHWAY", c_Add3) OR FIND(" WAY", c_Add3) OR FIND(" ST ", c_Add3) OR FIND(" RD ", c_Add3) OR FIND(" AVE ", c_Add3) OR FIND(" CRES ", c_Add3) OR FIND(" DR ", c_Add3) OR FIND(" CRT ", c_Add3) OR FIND(" CCT ",c_Add3) OR FIND(" PL ", c_Add3)
" "

EXTRACT FIELDS VM_EM Vndr_Site_ID Vndr_ID Pcode SUBSTR(INCLUDE(c_Add1, "0123456789"),1,50) AS "Address" "PO" AS "Type" IF  c_Add1F="PO" TO "%fld_Tmps%TMP2" OPEN
OPEN TMP1
EXTRACT FIELDS VM_EM Vndr_Site_ID Vndr_ID Pcode SUBSTR(INCLUDE(c_Add2, "0123456789"),1,50) AS "Address" "PO" AS "Type" IF c_Add2F="PO" TO "%fld_Tmps%TMP2" OPEN APPEND
OPEN TMP1
EXTRACT FIELDS VM_EM Vndr_Site_ID Vndr_ID Pcode SUBSTR(INCLUDE(c_Add3, "0123456789"),1,50) AS "Address" "PO" AS "Type" IF c_Add3F="PO" TO "%fld_Tmps%TMP2" OPEN APPEND
OPEN TMP1
EXTRACT FIELDS VM_EM Vndr_Site_ID Vndr_ID Pcode SUBSTR(INCLUDE(c_Add1 +c_Add2+c_Add3,"QWERTYUIOPASDFGHJKLZXCVBNM0123456789"),1,50) AS "Address" "ST" AS "Type" IF c_Add1F<>"PO" AND c_Add2F<>"PO" AND c_Add3F<>"PO" TO "%fld_Tmps%TMP2" OPEN APPEND
OPEN TMP1
EXTRACT FIELDS VM_EM Vndr_Site_ID Vndr_ID Pcode SUBSTR(INCLUDE(c_Add1 +c_Add2,"QWERTYUIOPASDFGHJKLZXCVBNM0123456789"),1,50) AS "Address" "ST" AS "Type" IF c_Add1F<>"PO" AND c_Add2F<>"PO" AND c_Add3F="PO" TO "%fld_Tmps%TMP2" OPEN APPEND
OPEN TMP1
EXTRACT FIELDS VM_EM Vndr_Site_ID Vndr_ID Pcode SUBSTR(INCLUDE(c_Add1 +c_Add3,"QWERTYUIOPASDFGHJKLZXCVBNM0123456789"),1,50) AS "Address" "ST" AS "Type" IF c_Add1F<>"PO" AND c_Add2F="PO" AND c_Add3F<>"PO" TO "%fld_Tmps%TMP2" OPEN APPEND
OPEN TMP1
EXTRACT FIELDS VM_EM Vndr_Site_ID Vndr_ID Pcode SUBSTR(INCLUDE(c_Add2+c_Add3,"QWERTYUIOPASDFGHJKLZXCVBNM0123456789"),1,50) AS "Address" "ST" AS "Type" IF c_Add1F="PO" AND c_Add2F<>"PO" AND c_Add3F<>"PO" TO "%fld_Tmps%TMP2" OPEN APPEND

COMMENT Fine for ACL 11
SUMMARIZE ON VM_EM Vndr_ID ADDRESS Pcode Type OTHER Vndr_Site_ID  IF NOT ISBLANK(ADDRESS) TO "%fld_Tmps%TMP10" OPEN PRESORT

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP_Address" OPEN 

DELETE FIELD KEY OK
DEFINE FIELD KEY COMPUTED SUBSTR(ALLTRIM(VM_EM)+ALLTRIM(Vndr_ID),1,22)

OPEN TMP_Address
DUPLICATES ON Address Pcode OTHER KEY Type Vndr_Site_ID Vndr_ID Address Pcode PRESORT IF Type = "PO" AND ALLTRIM(Address)<>"" OPEN TO "%fld_Tmps%TMP3.FIL"
OPEN TMP_Address
DUPLICATES ON Address Pcode OTHER KEY Type Vndr_Site_ID Vndr_ID Address Pcode PRESORT IF Type <> "PO" AND ALLTRIM(Address)<>"" APPEND OPEN TO "%fld_Tmps%TMP3.FIL"

OPEN TMP3
SUMMARIZE ON Address KEY Pcode Vndr_Site_ID Vndr_ID TO "%fld_Tmps%TMP4.FIL" OPEN PRESORT

DELETE FIELD DUP_KEY OK
DEFINE FIELD DUP_KEY COMPUTED ALLTRIM(PCode)+"~"+ALLTRIM(Address) 

DEFINE RELATION KEY WITH Vnd_Emp_Master INDEX IDX_VNDEMP_KEY

EXTRACT FIELDS DUP_KEY KEY Vnd_Emp_Master.VM_EM Vnd_Emp_Master.Vndr_Site_ID Vnd_Emp_Master.Vndr_ID Vnd_Emp_Master.Vndr_Nme Vnd_Emp_Master.ABN Vnd_Emp_Master.Vndr_Sts Vnd_Emp_Master.Vndr_Typ Vnd_Emp_Master.BSB Vnd_Emp_Master.Bnk_Acc_Num Vnd_Emp_Master.ADD1 Vnd_Emp_Master.ADD2 Vnd_Emp_Master.ADD3 Vnd_Emp_Master.City Vnd_Emp_Master.State Vnd_Emp_Master.Pcode Vnd_Emp_Master.Cntry Vnd_Emp_Master.TEL1 Vnd_Emp_Master.TEL2 Vnd_Emp_Master.TEL3 Vnd_Emp_Master.FAX Vnd_Emp_Master.Email1 Vnd_Emp_Master.Email2 Vnd_Emp_Master.Inv_Amt Vnd_Emp_Master.GST_AMT Vnd_Emp_Master.COUNT Vnd_Emp_Master.Hire_Dt Vnd_Emp_Master.Trm_Dt Vnd_Emp_Master.Created_Dt Vnd_Emp_Master.Modf_Dt IF KEY=Vnd_Emp_Master.KEY TO %fld_Tmps%TMP5 OPEN

COMM *** Only show dups across Vendor and HR Employee
SUMMARIZE ON DUP_KEY IF VM_EM="EM" TO "%fld_Tmps%TMP5_1.FIL" PRESORT
SUMMARIZE ON DUP_KEY IF VM_EM<>"EM" AND Vndr_Typ<>"EM" TO "%fld_Tmps%TMP5_2.FIL" PRESORT

OPEN TMP5_1
OPEN TMP5_2 SECONDARY
JOIN PKEY DUP_KEY FIELDS DUP_KEY SKEY DUP_KEY WITH DUP_KEY TO "%fld_Tmps%TMP6" OPEN PRESORT MANY SECSORT
CLOSE SECONDARY

INDEX ON DUP_KEY TO IDX_TMP6_DUP_KEY

OPEN TMP5
DEFINE RELATION DUP_KEY WITH TMP6 INDEX IDX_TMP6_DUP_KEY

EXTRACT FIELDS ALL IF NOT ISBLANK(TMP6.DUP_KEY) TO %fld_Tmps%TMP1 OPEN

COMM *** Begin Clean Dup Bank Acc exists in dup Address ***
EXTRACT FIELDS KEY FIRST 0 TO "%fld_Tmps%TMP_Dups"

IF FTYPE("VM014_VndEmp_BankAcc")="y" AND (FILESIZE("%fld_History%VM014_History.fil") >0 AND FTYPE("VM014_History")="y") OPEN VM014_History
IF FTYPE("VM014_VndEmp_BankAcc")="y" AND (FILESIZE("%fld_History%VM014_History.fil") <=0 OR FTYPE("VM014_History")<>"y") OPEN VM014_VndEmp_BankAcc
IF FTYPE("VM014_VndEmp_BankAcc")="y" AND (FTYPE("VM014_History")="y" OR FTYPE("VM014_VndEmp_BankAcc")="y") EXTRACT FIELDS KEY TO "%fld_Tmps%TMP_Dups" APPEND

OPEN TMP_Dups
INDEX ON KEY TO IDX_VND_DUP_A

OPEN TMP1
DEFINE RELATION KEY WITH TMP_Dups INDEX IDX_VND_DUP_A

SUMMARIZE ON DUP_KEY IF KEY  <> TMP_Dups.KEY  TO "%fld_Tmps%TMP2.FIL" OPEN PRESORT

OPEN TMP2
INDEX ON DUP_KEY TO IDX_TMP2_Dup_KEY

OPEN TMP1
DEFINE RELATION DUP_KEY WITH TMP2 INDEX IDX_TMP2_Dup_KEY

EXTRACT FIELDS ALL IF NOT ISBLANK(TMP2.DUP_KEY) TO "%fld_Tmps%TMP4" OPEN
COMM *** End clean***

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(KEY)+"~"+ALLTRIM(DUP_KEY),1,85)

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
v_DUP_KEY="DUP_KEY"
v_Filter=""
IF v_Exc_History =T DO AE001_Dup_History
IF v_Chk_CCM=T DO AE006_Dup_CCM
COMM *** End ***

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "VM015. Vendor details matching employee details by Address"

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(DUP_KEY)+ALLTRIM(VM_EM)+ALLTRIM(Vndr_Site_ID) ,1,60)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "c_Address VM_EM Vndr_Site_ID"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /Results
SORT ON SORT_KEY D  TO "%fld_Results%VM015_VndEmp_Add" OPEN

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    VM016_VndEmp_Tel                   
[PARENT_FOLDER_ID] 1340167398
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Vendor Master File Exception Tests
COMM *** VM016. Vendor details matching employee details on Telephone No/Mobile/Next of Kin Number (relation/families's )
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_VMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_VMF")="U" DO AA002_Variable_Setting
IF FTYPE("Vnd_Emp_Master")<>"y" OR FILESIZE("%fld_Workings%Vnd_Emp_Master.FIL")<=0 DO MZ003_Com_VndEmp
IF FTYPE("Vnd_Emp_Master")<>"y" OR FILESIZE("%fld_Workings%Vnd_Emp_Master.FIL")<=0 Errmsg=Errmsg+" VM016"
IF FTYPE("Vnd_Emp_Master")<>"y" OR FILESIZE("%fld_Workings%Vnd_Emp_Master.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="VM016"

OPEN Vnd_Emp_Master

DELETE FIELD c_Tel1 OK
DEFINE FIELD c_Tel1 COMPUTED ALLTRIM(STRING(VALUE(INCLUDE(Tel1, "0123456789"),0),21))
DELETE FIELD c_Tel2 OK
DEFINE FIELD c_Tel2 COMPUTED ALLTRIM(STRING(VALUE(INCLUDE(Tel2, "0123456789"),0),21))
DELETE FIELD c_Tel3 OK
DEFINE FIELD c_Tel3 COMPUTED ALLTRIM(STRING(VALUE(INCLUDE(Tel3, "0123456789"),0),21))
DELETE FIELD c_Fax OK
DEFINE FIELD c_Fax COMPUTED ALLTRIM(STRING(VALUE(INCLUDE(FAX , "0123456789"),0),21))

EXTRACT FIELDS VM_EM Vndr_Site_ID Vndr_ID c_Tel1 AS "Tel" IF Vndr_Sts='A' AND LENGTH(ALLTRIM(c_Tel1))>3 TO "%fld_Tmps%TMP1" 
EXTRACT FIELDS VM_EM Vndr_Site_ID Vndr_ID c_Tel2 AS "Tel" IF Vndr_Sts='A' AND LENGTH(ALLTRIM(c_Tel2))>3 TO "%fld_Tmps%TMP1" APPEND
EXTRACT FIELDS VM_EM Vndr_Site_ID Vndr_ID c_Tel3 AS "Tel" IF Vndr_Sts='A' AND LENGTH(ALLTRIM(c_Tel3))>3 TO "%fld_Tmps%TMP1" APPEND
EXTRACT FIELDS VM_EM Vndr_Site_ID Vndr_ID c_Fax AS "Tel" IF Vndr_Sts='A' AND LENGTH(ALLTRIM(c_Fax))>3 TO "%fld_Tmps%TMP1" APPEND


OPEN TMP1
DELETE FIELD KEY OK
DEFINE FIELD KEY COMPUTED SUBSTR(ALLTRIM(VM_EM)+ALLTRIM(Vndr_ID),1,22)

DELETE FIELD c_Tel OK
DEFINE FIELD c_Tel COMPUTED 

ALLTRIM(STRING(VALUE(SUBSTR(Tel, 3, 19),0),16)) IF SUBSTR( Tel, 1, 2) = "61"  AND LENGTH(ALLTRIM(Tel))>7
Tel

COMMENT Fine for ACL 11
SUMMARIZE ON VM_EM Vndr_ID c_Tel KEY OTHER Vndr_Site_ID TO "%fld_Tmps%TMP2.FIL" OPEN PRESORT

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP_TEL" OPEN
DUPLICATES ON c_Tel OTHER KEY Vndr_Site_ID Vndr_ID PRESORT OPEN TO "%fld_Tmps%TMP2.FIL"

DELETE FIELD DUP_KEY OK
DEFINE FIELD DUP_KEY COMPUTED ALLTRIM(c_Tel)

DEFINE RELATION KEY WITH Vnd_Emp_Master INDEX IDX_VNDEMP_KEY

EXTRACT FIELDS DUP_KEY KEY Vnd_Emp_Master.VM_EM Vnd_Emp_Master.Vndr_Site_ID Vnd_Emp_Master.Vndr_ID Vnd_Emp_Master.Vndr_Nme Vnd_Emp_Master.ABN Vnd_Emp_Master.Vndr_Sts Vnd_Emp_Master.Vndr_Typ Vnd_Emp_Master.BSB Vnd_Emp_Master.Bnk_Acc_Num Vnd_Emp_Master.ADD1 Vnd_Emp_Master.ADD2 Vnd_Emp_Master.ADD3 Vnd_Emp_Master.City Vnd_Emp_Master.State Vnd_Emp_Master.Pcode Vnd_Emp_Master.Cntry Vnd_Emp_Master.TEL1 Vnd_Emp_Master.TEL2 Vnd_Emp_Master.TEL3 Vnd_Emp_Master.FAX Vnd_Emp_Master.Email1 Vnd_Emp_Master.Email2 Vnd_Emp_Master.Inv_Amt Vnd_Emp_Master.GST_AMT Vnd_Emp_Master.COUNT Vnd_Emp_Master.Hire_Dt Vnd_Emp_Master.Trm_Dt Vnd_Emp_Master.Created_Dt Vnd_Emp_Master.Modf_Dt IF KEY=Vnd_Emp_Master.KEY TO %fld_Tmps%TMP3 OPEN


COMM *** Only show dups across Vendor and HR Employee
SUMMARIZE ON DUP_KEY IF VM_EM="EM" TO "%fld_Tmps%TMP5_1.FIL" PRESORT
SUMMARIZE ON DUP_KEY IF VM_EM<>"EM" AND Vndr_Typ<>"EM" TO "%fld_Tmps%TMP5_2.FIL" PRESORT

OPEN TMP5_1
OPEN TMP5_2 SECONDARY
JOIN PKEY DUP_KEY FIELDS DUP_KEY SKEY DUP_KEY WITH DUP_KEY TO "%fld_Tmps%TMP4" OPEN PRESORT MANY SECSORT
CLOSE SECONDARY

INDEX ON DUP_KEY TO IDX_TMP4_DUP_KEY

OPEN TMP3
DEFINE RELATION DUP_KEY WITH TMP4 INDEX IDX_TMP4_DUP_KEY

EXTRACT FIELDS ALL IF NOT ISBLANK(TMP4.DUP_KEY) TO "%fld_Tmps%TMP5" OPEN

COMM *** Begin Clean Dup Tel exists in dup Address ***
EXTRACT KEY FIRST 0 TO "%fld_Tmps%TMP_Dups"

IF FTYPE("VM014_VndEmp_BankAcc")="y" AND (FILESIZE("%fld_History%VM014_History.fil") >0 AND FTYPE("VM014_History")="y") OPEN VM014_History
IF FTYPE("VM014_VndEmp_BankAcc")="y" AND (FILESIZE("%fld_History%VM014_History.fil") <=0 OR FTYPE("VM014_History")<>"y") OPEN VM014_VndEmp_BankAcc
IF FTYPE("VM014_VndEmp_BankAcc")="y" AND (FTYPE("VM014_History")="y" OR FTYPE("VM014_VndEmp_BankAcc")="y") EXTRACT KEY TO "%fld_Tmps%TMP_Dups" APPEND

IF FTYPE("VM015_VndEmp_Add")="y" AND (FILESIZE("%fld_History%VM015_History.fil") >0 AND FTYPE("VM015_History")="y") OPEN VM015_History
IF FTYPE("VM015_VndEmp_Add")="y" AND (FILESIZE("%fld_History%VM015_History.fil") <=0 OR FTYPE("VM015_History")<>"y") OPEN VM015_VndEmp_Add
IF FTYPE("VM015_VndEmp_Add")="y" AND (FTYPE("VM015_History")="y" OR FTYPE("VM015_VndEmp_Add")="y") EXTRACT KEY TO "%fld_Tmps%TMP_Dups" APPEND

OPEN TMP_Dups
INDEX ON KEY TO IDX_VND_DUP_A

OPEN TMP5
DEFINE RELATION KEY WITH TMP_Dups INDEX IDX_VND_DUP_A

SUMMARIZE ON DUP_KEY IF ISBLANK(TMP_Dups.KEY) TO "%fld_Tmps%TMP2.FIL" OPEN PRESORT
INDEX ON DUP_KEY TO IDX_TMP2_DUP_KEY

OPEN TMP5
DEFINE RELATION DUP_KEY WITH TMP2 INDEX IDX_TMP2_DUP_KEY

EXTRACT FIELDS ALL IF DUP_KEY= TMP2.DUP_KEY TO %fld_Tmps%TMP4 OPEN 

COMM *** End clean***

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(KEY)+"~"+ALLTRIM(DUP_KEY),1,85)

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
v_DUP_KEY="DUP_KEY"
v_Filter=""
IF v_Exc_History =T DO AE001_Dup_History
IF v_Chk_CCM=T DO AE006_Dup_CCM
COMM *** End ***

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "VM016. Vendor details matching employee details on Telephone No/Mobile/Next of Kin Number"

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(DUP_KEY)+ALLTRIM(VM_EM)+ALLTRIM(Vndr_Site_ID) ,1,50)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "c_Tel VM_EM Vndr_Site_ID"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /Results
SORT ON SORT_KEY D  TO "%fld_Results%VM016_VndEmp_DTel" OPEN

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    EM005_Dup_Tel                      
[PARENT_FOLDER_ID] 1340167410
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Employee Master File Exception Tests
COMM *** EM005. Identify duplicate employees: by Telephone No.
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_EMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_EMF")="U" DO AA002_Variable_Setting
IF FTYPE("EMF_TMP_Emp")<>"y" OR FILESIZE("%fld_Workings%EMF_TMP_Emp.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="EM005"

OPEN EMF_TMP_Emp

DELETE FIELD c_Tel1 OK
DEFINE FIELD c_Tel1 COMPUTED ALLTRIM(STRING(VALUE(INCLUDE(TEL1, "0123456789"),0),21))
DELETE FIELD c_Tel2 OK
DEFINE FIELD c_Tel2 COMPUTED ALLTRIM(STRING(VALUE(INCLUDE(TEL2, "0123456789"),0),21))
DELETE FIELD c_Tel3 OK
DEFINE FIELD c_Tel3 COMPUTED ALLTRIM(STRING(VALUE(INCLUDE(TEL3, "0123456789"),0),21))
DELETE FIELD c_Fax OK
DEFINE FIELD c_Fax COMPUTED ALLTRIM(STRING(VALUE(INCLUDE(FAX, "0123456789"),0),21))

EXTRACT FIELDS Co_Emp_ID c_Tel1 AS "Tel" IF Emp_Sts<>"I" AND LENGTH(ALLTRIM(c_Tel1))>3  TO "%fld_Tmps%TMP1" 
EXTRACT FIELDS Co_Emp_ID c_Tel2 AS "Tel" IF Emp_Sts<>"I" AND LENGTH(ALLTRIM(c_Tel2))>3 TO "%fld_Tmps%TMP1" APPEND
EXTRACT FIELDS Co_Emp_ID c_Tel3 AS "Tel" IF Emp_Sts<>"I" AND LENGTH(ALLTRIM(c_Tel3))>3 TO "%fld_Tmps%TMP1" APPEND
EXTRACT FIELDS Co_Emp_ID c_Fax AS "Tel" IF Emp_Sts<>"I" AND LENGTH(ALLTRIM(c_Fax))>3 TO "%fld_Tmps%TMP1" OPEN APPEND

DELETE FIELD c_Tel OK
DEFINE FIELD c_Tel COMPUTED 

ALLTRIM(STRING(VALUE(SUBSTR(Tel, 3, 19),0),21)) IF SUBSTR( Tel, 1, 2) = "61"  AND LENGTH(ALLTRIM(Tel))>7
Tel

SUMMARIZE ON Tel Co_Emp_ID c_Tel TO "%fld_Tmps%TMP10.FIL" OPEN PRESORT

COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP_TEL" OPEN
DUPLICATES ON c_Tel OTHER Co_Emp_ID Tel PRESORT OPEN TO "%fld_Tmps%TMP1.FIL"

DELETE FIELD DUP_KEY OK
DEFINE FIELD DUP_KEY COMPUTED ALLTRIM(Tel)

INDEX ON Co_Emp_ID TO IDX_TMP

OPEN EMF_TMP_Emp
DEFINE RELATION Co_Emp_ID WITH TMP1 INDEX IDX_TMP

EXTRACT FIELDS %v_flds_EMF% TMP1.DUP_KEY TMP1.c_Tel BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN IF NOT ISBLANK(TMP1.Co_Emp_ID)  TO "%fld_Tmps%TMP4" OPEN

COMM *** Begin Clean Dup Bank Acc exists in dup Address ***
EXTRACT FIELDS Co_Emp_ID FIRST 0 TO "%fld_Tmps%TMP_Dups"

IF FILESIZE("%fld_Results%EM001_Dup_TFN.fil")>=0 AND (FILESIZE("%fld_History%EM001_History.fil") >0 AND FTYPE("EM001_History")="y") OPEN EM001_History
IF FILESIZE("%fld_Results%EM001_Dup_TFN.fil")>=0 AND (FILESIZE("%fld_History%EM001_History.fil") <=0 OR FTYPE("EM001_History")<>"y") OPEN EM001_Dup_TFN
IF FILESIZE("%fld_Results%EM001_Dup_TFN.fil")>=0 AND (FTYPE("EM001_History")="y" OR FILESIZE("%fld_Results%EM001_Dup_TFN.fil")>=0) EXTRACT FIELDS Co_Emp_ID TO "%fld_Tmps%TMP_Dups" APPEND

IF FILESIZE("%fld_Results%EM002_Dup_BnkAcc.fil")>=0 AND (FILESIZE("%fld_History%EM002_History.fil") >0 AND FTYPE("EM002_History")="y") OPEN EM002_History
IF FILESIZE("%fld_Results%EM002_Dup_BnkAcc.fil")>=0 AND (FILESIZE("%fld_History%EM002_History.fil") <=0 OR FTYPE("EM002_History")<>"y") OPEN EM002_Dup_BnkAcc
IF FILESIZE("%fld_Results%EM002_Dup_BnkAcc.fil")>=0 AND (FTYPE("EM002_History")="y" OR FILESIZE("%fld_Results%EM002_Dup_BnkAcc.fil")>=0) EXTRACT FIELDS Co_Emp_ID TO "%fld_Tmps%TMP_Dups" APPEND

IF FILESIZE("%fld_Results%EM003_Dup_Nme.fil")>=0 AND (FILESIZE("%fld_History%EM003_History.fil") >0 AND FTYPE("EM003_History")="y") OPEN EM003_History
IF FILESIZE("%fld_Results%EM003_Dup_Nme.fil")>=0 AND (FILESIZE("%fld_History%EM003_History.fil") <=0 OR FTYPE("EM003_History")<>"y") OPEN EM003_Dup_Nme
IF FILESIZE("%fld_Results%EM003_Dup_Nme.fil")>=0 AND (FTYPE("EM003_History")="y" OR FILESIZE("%fld_Results%EM003_Dup_Nme.fil")>=0) EXTRACT FIELDS Co_Emp_ID TO "%fld_Tmps%TMP_Dups" APPEND

IF FILESIZE("%fld_Results%EM004_Dup_Add.fil")>=0 AND (FILESIZE("%fld_History%EM004_History.fil") >0 AND FTYPE("EM004_History")="y") OPEN EM004_History
IF FILESIZE("%fld_Results%EM004_Dup_Add.fil")>=0 AND (FILESIZE("%fld_History%EM004_History.fil") <=0 OR FTYPE("EM004_History")<>"y") OPEN EM004_Dup_Add
IF FILESIZE("%fld_Results%EM004_Dup_Add.fil")>=0 AND (FTYPE("EM004_History")="y" OR FILESIZE("%fld_Results%EM004_Dup_Add.fil")>=0) EXTRACT FIELDS Co_Emp_ID TO "%fld_Tmps%TMP_Dups" APPEND

OPEN TMP_Dups
INDEX ON Co_Emp_ID TO IDX_VND_DUP_A

OPEN TMP4
DEFINE RELATION Co_Emp_ID WITH TMP_Dups INDEX IDX_VND_DUP_A

SUMMARIZE ON DUP_KEY IF Co_Emp_ID  <> TMP_Dups.Co_Emp_ID  TO "%fld_Tmps%TMP2.FIL" OPEN PRESORT

OPEN TMP2
INDEX ON DUP_KEY TO IDX_TMP2_Dup_KEY

OPEN TMP4
DEFINE RELATION DUP_KEY WITH TMP2 INDEX IDX_TMP2_Dup_KEY

EXTRACT FIELDS ALL IF NOT ISBLANK(TMP2.DUP_KEY) TO "%fld_Tmps%TMP3" OPEN
COMM *** End clean***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(DUP_KEY),1,85)
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
v_DUP_KEY="DUP_KEY"
v_Filter=""
IF v_Exc_History =T DO AE001_Dup_History
IF v_Chk_CCM=T DO AE006_Dup_CCM
COMM *** End ***

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP1" OPEN

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(DUP_KEY)+"~"+ZONED(Total_PayAmt,12)+"~"+ALLTRIM(Co_Emp_ID)1,64)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Telephone Total_PayAmt EmpCd"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  _RptRunDate 

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "EM005. Identify duplicate employees: By Telephone(s)"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%EM005_Dup_Tel" 

OPEN EMF_TMP_Emp
DELETE RELATION TMP1 OK

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    AP008_Exc_Alw_Limit                
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP008. Identify requisition where authorisation for payment exceeds the allowed limit 
COMM *** Limit to be a parameter entered 
COMM *** Will require authorisation limits by requestor 
COMM *** Dependant on data availability 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_AP_Inv")="U" OR FTYPE("trg_AP_Inv")="U" DO AA002_Variable_Setting
IF FTYPE("TXT_AP008_AllowLimit")="U" DO AC002_Test_Var_Input

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="AP008"

DELETE FORMAT AP_TMP OK
DELETE "%fld_Tmps%AP_TMP.FIL" OK

OPEN AP_Invoices

EXTRACT VALUE(TXT_AP008_AllowLimit,0) AS "AllowLimit" %v_flds_AP_Inv% IF Inv_Amt> VALUE(TXT_AP008_AllowLimit,0)  TO "%fld_Tmps%AP_TMP" OPEN

OPEN AP_TMP

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_Site_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vchr_ID),1,85)

COMM *** Start remove historical dups ***
v_ID_KEY=""
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD DiffAmt OK
DEFINE FIELD DiffAmt COMPUTED DEC(AllowLimit-Inv_Amt,2)

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ZONED(AllowLimit,12)+ZONED(ABS_INVAMT,12)+ALLTRIM(Vndr_ID)+"~" +ALLTRIM(c_Inv_Dt),1,64)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "AllowLimited Inv_Amt Vndr_ID c_Inv_Dt D"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "H"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP008.Identify requisition where authorisation for payment exceeds the allowed limit"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%AP008_Exc_Alw_Limit" 

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON

^BATCH    AP009_GST_Over_Char                
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP009. Identify invoices with GST tax overcharges: GST value <> 10% (Australia 10%, NZL: 13.5%)
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_AP_Inv")="U" OR FTYPE("trg_AP_Inv")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="AP009"

OPEN AP_Invoices
DELETE FIELD GST_Pct OK
DEFINE FIELD GST_Pct COMPUTED 

DEC((GST_Amt/Inv_Net_Amt)*100,2) IF Inv_Net_Amt<>0.00
DEC(GST_AMT/(Inv_Amt-GST_Amt) *100,2) IF Inv_Net_Amt=0.00 AND Inv_Amt-GST_Amt<>0.00
100

COMM *** SUBSTR(ALLTRIM(VMF_Vnd_Master_File.Curncy),1,3)="AUS" ***
COMM ***Australia 10%*** 
EXTRACT FIELDS ALL IF (Inv_Amt_Loc >= 1.00 OR Inv_Amt_Loc <= -1.00) AND GST_Amt<>0 AND GST_Pct>10.05 AND NOT MATCH(VMF_Vnd_Master_File.Cntry,"NEW ZEALAND","NZ") AND NOT FIND("AUCKLAND",VMF_Vnd_Master_File.City ) TO %fld_Tmps%AP_TMP 
COMM ***New Zealand 15%***
EXTRACT FIELDS ALL IF (Inv_Amt_Loc >= 1.00 OR Inv_Amt_Loc <= -1.00) AND GST_Amt<>0 AND GST_Pct>15.05 AND ( MATCH(VMF_Vnd_Master_File.Cntry,"NEW ZEALAND","NZ") OR  FIND("AUCKLAND",VMF_Vnd_Master_File.City )) TO %fld_Tmps%AP_TMP OPEN APPEND

OPEN AP_TMP
COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_Site_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vchr_ID),1,85)

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ZONED(GST_Pct,12)+ZONED(ABS_INVAMT,12)+ALLTRIM(Vndr_ID) +ALLTRIM(c_Inv_Dt),1,64)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "GST_Pct Inv_Amt Vndr_ID c_Inv_Dt D"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP009.Identify invoices with GST tax overcharges (AUS>10%,NZL>15.5%)"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%AP009_GST_Over_Char" OPEN
DEFINE RELATION Vndr_Site_ID WITH VMF_Vnd_Master_File INDEX IDX_VndrSiteID

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    AP010_Large_Inv                    
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP010. Extract large invoice payments excluding any intercompany transactions 
COMM *** 2 Ratio Analysis where the largest value is a % greater than average values for this vendor 
COMM *** % to be specified as a parameter 
COMM ***    Inpute TXT_AP010_Pct (default: 75%)
COMM *** with more than 5 transactions
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_AP_Inv")="U" OR FTYPE("trg_AP_Inv")="U" DO AA002_Variable_Setting
IF FTYPE("TXT_AP010_Pct")="U" OR FTYPE("TXT_AP010_Cnt")="U" DO AC002_Test_Var_Input

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="AP010"

OPEN AP_Invoices
DEFINE RELATION Vndr_Site_ID WITH VMF_InterCompany INDEX IDX_VMF_InterCo_VndrSiteID
DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum INDEX IDX_AP_Sum_VndrID


SORT ON Vndr_Site_ID Vndr_ID Inv_Amt D Inv_Dt IF Inv_Amt>0 AND ISBLANK(VMF_InterCompany.Vndr_Site_ID) AND AP_Vnd_InvGst_Sum.COUNT>VALUE(TXT_AP010_Cnt,0) TO TMP1 OPEN

SUMMARIZE ON Vndr_Site_ID Vndr_ID SUBTOTAL Inv_Net_Amt Inv_Amt GST_Amt IF Inv_Amt > 0.00 TO "%fld_Tmps%TMP2" PRESORT OPEN
INDEX ON Vndr_Site_ID TO IDX_TMP2_VndrSiteID

DELETE FIELD Avg_Inv_Amt OK
DEFINE FIELD Avg_Inv_Amt COMPUTED DEC(Inv_Amt/COUNT,2)

COMM *** Invoices where Invoice Amount >0.00 ***
OPEN TMP1
DEFINE RELATION Vndr_Site_ID WITH TMP2 INDEX IDX_TMP2_VndrSiteID

DELETE FIELD c_Largest
DEFINE FIELD c_Largest COMPUTED   
Largest Amount            
1 IF Vndr_ID <> RECOFFSET(Vndr_ID,-1)
0

DELETE FIELD c_Smallest
DEFINE FIELD c_Smallest COMPUTED   
Smallest Amount              
1 IF Vndr_ID <> RECOFFSET(Vndr_ID,1)
0

DELETE FIELD c_Second
DEFINE FIELD c_Second COMPUTED   
Second Largest Amount              
1 IF Vndr_ID = RECOFFSET(Vndr_ID,-1) and RECOFFSET(c_Largest,-1)=1
0

DELETE FIELD c_Inv_Avg_Pct OK
DEFINE FIELD c_Inv_Avg_Pct COMPUTED DEC(100*((Inv_Amt-TMP2.Avg_Inv_Amt)/TMP2.Avg_Inv_Amt),2)

COMM *** Lagest of Vendor ***
OPEN TMP1
EXTRACT FIELDS c_Largest %v_flds_AP_Inv% IF c_Largest=1 TO "%fld_Tmps%TMP1_Large" OPEN
INDEX ON Vndr_Site_ID TO IDX_TMP1_L_VndrSiteID

COMM *** Smallest of Vendor ***
OPEN TMP1
EXTRACT FIELDS c_Smallest %v_flds_AP_Inv% IF c_Smallest=1 TO "%fld_Tmps%TMP1_Small" OPEN
INDEX ON Vndr_Site_ID TO IDX_TMP1_S_VndrSiteID

COMM *** Second Lagest of Vendor ***
OPEN TMP1
EXTRACT c_Second %v_flds_AP_Inv% IF c_Second=1 TO "%fld_Tmps%TMP1_Second" OPEN
INDEX ON Vndr_Site_ID TO IDX_TMP1_SL_VndrSiteID

COMM *** Invoices with amount larger than Avg Inv Amt 75% *** 
OPEN TMP1
EXTRACT FIELDS c_Inv_Avg_Pct TMP2.Avg_Inv_Amt %v_flds_AP_Inv% IF c_Inv_Avg_Pct>VALUE(TXT_AP010_Pct,2) TO "%fld_Tmps%TMP3"

OPEN TMP3
SUMMARIZE ON Vndr_Site_ID Vndr_ID SUBTOTAL Inv_Amt IF Inv_Amt > 0.00 TO "%fld_Tmps%TMP4" PRESORT OPEN
OPEN TMP4
DEFINE RELATION Vndr_Site_ID WITH TMP2 INDEX IDX_TMP2_VndrSiteID
DEFINE RELATION Vndr_Site_ID WITH TMP1_Large INDEX IDX_TMP1_L_VndrSiteID
DEFINE RELATION Vndr_Site_ID WITH TMP1_Small INDEX IDX_TMP1_S_VndrSiteID
DEFINE RELATION Vndr_Site_ID WITH TMP1_Second INDEX IDX_TMP1_SL_VndrSiteID
DEFINE RELATION Vndr_Site_ID WITH VMF_Vnd_Master_File INDEX IDX_VndrSiteID

COMM *** Summarize the information at vendor level ***
EXTRACT FIELDS Vndr_Site_ID Vndr_ID VMF_Vnd_Master_File.Vndr_Nme VMF_Vnd_Master_File.Vndr_Sts VMF_Vnd_Master_File.Vndr_Typ TMP2.Inv_Amt AS "Ttl_Inv_Amt" TMP2.Avg_Inv_Amt TMP2.COUNT AS "Ttl_Count" Inv_Amt AS "Ttl_Inv_Amt_75" COUNT AS "Count_75" TMP1_Large.Inv_No AS "Max_Inv_No" TMP1_Large.Inv_Amt AS "Max_Inv_Amt" TMP1_Second.Inv_No AS "Snd_Inv_No" TMP1_Second.Inv_Amt AS "Snd_Inv_Amt"  TMP1_Small.Inv_No AS "Min_Inv_No" TMP1_Small.Inv_Amt AS "Min_Inv_Amt" TO "%fld_Tmps%TMP5" 

OPEN TMP5

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_Site_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED ALLTRIM(Vndr_Site_ID)+"~"+ALLTRIM(STRING(Max_Inv_Amt,85))
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD c_Max_Snd_Pct OK
DEFINE FIELD c_Max_Snd_Pct COMPUTED DEC(100*((Max_Inv_Amt-Snd_Inv_Amt)/Snd_Inv_Amt),2)

DELETE FIELD c_Max_Avg_Pct OK
DEFINE FIELD c_Max_Avg_Pct COMPUTED DEC(100*((Max_Inv_Amt-Avg_Inv_Amt)/Avg_Inv_Amt),2)

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ZONED(c_Max_Avg_Pct,8)+ZONED(Max_Inv_Amt,15)+ALLTRIM(Vndr_ID),1,43) 

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Inv_Avg_Pct Max_Inv_Amt Vndr_ID D"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP010.Extract Large Invoice Excluding any intercompany transactions (>%TXT_AP010_Pct%% than average vendor Inv Amt) - Vendor (Total Transaction Number>%TXT_AP010_Cnt%)"

SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%AP010_Large_Inv" OPEN
DEFINE RELATION Vndr_Site_ID WITH VMF_Vnd_Master_File INDEX IDX_VndrSiteID

COMM *** Details ***
OPEN TMP3
DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ALLTRIM(ZONED(c_Inv_Avg_Pct,8))+ALLTRIM(ZONED(Inv_Amt,15))+ALLTRIM(Vndr_ID) 

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Inv_Avg_Pct Inv_Amt Vndr_ID D"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP010D.Extract Large Invoice Excluding any intercompany transactions (>%TXT_AP010_Pct%% than average vendor Inv Amt) - Invoice"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

SORT ON SORT_KEY D TO "%fld_Results%AP010D_Large_Inv" OPEN
DEFINE RELATION Vndr_Site_ID WITH VMF_Vnd_Master_File INDEX IDX_VndrSiteID

OPEN TMP4
DELETE RELATION VMF_Vnd_Master_File OK

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    AP011_PODt_Aft_InvDt               
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP011. Identify Invoices with PO date after invoice date (if PO Data available)
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_PO")="U" OR FTYPE("trg_AP_PO")="U" DO AA002_Variable_Setting
IF FTYPE("%trg_AP_PO%")<>"y" OR FILESIZE("%fld_Workings%%trg_AP_PO%.fil")<=0 Errmsg=Errmsg+" AP011"
IF FTYPE("%trg_AP_PO%")<>"y" OR FILESIZE("%fld_Workings%%trg_AP_PO%.fil")<=0 ESCAPE


SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="AP011"

OPEN AP_PO_Vnd_Sum
DELETE FIELD VND_PO_ID OK
DEFINE FIELD VND_PO_ID COMPUTED SUBSTR(ALLTRIM(Vndr_Site_ID) + ALLTRIM(PO_NO),1,40)
INDEX ON PO_NO TO IDX_PO_PO_NO
INDEX ON VND_PO_ID TO IDX_PO_Vnd_Po_ID

OPEN AP_Invoices
INDEX ON Vchr_ID TO IDX_Inv_VchrID

OPEN AP_InvPO
DEFINE RELATION Vchr_ID WITH AP_Invoices INDEX IDX_Inv_VchrID
DELETE FIELD VND_PO_ID OK
DEFINE FIELD VND_PO_ID COMPUTED SUBSTR(ALLTRIM(AP_Invoices.Vndr_Site_ID) + ALLTRIM(PO_NO),1,40)

DEFINE RELATION VND_PO_ID WITH AP_PO_Vnd_Sum INDEX IDX_PO_Vnd_Po_ID

COMM SET FILTER TO NOT ISBLANK(AP_PO_Vnd_Sum.PO_NO) AND  ((AP_PO_Vnd_Sum.PO_Date>Inv_Dt) OR (AP_PO_Vnd_Sum.PO_Date>Pst_Dt))

SET FILTER TO NOT ISBLANK(AP_PO_Vnd_Sum.PO_NO) AND  (AP_PO_Vnd_Sum.PO_Date>AP_Invoices.Inv_Dt) 
EXTRACT FIELDS %v_flds_AP_Inv1% AP_PO_Vnd_Sum.PO_NO AP_PO_Vnd_Sum.Amount AP_PO_Vnd_Sum.Rec_Amt AP_PO_Vnd_Sum.PO_Qty AP_PO_Vnd_Sum.Rec_Qty AP_PO_Vnd_Sum.PO_Date AP_PO_Vnd_Sum.Rec_Dt TO "%fld_Tmps%TMP1" OPEN

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_Site_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vchr_ID)+"~"+ALLTRIM(PO_NO),1,85)
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD Days OK
DEFINE FIELD Days COMPUTED AGE( Inv_Dt,PO_Date )

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ZONE(Days,5)+ALLTRIM(Vndr_ID) +ALLTRIM(ZONED(Inv_Amt,15))+ALLTRIM(c_Inv_Dt),1,50)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Vndr_ID Inv_Amt Inv_Dt D"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP011.Identify Invoices with PO date after Invoice Date"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%AP011_PODt_Aft_InvDt" OPEN
DEFINE RELATION Vndr_Site_ID WITH %trg_VMF% INDEX IDX_VndrSiteID

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    AP012_POs_No_Goods                 
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP0012.Identify POs that are paid for but no goods/services received (if PO Data available)
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_PO")="U" OR FTYPE("trg_AP_PO")="U" DO AA002_Variable_Setting
IF FTYPE("%trg_AP_PO%")<>"y" OR FILESIZE("%fld_Workings%%trg_AP_PO%.fil")<=0 OR FTYPE("AP_InvPO")<>"y" Errmsg=Errmsg+" AP012"
IF FTYPE("%trg_AP_PO%")<>"y" OR FILESIZE("%fld_Workings%%trg_AP_PO%.fil")<=0 OR FTYPE("AP_InvPO")<>"y" ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="AP012"

OPEN AP_PO_Vnd_Sum
DELETE FIELD VND_PO_ID OK
DEFINE FIELD VND_PO_ID COMPUTED SUBSTR(ALLTRIM(Vndr_Site_ID) + ALLTRIM(PO_NO),1,40)
INDEX ON PO_NO TO IDX_PO_PO_NO
INDEX ON VND_PO_ID TO IDX_PO_Vnd_Po_ID

OPEN AP_Invoices
INDEX ON Vchr_ID TO IDX_Inv_VchrID

OPEN AP_InvPO
DEFINE RELATION Vchr_ID WITH AP_Invoices INDEX IDX_Inv_VchrID
DELETE FIELD VND_PO_ID OK
DEFINE FIELD VND_PO_ID COMPUTED SUBSTR(ALLTRIM(AP_Invoices.Vndr_Site_ID) + ALLTRIM(PO_NO),1,40)

DEFINE RELATION VND_PO_ID WITH AP_PO_Vnd_Sum INDEX IDX_PO_Vnd_Po_ID

SET FILTER TO AP_Invoices.isPaid="Y" AND NOT ISBLANK(AP_Invoices.Vchr_ID) AND (AP_PO_Vnd_Sum.Rec_Qty=0.00 OR ISBLANK(AP_PO_Vnd_Sum.PO_NO))
EXTRACT FIELDS %v_flds_AP_Inv1% PO_NO AP_PO_Vnd_Sum.Amount AP_PO_Vnd_Sum.Rec_Amt AP_PO_Vnd_Sum.PO_Qty AP_PO_Vnd_Sum.Rec_Qty AP_PO_Vnd_Sum.PO_Date AP_PO_Vnd_Sum.Rec_Dt TO "%fld_Tmps%TMP1" OPEN

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_Site_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vchr_ID)+'~'+ALLTRIM(PO_NO),1,85)
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ZONED(Amount,15)+ALLTRIM(PO_NO)+ALLTRIM(Vndr_ID),1,50)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "PO_Amount PO_NO Vndr_ID D"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP012.Identify POs that are paid for but no goods / services received"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%AP012_POs_No_Goods" OPEN
DEFINE RELATION Vndr_Site_ID WITH %trg_VMF% INDEX IDX_VndrSiteID

OPEN AP_InvPO
DELETE RELATION AP_PO_Vnd_Sum OK
DELETE RELATION AP_Invoices OK

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    AP013_PO_Mul_Diff_Vnd              
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP013. Identify invoices where a PO is used multiple times but with different vendors 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_PO")="U" OR FTYPE("trg_AP_PO")="U" DO AA002_Variable_Setting
IF FTYPE("%trg_AP_PO%")<>"y" OR FILESIZE("%fld_Workings%%trg_AP_PO%.fil")<=0 Errmsg=Errmsg+" AP013"
IF FTYPE("%trg_AP_PO%")<>"y" OR FILESIZE("%fld_Workings%%trg_AP_PO%.fil")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="AP013"

IF FTYPE("AP_PO_Vnd_Sum")<>"y" OR FILESIZE("%fld_Workings%AP_PO_Vnd_Sum.FIL")<0  ESCAPE

OPEN AP_PO_Vnd_Sum
DELETE FIELD VND_PO_ID OK
DEFINE FIELD VND_PO_ID COMPUTED SUBSTR(ALLTRIM(Vndr_Site_ID) + ALLTRIM(PO_NO),1,40)
INDEX ON PO_NO TO IDX_PO_PO_NO
INDEX ON VND_PO_ID TO IDX_PO_Vnd_Po_ID

OPEN AP_Invoices
INDEX ON Vchr_ID TO IDX_Inv_VchrID

OPEN AP_InvPO
DEFINE RELATION Vchr_ID WITH AP_Invoices INDEX IDX_Inv_VchrID
DELETE FIELD VND_PO_ID OK
DEFINE FIELD VND_PO_ID COMPUTED SUBSTR(ALLTRIM(AP_Invoices.Vndr_Site_ID) + ALLTRIM(PO_NO),1,40)

DEFINE RELATION VND_PO_ID WITH AP_PO_Vnd_Sum INDEX IDX_PO_Vnd_Po_ID

SET FILTER AP_Invoices.ABS_INVAMT<>0.00 
DUPLICATES ON PO_NO OTHER %v_flds_AP_Inv1% PRESORT OPEN TO "%fld_Tmps%AP_TMP.FIL"

OPEN AP_TMP
DELETE FIELD DUP_KEY OK
DEFINE FIELD DUP_KEY COMPUTED ALLTRIM(PO_NO)

COMM *** identify DIFF Vendor ***
OPEN AP_TMP
DUPLICATES ON PO_NO Vndr_ID OTHER Vchr_ID DUP_KEY PRESORT TO "%fld_Tmps%AP_TMP3.FIL" OPEN
INDEX ON Vchr_ID TO AP_TMP3_ID

OPEN AP_TMP
DEFINE RELATION Vchr_ID WITH AP_TMP3 INDEX AP_TMP3_ID

SUMMARIZE ON DUP_KEY IF Vchr_ID<> AP_TMP3.Vchr_ID TO "%fld_Tmps%AP_TMP2.FIL" OPEN PRESORT

INDEX ON DUP_KEY TO AP_TMP2_DUP_KEY

OPEN AP_TMP
DEFINE RELATION DUP_KEY WITH AP_TMP2 AP_TMP2_DUP_KEY

EXTRACT FIELDS ALL IF DUP_KEY= AP_TMP2.DUP_KEY TO "%fld_Tmps%TMP_AP_DUPS" OPEN

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_Site_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vchr_ID)+"~"+ALLTRIM(PO_NO),1,85)
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(PO_NO) +ALLTRIM(Vndr_ID) +ALLTRIM(c_Inv_Dt),1,50)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "PO_NO Vndr_ID c_Inv_Dt D"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP013.Identify invoices where a PO is used multiple times but with different vendors"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%AP013_PO_Mul_Diff_Vnd" OPEN
DEFINE RELATION Vndr_Site_ID WITH %trg_VMF% INDEX IDX_VndrSiteID

COMM *** Delete All the TMP files for Dups processing ***
DO AZ002_Dup_DelTmp

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    AP017_Top_xx_Vnd_xx_Mon            
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP017. Report of Top x Vendors over last xx months (e.g. 18 months, 6 months or quartely change)
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_AP_Inv")<>"U" OR FTYPE("trg_AP_Inv")="U" DO AA002_Variable_Setting
IF FTYPE("TXT_AP017_Months")="U" DO AC002_Test_Var_Input
IF FTYPE("TXT_AP017_Top")="U" DO AC002_Test_Var_Input

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

OPEN AP_Invoices
SUMMARIZE ON Vndr_Site_ID Vndr_ID SUBTOTAL Inv_Amt GST_Amt IF Inv_Amt<>0 AND Inv_Dt>=CTOD(DATE(_Data_Range_End_Date - VALUE(ALLTRIM(TXT_AP017_Months),0)*30),"DD/MM/YYYY") TO "%fld_Tmps%AP_TMP.FIL" OPEN PRESORT
INDEX ON Vndr_Site_ID TO IDX_AP_TMP_VndrSiteID

STATISTICS ON Inv_Amt TO SCREEN NUMBER TXT_AP017_Top
OPEN VMF_Vnd_Master_FIle
DEFINE RELATION Vndr_Site_ID WITH AP_TMP INDEX  IDX_AP_TMP_VndrSiteID

EXTRACT FIELDS AP_TMP.COUNT AP_TMP.Inv_Amt AP_TMP.GST_Amt %v_flds_VMF% IF AP_TMP.Inv_Amt>=HIGH1 TO "%fld_Tmps%AP_TMP1" OPEN
INDEX ON Vndr_Site_ID TO IDX_AP_TMP1_VndrSiteID

COMM *** Restults Top xx  ***

OPEN AP_TMP1
DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ZONED(Inv_Amt,15)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Inv_Amt"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
CTOD(DATE(_Data_Range_End_Date- VALUE(ALLTRIM(TXT_AP017_Months),0)*30),"DD/MM/YYYY")

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP017. Top %TXT_AP017_Top% Vendors over %TXT_AP017_Months% months"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO %fld_Results%AP017_Top_%TXT_AP017_Top%_Vnd_%TXT_AP017_Months%_Mon OPEN

INDEX ON Vndr_Site_ID TO IDX_AP017_VndrSiteID


COMM *** Get the Details for the TOP xx***
SET FOLDER /%fld_Tmps%

OPEN AP_Invoices
DEFINE RELATION Vndr_Site_ID WITH AP017_Top_%TXT_AP017_Top%_Vnd_%TXT_AP017_Months%_Mon INDEX IDX_AP017_VndrSiteID

EXTRACT %v_flds_AP_Inv% IF NOT ISBLANK(AP017_Top_%TXT_AP017_Top%_Vnd_%TXT_AP017_Months%_Mon.Vndr_ID) AND Inv_Amt<>0 AND Inv_Dt>=CTOD(DATE(_RptRunDate- VALUE(ALLTRIM(TXT_AP017_Months),0)*30),"DD/MM/YYYY")  TO "%fld_Tmps%AP_TMP2"

OPEN AP_TMP2
DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+ALLTRIM(c_Inv_Dt)+ALLTRIM(Inv_No),1,50)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Vndr_ID c_Inv_Dt Inv_No"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
CTOD(DATE(_RptRunDate- VALUE(ALLTRIM(TXT_AP017_Months),0)*30),"DD/MM/YYYY")

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP017D. Top %TXT_AP017_Top% Vendors over %TXT_AP017_Months% months - Details"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO %fld_Results%AP017D_Top_%TXT_AP017_Top%_Vnd_%TXT_AP017_Months%_Mon OPEN

OPEN AP_Invoices
DELETE RELATION AP017_Top_%TXT_AP017_Top%_Vnd_%TXT_AP017_Months%_Mon OK
OPEN VMF_Vnd_Master_FIle
DELETE RELATION AP_TMP OK
 
COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    AP018_Near_Alw_Limit               
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP018. Identify requisition where authorisation for payment near the allowed limit 
COMM *** Limit to be a parameter entered 
COMM *** Will require authorisation limits by requestor 
COMM *** Dependant on data availability 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_AP_Inv")="U" OR FTYPE("trg_AP_Inv")="U" DO AA002_Variable_Setting
IF FTYPE("TXT_AP018_AllowLimit")="U" DO AC002_Test_Var_Input
IF FTYPE("AP_Invoices")<>"y" OR FILESIZE("%fld_Workings%AP_Invoices.FIL")<=0  ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%
v_TestNo="AP018"

DELETE FORMAT AP_TMP OK
DELETE "%fld_Tmps%AP_TMP.FIL" OK

OPEN AP_Invoices

v_AllowLimit=BLANKS(12)
v_OverLimit=BLANKS(12)

v_total=OCCURS(TXT_AP008_AllowLimit,";")

GROUP
 v_Counter=1
 LOOP WHILE v_Counter <= v_total+1
     ASSIGN v_AllowLimit=SPLIT(TXT_AP018_AllowLimit,";",v_Counter) IF OCCURS(TXT_AP018_AllowLimit,";")<>0
     ASSIGN v_AllowLimit= TXT_AP018_AllowLimit IF OCCURS(TXT_AP018_AllowLimit,";")=0
     ASSIGN v_OverLimit=ALLTRIM(v_AllowLimit) IF BETWEEN(Inv_Amt,VALUE(v_AllowLimit,2)*(1-VALUE(TXT_AP018_AllowLimit_Pct,2)/100), VALUE(v_AllowLimit,2)) 
     v_Counter = v_Counter + 1
 END 
 EXTRACT VMF_Vnd_Master_File.Vndr_Sts VALUE(v_OverLimit,0) AS "AllowLimit" %v_flds_AP_Inv% IF VALUE(v_OverLimit,0)<>0  TO "%fld_Tmps%AP_TMP" 
 v_OverLimit=BLANKS(12)
END 

OPEN AP_TMP
DELETE FIELD DiffAmt OK
DEFINE FIELD DiffAmt COMPUTED DEC(AllowLimit-Inv_Amt,2)

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_Site_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vchr_ID)+"~"+ALLTRIM(Vndr_Site_ID),1,85)
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ZONED(AllowLimit,12)+ZONED(ABS_INVAMT,12)+ALLTRIM(Vndr_ID) +ALLTRIM(c_Inv_Dt),1,54)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "AllowLimited Inv_Amt Vndr_ID c_Inv_Dt D"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "L"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP018.Identify requisition where authorisation for payment near the allowed limit"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%AP018_Near_Alw_Limit" 

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON

^BATCH    AP019_CreditNt_Paid                
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP019. Identify open credit notes without paid date
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 25/07/2012
COMM***************************************************************************

IF FTYPE("v_flds_AP_Inv")="U" OR FTYPE("trg_AP_Inv")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="AP019"


OPEN AP_Invoices

EXTRACT %v_flds_AP_Inv% IF Inv_Amt<0.00 AND ISBLANK(DATETIME(Pd_Dt)) TO "%fld_Tmps%TMP1" OPEN

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+"~"+ALLTRIM(Vchr_ID),1,86)
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+'~'+ZONED(ABS(Inv_Amt),10)+"~"+c_Inv_Dt,1,85)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Vndr_ID ABS(InvAmt) c_InvDt"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP019. Identify open credit notes without paid date"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

SET FOLDER /%fld_Results%

SORT ON SORT_KEY D TO "%fld_Results%AP019_Opn_CreditNt" 

COMM *** delete temporary files ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    AP020_Mul_Paid_Mon                 
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP020. Identify Vendors with numerous payments who could be paid on a monthly basis
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 25/07/2012
COMM***************************************************************************


IF FTYPE("v_flds_AP_Pay")="U" OR FTYPE("trg_AP_Pay")="U" DO AA002_Variable_Setting
IF FTYPE("AP_Payments")<>"y" OR FILESIZE("%fld_Workings%AP_Payments.FIL")<=0  Errmsg=Errmsg+" AP020"
IF FTYPE("AP_Payments")<>"y" OR FILESIZE("%fld_Workings%AP_Payments.FIL")<=0  ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="AP020"

OPEN AP_Payments
DELETE FIELD YM OK
DEFINE FIELD YM COMPUTED SUBSTR(SUBSTR(c_Pay_Dt,1,4)+"-"+SUBSTR(c_Pay_Dt,5,2),1,7)

DELETE FIELD c_Btch_No OK
DEFINE FIELD c_Btch_No COMPUTED INCLUDE(Btch_No,"0123456789")

DELETE FIELD Vndr_YM OK
DEFINE FIELD Vndr_YM COMPUTED SUBSTR(ALLTRIM(Vndr_Site_ID)+ALLTRIM(YM),1,24)

COMMENT COMMENT Should work with ACL 11 if Pay_Amt GST_Amt are always the same for a particular "Vndr_Site_ID Vndr_ID YM c_Btch_No Vndr_YM Pymnt_Mth"
SUMMARIZE ON Vndr_Site_ID Vndr_ID YM c_Btch_No Vndr_YM Pymnt_Mth OTHER Pay_Amt GST_Amt SUBTOTAL Pay_Net_Amt  IF NOT ISBLANK(c_Pay_No) TO "%fld_Tmps%TMP1.FIL" OPEN PRESORT

SUMMARIZE ON Vndr_Site_ID Vndr_ID YM Vndr_YM SUBTOTAL GST_Amt Pay_Amt Pay_Net_Amt TO "%fld_Tmps%TMP2.FIL" OPEN PRESORT

EXTRACT FIELD ALL IF COUNT>1 TO "%fld_Tmps%TMP3.FIL" OPEN
INDEX ON Vndr_YM  TO IDX_TMP3_Vndr_YM 

OPEN TMP1
DEFINE RELATION Vndr_YM  WITH TMP3 INDEX IDX_TMP3_Vndr_YM 

COMM *** Vendor Cheques Report ***
EXTRACT FIELDS  Vndr_YM Vndr_SIte_ID Vndr_ID YM c_Btch_No GST_Amt Pay_Amt Pay_Net_Amt COUNT AS 'Pay_Pmnt_Num' TMP3.COUNT AS 'Mon_Pmnt_Num' IF NOT ISBLANK(TMP3.Vndr_Site_ID) TO "%fld_Tmps%TMP11" OPEN

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_Site_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_YM)+"~"+ALLTRIM(c_Btch_No),1,85)
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

EXTRACT FIELDS ALL TO  "%fld_Tmps%TMP4" OPEN
INDEX ON Vndr_YM TO IDX_TMP4_Vndr_YM

COMM *** Details Report ***
OPEN AP_Payments
DEFINE RELATION Vndr_YM WITH TMP4 INDEX IDX_TMP4_Vndr_YM

EXTRACT FIELDS ALL IF NOT ISBLANK(TMP4.Vndr_YM) AND  NOT ISBLANK(c_Pay_No) TO "%fld_Tmps%TMP5" OPEN

COMM *** Results - Vendor Cheques Report***
OPEN TMP4

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ALLTRIM(Vndr_Site_ID) +ALLTRIM(YM)+ ALLTRIM(c_Btch_No)+ALLTRIM(ZONED(Mon_Pmnt_Num,5))

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Vndr_Site_ID YM Check No Mon_Pay_Num D"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "L"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP020. Identify Vendors with numerous Payments who could be paid on a monthly basis"

SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%AP020_Mul_Paid_Mon" OPEN
DEFINE RELATION Vndr_Site_ID WITH %trg_VMF% INDEX IDX_VndrSiteID

COMM *** Results - Details Report***
OPEN TMP5

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_Site_ID) + ALLTRIM(c_Pay_Dt) +ALLTRIM(c_Pay_No),1,50)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Vndr_Site_ID Pay_Dt Check No"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "L"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP020D. Identify Vendors with numerous Payments who could be paid on a monthly basis -Details"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

SET FOLDER /%fld_Results%
SORT ON SORT_KEY  TO "%fld_Results%AP020D_Mul_Paid_Mon" 

OPEN AP_Payments
DELETE RELATION TMP4 OK

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    AP021_Chq_Out_Seq                  
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP021. Identify Cheque numbers (from same vendors the date of) which is out of sequence
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 25/07/2012
COMM***************************************************************************


IF FTYPE("v_flds_AP_Pay")="U" OR FTYPE("trg_AP_Pay")="U" DO AA002_Variable_Setting
IF FTYPE("AP_Payments")<>"y" OR FILESIZE("%fld_Workings%AP_Payments.FIL")<=0 Errmsg=Errmsg+" AP021"
IF FTYPE("AP_Payments")<>"y" OR FILESIZE("%fld_Workings%AP_Payments.FIL")<=0  ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

OPEN AP_Payments

DELETE FIELD n_Chq_No OK
DEFINE FIELD n_Chq_No COMPUTED VALUE(INCLUDE(Chq_No,"0123456789"),0)

DELETE FIELD c_Chq_No OK
DEFINE FIELD c_Chq_No COMPUTED ALLTRIM(STRING(n_Chq_No,20))

COMMENT Should work with ACL 11 because n_Chq_No is derived from c_Chq_No
SUMMARIZE ON c_Chq_No OTHER n_Chq_No SUBTOTAL GST_Amt Pay_Amt Pay_Net_Amt IF n_Chq_No>0 TO "%fld_Tmps%TMP1.FIL" OPEN PRESORT

SORT ON n_Chq_No TO "%fld_Tmps%TMP2" OPEN

GAPS ON n_Chq_No PRESORT OPEN TO "%fld_Tmps%TMP3.FIL"

OPEN TMP3
DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ZONED(GAP_START_EXCLUSIVE,20)  

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "GAP_START_EXCLUSIVE"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "L"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP021. Identify Cheque numbers which is out of sequence"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

SET FOLDER /%fld_Results%

SORT ON SORT_KEY TO "%fld_Results%AP021_Chq_Out_Seq" 

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp


SET SAFETY ON
^BATCH    AP005_3Cons_InvNo                  
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP005. Identify vendors with more than 3 consecutive invoice numbers within 12 months rolling period
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF
IF FTYPE("v_flds_AP_Inv")="U" OR FTYPE("trg_VMF")="U" DO AA002_Variable_Setting
IF FTYPE("v_AP005_Consec") ="U" DO AC002_Test_Var_Input
v_TestNo="AP005"

SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

OPEN AP_Invoices

COMM *** only test on the data within 12 months rolling period ***
SET FILTER TO AGE(Pst_Dt,_RptRunDate)<=365

DELETE FIELD n_Inv_No OK
DEFINE FIELD n_Inv_No COMPUTED  VALUE(INCLUDE(Inv_No,"0123456789"),0)

EXTRACT FIELDS n_Inv_No %v_flds_AP_Inv% IF Inv_Amt > 0.0 AND n_Inv_No<>0 TO "%fld_Tmps%AP_TMP" OPEN

DELETE FIELD INVNO_KEY OK
DEFINE FIELD INVNO_KEY COMPUTED SUBSTR(SUBSTR(Vndr_ID,1,20)+"~"+ZONED(n_Inv_No,20),1,40)

INDEX ON INVNO_KEY TO IDX_AP_TMP_INVNO_KEY

COMMENT Should work with ACL 11 because INVNO_KEY and n_Inv_No are derived from the key fields of the summarize command (Vndr_Site_ID Vndr_ID c_Inv_No)
SUMMARIZE ON Vndr_Site_ID Vndr_ID c_Inv_No Other INVNO_KEY  n_Inv_No  TO "%fld_Tmps%AP_TMP1.FIL" OPEN PRESORT

SORT ON INVNO_KEY  TO "%fld_Tmps%AP_TMP2" OPEN

DELETE FIELD Consec_Inv_No1 OK
DEFINE FIELD Consec_Inv_No1 COMPUTED

1 IF Vndr_ID=RECOFFSET(Vndr_ID,1) AND (RECOFFSET(n_Inv_No,1) - n_Inv_No= 1) 
0

DELETE FIELD Consec_Inv_No2 OK
DEFINE FIELD Consec_Inv_No2 COMPUTED

1 IF Vndr_ID=RECOFFSET(Vndr_ID,-1) AND (RECOFFSET(n_Inv_No,-1) - n_Inv_No= -1) 
0

EXTRACT Vndr_Site_ID Vndr_ID n_Inv_No Consec_Inv_No1 Consec_Inv_No2 IF Consec_Inv_No1+ Consec_Inv_No2=1 TO "%fld_Tmps%AP_TMP3" OPEN

DELETE FIELD n_Inv_No2 OK
DEFINE FIELD n_Inv_No2 COMPUTED  

RECOFFSET(n_Inv_No,1) IF Vndr_ID=RECOFFSET(Vndr_ID,1) AND Consec_Inv_No1=1 AND RECOFFSET(Consec_Inv_No2,1)=1
0

DELETE FIELD INVNO_KEY OK
DEFINE FIELD INVNO_KEY COMPUTED SUBSTR(SUBSTR(Vndr_ID,1,20)+ZONED(n_Inv_No,20),1,40)

DEFINE RELATION INVNO_KEY WITH AP_TMP IDX_AP_TMP_INVNO_KEY

EXTRACT Vndr_Site_ID Vndr_ID AP_TMP.Vchr_ID AP_TMP.Inv_Dt AP_TMP.Inv_No n_Inv_No AS 'n_Inv_No1' n_Inv_No2 AP_TMP.Cha_Field4 AP_TMP.Curncy IF n_Inv_No2<>0 AND n_Inv_No2-n_Inv_No>=%v_AP005_Consec% TO "%fld_Tmps%AP_TMP4" OPEN
 
DELETE FIELD Consec_Num OK
DEFINE FIELD Consec_Num COMPUTED n_Inv_No2-n_Inv_No1+1

DELETE FIELD INVNO_KEY OK
DEFINE FIELD INVNO_KEY COMPUTED SUBSTR(SUBSTR(Vndr_ID,1,20)+ZONED(n_Inv_No2,20),1,40)

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_Site_ID)+'~'+ALLTRIM(STRING(n_Inv_No2,20)),1,85)
COMM *** Summary ***

OPEN AP_TMP4

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_Site_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ZONED(Consec_Num,8)+'~'+ALLTRIM(Vndr_ID) 

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "consecutive invoice numbers Vndr_ID D"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "L"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 


DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP005.Identify vendors with more than %v_AP005_Consec% consecutive invoice numbers within 12 months rolling period - Summary"

SORT ON SORT_KEY D TO "%fld_Tmps%AP005_TMP" OPEN

DEFINE RELATION INVNO_KEY WITH AP_TMP INDEX IDX_AP_TMP_INVNO_KEY
DEFINE RELATION Vndr_Site_ID WITH VMF_Vnd_Master_File INDEX IDX_VndrSiteID

INDEX ON Vndr_Site_ID TO IDX_AP_TMP4_VndrSiteID

SET FOLDER /%fld_Results%
Extract FIELDS ID_KEY Vndr_Site_ID VMF_Vnd_Master_File.Vndr_Typ VMF_Vnd_Master_File.Vndr_Sts Vndr_ID VMF_Vnd_Master_File.Vndr_Nme Vchr_ID n_Inv_No1 AS 'Inv_No' Inv_No AS 'Inv_No1' Inv_Dt AS "Inv_Dt" AP_TMP.Vchr_ID AS "Vchr_ID2" AP_TMP.Inv_No AS "Inv_No2" AP_TMP.Inv_Dt AS "Inv_Dt2" Consec_Num AP_TMP.Cha_Field4 AP_TMP.Curncy Priority TEST_NAME RptRunDate Data_Range_Start_Date Data_Range_End_Date SORT_KEY SORT_KEY_Desc TO "%fld_Results%AP005_%v_AP005_Consec%Cons_InvNo" OPEN

DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum index IDX_AP_Sum_VndrID

INDEX ON Vndr_Site_ID TO IDX_AP005_VndrSiteID

COMM *** Details ***
COMM *** Extract the details for the Sensecutive invoices***
SET FOLDER /%fld_Tmps%
OPEN AP_TMP
OPEN AP005_TMP SECONDARY
COMMENT Should work with ACL 11 because Vndr_Site_ID is unique in the secondary table
JOIN PKEY Vndr_Site_ID FIELDS n_Inv_No %v_flds_AP_Inv% SKEY Vndr_Site_ID WITH ID_KEY n_Inv_No1 n_Inv_No2 TO "%fld_Tmps%AP_TMP6" OPEN PRESORT MANY SECSORT

DEFINE FIELD f_Inv_No       COMPUTED 

 1 IF BETWEEN( n_Inv_No, n_Inv_No1, n_Inv_No2)
 0

EXTRACT FIELDS %v_flds_AP_Inv% ID_KEY n_Inv_No n_Inv_No1 n_Inv_No2 ID_KEY AS 'Rec_Key' IF f_Inv_No=1 TO "%fld_Tmps%AP_TMP7" OPEN

CLOSE SECONDARY

OPEN AP_TMP7
DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ALLTRIM(ID_KEY)+'~'+ZONED(n_Inv_No,20)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Vndr_ID c_Inv_No"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "L"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP005D.Identify vendors with more than %v_AP005_Consec% consecutive invoice numbers within 12 months rolling period - Details"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

SET FOLDER /%fld_Results%
SORT ON SORT_KEY TO "%fld_Results%AP005D_%v_AP005_Consec%Cons_InvNo_Details" OPEN
DEFINE RELATION Vndr_Site_ID WITH VMF_Vnd_Master_File INDEX IDX_VndrSiteID

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    AP007_Not_Reg_GST                  
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP007. Identify transactions by vendors not registered for GST who are charging GST Or Inv_Dt >GST expired Date
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************
IF FTYPE("v_flds_AP_Inv")="U" OR FTYPE("trg_VMF")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="AP"

DELETE FORMAT ABN_ASIC OK
 
COMM *** Importing data For ABN tests ***
DO VMZ02_Import_ABR

IF FTYPE("ABN_ASIC")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF%.FIL")<=0 Errmsg=Errmsg+" VM010"
IF FTYPE("ABN_ASIC")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF%.FIL")<=0 ESCAPE


COMM *** IF ABR website connection failed, then escape, don't process this test ***
OPEN ABN_ASIC
SET FILTER TO ASIC_entityStatusCode="Connection erro"
COUNT
IF COUNT1>0 Errmsg=Errmsg+" VM008"
IF COUNT1>0 ESCAPE
SET FILTER 

COMM ***Start run test ***

OPEN VMF_Vnd_Master_File
DEFINE RELATION ABN_CLN WITH ABN_ASIC INDEX INXABN

EXTRACT FIELDS ALL ABN_ASIC.ASIC_entityStatusCode CTOD(ABN_ASIC.ASIC_entityStatusEF,"YYYY-MM-DD") AS "ASIC_entityStatusEF" CTOD(ABN_ASIC.ASIC_GST_effFrom,"YYYY-MM-DD") AS "ASIC_GST_effFrom" CTOD(ABN_ASIC.ASIC_GST_effTo,"YYYY-MM-DD") AS "ASIC_GST_effTo" ABN_ASIC.ASIC_entityDescription IF LENGTH(ALLTRIM(ABN_CLN))>1 AND Vndr_Sts="A" AND InvABN="F" AND (((ABN_ASIC.ASIC_entityStatusCode = "Active") AND ISBLANK(ABN_ASIC.ASIC_GST_effFrom)) OR ((ABN_ASIC.ASIC_entityStatusCode = "Active") AND NOT ISBLANK(ABN_ASIC.ASIC_GST_effTo))) TO "%fld_Tmps%TMP1" OPEN

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+"~"+ALLTRIM(ABN_CLN),1,85)

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP_Vnd" OPEN
INDEX ON Vndr_Site_ID TO IDX_TMP_VndrSiteID

COMM *** VM003D. Identify invoices with Inv_Dt >=GST expired Date ***
INDEX ON Vndr_Site_ID TO IDX_TMP_Vnd_VndrSiteID

OPEN AP_Invoices
DEFINE RELATION Vndr_Site_ID WITH TMP_Vnd INDEX IDX_TMP_Vnd_VndrSiteID

SORT ON Vndr_ID c_Inv_Dt D IF GST_Amt <> 0.00 AND NOT ISBLANK(TMP_Vnd.Vndr_ID) AND (Inv_Dt > TMP_Vnd.ASIC_GST_effTo OR ISBLANK(DATE(TMP_Vnd.ASIC_GST_effFrom))) TO "%fld_Tmps%TMP_VM010D" OPEN

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+"~"+ALLTRIM(c_Inv_Dt),1,30)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Vndr_ID Inv_Date"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "H"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "VM010D. Identify transactions by vendors not registered for GST or Inv_Dt >GST expired Date"

SET FOLDER /%fld_Results%

SUMMARIZE ON Vndr_Site_ID SUBTOTAL GST_Amt Inv_Amt TO "%fld_Results%VM010D_DeReg_GST_Sum.FIL" OPEN PRESORT
INDEX ON Vndr_Site_ID TO IDX_VM010D_Sum_VndrSiteID

SET FOLDER /%fld_Tmps%

OPEN TMP_Vnd
DEFINE RELATION Vndr_Site_ID WITH VM010D_DeReg_GST_Sum INDEX IDX_VM010D_Sum_VndrSiteID

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ALLTRIM(ZONED(VM010D_DeReg_GST_Sum.GST_Amt,12))+ALLTRIM(Vndr_ID)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Total_InvAmt_PostGST_Expiry Vndr_ID"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate  

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "VM010. Identify ABN deregistered for GST against ABR site"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SORT ON SORT_KEY D TO "%fld_Tmps%TMP_VM010" OPEN
DEFINE RELATION Vndr_Site_ID WITH VM010D_DeReg_GST_Sum INDEX IDX_VM010D_Sum_VndrSiteID

COMM *** Finalize results ***
SET FOLDER /%fld_Results%
OPEN TMP_VM010
DEFINE RELATION Vndr_Site_ID WITH VMF_Vnd_Master_File INDEX IDX_VndrSiteID
EXTRACT FIELDS ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription VM010D_DeReg_GST_Sum.Inv_Amt VM010D_DeReg_GST_Sum.GST_Amt VM010D_DeReg_GST_Sum.COUNT %v_flds_VMF% Priority TEST_NAME RptRunDate SORT_KEY SORT_KEY_Desc TO "%fld_Results%VM010_DeReg_GST" OPEN
INDEX ON Vndr_Site_ID TO IDX_VM010_VndrSiteID
DEFINE RELATION Vndr_Site_ID WITH VM010D_DeReg_GST_Sum INDEX IDX_VM010D_Sum_VndrSiteID
    
OPEN TMP_VM010D
DEFINE RELATION Vndr_Site_ID WITH VM010_DeReg_GST INDEX IDX_VM010_VndrSiteID

EXTRACT FIELDS VM010_DeReg_GST.ASIC_GST_effTo %v_flds_AP_Inv% Priority TEST_NAME RptRunDate Data_Range_Start_Date Data_Range_End_Date SORT_KEY SORT_KEY_Desc TO "%fld_Results%VM010D_DeReg_GST" OPEN
DEFINE RELATION Vndr_Site_ID WITH VM010_DeReg_GST INDEX IDX_VM010_VndrSiteID

OPEN AP_Invoices
DELETE RELATION TMP_Vnd OK
OPEN TMP_VM010D
DELETE RELATION VM010_DeReg_GST OK

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON


SET SAFETY ON
^BATCH    AC003_Batch_Menu                   
[PARENT_FOLDER_ID] 1340167481
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Tests Main Menu
COMM *** Before run the Tests, check the target tables to see if related tables exist and get data inside
COMM *** Otherwise, redirect to data import or convert menu
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 21/06/2012
COMM***************************************************************************

IF FTYPE("_Version")="v" OR FTYPE("_Version")="U" OR FTYPE("fld_Workings")="U" DO AA002_Variable_Setting

DO AC002_Test_Var_Input
exit=F

COMM *** DIALOG ***
IF FILESIZE("Dialogs\Dialog_AC003_Batch_Menu.txt") <=0 ESCAPE
DELETE SCRIPT Dialog_AC003_Batch_Menu OK

%v_CCMJob% DO "Dialogs\Dialog_AC003_Batch_Menu.txt"
DELETE SCRIPT Dialog_AC003_Batch_Menu OK

IF exit=T ESCAPE
 
%v_CCMJob% IF CHK_TEST_VMF=F AND CHK_TEST_AP=F AND CHK_TEST_EMF=F AND CHK_TEST_PR=F PAUSE "Please select the test components you want to execute."
IF CHK_TEST_VMF=T OR CHK_TEST_AP=T OR CHK_TEST_EMF=T OR CHK_TEST_PR=T FLAG_Test=T

%v_CCMJob% IF CHK_TEST_VMF =T AND FILESIZE("%fld_Workings%%trg_VMF%.fil") <= 0 PAUSE "There is no Vendor Master data, please prepare the data first."
IF CHK_TEST_VMF =T AND FILESIZE("%fld_Workings%%trg_VMF%.fil") <= 0 FLAG_Test=F

%v_CCMJob% IF CHK_TEST_AP =T AND FILESIZE("%fld_Workings%%trg_AP_Inv%.fil") <= 0 AND FILESIZE("%fld_Workings%%trg_VMF%.fil") <= 0 PAUSE "There is no Vendor Master and Invoices data, please prepare the data first."
IF CHK_TEST_AP =T AND FILESIZE("%fld_Workings%%trg_AP_Inv%.fil") <= 0 AND FILESIZE("%fld_Workings%%trg_VMF%.fil") <= 0 FLAG_Test=F

%v_CCMJob% IF CHK_TEST_EMF =T AND FILESIZE("%fld_Workings%%trg_EMF%.fil") <= 0 PAUSE "There is no Employee Master data, please prepare the data first."
IF CHK_TEST_EMF =T AND FILESIZE("%fld_Workings%%trg_EMF%.fil") <= 0 FLAG_Test=F

%v_CCMJob% IF CHK_TEST_PR =T AND FILESIZE("%fld_Workings%%trg_PR%.fil") <= 0 AND FILESIZE("%fld_Workings%%trg_EMF%.fil") <= 0 PAUSE "There is no Employee Master and Payroll data, please prepare the data first."
IF CHK_TEST_PR =T AND FILESIZE("%fld_Workings%%trg_PR%.fil") <= 0 AND FILESIZE("%fld_Workings%%trg_EMF%.fil") <= 0 FLAG_Test=F

COMM VMF
IF FLAG_Test=T AND CHK_TEST_VMF=T DO VA001_Menu
COMM AP
IF FLAG_Test=T AND CHK_TEST_AP=T DO AA001_Menu
COMM EMF
IF FLAG_Test=T AND CHK_TEST_EMF=T DO EA001_Menu
COMM Payroll
IF FLAG_Test=T AND CHK_TEST_PR=T DO PA001_Menu


^FOLDER   Custom_Import_temp                  1430178051
[PARENT_FOLDER_ID] 1340167351
^FOLDER   zNotInUse_01                        1430205343
[PARENT_FOLDER_ID] 0
^BATCH    Import_001                         
[PARENT_FOLDER_ID] 1430205343
IF FTYPE("v_PATH")="U" v_PATH="DATA_001\"

SET FOLDER /%v_PATH%

CLOSE PRIMARY SECONDARY
SET SAFETY OFF

DELETE FORMAT _DIR OK
DIR *.AC TO _DIR

OPEN _DIR 

DELETE FORMAT "FIXED_5000.FIL" OK
EXTRACT BLANKS(5000) AS "ALLREC" TO "FIXED_5000.FIL" FIRST 0

DELETE FORMAT "GENERIC.FIL" OK
EXTRACT BLANKS(5000) AS "ALLREC" TO "GENERIC.FIL" FIRST 0
COMM OPEN "filename.txt" FORMAT FIXED_5000 -- dialogue prompt for filename

OPEN Files
LOCATE RECORD v_Record
v_FILE_NAME = ALLTRIM(FILE_NAME)

OPEN "%v_FILE_NAME%" FORMAT FIXED_5000


DEFINE FIELD c_PIPE COMPUTED OCCURS(ALLREC,'|')
DEFINE FIELD c_TILDE COMPUTED OCCURS(ALLREC,'~')
GROUP
EXTRACT REGEXREPLACE(ALLREC,"[(\x00-\x09)(\x0B-\x0C)(\x0E-\x1F)]",' ') TO "Invoice_fixed.fil"
STATISTICS ON c_PIPE
STATISTICS ON c_TILDE
END


OPEN "Invoice_fixed.fil" FORMAT GENERIC CRLF 

v_buffer=BLANKS(5000)
v_delimiters=0
fdebug=F
GROUP
 v_buffer=ALLTRIM(v_buffer)+ALLTRIM(ALLREC)
 v_delimiters = OCCURS(v_buffer,'~|~')
IF fdebug EXTRACT v_delimiters v_buffer TO debug
EXPORT '~'+ ALLTRIM(v_buffer) + '~' TO "Invoice_Clean.txt" IF v_delimiters >= 14
 v_buffer='' IF v_delimiters >= 14
 v_delimiters = 0 IF v_delimiters >= 14
END


IMPORT DELIMITED TO Invoice_Clean1 "Invoice_Clean1.fil" FROM "Invoice_Clean.txt" 0 SEPARATOR "|" QUALIFIER "~" CONSECUTIVE STARTLINE 1 KEEPTITLE  FIELD "VENDOR_ID" C AT 1 DEC 0 WID 9 PIC "" AS ""  FIELD "VENDOR_SITE_ID" C AT 10 DEC 0 WID 14 PIC "" AS ""  FIELD "INVOICE_ID" C AT 24 DEC 0 WID 10 PIC "" AS ""  FIELD "INVOICE_NUM" C AT 34 DEC 0 WID 40 PIC "" AS ""  FIELD "INVOICE_TYPE" C AT 74 DEC 0 WID 20 PIC "" AS ""  FIELD "INVOICE_DATE" C AT 94 DEC 0 WID 12 PIC "" AS ""  FIELD "INVOICE_AMOUNT" C AT 106 DEC 0 WID 14 PIC "" AS ""  FIELD "INV_DIST_NUMBER" C AT 120 DEC 0 WID 15 PIC "" AS ""  FIELD "INV_DIST_AMOUNT" C AT 135 DEC 0 WID 15 PIC "" AS ""  FIELD "DESCRIPTION" C AT 150 DEC 0 WID 500 PIC "" AS ""  FIELD "CHARGECODE" C AT 650 DEC 0 WID 35 PIC "" AS ""  FIELD "PAYMENT_STATUS_FLAG" C AT 685 DEC 0 WID 40 PIC "" AS ""  FIELD "CANCELLED_DATE" C AT 725 DEC 0 WID 20 PIC "" AS ""  FIELD "GST_STATUS" C AT 745 DEC 0 WID 20 PIC "" AS ""  FIELD "APPROVAL_STATUS" C AT 765 DEC 0 WID 30 PIC "" AS "" 

DO FormatImport
v_Record = v_Record +1

SET SAFETY ON






 

^BATCH    PrepareInvoice                     
[PARENT_FOLDER_ID] 1430205343
COMM IMPORT INVOICES AND PREPARE INDIVIDUAL 

CLOSE PRIMARY SECONDARY
SET SAFETY OFF
OPEN INVOICE_FMT
SUMMARIZE ON VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_DATE SUBTOTAL INV_DIST_AMOUNT OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS TO "INVOICE_FMT_SUMM.FIL" OPEN PRESORT

COMM APPEND THE SUMMARISED INVOICES BEFORE ELIMINATING DUPLICATES WITHIN DELTA FILES

IF v_Record = 1 EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,15) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,15) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' INVOICE_DATE, INV_DIST_AMOUNT, COUNT AS 'INV_DIST_COUNT' SUBSTRING(INVOICE_NUM,1,15) AS 'INVOICE_NUM' INVOICE_AMOUNT SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS TO TMP_Imported

IF v_Record > 1 EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,15) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,15) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' INVOICE_DATE, INV_DIST_AMOUNT, COUNT AS 'INV_DIST_COUNT' SUBSTRING(INVOICE_NUM,1,15) AS 'INVOICE_NUM' INVOICE_AMOUNT SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG  CANCELLED_DATE GST_STATUS APPROVAL_STATUS TO TMP_Imported APPEND


SET SAFETY ON
^BATCH    Import_003                         
[PARENT_FOLDER_ID] 1430205343
SET SAFETY OFF
CLOSE PRIMARY SECONDARY
IF FTYPE("v_PATH")="U"  v_PATH="DATA_001\"
SET FOLDER /%v_PATH%


OPEN Files
LOCATE RECORD v_Record
v_FILE_NAME = ALLTRIM(FILE_NAME)
v_CleanFileName = REPLACE(v_FILE_NAME,"%v_folder_location%","")
v_CLN_FILENAME =  SUBSTR(v_CleanFileName, 1,AT(1,"_",v_CleanFileName)-1)

IMPORT DELIMITED TO VendorBankAccount "%v_CLN_FILENAME%.fil" FROM "%v_FILE_NAME%" 0 SEPARATOR "|" QUALIFIER "~" CONSECUTIVE STARTLINE 1 KEEPTITLE FIELD "VENDOR_ID__" C AT 1 DEC 0 WID 11 PIC "" AS "" FIELD "_VENDOR_SITE_ID_" C AT 12 DEC 0 WID 16 PIC "" AS "" FIELD "_VENDOR_BANK_ACCT_NAME_" C AT 28 DEC 0 WID 48 PIC "" AS "" FIELD "_VENDOR_BSB_" C AT 76 DEC 0 WID 12 PIC "" AS "" FIELD "_VENDOR_BANK_ACCOUNT_NUMBER_" C AT 88 DEC 0 WID 28 PIC "" AS "" FIELD "_ACCT_START_DATE_" C AT 116 DEC 0 WID 22 PIC "" AS "" FIELD "_ACCT_END_DATE" C AT 138 DEC 0 WID 22 PIC "" AS "" 


DO FormatVBImport

v_Record = v_Record +1

SET SAFETY ON






 

^BATCH    Import_002                         
[PARENT_FOLDER_ID] 1430205343
SET SAFETY OFF
CLOSE PRIMARY SECONDARY
IF FTYPE("v_PATH")="U"  v_PATH="DATA_001\"
SET FOLDER /%v_PATH%


OPEN Files
LOCATE RECORD v_Record
v_FILE_NAME = ALLTRIM(FILE_NAME)
v_CleanFileName = REPLACE(v_FILE_NAME,"%v_folder_location%","")
v_CLN_FILENAME =  SUBSTR(v_CleanFileName, 1,AT(1,"_",v_CleanFileName)-1)

IMPORT DELIMITED TO "%v_CLN_FILENAME%" "%v_CLN_FILENAME%.fil" FROM "%v_FILE_NAME%" 0 SEPARATOR "|" QUALIFIER "~" CONSECUTIVE STARTLINE 1 KEEPTITLE FIELD "VENDOR_ID_" C AT 1 DEC 0 WID 10 PIC "" AS "" FIELD "VENDOR_NUMBER" C AT 11 DEC 0 WID 13 PIC "" AS "" FIELD "VENDOR_NAME" C AT 24 DEC 0 WID 73 PIC "" AS "" FIELD "VENDOR_SITE_ID" C AT 97 DEC 0 WID 14 PIC "" AS "" FIELD "VENDOR_SITE" C AT 111 DEC 0 WID 15 PIC "" AS "" FIELD "VENDOR_ADDRESS" C AT 126 DEC 0 WID 125 PIC "" AS "" FIELD "CITY" C AT 251 DEC 0 WID 25 PIC "" AS "" FIELD "STATE" C AT 276 DEC 0 WID 18 PIC "" AS "" FIELD "POSTCODE" C AT 294 DEC 0 WID 12 PIC "" AS "" FIELD "COUNTRY" C AT 306 DEC 0 WID 7 PIC "" AS "" FIELD "INACTIVE_DATE" C AT 313 DEC 0 WID 20 PIC "" AS "" FIELD "VENDOR_ABN" C AT 333 DEC 0 WID 15 PIC "" AS "" FIELD "GST_REGISTRATION_STATUS" C AT 348 DEC 0 WID 23 PIC "" AS "" FIELD "AREA_CODE" C AT 371 DEC 0 WID 9 PIC "" AS "" FIELD "PHONE" C AT 380 DEC 0 WID 15 PIC "" AS "" FIELD "FAX" C AT 395 DEC 0 WID 15 PIC "" AS "" FIELD "EMAIL_ADDRESS" C AT 410 DEC 0 WID 94 PIC "" AS "" FIELD "VENDOR_TYPE" C AT 504 DEC 0 WID 11 PIC "" AS "" FIELD "PAYMENT_METHOD" C AT 515 DEC 0 WID 14 PIC "" AS "" FIELD "CREATION_DATE" C AT 529 DEC 0 WID 20 PIC "" AS "" 


DO FormatVMImport

v_Record = v_Record +1

SET SAFETY ON






 

^BATCH    PrepareVM                          
[PARENT_FOLDER_ID] 1430205343
COMM IMPORT INVOICES AND PREPARE INDIVIDUAL 

CLOSE PRIMARY SECONDARY
SET SAFETY OFF
OPEN VENDOR_MASTER_FMT

SORT ON VENDOR_SITE_ID VENDOR_ID VENDOR_NUMBER CREATION_DATE  D  TO "VENDOR_MASTER_FMT_SORTED" OPEN

SUMMARIZE ON VENDOR_SITE_ID VENDOR_ID VENDOR_NUMBER OTHER VENDOR_ID VENDOR_NUMBER VENDOR_NAME VENDOR_SITE_ID VENDOR_SITE VENDOR_ADDRESS CITY STATE POSTCODE COUNTRY INACTIVE_DATE VENDOR_ABN GST_REGISTRATION_STATUS AREA_CODE PHONE FAX EMAIL_ADDRESS VENDOR_TYPE PAYMENT_METHOD CREATION_DATE Vndr_Sts TEL1 FAX TO "VENDOR_MASTER_SUMM.FIL" OPEN PRESORT

COMM APPEND THE SUMMARISED INVOICES BEFORE ELIMINATING DUPLICATES WITHIN DELTA FILES

IF v_Record = 1 EXTRACT FIELDS  SUBSTR(VENDOR_SITE_ID,1,15) AS 'VENDOR_SITE_ID' SUBSTR(VENDOR_ID,1,15) AS 'VENDOR_ID' SUBSTR(VENDOR_NUMBER,1,15) AS 'VENDOR_NUMBER' SUBSTR(VENDOR_NAME,1,30) AS 'VENDOR_NAME' SUBSTR(VENDOR_SITE,1,30) AS 'VENDOR_SITE' SUBSTR(VENDOR_ADDRESS,1,100) AS 'VENDOR_ADDRESS' CITY STATE POSTCODE COUNTRY INACTIVE_DATE  SUBSTR(VENDOR_ABN,1,20) AS 'VENDOR_ABN'  SUBSTR(GST_REGISTRATION_STATUS,1,30) AS 'GST_REGISTRATION_STATUS' SUBSTR(AREA_CODE,1,10) AS 'AREA_CODE' SUBSTR(PHONE,1,15) AS 'PHONE' SUBSTR(FAX,1,15) AS 'FAX' SUBSTR(EMAIL_ADDRESS,1,30) AS 'EMAIL_ADDRESS' SUBSTR(VENDOR_TYPE,1,11) AS 'VENDOR_TYPE' SUBSTR(PAYMENT_METHOD,1,15) AS 'PAYMENT_METHOD' CREATION_DATE Vndr_Sts SUBSTR(TEL1,1,20) AS 'TEL1' SUBSTR(FAX,1,20) AS 'FAX' TO TMP_Imported

IF v_Record > 1 EXTRACT FIELDS  SUBSTR(VENDOR_SITE_ID,1,15) AS 'VENDOR_SITE_ID' SUBSTR(VENDOR_ID,1,15) AS 'VENDOR_ID' SUBSTR(VENDOR_NUMBER,1,15) AS 'VENDOR_NUMBER' SUBSTR(VENDOR_NAME,1,30) AS 'VENDOR_NAME' SUBSTR(VENDOR_SITE,1,30) AS 'VENDOR_SITE' SUBSTR(VENDOR_ADDRESS,1,100) AS 'VENDOR_ADDRESS' CITY STATE POSTCODE COUNTRY INACTIVE_DATE  SUBSTR(VENDOR_ABN,1,20) AS 'VENDOR_ABN'  SUBSTR(GST_REGISTRATION_STATUS,1,30) AS 'GST_REGISTRATION_STATUS' SUBSTR(AREA_CODE,1,10) AS 'AREA_CODE' SUBSTR(PHONE,1,15) AS 'PHONE' SUBSTR(FAX,1,15) AS 'FAX' SUBSTR(EMAIL_ADDRESS,1,30) AS 'EMAIL_ADDRESS' SUBSTR(VENDOR_TYPE,1,11) AS 'VENDOR_TYPE' SUBSTR(PAYMENT_METHOD,1,15) AS 'PAYMENT_METHOD' CREATION_DATE Vndr_Sts SUBSTR(TEL1,1,20) AS 'TEL1' SUBSTR(FAX,1,20) AS 'FAX'  TO  TMP_Imported APPEND


SET SAFETY ON
^BATCH    FormatVMImport                     
[PARENT_FOLDER_ID] 1430205343
CLOSE PRIMARY SECONDARY 
SET SAFETY OFF
COMMENT
Format Numeric and Date fields from characters

OPEN VendorMaster

DELETE FIELD c_VENDOR_ID OK
DEFINE FIELD c_VENDOR_ID COMPUTED REPLACE(ALLTRIM(VENDOR_ID_),'~','')

DELETE FIELD c_INACTIVE_DATE OK
DEFINE FIELD c_INACTIVE_DATE COMPUTED CTOD(SUBSTR(INACTIVE_DATE,1,10)'DD/MM/YYYY')

DELETE FIELD c_CREATION_DATE OK
DEFINE FIELD c_CREATION_DATE COMPUTED CTOD(SUBSTR(CREATION_DATE,1,10)'DD/MM/YYYY')

DELETE FIELD c_VENDOR_STATUS OK
DEFINE FIELD c_VENDOR_STATUS COMPUTED
c_VENDOR_STATUS
"A" IF INACTIVE_DATE = " "
"A" IF CTOD(SUBSTR(INACTIVE_DATE,1,10)'DD/MM/YYYY') > TODAY()
"I"

DELETE FIELD c_Tel OK
DEFINE FIELD c_Tel COMPUTED INCLUDE(AREA_CODE,'0123456789') + INCLUDE(PHONE,'0123456789')

DELETE FIELD c_Fax OK
DEFINE FIELD c_Fax COMPUTED INCLUDE(AREA_CODE,'0123456789') + INCLUDE(FAX,'0123456789')


EXTRACT FIELDS SUBSTR(c_VENDOR_ID,1,15) AS 'VENDOR_ID' SUBSTR(VENDOR_NUMBER,1,15) AS 'VENDOR_NUMBER' SUBSTR(VENDOR_NAME,1,30) AS 'VENDOR_NAME' SUBSTR(VENDOR_SITE_ID,1,15) AS 'VENDOR_SITE_ID' SUBSTR(VENDOR_SITE,1,30) AS 'VENDOR_SITE' SUBSTR(VENDOR_ADDRESS,1,100) AS 'VENDOR_ADDRESS' CITY, STATE, POSTCODE, COUNTRY  , c_INACTIVE_DATE AS 'INACTIVE_DATE' SUBSTR(VENDOR_ABN,1,20) AS 'VENDOR_ABN' GST_REGISTRATION_STATUS AREA_CODE PHONE FAX SUBSTR(EMAIL_ADDRESS,1,30) AS 'EMAIL_ADDRESS' VENDOR_TYPE PAYMENT_METHOD c_CREATION_DATE AS 'CREATION_DATE' c_VENDOR_STATUS AS 'Vndr_Sts' c_Tel AS 'TEL1' c_Fax AS 'FAX' TO "VENDOR_MASTER_FMT.FIL"

SET SAFETY ON 

DO PrepareVM
^BATCH    FormatImport                       
[PARENT_FOLDER_ID] 1430205343
CLOSE PRIMARY SECONDARY 
SET SAFETY OFF
COMMENT
Format Numeric and Date fields from characters

OPEN Invoice_Clean1

DELETE FIELD c_MONTH OK
DEFINE FIELD c_MONTH COMPUTED 

"01" IF SUBSTR(INVOICE_DATE,4,3) = 'JAN'
"02" IF SUBSTR(INVOICE_DATE,4,3) = 'FEB'
"03" IF SUBSTR(INVOICE_DATE,4,3) = 'MAR'
"04" IF SUBSTR(INVOICE_DATE,4,3) = 'APR'
"05" IF SUBSTR(INVOICE_DATE,4,3) = 'MAY'
"06" IF SUBSTR(INVOICE_DATE,4,3) = 'JUN'
"07" IF SUBSTR(INVOICE_DATE,4,3) = 'JUL'
"08" IF SUBSTR(INVOICE_DATE,4,3) = 'AUG'
"09" IF SUBSTR(INVOICE_DATE,4,3) = 'SEP'
"10" IF SUBSTR(INVOICE_DATE,4,3) = 'OCT'
"11" IF SUBSTR(INVOICE_DATE,4,3) = 'NOV'
"12" IF SUBSTR(INVOICE_DATE,4,3) = 'DEC'
"00"


DELETE FIELD c_DAY OK
DEFINE FIELD c_DAY COMPUTED SUBSTR(INVOICE_DATE,1,2)

DELETE FIELD c_YEAR OK
DEFINE FIELD c_YEAR COMPUTED "20"+ SUBSTR(INVOICE_DATE,8,2)

DELETE FIELD c_INVOICE_DATE_CLN OK
DEFINE FIELD c_INVOICE_DATE_CLN COMPUTED c_DAY + '/' + c_MONTH + '/' + c_YEAR

DELETE FIELD c_INVOICE_DATE OK
DEFINE FIELD  c_INVOICE_DATE COMPUTED CTOD(c_INVOICE_DATE_CLN ,'DD/MM/YYYY' )

DELETE FIELD c_INVOICE_AMOUNT OK
DEFINE FIELD c_INVOICE_AMOUNT COMPUTED VALUE(INVOICE_AMOUNT,2)

DELETE FIELD c_INV_DIST_AMOUNT OK
DEFINE FIELD c_INV_DIST_AMOUNT COMPUTED VALUE(INV_DIST_AMOUNT,2)

DELETE FIELD c_MONTH1 OK
DEFINE FIELD c_MONTH1 COMPUTED 

"01" IF SUBSTR(CANCELLED_DATE,4,3) = 'JAN'
"02" IF SUBSTR(CANCELLED_DATE,4,3) = 'FEB'
"03" IF SUBSTR(CANCELLED_DATE,4,3) = 'MAR'
"04" IF SUBSTR(CANCELLED_DATE,4,3) = 'APR'
"05" IF SUBSTR(CANCELLED_DATE,4,3) = 'MAY'
"06" IF SUBSTR(CANCELLED_DATE,4,3) = 'JUN'
"07" IF SUBSTR(CANCELLED_DATE,4,3) = 'JUL'
"08" IF SUBSTR(CANCELLED_DATE,4,3) = 'AUG'
"09" IF SUBSTR(CANCELLED_DATE,4,3) = 'SEP'
"10" IF SUBSTR(CANCELLED_DATE,4,3) = 'OCT'
"11" IF SUBSTR(CANCELLED_DATE,4,3) = 'NOV'
"12" IF SUBSTR(CANCELLED_DATE,4,3) = 'DEC'
"00"

DELETE FIELD c_DAY1 OK
DEFINE FIELD c_DAY1 COMPUTED SUBSTR(CANCELLED_DATE,1,2)

DELETE FIELD c_YEAR1 OK
DEFINE FIELD c_YEAR1 COMPUTED "20"+ SUBSTR(CANCELLED_DATE,8,2)

DELETE FIELD c_CANCELLED_DATE_CLN OK
DEFINE FIELD c_CANCELLED_DATE_CLN COMPUTED c_DAY1 + '/' + c_MONTH1 + '/' + c_YEAR1

DELETE FIELD c_CANCELLED_DATE OK
DEFINE FIELD c_CANCELLED_DATE COMPUTED CTOD(c_CANCELLED_DATE_CLN,'DD/MM/YYYY')


EXTRACT FIELDS VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE c_INVOICE_DATE AS 'INVOICE_DATE' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' INV_DIST_NUMBER c_INV_DIST_AMOUNT AS 'INV_DIST_AMOUNT' DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG c_CANCELLED_DATE AS 'CANCELLED_DATE' GST_STATUS APPROVAL_STATUS TO "INVOICE_FMT.FIL"

SET SAFETY ON
DO PrepareInvoice
^BATCH    New_Script2                        
[PARENT_FOLDER_ID] 1430205343
com OPEN "filename.txt" FORMAT GENERIC CRLF
com EXPORT '"'+ ALLTRIM(REPLACE(ALLREC,'~|~','"|"')) TO 'Invoice_Clean.txt'
COMM SET FOLDER /TEMPDATA
COMM OPEN Invoice_Clean1
COMM SAVE LAYOUT TABLE TO INVOICE_CLEAN_LAYOUT
COMM OPEN VENDOR_MASTER_SUMM
COMM SAVE LAYOUT TABLE TO VENDOR_MASTER_SUMM_LAYOUT

 OPEN VENDOR_BANK_ACCOUNT_NO_DUPS
 SAVE LAYOUT TABLE TO VENDOR_BANK_ACCOUNT_NO_DUPS_Layout

^BATCH    CA001_Imp_All_Main                 
[PARENT_FOLDER_ID] 1341537122
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** User can customize data after importing source data
COMM *** Prepare the data for the mapping/conversion  -- Main Script
COMM *** Created by Nancy ON 30/07/2012 
COMM *** Called by: IM001_Import, if selected by user in IA001_Menu
COMM***************************************************************************


IF FTYPE("_Version")="v" OR FTYPE("_Version")="U" OR FTYPE("fld_Sources")="U" OR FTYPE("fld_DataMapping")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"

COMM *** Importing AP and Vendor Master File ***

DO CA002_Imp_AP_VM_Main

COMMENT 
*** Importing Payroll and Employee Master File ***
DO CA003_Imp_PR_EM_Main
END

COMM *** delete the tmp files ***
DELETE FORMAT AP_InvoiceListing_PO OK
DELETE %fld_Tmps%AP_InvoiceListing_PO OK
DELETE FORMAT Data_Inv_Lst OK
DELETE %fld_Tmps%Data_Inv_Lst OK
DELETE FORMAT Data_Pay_Lst OK
DELETE %fld_Tmps%Data_Pay_Lst OK
DELETE FORMAT Data_PO_Lst OK
DELETE %fld_Tmps%Data_PO_Lst OK
DELETE FORMAT Data_PR_Lst OK
DELETE %fld_Tmps%Data_PR_Lst OK
DELETE FORMAT Inv_YM OK
DELETE %fld_Tmps%Inv_YM OK
DELETE FORMAT Pay_YM OK
DELETE %fld_Tmps%Pay_YM OK
DELETE FORMAT TMP_PAYROLL_SUM OK
DELETE %fld_Tmps%TMP_PAYROLL_SUM OK

SET SAFETY ON
^BATCH    FormatVBImport                     
[PARENT_FOLDER_ID] 1430205343
CLOSE PRIMARY SECONDARY 
SET SAFETY OFF
COMMENT
Format Numeric and Date fields from characters

OPEN VendorBankAccount
DELETE FIELD c_VENDOR_ID OK
DEFINE FIELD c_VENDOR_ID COMPUTED REPLACE(ALLTRIM(VENDOR_ID__),'~','')

DELETE FIELD c_ACCT_START_DATE OK
DEFINE FIELD c_ACCT_START_DATE COMPUTED CTOD(SUBSTR(_ACCT_START_DATE_,1,10)'DD/MM/YYYY')

DELETE FIELD c_ACCT_END_DATE OK
DEFINE FIELD c_ACCT_END_DATE COMPUTED CTOD(SUBSTR(_ACCT_END_DATE,1,10)'DD/MM/YYYY')


EXTRACT FIELDS SUBSTR(c_VENDOR_ID,1,15) AS 'VENDOR_ID' SUBSTR(_VENDOR_SITE_ID_,1,16) AS 'VENDOR_SITE_ID' SUBSTR(_VENDOR_BANK_ACCT_NAME_,1,50) AS 'VENDOR_BANK_ACCT_NAME' SUBSTR(_VENDOR_BSB_,1,12) AS 'VENDOR_BSB' SUBSTR(_VENDOR_BANK_ACCOUNT_NUMBER_,1,30) AS 'VENDOR_BANK_ACCOUNT_NUMBER' c_ACCT_START_DATE AS 'ACCT_START_DATE'  c_ACCT_END_DATE AS 'ACCT_END_DATE' TO "VENDOR_BANK_ACCOUNT_FMT.FIL"

DO PrepareVB

SET SAFETY ON 
^BATCH    PrepareVB                          
[PARENT_FOLDER_ID] 1430205343
COMM IMPORT INVOICES AND PREPARE INDIVIDUAL 

CLOSE PRIMARY SECONDARY
SET SAFETY OFF
OPEN VENDOR_BANK_ACCOUNT_FMT



SORT ON VENDOR_SITE_ID ACCT_START_DATE  D  TO "VEDOR_BANK_ACCOUNT_SORTED" OPEN
OPEN "VEDOR_BANK_ACCOUNT_SORTED"

DELETE FORMAT VENDOR_BANK_ACCOUNT_NO_DUPS OK
SUMMARIZE ON VENDOR_SITE_ID VENDOR_ID OTHER VENDOR_ID VENDOR_SITE_ID VENDOR_BANK_ACCT_NAME VENDOR_BSB VENDOR_BANK_ACCOUNT_NUMBER ACCT_START_DATE ACCT_END_DATE TO "VENDOR_BANK_ACCOUNT_NO_DUPS.FIL" OPEN PRESORT

OPEN "VENDOR_BANK_ACCOUNT_NO_DUPS"


COMM APPEND THE SUMMARISED INVOICES BEFORE ELIMINATING DUPLICATES WITHIN DELTA FILES

IF v_Record = 1 EXTRACT FIELDS  SUBSTR(VENDOR_SITE_ID,1,16) AS 'VENDOR_SITE_ID' SUBSTR(VENDOR_ID,1,15) AS 'VENDOR_ID' SUBSTR(VENDOR_BANK_ACCT_NAME,1,50) AS 'VENDOR_BANK_ACCT_NAME' SUBSTR(VENDOR_BSB,1,12) AS 'VENDOR_BSB'  SUBSTR(VENDOR_BANK_ACCOUNT_NUMBER,1,30) AS 'VENDOR_BANK_ACCOUNT_NUMBER' ACCT_START_DATE ACCT_END_DATE TO TMP_Imported

IF v_Record > 1 EXTRACT FIELDS  SUBSTR(VENDOR_SITE_ID,1,16) AS 'VENDOR_SITE_ID' SUBSTR(VENDOR_ID,1,15) AS 'VENDOR_ID' SUBSTR(VENDOR_BANK_ACCT_NAME,1,50) AS 'VENDOR_BANK_ACCT_NAME' SUBSTR(VENDOR_BSB,1,12) AS 'VENDOR_BSB'  SUBSTR(VENDOR_BANK_ACCOUNT_NUMBER,1,30) AS 'VENDOR_BANK_ACCOUNT_NUMBER' ACCT_START_DATE ACCT_END_DATE TO  TMP_Imported APPEND


SET SAFETY ON
^FOLDER   Working_Files                       1249276814
[PARENT_FOLDER_ID] 0
^BATCH    AC001_Main_Menu                    
[PARENT_FOLDER_ID] 1340167481
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Tests Main Menu
COMM *** Before run the Tests, check the target tables to see if related tables exist and get data inside
COMM *** Otherwise, redirect to data import or convert menu
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 21/06/2012
COMM***************************************************************************


SET SAFETY OFF

IF FTYPE("_Version")="v" OR FTYPE("_Version")="U" DO AA002_Variable_Setting

DO AC002_Test_Var_Input

FLAG_Test=F

DO AC003_Batch_Menu WHILE FLAG_Test=F

SET SAFETY ON
^BATCH    MainInvoiceImport                  
[PARENT_FOLDER_ID] 1430205343
COM ************************************************************
COMMENT Importing invoice, VMF and VendBank files :
COM ************************************************************

SET SAFETY OFF 
CLOSE PRIMARY SECONDARY


COMM Import Invoices 
v_Parent_Invoice_Folder = "E:\Data"
v_folder_location = "%v_Parent_Invoice_Folder%\"
v_file_extension = ".txt"

COM IMPORT AND PREPARE ALL INVOICE FILES
COMMENT
CLOSE
SET DATE "DD/MM/YYYY"
DIR "%fld_VM_AP_Fld%*" TO "%fld_Tmps%TMP4"
DELETE FORMAT FILES OK
DIRECTORY "%fld_VM_AP_Fld%Invoices_*%fld_VM_AP_Ext%" TO Files 
DELETE FORMAT Files1 OK
OPEN Files
SORT ON FILE_CREATE_DATE  FILE_CREATE_TIME  TO Files1 
OPEN Files1 
COUNT
v_Record = 1
DO Import_001 WHILE  v_Record <= COUNT1 
OPEN TMP_Imported
COMMENT

COM IMPORT AND PREPARE ALL VENDOR MASTER FILES

DELETE FORMAT Files OK 
DIRECTORY "%v_folder_location%VendorMasterfile_*%v_file_extension%" TO Files 
DELETE FORMAT Files1 OK
OPEN Files
SORT ON FILE_CREATE_DATE D FILE_CREATE_TIME D TO Files1 
OPEN Files1 
COUNT
v_Record = 1
DO Import_002 WHILE  v_Record <= COUNT1 
OPEN TMP_Imported
DELETE FORMAT VENDOR_MASTER_SUMM_NODUPS OK
DELETE FORMAT TMP1 OK
SORT ON VENDOR_SITE_ID VENDOR_ID VENDOR_NUMBER CREATION_DATE  D  TO "TMP1" OPEN
OPEN "TMP1"
DELETE FORMAT VENDOR_MASTER_SUMM_NODUPS OK
SUMMARIZE ON VENDOR_SITE_ID VENDOR_ID VENDOR_NUMBER OTHER VENDOR_SITE_ID VENDOR_ID VENDOR_NUMBER VENDOR_NAME VENDOR_SITE VENDOR_ADDRESS CITY STATE POSTCODE COUNTRY INACTIVE_DATE  VENDOR_ABN  GST_REGISTRATION_STATUS AREA_CODE PHONE FAX EMAIL_ADDRESS VENDOR_TYPE PAYMENT_METHOD CREATION_DATE Vndr_Sts TEL1 FAX 'R11' AS 'SourceFlag' TO "VENDOR_MASTER_SUMM_NODUPS.FIL" OPEN PRESORT
DELETE FORMAT TMP1 OK


COM IMPORT AND PREPARE ALL Vendor Banking File

DELETE FORMAT Files OK
DIRECTORY "%v_folder_location%VendorBankAccount_*%v_file_extension%" TO Files 
DELETE FORMAT Files1 OK
OPEN Files
SORT ON FILE_CREATE_DATE D FILE_CREATE_TIME D TO Files1 
OPEN Files1 
COUNT
v_Record = 1
DO Import_003 WHILE  v_Record <= COUNT1 
OPEN TMP_Imported
DELETE FORMAT VENDOR_BANKACC_SUMM_NODUP 

SUMMARIZE ON VENDOR_SITE_ID VENDOR_ID VENDOR_BANK_ACCOUNT_NUMBER ACCT_START_DATE OTHER VENDOR_SITE_ID VENDOR_ID VENDOR_BANK_ACCT_NAME VENDOR_BSB VENDOR_BANK_ACCOUNT_NUMBER ACCT_START_DATE ACCT_END_DATE 'R11' AS 'SourceFlag' TO "VENDOR_BANKACC_SUMM_NODUP.FIL" OPEN PRESORT
SET SAFETY ON









^BATCH    AA001_Main_Menu                    
[PARENT_FOLDER_ID] 1340167442
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Main Menu
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SESSION AA001_Main_Menu
IF FTYPE("_Version")="v" OR FTYPE("_Version")="U" OR FTYPE("fld_Sources")="U" OR FTYPE("fld_DataMapping")="U" DO AA002_Variable_Setting

SET SAFETY OFF

DO AC002_Test_Var_Input

IF FTYPE("CHK_Main_Imp")="U" ASSIGN CHK_Main_Imp=F
IF FTYPE("CHK_Main_Lnk")="U" ASSIGN CHK_Main_Lnk=F
IF FTYPE("CHK_Main_Conv")="U" ASSIGN CHK_Main_Conv=F
IF FTYPE("CHK_Main_Test")="U" ASSIGN CHK_Main_Test=F
IF FTYPE("CHK_Main_ST")="U" ASSIGN CHK_Main_ST=F
IF FTYPE("CHK_Main_Exp")="U" ASSIGN CHK_Main_Exp=F
IF FTYPE("CHK_ABNChecker")="U" ASSIGN CHK_ABNChecker=F
IF FTYPE("CHK_ACLExtractor")="U" ASSIGN CHK_ACLExtractor=F
IF FTYPE("exit")="U" ASSIGN exit=T

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version%" WIDTH 683 HEIGHT 475 ) (BUTTONSET TITLE "&OK;&Cancel" AT 492 396 DEFAULT 1 )(TEXT TITLE "_________________________________________________________________________________________________________________________________" AT 12 28 WIDTH 524 ) (TEXT TITLE "Accounts Payable, Vendor Master, Employee Master and Payroll Exception Tests" AT 12 76 WIDTH 513 CENTER ) (TEXT TITLE "SATORI GROUP                                           1800-SATORI                             www.satorigroup.com.au" AT 12 16 WIDTH 531 ) (CHECKBOX TITLE "1. Import Source Data" TO "CHK_Main_Imp" AT 36 132 )(CHECKBOX TITLE "2. Field Mapping from Source Data Tables to Fraud Module Standard Tables (Optional)" TO "CHK_Main_Lnk" AT 36 168 WIDTH 462 ) (CHECKBOX TITLE "3. Convert Source Data Tables  into  Fraud Module Standard Tables" TO "CHK_Main_Conv" AT 36 204 ) (CHECKBOX TITLE "4. Run ABN Checker to obtain ABN Status Information from ABR Website" TO "CHK_ABNChecker" AT 36 240 )(CHECKBOX TITLE "5. Exception Tests Execution" TO "CHK_Main_Test" AT 36 276 ) (CHECKBOX TITLE "6. Export ACL Test Results" TO "CHK_Main_Exp" AT 36 312 )    (CHECKBOX TITLE "7. Use ACL Report Extractor to combine all reports into one Excel workbook" TO "CHK_ACLExtractor" AT 36 348 )(CHECKBOX TITLE "8. Exit/Escape" TO "exit" AT 36 384 )


IF exit=T ESCAPE

IF CHK_Main_Imp = T  DO IA001_Menu
IF CHK_Main_Lnk = T  DO LE001_Link_Menu
IF CHK_Main_Conv = T  DO MA001_Main_Menu
IF CHK_ABNChecker=T DO CA003_RunABNChecker
IF CHK_Main_Test = T  DO AC001_Main_Menu
IF CHK_Main_Exp = T  DO UA001_Export_Menu
IF CHK_ACLExtractor=T DO CZ001_ACLExtractor

%v_CCMJob% IF CHK_ACLExtractor<>T AND (CHK_Main_Imp = T OR CHK_Main_Lnk = T OR CHK_Main_Conv = T OR CHK_ABNChecker=T OR CHK_Main_Test = T OR CHK_Main_Exp = T) PAUSE "ACL step(s) you selected run successfully."


SET SAFETY ON
^BATCH    CB007_Imp_Inv                      
[PARENT_FOLDER_ID] 1341537122
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** User can customize data after importing source data
COMM *** DATE: 06/10/2012
COMM***************************************************************************


IF FTYPE("fld_Sources")="U" OR FTYPE("fld_Data")="U" OR FTYPE("fld_VM_AP_Inv_Fld")="U" OR  FTYPE("fld_VM_AP_Inv_Ext") = "U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"

SET FOLDER /%fld_Tmps%

COMM *** List Table Names ***
CLOSE

DIR "%fld_VM_AP_Inv_Fld%*" TO "%fld_Tmps%TMP4"
OPEN TMP4
SORT ON FILE_CREATE_DATE  FILE_CREATE_TIME  TO "%fld_Tmps%Data_Inv_Lst"
DELETE FIELD c_Folder OK
DEFINE FIELD c_Folder COMPUTED SUBSTR(REPLACE(ALLTRIM(REPLACE(FILE_NAME,'%fld_VM_AP_Inv_Fld%','')),'%fld_VM_AP_Inv_Ext%',''),1,20)

SET FILTER TO MAP(c_Folder,"99999999")
SORT ON c_Folder TO "%fld_Tmps%Lst_Fld" OPEN
COUNT
v_counter=1
DO CB007_Imp_Inv_Sub WHILE v_counter<=COUNT1



COMM *** delete all temp files ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    CB001_Imp_AP_VMBnk_SUB             
[PARENT_FOLDER_ID] 1341537122
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Import Vendor Master Files (fixed and delta)
COMM *** DATE: 06/10/2015
COMM***************************************************************************


IF FTYPE("fld_Sources")="U" OR FTYPE("fld_Data")="U" OR FTYPE("fld_VM_AP_VMBnk_Fld")="U" OR  FTYPE("fld_VM_AP_VMBnk_Ext") = "U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"

SET FOLDER /%fld_Tmps%

COMM *** List Table Names ***
CLOSE

DIR "%fld_VM_AP_VMBnk_Fld%*" TO "%fld_Tmps%TMP4"
OPEN TMP4

SORT ON FILE_CREATE_DATE  FILE_CREATE_TIME  TO "%fld_Tmps%Data_VMBnk_Lst"
DELETE FIELD c_Folder OK
DEFINE FIELD c_Folder COMPUTED SUBSTR(REPLACE(ALLTRIM(REPLACE(FILE_NAME,'%fld_VM_AP_VMBnk_Fld%','')),'%fld_VM_AP_VMBnk_Ext%',''),1,20)

SET FILTER TO MAP(c_Folder,"99999999")
SORT ON c_Folder TO "%fld_Tmps%Lst_Fld" OPEN
COUNT
v_counter=1
DO CB007_Imp_VMBnk_Sub WHILE v_counter<=COUNT1



COMM *** delete all temp files ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    New_Script                         
[PARENT_FOLDER_ID] 1430205343
DIALOG (DIALOG TITLE '%_Version% - Accounts Payable Exception Tests' WIDTH 900 HEIGHT 636+80 ) (BUTTONSET TITLE '&OK;&Cancel' AT 720 144 DEFAULT 1 ) (TEXT TITLE 'Accounts Payable Exception Tests' AT 264 8 )(TEXT TITLE 'Test Options' AT 720 40 ) (RADIOBUTTON TITLE 'One Time;Exclude History' TO 'RAD_AP' AT 720 60 DEFAULT 1 ) (CHECKBOX TITLE 'Run All AP Tests' TO 'CHK_AP_ALL' AT 24 36 ) (CHECKBOX TITLE 'AP001. Identify possible Duplicate Invoices by Invoice Number, Amount, Date, and Vendor Number' TO 'CHK_AP000' AT 24 60 WIDTH 529 )(TEXT TITLE 'AP002. Identify possible Duplicate Invoices by Invoice Number, Amount, and Date (different Vendor Number)' AT 40 84 WIDTH 663 )(TEXT TITLE 'AP003. Identify possible Duplicate Invoices by Invoice Number, Amount and Vendor Number (different Date)' AT 40 108 WIDTH 662 )(CHECKBOX TITLE 'AP004. Identify possible Duplicate Invoices by Amount, Date and Vendor Number (different Invoice Number)' TO 'CHK_AP004' AT 24 132 WIDTH 600)(CHECKBOX TITLE 'AP005. Identify vendors with more than 3 consecutive invoice numbers' TO 'CHK_AP005' AT 24 156 )(CHECKBOX TITLE 'AP006. Identify payments made to vendors not in vendor master file' TO 'CHK_AP006' AT 24 180 )(CHECKBOX TITLE 'AP007. Identify transactions by vendors not registered for GST who are charging GST' TO 'CHK_AP007' AT 24 204 )(CHECKBOX TITLE 'AP008. Identify requisition where authorisation for payment exceeds the allowed limit $' TO 'CHK_AP008' AT 24 228 WIDTH 430 ) (EDIT TO 'TXT_AP008_AllowLimit' AT 450 228 WIDTH 57 DEFAULT '%TXT_AP008_AllowLimit%' )(CHECKBOX TITLE 'AP009. Identify invoices with GST tax overcharges (GST Value AUS >10.05%, NZL >15.05%)' TO 'CHK_AP009' AT 24 252 WIDTH 564 )(CHECKBOX TITLE 'AP010. Extract large invoice payments excluding any intercompany transactions' TO 'CHK_AP010' AT 24 276 WIDTH 400 )(TEXT TITLE 'Where the largest value is' AT 48 300+5 WIDTH 150 RIGHT ) (EDIT TO 'TXT_AP010_Pct' AT 200 300 WIDTH 33 HEIGHT 23 DEFAULT '%TXT_AP010_Pct%') (TEXT TITLE '% greater than average values for this vendor, with total transaction more than ' AT 238 300+5 WIDTH 400 ) (EDIT TO 'TXT_AP010_Cnt' AT 610 300 WIDTH 33 DEFAULT '%TXT_AP010_Cnt%' )(CHECKBOX TITLE 'AP011. Identify Invoices with PO date after invoice date (if PO Data available)' TO 'CHK_AP011' AT 24 324 )(CHECKBOX TITLE 'AP012. Identify POs that are paid for but no goods / services received (if PO Data available)' TO 'CHK_AP012' AT 24 348 )(CHECKBOX TITLE 'AP013. Identify invoices where a PO is used multiple times but with different vendors' TO 'CHK_AP013' AT 24 372 )(CHECKBOX TITLE 'AP014. Identify active vendors without transactions in the past' TO 'CHK_AP014' AT 24 396 WIDTH 320 ) (EDIT TO 'TXT_AP014_Months' AT 338 396 WIDTH 34 DEFAULT '%TXT_AP014_Months%' ) (TEXT TITLE 'months' AT 372 396+5 )(CHECKBOX TITLE 'AP015. Identify multiple (>2) transactions against the same one-time vendor' TO 'CHK_AP015' AT 24 420 )(CHECKBOX TITLE 'AP016. Identify transactions against vendors with missing or invalid ABN' TO 'CHK_AP016' AT 24 444 )(CHECKBOX TITLE 'AP017. Report of Top ' TO 'CHK_AP017' AT 24 468 WIDTH 126 ) (EDIT TO 'TXT_AP017_Top' AT 168 468 WIDTH 32 DEFAULT '%TXT_AP017_Top%' ) (TEXT TITLE 'Vendors over' AT 204 468+5 WIDTH 65 HEIGHT 17 ) (EDIT TO 'TXT_AP017_Months' AT 276 468 WIDTH 31 DEFAULT '%TXT_AP017_Months%' )(TEXT TITLE 'months' AT 312 468+5 WIDTH 58 )(CHECKBOX TITLE 'AP018. Identify requisition where authorisation for payment near to the allowed limit $' TO 'CHK_AP018' AT 24 492 WIDTH 415 ) (EDIT TO 'TXT_AP018_AllowLimit' AT 444 492 WIDTH 220 DEFAULT '%TXT_AP018_AllowLimit%' ) (EDIT TO 'TXT_AP018_AllowLimit_Pct' AT 672 492 WIDTH 24 DEFAULT '%TXT_AP018_AllowLimit_Pct%' ) (TEXT TITLE '%' AT 708 492+5 )(CHECKBOX TITLE 'AP019. Identify Invoices where a credit note exists yet payment has been made' TO 'CHK_AP019' AT 24 516 )(CHECKBOX TITLE 'AP020. Identify Vendors with numerious payments who could be paid on a monthly basis' TO 'CHK_AP020' AT 24 540 )(CHECKBOX TITLE 'AP021. Identify cheque number which is out of sequence' TO 'CHK_AP021' AT 24 564 )(CHECKBOX TITLE 'AP022. Identify discounts missed based on invoice and payment date and terms' TO 'CHK_AP022' AT 24 588 )(CHECKBOX TITLE 'AP023. Identify discounts achieved but not awarded based on invoice and payment date and terms' TO 'CHK_AP023' AT 24 612)(CHECKBOX TITLE 'AP024. Identify Low activity vendors (less than' TO 'CHK_AP024' AT 24 636 WIDTH 235 ) (EDIT TO 'TXT_AP024_Trans_Num' AT 264 636 WIDTH 40 DEFAULT '%TXT_AP024_Trans_Num%' ) (TEXT TITLE 'transactions within ' AT 308 636+5 WIDTH 108 ) (EDIT TO 'TXT_AP024_Mon' AT 400 636 WIDTH 40 DEFAULT '%TXT_AP024_Mon%') (TEXT TITLE 'months' AT 445 636+5 ) (TEXT TITLE '(vendor created date >=' AT 490 636+5 WIDTH 138 ) (EDIT TO 'TXT_AP024_Created_Mon' AT 610 636 WIDTH 32 DEFAULT '%TXT_AP024_Created_MoN%') (TEXT TITLE 'months)' AT 660 636+5 ) (EDIT TO 'TXT_AP010_Cnt' AT 708 636 WIDTH 33 DEFAULT '%TXT_AP010_Cnt%' )
^BATCH    CA002_Imp_AP_VM_Main               
[PARENT_FOLDER_ID] 1341537122
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** User can customize data after importing source data
COMM *** Prepare the data for the mapping/conversion  -- Main Script
COMM *** Created by Nancy ON 30/07/2012 
COMM***************************************************************************
SET SAFETY OFF

IF FTYPE("_Version")="v" OR FTYPE("_Version")="U" OR FTYPE("fld_Sources")="U" OR FTYPE("fld_DataMapping")="U" DO AA002_Variable_Setting

SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

COMM move any files already processed in archive into E:\Data\Error to prevent double processing
DELETE FORMAT _DATA OK
DIR %fld_Data_Path%*%fld_VM_AP_Inv_Ext% TO _DATA
DELETE FORMAT _ARCHIVE OK
DIR %fld_Archive_Path%*%fld_VM_AP_Inv_Ext% TO _ARCHIVE

OPEN _ARCHIVE
DELETE FIELD cKEY OK
DEFINE FIELD cKEY COMPUTED SUBSTRING(REPLACE(ALLTRIM(FILE_NAME),"%fld_Archive_Path%",""),1,40)
INDEX ON cKEY TO IDX_Key

OPEN _DATA
DELETE FIELD cKEY OK
DEFINE FIELD cKEY COMPUTED SUBSTRING((REPLACE(ALLTRIM(FILE_NAME),"%fld_Data_Path%","")),1,40)

DEFINE RELATION cKEY WITH _ARCHIVE INDEX IDX_Key

EXTRACT RECORD TO "%fld_Tmps%TMP5.FIL" IF  MATCH(_DATA.cKEY  _ARCHIVE.cKEY )  

OPEN TMP5
COUNT
v_counter=1
DO CB010MoveToError WHILE v_counter<= COUNT1

COMM *** Importing And Prepared AP and Vendor Master File ***


DO CB001_Imp_AP_VM

DO CB002_Pre_AP_VM

SET SAFETY ON
^BATCH    CB010MoveToError                   
[PARENT_FOLDER_ID] 1341537122
SET SAFETY OFF
IF FTYPE("fld_Data_Path")="U" DO AA002_Variable_Setting
OPEN TMP5
LOCATE RECORD v_counter

v_FILE_NAME = ALLTRIM(FILE_NAME)

v_filename = REPLACE(v_FILE_NAME,"E:\Data\","E:\Data\")

v_errFilename = REPLACE(v_FILE_NAME,"E:\Data\","E:\Data\Error\")

 RENAME FILE "%v_FILE_NAME%" "%v_errFilename%" OK

v_counter = v_counter + 1
SET SAFETY ON

^FOLDER   Data                                1430796652
[PARENT_FOLDER_ID] 1340167351
^FOLDER   Export                              1430796679
[PARENT_FOLDER_ID] 1430796652
^FOLDER   Import                              1430796694
[PARENT_FOLDER_ID] 1430796652
^FOLDER   Mapping                             1430796705
[PARENT_FOLDER_ID] 1430796652
^FOLDER   Prep                                1430796715
[PARENT_FOLDER_ID] 1430796652
^BATCH    UA001_Export_Menu                  
[PARENT_FOLDER_ID] 1430796679
COMMENT
***********************************************************************
* Script Name:UA001_Export_Menu                                       *
* Description: Interactive menu which would export files into format  *
* Last Modified on:27/06/2012       by:  Nancy Li                     *
***********************************************************************
END


IF FTYPE("_Version")="v" OR FTYPE("_Version")="U" OR FTYPE("fld_Sources")="U" OR FTYPE("fld_DataMapping")="U" DO AA002_Variable_Setting
IF FTYPE("_Version")="v" OR FTYPE("_Version")="U" DO AA002_Variable_Setting

SET SAFETY OFF

DO UZ006_CHK_Exp_F


IF FTYPE("rad1")="U" ASSIGN rad1 = 6
IF FTYPE("rad2")="U" ASSIGN rad2 = 6
IF FTYPE("CHK_TEST_VMF")="U" ASSIGN CHK_TEST_VMF=F
IF FTYPE("CHK_TEST_AP")="U" ASSIGN CHK_TEST_AP=F
IF FTYPE("CHK_TEST_EMF")="U" ASSIGN CHK_TEST_EMF=F
IF FTYPE("CHK_TEST_PR")="U" ASSIGN CHK_TEST_PR=F
IF FTYPE("CHK_TEST_ST")="U" ASSIGN CHK_TEST_ST=F
IF FTYPE("TXT_Exp_filepath")="U" ASSIGN TXT_Exp_filepath="Reports\"
IF FTYPE("exit")="U" ASSIGN exit=F

COMM *** DIALOG ***
IF FILESIZE("Dialogs\Dialog_UA001_Export_Menu.txt") <=0 ESCAPE
DELETE SCRIPT Dialog_UA001_Export_Menu OK
%v_CCMJob% DO "Dialogs\Dialog_UA001_Export_Menu.txt"

IF exit=T ESCAPE

IF rad2=2 AND CHK_TEST_VMF =T DO UB001_Export_VM
IF rad2=2 AND CHK_TEST_AP =T DO UB002_Export_AP
IF rad2=2 AND CHK_TEST_EMF =T DO UB003_Export_EM
IF rad2=2 AND CHK_TEST_PR =T DO UB004_Export_PR
IF rad2=2 AND CHK_TEST_ST =T DO UB005_Export_ST

IF rad2=1 AND CHK_TEST_VMF =T DO UZ001_CHK_Exp_VM_All_T
IF rad2=1 AND CHK_TEST_AP =T DO UZ002_CHK_Exp_AP_All_T
IF rad2=1 AND CHK_TEST_EMF =T DO UZ003_CHK_Exp_EM_All_T
IF rad2=1 AND CHK_TEST_PR =T DO UZ004_CHK_Exp_PR_All_T
IF rad2=1 AND CHK_TEST_ST =T DO UZ005_CHK_Exp_ST_All_T


DO UU001_Export


%v_CCMJob% PAUSE "Test results have been exported into %TXT_Exp_filepath% successfully."

SET SAFETY ON
^BATCH    UB001_Export_VM                    
[PARENT_FOLDER_ID] 1430796753
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Export Vendor Master File Results
COMM *** Menu 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 21/06/2012
COMM***************************************************************************


SET DATE "DD/MM/YYYY"

COMM *** DIALOG ***
IF FILESIZE("Dialogs\Dialog_UB001_Export_VM.txt") <=0 ESCAPE
DELETE SCRIPT Dialog_UB001_Export_VM OK
%v_CCMJob% DO "Dialogs\Dialog_UB001_Export_VM.txt"
DELETE SCRIPT Dialog_UB001_Export_VM OK

IF CHK_Exp_VM_ALL=T DO UZ001_CHK_Exp_VM_All_T


^BATCH    UB002_Export_AP                    
[PARENT_FOLDER_ID] 1430796679
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Export Accounts Payable Results
COMM *** Menu 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 21/06/2012
COMM***************************************************************************


COMM *** DIALOG ***
IF FILESIZE("Dialogs\Dialog_UB002_Export_AP.txt") <=0 ESCAPE
DELETE SCRIPT Dialog_UB002_Export_AP OK
%v_CCMJob% DO "Dialogs\Dialog_UB002_Export_AP.txt"
DELETE SCRIPT Dialog_UB002_Export_AP OK


IF CHK_Exp_AP000 =T ASSIGN CHK_Exp_AP001=T
IF CHK_Exp_AP000 =T ASSIGN CHK_Exp_AP002=T
IF CHK_Exp_AP000 =T ASSIGN CHK_Exp_AP003=T

IF CHK_Exp_AP000 =F ASSIGN CHK_Exp_AP001=F
IF CHK_Exp_AP000 =F ASSIGN CHK_Exp_AP002=F
IF CHK_Exp_AP000 =F ASSIGN CHK_Exp_AP003=F

IF CHK_Exp_AP_ALL=T DO UZ002_CHK_Exp_AP_All_T



^BATCH    UB003_Export_EM                    
[PARENT_FOLDER_ID] 1430796753
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Export Employee Master File Tests Results
COMM *** Menu 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET DATE "DD/MM/YYYY"

COMM *** DIALOG ***
IF FILESIZE("Dialogs\Dialog_UB003_Export_EM.txt") <=0 ESCAPE
DELETE SCRIPT Dialog_UB003_Export_EM OK
%v_CCMJob% DO "Dialogs\Dialog_UB003_Export_EM.txt"
DELETE SCRIPT Dialog_UB003_Export_EM OK

IF CHK_Exp_EM_ALL=T DO UZ003_CHK_Exp_EM_All_T


^BATCH    UB004_Export_PR                    
[PARENT_FOLDER_ID] 1430796679
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Payroll Exception Tests
COMM *** Menu 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 21/06/2012
COMM***************************************************************************


SET DATE "YYYY-MM-DD"

COMM *** DIALOG ***
IF FILESIZE("Dialogs\Dialog_UB004_Export_PR.txt") <=0 ESCAPE
DELETE SCRIPT Dialog_UB004_Export_PR OK
%v_CCMJob% DO "Dialogs\Dialog_UB004_Export_PR.txt"
DELETE SCRIPT Dialog_UB004_Export_PR OK

IF CHK_Exp_PR_ALL=T DO UZ004_CHK_Exp_PR_All_T




^BATCH    UB005_Export_ST                    
[PARENT_FOLDER_ID] 1430796679

IF FILESIZE("Dialogs\Dialog_UB005_Export_ST.txt") <=0 ESCAPE
DELETE SCRIPT Dialog_UB005_Export_ST OK
%v_CCMJob% DO "Dialogs\Dialog_UB005_Export_ST.txt"
DELETE SCRIPT Dialog_UB005_Export_ST OK

IF CHK_Exp_ST_ALL=T DO UZ005_CHK_Exp_ST_All_T
^BATCH    UZ001_CHK_Exp_VM_All_T             
[PARENT_FOLDER_ID] 1430796679
CHK_Exp_VM001=T
CHK_Exp_VM002=T
CHK_Exp_VM003=T
CHK_Exp_VM004=T
CHK_Exp_VM005=T
CHK_Exp_VM006=T
CHK_Exp_VM007=T
CHK_Exp_VM008=T
CHK_Exp_VM009=T
CHK_Exp_VM010=T
CHK_Exp_VM011=T
CHK_Exp_VM012=T
CHK_Exp_VM013=T
CHK_Exp_VM014=T
CHK_Exp_VM015=T
CHK_Exp_VM016=T
CHK_Exp_VM017=T
^BATCH    UZ002_CHK_Exp_AP_All_T             
[PARENT_FOLDER_ID] 1430796679
CHK_Exp_AP000=T

CHK_Exp_AP001=T
CHK_Exp_AP002=T
CHK_Exp_AP003=T
CHK_Exp_AP004=T
CHK_Exp_AP005=T
CHK_Exp_AP006=T
CHK_Exp_AP007=T
CHK_Exp_AP008=T
CHK_Exp_AP009=T
CHK_Exp_AP010=T
CHK_Exp_AP011=T
CHK_Exp_AP012=T
CHK_Exp_AP013=T
CHK_Exp_AP014=T
CHK_Exp_AP015=T
CHK_Exp_AP016=T
CHK_Exp_AP017=T
CHK_Exp_AP018=T
CHK_Exp_AP019=T
CHK_Exp_AP020=T
CHK_Exp_AP021=T
CHK_Exp_AP022=T
CHK_Exp_AP023=T
CHK_Exp_AP024=T
^BATCH    UZ003_CHK_Exp_EM_All_T             
[PARENT_FOLDER_ID] 1430796679
CHK_Exp_EM001=T
CHK_Exp_EM002=T
CHK_Exp_EM003=T
CHK_Exp_EM004=T
CHK_Exp_EM005=T
CHK_Exp_EM006=T
CHK_Exp_EM007=T
CHK_Exp_EM008=T
CHK_Exp_EM009=T
CHK_Exp_EM010=T
CHK_Exp_EM011=T
CHK_Exp_EM012=T
CHK_Exp_EM013=T
CHK_Exp_EM014=T
CHK_Exp_EM015=T


^BATCH    UZ004_CHK_Exp_PR_All_T             
[PARENT_FOLDER_ID] 1430796679
CHK_Exp_PR001=T
CHK_Exp_PR002=T
CHK_Exp_PR003=T
CHK_Exp_PR004=T
CHK_Exp_PR005=T
CHK_Exp_PR006=T
CHK_Exp_PR007=T
CHK_Exp_PR008=T
CHK_Exp_PR009=T

^BATCH    UZ005_CHK_Exp_ST_All_T             
[PARENT_FOLDER_ID] 1430796679
CHK_Exp_ST001=T
CHK_Exp_ST002=T
CHK_Exp_ST003=T
CHK_Exp_ST004=T
CHK_Exp_ST005=T
CHK_Exp_ST006=T
^BATCH    UZ006_CHK_Exp_F                    
[PARENT_FOLDER_ID] 1430796679

ASSIGN CHK_Exp_VM001=F
ASSIGN CHK_Exp_VM002=F
ASSIGN CHK_Exp_VM003=F
ASSIGN CHK_Exp_VM004=F
ASSIGN CHK_Exp_VM005=F
ASSIGN CHK_Exp_VM006=F
ASSIGN CHK_Exp_VM007=F
ASSIGN CHK_Exp_VM008=F
ASSIGN CHK_Exp_VM009=F
ASSIGN CHK_Exp_VM010=F
ASSIGN CHK_Exp_VM011=F
ASSIGN CHK_Exp_VM012=F
ASSIGN CHK_Exp_VM013=F
ASSIGN CHK_Exp_VM014=F
ASSIGN CHK_Exp_VM015=F
ASSIGN CHK_Exp_VM016=F
ASSIGN CHK_Exp_VM017=F

ASSIGN CHK_Exp_AP000=F
ASSIGN CHK_Exp_AP001=F
ASSIGN CHK_Exp_AP002=F
ASSIGN CHK_Exp_AP003=F
ASSIGN CHK_Exp_AP004=F
ASSIGN CHK_Exp_AP005=F
ASSIGN CHK_Exp_AP006=F
ASSIGN CHK_Exp_AP007=F
ASSIGN CHK_Exp_AP008=F
ASSIGN CHK_Exp_AP009=F
ASSIGN CHK_Exp_AP010=F
ASSIGN CHK_Exp_AP011=F
ASSIGN CHK_Exp_AP012=F
ASSIGN CHK_Exp_AP013=F
ASSIGN CHK_Exp_AP014=F
ASSIGN CHK_Exp_AP015=F
ASSIGN CHK_Exp_AP016=F
ASSIGN CHK_Exp_AP017=F
ASSIGN CHK_Exp_AP018=F
ASSIGN CHK_Exp_AP019=F
ASSIGN CHK_Exp_AP020=F
ASSIGN CHK_Exp_AP021=F
ASSIGN CHK_Exp_AP022=F
ASSIGN CHK_Exp_AP023=F
ASSIGN CHK_Exp_AP024=F

ASSIGN CHK_Exp_EM001=F
ASSIGN CHK_Exp_EM002=F
ASSIGN CHK_Exp_EM003=F
ASSIGN CHK_Exp_EM004=F
ASSIGN CHK_Exp_EM005=F
ASSIGN CHK_Exp_EM006=F
ASSIGN CHK_Exp_EM007=F
ASSIGN CHK_Exp_EM008=F
ASSIGN CHK_Exp_EM009=F
ASSIGN CHK_Exp_EM010=F
ASSIGN CHK_Exp_EM011=F
ASSIGN CHK_Exp_EM012=F
ASSIGN CHK_Exp_EM013=F
ASSIGN CHK_Exp_EM014=F
ASSIGN CHK_Exp_EM015=F
ASSIGN CHK_Exp_EM016=F
ASSIGN CHK_Exp_EM017=F

ASSIGN CHK_Exp_PR001=F
ASSIGN CHK_Exp_PR002=F
ASSIGN CHK_Exp_PR003=F
ASSIGN CHK_Exp_PR004=F
ASSIGN CHK_Exp_PR005=F
ASSIGN CHK_Exp_PR006=F
ASSIGN CHK_Exp_PR007=F
ASSIGN CHK_Exp_PR008=F
ASSIGN CHK_Exp_PR009=F

ASSIGN CHK_Exp_ST001=F
ASSIGN CHK_Exp_ST002=F
ASSIGN CHK_Exp_ST003=F
ASSIGN CHK_Exp_ST004=F
ASSIGN CHK_Exp_ST005=F
ASSIGN CHK_Exp_ST006=F

^BATCH    IA001_Menu                         
[PARENT_FOLDER_ID] 1430796694
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Load Source Data : Menu
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF

IF FTYPE("_Version")="U" OR FTYPE("fld_Sources")="U" DO AA002_Variable_Setting
IF FTYPE("DRP_Source")="U" ASSIGN DRP_Source="from Files"

IF FTYPE("CHK_IM001_Custom")="U" CHK_IM001_Custom=F
IF FTYPE("TXT_IM001_Custom")="U" TXT_IM001_Custom="CA001_Main"
IF FTYPE("v_EMP_Folder")="U" v_EMP_Folder="ADP\"
IF FTYPE("v_AP_Folder")="U" v_AP_Folder = "AP\"

COMM
DIALOG (DIALOG TITLE "%_Version% - Import Data" WIDTH 619 HEIGHT 161 ) (BUTTONSET TITLE "&OK;&Cancel" AT 468 48 DEFAULT 1 ) (DROPDOWN TITLE "from Files;ADP;Great Plains;SAP;JD Edwards;PeopleSoft;Oracle" TO "DRP_Source" AT 180 48 WIDTH 219 DEFAULT 1 ) (TEXT TITLE "Import source files from" AT 36 52 WIDTH 131 HEIGHT 18 ) (CHECKBOX TITLE "Use a prepared script for data importing and preparation." TO "CHK_IM001_Custom" AT 36 84 Checked) (TEXT TITLE "Main script name:" AT 42 112 RIGHT ) (DROPDOWN TITLE "CA001_Imp_All_Main;CA002_Imp_AP_VM_Main;CA003_Imp_PR_EM_Main" TO "TXT_IM001_Custom" AT 180 108 WIDTH 212 DEFAULT 1 )

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% - Import Data" WIDTH 619 HEIGHT 161 ) (BUTTONSET TITLE "&OK;&Cancel" AT 468 48 DEFAULT 1 ) (DROPDOWN TITLE "from Files;ADP;Great Plains" TO "DRP_Source" AT 180 48 WIDTH 219 DEFAULT 1 ) (TEXT TITLE "Import source files from" AT 36 52 WIDTH 131 HEIGHT 18 ) (CHECKBOX TITLE "Use a prepared script for data importing and preparation." TO "CHK_IM001_Custom" AT 36 84 Checked) (TEXT TITLE "Main script name:" AT 42 112 RIGHT ) (DROPDOWN TITLE "CA001_Imp_All_Main;CA002_Imp_AP_VM_Main;CA003_Imp_PR_EM_Main" TO "TXT_IM001_Custom" AT 180 108 WIDTH 212 DEFAULT 1 )

IF DRP_Source="from Files" DO IM001_Import

IF DRP_Source="ADP"   DO IM002_ADP
IF DRP_Source="Great Plains"  DO IM003_GPlains
IF DRP_Source="SAP"   DO IM004_SAP
IF DRP_Source="JD Edwards"  DO IM005_JDE
IF DRP_Source="Peoplesoft"  DO IM006_PeopleSoft
IF DRP_Source="Oracle"   DO IM007_Oracle
 

%v_CCMJob% PAUSE "Source data have been imported into ACL successfully."

SET SAFETY ON
^BATCH    IM001_Import                       
[PARENT_FOLDER_ID] 1430796694
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Load Source Data from csv files
COMM *** CREATED BY NANCY LI ON 20/07/2012 Satorigroup 0431 057 135
COMM***************************************************************************


IF FTYPE("_Version")="U" OR FTYPE("fld_Sources")="U" DO AA002_Variable_Setting
SET SAFETY OFF
SET FOLDER /%fld_Sources%

%v_CCMJob% IF CHK_IM001_Custom=F PAUSE "Please use ACL Data Import function(Data - External Data) to load your source data into this ACL project."

COMM *** Set up the Custom Importing script and prepare the data ***
IF CHK_IM001_Custom=T AND NOT ISBLANK(TXT_IM001_Custom) DO %TXT_IM001_Custom%

IF CHK_IM001_Custom=T AND ISBLANK(TXT_IM001_Custom) DO CA001_Main

SET SAFETY ON
^BATCH    IM002_ADP                          
[PARENT_FOLDER_ID] 1430796694
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Load Source Data: ADP 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("_Version")="U" OR FTYPE("fld_Sources")="U" DO AA002_Variable_Setting

SET FOLDER /%fld_Sources%
IF FTYPE("v_EMP_Folder")='U' v_EMP_Folder="ADP\"

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version%" WIDTH 633 HEIGHT 156 ) (BUTTONSET TITLE "&OK;&Cancel" AT 528 36 DEFAULT 1 ) (TEXT TITLE "ADP TXT Folder" AT 36 52 ) (EDIT TO "v_EMP_Folder" AT 156 48 WIDTH 351 DEFAULT "C:\ACL_Data\ADP\" )

COMM *** Employee Master File Tables ***
Range_IMPORT DELIMITED TO EMPLOYEE_DAT "%fld_Sources%EMPLOYEE_DAT.fil" FROM "%v_EMP_Folder%EMPLOYEE_DAT.txt" 0 SEPARATOR ";" QUALIFIER '"' CONSECUTIVE STARTLINE 1 KEEPTITLE FIELD "EMP_COMPANY_EMP_CODE" C AT 1 DEC 0 WID 20 PIC "" AS "" FIELD "GENERAL_DESC" C AT 21 DEC 0 WID 126 PIC "" AS "" FIELD "CURR_PAY_KEY" C AT 147 DEC 0 WID 12 PIC "" AS "" FIELD "RATE_ID" C AT 159 DEC 0 WID 7 PIC "" AS "" FIELD "PAY_RATE" N AT 166 DEC 4 WID 11 PIC "" AS "" FIELD "AVGDET_PE_DATE" C AT 177 DEC 0 WID 14 PIC "" AS "" FIELD "AVGDET_HOURS" C AT 191 DEC 0 WID 12 PIC "" AS "" FIELD "AVGDET_AMOUNT" C AT 203 DEC 0 WID 13 PIC "" AS "" FIELD "AVGDET_HOURS_NR" C AT 216 DEC 0 WID 15 PIC "" AS "" FIELD "AVGDET_AMOUNT_NR" C AT 231 DEC 0 WID 16 PIC "" AS "" FIELD "AVGDET_GROSS" C AT 247 DEC 0 WID 12 PIC "" AS "" FIELD "AVGDET_HOURS_DY" C AT 259 DEC 0 WID 15 PIC "" AS "" FIELD "AVGDET_AMOUNT_DY" C AT 274 DEC 0 WID 16 PIC "" AS "" FIELD "AVG_LWOP_FROM" C AT 290 DEC 0 WID 13 PIC "" AS "" FIELD "AVG_LWOP_TO" C AT 303 DEC 0 WID 11 PIC "" AS "" FIELD "AVG_LWOP_HOURS" C AT 314 DEC 0 WID 14 PIC "" AS "" FIELD "AVG_LWOP_AMOUNT" C AT 328 DEC 0 WID 15 PIC "" AS "" FIELD "AVG_LWOP_PE" C AT 343 DEC 0 WID 11 PIC "" AS "" FIELD "AVG_MWOP_FROM" C AT 354 DEC 0 WID 13 PIC "" AS "" FIELD "AVG_MWOP_TO" C AT 367 DEC 0 WID 11 PIC "" AS "" FIELD "AVG_MWOP_HOURS" C AT 378 DEC 0 WID 14 PIC "" AS "" FIELD "AVG_MWOP_AMOUNT" C AT 392 DEC 0 WID 15 PIC "" AS "" FIELD "AVG_MWOP_PE" C AT 407 DEC 0 WID 11 PIC "" AS "" FIELD "ORD_CODE" C AT 418 DEC 0 WID 10 PIC "" AS "" FIELD "ORD_HOURS" C AT 428 DEC 0 WID 10 PIC "" AS "" FIELD "ORD_RATE" C AT 438 DEC 0 WID 10 PIC "" AS "" FIELD "ORD_VALUE" C AT 448 DEC 0 WID 10 PIC "" AS "" FIELD "KIWISAVER_HOLIDAY_FROM" C AT 458 DEC 0 WID 22 PIC "" AS "" FIELD "KIWISAVER_HOLIDAY_TO" C AT 480 DEC 0 WID 20 PIC "" AS "" FIELD "KIWISAVER_HOLIDAY_DESC" C AT 500 DEC 0 WID 22 PIC "" AS "" FIELD "SUPER_DED_CODE" C AT 522 DEC 0 WID 14 PIC "" AS "" FIELD "SUPER_BENEFICIARY_RELSHP" C AT 536 DEC 0 WID 24 PIC "" AS "" FIELD "SUPER_BENEFICIARY_SURNAME" C AT 560 DEC 0 WID 25 PIC "" AS "" FIELD "SUPER_EFFECTIVE_DATE" C AT 585 DEC 0 WID 20 PIC "" AS "" FIELD "SUPER_JOINED_1ST_E" C AT 605 DEC 0 WID 18 PIC "" AS "" FIELD "SUPER_REASON_NOTWORK" C AT 623 DEC 0 WID 20 PIC "" AS "" FIELD "SUPER_DATE_JOINED" C AT 643 DEC 0 WID 17 PIC "" AS "" FIELD "SUPER_BENEFIT_CLASS" C AT 660 DEC 0 WID 19 PIC "" AS "" FIELD "SUPER_BENEFIT_CLASS_DATE" C AT 679 DEC 0 WID 24 PIC "" AS "" FIELD "SUPER_SERVICE_FRACTION" C AT 703 DEC 0 WID 22 PIC "" AS "" FIELD "SUPER_SALARY" C AT 725 DEC 0 WID 12 PIC "" AS "" FIELD "SUPER_SALARY_EFFECTIVE" C AT 737 DEC 0 WID 22 PIC "" AS "" FIELD "SUPER_INSUR_UNITS" C AT 759 DEC 0 WID 17 PIC "" AS "" FIELD "SUPER_ATWORK_JOINED" C AT 776 DEC 0 WID 19 PIC "" AS "" FIELD "SIG_DATE" D AT 795 DEC 0 WID 11 PIC "DD MMM YYYY" AS "" FIELD "SIG_REASON" C AT 806 DEC 0 WID 10 PIC "" AS "" FIELD "SIG_REASON_DESC" C AT 816 DEC 0 WID 24 PIC "" AS "" FIELD "ADD_CODE" C AT 840 DEC 0 WID 8 PIC "" AS "" FIELD "ADD_KIWISAVER_FUND" C AT 848 DEC 0 WID 18 PIC "" AS "" FIELD "ADD_AMOUNT" N AT 866 DEC 2 WID 10 PIC "" AS "" FIELD "ADD_REFERENCE" C AT 876 DEC 0 WID 35 PIC "" AS "" FIELD "ADD_SUPER_SPIN_CODE" C AT 911 DEC 0 WID 19 PIC "" AS "" FIELD "DED_CODE" C AT 930 DEC 0 WID 8 PIC "" AS "" FIELD "DED_KIWISAVER_FUND" C AT 938 DEC 0 WID 18 PIC "" AS "" FIELD "DED_AMOUNT" C AT 956 DEC 0 WID 10 PIC "" AS "" FIELD "DED_AMT_BORROWED" C AT 966 DEC 0 WID 16 PIC "" AS "" FIELD "DED_AMT_BALANCE" C AT 982 DEC 0 WID 15 PIC "" AS "" FIELD "DED_REFERENCE" C AT 997 DEC 0 WID 35 PIC "" AS "" FIELD "DED_SUPER_SPIN_CODE" C AT 1032 DEC 0 WID 19 PIC "" AS "" FIELD "AUTOPAY_ELEMENTS" C AT 1051 DEC 0 WID 16 PIC "" AS "" FIELD "AUTOPAY_HOURS_DAYS" N AT 1067 DEC 4 WID 18 PIC "" AS "" FIELD "ARREARS_DED_CODE" C AT 1085 DEC 0 WID 16 PIC "" AS "" FIELD "ARREARS_DED_AMOUNT" C AT 1101 DEC 0 WID 18 PIC "" AS "" FIELD "PAY_METHOD" C AT 1119 DEC 0 WID 10 PIC "" AS "" FIELD "AUS_BD_ADD_REFERENCE" C AT 1129 DEC 0 WID 20 PIC "" AS "" FIELD "NZ_BD_ADD_CODE" C AT 1149 DEC 0 WID 14 PIC "" AS "" FIELD "NZ_BD_ADD_NAME" C AT 1163 DEC 0 WID 14 PIC "" AS "" FIELD "NZ_BD_ADD_PARTICULARS" C AT 1177 DEC 0 WID 21 PIC "" AS "" FIELD "NZ_BD_ADD_REFERENCE" C AT 1198 DEC 0 WID 19 PIC "" AS "" FIELD "PAY_METHOD_IND" C AT 1217 DEC 0 WID 14 PIC "" AS "" FIELD "PAY_METHOD_AMT" C AT 1231 DEC 0 WID 14 PIC "" AS "" FIELD "PAY_METHOD_DED" C AT 1245 DEC 0 WID 14 PIC "" AS "" FIELD "PAY_METHOD_INSTIT" C AT 1259 DEC 0 WID 17 PIC "" AS "" FIELD "BSB_CODE" C AT 1276 DEC 0 WID 8 PIC "" AS "" FIELD "BSB_NAME" C AT 1284 DEC 0 WID 39 PIC "" AS "" FIELD "BANK_ACCOUNT_NUM" C AT 1323 DEC 0 WID 16 PIC "" AS "" FIELD "BANK_ACCOUNT_NAME" C AT 1339 DEC 0 WID 44 PIC "" AS "" FIELD "AWARD_ALLOW_CODE" C AT 1383 DEC 0 WID 16 PIC "" AS "" FIELD "AWARD_ALLOW_AMOUNT" C AT 1399 DEC 0 WID 18 PIC "" AS "" FIELD "AWARD_DED_CODE" C AT 1417 DEC 0 WID 14 PIC "" AS "" FIELD "AWARD_DED_AMOUNT" C AT 1431 DEC 0 WID 16 PIC "" AS "" FIELD "AVG_EFFECTIVE" D AT 1447 DEC 0 WID 13 PIC "DD MMM YYYY" AS "" FIELD "AVERAGE_RATE" C AT 1460 DEC 0 WID 12 PIC "" AS "" FIELD "AVERAGE_DESC" C AT 1472 DEC 0 WID 12 PIC "" AS "" FIELD "AVG_4WEEK_RATE" C AT 1484 DEC 0 WID 14 PIC "" AS "" FIELD "ORD_WEEKLY_RATE" C AT 1498 DEC 0 WID 15 PIC "" AS "" FIELD "ORD_OPTION" C AT 1513 DEC 0 WID 10 PIC "" AS "" FIELD "AVG_TRANS_RATE" N AT 1523 DEC 4 WID 14 PIC "" AS "" FIELD "EE_ANNUAL" C AT 1537 DEC 0 WID 10 PIC "" AS "" FIELD "AVG_DAILY_RATE" C AT 1547 DEC 0 WID 14 PIC "" AS "" FIELD "HECS" C AT 1561 DEC 0 WID 4 PIC "" AS "" FIELD "GROUP_CERT_PRINT" C AT 1565 DEC 0 WID 16 PIC "" AS "" FIELD "TAX_EXEMPT" C AT 1581 DEC 0 WID 10 PIC "" AS "" FIELD "TAX_SCALE" C AT 1591 DEC 0 WID 9 PIC "" AS "" FIELD "TAX_FILE_NUM" C AT 1600 DEC 0 WID 12 PIC "" AS "" FIELD "DEPENDENT_REBATE" C AT 1612 DEC 0 WID 16 PIC "" AS "" FIELD "ZONE_REBATE" C AT 1628 DEC 0 WID 11 PIC "" AS "" FIELD "DEPEND_SPOUSE" C AT 1639 DEC 0 WID 13 PIC "" AS "" FIELD "NO_DEPEND_CHILDREN" C AT 1652 DEC 0 WID 18 PIC "" AS "" FIELD "PAY_POINT" C AT 1670 DEC 0 WID 9 PIC "" AS "" FIELD "PAY_TYPE" C AT 1679 DEC 0 WID 8 PIC "" AS "" FIELD "PAY_CLASS_CODE" C AT 1687 DEC 0 WID 14 PIC "" AS "" FIELD "ELEMENT_NUM" C AT 1701 DEC 0 WID 11 PIC "" AS "" FIELD "YEARLY_SALARY" N AT 1712 DEC 0 WID 13 PIC "" AS "" FIELD "PAY_LIMIT" C AT 1725 DEC 0 WID 10 PIC "" AS "" FIELD "PPS_TAX" C AT 1735 DEC 0 WID 7 PIC "" AS "" FIELD "LEVY_ADJ_IND" C AT 1742 DEC 0 WID 12 PIC "" AS "" FIELD "GROUP_CERT_DATE" C AT 1754 DEC 0 WID 15 PIC "" AS "" FIELD "ITEM_SELECTION" C AT 1769 DEC 0 WID 14 PIC "" AS "" FIELD "PAY_MESSAGE" C AT 1783 DEC 0 WID 11 PIC "" AS "" FIELD "SUSPEND_TO_DATE" C AT 1794 DEC 0 WID 15 PIC "" AS "" FIELD "PPS_TAX_RATE" C AT 1809 DEC 0 WID 12 PIC "" AS "" FIELD "EFT_INDICATOR" C AT 1821 DEC 0 WID 13 PIC "" AS "" FIELD "EFT_S_INDICATOR" C AT 1834 DEC 0 WID 15 PIC "" AS "" FIELD "EFT_C_INDICATOR" C AT 1849 DEC 0 WID 15 PIC "" AS "" FIELD "DECLARATION" C AT 1864 DEC 0 WID 11 PIC "" AS "" FIELD "RATES_EFFECT_DATE" D AT 1875 DEC 0 WID 17 PIC "DD MMM YYYY" AS "" FIELD "AWARD_CODE" C AT 1892 DEC 0 WID 10 PIC "" AS "" FIELD "AWARD_SUB_LEVEL" C AT 1902 DEC 0 WID 15 PIC "" AS "" FIELD "AWARD_DIARY_CODE" C AT 1917 DEC 0 WID 16 PIC "" AS "" FIELD "AWARD_DIARY_STEP" C AT 1933 DEC 0 WID 16 PIC "" AS "" FIELD "AWARD_RATE_ID" C AT 1949 DEC 0 WID 13 PIC "" AS "" FIELD "AWARD_RATE_AMOUNT" C AT 1962 DEC 0 WID 17 PIC "" AS "" FIELD "ADDS_EFFECT_DATE" D AT 1979 DEC 0 WID 16 PIC "DD MMM YYYY" AS "" FIELD "DEDS_EFFECT_DATE" D AT 1995 DEC 0 WID 16 PIC "DD MMM YYYY" AS "" FIELD "RATES_CHANGE_DATE" D AT 2011 DEC 0 WID 17 PIC "DD MMM YYYY" AS "" FIELD "ALL_CHANGE_DATE" D AT 2028 DEC 0 WID 15 PIC "DD MMM YYYY" AS "" FIELD "DED_CHANGE_DATE" D AT 2043 DEC 0 WID 15 PIC "DD MMM YYYY" AS "" FIELD "TERM_C_GC_PRINT" C AT 2058 DEC 0 WID 15 PIC "" AS "" FIELD "EMP_CLASS_CODE" C AT 2073 DEC 0 WID 14 PIC "" AS "" FIELD "PAY_ADVICE_CLASS" C AT 2087 DEC 0 WID 16 PIC "" AS "" FIELD "PAYSLIP_TYPE" C AT 2103 DEC 0 WID 12 PIC "" AS "" FIELD "PAYROLL_TAX_STATE" C AT 2115 DEC 0 WID 17 PIC "" AS "" FIELD "TFN_TO_SUPER" C AT 2132 DEC 0 WID 12 PIC "" AS "" FIELD "EMP_DEC_SIGN_DATE" D AT 2144 DEC 0 WID 17 PIC "DD MMM YYYY" AS "" FIELD "FTA_CLAIMED" C AT 2161 DEC 0 WID 11 PIC "" AS "" FIELD "SAVINGS_REBATE_CLAIMED" C AT 2172 DEC 0 WID 22 PIC "" AS "" FIELD "NZ_IR_NUMBER" C AT 2194 DEC 0 WID 12 PIC "" AS "" FIELD "NZ_TAX_CODE" C AT 2206 DEC 0 WID 11 PIC "" AS "" FIELD "NZ_EE_LOW_RATE" C AT 2217 DEC 0 WID 14 PIC "" AS "" FIELD "NZ_PAYE_RATE" C AT 2231 DEC 0 WID 12 PIC "" AS "" FIELD "NOTIONAL_SAL" C AT 2243 DEC 0 WID 12 PIC "" AS "" FIELD "PROTECTED_EARNINGS" C AT 2255 DEC 0 WID 18 PIC "" AS "" FIELD "ABN_NUMBER" C AT 2273 DEC 0 WID 10 PIC "" AS "" FIELD "GST_REGISTERED" C AT 2283 DEC 0 WID 14 PIC "" AS "" FIELD "PAYEE_SIGNED" C AT 2297 DEC 0 WID 12 PIC "" AS "" FIELD "SFSS" C AT 2309 DEC 0 WID 4 PIC "" AS "" FIELD "APPRENTICE_WAGES" C AT 2313 DEC 0 WID 16 PIC "" AS "" FIELD "SUPPRESS_TFNDEC" C AT 2329 DEC 0 WID 15 PIC "" AS "" FIELD "SPECTRUM_ID" C AT 2344 DEC 0 WID 11 PIC "" AS "" FIELD "SUPER_REBATE" C AT 2355 DEC 0 WID 12 PIC "" AS "" FIELD "CLASSNOTE1" C AT 2367 DEC 0 WID 119 PIC "" AS "" FIELD "CLASSNOTE2" C AT 2486 DEC 0 WID 27 PIC "" AS "" FIELD "CLASSNOTE3" C AT 2513 DEC 0 WID 14 PIC "" AS "" FIELD "CLASSNOTE4" C AT 2527 DEC 0 WID 10 PIC "" AS "" FIELD "CLASSNOTE5" C AT 2537 DEC 0 WID 10 PIC "" AS "" FIELD "CLASSNOTE6" C AT 2547 DEC 0 WID 10 PIC "" AS "" FIELD "CLASSNOTE7" C AT 2557 DEC 0 WID 10 PIC "" AS "" FIELD "CLASSNOTE8" C AT 2567 DEC 0 WID 10 PIC "" AS "" FIELD "CLASSNOTE9" C AT 2577 DEC 0 WID 10 PIC "" AS "" FIELD "CLASSNOTE10" C AT 2587 DEC 0 WID 11 PIC "" AS "" FIELD "CLASSNOTE11" C AT 2598 DEC 0 WID 11 PIC "" AS "" FIELD "CLASSNOTE12" C AT 2609 DEC 0 WID 14 PIC "" AS "" FIELD "CLASSNOTE13" C AT 2623 DEC 0 WID 20 PIC "" AS "" FIELD "CLASSNOTE14" C AT 2643 DEC 0 WID 16 PIC "" AS "" FIELD "CLASSNOTE15" C AT 2659 DEC 0 WID 17 PIC "" AS "" FIELD "PAYSLIP_EXTRACT_OPTIONS" C AT 2676 DEC 0 WID 23 PIC "" AS "" FIELD "PAYSLIP_EXTRACT_TYPE" C AT 2699 DEC 0 WID 20 PIC "" AS "" FIELD "EMP_STANDARD_HOURS" N AT 2719 DEC 4 WID 18 PIC "" AS "" FIELD "RECORDING_DATE" C AT 2737 DEC 0 WID 14 PIC "" AS "" FIELD "AVG_RATE_CODE" C AT 2751 DEC 0 WID 13 PIC "" AS "" FIELD "AVG_START_DATE" C AT 2764 DEC 0 WID 14 PIC "" AS "" FIELD "AVG_INIT_RATE" C AT 2778 DEC 0 WID 13 PIC "" AS "" FIELD "NZ_GROSS_PERCENTAGE" C AT 2791 DEC 0 WID 19 PIC "" AS "" FIELD "ORD_MAN_FLAG" C AT 2810 DEC 0 WID 12 PIC "" AS "" FIELD "SPIN_CHOICE" C AT 2822 DEC 0 WID 11 PIC "" AS "" FIELD "SPIN_CHOICE_DATE" C AT 2833 DEC 0 WID 16 PIC "" AS "" FIELD "SPIN_ACTION_DATE" C AT 2849 DEC 0 WID 16 PIC "" AS "" FIELD "NZ_PROTECTED_NET" C AT 2865 DEC 0 WID 16 PIC "" AS "" FIELD "KIWISAVER_INFO" C AT 2881 DEC 0 WID 14 PIC "" AS "" FIELD "KIWISAVER_INFO_DATE" C AT 2895 DEC 0 WID 19 PIC "" AS "" FIELD "KIWISAVER_OPT_IN" C AT 2914 DEC 0 WID 16 PIC "" AS "" FIELD "KIWISAVER_OPT_OUT" C AT 2930 DEC 0 WID 17 PIC "" AS "" FIELD "KIWISAVER_EXISTING_MEMBER" C AT 2947 DEC 0 WID 25 PIC "" AS "" FIELD "KIWISAVER_OPT_OUT_BSB" C AT 2972 DEC 0 WID 21 PIC "" AS "" FIELD "KIWISAVER_OPT_OUT_ACCOUNT" C AT 2993 DEC 0 WID 25 PIC "" AS "" FIELD "KIWISAVER_OPT_OUT_ACC_NAME" C AT 3018 DEC 0 WID 26 PIC "" AS "" FIELD "KIWISAVER_OPT_OUT_SIGNED" C AT 3044 DEC 0 WID 24 PIC "" AS "" FIELD "SSCWT_RATE" C AT 3068 DEC 0 WID 10 PIC "" AS "" FIELD "ETP_TRANSITIONAL" C AT 3078 DEC 0 WID 16 PIC "" AS "" FIELD "SL_RATE" C AT 3094 DEC 0 WID 10 PIC "" AS "" FIELD "FTB_REBATE" C AT 3104 DEC 0 WID 10 PIC "" AS "" FIELD "NZ_EE_HIGHER_RATE" C AT 3114 DEC 0 WID 17 PIC "" AS "" FIELD "REBATE_CLAIMED" C AT 3131 DEC 0 WID 14 PIC "" AS "" FIELD "PAYSLIP_OPTIONS" C AT 3145 DEC 0 WID 15 PIC "" AS "" FIELD "WEB_ATO" C AT 3160 DEC 0 WID 7 PIC "" AS "" FIELD "AUS_FLOOD_LEVY" C AT 3167 DEC 0 WID 14 PIC "" AS "" FIELD "ESCT_RATE_DB" C AT 3181 DEC 0 WID 12 PIC "" AS "" FIELD "BILLING_FREQ_DESC" C AT 3193 DEC 0 WID 17 PIC "" AS "" FIELD "PAY_PERIOD_DESC" C AT 3210 DEC 0 WID 15 PIC "" AS "" FIELD "TERM_REASON_DESC" C AT 3225 DEC 0 WID 30 PIC "" AS "" FIELD "EMP_CLASS_DESC" C AT 3255 DEC 0 WID 30 PIC "" AS "" 
IMPORT DELIMITED TO EMPLOYEE_DAT_BANK_ACC "%fld_Sources%EMPLOYEE_DAT_BANK_ACC.fil" FROM "%v_EMP_Folder%EMPLOYEE_DAT_Append.txt" 0 SEPARATOR ";" QUALIFIER '"' CONSECUTIVE STARTLINE 1 KEEPTITLE FIELD "EMP_COMPANY_EMP_CODE" C AT 1 DEC 0 WID 20 PIC "" AS "" FIELD "PAY_METHOD" C AT 21 DEC 0 WID 10 PIC "" AS "" FIELD "AUS_BD_ADD_REFERENCE" C AT 31 DEC 0 WID 20 PIC "" AS "" FIELD "NZ_BD_ADD_CODE" C AT 51 DEC 0 WID 14 PIC "" AS "" FIELD "NZ_BD_ADD_NAME" C AT 65 DEC 0 WID 14 PIC "" AS "" FIELD "NZ_BD_ADD_PARTICULARS" C AT 79 DEC 0 WID 21 PIC "" AS "" FIELD "NZ_BD_ADD_REFERENCE" C AT 100 DEC 0 WID 19 PIC "" AS "" FIELD "PAY_METHOD_IND" C AT 119 DEC 0 WID 14 PIC "" AS "" FIELD "PAY_METHOD_AMT" C AT 133 DEC 0 WID 14 PIC "" AS "" FIELD "PAY_METHOD_DED" C AT 147 DEC 0 WID 14 PIC "" AS "" FIELD "PAY_METHOD_INSTIT" C AT 161 DEC 0 WID 17 PIC "" AS "" FIELD "BSB_CODE" C AT 178 DEC 0 WID 8 PIC "" AS "" FIELD "BSB_NAME" C AT 186 DEC 0 WID 39 PIC "" AS "" FIELD "BANK_ACCOUNT_NUM" C AT 225 DEC 0 WID 16 PIC "" AS "" FIELD "BANK_ACCOUNT_NAME" C AT 241 DEC 0 WID 44 PIC "" AS "" 

IMPORT DELIMITED TO EMP_COST_DAT "%fld_Sources%EMP_COST_DAT.fil" FROM "%v_EMP_Folder%EMP_COST_DAT.txt" 0 SEPARATOR ";" QUALIFIER '"' CONSECUTIVE STARTLINE 1 KEEPTITLE FIELD "EMP_COMPANY_EMP_CODE" C AT 1 DEC 0 WID 20 PIC "" AS "" FIELD "COST_CENTRE" C AT 21 DEC 0 WID 19 PIC "" AS "" FIELD "COST_ALLOC" N AT 40 DEC 2 WID 10 PIC "" AS "" FIELD "EFFECTIVE" D AT 50 DEC 0 WID 11 PIC "DD MMM YYYY" AS "" FIELD "PREVIOUS" D AT 61 DEC 0 WID 11 PIC "DD MMM YYYY" AS "" FIELD "NEXT" D AT 72 DEC 0 WID 10 PIC "DD MMM YYYY" AS "" 
IMPORT DELIMITED TO EMP_COST_DAT_COST_ALLOC "%fld_Sources%EMP_COST_DAT_COST_ALLOC.fil" FROM "%v_EMP_Folder%EMP_COST_DAT_Append.txt" 0 SEPARATOR ";" QUALIFIER '"' CONSECUTIVE STARTLINE 1 KEEPTITLE FIELD "EMP_COMPANY_EMP_CODE" C AT 1 DEC 0 WID 20 PIC "" AS "" FIELD "COST_CENTRE" C AT 21 DEC 0 WID 19 PIC "" AS "" FIELD "COST_ALLOC" N AT 40 DEC 2 WID 10 PIC "" AS "" 

COMM *** Payroll  ***
IMPORT DELIMITED TO GL_POSTING_EMP_AUD_DAT "%fld_Sources%GL_POSTING_EMP_AUD_DAT.fil" FROM "%v_EMP_Folder%GL_POSTING_EMP_AUD_DAT.txt" 0 SEPARATOR ";" QUALIFIER '"' CONSECUTIVE STARTLINE 1 KEEPTITLE FIELD "EMP_COMPANY_EMP_CODE" C AT 1 DEC 0 WID 58 PIC "" AS "" FIELD "PAYCODE" C AT 59 DEC 0 WID 7 PIC "" AS "" FIELD "PAYCODE_HOURS" N AT 66 DEC 4 WID 13 PIC "" AS "" FIELD "PAYCODE_AMOUNTS" N AT 79 DEC 2 WID 15 PIC "" AS "" FIELD "PAYCODE_H" N AT 94 DEC 0 WID 9 PIC "" AS "" FIELD "NA_CR_AMOUNT" N AT 103 DEC 2 WID 12 PIC "" AS "" FIELD "NA_CR_HOURS" N AT 115 DEC 4 WID 11 PIC "" AS "" FIELD "NA_DB_AMOUNT" N AT 126 DEC 2 WID 12 PIC "" AS "" FIELD "NA_DB_HOURS" N AT 138 DEC 4 WID 11 PIC "" AS "" FIELD "AD_CR_AMOUNT" N AT 149 DEC 2 WID 12 PIC "" AS "" FIELD "AD_CR_HOURS" N AT 161 DEC 4 WID 11 PIC "" AS "" FIELD "AD_DB_AMOUNT" N AT 172 DEC 2 WID 12 PIC "" AS "" FIELD "AD_DB_HOURS" N AT 184 DEC 4 WID 11 PIC "" AS "" FIELD "ACC_CR_AMOUNT" N AT 195 DEC 2 WID 13 PIC "" AS "" FIELD "ACC_CR_HOURS" N AT 208 DEC 4 WID 12 PIC "" AS "" FIELD "ACC_DB_AMOUNT" N AT 220 DEC 2 WID 13 PIC "" AS "" FIELD "ACC_DB_HOURS" N AT 233 DEC 4 WID 12 PIC "" AS "" FIELD "ACC_PERCENT" N AT 245 DEC 4 WID 11 PIC "" AS "" FIELD "LINE_DESC" C AT 256 DEC 0 WID 31 PIC "" AS "" FIELD "PAY_GROUP" C AT 287 DEC 0 WID 9 PIC "" AS "" FIELD "PR_TAX_STATE" C AT 296 DEC 0 WID 12 PIC "" AS "" FIELD "CALC_LEVEL1" C AT 308 DEC 0 WID 39 PIC "" AS "" FIELD "CALC_LEVEL2" C AT 347 DEC 0 WID 136 PIC "" AS "" FIELD "Prd_Dt" D AT 483 DEC 0 WID 11 PIC "DD MMM YYYY" AS "" FIELD "RV_CR_AMOUNT" N AT 494 DEC 2 WID 12 PIC "" AS "" FIELD "RV_CR_HOURS" N AT 506 DEC 4 WID 11 PIC "" AS "" FIELD "RV_DB_AMOUNT" N AT 517 DEC 2 WID 12 PIC "" AS "" FIELD "RV_DB_HOURS" N AT 529 DEC 4 WID 11 PIC "" AS "" 
IMPORT DELIMITED TO GL_POSTING_EMP_AUD_DAT_PayCode "%fld_Sources%GL_POSTING_EMP_AUD_DAT_PayCode.fil" FROM "%v_EMP_Folder%GL_POSTING_EMP_AUD_DAT_Append.txt" 0 SEPARATOR ";" QUALIFIER '"' CONSECUTIVE STARTLINE 1 KEEPTITLE FIELD "EMP_COMPANY_EMP_CODE" C AT 1 DEC 0 WID 58 PIC "" AS "" FIELD "PAYCODE" C AT 59 DEC 0 WID 7 PIC "" AS "" FIELD "PAYCODE_HOURS" N AT 66 DEC 4 WID 13 PIC "" AS "" FIELD "PAYCODE_AMOUNTS" N AT 79 DEC 2 WID 15 PIC "" AS "" FIELD "PAYCODE_H" N AT 94 DEC 4 WID 9 PIC "" AS "" 
^BATCH    IM003_GPlains                      
[PARENT_FOLDER_ID] 1430796694
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Load Source Data: Great Plains
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("_Version")="U" OR FTYPE("fld_Sources")="U" DO AA002_Variable_Setting

SET FOLDER /%fld_Sources%

IF FTYPE('TXT_IM003_ODBC') = 'U' TXT_IM003_ODBC="EVA_GPlains"
IF FTYPE('TXT_IM003_Dt') = 'U' TXT_IM003_ODBC="GPSQL2"
IF FTYPE('TXT_IM003_UserID') = 'U' TXT_IM003_ODBC="satorigroup"

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Enter Import SAP Details"  WIDTH 501 HEIGHT 219 ) (BUTTONSET TITLE "&OK;&Cancel" AT 396 120 DEFAULT 1 ) (EDIT TO "TXT_IM003_ODBC" AT 156 96 WIDTH 174 DEFAULT "EVA_GPlains" ) (TEXT TITLE "ODBC Name" AT 12 100 ) (EDIT TO "TXT_IM003_Dt" AT 156 48 WIDTH 168 DEFAULT "%_LastYearTranDt%" ) (TEXT TITLE "Extract Transactions From " AT 12 52 WIDTH 126 ) (TEXT TITLE "ODBC User ID" AT 12 148 ) (EDIT TO "TXT_IM003_UserID" AT 156 144 WIDTH 169 DEFAULT "satorigroup" )


COMM *** Vendor Master File Tables***
IMPORT ODBC SOURCE "%TXT_IM003_ODBC%" TABLE "PM00200" OWNER "dbo" USERID "%TXT_IM003_UserID%" TO "%v_Source_Folder%PM00200.FIL" WIDTH 50 MAXIMUM 100 FIELDS "VENDORID","VENDNAME","VNDCHKNM","VENDSHNM","VADDCDPR","VADCDPAD","VADCDSFR","VADCDTRO","VNDCLSID","VNDCNTCT","ADDRESS1","ADDRESS2","ADDRESS3","CITY","STATE","ZIPCODE","COUNTRY","PHNUMBR1","PHNUMBR2","PHONE3","FAXNUMBR","UPSZONE","SHIPMTHD","TAXSCHID","ACNMVNDR","TXIDNMBR","VENDSTTS","CURNCYID","TXRGNNUM","PARVENID","TRDDISCT","TEN99TYPE","TEN99BOXNUMBER","MINORDER","PYMTRMID","MINPYTYP","MINPYPCT","MINPYDLR","MXIAFVND","MAXINDLR","COMMENT1","COMMENT2","USERDEF1","USERDEF2","CRLMTDLR","PYMNTPRI","KPCALHST","KGLDSTHS","KPERHIST","KPTRXHST","HOLD","PTCSHACF","CREDTLMT","WRITEOFF","MXWOFAMT","SBPPSDED","PPSTAXRT","DXVARNUM","CRTCOMDT","CRTEXPDT","RTOBUTKN","XPDTOBLG","PRSPAYEE","PMAPINDX","PMCSHIDX","PMDAVIDX","PMDTKIDX","PMFINIDX","PMMSCHIX","PMFRTIDX","PMTAXIDX","PMWRTIDX","PMPRCHIX","PMRTNGIX","PMTDSCIX","ACPURIDX","PURPVIDX","NOTEINDX","CHEKBKID","MODIFDT","CREATDDT","RATETPID","Revalue_Vendor","Post_Results_To","FREEONBOARD","GOVCRPID","GOVINDID","DISGRPER","DUEGRPER","DOCFMTID","TaxInvRecvd","USERLANG","WithholdingType","WithholdingFormType","WithholdingEntityType","TaxFileNumMode","BRTHDATE","LaborPmtType","CCode","DECLID","CBVAT","Workflow_Approval_Status","Workflow_Priority","DEX_ROW_TS","DEX_ROW_ID"

COMM *** Accounts Payable Tables***
IMPORT ODBC SOURCE "%TXT_IM003_ODBC%" TABLE "PM20000" OWNER "dbo" USERID "%TXT_IM003_UserID%" WHERE "POSTEDDT>='%TXT_IM003_Dt%'" TO "%fld_Sources%PM20000.FIL" WIDTH 50 MAXIMUM 100 FIELDS "VCHRNMBR","VENDORID","DOCTYPE","DOCDATE","DOCNUMBR","DOCAMNT","CURTRXAM","DISTKNAM","DISCAMNT","DSCDLRAM","BACHNUMB","TRXSORCE","BCHSOURC","DISCDATE","DUEDATE","PORDNMBR","TEN99AMNT","WROFAMNT","DISAMTAV","TRXDSCRN","UN1099AM","BKTPURAM","BKTFRTAM","BKTMSCAM","VOIDED","HOLD","CHEKBKID","DINVPDOF","PPSAMDED","PPSTAXRT","PGRAMSBJ","GSTDSAMT","POSTEDDT","PTDUSRID","MODIFDT","MDFUSRID","PYENTTYP","CARDNAME","PRCHAMNT","TRDISAMT","MSCCHAMT","FRTAMNT","TAXAMNT","TTLPYMTS","CURNCYID","PYMTRMID","SHIPMTHD","TAXSCHID","PCHSCHID","FRTSCHID","MSCSCHID","PSTGDATE","DISAVTKN","CNTRLTYP","NOTEINDX","PRCTDISC","RETNAGAM","ICTRX","Tax_Date","PRCHDATE","CORRCTN","SIMPLIFD","BNKRCAMT","APLYWITH","Electronic","ECTRX","DocPrinted","TaxInvReqd","VNDCHKNM","BackoutTradeDisc","CBVAT","VADCDTRO","TEN99TYPE","TEN99BOXNUMBER","DEX_ROW_TS","DEX_ROW_ID"
IMPORT ODBC SOURCE "%TXT_IM003_ODBC%" TABLE "PM30200" OWNER "dbo" USERID "%TXT_IM003_UserID%" WHERE "POSTEDDT>='%TXT_IM003_Dt%'" TO "%fld_Sources%PM30200.FIL" WIDTH 50 MAXIMUM 100 FIELDS "VCHRNMBR","VENDORID","DOCTYPE","DOCDATE","DOCNUMBR","DOCAMNT","CURTRXAM","DISTKNAM","DISCAMNT","DSCDLRAM","BACHNUMB","TRXSORCE","BCHSOURC","DISCDATE","DUEDATE","PORDNMBR","TEN99AMNT","WROFAMNT","DISAMTAV","TRXDSCRN","UN1099AM","BKTPURAM","BKTFRTAM","BKTMSCAM","VOIDED","HOLD","CHEKBKID","DINVPDOF","PPSAMDED","PPSTAXRT","PGRAMSBJ","GSTDSAMT","POSTEDDT","PTDUSRID","MODIFDT","MDFUSRID","PYENTTYP","CARDNAME","PRCHAMNT","TRDISAMT","MSCCHAMT","FRTAMNT","TAXAMNT","TTLPYMTS","CURNCYID","PYMTRMID","SHIPMTHD","TAXSCHID","PCHSCHID","FRTSCHID","MSCSCHID","PSTGDATE","DISAVTKN","CNTRLTYP","NOTEINDX","PRCTDISC","RETNAGAM","VOIDPDATE","ICTRX","Tax_Date","PRCHDATE","CORRCTN","SIMPLIFD","APLYWITH","Electronic","ECTRX","DocPrinted","TaxInvReqd","VNDCHKNM","BackoutTradeDisc","CBVAT","VADCDTRO","TEN99TYPE","TEN99BOXNUMBER","DEX_ROW_TS","DEX_ROW_ID"
IMPORT ODBC SOURCE "%TXT_IM003_ODBC%" TABLE "BP50101" OWNER "dbo" USERID "%TXT_IM003_UserID%" WHERE "MODIFDT>='%TXT_IM003_Dt%'" TO "%fld_Sources%BP50101.fil" WIDTH 50 MAXIMUM 100 FIELDS "SEQNUMBR","VENDORID","VENDNAME","BP_Audit_Change","BNKACTNM","BNKBRNCH","EFT_Vendor","USERDEF1","USERDEF2","BPOLD_BAN","BPOLD_BSB","BPOLD_EFTCB","BPOLD_UD1","BPOLD_UD2","MDFUSRID","MODIFDT","TIME1","APPROVL","APRVLUSERID","DEX_ROW_ID"
IMPORT ODBC SOURCE "%TXT_IM003_ODBC%" TABLE "PM40102" OWNER "dbo" USERID "%TXT_IM003_UserID%" TO "%fld_Sources%PM40102.FIL" WIDTH 50 MAXIMUM 100 FIELDS "DOCTYPE","DOCABREV","DOCTYNAM","DEX_ROW_ID"
IMPORT ODBC SOURCE "%TXT_IM003_ODBC%" TABLE "BP00101" OWNER "dbo" USERID "%TXT_IM003_UserID%" TO "%fld_Sources%BP00101.fil" WIDTH 50 MAXIMUM 100 FIELDS "VENDORID","VENDNAME","CHEKBKID","BNKACTNM","BNKBRNCH","EFT_Vendor","BANKCHEQ","Book_Transfer_Vendor","PRINTCHK","CONSDPAY","NOTEINDX","XPRTFTYP","APPROVL","USERID","BP_BB_Included","BP_BB_SWIFT","BP_BB_BankName","BP_BB_BankAddress1","BP_BB_BankAddress2","BP_BB_BankAddress3","BP_BB_BankAddress4","BP_BB_Country_Code","BP_BB_Payment_Ref","BP_INT_Included","BP_INT_BankName","BP_INT_BankAddress1","BP_INT_BankAddress2","BP_INT_BankAddress3","BP_INT_BankAddress4","BP_INT_SWIFT","BP_INT_Bank_Account_Numb","BP_INT_Country_Code","BP_BB_Sec_Party_Charges","DEX_ROW_ID"

IMPORT EXCEL TO GrayList "%fld_Sources%GrayList.fil" FROM "%fld_Sources%GrayList.xlsx" TABLE "RentVndr - GRAYLIST$" CHARMAX 50 KEEPTITLE

^BATCH    IM004_SAP                          
[PARENT_FOLDER_ID] 1430796694
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Load Source Data : SAP
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("_Version")="U" OR FTYPE("fld_Sources")="U" DO AA002_Variable_Setting

SET FOLDER /%fld_Sources%

SET DATE "YYYYMMDD"

IF FTYPE('_SAP_SYSTEM') = 'U' _SAP_SYSTEM="EVA_SAP"
IF FTYPE('_SAP_CLIENT') = 'U' _SAP_CLIENT="800"
IF FTYPE('SAP_UserID') = 'U' SAP_UserID=""
IF FTYPE('SAP_Password') = 'U' SAP_Password=""
IF FTYPE('_Data_Range_From') = 'U' _Data_Range_From="20120101"
IF FTYPE('_Data_Range_To') = 'U' _Data_Range_From="20131231"


%v_CCMJob% DIALOG (DIALOG TITLE "SATORI EVA V2.5 Enter Import SAP Details" WIDTH 497 HEIGHT 291 ) (BUTTONSET TITLE "&OK;&Cancel" AT 372 204 DEFAULT 1 ) (TEXT TITLE "Importing SAP Files for Accounts Payable Automation Tests" AT 60 16 WIDTH 319 CENTER ) (TEXT TITLE "Date Range From" AT 12 76 WIDTH 102 RIGHT ) (EDIT TO "_Data_Range_From" AT 132 72 WIDTH 69 DEFAULT "20120101" ) (TEXT TITLE "To" AT 216 76 ) (EDIT TO "_Data_Range_To" AT 252 72 WIDTH 66 DEFAULT "20120630" ) (TEXT TITLE "YYYYMMDD" AT 336 76 ) (TEXT TITLE "SAP User ID" AT 36 208 WIDTH 71 ) (EDIT TO "SAP_UserID" AT 132 204 DEFAULT "ACLDOWNLOAD" ) (TEXT TITLE "Password" AT 36 256 ) (EDIT TO "SAP_Password" AT 132 252 ) (TEXT TITLE "SAP System" AT 36 124 ) (EDIT TO "_SAP_System" AT 132 120 DEFAULT "EVA_SAP" ) (TEXT TITLE "SAP Client" AT 36 160 ) (EDIT TO "_SAP_CLIENT" AT 132 156 WIDTH 116 DEFAULT "800" )

_user_tst = "%SAP_UserID%"

SET ECHO NONE
SET PASSWORD 1 TO "%SAP_Password%"
SET ECHO ON

IMPORT SAP PASSWORD 1 TO BSAK SAP SOURCE "SAP AGENT" <q version="6.0"><s>0</s><d>%_SAP_SYSTEM%</d><u>%SAP_UserID%</u><c>%_SAP_CLIENT%</c><lg>EN</lg><cf>%fld_Sources%BSAK.fil</cf><sf>D:\ACL_DOWNLOAD\DL_ACLDOWNLOAD102243.DAT                                                                                                                                                                                                                       </sf><jcount>10224300</jcount><jname>DL_ACLDOWNLOAD102243.DAT        </jname><dl>1649</dl><m>1</m><r>500</r><ar>1</ar><e>500</e><ts><t><n>BSAK</n><a>T00001</a><td>Accounting: Secondary Index for Vendors (Cleared Items)</td><fs><f>MANDT</f><f>BUKRS</f><f>LIFNR</f><f>UMSKS</f><f>UMSKZ</f><f>AUGDT</f><f>AUGBL</f><f>ZUONR</f><f>GJAHR</f><f>BELNR</f><f>BUZEI</f><f>BUDAT</f><f>BLDAT</f><f>CPUDT</f><f>WAERS</f><f>XBLNR</f><f>BLART</f><f>MONAT</f><f>BSCHL</f><f>ZUMSK</f><f>SHKZG</f><f>GSBER</f><f>MWSKZ</f><f>DMBTR</f><f>WRBTR</f><f>MWSTS</f><f>WMWST</f><f>BDIFF</f><f>BDIF2</f><f>SGTXT</f><f>PROJN</f><f>AUFNR</f><f>ANLN1</f><f>ANLN2</f><f>EBELN</f><f>EBELP</f><f>SAKNR</f><f>HKONT</f><f>FKONT</f><f>FILKD</f><f>ZFBDT</f><f>ZTERM</f><f>ZBD1T</f><f>ZBD2T</f><f>ZBD3T</f><f>ZBD1P</f><f>ZBD2P</f><f>SKFBT</f><f>SKNTO</f><f>WSKTO</f><f>ZLSCH</f><f>ZLSPR</f><f>ZBFIX</f><f>HBKID</f><f>BVTYP</f><f>REBZG</f><f>REBZJ</f><f>REBZZ</f><f>SAMNR</f><f>ZOLLT</f><f>ZOLLD</f><f>LZBKZ</f><f>LANDL</f><f>DIEKZ</f><f>MANSP</f><f>MSCHL</f><f>MADAT</f><f>MANST</f><f>MABER</f><f>XNETB</f><f>XANET</f><f>XCPDD</f><f>XESRD</f><f>XZAHL</f><f>MWSK1</f><f>DMBT1</f><f>WRBT1</f><f>MWSK2</f><f>DMBT2</f><f>WRBT2</f><f>MWSK3</f><f>DMBT3</f><f>WRBT3</f><f>QSSKZ</f><f>QSSHB</f><f>QBSHB</f><f>BSTAT</f><f>ANFBN</f><f>ANFBJ</f><f>ANFBU</f><f>VBUND</f><f>REBZT</f><f>STCEG</f><f>EGBLD</f><f>EGLLD</f><f>QSZNR</f><f>QSFBT</f><f>XINVE</f><f>PROJK</f><f>FIPOS</f><f>NPLNR</f><f>AUFPL</f><f>APLZL</f><f>XEGDR</f><f>DMBE2</f><f>DMBE3</f><f>DMB21</f><f>DMB22</f><f>DMB23</f><f>DMB31</f><f>DMB32</f><f>DMB33</f><f>MWST2</f><f>MWST3</f><f>SKNT2</f><f>SKNT3</f><f>BDIF3</f><f>XRAGL</f><f>RSTGR</f><f>UZAWE</f><f>KOSTL</f><f>LNRAN</f><f>XSTOV</f><f>KZBTR</f><f>XREF1</f><f>XREF2</f><f>XARCH</f><f>PSWSL</f><f>PSWBT</f><f>IMKEY</f><f>ZEKKN</f><f>FISTL</f><f>GEBER</f><f>DABRZ</f><f>XNEGP</f><f>EMPFB</f><f>PRCTR</f><f>XREF3</f><f>DTWS1</f><f>DTWS2</f><f>DTWS3</f><f>DTWS4</f><f>XPYPR</f><f>KIDNO</f><f>PYCUR</f><f>PYAMT</f><f>BUPLA</f><f>SECCO</f><f>PPDIFF</f><f>PPDIF2</f><f>PPDIF3</f><f>PENLC1</f><f>PENLC2</f><f>PENLC3</f><f>PENFC</f><f>PENDAYS</f><f>PENRC</f><f>VERTT</f><f>VERTN</f><f>VBEWA</f><f>KBLNR</f><f>KBLPOS</f><f>GRANT_NBR</f><f>GMVKZ</f><f>SRTYPE</f><f>LOTKZ</f><f>ZINKZ</f><f>FKBER</f><f>INTRENO</f><f>PPRCT</f><f>BUZID</f><f>AUGGJ</f><f>KONTT</f><f>KONTL</f><f>UEBGDAT</f><f>VNAME</f><f>EGRUP</f><f>BTYPE</f></fs><wc><w><f>BLDAT</f><o>6</o><l>%_Data_Range_From%</l><h>%_Data_Range_To%</h></w></wc></t></ts><js></js></q>
IMPORT SAP PASSWORD 1 TO BSIK SAP SOURCE "SAP AGENT" <q version="6.0"><s>0</s><d>%_SAP_SYSTEM%</d><u>%SAP_UserID%</u><c>%_SAP_CLIENT%</c><lg>EN</lg><cf>%fld_Sources%BSIK.fil</cf><sf>D:\ACL_DOWNLOAD\DL_ACLDOWNLOAD101649.DAT                                                                                                                                                                                                                       </sf><jcount>10164900</jcount><jname>DL_ACLDOWNLOAD101649.DAT        </jname><dl>1649</dl><m>1</m><r>0</r><ar>1</ar><e>500</e><ts><t><n>BSIK</n><a>T00001</a><td>Accounting: Secondary Index for Vendors</td><fs><f>MANDT</f><f>BUKRS</f><f>LIFNR</f><f>UMSKS</f><f>UMSKZ</f><f>AUGDT</f><f>AUGBL</f><f>ZUONR</f><f>GJAHR</f><f>BELNR</f><f>BUZEI</f><f>BUDAT</f><f>BLDAT</f><f>CPUDT</f><f>WAERS</f><f>XBLNR</f><f>BLART</f><f>MONAT</f><f>BSCHL</f><f>ZUMSK</f><f>SHKZG</f><f>GSBER</f><f>MWSKZ</f><f>DMBTR</f><f>WRBTR</f><f>MWSTS</f><f>WMWST</f><f>BDIFF</f><f>BDIF2</f><f>SGTXT</f><f>PROJN</f><f>AUFNR</f><f>ANLN1</f><f>ANLN2</f><f>EBELN</f><f>EBELP</f><f>SAKNR</f><f>HKONT</f><f>FKONT</f><f>FILKD</f><f>ZFBDT</f><f>ZTERM</f><f>ZBD1T</f><f>ZBD2T</f><f>ZBD3T</f><f>ZBD1P</f><f>ZBD2P</f><f>SKFBT</f><f>SKNTO</f><f>WSKTO</f><f>ZLSCH</f><f>ZLSPR</f><f>ZBFIX</f><f>HBKID</f><f>BVTYP</f><f>REBZG</f><f>REBZJ</f><f>REBZZ</f><f>SAMNR</f><f>ZOLLT</f><f>ZOLLD</f><f>LZBKZ</f><f>LANDL</f><f>DIEKZ</f><f>MANSP</f><f>MSCHL</f><f>MADAT</f><f>MANST</f><f>MABER</f><f>XNETB</f><f>XANET</f><f>XCPDD</f><f>XESRD</f><f>XZAHL</f><f>MWSK1</f><f>DMBT1</f><f>WRBT1</f><f>MWSK2</f><f>DMBT2</f><f>WRBT2</f><f>MWSK3</f><f>DMBT3</f><f>WRBT3</f><f>QSSKZ</f><f>QSSHB</f><f>QBSHB</f><f>BSTAT</f><f>ANFBN</f><f>ANFBJ</f><f>ANFBU</f><f>VBUND</f><f>REBZT</f><f>STCEG</f><f>EGBLD</f><f>EGLLD</f><f>QSZNR</f><f>QSFBT</f><f>XINVE</f><f>PROJK</f><f>FIPOS</f><f>NPLNR</f><f>AUFPL</f><f>APLZL</f><f>XEGDR</f><f>DMBE2</f><f>DMBE3</f><f>DMB21</f><f>DMB22</f><f>DMB23</f><f>DMB31</f><f>DMB32</f><f>DMB33</f><f>MWST2</f><f>MWST3</f><f>SKNT2</f><f>SKNT3</f><f>BDIF3</f><f>XRAGL</f><f>RSTGR</f><f>UZAWE</f><f>KOSTL</f><f>LNRAN</f><f>XSTOV</f><f>KZBTR</f><f>XREF1</f><f>XREF2</f><f>XARCH</f><f>PSWSL</f><f>PSWBT</f><f>IMKEY</f><f>ZEKKN</f><f>FISTL</f><f>GEBER</f><f>DABRZ</f><f>XNEGP</f><f>EMPFB</f><f>PRCTR</f><f>XREF3</f><f>DTWS1</f><f>DTWS2</f><f>DTWS3</f><f>DTWS4</f><f>XPYPR</f><f>KIDNO</f><f>PYCUR</f><f>PYAMT</f><f>BUPLA</f><f>SECCO</f><f>PPDIFF</f><f>PPDIF2</f><f>PPDIF3</f><f>PENLC1</f><f>PENLC2</f><f>PENLC3</f><f>PENFC</f><f>PENDAYS</f><f>PENRC</f><f>VERTT</f><f>VERTN</f><f>VBEWA</f><f>KBLNR</f><f>KBLPOS</f><f>GRANT_NBR</f><f>GMVKZ</f><f>SRTYPE</f><f>LOTKZ</f><f>ZINKZ</f><f>FKBER</f><f>INTRENO</f><f>PPRCT</f><f>BUZID</f><f>AUGGJ</f><f>KONTT</f><f>KONTL</f><f>UEBGDAT</f><f>VNAME</f><f>EGRUP</f><f>BTYPE</f></fs><wc><w><f>BLDAT</f><o>6</o><l>%_Data_Range_From%</l><h>%_Data_Range_To%</h></w></wc></t></ts><js></js></q>
IMPORT SAP PASSWORD 1 TO BKPF SAP SOURCE "SAP AGENT" <q version="6.0"><s>0</s><d>%_SAP_SYSTEM%</d><u>%SAP_UserID%</u><c>%_SAP_CLIENT%</c><lg>EN</lg><cf>%fld_Sources%BKPF.fil</cf><sf>D:\ACL_DOWNLOAD\DL_ACLDOWNLOAD102949.DAT                                                                                                                                                                                                                       </sf><jcount>10294900</jcount><jname>DL_ACLDOWNLOAD102949.DAT        </jname><dl>719 </dl><m>1</m><r>500</r><ar>1</ar><e>500</e><ts><t><n>BKPF</n><a>T00001</a><td>Accounting Document Header</td><fs><f>MANDT</f><f>BUKRS</f><f>BELNR</f><f>GJAHR</f><f>BLART</f><f>BLDAT</f><f>BUDAT</f><f>MONAT</f><f>CPUDT</f><f>CPUTM</f><f>AEDAT</f><f>UPDDT</f><f>WWERT</f><f>USNAM</f><f>TCODE</f><f>BVORG</f><f>XBLNR</f><f>DBBLG</f><f>STBLG</f><f>STJAH</f><f>BKTXT</f><f>WAERS</f><f>KURSF</f><f>KZWRS</f><f>KZKRS</f><f>BSTAT</f><f>XNETB</f><f>FRATH</f><f>XRUEB</f><f>GLVOR</f><f>GRPID</f><f>DOKID</f><f>ARCID</f><f>IBLAR</f><f>AWTYP</f><f>AWKEY</f><f>FIKRS</f><f>HWAER</f><f>HWAE2</f><f>HWAE3</f><f>KURS2</f><f>KURS3</f><f>BASW2</f><f>BASW3</f><f>UMRD2</f><f>UMRD3</f><f>XSTOV</f><f>STODT</f><f>XMWST</f><f>CURT2</f><f>CURT3</f><f>KUTY2</f><f>KUTY3</f><f>XSNET</f><f>AUSBK</f><f>XUSVR</f><f>DUEFL</f><f>AWSYS</f><f>TXKRS</f><f>LOTKZ</f><f>XWVOF</f><f>STGRD</f><f>PPNAM</f><f>BRNCH</f><f>NUMPG</f><f>ADISC</f><f>XREF1_HD</f><f>XREF2_HD</f><f>XREVERSAL</f><f>REINDAT</f><f>XBLNR_ALT</f><f>VATDATE</f><f>PSOTY</f><f>PSOAK</f><f>PSOKS</f><f>PSOSG</f><f>PSOFN</f><f>INTFORM</f><f>INTDATE</f><f>PSOBT</f><f>PSOZL</f><f>PSODT</f><f>PSOTM</f><f>FM_UMART</f><f>CCINS</f><f>CCNUM</f><f>SSBLK</f><f>BATCH</f><f>SNAME</f><f>SAMPLED</f><f>EXCLUDE_FLAG</f><f>BLIND</f><f>OFFSET_STATUS</f><f>OFFSET_REFER_DAT</f><f>PENRC</f><f>KNUMV</f></fs><wc><w><f>BLDAT</f><o>6</o><l>%_Data_Range_From%</l><h>%_Data_Range_To%</h></w></wc></t></ts><js></js></q>
IMPORT SAP PASSWORD 1 TO EKPO SAP SOURCE "SAP AGENT" <q version="6.0"><s>0</s><d>%_SAP_SYSTEM%</d><u>%SAP_UserID%</u><c>%_SAP_CLIENT%</c><lg>EN</lg><cf>%fld_Sources%EKPO.fil</cf><sf>D:\ACL_DOWNLOAD\DL_ACLDOWNLOAD103728.DAT                                                                                                                                                                                                                       </sf><jcount>10372800</jcount><jname>DL_ACLDOWNLOAD103728.DAT        </jname><dl>1454</dl><m>1</m><r>500</r><ar>1</ar><e>500</e><ts><t><n>EKPO</n><a>T00001</a><td>Purchasing Document Item</td><fs><f>MANDT</f><f>EBELN</f><f>EBELP</f><f>LOEKZ</f><f>STATU</f><f>AEDAT</f><f>TXZ01</f><f>MATNR</f><f>EMATN</f><f>BUKRS</f><f>WERKS</f><f>LGORT</f><f>BEDNR</f><f>MATKL</f><f>INFNR</f><f>IDNLF</f><f>KTMNG</f><f>MENGE</f><f>MEINS</f><f>BPRME</f><f>BPUMZ</f><f>BPUMN</f><f>UMREZ</f><f>UMREN</f><f>NETPR</f><f>PEINH</f><f>NETWR</f><f>BRTWR</f><f>AGDAT</f><f>WEBAZ</f><f>MWSKZ</f><f>BONUS</f><f>INSMK</f><f>SPINF</f><f>PRSDR</f><f>SCHPR</f><f>MAHNZ</f><f>MAHN1</f><f>MAHN2</f><f>MAHN3</f><f>UEBTO</f><f>UEBTK</f><f>UNTTO</f><f>BWTAR</f><f>BWTTY</f><f>ABSKZ</f><f>AGMEM</f><f>ELIKZ</f><f>EREKZ</f><f>PSTYP</f><f>KNTTP</f><f>KZVBR</f><f>VRTKZ</f><f>TWRKZ</f><f>WEPOS</f><f>WEUNB</f><f>REPOS</f><f>WEBRE</f><f>KZABS</f><f>LABNR</f><f>KONNR</f><f>KTPNR</f><f>ABDAT</f><f>ABFTZ</f><f>ETFZ1</f><f>ETFZ2</f><f>KZSTU</f><f>NOTKZ</f><f>LMEIN</f><f>EVERS</f><f>ZWERT</f><f>NAVNW</f><f>ABMNG</f><f>PRDAT</f><f>BSTYP</f><f>EFFWR</f><f>XOBLR</f><f>KUNNR</f><f>ADRNR</f><f>EKKOL</f><f>SKTOF</f><f>STAFO</f><f>PLIFZ</f><f>NTGEW</f><f>GEWEI</f><f>TXJCD</f><f>ETDRK</f><f>SOBKZ</f><f>ARSNR</f><f>ARSPS</f><f>INSNC</f><f>SSQSS</f><f>ZGTYP</f><f>EAN11</f><f>BSTAE</f><f>REVLV</f><f>GEBER</f><f>FISTL</f><f>FIPOS</f><f>KO_GSBER</f><f>KO_PARGB</f><f>KO_PRCTR</f><f>KO_PPRCTR</f><f>MEPRF</f><f>BRGEW</f><f>VOLUM</f><f>VOLEH</f><f>INCO1</f><f>INCO2</f><f>VORAB</f><f>KOLIF</f><f>LTSNR</f><f>PACKNO</f><f>FPLNR</f><f>GNETWR</f><f>STAPO</f><f>UEBPO</f><f>LEWED</f><f>EMLIF</f><f>LBLKZ</f><f>SATNR</f><f>ATTYP</f><f>KANBA</f><f>ADRN2</f><f>CUOBJ</f><f>XERSY</f><f>EILDT</f><f>DRDAT</f><f>DRUHR</f><f>DRUNR</f><f>AKTNR</f><f>ABELN</f><f>ABELP</f><f>ANZPU</f><f>PUNEI</f><f>SAISO</f><f>SAISJ</f><f>EBON2</f><f>EBON3</f><f>EBONF</f><f>MLMAA</f><f>MHDRZ</f><f>ANFNR</f><f>ANFPS</f><f>KZKFG</f><f>USEQU</f><f>UMSOK</f><f>BANFN</f><f>BNFPO</f><f>MTART</f><f>UPTYP</f><f>UPVOR</f><f>KZWI1</f><f>KZWI2</f><f>KZWI3</f><f>KZWI4</f><f>KZWI5</f><f>KZWI6</f><f>SIKGR</f><f>MFZHI</f><f>FFZHI</f><f>RETPO</f><f>AUREL</f><f>BSGRU</f><f>LFRET</f><f>MFRGR</f><f>NRFHG</f><f>J_1BNBM</f><f>J_1BMATUSE</f><f>J_1BMATORG</f><f>J_1BOWNPRO</f><f>J_1BINDUST</f><f>ABUEB</f><f>NLABD</f><f>NFABD</f><f>KZBWS</f><f>BONBA</f><f>FABKZ</f><f>J_1AINDXP</f><f>J_1AIDATEP</f><f>MPROF</f><f>EGLKZ</f><f>KZTLF</f><f>KZFME</f><f>RDPRF</f><f>TECHS</f><f>CHG_SRV</f><f>CHG_FPLNR</f><f>MFRPN</f><f>MFRNR</f><f>EMNFR</f><f>NOVET</f><f>AFNAM</f><f>TZONRC</f><f>IPRKZ</f><f>LEBRE</f><f>BERID</f><f>XCONDITIONS</f><f>APOMS</f><f>CCOMP</f><f>GRANT_NBR</f><f>FKBER</f><f>STATUS</f><f>RESLO</f><f>PRIO_URG</f><f>PRIO_REQ</f><f>EXCPE</f><f>ZZDUMMY</f><f>REFSITE</f></fs><wc><w><f>AEDAT</f><o>6</o><l>%_Data_Range_From%</l><h>%_Data_Range_To%</h></w></wc></t></ts><js></js></q>
IMPORT SAP PASSWORD 1 TO LFA1 SAP SOURCE "SAP AGENT" <q version="6.0"><s>0</s><d>%_SAP_SYSTEM%</d><u>%SAP_UserID%</u><c>%_SAP_CLIENT%</c><lg>EN</lg><cf>%fld_Sources%LFA1.fil</cf><sf>D:\ACL_DOWNLOAD\DL_ACLDOWNLOAD104536.DAT                                                                                                                                                                                                                       </sf><jcount>10453600</jcount><jname>DL_ACLDOWNLOAD104536.DAT        </jname><dl>1495</dl><m>1</m><r>500</r><ar>1</ar><e>500</e><ts><t><n>LFA1</n><a>T00001</a><td>Vendor Master (General Section)</td><fs><f>MANDT</f><f>LIFNR</f><f>LAND1</f><f>NAME1</f><f>NAME2</f><f>NAME3</f><f>NAME4</f><f>ORT01</f><f>ORT02</f><f>PFACH</f><f>PSTL2</f><f>PSTLZ</f><f>REGIO</f><f>SORTL</f><f>STRAS</f><f>ADRNR</f><f>MCOD1</f><f>MCOD2</f><f>MCOD3</f><f>ANRED</f><f>BAHNS</f><f>BBBNR</f><f>BBSNR</f><f>BEGRU</f><f>BRSCH</f><f>BUBKZ</f><f>DATLT</f><f>DTAMS</f><f>DTAWS</f><f>ERDAT</f><f>ERNAM</f><f>ESRNR</f><f>KONZS</f><f>KTOKK</f><f>KUNNR</f><f>LNRZA</f><f>LOEVM</f><f>SPERR</f><f>SPERM</f><f>SPRAS</f><f>STCD1</f><f>STCD2</f><f>STKZA</f><f>STKZU</f><f>TELBX</f><f>TELF1</f><f>TELF2</f><f>TELFX</f><f>TELTX</f><f>TELX1</f><f>XCPDK</f><f>XZEMP</f><f>VBUND</f><f>FISKN</f><f>STCEG</f><f>STKZN</f><f>SPERQ</f><f>GBORT</f><f>GBDAT</f><f>SEXKZ</f><f>KRAUS</f><f>REVDB</f><f>QSSYS</f><f>KTOCK</f><f>PFORT</f><f>WERKS</f><f>LTSNA</f><f>WERKR</f><f>PLKAL</f><f>DUEFL</f><f>TXJCD</f><f>SPERZ</f><f>SCACD</f><f>SFRGR</f><f>LZONE</f><f>XLFZA</f><f>DLGRP</f><f>FITYP</f><f>STCDT</f><f>REGSS</f><f>ACTSS</f><f>STCD3</f><f>STCD4</f><f>IPISP</f><f>TAXBS</f><f>PROFS</f><f>STGDL</f><f>EMNFR</f><f>LFURL</f><f>J_1KFREPRE</f><f>J_1KFTBUS</f><f>J_1KFTIND</f><f>CONFS</f><f>UPDAT</f><f>UPTIM</f><f>NODEL</f><f>QSSYSDAT</f><f>PODKZB</f><f>FISKU</f><f>STENR</f><f>J_SC_CAPITAL</f><f>J_SC_CURRENCY</f><f>ALC</f><f>PMT_OFFICE</f><f>PSOFG</f><f>PSOIS</f><f>PSON1</f><f>PSON2</f><f>PSON3</f><f>PSOVN</f><f>PSOTL</f><f>PSOHS</f><f>PSOST</f></fs><wc></wc></t></ts><js></js></q>
IMPORT SAP PASSWORD 1 TO LFB1 SAP SOURCE "SAP AGENT" <q version="6.0"><s>0</s><d>%_SAP_SYSTEM%</d><u>%SAP_UserID%</u><c>%_SAP_CLIENT%</c><lg>EN</lg><cf>%fld_Sources%LFB1.fil</cf><sf>D:\ACL_DOWNLOAD\DL_ACLDOWNLOAD104623.DAT                                                                                                                                                                                                                       </sf><jcount>10462300</jcount><jname>DL_ACLDOWNLOAD104623.DAT        </jname><dl>518 </dl><m>1</m><r>500</r><ar>1</ar><e>500</e><ts><t><n>LFB1</n><a>T00001</a><td>Vendor Master (Company Code)</td><fs><f>MANDT</f><f>LIFNR</f><f>BUKRS</f><f>PERNR</f><f>ERDAT</f><f>ERNAM</f><f>SPERR</f><f>LOEVM</f><f>ZUAWA</f><f>AKONT</f><f>BEGRU</f><f>VZSKZ</f><f>ZWELS</f><f>XVERR</f><f>ZAHLS</f><f>ZTERM</f><f>EIKTO</f><f>ZSABE</f><f>KVERM</f><f>FDGRV</f><f>BUSAB</f><f>LNRZE</f><f>LNRZB</f><f>ZINDT</f><f>ZINRT</f><f>DATLZ</f><f>XDEZV</f><f>WEBTR</f><f>KULTG</f><f>REPRF</f><f>TOGRU</f><f>HBKID</f><f>XPORE</f><f>QSZNR</f><f>QSZDT</f><f>QSSKZ</f><f>BLNKZ</f><f>MINDK</f><f>ALTKN</f><f>ZGRUP</f><f>MGRUP</f><f>UZAWE</f><f>QSREC</f><f>QSBGR</f><f>QLAND</f><f>XEDIP</f><f>FRGRP</f><f>TOGRR</f><f>TLFXS</f><f>INTAD</f><f>XLFZB</f><f>GUZTE</f><f>GRICD</f><f>GRIDT</f><f>XAUSZ</f><f>CERDT</f><f>CONFS</f><f>UPDAT</f><f>UPTIM</f><f>NODEL</f><f>TLFNS</f><f>J_SC_SUBCONTYPE</f><f>J_SC_COMPDATE</f><f>J_SC_OFFSM</f><f>J_SC_OFFSR</f><f>BASIS_PNT</f><f>GMVKZK</f></fs><wc></wc></t></ts><js></js></q>
IMPORT SAP PASSWORD 1 TO LFBK SAP SOURCE "SAP AGENT" <q version="6.0"><s>0</s><d>%_SAP_SYSTEM%</d><u>%SAP_UserID%</u><c>%_SAP_CLIENT%</c><lg>EN</lg><cf>%fld_Sources%LFBK.fil</cf><sf>D:\ACL_DOWNLOAD\DL_ACLDOWNLOAD104716.DAT                                                                                                                                                                                                                       </sf><jcount>10471600</jcount><jname>DL_ACLDOWNLOAD104716.DAT        </jname><dl>194 </dl><m>1</m><r>500</r><ar>1</ar><e>500</e><ts><t><n>LFBK</n><a>T00001</a><td>Vendor Master (Bank Details)</td><fs><f>MANDT</f><f>LIFNR</f><f>BANKS</f><f>BANKL</f><f>BANKN</f><f>BKONT</f><f>BVTYP</f><f>XEZER</f><f>BKREF</f><f>KOINH</f><f>EBPP_ACCNAME</f><f>EBPP_BVSTATUS</f><f>KOVON</f><f>KOBIS</f></fs><wc></wc></t></ts><js></js></q>
IMPORT SAP PASSWORD 1 TO PAYR SAP SOURCE "SAP AGENT" <q version="6.0"><s>0</s><d>%_SAP_SYSTEM%</d><u>%SAP_UserID%</u><c>%_SAP_CLIENT%</c><lg>EN</lg><cf>%fld_Sources%PAYR.fil</cf><sf>D:\ACL_DOWNLOAD\DL_ACLDOWNLOAD103414.DAT                                                                                                                                                                                                                       </sf><jcount>10341400</jcount><jname>DL_ACLDOWNLOAD103414.DAT        </jname><dl>634 </dl><m>1</m><r>500</r><ar>1</ar><e>500</e><ts><t><n>PAYR</n><a>T00001</a><td>Payment Medium File</td><fs><f>MANDT</f><f>ZBUKR</f><f>HBKID</f><f>HKTID</f><f>RZAWE</f><f>CHECT</f><f>CHECF</f><f>LAUFD</f><f>LAUFI</f><f>LIFNR</f><f>KUNNR</f><f>EMPFG</f><f>UBHKT</f><f>VBLNR</f><f>GJAHR</f><f>ZALDT</f><f>WAERS</f><f>RWBTR</f><f>STRGB</f><f>PRIDT</f><f>PRITI</f><f>PRIUS</f><f>XMANU</f><f>XBANC</f><f>BANCD</f><f>EXTRD</f><f>EXTRT</f><f>XBUKR</f><f>ZANRE</f><f>ZNME1</f><f>ZNME2</f><f>ZNME3</f><f>ZNME4</f><f>ZPSTL</f><f>ZORT1</f><f>ZSTRA</f><f>ZPFAC</f><f>ZLAND</f><f>ZREGI</f><f>ZBNKS</f><f>ZBNKN</f><f>ZBNKL</f><f>ZBKON</f><f>VOIDR</f><f>VOIDD</f><f>VOIDU</f><f>CHECV</f><f>HBKIV</f><f>HKTIV</f><f>ZPST2</f><f>XRAGL</f><f>PERNR</f><f>SEQNR</f><f>REC_BELNR</f><f>REC_GJAHR</f><f>ZPFOR</f><f>UZAWE</f><f>ICHEC</f><f>IREFE</f><f>RWSKT</f></fs><wc><w><f>BANCD</f><o>6</o><l>%_Data_Range_From%</l><h>%_Data_Range_To%</h></w></wc></t></ts><js></js></q>
IMPORT SAP PASSWORD 1 TO BSEG SAP SOURCE "SAP AGENT" <q version="6.0"><s>0</s><d>%_SAP_SYSTEM%</d><u>%SAP_UserID%</u><c>%_SAP_CLIENT%</c><lg>EN</lg><cf>%fld_Sources%BSEG.fil</cf><sf>D:\ACL_DOWNLOAD\DL_ACLDOWNLOAD151051.DAT                                                                                                                                                                                                                       </sf><jcount>15105100</jcount><jname>DL_ACLDOWNLOAD151051.DAT        </jname><dl>2632</dl><m>1</m><r>500</r><ar>1</ar><e>500</e><ts><t><n>BSEG</n><a>T00001</a><td>Accounting Document Segment</td><fs><f>MANDT</f><f>BUKRS</f><f>BELNR</f><f>GJAHR</f><f>BUZEI</f><f>BUZID</f><f>AUGDT</f><f>AUGCP</f><f>AUGBL</f><f>BSCHL</f><f>KOART</f><f>UMSKZ</f><f>UMSKS</f><f>ZUMSK</f><f>SHKZG</f><f>GSBER</f><f>PARGB</f><f>MWSKZ</f><f>QSSKZ</f><f>DMBTR</f><f>WRBTR</f><f>KZBTR</f><f>PSWBT</f><f>PSWSL</f><f>TXBHW</f><f>TXBFW</f><f>MWSTS</f><f>WMWST</f><f>HWBAS</f><f>FWBAS</f><f>HWZUZ</f><f>FWZUZ</f><f>SHZUZ</f><f>STEKZ</f><f>MWART</f><f>TXGRP</f><f>KTOSL</f><f>QSSHB</f><f>KURSR</f><f>GBETR</f><f>BDIFF</f><f>BDIF2</f><f>VALUT</f><f>ZUONR</f><f>SGTXT</f><f>ZINKZ</f><f>VBUND</f><f>BEWAR</f><f>ALTKT</f><f>VORGN</f><f>FDLEV</f><f>FDGRP</f><f>FDWBT</f><f>FDTAG</f><f>FKONT</f><f>KOKRS</f><f>KOSTL</f><f>PROJN</f><f>AUFNR</f><f>VBELN</f><f>VBEL2</f><f>POSN2</f><f>ETEN2</f><f>ANLN1</f><f>ANLN2</f><f>ANBWA</f><f>BZDAT</f><f>PERNR</f><f>XUMSW</f><f>XHRES</f><f>XKRES</f><f>XOPVW</f><f>XCPDD</f><f>XSKST</f><f>XSAUF</f><f>XSPRO</f><f>XSERG</f><f>XFAKT</f><f>XUMAN</f><f>XANET</f><f>XSKRL</f><f>XINVE</f><f>XPANZ</f><f>XAUTO</f><f>XNCOP</f><f>XZAHL</f><f>SAKNR</f><f>HKONT</f><f>KUNNR</f><f>LIFNR</f><f>FILKD</f><f>XBILK</f><f>GVTYP</f><f>HZUON</f><f>ZFBDT</f><f>ZTERM</f><f>ZBD1T</f><f>ZBD2T</f><f>ZBD3T</f><f>ZBD1P</f><f>ZBD2P</f><f>SKFBT</f><f>SKNTO</f><f>WSKTO</f><f>ZLSCH</f><f>ZLSPR</f><f>ZBFIX</f><f>HBKID</f><f>BVTYP</f><f>NEBTR</f><f>MWSK1</f><f>DMBT1</f><f>WRBT1</f><f>MWSK2</f><f>DMBT2</f><f>WRBT2</f><f>MWSK3</f><f>DMBT3</f><f>WRBT3</f><f>REBZG</f><f>REBZJ</f><f>REBZZ</f><f>REBZT</f><f>ZOLLT</f><f>ZOLLD</f><f>LZBKZ</f><f>LANDL</f><f>DIEKZ</f><f>SAMNR</f><f>ABPER</f><f>VRSKZ</f><f>VRSDT</f><f>DISBN</f><f>DISBJ</f><f>DISBZ</f><f>WVERW</f><f>ANFBN</f><f>ANFBJ</f><f>ANFBU</f><f>ANFAE</f><f>BLNBT</f><f>BLNKZ</f><f>BLNPZ</f><f>MSCHL</f><f>MANSP</f><f>MADAT</f><f>MANST</f><f>MABER</f><f>ESRNR</f><f>ESRRE</f><f>ESRPZ</f><f>KLIBT</f><f>QSZNR</f><f>QBSHB</f><f>QSFBT</f><f>NAVHW</f><f>NAVFW</f><f>MATNR</f><f>WERKS</f><f>MENGE</f><f>MEINS</f><f>ERFMG</f><f>ERFME</f><f>BPMNG</f><f>BPRME</f><f>EBELN</f><f>EBELP</f><f>ZEKKN</f><f>ELIKZ</f><f>VPRSV</f><f>PEINH</f><f>BWKEY</f><f>BWTAR</f><f>BUSTW</f><f>REWRT</f><f>REWWR</f><f>BONFB</f><f>BUALT</f><f>PSALT</f><f>NPREI</f><f>TBTKZ</f><f>SPGRP</f><f>SPGRM</f><f>SPGRT</f><f>SPGRG</f><f>SPGRV</f><f>SPGRQ</f><f>STCEG</f><f>EGBLD</f><f>EGLLD</f><f>RSTGR</f><f>RYACQ</f><f>RPACQ</f><f>RDIFF</f><f>RDIF2</f><f>PRCTR</f><f>XHKOM</f><f>VNAME</f><f>RECID</f><f>EGRUP</f><f>VPTNR</f><f>VERTT</f><f>VERTN</f><f>VBEWA</f><f>DEPOT</f><f>TXJCD</f><f>IMKEY</f><f>DABRZ</f><f>POPTS</f><f>FIPOS</f><f>KSTRG</f><f>NPLNR</f><f>AUFPL</f><f>APLZL</f><f>PROJK</f><f>PAOBJNR</f><f>PASUBNR</f><f>SPGRS</f><f>SPGRC</f><f>BTYPE</f><f>ETYPE</f><f>XEGDR</f><f>LNRAN</f><f>HRKFT</f><f>DMBE2</f><f>DMBE3</f><f>DMB21</f><f>DMB22</f><f>DMB23</f><f>DMB31</f><f>DMB32</f><f>DMB33</f><f>MWST2</f><f>MWST3</f><f>NAVH2</f><f>NAVH3</f><f>SKNT2</f><f>SKNT3</f><f>BDIF3</f><f>RDIF3</f><f>HWMET</f><f>GLUPM</f><f>XRAGL</f><f>UZAWE</f><f>LOKKT</f><f>FISTL</f><f>GEBER</f><f>STBUK</f><f>TXBH2</f><f>TXBH3</f><f>PPRCT</f><f>XREF1</f><f>XREF2</f><f>KBLNR</f><f>KBLPOS</f><f>STTAX</f><f>FKBER</f><f>OBZEI</f><f>XNEGP</f><f>RFZEI</f><f>CCBTC</f><f>KKBER</f><f>EMPFB</f><f>XREF3</f><f>DTWS1</f><f>DTWS2</f><f>DTWS3</f><f>DTWS4</f><f>GRICD</f><f>GRIRG</f><f>GITYP</f><f>XPYPR</f><f>KIDNO</f><f>ABSBT</f><f>IDXSP</f><f>LINFV</f><f>KONTT</f><f>KONTL</f><f>TXDAT</f><f>AGZEI</f><f>PYCUR</f><f>PYAMT</f><f>BUPLA</f><f>SECCO</f><f>LSTAR</f><f>CESSION_KZ</f><f>PRZNR</f><f>PPDIFF</f><f>PPDIF2</f><f>PPDIF3</f><f>PENLC1</f><f>PENLC2</f><f>PENLC3</f><f>PENFC</f><f>PENDAYS</f><f>PENRC</f><f>GRANT_NBR</f><f>SCTAX</f><f>FKBER_LONG</f><f>GMVKZ</f><f>SRTYPE</f><f>INTRENO</f><f>MEASURE</f><f>AUGGJ</f><f>PPA_EX_IND</f></fs><wc><w><f>VALUT</f><o>6</o><l>%_Data_Range_From%</l><h>%_Data_Range_To%</h></w></wc></t></ts><js></js></q>

COMM *** RETRIEVE SAP DATA ***

RETRIEVE BSAK PASSWORD 1
RETRIEVE BSIK PASSWORD 1
RETRIEVE PKPF PASSWORD 1
RETRIEVE EKPO PASSWORD 1
RETRIEVE LFA1 PASSWORD 1
RETRIEVE LFB1 PASSWORD 1
RETRIEVE LFBK PASSWORD 1
RETRIEVE PAYR PASSWORD 1
RETRIEVE BSEG PASSWORD 1


SET DATE "DD/MM/YYYY"

SET SAFETY ON
^BATCH    IM005_JDE                          
[PARENT_FOLDER_ID] 1430796694
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Load Source Data : JDE
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("_Version")="U" OR FTYPE("fld_Sources")="U" DO AA002_Variable_Setting

SET FOLDER /%fld_Sources%
^BATCH    IM006_PeopleSoft                   
[PARENT_FOLDER_ID] 1430796694
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Load Source Data : PeopleSoft
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("_Version")="U" OR FTYPE("fld_Sources")="U" DO AA002_Variable_Setting

SET FOLDER /%fld_Sources%

^BATCH    IM007_Oracle                       
[PARENT_FOLDER_ID] 1430796694
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Load Source Data : Oracle
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("_Version")="U" OR FTYPE("fld_Sources")="U" DO AA002_Variable_Setting

SET FOLDER /%fld_Sources%
^FOLDER   Mapping_Table                       1430797880
[PARENT_FOLDER_ID] 1430796705
^BATCH    LE001_Link_Menu                    
[PARENT_FOLDER_ID] 1430796705
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Link Field from Source Data To Target Working File Tables: Menu
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("_Version")="v" OR FTYPE("_Version")="U" OR FTYPE("fld_Sources")="U" OR FTYPE("fld_DataMapping")="U" DO AA002_Variable_Setting
DO LE006_Fields

FLAG=F

DO LE002_Match_Menu WHILE FLAG=F
^FOLDER   zNotInUse                           1427071019
[PARENT_FOLDER_ID] 1349217412
^BATCH    LE002_Match_Menu                   
[PARENT_FOLDER_ID] 1430796705
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Link Field from Source Data To Target Working File Tables: Menu
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF

COMM *** Initialize the link fields from the mapping tables ***

ASSIGN LE_ALL=F
ASSIGN LE_VM_MA=F
ASSIGN LE_VM_Add=F
ASSIGN LE_VM_BK=F
ASSIGN LE_VM_OTV=F
ASSIGN LE_VM_GL=F
ASSIGN LE_VM_InterCo=F
ASSIGN LE_AP_INV=F
ASSIGN LE_AP_PAY=F
ASSIGN LE_AP_PO=F
ASSIGN LE_AP_InvPO=F
ASSIGN LE_EM_MA=F
ASSIGN LE_EM_BK=F
ASSIGN LE_PR_PAY=F
ASSIGN LE_Map_Excel =F
ASSIGN LE_Excel_Add="DataMapping\DataMapping.xlsx"
exit=F

COMM
DIALOG (DIALOG TITLE "%_Version% Data File Selection Menu" WIDTH 792 HEIGHT 568 ) (BUTTONSET TITLE "&OK;&Cancel" AT 624 432 DEFAULT 1 ) (TEXT TITLE "Please specify the file you would like to identify?" AT 60 28 WIDTH 646 HEIGHT 14 CENTER ) (CHECKBOX TITLE "All Files" TO "LE_ALL" AT 36 120 WIDTH 57 HEIGHT 14 ) (CHECKBOX TITLE "AP Invoices / Transactions *" TO "LE_AP_INV" AT 36 324 WIDTH 181 HEIGHT 20 ) (CHECKBOX TITLE "Vendors / Suppliers *" TO "LE_VM_MA" AT 36 216 ) (TEXT TITLE "All files from Vendor Master, Accounts Payable, Employee Master and Payroll are selected automatically." AT 144 120 WIDTH 524 HEIGHT 14 ) (CHECKBOX TITLE "Vendor addresses / Vendor Sites (If mutiple)" TO "LE_VM_Add" AT 240 216 WIDTH 284 ) (CHECKBOX TITLE "Vendor / Supplier Bank Accounts" TO "LE_VM_BK" AT 540 216 WIDTH 180 ) (CHECKBOX TITLE "Check to Exit/Escape" TO "exit" AT 612 492 WIDTH 123 ) (TEXT TITLE "VENDOR MASTER" AT 36 184 HEIGHT 15 ) (CHECKBOX TITLE "AP Payments" TO "LE_AP_PAY" AT 240 324 HEIGHT 20 ) (TEXT TITLE "ACCOUNTS PAYABLE" AT 36 292 ) (CHECKBOX TITLE "Employee Master File *" TO "LE_EM_MA" AT 36 432 WIDTH 144 ) (CHECKBOX TITLE "Employee Bank Account" TO "LE_EM_BK" AT 240 432 ) (TEXT TITLE "EMPLOYEE MASTER " AT 36 400 HEIGHT 14 ) (CHECKBOX TITLE "Purchase Order Lines" TO "LE_AP_PO" AT 540 324 ) (TEXT TITLE "PAYROLL" AT 36 484 ) (CHECKBOX TITLE "One Time Vendors" TO "LE_VM_OTV" AT 36 240 ) (CHECKBOX TITLE "Interal Companies" TO "LE_VM_InterCo" AT 240 240 ) (CHECKBOX TITLE "Payroll / Payment Transactions *" TO "LE_PR_PAY" AT 36 516 ) (CHECKBOX TITLE "Load the mapping from EXCEL file" TO "LE_Map_Excel" AT 36 72 WIDTH 209 ) (EDIT TO "LE_Excel_Add" AT 240 72 WIDTH 376 DEFAULT "%LE_Excel_Add%" ) (CHECKBOX TITLE "AP Invoices - PO Relationship" TO "LE_AP_INVPO" AT 36 348 )

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data File Selection Menu" WIDTH 735 HEIGHT 250 ) (BUTTONSET TITLE "&OK;&Cancel" AT 252 120 DEFAULT 1 ) (TEXT TITLE "Please specify the file you would like to identify?" AT 60 28 WIDTH 646 HEIGHT 14 CENTER ) (CHECKBOX TITLE "Check to Exit/Escape" TO "exit" AT 372 132 WIDTH 123 ) (CHECKBOX TITLE "Load the mapping from EXCEL file" TO "LE_Map_Excel" AT 36 72 WIDTH 209 CHECKED ) (EDIT TO "LE_Excel_Add" AT 240 72 WIDTH 376 DEFAULT "%LE_Excel_Add%" )

IF exit=T ESCAPE

IF LE_Map_Excel=T DO LE003_Imp_Mapping
IF LE_Map_Excel=T ESCAPE

%v_CCMJob% IF ((LE_VM_MA= F) AND (LE_VM_Add= F) AND (LE_VM_BK= F) AND (LE_VM_OTV= F) AND (LE_VM_InterCo= F) AND (LE_AP_INV= F) AND (LE_AP_PAY= F) AND (LE_AP_PAY= F) AND LE_AP_PO=F AND LE_AP_PO=F AND LE_AP_InvPO=F AND LE_EM_MA=F AND LE_EM_BK=F AND LE_PR_PAY=F) Pause "Please select the file(s) you want to link." 
IF ((LE_VM_MA= T) OR (LE_VM_Add= T) OR (LE_VM_BK= T) OR (LE_VM_OTV= T) OR (LE_VM_InterCo= T) OR (LE_AP_INV= T) OR (LE_AP_PAY= T) OR (LE_AP_PAY= T) OR LE_AP_PO=T OR LE_AP_PO=T OR LE_AP_InvPO=T OR LE_EM_MA=T OR LE_EM_BK=T OR LE_PR_PAY=T) Flag=T

IF LE_ALL=T ASSIGN LE_VM_MA=T
IF LE_ALL=T ASSIGN LE_VM_Add=T
IF LE_ALL=T ASSIGN LE_VM_BK=T
IF LE_ALL=T ASSIGN LE_VM_OTV=T
IF LE_ALL=T ASSIGN LE_VM_InterCo=T
IF LE_ALL=T ASSIGN LE_AP_INV=T
IF LE_ALL=T ASSIGN LE_AP_PAY=T
IF LE_ALL=T ASSIGN LE_AP_PO=T
IF LE_ALL=T ASSIGN LE_AP_InvPO=T
IF LE_ALL=T ASSIGN LE_EM_MA=T
IF LE_ALL=T ASSIGN LE_EM_BK=T
IF LE_ALL=T ASSIGN LE_PR_PAY=T

IF LE_VM_MA = T    DO B0101_Select_Vnd
IF LE_VM_Add = T   DO B0201_Select_Vnd_Add
IF LE_VM_BK = T    DO B0301_Select_Vnd_BK
IF LE_VM_OTV = T   DO B0401_Select_OTV
IF LE_VM_InterCo = T  DO B0601_Select_InterCo
IF LE_AP_INV= T    DO B0701_Select_Inv
IF LE_AP_PAY= T    DO B0801_Select_Pay
IF LE_AP_PO= T     DO B0901_Select_PO
IF LE_AP_InvPO= T     DO B1301_Select_InvPO
IF LE_EM_MA= T     DO B1001_Select_Emp
IF LE_EM_BK= T     DO B1101_Select_Emp_Bk
IF LE_PR_PAY= T    DO B1201_Select_PR_Pay


SET SAFETY ON

^BATCH    LE004_Upt_Mapping                  
[PARENT_FOLDER_ID] 1430796705
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Update the data mapping (DM_*) to change the relationship between source fields and target fields
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 09/07/2012
COMM***************************************************************************


SET SAFETY OFF


DELETE FORMAT TMP OK
DELETE FORMAT TMP1 OK
DELETE "%fld_Tmps%TMP.FIL" OK
DELETE "%fld_Tmps%TMP1.FIL" OK


IF FTYPE("fld_Tmps")="U" OR FTYPE("fld_DataMapping")="U" DO AA002_Variable_Setting

IF FILESIZE("%fld_DataMapping%%v_dm_tbl_Nme%.fil")<=0 DM_Flag=F
IF FILESIZE("%fld_DataMapping%%v_dm_tbl_Nme%.fil")<=0 DO LE003_Imp_Mapping

SET FOLDER /%fld_Tmps%

OPEN %v_dm_tbl_Nme%
EXTRACT FIELDS ALL TO "%fld_Tmps%TMP" OPEN

COUNT
v_counter=1
DO LE005_Upt_Mapping_Sub WHILE v_counter<=COUNT1


OPEN TMP1
INDEX ON std_Fld_Nme TO IDX_TMP1_Std_Fld_Nme
OPEN TMP
DEFINE RELATION std_Fld_Nme WITH TMP1 INDEX IDX_TMP1_Std_Fld_Nme

SET FOLDER /%fld_DataMapping%
EXTRACT FIELDS Std_Fld_Nme Type Length Decimals Field_explanation TMP1.Src_File TMP1.Src_Fld_Nme IF NOT ISBLANK(Std_Fld_Nme) TO  "%fld_DataMapping%%v_dm_tbl_Nme%" OPEN


DELETE FORMAT TMP OK
DELETE FORMAT TMP1 OK
DELETE "%fld_Tmps%TMP.FIL" OK
DELETE "%fld_Tmps%TMP1.FIL" OK


^BATCH    LE005_Upt_Mapping_Sub              
[PARENT_FOLDER_ID] 1430796705
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Update the data mapping (DM_*) to change the relationship between source fields and target fields
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 09/07/2012
COMM***************************************************************************


SET SAFETY OFF

LOCATE RECORD v_counter

v_fld_src=ALLTRIM("%v_fd%_"+Std_Fld_Nme)
v_fld_src2='%v_fld_src%'
v_fld_Nme=ALLTRIM(Std_Fld_Nme)

IF v_counter =1 DELETE "%fld_Tmps%TMP1.FIL" OK
IF v_counter =1 DELETE FORMAT "TMP1" OK
EXTRACT FIELDS SUBSTR("%v_fld_Nme%",1,50) AS "Std_Fld_Nme" SUBSTR(ALLTRIM("%v_src_tbl_Nme%"),1,50) AS "Src_File" SUBSTR(%v_fld_src2%,1,50) AS "Src_Fld_Nme" TO "%fld_Tmps%TMP1" FIRST 1 APPEND

v_counter=v_counter+1

^BATCH    LE006_Fields                       
[PARENT_FOLDER_ID] 1430796705
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Format the Target Fields for the EVA Standard tables
COMM *** If the mappings have been set, then will generate the mapping information into corresponding variables
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("_Version")="U" OR FTYPE("fld_DataMapping") ="U" DO AA002_Variable_Setting

IF FTYPE("v_dm_tbl_Nme")="U" v_dm_tbl_Nme=""
IF FTYPE("v_fd")="U" v_fd=""
IF FTYPE("v_src_tbl_Nme")="U" v_src_tbl_Nme=""

src_VMF=""
src_VMF_Bk=""
src_VMF_Add=""
src_VMF_GL=""
src_VMF_OTV=""
src_VMF_InterCo=""
src_AP_Inv=""
src_AP_Pay=""
src_AP_InvPO=""
src_AP_PO=""
src_EMF=""
src_EMF_Bk=""
src_PR_Pay=""
 
COMM *** AP_Invoice ***
COMM *** initialize the link fields ***
v_dm_tbl_Nme="DM_%trg_AP_Inv%"
v_fd="fdap"
DO LE007_Ini_Fields
src_AP_Inv='%v_src_tbl_Nme%'

COMM *** AP_Payments ***
COMM *** initialize the link fields ***
v_dm_tbl_Nme="DM_%trg_AP_Pay%"
v_fd="fdpp"
DO LE007_Ini_Fields
src_AP_Pay='%v_src_tbl_Nme%'

COMM *** AP PO Line Items ***
COMM *** initialize the link fields ***
v_dm_tbl_Nme="DM_%trg_AP_PO%"
v_fd="fdpo"
DO LE007_Ini_Fields
src_AP_PO='%v_src_tbl_Nme%'

COMM *** AP PO Line Items ***
COMM *** initialize the link fields ***
v_dm_tbl_Nme="DM_%trg_AP_InvPO%"
v_fd="fdip"
DO LE007_Ini_Fields
src_AP_InvPO='%v_src_tbl_Nme%'

COMM *** VMF_Vnd_Master_File ***
COMM *** initialize the link fields ***
v_dm_tbl_Nme="DM_%trg_VMF%"
v_fd="fdvm"
DO LE007_Ini_Fields
src_VMF='%v_src_tbl_Nme%'


COMM *** VMF_Add ***
COMM *** initialize the link fields ***
v_dm_tbl_Nme="DM_%trg_VMF_Add%"
v_fd="fdad"
DO LE007_Ini_Fields
src_VMF_Add='%v_src_tbl_Nme%'

COMM *** VMF_BnkAcc ***
COMM *** initialize the link fields ***
v_dm_tbl_Nme="DM_%trg_VMF_BK%"
v_fd="fdbk"
DO LE007_Ini_Fields
src_VMF_BK='%v_src_tbl_Nme%'

COMM *** VMF_Vnd_One_Time ***
COMM *** initialize the link fields ***
v_dm_tbl_Nme="DM_%trg_VMF_OTV%"
v_fd="fdot"
DO LE007_Ini_Fields
src_VMF_OTV='%v_src_tbl_Nme%'

COMM *** VMF_InterCompany ***
COMM *** initialize the link fields ***
v_dm_tbl_Nme="DM_%trg_VMF_InterCo%"
v_fd="fdic"
DO LE007_Ini_Fields
src_VMF_InterCo='%v_src_tbl_Nme%'

COMM *** EMF_EMP_Master_File
COMM *** initialize the link fields ***
v_dm_tbl_Nme="DM_%trg_EMF%"
v_fd="fdem"
DO LE007_Ini_Fields
src_EMF='%v_src_tbl_Nme%'

COMM *** Employee Bank Accounts ***
COMM *** initialize the link fields ***
v_dm_tbl_Nme="DM_%trg_EMF_BK%"
v_fd="fdeb"
DO LE007_Ini_Fields
src_EMF_BK='%v_src_tbl_Nme%'

COMM *** Payroll Payments **
COMM *** initialize the link fields ***
v_dm_tbl_Nme="DM_%trg_PR_Pay%"
v_fd="fdpr"
DO LE007_Ini_Fields
src_PR_Pay='%v_src_tbl_Nme%'
^BATCH    LE007_Ini_Fields                   
[PARENT_FOLDER_ID] 1430796705
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Initialize the link fields from the mapping tables
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 09/07/2012
COMM***************************************************************************


v_src_tbl_Nme=""


IF FTYPE("%v_dm_tbl_Nme%")<>"y" OR FILESIZE("%fld_DataMapping%%v_dm_tbl_Nme%.fil")<=0 DM_Flag=F
IF FTYPE("%v_dm_tbl_Nme%")<>"y" OR FILESIZE("%fld_DataMapping%%v_dm_tbl_Nme%.fil")<=0 DO LE003_Imp_Mapping


OPEN %v_dm_tbl_Nme%
COUNT

v_counter=1

DO LE008_Ini_Fields_Sub WHILE v_counter<=COUNT1

^BATCH    LE008_Ini_Fields_Sub               
[PARENT_FOLDER_ID] 1430796705
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Initialize the link fields from the mapping tables
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 09/07/2012
COMM***************************************************************************


LOCATE RECORD v_counter

IF ALLTRIM(Src_File)<>"" v_src_tbl_Nme=ALLTRIM(Src_File)

v_fld_nme=ALLTRIM("%v_fd%_"+Std_Fld_Nme)
v_fld_src= ALLTRIM(src_Fld_Nme) 
%v_fld_nme%='%v_fld_src%'

v_counter=v_counter+1

^BATCH    B0101_Select_Vnd                   
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Convert, Link Fields from Source Data To Target Working File Table's Fields: Vendor Master File
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF

FLAG_Show=T

DO B0102_Loop_Sel_Vnd WHILE ISBLANK(src_VMF)= T OR FLAG_Show=T

DO B0103_Match_Vnd_Mstr_Flds
IF exit=T ESCAPE


SET SAFETY ON

^BATCH    B0102_Loop_Sel_Vnd                 
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - Select the source table that you want to link to the Vendor Master File
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


FLAG_Show=F
SET FOLDER /%fld_Tmps%

COMM *** List Table Names ***
CLOSE
DIR %fld_Sources%*.fil SUB TO "%fld_Tmps%CVT_Tables"

OPEN CVT_Tables
DELETE FIELD Table_Name OK
DEFINE FIELD Table_Name COMPUTED ALLTRIM(SPLIT(SPLIT(FILE_NAME,"\",OCCURS(FILE_NAME,"\")+1),".",1))

v_Table_Names=BLANKS(10000)
v_counter=0
COUNT

GROUP IF NOT ISBLANK(Table_Name)
 LOOP WHILE v_counter<=COUNT1
  v_Table_Names = ALLTRIM(v_Table_Names) + ALLTRIM(RECOFFSET(Table_Name,v_counter)) + ";"
  v_counter = v_counter + 1
 END
END

v_Table_Names=REPLACE(ALLTRIM(REPLACE(v_Table_Names,";"," "))," ",";")

LOCATE IF Table_Name="%src_VMF%"
v_default=RECNO()

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data Mapping" WIDTH 523 HEIGHT 167 ) (BUTTONSET TITLE "&OK;&Cancel" AT 372 72 DEFAULT 1 ) (DROPDOWN TITLE "%v_Table_Names%" TO "src_VMF" AT 48 72 WIDTH 234 HEIGHT 126 DEFAULT %v_default%) (TEXT TITLE "Select a source table match to the target table - Vendor Master File Table" AT 48 40 )

%v_CCMJob% IF ISBLANK(src_VMF)= T PAUSE "Please select a file that maps to Vendor Master File"


^BATCH    B0103_Match_Vnd_Mstr_Flds          
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Link Fields from Source Data To Target Working File Table's Fields: Vendor Master File
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF
exit=F
FLAG_Show=T

OPEN %src_VMF%
DELETE FIELD _empty_ OK
DEFINE FIELD _empty_ COMPUTED ""

DO B0104_Loop_Match_Vnd WHILE FLAG_Show=T OR MATCH(fdvm_Vndr_Site_ID,"_empty"," ") OR MATCH(fdvm_Vndr_ID,"_empty"," ") OR MATCH(fdvm_Vndr_Nme,"_empty"," ") OR MATCH(fdvm_ABN,"_empty"," ") OR MATCH(fdvm_Vndr_Sts,"_empty"," ") OR MATCH(fdvm_ADD1,"_empty"," ") 
COMM OR MATCH(fdvm_TEL1,"_empty"," ")

IF exit=T ESCAPE

COMM *** Extracting fields to master table from Source ***

v_Flds_Extract="ALLTRIM(%fdvm_Vndr_Site_ID%) AS 'Vndr_Site_ID' ALLTRIM(%fdvm_Vndr_ID%) AS 'Vndr_ID' ALLTRIM(%fdvm_Vndr_Nme%) AS 'Vndr_Nme' ALLTRIM(%fdvm_ABN%) AS 'ABN' ALLTRIM(%fdvm_Vndr_Sts%) AS 'Vndr_Sts' ALLTRIM(fdvm_ADD1) AS 'ADD1'"

IF NOT MATCH(fdvm_Co,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdvm_Co% AS 'Co'"
IF MATCH(fdvm_Co,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Co'"

IF NOT MATCH(fdvm_Vndr_Typ,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdvm_Vndr_Typ% AS 'Vndr_Typ'"
IF MATCH(fdvm_Vndr_Typ,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(11) AS 'Vndr_Typ'"

IF NOT MATCH(fdvm_Vndr_Add_Typ,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdvm_Vndr_Add_Typ% AS 'Vndr_Add_Typ'"
IF MATCH(fdvm_Vndr_Add_Typ,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(15) AS 'Vndr_Add_Typ'"

IF NOT MATCH(fdvm_ADD2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdvm_ADD2%) AS 'ADD2'"
IF MATCH(fdvm_ADD2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(61) AS 'ADD2'"

IF NOT MATCH(fdvm_ADD3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdvm_ADD3%) AS 'ADD3'"
IF MATCH(fdvm_ADD3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(61) AS 'ADD3'"

IF NOT MATCH(fdvm_City,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdvm_City%) AS 'City'"
IF MATCH(fdvm_City,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(35) AS 'City'"

IF NOT MATCH(fdvm_State,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdvm_State%) AS 'State'"
IF MATCH(fdvm_State,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(29) AS 'State'"

IF NOT MATCH(fdvm_Pcode,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdvm_Pcode%) AS 'Pcode'"
IF MATCH(fdvm_Pcode,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(11) AS 'Pcode'"

IF NOT MATCH(fdvm_Cntry,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdvm_Cntry%) AS 'Cntry'"
IF MATCH(fdvm_Cntry,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(61) AS 'Cntry'"

IF NOT MATCH(fdvm_TEL1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdvm_TEL1%) AS 'TEL1'"
IF MATCH(fdvm_TEL1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(21) AS 'TEL1'"

IF NOT MATCH(fdvm_TEL2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdvm_TEL2%) AS 'TEL2'"
IF MATCH(fdvm_TEL2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(21) AS 'TEL2'"

IF NOT MATCH(fdvm_TEL3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdvm_TEL3%) AS 'TEL3'"
IF MATCH(fdvm_TEL3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(21) AS 'TEL3'"

IF NOT MATCH(fdvm_FAX,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdvm_FAX%) AS 'FAX'"
IF MATCH(fdvm_FAX,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(21) AS 'FAX'"

IF NOT MATCH(fdvm_Email1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdvm_Email1%) AS 'Email1'"
IF MATCH(fdvm_Email1"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(60) AS 'Email1'"

IF NOT MATCH(fdvm_Email2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdvm_Email2%) AS 'Email2'"
IF MATCH(fdvm_Email2"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(60) AS 'Email2'"

IF NOT MATCH(fdvm_Pymnt_Trm,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdvm_Pymnt_Trm%) AS 'Pymnt_Trm'"
IF MATCH(fdvm_Pymnt_Trm,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(21) AS 'Pymnt_Trm'"

IF NOT MATCH(fdvm_Created_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdvm_Created_Dt% AS 'Created_Dt'"
IF MATCH(fdvm_Created_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(10) AS 'Created_Dt'"

IF NOT MATCH(fdvm_Modf_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdvm_Modf_Dt% AS 'Modf_Dt'"
IF MATCH(fdvm_Modf_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(10) AS 'Modf_Dt'"

IF NOT MATCH(fdvm_Cha_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdvm_Cha_Field1%) AS 'Cha_Field1'"
IF MATCH(fdvm_Cha_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field1'"

IF NOT MATCH(fdvm_Cha_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdvm_Cha_Field2%) AS 'Cha_Field2'"
IF MATCH(fdvm_Cha_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field2'"

IF NOT MATCH(fdvm_Cha_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdvm_Cha_Field3%) AS 'Cha_Field3'"
IF MATCH(fdvm_Cha_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field3'"

IF NOT MATCH(fdvm_Cha_Field4,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdvm_Cha_Field4%) AS 'Cha_Field4'"
IF MATCH(fdvm_Cha_Field4,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field4'"

IF NOT MATCH(fdvm_Cha_Field5,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdvm_Cha_Field5%) AS 'Cha_Field5'"
IF MATCH(fdvm_Cha_Field5,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field5'"

IF NOT MATCH(fdvm_Num_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdvm_Num_Field1% AS 'Num_Field1'"
IF MATCH(fdvm_Num_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'Num_Field1'"

IF NOT MATCH(fdvm_Num_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdvm_Num_Field2% AS 'Num_Field2'"
IF MATCH(fdvm_Num_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'Num_Field2'"

IF NOT MATCH(fdvm_Num_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdvm_Num_Field3% AS 'Num_Field3'"
IF MATCH(fdvm_Num_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'Num_Field3'"

IF NOT MATCH(fdvm_Num_Field4,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdvm_Num_Field4% AS 'Num_Field4'"
IF MATCH(fdvm_Num_Field4,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'Num_Field4'"

IF NOT MATCH(fdvm_Num_Field5,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdvm_Num_Field5% AS 'Num_Field5'"
IF MATCH(fdvm_Num_Field5,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'Num_Field5'"

IF NOT MATCH(fdvm_Dt_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdvm_Dt_Field1% AS 'Dt_Field1'"
IF MATCH(fdvm_Dt_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Dt_Field1'"

IF NOT MATCH(fdvm_Dt_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdvm_Dt_Field2% AS 'Dt_Field2'"
IF MATCH(fdvm_Dt_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Dt_Field2'"

IF NOT MATCH(fdvm_Dt_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdvm_Dt_Field3% AS 'Dt_Field3'"
IF MATCH(fdvm_Dt_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Dt_Field3'"


COMM EXTRACT FIELDS %v_Flds_Extract%  TO "%fld_Workings%%trg_VMF%.FIL"

DELETE FIELD _empty_ OK  

EXTRACT FIELDS %v_Flds_Extract% TO "%fld_Tmps%TMP_Mapping.FIL" OPEN
  
COMM *** Update the fields linkage information into Data mapping Table, So the user can reuse the mapping information next time ***

v_fd="fdvm"
v_dm_tbl_Nme="DM_%trg_VMF%"
v_src_tbl_Nme='%src_VMF%'
DO LE004_Upt_Mapping

DELETE FORMAT TMP_Mapping OK
DELETE "%fld_Tmps%TMP_Mapping.FIL" OK
^BATCH    B0104_Loop_Match_Vnd               
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - Vendor Master File 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


FLAG_Show=F

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data File Setup - Vendor Master File" WIDTH 971 HEIGHT 653 ) (BUTTONSET TITLE "&OK;&Cancel" AT 734 556 DEFAULT 1 ) (TEXT TITLE "Please link the fields from source file to  standard file - Vendor Master File" AT 48 28 WIDTH 606 CENTER ) (ITEM TITLE "C" TO "fdvm_Vndr_ID" AT 305 135 WIDTH 178 DEFAULT "%fdvm_Vndr_ID%" ) (TEXT TITLE "Vendor Number / Supplier Number *" AT 39 136 WIDTH 240 RIGHT ) (ITEM TITLE "C" TO "fdvm_Vndr_Nme" AT 305 185 WIDTH 178 DEFAULT "%fdvm_Vndr_Nme%" ) (TEXT TITLE "Vendor Name / Supplier Name *" AT 37 186 WIDTH 240 RIGHT ) (ITEM TITLE "NC" TO "fdvm_ABN" AT 305 209 WIDTH 179 DEFAULT "%fdvm_ABN%" ) (TEXT TITLE "Vendor ABN / Vendor TAX Identifier *" AT 36 209 WIDTH 240 HEIGHT 20 RIGHT ) (ITEM TITLE "NC" TO "fdvm_Vndr_Sts" AT 305 234 WIDTH 179 DEFAULT "%fdvm_Vndr_Sts%" ) (TEXT TITLE "Vendor Status *" AT 36 236 WIDTH 240 RIGHT ) (ITEM TITLE "CD" TO "fdvm_Vndr_InvlDt" AT 305 260 WIDTH 179 DEFAULT "%fdvm_Vndr_InvlDt%" ) (CHECKBOX TITLE "To exit/Escape" TO "exit" AT 728 609 WIDTH 100 ) (TEXT TITLE "Standard Table Fields" AT 168 76 ) (TEXT TITLE "Source Table Fields" AT 336 76 ) (TEXT TITLE "Vendor Type" AT 36 287 WIDTH 240 RIGHT ) (TEXT TITLE "Vendor Address Type" AT 36 308 WIDTH 240 RIGHT ) (TEXT TITLE "Address 1 *" AT 36 332 WIDTH 240 RIGHT ) (TEXT TITLE "Address 2" AT 37 357 WIDTH 240 RIGHT ) (TEXT TITLE "Address 3" AT 35 382 WIDTH 240 RIGHT ) (TEXT TITLE "City" AT 32 405 WIDTH 240 RIGHT ) (TEXT TITLE "State" AT 32 433 WIDTH 240 RIGHT ) (TEXT TITLE "Post Code" AT 36 458 WIDTH 240 RIGHT ) (TEXT TITLE "Telephone 1" AT 32 505 WIDTH 240 RIGHT ) (TEXT TITLE "Telephone 2" AT 28 528 WIDTH 240 RIGHT ) (TEXT TITLE "Telephone 3" AT 29 555 WIDTH 240 RIGHT ) (TEXT TITLE "Fax" AT 28 579 WIDTH 240 RIGHT ) (TEXT TITLE "Vendor Status Changed Date / Inactive Date" AT 11 262 WIDTH 267 RIGHT ) (TEXT TITLE "Payment Term" AT 32 605 WIDTH 240 RIGHT ) (TEXT TITLE "Modified Date" AT 495 138 WIDTH 180 RIGHT ) (ITEM TITLE "C" TO "fdvm_Vndr_Typ" AT 305 284 WIDTH 179 DEFAULT "%fdvm_Vndr_Typ%" ) (ITEM TITLE "C" TO "fdvm_Vndr_Add_Typ" AT 305 307 WIDTH 179 DEFAULT "%fdvm_Vndr_Add_Typ%" ) (ITEM TITLE "C" TO "fdvm_ADD1" AT 305 332 WIDTH 179 DEFAULT "%fdvm_ADD1%" ) (ITEM TITLE "C" TO "fdvm_ADD2" AT 305 356 WIDTH 179 DEFAULT "%fdvm_ADD2%" ) (ITEM TITLE "C" TO "fdvm_ADD3" AT 305 382 WIDTH 179 DEFAULT "%fdvm_ADD3%" ) (ITEM TITLE "C" TO "fdvm_City" AT 305 408 WIDTH 179 DEFAULT "%fdvm_City%" ) (ITEM TITLE "C" TO "fdvm_State" AT 305 434 WIDTH 179 DEFAULT "%fdvm_State%" ) (ITEM TITLE "C" TO "fdvm_Pcode" AT 305 458 WIDTH 179 DEFAULT "%fdvm_Pcode%" ) (ITEM TITLE "C" TO "fdvm_Cntry" AT 305 481 WIDTH 179 DEFAULT "%fdvm_Cntry%" ) (ITEM TITLE "C" TO "fdvm_TEL1" AT 305 504 WIDTH 179 DEFAULT "%fdvm_TEL1%" ) (ITEM TITLE "C" TO "fdvm_TEL2" AT 305 528 WIDTH 179 DEFAULT "%fdvm_TEL2%" ) (ITEM TITLE "C" TO "fdvm_TEL3" AT 305 554 WIDTH 179 DEFAULT "%fdvm_TEL3%" ) (ITEM TITLE "C" TO "fdvm_FAX" AT 305 579 WIDTH 179 DEFAULT "%fdvm_FAX%" ) (ITEM TITLE "C" TO "fdvm_Pymnt_Trm" AT 305 604 WIDTH 179 DEFAULT "%fdvm_Pymnt_Trm%" ) (ITEM TITLE "DC" TO "fdvm_Modf_Dt" AT 700 137 WIDTH 179 DEFAULT "%fdvm_Modf_Dt%" ) (TEXT TITLE "Country" AT 31 481 WIDTH 240 RIGHT ) (TEXT TITLE "Source Table Name " AT 624 28 RIGHT ) (TEXT TITLE "%src_VMF%" AT 780 28 WIDTH 162 ) (TEXT TITLE "Character Spare Field 1" AT 495 212 WIDTH 180 RIGHT ) (TEXT TITLE "Character Spare Field 2" AT 495 239 WIDTH 180 RIGHT ) (TEXT TITLE "Character Spare Field 3" AT 495 264 WIDTH 180 RIGHT ) (TEXT TITLE "Character Spare Field 4" AT 495 291 WIDTH 180 RIGHT ) (TEXT TITLE "Character Spare Field 5" AT 495 313 WIDTH 180 RIGHT ) (TEXT TITLE "Standard Table Fields" AT 540 76 CENTER ) (TEXT TITLE "Source Table Fields" AT 708 76 CENTER ) (ITEM TITLE "C" TO "fdvm_Cha_Field1" AT 699 209 WIDTH 178 DEFAULT "%fdvm_Cha_Field1%" ) (ITEM TITLE "C" TO "fdvm_Cha_Field2" AT 699 235 WIDTH 178 DEFAULT "%fdvm_Cha_Field2%" ) (ITEM TITLE "C" TO "fdvm_Cha_Field3" AT 699 261 WIDTH 178 DEFAULT "%fdvm_Cha_Field3%" ) (ITEM TITLE "C" TO "fdvm_Cha_Field4" AT 699 286 WIDTH 178 DEFAULT "%fdvm_Cha_Field4%" ) (ITEM TITLE "C" TO "fdvm_Cha_Field5" AT 699 310 WIDTH 178 DEFAULT "%fdvm_Cha_Field5%" ) (TEXT TITLE "Numeric Spare Field 1" AT 495 338 WIDTH 180 RIGHT ) (TEXT TITLE "Numeric Spare Field 2" AT 495 359 WIDTH 180 RIGHT ) (TEXT TITLE "Numeric Spare Field 3" AT 495 385 WIDTH 180 RIGHT ) (TEXT TITLE "Numeric Spare Field 4" AT 495 411 WIDTH 180 RIGHT ) (TEXT TITLE "Numeric Spare Field 5" AT 495 434 WIDTH 180 RIGHT ) (TEXT TITLE "Date Spare Field 1" AT 495 461 WIDTH 180 RIGHT ) (TEXT TITLE "Date Spare Field 2" AT 495 488 WIDTH 180 RIGHT ) (TEXT TITLE "Date Spare Field 3" AT 495 515 WIDTH 180 RIGHT ) (ITEM TITLE "NC" TO "fdvm_Num_Field1" AT 699 335 WIDTH 178 DEFAULT "%fdvm_Num_Field1%" ) (ITEM TITLE "NC" TO "fdvm_Num_Field2" AT 699 358 WIDTH 178 DEFAULT "%fdvm_Num_Field2%" ) (ITEM TITLE "NC" TO "fdvm_Num_Field3" AT 699 383 WIDTH 178 DEFAULT "%fdvm_Num_Field3%" ) (ITEM TITLE "NC" TO "fdvm_Num_Field4" AT 699 408 WIDTH 178 DEFAULT "%fdvm_Num_Field4%" ) (ITEM TITLE "NC" TO "fdvm_Num_Field5" AT 699 432 WIDTH 178 DEFAULT "%fdvm_Num_Field5%" ) (ITEM TITLE "DC" TO "fdvm_Dt_Field1" AT 699 457 WIDTH 178 DEFAULT "%fdvm_Dt_Field1%" ) (ITEM TITLE "DC" TO "fdvm_Dt_Field2" AT 699 483 WIDTH 178 DEFAULT "%fdvm_Dt_Field2%" ) (ITEM TITLE "DC" TO "fdvm_Dt_Field3" AT 699 511 WIDTH 178 DEFAULT "%fdvm_Dt_Field3%" ) (ITEM TITLE "C" TO "fdvm_Co" AT 305 160 WIDTH 178 DEFAULT "%fdvm_Co%" ) (ITEM TITLE "C" TO "fdvm_Email1" AT 700 160 WIDTH 178 DEFAULT "%fdvm_Email1%" ) (ITEM TITLE "C" TO "fdvm_Email2" AT 700 184 WIDTH 178 DEFAULT "%fdvm_Email1%" ) (TEXT TITLE "Company" AT 95 162 WIDTH 180 RIGHT ) (TEXT TITLE "Email 1" AT 495 161 WIDTH 180 RIGHT ) (TEXT TITLE "Email 2" AT 495 184 WIDTH 180 RIGHT ) (TEXT TITLE "Created Date" AT 495 114 WIDTH 180 RIGHT ) (ITEM TITLE "DC" TO "fdvm_Created_Dt" AT 700 111 WIDTH 178 DEFAULT "%fdvm_Created_Dt%" ) (ITEM TITLE "C" TO "fdvm_Vndr_Site_ID" AT 305 111 WIDTH 178 DEFAULT "%fdvm_Vndr_Site_ID%" ) (TEXT TITLE "Vendor ID / Supplier Unique Key*" AT 26 113 WIDTH 253 RIGHT )

IF exit=T ESCAPE

ErrMsg=""
IF MATCH(fdvm_Vndr_Site_ID,"_empty_"," ") ErrMsg="Vendor Unique ID"
IF MATCH(fdvm_Vndr_ID,"_empty_"," ") ErrMsg="Vendor Number"
IF MATCH(fdvm_Vndr_Nme,"_empty_"," ") ErrMsg=ErrMsg+" Vendor Name"
IF MATCH(fdvm_ABN,"_empty_"," ") ErrMsg=ErrMsg+" ABN- Australian Business Number"
IF MATCH(fdvm_Vndr_Sts,"_empty_"," ") ErrMsg=ErrMsg+" Vendor Status"
IF MATCH(fdvm_ADD1,"_empty_"," ") ErrMsg=ErrMsg+" Address 1"
COMM IF MATCH(fdvm_TEL1,"_empty_"," ") ErrMsg=ErrMsg+" Telephone 1"

%v_CCMJob% IF ALLTRIM(ErrMsg)<>"" PAUSE "Please Select a field for "+ErrMsg
^BATCH    B0201_Select_Vnd_Add               
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Convert, Link Fields from Source Data To Target Working File Table's Fields: Vendor Addresses/Sites
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF
FLAG_Show=T
FLAG=T

DO B0202_Loop_Sel_Add WHILE ISBLANK(src_VMF_Add)= T OR FLAG_Show=T

DO B0203_Match_Vnd_Add_Flds

IF exit=T ESCAPE

SET SAFETY ON


^BATCH    B0202_Loop_Sel_Add                 
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - Select the source table that you want to link to Vendor Sites / Address
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


FLAG_Show=F
SET FOLDER /%fld_Tmps%

COMM *** List Table Names ***
CLOSE
DIR %fld_Sources%*.fil SUB TO "%fld_Tmps%CVT_Tables"

OPEN CVT_Tables
DELETE FIELD Table_Name OK
DEFINE FIELD Table_Name COMPUTED ALLTRIM(SPLIT(SPLIT(FILE_NAME,"\",OCCURS(FILE_NAME,"\")+1),".",1))

v_Table_Names=BLANKS(10000)
v_counter=0
COUNT

GROUP IF NOT ISBLANK(Table_Name)
 LOOP WHILE v_counter<=COUNT1
  v_Table_Names = ALLTRIM(v_Table_Names) + ALLTRIM(RECOFFSET(Table_Name,v_counter)) + ";"
  v_counter = v_counter + 1
 END
END

v_Table_Names=REPLACE(ALLTRIM(REPLACE(v_Table_Names,";"," "))," ",";")

LOCATE IF Table_Name="%src_VMF_Add%"
v_default=RECNO()

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data Mapping - Vendor Addresses / Sites" WIDTH 523 HEIGHT 167 ) (BUTTONSET TITLE "&OK;&Cancel" AT 372 72 DEFAULT 1 ) (DROPDOWN TITLE "%v_Table_Names%" TO "src_VMF_Add" AT 48 72 WIDTH 234 HEIGHT 126 DEFAULT %v_default%) (TEXT TITLE "Select a source table match to the target table - Vendor Addresses / Sites" AT 48 40 )

%v_CCMJob% IF ISBLANK(src_VMF_Add)= T PAUSE "Please select a file that maps to Vendor Address / Sites"




^BATCH    B0203_Match_Vnd_Add_Flds           
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Link Fields from Source Data To Target Working File Table's Fields: Vendor Addresses/Sites
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF
exit=F
FLAG_Show=T

OPEN %src_VMF_Add%
DELETE FIELD _empty_ OK
DEFINE FIELD _empty_ COMPUTED ""

DO B0204_Loop_Match_Vnd_Add WHILE FLAG_Show=T OR MATCH(fdad_Vndr_Site_ID,"_empty"," ") OR MATCH(fdad_Vndr_ID,"_empty"," ") OR MATCH(fdad_ADD1,"_empty"," ")

IF exit=T ESCAPE

COMM *** Extracting fields to master table from Source ***

v_Flds_Extract="ALLTRIM(%fdad_Vndr_Site_ID%) AS 'Vndr_Site_ID' ALLTRIM(%fdad_Vndr_ID%) AS 'Vndr_ID' ALLTRIM(%fdad_ADD1%) AS 'ADD1'"

IF NOT MATCH(fdad_Vndr_Add_Typ,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdad_Vndr_Add_Typ%) AS 'Vndr_Add_Typ'"
IF MATCH(fdad_Vndr_Add_Typ,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(60) AS 'Vndr_Add_Typ'"

IF NOT MATCH(fdad_ADD2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdad_ADD2%) AS 'ADD2'"
IF MATCH(fdad_ADD2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(60) AS 'ADD2'"

IF NOT MATCH(fdad_ADD3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdad_ADD3%) AS 'ADD3'"
IF MATCH(fdad_ADD3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(60) AS 'ADD3'"

IF NOT MATCH(fdad_City,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdad_City%) AS 'City'"
IF MATCH(fdad_City,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(60) AS 'City'"

IF NOT MATCH(fdad_State,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdad_State%) AS 'State'"
IF MATCH(fdad_State,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(60) AS 'State'"

IF NOT MATCH(fdad_Cntry,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdad_Cntry%) AS 'Cntry'"
IF MATCH(fdad_Cntry,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(60) AS 'Cntry'"

COMM EXTRACT FIELDS v_Flds_Extract TO "%fld_Workings%%trg_VMF_Add%.FIL"

DELETE FIELD _empty_ OK
  
EXTRACT FIELDS %v_Flds_Extract% TO "%fld_Tmps%TMP_Mapping.FIL" OPEN
  
COMM *** Update the fields linkage information into Data mapping Table, So the user can reuse the mapping information next time ***

v_fd="fdad"
v_dm_tbl_Nme="DM_%trg_VMF_Add%"
v_src_tbl_Nme='%src_VMF_Add%'
DO LE004_Upt_Mapping

DELETE FORMAT TMP_Mapping OK
DELETE "%fld_Tmps%TMP_Mapping.FIL" OK

^BATCH    B0204_Loop_Match_Vnd_Add           
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - Vendor Sites/Address
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


FLAG_Show=F

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data File Setup - Vendor Addresses / Sites" WIDTH 835 HEIGHT 404 ) (BUTTONSET TITLE "&OK;&Cancel" AT 648 252 DEFAULT 1 ) (TEXT TITLE "Please link the fields from source file to  standard file: Vendor Address" AT 168 28 WIDTH 488 CENTER ) (ITEM TITLE "C" TO "fdad_Vndr_ID" AT 360 132 WIDTH 178 DEFAULT "%fdad_Vndr_ID%" ) (TEXT TITLE "Vendor Number / Supplier Number *" AT 36 136 WIDTH 280 RIGHT ) (CHECKBOX TITLE "To exit/Escape" TO "exit" AT 648 312 WIDTH 120 ) (TEXT TITLE "Standard Table Fields" AT 168 76 ) (TEXT TITLE "Source Table Fields" AT 408 76 ) (TEXT TITLE "Vendor Address Type" AT 36 160 WIDTH 280 RIGHT ) (TEXT TITLE "Address 1 *" AT 36 184 WIDTH 280 RIGHT ) (TEXT TITLE "Address 2" AT 36 208 WIDTH 280 RIGHT ) (TEXT TITLE "Address 3" AT 36 232 WIDTH 280 RIGHT ) (TEXT TITLE "City" AT 36 256 WIDTH 280 RIGHT ) (TEXT TITLE "State" AT 36 280 WIDTH 280 RIGHT ) (TEXT TITLE "Post Code" AT 36 304 WIDTH 280 RIGHT ) (ITEM TITLE "C" TO "fdad_Vndr_Add_Typ" AT 360 156 WIDTH 179 DEFAULT "%fdad_Vndr_Add_Typ%" ) (ITEM TITLE "C" TO "fdad_ADD1" AT 360 180 WIDTH 179 DEFAULT "%fdad_ADD1%" ) (ITEM TITLE "C" TO "fdad_ADD2" AT 360 204 WIDTH 179 DEFAULT "%fdad_ADD2%" ) (ITEM TITLE "C" TO "fdad_ADD3" AT 360 228 WIDTH 179 DEFAULT "%fdad_ADD3%" ) (ITEM TITLE "C" TO "fdad_City" AT 360 252 WIDTH 179 DEFAULT "%fdad_City%" ) (ITEM TITLE "C" TO "fdad_State" AT 360 276 WIDTH 179 DEFAULT "%fdad_State%" ) (ITEM TITLE "C" TO "fdad_Pcode" AT 360 300 WIDTH 179 DEFAULT "%fdad_Pcode%" ) (ITEM TITLE "C" TO "fdad_Cntry" AT 360 324 WIDTH 179 DEFAULT "%fdad_Cntry%" ) (TEXT TITLE "Country" AT 36 328 WIDTH 280 RIGHT ) (TEXT TITLE "Source Table Name " AT 636 76 ) (TEXT TITLE "%src_VMF_Add%" AT 636 112 WIDTH 136 ) (ITEM TITLE "C" TO "fdad_Vndr_Site_ID" AT 360 108 WIDTH 178 DEFAULT "%fdad_Vndr_Site_ID%" ) (TEXT TITLE "Vendor ID / Supplier Unqiue Key*" AT 72 112 WIDTH 240 RIGHT )

IF exit=T ESCAPE

ErrMsg=""
IF MATCH(fdad_Vndr_Site_ID," ","_empty_") ErrMsg="Vendor Unique Key"
IF MATCH(fdad_Vndr_ID," ","_empty_") ErrMsg="Vendor Number"
IF MATCH(fdad_ADD1," ","_empty_")  ErrMsg=ErrMsg+" Address 1"

%v_CCMJob% IF ALLTRIM(ErrMsg)<>"" PAUSE "Please Select a field for "+ErrMsg
^BATCH    B0301_Select_Vnd_BK                
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Convert, Link Fields from Source Data To Target Working File Table's Fields: Vendor Bank Account
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF

FLAG_Show=T

DO B0302_Loop_Sel_BK WHILE ISBLANK(src_VMF_BK)= T OR FLAG_Show=T

DO B0303_Match_Vnd_BK_Flds

IF exit=T ESCAPE

SET SAFETY ON


^BATCH    B0302_Loop_Sel_BK                  
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - Select the source table that you want to link to Vendor Bank Account
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


FLAG_Show=F
SET FOLDER /%fld_Tmps%

COMM *** List Table Names ***
CLOSE
DIR %fld_Sources%*.fil SUB TO "%fld_Tmps%CVT_Tables"

OPEN CVT_Tables
DELETE FIELD Table_Name OK
DEFINE FIELD Table_Name COMPUTED ALLTRIM(SPLIT(SPLIT(FILE_NAME,"\",OCCURS(FILE_NAME,"\")+1),".",1))

v_Table_Names=BLANKS(1000)
v_counter=0
v_Default=0
COUNT

GROUP IF NOT ISBLANK(Table_Name)
 LOOP WHILE v_counter<=COUNT1
  v_Table_Names = ALLTRIM(v_Table_Names) + ALLTRIM(RECOFFSET(Table_Name,v_counter))+";"
  v_counter = v_counter + 1
 END
END

v_Table_Names=REPLACE(ALLTRIM(REPLACE(v_Table_Names,";"," "))," ",";")


LOCATE IF Table_Name="%src_VMF_BK%"
v_default=RECNO()

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data Mapping - Vendor Bank ACcount" WIDTH 523 HEIGHT 167 ) (BUTTONSET TITLE "&OK;&Cancel" AT 372 72 DEFAULT 1 ) (DROPDOWN TITLE "%v_Table_Names%" TO "src_VMF_BK" AT 48 72 WIDTH 234 HEIGHT 126 DEFAULT %v_Default%) (TEXT TITLE "Select a source table match to the target table - Vendor Bank Account" AT 48 40)

%v_CCMJob% IF ISBLANK(src_VMF_BK)= T PAUSE "Please select a file that maps to Vendor Address / Sites"





^BATCH    B0303_Match_Vnd_BK_Flds            
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Link Fields from Source Data To Target Working File Table's Fields: Vendor Bank Account
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF
exit=F
FLAG_Show=T

OPEN %src_VMF_BK%

DELETE FIELD _empty_ OK
DEFINE FIELD _empty_ COMPUTED ""

DO B0304_Loop_Match_Vnd_bk WHILE FLAG_Show=T OR MATCH(fdbk_Vndr_Site_ID,"_empty_"," ") OR MATCH(fdbk_Vndr_ID,"_empty_"," ") OR MATCH(fdbk_Bnk_Acc_Num,"_empty"," ")

IF exit=T ESCAPE

COMM *** Extracting fields to master table from Source ***

v_Flds_Extract="ALLTRIM(%fdbk_Vndr_Site_ID%) AS 'Vndr_Site_ID' ALLTRIM(%fdbk_Vndr_ID%) AS 'Vndr_ID' ALLTRIM(%fdbk_BSB%) AS 'BSB' ALLTRIM(%fdbk_Bnk_Acc_Num%) AS 'Bnk_Acc_Num'"

IF NOT MATCH(fdbk_BSB_NAME,"_empty"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdbk_BSB_NAME%) AS 'BSB_Name'"
IF MATCH(fdbk_BSB_NAME,"_empty"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(60) AS 'BSB_Name'"

IF NOT MATCH(fdbk_Bnk_Acc_Name,"_empty"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdbk_Bnk_Acc_Name%) AS 'Bnk_Acc_Name'"
IF MATCH(fdbk_Bnk_Acc_Name,"_empty"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(60) AS 'Bnk_Acc_Name'"

IF NOT MATCH(fdbk_Bnk_Acc_Type,"_empty"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdbk_Bnk_Acc_Type%) AS 'Bnk_Acc_Type'"
IF MATCH(fdbk_Bnk_Acc_Type,"_empty"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(60) AS 'Bnk_Acc_Type'"

IF NOT MATCH(fdbk_Chg_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdvm_Modf_Dt% AS 'Chg_Dt'"
IF MATCH(fdbk_Chg_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(10) AS 'Chg_Dt'"

DELETE FIELD _empty_ OK 

EXTRACT FIELDS %v_Flds_Extract% TO "%fld_Tmps%TMP_Mapping.FIL" OPEN
  
COMM *** Update the fields linkage information into Data mapping Table, So the user can reuse the mapping information next time ***

v_fd="fdbk"
v_dm_tbl_Nme="DM_%trg_VMF_BK%"
v_src_tbl_Nme='%src_VMF_BK%'
DO LE004_Upt_Mapping

DELETE FORMAT TMP_Mapping OK
DELETE "%fld_Tmps%TMP_Mapping.FIL" OK
^BATCH    B0304_Loop_Match_Vnd_BK            
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - Vendor Bank Account
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


FLAG_Show=F

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data File Setup - Vendor Bank Account" WIDTH 830 HEIGHT 337 ) (BUTTONSET TITLE "&OK;&Cancel" AT 612 168 DEFAULT 1 ) (TEXT TITLE "Please link the fields from source file to  standard file - Vendor Bank Account " AT 144 28 WIDTH 488 CENTER ) (ITEM TITLE "C" TO "fdbk_Vndr_ID" AT 324 132 WIDTH 178 DEFAULT "%fdbk_Vndr_ID%" ) (TEXT TITLE "Vendor Number / Supplier Number *" AT 72 136 WIDTH 223 RIGHT ) (CHECKBOX TITLE "To exit/Escape" TO "exit" AT 600 228 WIDTH 100 ) (TEXT TITLE "Standard Table Fields" AT 168 76 ) (TEXT TITLE "Source Table Fields" AT 336 76 ) (TEXT TITLE "BSB Code*" AT 96 160 WIDTH 197 RIGHT ) (TEXT TITLE "BSB Name" AT 48 208 WIDTH 240 RIGHT ) (TEXT TITLE "Bank Account Number*" AT 60 184 WIDTH 231 RIGHT ) (TEXT TITLE "Bank Account Name" AT 48 232 WIDTH 240 RIGHT ) (ITEM TITLE "C" TO "fdbk_BSB" AT 324 156 WIDTH 179 DEFAULT "%fdbk_BSB%" ) (ITEM TITLE "C" TO "fdbk_Bnk_Acc_Num" AT 324 180 WIDTH 179 DEFAULT "%fdbk_Bnk_Acc_Num%" ) (ITEM TITLE "C" TO "fdbk_BSB_NAME" AT 324 204 WIDTH 179 DEFAULT "%fdbk_BSB_NAME%" ) (ITEM TITLE "C" TO "fdbk_Bnk_Acc_Name" AT 324 228 WIDTH 179 DEFAULT "%fdbk_Bnk_Acc_Name%" ) (TEXT TITLE "Source Table Name " AT 588 76 CENTER ) (TEXT TITLE "%src_VMF_BK%" AT 552 100 WIDTH 208 CENTER ) (ITEM TITLE "C" TO "fdbk_Vndr_Site_ID" AT 324 108 WIDTH 178 DEFAULT "%fdbk_Vndr_Site_ID%" ) (TEXT TITLE "Vendor ID / Supplier Unique Key*" AT 48 112 WIDTH 240 RIGHT ) (TEXT TITLE "Bank Account Type" AT 108 256 WIDTH 180 RIGHT ) (ITEM TITLE "C" TO "fdbk_Bnk_Acc_Type" AT 324 252 WIDTH 179 DEFAULT "%fdbk_Bnk_Acc_Type%" ) (TEXT TITLE "Changed Date" AT 108 280 WIDTH 175 RIGHT ) (ITEM TITLE "DC" TO "fdbk_Chg_Dt" AT 324 276 WIDTH 179 DEFAULT "%fdbk_Chg_Dt%" )

IF exit=T ESCAPE

ErrMsg=""
IF MATCH(fdbk_Vndr_Site_ID,"_empty"," ") ErrMsg="Vendor Unique Key"
IF MATCH(fdbk_Vndr_ID,"_empty"," ") ErrMsg="Vendor Number"
IF MATCH(fdbk_Bnk_Acc_Num,"_empty"," ") ErrMsg=ErrMsg+" Bank Account Number"

%v_CCMJob% IF ALLTRIM(ErrMsg)<>"" PAUSE "Please Select a field for " + ErrMsg
^BATCH    B0401_Select_OTV                   
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Convert, Link Fields from Source Data To Target Working File Table's Fields: One time vendor
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF
FLAG_Show=T

DO B0402_Loop_Sel_OTV WHILE ISBLANK(src_VMF_OTV)= T OR FLAG_Show=T

DO B0403_Match_OTV_Flds

IF exit=T ESCAPE


SET SAFETY ON


^BATCH    B0402_Loop_Sel_OTV                 
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - Select the source table that you want to link to One time vendor
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


FLAG_Show=F
SET FOLDER /%fld_Tmps%


COMM *** List Table Names ***
CLOSE
DIR %fld_Sources%*.fil SUB TO "%fld_Tmps%CVT_Tables"

OPEN CVT_Tables
DELETE FIELD Table_Name OK
DEFINE FIELD Table_Name COMPUTED ALLTRIM(SPLIT(SPLIT(FILE_NAME,"\",OCCURS(FILE_NAME,"\")+1),".",1))

v_Table_Names=BLANKS(1000)
v_counter=0
COUNT

GROUP IF NOT ISBLANK(Table_Name)
 LOOP WHILE v_counter<=COUNT1
  v_Table_Names = ALLTRIM(v_Table_Names) + ALLTRIM(RECOFFSET(Table_Name,v_counter)) + ";"
  v_counter = v_counter + 1
 END
END

v_Table_Names=REPLACE(ALLTRIM(REPLACE(v_Table_Names,";"," "))," ",";")

LOCATE IF Table_Name="%src_VMF_OTV%"
v_default=RECNO()

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data Mapping - One Time Vendor" WIDTH 523 HEIGHT 167 ) (BUTTONSET TITLE "&OK;&Cancel" AT 372 72 DEFAULT 1 ) (DROPDOWN TITLE "%v_Table_Names%" TO "src_VMF_OTV" AT 48 72 WIDTH 234 HEIGHT 126 DEFAULT %v_default%) (TEXT TITLE "Select a source table match to the target table - One Time Vendor" AT 48 40 )

%v_CCMJob% IF ISBLANK(src_VMF_OTV)= T PAUSE "Please select a file that maps to One Time Vendor"




^BATCH    B0403_Match_OTV_Flds               
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Link Fields from Source Data To Target Working File Table's Fields: One time vendor
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF
exit=F
FLAG_Show=T

OPEN %src_VMF_OTV%

DELETE FIELD _empty_ OK
DEFINE FIELD _empty_ COMPUTED ""

DO B0404_Loop_Match_OTV WHILE FLAG_Show=T OR MATCH(fdot_Vndr_ID,"_empty"," ") OR MATCH(fdot_Vndr_Site_ID,"_empty"," ")

IF exit=T ESCAPE

COMM *** Extracting fields to master table from Source ***

v_Flds_Extract="ALLTRIM(%fdot_Vndr_Site_ID%) AS 'Vndr_Site_ID' ALLTRIM(%fdot_Vndr_ID%) AS 'Vndr_ID'"

IF NOT MATCH(fdot_Vndr_Nme,"_empty"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdot_Vndr_Nme%) AS 'Vndr_Nme'"
IF MATCH(fdot_Vndr_Nme,"_empty"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(65) AS 'Vndr_Nme'"

DELETE FIELD _empty_ OK 
  
EXTRACT FIELDS %v_Flds_Extract% TO "%fld_Tmps%TMP_Mapping.FIL" OPEN
 
COMM *** Update the fields linkage information into Data mapping Table, So the user can reuse the mapping information next time ***

v_fd="fdot"
v_dm_tbl_Nme="DM_%trg_VMF_OTV%"
v_src_tbl_Nme='%src_VMF_OTV%'
DO LE004_Upt_Mapping

DELETE FORMAT TMP_Mapping OK
DELETE "%fld_Tmps%TMP_Mapping.FIL" OK
^BATCH    B0404_Loop_Match_OTV               
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - One-time vendor
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


FLAG_Show=F

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data File Setup - Vendor Bank Account" WIDTH 814 HEIGHT 269 ) (BUTTONSET TITLE "&OK;&Cancel" AT 636 144 DEFAULT 1 ) (TEXT TITLE "Please link the fields from source file to  standard file - One Time Vendor" AT 168 28 WIDTH 488 CENTER ) (ITEM TITLE "C" TO "fdot_Vndr_ID" AT 336 132 WIDTH 178 DEFAULT "%fdot_Vndr_ID%" ) (TEXT TITLE "Vendor Number *" AT 60 136 WIDTH 240 RIGHT ) (CHECKBOX TITLE "To exit/Escape" TO "exit" AT 636 216 WIDTH 100 ) (TEXT TITLE "Standard Table Fields" AT 168 76 ) (TEXT TITLE "Source Table Fields" AT 360 76 ) (TEXT TITLE "Source Table Name " AT 612 76 ) (TEXT TITLE "%src_VMF_OTV%" AT 612 100 ) (TEXT TITLE "Vendor ID / Supplier Unique Key*" AT 60 112 WIDTH 240 RIGHT ) (ITEM TITLE "C" TO "fdot_Vndr_Site_ID" AT 336 108 WIDTH 178 DEFAULT "%fdot_Vndr_Site_ID%" ) (TEXT TITLE "Vendor Name" AT 96 160 WIDTH 198 RIGHT ) (ITEM TITLE "C" TO "fdot_Vndr_Nme" AT 336 156 WIDTH 178 DEFAULT "%fdot_Vndr_Nme%" )

IF exit=T ESCAPE

ErrMsg=""
IF ISBLANK(fdot_Vndr_Site_ID)=T ErrMsg="Vendor Unique Key"

IF ISBLANK(fdot_Vndr_ID)=T ErrMsg="Vendor Number"

%v_CCMJob% IF ALLTRIM(ErrMsg)<>"" PAUSE "Please Select a field for " + ErrMsg
^BATCH    B0501_Select_GL                    
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Convert, Link Fields from Source Data To Target Working File Table's Fields: Grey List
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF
FLAG_Show=T

DO B0502_Loop_Sel_GL WHILE ISBLANK(src_VMF_GL)= T OR FLAG_Show=T

DO B0503_Match_GL_Flds

IF exit=T ESCAPE


SET SAFETY ON


^BATCH    B0502_Loop_Sel_GL                  
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - Select the source table that you want to link to Grey List
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


FLAG_Show=F
SET FOLDER /%fld_Tmps%

COMM *** List Table Names ***
CLOSE
DIR %fld_Sources%*.fil SUB TO "%fld_Tmps%CVT_Tables"

OPEN CVT_Tables
DELETE FIELD Table_Name OK
DEFINE FIELD Table_Name COMPUTED ALLTRIM(SPLIT(SPLIT(FILE_NAME,"\",OCCURS(FILE_NAME,"\")+1),".",1))

v_Table_Names=BLANKS(1000)
v_counter=0
COUNT

GROUP IF NOT ISBLANK(Table_Name)
 LOOP WHILE v_counter<=COUNT1
  v_Table_Names = ALLTRIM(v_Table_Names) + ALLTRIM(RECOFFSET(Table_Name,v_counter)) + ";"
  v_counter = v_counter + 1
 END
END

v_Table_Names=REPLACE(ALLTRIM(REPLACE(v_Table_Names,";"," "))," ",";")

LOCATE IF Table_Name="%src_VMF_GL%"
v_default=RECNO()

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data Mapping - Grey List" WIDTH 523 HEIGHT 167 ) (BUTTONSET TITLE "&OK;&Cancel" AT 372 72 DEFAULT 1 ) (DROPDOWN TITLE "%v_Table_Names%" TO "src_VMF_GL" AT 48 72 WIDTH 234 HEIGHT 126 DEFAULT %v_default%) (TEXT TITLE "Select a source table match to the target table - Grey List" AT 48 40 )

%v_CCMJob% IF ISBLANK(src_VMF_GL)= T PAUSE "Please select a file that maps to Grey List"




^BATCH    B0503_Match_GL_Flds                
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Link Fields from Source Data To Target Working File Table's Fields: Grey List
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF
exit=F
FLAG_Show=T

OPEN %src_VMF_GL%

DELETE FIELD _empty_ OK
DEFINE FIELD _empty_ COMPUTED ""

DO B0504_Loop_Match_gl WHILE FLAG_Show=T OR MATCH(fdgl_Vndr_ID,"_empty"," ") OR MATCH(fdgl_Vndr_Site_ID,"_empty"," ") 

IF exit=T ESCAPE

COMM *** Extracting fields to master table from Source ***
COMM *** This way we avoid the need of using variables across all the scripts. ***

OPEN %src_VMF_GL%

v_Flds_Extract="ALLTRIM(%fdgl_Vndr_Site_ID%) AS 'Vndr_Site_ID' ALLTRIM(%fdgl_Vndr_ID%) AS 'Vndr_ID'"

IF NOT MATCH(fdgl_Vndr_Nme,"_empty"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdgl_Vndr_Nme%) AS 'Vndr_Nme'"
IF MATCH(fdgl_Vndr_Nme,"_empty"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(65) AS 'Bndr_Nme'"

DELETE FIELD _empty_ OK 
  
EXTRACT FIELDS %v_Flds_Extract% TO "%fld_Tmps%TMP_Mapping.FIL" OPEN
  
COMM *** Update the fields linkage information into Data mapping Table, So the user can reuse the mapping information next time ***

v_fd="fdgl"
v_dm_tbl_Nme="DM_%trg_VMF_GL%"
v_src_tbl_Nme='%src_VMF_GL%'
DO LE004_Upt_Mapping

DELETE FORMAT TMP_Mapping OK
DELETE "%fld_Tmps%TMP_Mapping.FIL" OK
^BATCH    B0504_Loop_Match_GL                
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - One-time vendor
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


FLAG_Show=F

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data File Setup - Grey List" WIDTH 814 HEIGHT 269 ) (BUTTONSET TITLE "&OK;&Cancel" AT 636 144 DEFAULT 1 ) (TEXT TITLE "Please link the fields from source file to  standard file - Grey List" AT 168 28 WIDTH 488 CENTER ) (ITEM TITLE "C" TO "fdgl_Vndr_ID" AT 348 132 WIDTH 178 DEFAULT "%fdgl_Vndr_ID%" ) (TEXT TITLE "Vendor Number *" AT 72 136 WIDTH 240 RIGHT ) (CHECKBOX TITLE "To exit/Escape" TO "exit" AT 636 204 WIDTH 100 ) (TEXT TITLE "Standard Table Fields" AT 168 76 ) (TEXT TITLE "Source Table Fields" AT 360 76 ) (TEXT TITLE "Source Table Name " AT 612 76 ) (TEXT TITLE "%src_VMF_GL%" AT 612 112 WIDTH 157 ) (TEXT TITLE "Vendor ID / Supplier Unique Key*" AT 72 112 WIDTH 240 RIGHT ) (ITEM TITLE "C" TO "fdgl_Vndr_Site_ID" AT 348 108 WIDTH 178 DEFAULT "%fdgl_Vndr_Site_ID%" ) (TEXT TITLE "Vendor Name" AT 132 160 WIDTH 178 RIGHT ) (ITEM TITLE "C" TO "fdgl_Vndr_Nme" AT 348 156 WIDTH 175 DEFAULT "%fdgl_Vndr_Nme%" )

IF exit=T ESCAPE

ErrMsg=""
IF MATCH(fdgl_Vndr_Site_ID,"_empty"," ") ErrMsg="Vendor Unique Key"

IF MATCH(fdgl_Vndr_ID,"_empty"," ") ErrMsg="Vendor Number"

%v_CCMJob% IF ALLTRIM(ErrMsg)<>"" PAUSE "Please Select a field for " + ErrMsg
^BATCH    B0601_Select_InterCo               
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Convert, Link Fields from Source Data To Target Working File Table's Fields: Inter Company
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF

DO B0602_Loop_Sel_InterCo WHILE ISBLANK(src_VMF_InterCo)= T

DO B0603_Match_InterCo_Flds

IF exit=T ESCAPE


SET SAFETY ON


^BATCH    B0602_Loop_Sel_InterCo             
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - Select the source table that you want to link to Inter Company
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


FLAG_Show=F
SET FOLDER /%fld_Tmps%

COMM *** List Table Names ***
CLOSE
DIR %fld_Sources%*.fil SUB TO "%fld_Tmps%CVT_Tables"

OPEN CVT_Tables
DELETE FIELD Table_Name OK
DEFINE FIELD Table_Name COMPUTED ALLTRIM(SPLIT(SPLIT(FILE_NAME,"\",OCCURS(FILE_NAME,"\")+1),".",1))

v_Table_Names=BLANKS(1000)
v_counter=0
COUNT

GROUP IF NOT ISBLANK(Table_Name)
 LOOP WHILE v_counter<=COUNT1
  v_Table_Names = ALLTRIM(v_Table_Names) + ALLTRIM(RECOFFSET(Table_Name,v_counter)) + ";"
  v_counter = v_counter + 1
 END
END

v_Table_Names=REPLACE(ALLTRIM(REPLACE(v_Table_Names,";"," "))," ",";")

LOCATE IF Table_Name="%src_VMF_InterCo%"
v_default=RECNO()

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data Mapping - Inter Company" WIDTH 523 HEIGHT 167 ) (BUTTONSET TITLE "&OK;&Cancel" AT 372 72 DEFAULT 1 ) (DROPDOWN TITLE "%v_Table_Names%" TO "src_VMF_InterCo" AT 48 72 WIDTH 234 HEIGHT 126 DEFAULT %v_default%) (TEXT TITLE "Select a source table match to the target table - Inter Company" AT 48 40 )

%v_CCMJob% IF ISBLANK(src_VMF_InterCo)= T PAUSE "Please select a file that maps to One Time Vendor"




^BATCH    B0603_Match_InterCo_Flds           
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Link Fields from Source Data To Target Working File Table's Fields: Inter Company
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF
exit=F
FLAG_Show=T

OPEN %src_VMF_InterCo%

DELETE FIELD _empty_ OK
DEFINE FIELD _empty_ COMPUTED ""

DO B0604_Loop_Match_InterCo WHILE FLAG_Show=T OR MATCH(fdic_Vndr_ID,"_empty"," ") OR MATCH(fdic_Vndr_Site_ID,"_empty"," ")

IF exit=T ESCAPE

COMM *** Extracting fields to master table from Source ***

OPEN %src_VMF_InterCo%

v_Flds_Extract="ALLTRIM(%fdic_Vndr_Site_ID%) AS 'Vndr_Site_ID' ALLTRIM(%fdic_Vndr_ID%) AS 'Vndr_ID'"

IF NOT MATCH(fdic_Vndr_Nme,"_empty"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdic_Vndr_Nme%) AS 'Vndr_Nme'"
IF MATCH(fdic_Vndr_Nme,"_empty"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(65) AS 'Bndr_Nme'"

DELETE FIELD _empty_ OK 
  
EXTRACT FIELDS %v_Flds_Extract% TO "%fld_Tmps%TMP_Mapping.FIL" OPEN
  
COMM *** Update the fields linkage information into Data mapping Table, So the user can reuse the mapping information next time ***

v_fd="fdic"
v_dm_tbl_Nme="DM_%trg_VMF_InterCo%"
v_src_tbl_Nme='%src_VMF_InterCo%'
DO LE004_Upt_Mapping

DELETE FORMAT TMP_Mapping OK
DELETE "%fld_Tmps%TMP_Mapping.FIL" OK

^BATCH    B0604_Loop_Match_InterCo           
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - Inter Company
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


FLAG_Show=F

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data File Setup - Inter Company" WIDTH 814 HEIGHT 269 ) (BUTTONSET TITLE "&OK;&Cancel" AT 636 144 DEFAULT 1 ) (TEXT TITLE "Please link the fields from source file to  standard file - Inter Company" AT 168 28 WIDTH 488 CENTER ) (ITEM TITLE "C" TO "fdic_Vndr_ID" AT 348 132 WIDTH 178 DEFAULT "%fdic_Vndr_ID%" ) (TEXT TITLE "Vendor Number *" AT 60 136 WIDTH 240 RIGHT ) (CHECKBOX TITLE "To exit/Escape" TO "exit" AT 636 216 WIDTH 100 ) (TEXT TITLE "Standard Table Fields" AT 168 76 ) (TEXT TITLE "Source Table Fields" AT 360 76 ) (TEXT TITLE "Source Table Name " AT 612 76 ) (TEXT TITLE "%src_VMF_InterCo%" AT 588 112 WIDTH 203 ) (TEXT TITLE "Vendor ID / Supplier Unique Key*" AT 60 112 WIDTH 240 RIGHT ) (ITEM TITLE "C" TO "fdic_Vndr_Site_ID" AT 348 108 WIDTH 178 DEFAULT "%fdic_Vndr_Site_ID%" ) (TEXT TITLE "Vendor Name" AT 84 160 WIDTH 207 RIGHT ) (ITEM TITLE "C" TO "fdic_Vndr_Nme" AT 348 156 WIDTH 178 DEFAULT "%fdic_Vndr_Nme%" )

IF exit=T ESCAPE

ErrMsg=""
IF MATCH(fdic_Vndr_Site_ID,"_empty"," ") ErrMsg="Vendor Unique Key"
IF MATCH(fdic_Vndr_ID,"_empty"," ") ErrMsg="Vendor Number"

%v_CCMJob% IF ALLTRIM(ErrMsg)<>"" PAUSE "Please Select a field for " + ErrMsg
^BATCH    B0701_Select_Inv                   
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Convert, Link Fields from Source Data To Target Working File Table's Fields: AP Invoices
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF
FLAG_Show=T

DO B0702_Loop_Sel_Inv WHILE ISBLANK(src_AP_Inv)= T OR FLAG_Show=T

DO B0703_Match_Inv_Mstr_Flds
IF exit=T ESCAPE


SET SAFETY ON

^BATCH    B0702_Loop_Sel_Inv                 
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - Select the source table that you want to link to the  AP Invoices
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


FLAG_Show=F
SET FOLDER /%fld_Tmps%

COMM *** List Table Names ***
CLOSE
DIR %fld_Sources%*.fil SUB TO "%fld_Tmps%CVT_Tables"

OPEN CVT_Tables
DELETE FIELD Table_Name OK
DEFINE FIELD Table_Name COMPUTED ALLTRIM(SPLIT(SPLIT(FILE_NAME,"\",OCCURS(FILE_NAME,"\")+1),".",1))

v_Table_Names=BLANKS(10000)
v_counter=0
COUNT

GROUP IF NOT ISBLANK(Table_Name)
 LOOP WHILE v_counter<=COUNT1
  v_Table_Names = ALLTRIM(v_Table_Names) + ALLTRIM(RECOFFSET(Table_Name,v_counter)) + ";"
  v_counter = v_counter + 1
 END
END

v_Table_Names=REPLACE(ALLTRIM(REPLACE(v_Table_Names,";"," "))," ",";")

LOCATE IF Table_Name="%src_AP_Inv%"
v_default=RECNO()

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data Mapping - Invoices" WIDTH 523 HEIGHT 167 ) (BUTTONSET TITLE "&OK;&Cancel" AT 372 72 DEFAULT 1 ) (DROPDOWN TITLE "%v_Table_Names%" TO "src_AP_Inv" AT 48 72 WIDTH 234 HEIGHT 126 DEFAULT %v_default%) (TEXT TITLE "Select a source table match to the target table - Invoices Table" AT 48 40 )

%v_CCMJob% IF ISBLANK(src_AP_Inv)= T PAUSE "Please select a file that maps to Invoices"


^BATCH    B0703_Match_Inv_Mstr_Flds          
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Link Fields from Source Data To Target Working File Table's Fields: Vendor Master File
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF
exit=F
FLAG_Show=T

OPEN %src_AP_Inv%

DELETE FIELD _empty_ OK
DEFINE FIELD _empty_ COMPUTED ""

DO B0704_Loop_Match_Inv WHILE FLAG_Show=T OR MATCH(fdap_Vndr_Site_ID,"_empty"," ") OR MATCH(fdap_Vndr_ID,"_empty"," ") OR MATCH(fdap_Vchr_ID,"_empty"," ") OR MATCH(fdap_Inv_Dt,"_empty"," ") OR MATCH(fdap_Inv_No,"_empty"," ") OR (MATCH(fdap_Inv_Amt,"_empty"," ") AND MATCH(fdap_Inv_Amt_Doc,"_empty"," ")))

IF exit=T ESCAPE

COMM *** Extracting fields to master table from Source ***

OPEN %src_AP_Inv%

v_Flds_Extract="ALLTRIM(%fdap_Vndr_Site_ID%) AS 'Vndr_Site_ID' ALLTRIM(%fdap_Vndr_ID%) AS 'Vndr_ID' ALLTRIM(%fdap_Vchr_ID%) AS 'Vchr_ID' ALLTRIM(%fdap_Inv_No%) AS 'Inv_No' %fdap_Inv_Dt% AS 'Inv_Dt'"

IF NOT MATCH(fdap_Inv_Amt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdap_Inv_Amt% AS 'Inv_Amt'"
IF MATCH(fdap_Inv_Amt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'Inv_Amt'"

IF NOT MATCH(fdap_Inv_Amt_Doc,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdap_Inv_Amt_Doc% AS 'Inv_Amt_Doc'"
IF MATCH(fdap_Inv_Amt_Doc,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'Inv_Amt_Doc'"

IF NOT MATCH(fdap_Doc_Typ,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdap_Doc_Typ% AS 'Doc_Typ'"
IF MATCH(fdap_Doc_Typ,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(2) AS 'Doc_Typ'"

IF NOT MATCH(fdap_Curncy,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdap_Curncy%) AS 'Curncy'"
IF MATCH(fdap_Curncy,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(15) AS 'Curncy'"

IF NOT MATCH(fdap_Inv_Net_Amt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdap_Inv_Net_Amt% AS 'Inv_Net_Amt'"
IF MATCH(fdap_Inv_Net_Amt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'Inv_Net_Amt'"

IF NOT MATCH(fdap_GST_Amt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdap_GST_Amt% AS 'GST_Amt'"
IF MATCH(fdap_GST_Amt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'GST_Amt'"

IF NOT MATCH(fdap_Btch_No,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdap_Btch_No%) AS 'Btch_No'"
IF MATCH(fdap_Btch_No,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(15) AS 'Btch_No'"

IF NOT MATCH(fdap_Due_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdap_Due_Dt% AS 'Due_Dt'"
IF MATCH(fdap_Due_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Due_Dt'"

IF NOT MATCH(fdap_PO_No,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdap_PO_No%) AS 'PO_No'"
IF MATCH(fdap_PO_No,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(21) AS 'PO_No'"

IF NOT MATCH(fdap_PO_Net_Amt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdap_PO_Net_Amt% AS 'PO_Net_Amt'"
IF MATCH(fdap_PO_Net_Amt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'PO_Net_Amt'"

IF NOT MATCH(fdap_Descrp,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdap_Descrp%) AS 'Descrp'"
IF MATCH(fdap_Descrp,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(31) AS 'Descrp'"

IF NOT MATCH(fdap_Pd_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdap_Pd_Dt% AS 'Pd_Dt'"
IF MATCH(fdap_Pd_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'PO_Pd_Dt'"

IF NOT MATCH(fdap_Pymnt_Trms,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdap_Pymnt_Trms%) AS 'Pymnt_Trms'"
IF MATCH(fdap_Pymnt_Trms,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(21) AS 'Pymnt_Trms'"

IF NOT MATCH(fdap_Pst_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdap_Pst_Dt% AS 'Pst_Dt'"
IF MATCH(fdap_Pst_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Pst_Dt'"

IF NOT MATCH(fdap_VOIDED,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdap_VOIDED%) AS 'VOIDED'"
IF MATCH(fdap_VOIDED,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(1) AS 'VOIDED'"

IF NOT MATCH(fdap_Void_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdap_Void_Dt% AS 'Void_Dt'"
IF MATCH(fdap_Void_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Void_Dt'"

IF NOT MATCH(fdap_isPaid,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdap_isPaid%) AS 'isPaid'"
IF MATCH(fdap_isPaid,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(1) AS 'isPaid'"

IF NOT MATCH(fdap_Modf_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdap_Modf_Dt% AS 'Modf_Dt'"
IF MATCH(fdap_Modf_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Modf_Dt'"

IF NOT MATCH(fdap_Modf_By,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdap_Modf_By%) AS 'Modf_By'"
IF MATCH(fdap_Modf_By,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(15) AS 'Modf_By'"

IF NOT MATCH(fdap_Num_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdap_Num_Field1% AS 'Num_Field1'"
IF MATCH(fdap_Num_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'Num_Field1'"

IF NOT MATCH(fdap_Num_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdap_Num_Field2% AS 'Num_Field2'"
IF MATCH(fdap_Num_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'Num_Field2'"

IF NOT MATCH(fdap_Num_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdap_Num_Field3% AS 'Num_Field3'"
IF MATCH(fdap_Num_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'Num_Field3'"

IF NOT MATCH(fdap_Num_Field4,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdap_Num_Field4% AS 'Num_Field4'"
IF MATCH(fdap_Num_Field4,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'Num_Field4'"

IF NOT MATCH(fdap_Num_Field5,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdap_Num_Field5% AS 'Num_Field5'"
IF MATCH(fdap_Num_Field5,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'Num_Field5'"

IF NOT MATCH(fdap_Dt_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdap_Dt_Field1% AS 'Dt_Field1'"
IF MATCH(fdap_Dt_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Dt_Field1'"

IF NOT MATCH(fdap_Dt_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdap_Dt_Field2% AS 'Dt_Field2'"
IF MATCH(fdap_Dt_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Dt_Field2'"

IF NOT MATCH(fdap_Dt_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdap_Dt_Field3% AS 'Dt_Field3'"
IF MATCH(fdap_Dt_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Dt_Field3'"

IF NOT MATCH(fdap_Cha_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdap_Cha_Field1%) AS 'Cha_Field1'"
IF MATCH(fdap_Cha_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field1'"

IF NOT MATCH(fdap_Cha_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdap_Cha_Field2%) AS 'Cha_Field2'"
IF MATCH(fdap_Cha_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field2'"

IF NOT MATCH(fdap_Cha_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdap_Cha_Field3%) AS 'Cha_Field3'"
IF MATCH(fdap_Cha_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field3'"

IF NOT MATCH(fdap_Cha_Field4,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdap_Cha_Field4%) AS 'Cha_Field4'"
IF MATCH(fdap_Cha_Field4,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field4'"

IF NOT MATCH(fdap_Cha_Field5,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdap_Cha_Field5%) AS 'Cha_Field5'"
IF MATCH(fdap_Cha_Field5,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field5'"

COMM EXTRACT FIELDS %v_Flds_Extract% TO "%fld_Workings%%trg_AP_Inv%.FIL"

DELETE FIELD _empty_ OK 

EXTRACT FIELDS %v_Flds_Extract% TO "%fld_Tmps%TMP_Mapping.FIL" FIRST 1 
  
COMM *** Update the fields linkage information into Data mapping Table, So the user can reuse the mapping information next time ***

v_fd="fdap"
v_dm_tbl_Nme="DM_%trg_AP_Inv%"
v_src_tbl_Nme='%src_AP_INv%'

DO LE004_Upt_Mapping

DELETE FORMAT TMP_Mapping OK
DELETE "%fld_Tmps%TMP_Mapping.FIL" OK



^BATCH    B0704_Loop_Match_Inv               
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - Invoices 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


FLAG_Show=F

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data File Setup - Invoices" WIDTH 1044 HEIGHT 704 ) (BUTTONSET TITLE "&OK;&Cancel" AT 756 552 DEFAULT 1 ) (TEXT TITLE "Please link the fields from source file to  standard file - AP Invoices" AT 96 16 WIDTH 432 CENTER ) (ITEM TITLE "C" TO "fdap_Vndr_ID" AT 324 108 WIDTH 178 DEFAULT "%fdap_Vndr_ID%" ) (TEXT TITLE "Vendor Number / Supplier Number *" AT 12 112 WIDTH 280 RIGHT ) (ITEM TITLE "C" TO "fdap_Vchr_ID" AT 324 132 WIDTH 178 DEFAULT "%fdap_Vchr_ID%" ) (TEXT TITLE "Voucher ID / Invoice ID*" AT 8 136 WIDTH 280 RIGHT ) (ITEM TITLE "NC" TO "fdap_Doc_Typ" AT 324 156 WIDTH 179 DEFAULT "%fdap_Doc_Typ%" ) (TEXT TITLE "Document Type" AT 8 160 WIDTH 280 HEIGHT 20 RIGHT ) (ITEM TITLE "C" TO "fdap_Inv_No" AT 324 180 WIDTH 179 DEFAULT "%fdap_Inv_No%" ) (TEXT TITLE "Invoice Number*" AT 12 184 WIDTH 280 RIGHT ) (ITEM TITLE "DC" TO "fdap_Inv_Dt" AT 324 204 WIDTH 179 DEFAULT "%fdap_Inv_Dt%" ) (CHECKBOX TITLE "To exit/Escape" TO "exit" AT 744 624 WIDTH 100 ) (TEXT TITLE "Standard Table Fields" AT 168 52 ) (TEXT TITLE "Source Table Fields" AT 348 52 CENTER ) (TEXT TITLE "Invoice Amount (Document Currency)*" AT 8 232 WIDTH 280 RIGHT ) (TEXT TITLE "Invoice Amount (Local Currency)" AT 12 256 WIDTH 280 RIGHT ) (TEXT TITLE "Currency" AT 12 280 WIDTH 280 RIGHT ) (TEXT TITLE "Exchange Rate" AT 8 304 WIDTH 280 RIGHT ) (TEXT TITLE "Invoice Net Amount" AT 12 328 WIDTH 280 RIGHT ) (TEXT TITLE "GST Amount" AT 8 352 WIDTH 280 RIGHT ) (TEXT TITLE "Batch Number" AT 8 376 WIDTH 280 RIGHT ) (TEXT TITLE "Due Date" AT 8 400 WIDTH 280 RIGHT ) (TEXT TITLE "PO Net Amount" AT 12 448 WIDTH 280 RIGHT ) (TEXT TITLE "Invoice Description" AT 12 472 WIDTH 280 RIGHT ) (TEXT TITLE "Paid Date" AT 8 496 WIDTH 280 RIGHT ) (TEXT TITLE "Payment Terms" AT 12 520 WIDTH 280 RIGHT ) (TEXT TITLE "Invoice Date*" AT 8 208 WIDTH 280 RIGHT ) (TEXT TITLE "Voided" AT 8 568 WIDTH 280 RIGHT ) (TEXT TITLE "Modified Date" AT 8 640 WIDTH 280 RIGHT ) (ITEM TITLE "NC" TO "fdap_Inv_Amt_Doc" AT 324 228 WIDTH 179 DEFAULT "%fdap_Inv_Amt_Doc%" ) (ITEM TITLE "NC" TO "fdap_Inv_Amt" AT 324 252 WIDTH 179 DEFAULT "%fdap_Inv_Amt%" ) (ITEM TITLE "C" TO "fdap_Curncy" AT 324 276 WIDTH 179 DEFAULT "%fdap_Curncy%" ) (ITEM TITLE "NC" TO "fdap_Ex_Rate" AT 324 300 WIDTH 179 DEFAULT "%fdap_Ex_Rate%" ) (ITEM TITLE "NC" TO "fdap_Inv_Net_Amt" AT 324 324 WIDTH 179 DEFAULT "%fdap_Inv_Net_Amt%" ) (ITEM TITLE "NC" TO "fdap_GST_Amt" AT 324 348 WIDTH 179 DEFAULT "%fdap_GST_Amt%" ) (ITEM TITLE "C" TO "fdap_Btch_No" AT 324 372 WIDTH 179 DEFAULT "%fdap_Btch_No%" ) (ITEM TITLE "DC" TO "fdap_Due_Dt" AT 324 396 WIDTH 179 DEFAULT "%fdap_Due_Dt%" ) (ITEM TITLE "C" TO "fdap_PO_No" AT 324 420 WIDTH 179 DEFAULT "%fdap_PO_No%" ) (ITEM TITLE "NC" TO "fdap_PO_Net_Amt" AT 324 444 WIDTH 179 DEFAULT "%fdap_PO_Net_Amt%" ) (ITEM TITLE "C" TO "fdap_Descrp" AT 324 468 WIDTH 179 DEFAULT "%fdap_Descrp%" ) (ITEM TITLE "DC" TO "fdap_Pd_Dt" AT 324 492 WIDTH 179 DEFAULT "%fdap_Pd_Dt%" ) (ITEM TITLE "C" TO "fdap_Pymnt_Trms" AT 324 516 WIDTH 179 DEFAULT "%fdap_Pymnt_Trms%" ) (ITEM TITLE "DC" TO "fdap_Pst_Dt" AT 324 540 WIDTH 179 DEFAULT "%fdap_Pst_Dt%" ) (ITEM TITLE "DC" TO "fdap_Modf_Dt" AT 324 636 WIDTH 179 DEFAULT "%fdap_Modf_Dt%" ) (TEXT TITLE "PO Number" AT 12 424 WIDTH 280 RIGHT ) (TEXT TITLE "Source Table Name " AT 564 16 RIGHT ) (TEXT TITLE "%src_AP_Inv%" AT 720 16 WIDTH 252 ) (TEXT TITLE "Document Post Date" AT 8 544 WIDTH 280 RIGHT ) (TEXT TITLE "Voided Date" AT 8 592 WIDTH 280 RIGHT ) (TEXT TITLE "Modified By" AT 12 616 WIDTH 280 RIGHT ) (ITEM TITLE "CN" TO "fdap_VOIDED" AT 324 564 WIDTH 179 DEFAULT "%fdap_VOIDED%" ) (ITEM TITLE "DC" TO "fdap_Void_Dt" AT 324 588 WIDTH 179 HEIGHT 100 DEFAULT "%fdap_Void_Dt%" ) (ITEM TITLE "C" TO "fdap_Modf_By" AT 324 612 WIDTH 179 HEIGHT 100 DEFAULT "%fdap_Modf_By%" ) (TEXT TITLE "IsPaid" AT 504 88 WIDTH 170 RIGHT ) (ITEM TITLE "C" TO "fdap_IsPaid" AT 708 84 WIDTH 179 DEFAULT "%fdap_IsPaid%" ) (TEXT TITLE "Standard Table Fields" AT 540 52 CENTER ) (TEXT TITLE "Source Table Fields" AT 732 52 CENTER ) (TEXT TITLE "Numeric Spare Field 1" AT 504 112 WIDTH 170 RIGHT ) (TEXT TITLE "Numeric Spare Field 2" AT 504 136 WIDTH 170 RIGHT ) (TEXT TITLE "Numeric Spare Field 3" AT 504 160 WIDTH 170 RIGHT ) (TEXT TITLE "Numeric Spare Field 4" AT 504 184 WIDTH 170 RIGHT ) (TEXT TITLE "Numeric Spare Field 5" AT 504 208 WIDTH 170 RIGHT ) (TEXT TITLE "Date Spare Field 1" AT 504 232 WIDTH 170 RIGHT ) (TEXT TITLE "Date Spare Field 2" AT 504 256 WIDTH 170 RIGHT ) (TEXT TITLE "Date Spare Field 3" AT 504 280 WIDTH 170 RIGHT ) (TEXT TITLE "Character Spare Field 1" AT 504 304 WIDTH 170 RIGHT ) (TEXT TITLE "Character Spare Field 3" AT 504 352 WIDTH 170 RIGHT ) (TEXT TITLE "Character Spare Field 2" AT 504 328 WIDTH 170 RIGHT ) (TEXT TITLE "Character Spare Field 4" AT 504 376 WIDTH 170 RIGHT ) (TEXT TITLE "Character Spare Field 5" AT 504 400 WIDTH 170 RIGHT ) (ITEM TITLE "NC" TO "fdap_Num_Field1" AT 708 108 WIDTH 178 DEFAULT "%fdap_Num_Field1%" ) (ITEM TITLE "NC" TO "fdap_Num_Field2" AT 708 132 WIDTH 178 DEFAULT "%fdap_Num_Field2%" ) (ITEM TITLE "NC" TO "fdap_Num_Field3" AT 708 156 WIDTH 178 DEFAULT "%fdap_Num_Field3%" ) (ITEM TITLE "NC" TO "fdap_Num_Field4" AT 708 180 WIDTH 178 DEFAULT "%fdap_Num_Field4%" ) (ITEM TITLE "NC" TO "fdap_Num_Field5" AT 708 204 WIDTH 178 DEFAULT "%fdap_Num_Field5%" ) (ITEM TITLE "DC" TO "fdap_Dt_Field1" AT 708 228 WIDTH 178 DEFAULT "%fdap_Dt_Field1%" ) (ITEM TITLE "DC" TO "fdap_Dt_Field2" AT 708 252 WIDTH 178 DEFAULT "%fdap_Dt_Field2%" ) (ITEM TITLE "DC" TO "fdap_Dt_Field3" AT 708 276 WIDTH 178 DEFAULT "%fdap_Dt_Field3%" ) (ITEM TITLE "C" TO "fdap_Cha_Field1" AT 708 300 WIDTH 178 DEFAULT "%fdap_Cha_Field1%" ) (ITEM TITLE "C" TO "fdap_Cha_Field2" AT 708 324 WIDTH 178 DEFAULT "%fdap_Cha_Field2%" ) (ITEM TITLE "C" TO "fdap_Cha_Field3" AT 708 348 WIDTH 178 DEFAULT "%fdap_Cha_Field3%" ) (ITEM TITLE "C" TO "fdap_Cha_Field4" AT 708 372 WIDTH 178 DEFAULT "%fdap_Cha_Field4%" ) (ITEM TITLE "C" TO "fdap_Cha_Field5" AT 708 396 WIDTH 178 DEFAULT "%fdap_Cha_Field5%" ) (TEXT TITLE "Vendor ID / Supplier Unique Key*" AT 8 88 WIDTH 280 RIGHT ) (ITEM TITLE "C" TO "fdap_Vndr_Site_ID" AT 324 84 WIDTH 178 DEFAULT "%fdap_Vndr_Site_ID%" )

IF exit=T ESCAPE

ErrMsg=""
IF MATCH(fdap_Vndr_Site_ID,"_empty_"," ") ErrMsg="Vendor Unique Key"
IF MATCH(fdap_Vndr_ID,"_empty_"," ") ErrMsg="Vendor Number"
IF MATCH(fdap_Vchr_ID,"_empty_"," ") ErrMsg=ErrMsg+" Voucher ID"
IF MATCH(fdap_Inv_No,"_empty_"," ") ErrMsg=ErrMsg+" Invoice Number"
IF MATCH(fdap_Inv_Dt,"_empty_"," ") ErrMsg=ErrMsg+" Invoice Date"
IF MATCH(fdap_Inv_Amt,"_empty_"," ") AND MATCH(fdap_Inv_Amt_Doc,"_empty_"," ") ErrMsg=ErrMsg+" Invoice Amount"

%v_CCMJob% IF ALLTRIM(ErrMsg)<>"" PAUSE "Please Select a field for "+ErrMsg


^BATCH    B0801_Select_Pay                   
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Convert, Link Fields from Source Data To Target Working File Table's Fields: AP Payments
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF
FLAG_Show=T

DO B0802_Loop_Sel_Pay WHILE ISBLANK(src_AP_Pay)= T OR FLAG_Show=T

DO B0803_Match_Pay_Mstr_Flds
IF exit=T ESCAPE

SET SAFETY ON

^BATCH    B0802_Loop_Sel_Pay                 
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - Select the source table that you want to link to the  AP Payments
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


FLAG_Show=F
SET FOLDER /%fld_Tmps%

COMM *** List Table Names ***
CLOSE
DIR %fld_Sources%*.fil SUB TO "%fld_Tmps%CVT_Tables"

OPEN CVT_Tables
DELETE FIELD Table_Name OK
DEFINE FIELD Table_Name COMPUTED ALLTRIM(SPLIT(SPLIT(FILE_NAME,"\",OCCURS(FILE_NAME,"\")+1),".",1))

v_Table_Names=BLANKS(10000)
v_counter=0
COUNT

GROUP IF NOT ISBLANK(Table_Name)
 LOOP WHILE v_counter<=COUNT1
  v_Table_Names = ALLTRIM(v_Table_Names) + ALLTRIM(RECOFFSET(Table_Name,v_counter)) + ";"
  v_counter = v_counter + 1
 END
END

v_Table_Names=REPLACE(ALLTRIM(REPLACE(v_Table_Names,";"," "))," ",";")

LOCATE IF Table_Name="%src_AP_Pay%"
v_default=RECNO()

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data Mapping - Payments" WIDTH 523 HEIGHT 167 ) (BUTTONSET TITLE "&OK;&Cancel" AT 372 72 DEFAULT 1 ) (DROPDOWN TITLE "%v_Table_Names%" TO "src_AP_Pay" AT 48 72 WIDTH 234 HEIGHT 126 DEFAULT %v_default%) (TEXT TITLE "Select a source table match to the target table - Payments Table" AT 48 40 )

%v_CCMJob% IF ISBLANK(src_AP_Pay)= T PAUSE "Please select a file that maps to Payments"



^BATCH    B0803_Match_Pay_Mstr_Flds          
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Link Fields from Source Data To Target Working File Table's Fields: Payments
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF
exit=F
FLAG_Show=T

OPEN %src_AP_Pay%

DELETE FIELD _empty_ OK
DEFINE FIELD _empty_ COMPUTED ""

DO B0804_Loop_Match_Pay WHILE FLAG_Show=T OR MATCH(fdpp_Vndr_Site_ID,"_empty_"," ")  OR MATCH(fdpp_Vndr_ID,"_empty_"," ") OR MATCH(fdpp_Vchr_ID,"_empty_"," ") OR MATCH(fdpp_Pay_Dt,"_empty_"," ") OR MATCH(fdpp_Pay_No,"_empty_"," ") OR (MATCH(fdpp_Pay_Amt,"_empty_"," ") AND MATCH(fdpp_Pay_Amt_Doc,"_empty_"," "))

IF exit=T ESCAPE

COMM *** Extracting fields to master table from Source ***

v_Flds_Extract="ALLTRIM(%fdpp_Vndr_Site_ID%) AS 'Vndr_Site_ID' ALLTRIM(%fdpp_Vndr_ID%) AS 'Vndr_ID' ALLTRIM(%fdpp_Vchr_ID%) AS 'Vchr_ID' ALLTRIM(%fdpp_Pay_No%) AS 'Pay_No' %fdpp_Pay_Dt% AS 'Pay_Dt'"

IF NOT MATCH(fdpp_Pay_Amt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpp_Pay_Amt% AS 'Pay_Amt'"
IF MATCH(fdpp_Pay_Amt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'Pay_Amt'"

IF NOT MATCH(fdpp_Pay_Amt_Doc,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpp_Pay_Amt_Doc% AS 'Pay_Amt_Doc'"
IF MATCH(fdpp_Pay_Amt_Doc,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'Pay_Amt_Doc'"

IF NOT MATCH(fdpp_Doc_Typ,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpp_Doc_Typ% AS 'Doc_Typ'"
IF MATCH(fdpp_Doc_Typ,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(2) AS 'Doc_Typ'"

IF NOT MATCH(fdpp_Curncy,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpp_Curncy%) AS 'Curncy'"
IF MATCH(fdpp_Curncy,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(15) AS 'Curncy'"

IF NOT MATCH(fdpp_Pay_Net_Amt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpp_Pay_Net_Amt% AS 'Pay_Net_Amt'"
IF MATCH(fdpp_Pay_Net_Amt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'Pay_Net_Amt'"

IF NOT MATCH(fdpp_GST_Amt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpp_GST_Amt% AS 'GST_Amt'"
IF MATCH(fdpp_GST_Amt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'GST_Amt'"

IF NOT MATCH(fdpp_Btch_No,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpp_Btch_No%) AS 'Btch_No'"
IF MATCH(fdpp_Btch_No,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(15) AS 'Btch_No'"

IF NOT MATCH(fdpp_Due_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpp_Due_Dt% AS 'Due_Dt'"
IF MATCH(fdpp_Due_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Due_Dt'"

IF NOT MATCH(fdpp_PO_No,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpp_PO_No%) AS 'PO_No'"
IF MATCH(fdpp_PO_No,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(21) AS 'PO_No'"

IF NOT MATCH(fdpp_PO_Net_Amt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpp_PO_Net_Amt% AS 'PO_Net_Amt'"
IF MATCH(fdpp_PO_Net_Amt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'PO_Net_Amt'"

IF NOT MATCH(fdpp_Descrp,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpp_Descrp%) AS 'Descrp'"
IF MATCH(fdpp_Descrp,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(31) AS 'Descrp'"

IF NOT MATCH(fdpp_Pd_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpp_Pd_Dt% AS 'Pd_Dt'"
IF MATCH(fdpp_Pd_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'PO_Pd_Dt'"

IF NOT MATCH(fdpp_Pymnt_Trms,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpp_Pymnt_Trms%) AS 'Pymnt_Trms'"
IF MATCH(fdpp_Pymnt_Trms,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(21) AS 'Pymnt_Trms'"

IF NOT MATCH(fdpp_Pst_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpp_Pst_Dt% AS 'Pst_Dt'"
IF MATCH(fdpp_Pst_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Pst_Dt'"

IF NOT MATCH(fdpp_VOIDED,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpp_VOIDED%) AS 'VOIDED'"
IF MATCH(fdpp_VOIDED,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(1) AS 'VOIDED'"

IF NOT MATCH(fdpp_Void_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpp_Void_Dt% AS 'Void_Dt'"
IF MATCH(fdpp_Void_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Void_Dt'"

IF NOT MATCH(fdpp_Modf_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpp_Modf_Dt% AS 'Modf_Dt'"
IF MATCH(fdpp_Modf_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Modf_Dt'"

IF NOT MATCH(fdpp_Modf_By,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpp_Modf_By%) AS 'Modf_By'"
IF MATCH(fdpp_Modf_By,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(15) AS 'Modf_By'"

IF NOT MATCH(fdpp_Chq_No,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpp_Chq_No% AS 'Chq_No'"
IF MATCH(fdpp_Chq_No,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(2) AS 'Chq_No'"

IF NOT MATCH(fdpp_Pymnt_Mth,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpp_Pymnt_Mth%) AS 'Pymnt_Mth'"
IF MATCH(fdpp_Pymnt_Mth,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'fdpp_Pymnt_Mth'"

IF NOT MATCH(fdpp_Num_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpp_Num_Field1% AS 'Num_Field1'"
IF MATCH(fdpp_Num_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'Num_Field1'"

IF NOT MATCH(fdpp_Num_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpp_Num_Field2% AS 'Num_Field2'"
IF MATCH(fdpp_Num_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'Num_Field2'"

IF NOT MATCH(fdpp_Num_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpp_Num_Field3% AS 'Num_Field3'"
IF MATCH(fdpp_Num_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'Num_Field3'"

IF NOT MATCH(fdpp_Num_Field4,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpp_Num_Field4% AS 'Num_Field4'"
IF MATCH(fdpp_Num_Field4,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'Num_Field4'"

IF NOT MATCH(fdpp_Num_Field5,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpp_Num_Field5% AS 'Num_Field5'"
IF MATCH(fdpp_Num_Field5,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',5) AS 'Num_Field5'"

IF NOT MATCH(fdpp_Dt_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpp_Dt_Field1% AS 'Dt_Field1'"
IF MATCH(fdpp_Dt_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Dt_Field1'"

IF NOT MATCH(fdpp_Dt_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpp_Dt_Field2% AS 'Dt_Field2'"
IF MATCH(fdpp_Dt_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Dt_Field2'"

IF NOT MATCH(fdpp_Dt_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpp_Dt_Field3% AS 'Dt_Field3'"
IF MATCH(fdpp_Dt_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Dt_Field3'"

IF NOT MATCH(fdpp_Cha_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpp_Cha_Field1%) AS 'Cha_Field1'"
IF MATCH(fdpp_Cha_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field1'"

IF NOT MATCH(fdpp_Cha_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpp_Cha_Field2%) AS 'Cha_Field2'"
IF MATCH(fdpp_Cha_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field2'"

IF NOT MATCH(fdpp_Cha_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpp_Cha_Field3%) AS 'Cha_Field3'"
IF MATCH(fdpp_Cha_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field3'"

IF NOT MATCH(fdpp_Cha_Field4,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpp_Cha_Field4%) AS 'Cha_Field4'"
IF MATCH(fdpp_Cha_Field4,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field4'"

IF NOT MATCH(fdpp_Cha_Field5,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpp_Cha_Field5%) AS 'Cha_Field5'"
IF MATCH(fdpp_Cha_Field5,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field5'"

COMM EXTRACT FIELDS %v_Flds_Extract% TO "%fld_Workings%%trg_AP_Pay%.FIL"

DELETE FIELD _empty_ OK 

EXTRACT FIELDS %v_Flds_Extract% TO "%fld_Tmps%TMP_Mapping.FIL" FIRST 1
  
COMM *** Update the fields linkage information into Data mapping Table, So the user can reuse the mapping information next time ***

v_fd="fdpp"
v_dm_tbl_Nme="DM_%trg_AP_Pay%"
v_src_tbl_Nme='%src_AP_Pay%'

DO LE004_Upt_Mapping

DELETE FORMAT TMP_Mapping OK
DELETE "%fld_Tmps%TMP_Mapping.FIL" OK


^BATCH    B0804_Loop_Match_Pay               
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - Payments 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


FLAG_Show=F

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data File Setup - Payments" WIDTH 1044 HEIGHT 704 ) (BUTTONSET TITLE "&OK;&Cancel" AT 732 528 DEFAULT 1 ) (TEXT TITLE "Please link the fields from source file to  standard file - AP Payments" AT 96 16 WIDTH 432 CENTER ) (ITEM TITLE "C" TO "fdpp_Vndr_ID" AT 324 108 WIDTH 178 DEFAULT "%fdpp_Vndr_ID%" ) (TEXT TITLE "Vendor Number / Supplier Number *" AT 12 112 WIDTH 280 RIGHT ) (ITEM TITLE "C" TO "fdpp_Vchr_ID" AT 324 132 WIDTH 178 DEFAULT "%fdpp_Vchr_ID%" ) (TEXT TITLE "Voucher ID / Payment ID*" AT 12 136 WIDTH 280 RIGHT ) (ITEM TITLE "NC" TO "fdpp_Doc_Typ" AT 324 156 WIDTH 179 DEFAULT "%fdpp_Doc_Typ%" ) (TEXT TITLE "Document Type" AT 8 160 WIDTH 280 HEIGHT 20 RIGHT ) (ITEM TITLE "C" TO "fdpp_pay_No" AT 324 180 WIDTH 179 DEFAULT "%fdpp_pay_No%" ) (TEXT TITLE "Payment Number*" AT 12 184 WIDTH 280 RIGHT ) (ITEM TITLE "DC" TO "fdpp_pay_Dt" AT 324 204 WIDTH 179 DEFAULT "%fdpp_pay_Dt%" ) (CHECKBOX TITLE "To exit/Escape" TO "exit" AT 732 600 WIDTH 100 ) (TEXT TITLE "Standard Table Fields" AT 168 52 ) (TEXT TITLE "Source Table Fields" AT 348 52 CENTER ) (TEXT TITLE "Payment Amount (Document Currency)*" AT 8 232 WIDTH 280 RIGHT ) (TEXT TITLE "Payment Amount (Local Currency)" AT 12 256 WIDTH 280 RIGHT ) (TEXT TITLE "Currency" AT 8 280 WIDTH 280 RIGHT ) (TEXT TITLE "Exchange Rate" AT 12 304 WIDTH 280 RIGHT ) (TEXT TITLE "Payment Net Amount" AT 12 328 WIDTH 280 RIGHT ) (TEXT TITLE "GST Amount" AT 8 352 WIDTH 280 RIGHT ) (TEXT TITLE "Batch Number" AT 12 376 WIDTH 280 RIGHT ) (TEXT TITLE "Due Date" AT 12 400 WIDTH 280 RIGHT ) (TEXT TITLE "PO Net Amount" AT 12 448 WIDTH 280 RIGHT ) (TEXT TITLE "Payment Description" AT 12 472 WIDTH 280 RIGHT ) (TEXT TITLE "Paid Date" AT 8 496 WIDTH 280 RIGHT ) (TEXT TITLE "Payment Terms" AT 8 520 WIDTH 280 RIGHT ) (TEXT TITLE "Payment Date*" AT 8 208 WIDTH 280 RIGHT ) (TEXT TITLE "Voided" AT 8 568 WIDTH 280 RIGHT ) (TEXT TITLE "Modified Date" AT 504 136 WIDTH 170 RIGHT ) (ITEM TITLE "NC" TO "fdpp_pay_Amt_Doc" AT 324 228 WIDTH 179 DEFAULT "%fdpp_pay_Amt_Doc%" ) (ITEM TITLE "NC" TO "fdpp_pay_Amt" AT 324 252 WIDTH 179 DEFAULT "%fdpp_pay_Amt%" ) (ITEM TITLE "C" TO "fdpp_Curncy" AT 324 276 WIDTH 179 DEFAULT "%fdpp_Curncy%" ) (ITEM TITLE "NC" TO "fdpp_Ex_Rate" AT 324 300 WIDTH 179 DEFAULT "%fdpp_Ex_Rate%" ) (ITEM TITLE "NC" TO "fdpp_pay_Net_Amt" AT 324 324 WIDTH 179 DEFAULT "%fdpp_pay_Net_Amt%" ) (ITEM TITLE "NC" TO "fdpp_GST_Amt" AT 324 348 WIDTH 179 DEFAULT "%fdpp_GST_Amt%" ) (ITEM TITLE "C" TO "fdpp_Btch_No" AT 324 372 WIDTH 179 DEFAULT "%fdpp_Btch_No%" ) (ITEM TITLE "DC" TO "fdpp_Due_Dt" AT 324 396 WIDTH 179 DEFAULT "%fdpp_Due_Dt%" ) (ITEM TITLE "C" TO "fdpp_PO_No" AT 324 420 WIDTH 179 DEFAULT "%fdpp_PO_No%" ) (ITEM TITLE "NC" TO "fdpp_PO_Net_Amt" AT 324 444 WIDTH 179 DEFAULT "%fdpp_PO_Net_Amt%" ) (ITEM TITLE "C" TO "fdpp_Descrp" AT 324 468 WIDTH 179 DEFAULT "%fdpp_Descrp%" ) (ITEM TITLE "DC" TO "fdpp_Pd_Dt" AT 324 492 WIDTH 179 DEFAULT "%fdpp_Pd_Dt%" ) (ITEM TITLE "C" TO "fdpp_Pymnt_Trms" AT 324 516 WIDTH 179 DEFAULT "%fdpp_Pymnt_Trms%" ) (ITEM TITLE "DC" TO "fdpp_Pst_Dt" AT 324 540 WIDTH 179 DEFAULT "%fdpp_Pst_Dt%" ) (ITEM TITLE "DC" TO "fdpp_Modf_Dt" AT 708 132 WIDTH 179 DEFAULT "%fdpp_Modf_Dt%" ) (TEXT TITLE "PO Number" AT 12 424 WIDTH 280 RIGHT ) (TEXT TITLE "Source Table Name " AT 564 16 RIGHT ) (TEXT TITLE "%src_AP_Pay%" AT 720 16 WIDTH 252 ) (TEXT TITLE "Document Post Date" AT 8 544 WIDTH 280 RIGHT ) (TEXT TITLE "Voided Date" AT 8 592 WIDTH 280 RIGHT ) (TEXT TITLE "Modified By" AT 504 112 WIDTH 170 RIGHT ) (ITEM TITLE "CN" TO "fdpp_VOIDED" AT 324 564 WIDTH 179 DEFAULT "%fdpp_VOIDED%" ) (ITEM TITLE "DC" TO "fdpp_Void_Dt" AT 324 588 WIDTH 179 HEIGHT 100 DEFAULT "%fdpp_Void_Dt%" ) (ITEM TITLE "C" TO "fdpp_Modf_By" AT 708 108 WIDTH 179 HEIGHT 100 DEFAULT "%fdpp_Modf_By%" ) (TEXT TITLE "Standard Table Fields" AT 540 52 CENTER ) (TEXT TITLE "Source Table Fields" AT 732 52 CENTER ) (TEXT TITLE "Numeric Spare Field 1" AT 504 160 WIDTH 170 RIGHT ) (TEXT TITLE "Numeric Spare Field 2" AT 504 184 WIDTH 170 RIGHT ) (TEXT TITLE "Numeric Spare Field 3" AT 504 208 WIDTH 170 RIGHT ) (TEXT TITLE "Numeric Spare Field 4" AT 504 232 WIDTH 170 RIGHT ) (TEXT TITLE "Numeric Spare Field 5" AT 504 256 WIDTH 170 RIGHT ) (TEXT TITLE "Date Spare Field 1" AT 504 280 WIDTH 170 RIGHT ) (TEXT TITLE "Date Spare Field 2" AT 504 304 WIDTH 170 RIGHT ) (TEXT TITLE "Date Spare Field 3" AT 504 328 WIDTH 170 RIGHT ) (TEXT TITLE "Character Spare Field 1" AT 504 352 WIDTH 170 RIGHT ) (TEXT TITLE "Character Spare Field 3" AT 504 400 WIDTH 170 RIGHT ) (TEXT TITLE "Character Spare Field 2" AT 504 376 WIDTH 170 RIGHT ) (TEXT TITLE "Character Spare Field 4" AT 504 424 WIDTH 170 RIGHT ) (TEXT TITLE "Character Spare Field 5" AT 504 448 WIDTH 170 RIGHT ) (ITEM TITLE "NC" TO "fdpp_Num_Field1" AT 708 156 WIDTH 178 DEFAULT "%fdpp_Num_Field1%" ) (ITEM TITLE "NC" TO "fdpp_Num_Field2" AT 708 180 WIDTH 178 DEFAULT "%fdpp_Num_Field2%" ) (ITEM TITLE "NC" TO "fdpp_Num_Field3" AT 708 204 WIDTH 178 DEFAULT "%fdpp_Num_Field3%" ) (ITEM TITLE "NC" TO "fdpp_Num_Field4" AT 708 228 WIDTH 178 DEFAULT "%fdpp_Num_Field4%" ) (ITEM TITLE "NC" TO "fdpp_Num_Field5" AT 708 252 WIDTH 178 DEFAULT "%fdpp_Num_Field5%" ) (ITEM TITLE "DC" TO "fdpp_Dt_Field1" AT 708 276 WIDTH 178 DEFAULT "%fdpp_Dt_Field1%" ) (ITEM TITLE "DC" TO "fdpp_Dt_Field2" AT 708 300 WIDTH 178 DEFAULT "%fdpp_Dt_Field2%" ) (ITEM TITLE "DC" TO "fdpp_Dt_Field3" AT 708 324 WIDTH 178 DEFAULT "%fdpp_Dt_Field3%" ) (ITEM TITLE "C" TO "fdpp_Cha_Field1" AT 708 348 WIDTH 178 DEFAULT "%fdpp_Cha_Field1%" ) (ITEM TITLE "C" TO "fdpp_Cha_Field2" AT 708 372 WIDTH 178 DEFAULT "%fdpp_Cha_Field2%" ) (ITEM TITLE "C" TO "fdpp_Cha_Field3" AT 708 396 WIDTH 178 DEFAULT "%fdpp_Cha_Field3%" ) (ITEM TITLE "C" TO "fdpp_Cha_Field4" AT 708 420 WIDTH 178 DEFAULT "%fdpp_Cha_Field4%" ) (ITEM TITLE "C" TO "fdpp_Cha_Field5" AT 708 444 WIDTH 178 DEFAULT "%fdpp_Cha_Field5%" ) (ITEM TITLE "C" TO "fdpp_Vndr_Site_ID" AT 324 84 WIDTH 178 DEFAULT "%fdpp_Vndr_Site_ID%" ) (ITEM TITLE "C" TO "fdpp_Chq_No" AT 324 612 WIDTH 178 DEFAULT "%fdpp_Chq_No%" ) (TEXT TITLE "Cheque Number" AT 8 616 WIDTH 280 RIGHT ) (TEXT TITLE "Vendor ID / Supplier Unique Key*" AT 12 88 WIDTH 280 RIGHT ) (ITEM TITLE "C" TO "fdpp_Pymnt_Mth" AT 708 84 WIDTH 178 DEFAULT "%fdpp_Pymnt_Mth%" ) (TEXT TITLE "Payment Method" AT 552 88 WIDTH 118 RIGHT )

IF exit=T ESCAPE

ErrMsg=""
IF MATCH(fdpp_Vndr_Site_ID,"_empty_"," ") ErrMsg="Vendor Unique Key"
IF MATCH(fdpp_Vndr_ID,"_empty_"," ") ErrMsg="Vendor Number"
IF MATCH(fdpp_Vchr_ID,"_empty_"," ") ErrMsg=ErrMsg+" Voucher ID"
IF MATCH(fdpp_pay_No,"_empty_"," ") ErrMsg=ErrMsg+" Payment Number"
IF MATCH(fdpp_pay_Dt,"_empty_"," ") ErrMsg=ErrMsg+" Payment Date"
IF MATCH(fdpp_pay_Amt,"_empty_"," ") AND MATCH(fdpp_pay_Amt_Doc,"_empty_"," ") ErrMsg=ErrMsg+" Payment Amount"

%v_CCMJob% IF ALLTRIM(ErrMsg)<>"" PAUSE "Please Select a field for "+ErrMsg



^BATCH    B0901_Select_PO                    
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Convert, Link Fields from Source Data To Target Working File Table's Fields: PO Line Items
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF
FLAG_Show=T

DO B0902_Loop_Sel_PO WHILE ISBLANK(src_AP_PO)= T OR FLAG_Show=T

DO B0903_Match_PO_Mstr_Flds
IF exit=T ESCAPE


SET SAFETY ON
^BATCH    B0902_Loop_Sel_PO                  
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - Select the source table that you want to link to the Vendor Master File
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************

FLAG_Show=F
SET FOLDER /%fld_Tmps%

COMM *** List Table Names ***
CLOSE
DIR %fld_Sources%*.fil SUB TO "%fld_Tmps%CVT_Tables"

OPEN CVT_Tables
DELETE FIELD Table_Name OK
DEFINE FIELD Table_Name COMPUTED ALLTRIM(SPLIT(SPLIT(FILE_NAME,"\",OCCURS(FILE_NAME,"\")+1),".",1))

v_Table_Names=BLANKS(10000)
v_counter=0
COUNT

GROUP IF NOT ISBLANK(Table_Name)
 LOOP WHILE v_counter<=COUNT1
  v_Table_Names = ALLTRIM(v_Table_Names) + ALLTRIM(RECOFFSET(Table_Name,v_counter)) + ";"
  v_counter = v_counter + 1
 END
END

v_Table_Names=REPLACE(ALLTRIM(REPLACE(v_Table_Names,";"," "))," ",";")

LOCATE IF Table_Name="%src_AP_PO%"
v_default=RECNO()

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data Mapping - PO Items" WIDTH 523 HEIGHT 167 ) (BUTTONSET TITLE "&OK;&Cancel" AT 372 72 DEFAULT 1 ) (DROPDOWN TITLE "%v_Table_Names%" TO "src_AP_PO" AT 48 72 WIDTH 234 HEIGHT 126 DEFAULT %v_default%) (TEXT TITLE "Select a source table match to the target table - Vendor Master File Table" AT 48 40 )

%v_CCMJob% IF ISBLANK(src_AP_PO)= T PAUSE "Please select a file that maps to PO Line Items"


^BATCH    B0903_Match_PO_Mstr_Flds           
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Link Fields from Source Data To Target Working File Table's Fields: PO Line Items
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF
exit=F
FLAG_Show=T

OPEN %src_AP_PO%

DELETE FIELD _empty_ OK
DEFINE FIELD _empty_ COMPUTED ""

DO B0904_Loop_Match_PO WHILE FLAG_Show=T OR MATCH(fdpo_Vndr_Site_ID,"_empty_"," ") OR MATCH(fdpo_Vndr_ID,"_empty_"," ") OR MATCH(fdpo_PO_NO,"_empty_"," ") OR MATCH(fdpo_PO_Date,"_empty_"," ") OR MATCH(fdpo_Amount,"_empty_"," ")

IF exit=T ESCAPE

COMM *** Extracting fields to master table from Source ***

SET FOLDER /%fld_Workings%
OPEN %src_AP_PO%

v_Flds_Extract="ALLTRIM(%fdpo_Vndr_Site_ID%) AS 'Vndr_Site_ID' ALLTRIM(%fdpo_Vndr_ID%) AS 'Vndr_ID' ALLTRIM(%fdpo_PO_NO%) AS 'PO_NO' %fdpo_PO_Date% AS 'PO_Date' %fdpo_Amount% AS 'Amount'"

IF NOT MATCH(fdpo_Net_Price,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpo_Net_Price% AS 'Net_Price'"
IF MATCH(fdpo_Net_Price,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',2) AS 'Net_Price'"

IF NOT MATCH(fdpo_PO_Qty,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpo_PO_Qty% AS 'PO_Qty'"
IF MATCH(fdpo_PO_Qty,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',2) AS 'PO_Qty'"

IF NOT MATCH(fdpo_Rec_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpo_Rec_Dt% AS 'Rec_Dt'"
IF MATCH(fdpo_Rec_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Rec_Dt'"

IF NOT MATCH(fdpo_Rec_Qty,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpo_Rec_Qty% AS 'Rec_Qty'"
IF MATCH(fdpo_Rec_Qty,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',2) AS 'Rec_Qty'"

IF NOT MATCH(fdpo_Rec_Amt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpo_Rec_Amt% AS 'Rec_Amt'"
IF MATCH(fdpo_Rec_Amt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',2) AS 'Rec_Amt'"

IF NOT MATCH(fdpo_Gst_Amt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpo_Gst_Amt% AS 'Gst_Amt'"
IF MATCH(fdpo_Gst_Amt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',2) AS 'Gst_Amt'"

IF NOT MATCH(fdpo_PO_Line_No,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpo_PO_Line_No%) AS 'PO_Line_No'"
IF MATCH(fdpo_PO_Line_No,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(21) AS 'PO_Line_No'"

IF NOT MATCH(fdpo_Item_Cd,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpo_Item_Cd%) AS 'Item_Cd'"
IF MATCH(fdpo_Item_Cd,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Item_Cd'"

IF NOT MATCH(fdpo_Item_Desc,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpo_Item_Desc%) AS 'Item_Desc'"
IF MATCH(fdpo_Item_Desc,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(60) AS 'Item_Desc'"

IF NOT MATCH(fdpo_Num_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpo_Num_Field1% AS 'Num_Field1'"
IF MATCH(fdpo_Num_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',2) AS 'Num_Field1'"

IF NOT MATCH(fdpo_Num_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpo_Num_Field2% AS 'Num_Field2'"
IF MATCH(fdpo_Num_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',2) AS 'Num_Field2'"

IF NOT MATCH(fdpo_Num_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpo_Num_Field3% AS 'Num_Field3'"
IF MATCH(fdpo_Num_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',2) AS 'Num_Field3'"

IF NOT MATCH(fdpo_Num_Field4,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpo_Num_Field4% AS 'Num_Field4'"
IF MATCH(fdpo_Num_Field4,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',2) AS 'Num_Field4'"

IF NOT MATCH(fdpo_Num_Field5,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpo_Num_Field5% AS 'Num_Field5'"
IF MATCH(fdpo_Num_Field5,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',2) AS 'Num_Field5'"

IF NOT MATCH(fdpo_Dt_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpo_Dt_Field1% AS 'Dt_Field1'"
IF MATCH(fdpo_Dt_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Dt_Field1'"

IF NOT MATCH(fdpo_Dt_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpo_Dt_Field2% AS 'Dt_Field2'"
IF MATCH(fdpo_Dt_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Dt_Field2'"

IF NOT MATCH(fdpo_Dt_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpo_Dt_Field3% AS 'Dt_Field3'"
IF MATCH(fdpo_Dt_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Dt_Field3'"

IF NOT MATCH(fdpo_Cha_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpo_Cha_Field1%) AS 'Cha_Field1'"
IF MATCH(fdpo_Cha_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field1'"

IF NOT MATCH(fdpo_Cha_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpo_Cha_Field2%) AS 'Cha_Field2'"
IF MATCH(fdpo_Cha_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field2'"

IF NOT MATCH(fdpo_Cha_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpo_Cha_Field3%) AS 'Cha_Field3'"
IF MATCH(fdpo_Cha_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field3'"

IF NOT MATCH(fdpo_Cha_Field4,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpo_Cha_Field4%) AS 'Cha_Field4'"
IF MATCH(fdpo_Cha_Field4,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field4'"

IF NOT MATCH(fdpo_Cha_Field5,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpo_Cha_Field5%) AS 'Cha_Field5'"
IF MATCH(fdpo_Cha_Field5,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field5'"

COMM EXTRACT FIELDS %v_Flds_Extract% TO "%fld_Workings%%trg_AP_PO%.FIL"

DELETE FIELD _empty_ OK 

EXTRACT FIELDS %v_Flds_Extract% TO "%fld_Tmps%TMP_Mapping.FIL" OPEN
  
COMM *** Update the fields linkage information into Data mapping Table, So the user can reuse the mapping information next time ***

v_fd="fdpo"
v_dm_tbl_Nme="DM_%trg_AP_PO%"
v_src_tbl_Nme='%src_AP_PO%'

DO LE004_Upt_Mapping

DELETE FORMAT TMP_Mapping OK
DELETE "%fld_Tmps%TMP_Mapping.FIL" OK


^BATCH    B0904_Loop_Match_PO                
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - PO Line Items 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************

FLAG_Show=F

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data File Setup - PO Line Items" WIDTH 1019 HEIGHT 543 ) (BUTTONSET TITLE "&OK;&Cancel" AT 768 420 DEFAULT 1 ) (TEXT TITLE "Please link the fields from source file to  standard file - PO Line Items" AT 96 16 WIDTH 432 CENTER ) (ITEM TITLE "C" TO "fdpo_Vndr_ID" AT 324 108 WIDTH 178 DEFAULT "%fdpo_Vndr_ID%" ) (TEXT TITLE "Vendor Number / Supplier Number *" AT 12 112 WIDTH 280 RIGHT ) (ITEM TITLE "C" TO "fdpo_PO_NO" AT 324 132 WIDTH 178 DEFAULT "%fdpo_PO_NO%" ) (TEXT TITLE "Purchase Order Number*" AT 12 136 WIDTH 280 RIGHT ) (ITEM TITLE "DC" TO "fdpo_PO_Date" AT 324 156 WIDTH 179 DEFAULT "%fdpo_PO_Date%" ) (TEXT TITLE "Purchase Order Date*" AT 12 160 WIDTH 280 HEIGHT 20 RIGHT ) (ITEM TITLE "NC" TO "fdpo_Amount" AT 324 180 WIDTH 179 DEFAULT "%fdpo_Amount%" ) (TEXT TITLE "PO Item Amount*" AT 12 184 WIDTH 280 RIGHT ) (ITEM TITLE "NC" TO "fdpo_PO_Qty" AT 324 204 WIDTH 179 DEFAULT "%fdpo_PO_Qty%" ) (CHECKBOX TITLE "To exit/Escape" TO "exit" AT 756 492 WIDTH 100 ) (TEXT TITLE "Standard Table Fields" AT 168 52 ) (TEXT TITLE "Source Table Fields" AT 348 52 CENTER ) (TEXT TITLE "Line Item Number" AT 12 232 WIDTH 280 RIGHT ) (TEXT TITLE "Unit Net Price" AT 12 256 WIDTH 280 RIGHT ) (TEXT TITLE "Gst Amount" AT 12 400 WIDTH 280 RIGHT ) (TEXT TITLE "PO Quantity" AT 12 208 WIDTH 280 RIGHT ) (ITEM TITLE "C" TO "fdpo_PO_Line_No" AT 324 228 WIDTH 179 DEFAULT "%fdpo_PO_Line_No%" ) (ITEM TITLE "NC" TO "fdpo_Net_Price" AT 324 252 WIDTH 179 DEFAULT "%fdpo_Net_Price%" ) (ITEM TITLE "NC" TO "fdpo_Gst_Amt" AT 324 396 WIDTH 179 DEFAULT "%fdpo_Gst_Amt%" ) (TEXT TITLE "Source Table Name " AT 564 16 RIGHT ) (TEXT TITLE "%src_AP_PO%" AT 720 16 WIDTH 252 ) (TEXT TITLE "Standard Table Fields" AT 540 52 CENTER ) (TEXT TITLE "Source Table Fields" AT 732 52 CENTER ) (TEXT TITLE "Numeric Spare Field 1" AT 504 88 WIDTH 170 RIGHT ) (TEXT TITLE "Numeric Spare Field 2" AT 504 112 WIDTH 170 RIGHT ) (TEXT TITLE "Numeric Spare Field 3" AT 504 136 WIDTH 170 RIGHT ) (TEXT TITLE "Numeric Spare Field 4" AT 504 160 WIDTH 170 RIGHT ) (TEXT TITLE "Numeric Spare Field 5" AT 504 184 WIDTH 170 RIGHT ) (TEXT TITLE "Date Spare Field 1" AT 504 208 WIDTH 170 RIGHT ) (TEXT TITLE "Date Spare Field 2" AT 504 232 WIDTH 170 RIGHT ) (TEXT TITLE "Date Spare Field 3" AT 504 256 WIDTH 170 RIGHT ) (TEXT TITLE "Character Spare Field 1" AT 504 280 WIDTH 170 RIGHT ) (TEXT TITLE "Character Spare Field 3" AT 504 328 WIDTH 170 RIGHT ) (TEXT TITLE "Character Spare Field 2" AT 504 304 WIDTH 170 RIGHT ) (TEXT TITLE "Character Spare Field 4" AT 504 352 WIDTH 170 RIGHT ) (TEXT TITLE "Character Spare Field 5" AT 504 376 WIDTH 170 RIGHT ) (ITEM TITLE "NC" TO "fdpo_Num_Field1" AT 708 84 WIDTH 178 DEFAULT "%fdpo_Num_Field1%" ) (ITEM TITLE "NC" TO "fdap_Num_Field2" AT 708 108 WIDTH 178 DEFAULT "%fdpo_Num_Field2%" ) (ITEM TITLE "NC" TO "fdpo_Num_Field3" AT 708 132 WIDTH 178 DEFAULT "%fdpo_Num_Field3%" ) (ITEM TITLE "NC" TO "fdpo_Num_Field4" AT 708 156 WIDTH 178 DEFAULT "%fdpo_Num_Field4%" ) (ITEM TITLE "NC" TO "fdpo_Num_Field5" AT 708 180 WIDTH 178 DEFAULT "%fdpo_Num_Field5%" ) (ITEM TITLE "DC" TO "fdpo_Dt_Field1" AT 708 204 WIDTH 178 DEFAULT "%fdpo_Dt_Field1%" ) (ITEM TITLE "DC" TO "fdpo_Dt_Field2" AT 708 228 WIDTH 178 DEFAULT "%fdpo_Dt_Field2%" ) (ITEM TITLE "DC" TO "fdpo_Dt_Field3" AT 708 252 WIDTH 178 DEFAULT "%fdpo_Dt_Field3%" ) (ITEM TITLE "C" TO "fdpo_Cha_Field1" AT 708 276 WIDTH 178 DEFAULT "%fdpo_Cha_Field1%" ) (ITEM TITLE "C" TO "fdpo_Cha_Field2" AT 708 300 WIDTH 178 DEFAULT "%fdpo_Cha_Field2%" ) (ITEM TITLE "C" TO "fdpo_Cha_Field3" AT 708 324 WIDTH 178 DEFAULT "%fdpo_Cha_Field3%" ) (ITEM TITLE "C" TO "fdpo_Cha_Field4" AT 708 348 WIDTH 178 DEFAULT "%fdpo_Cha_Field4%" ) (ITEM TITLE "C" TO "fdpo_Cha_Field5" AT 708 372 WIDTH 178 DEFAULT "%fdpo_Cha_Field5%" ) (TEXT TITLE "Item Description" AT 12 376 WIDTH 280 RIGHT ) (ITEM TITLE "C" TO "fdpo_Item_Desc" AT 324 372 WIDTH 178 DEFAULT "%fdpo_Item_Desc%" ) (TEXT TITLE "Item Code" AT 12 352 WIDTH 280 RIGHT ) (ITEM TITLE "C" TO "fdpo_Item_Cd" AT 324 348 WIDTH 178 DEFAULT "%fdpo_Item_Cd%" ) (TEXT TITLE "Received Quantity" AT 12 304 WIDTH 280 RIGHT ) (ITEM TITLE "NC" TO "fdpo_Rec_Qty" AT 324 300 WIDTH 178 DEFAULT "%fdpo_Rec_Qty%" ) (ITEM TITLE "NC" TO "fdpo_Rec_Amt" AT 324 324 WIDTH 178 DEFAULT "%fdpo_Rec_Amt%" ) (TEXT TITLE "Received Amount" AT 12 328 WIDTH 280 RIGHT ) (TEXT TITLE "Received Date" AT 12 280 WIDTH 280 RIGHT ) (ITEM TITLE "DC" TO "fdpo_Rec_Dt" AT 324 276 WIDTH 178 DEFAULT "%fdpo_Rec_Dt%" ) (ITEM TITLE "C" TO "fdpo_Vndr_Site_ID" AT 324 84 WIDTH 178 DEFAULT "%fdpo_Vndr_Site_ID%" ) (TEXT TITLE "Vendor ID / Supplier Unique Key*" AT 12 88 WIDTH 280 RIGHT )

IF exit=T ESCAPE

ErrMsg=""
IF MATCH(fdpo_Vndr_Site_ID,"_empty_"," ") ErrMsg="Vendor Unique Key"
IF MATCH(fdpo_Vndr_ID,"_empty_"," ") ErrMsg="Vendor Number"
IF MATCH(fdpo_PO_NO,"_empty_"," ") ErrMsg=ErrMsg+" PO Number"
IF MATCH(fdpo_PO_Date,"_empty_"," ") ErrMsg=ErrMsg+" PO Date"
IF MATCH(fdpo_Amount,"_empty_"," ") ErrMsg=ErrMsg+" Amount"


%v_CCMJob% IF ALLTRIM(ErrMsg)<>"" PAUSE "Please Select a field for "+ErrMsg
^BATCH    B1001_Select_Emp                   
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Convert, Link Fields from Source Data To Target Working File Table's Fields: Vendor Master File
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF
FLAG_Show=T

DO B1002_Loop_Sel_Emp WHILE ISBLANK(src_EMF)= T OR FLAG_Show=T

DO B1003_Match_Emp_Mstr_Flds
IF exit=T ESCAPE

SET SAFETY ON

^BATCH    B1002_Loop_Sel_Emp                 
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - Select the source table that you want to link to the Employee Master File
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************

FLAG_Show=F
SET FOLDER /%fld_Tmps%

COMM *** List Table Names ***
CLOSE
DIR %fld_Sources%*.fil SUB TO "%fld_Tmps%CVT_Tables"

OPEN CVT_Tables
DELETE FIELD Table_Name OK
DEFINE FIELD Table_Name COMPUTED ALLTRIM(SPLIT(SPLIT(FILE_NAME,"\",OCCURS(FILE_NAME,"\")+1),".",1))

v_Table_Names=BLANKS(10000)
v_counter=0
COUNT

GROUP IF NOT ISBLANK(Table_Name)
 LOOP WHILE v_counter<=COUNT1
  v_Table_Names = ALLTRIM(v_Table_Names) + ALLTRIM(RECOFFSET(Table_Name,v_counter)) + ";"
  v_counter = v_counter + 1
 END
END

v_Table_Names=REPLACE(ALLTRIM(REPLACE(v_Table_Names,";"," "))," ",";")

LOCATE IF Table_Name="%src_EMF%"
v_default=RECNO()

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data Mapping - Employee Master" WIDTH 523 HEIGHT 167 ) (BUTTONSET TITLE "&OK;&Cancel" AT 372 72 DEFAULT 1 ) (DROPDOWN TITLE "%v_Table_Names%" TO "src_EMF" AT 48 72 WIDTH 234 HEIGHT 126 DEFAULT %v_default%) (TEXT TITLE "Select a source table match to the target table - Vendor Master File Table" AT 48 40 )

%v_CCMJob% IF ISBLANK(src_EMF)= T PAUSE "Please select a file that maps to Employee Master File"


^BATCH    B1003_Match_Emp_Mstr_Flds          
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Link Fields from Source Data To Target Working File Table's Fields: Vendor Master File
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF
exit=F
FLAG_Show=T

OPEN %src_EMF%
DELETE FIELD _empty_ OK
DEFINE FIELD _empty_ COMPUTED ""

DO B1004_Loop_Match_Emp WHILE FLAG_Show=T OR MATCH(fdem_Co_Emp_ID,"_empty_"," ") OR MATCH(fdem_Emp_ID,"_empty_"," ") OR MATCH(fdem_Sur_Nme,"_empty_"," ") OR MATCH(fdem_Emp_Sts,"_empty_"," ") OR MATCH(fdem_Add1,"_empty_"," ")

IF exit=T ESCAPE

COMM *** Extracting fields to master table from Source ***

v_Flds_Extract="ALLTRIM(%fdem_Co_Emp_ID%) AS 'Co_Emp_ID' ALLTRIM(%fdem_Emp_ID%) AS 'Emp_ID' ALLTRIM(fdem_Sur_Nme) AS 'Sur_Nme' ALLTRIM(%fdem_Add1%) AS 'Add1'"

IF NOT MATCH(fdem_Emp_Sts,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdem_Emp_Sts% AS 'Emp_Sts'"
IF MATCH(fdem_Emp_Sts,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(1) AS 'Emp_Sts'"

IF NOT MATCH(fdem_Co,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_Co%) AS 'Co'"
IF MATCH(fdem_Co,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Co'"

IF NOT MATCH(fdem_COST_CENTRE,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_COST_CENTRE%) AS 'COST_CENTRE'"
IF MATCH(fdem_COST_CENTRE,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(19) AS 'COST_CENTRE'"

IF NOT MATCH(fdem_Title,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_Title%) AS 'Title'"
IF MATCH(fdem_Title,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(5) AS 'Title'"

IF NOT MATCH(fdem_Tax_Fle_Num,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_Tax_Fle_Num%) AS 'Tax_Fle_Num'"
IF MATCH(fdem_Tax_Fle_Num,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Tax_Fle_Num'"

IF NOT MATCH(fdem_Tax_Scale,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdem_Tax_Scale% AS 'Tax_Scale'"
IF MATCH(fdem_Tax_Scale,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(9) AS 'Tax_Scale'"

IF NOT MATCH(fdem_Frst_Nme,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_Frst_Nme%) AS 'Frst_Nme'"
IF MATCH(fdem_Frst_Nme,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Frst_Nme'"

IF NOT MATCH(fdem_Second_Given_Name,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_Second_Given_Name%) AS 'Second_Given_Name'"
IF MATCH(fdem_Second_Given_Name,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Second_Given_Name'"

IF NOT MATCH(fdem_Add2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_Add2%) AS 'Add2'"
IF MATCH(fdem_Add2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(61) AS 'Add2'"

IF NOT MATCH(fdem_Add3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_Add3%) AS 'Add3'"
IF MATCH(fdem_Add3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(61) AS 'Add3'"

IF NOT MATCH(fdem_City,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_City%) AS 'City'"
IF MATCH(fdem_City,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(35) AS 'City'"

IF NOT MATCH(fdem_State,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_State%) AS 'State'"
IF MATCH(fdem_State,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(29) AS 'State'"

IF NOT MATCH(fdem_PCode,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_PCode%) AS 'PCode'"
IF MATCH(fdem_PCode,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(11) AS 'PCode'"

IF NOT MATCH(fdem_Cntry,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_Cntry%) AS 'Cntry'"
IF MATCH(fdem_Cntry,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(61) AS 'Cntry'"

IF NOT MATCH(fdem_TEL1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_TEL1%) AS 'TEL1'"
IF MATCH(fdem_TEL1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(21) AS 'TEL1'"

IF NOT MATCH(fdem_TEL2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_TEL2%) AS 'TEL2'"
IF MATCH(fdem_TEL2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(21) AS 'TEL2'"

IF NOT MATCH(fdem_TEL3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_TEL3%) AS 'TEL3'"
IF MATCH(fdem_TEL3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(21) AS 'TEL3'"

IF NOT MATCH(fdem_Fax,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_Fax%) AS 'Fax'"
IF MATCH(fdem_Fax,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(21) AS 'Fax'"

IF NOT MATCH(fdem_Email_Bus,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_Email_Bus%) AS 'Email_Bus'"
IF MATCH(fdem_Email_Bus,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(40) AS 'Email_Bus'"

IF NOT MATCH(fdem_Email_Privt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_Email_Privt%) AS 'Email_Privt'"
IF MATCH(fdem_Email_Privt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(36) AS 'Email_Privt'"

IF NOT MATCH(fdem_DOB,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdem_DOB% AS 'DOB'"
IF MATCH(fdem_DOB,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(10) AS 'DOB'"

IF NOT MATCH(fdem_Sex,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_Sex%) AS 'Sex'"
IF MATCH(fdem_Sex,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(3) AS 'Sex'"

IF NOT MATCH(fdem_Hire_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdem_Hire_Dt% AS 'Hire_Dt'"
IF MATCH(fdem_Hire_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Hire_Dt'"

IF NOT MATCH(fdem_Trm_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdem_Trm_Dt% AS 'Trm_Dt'"
IF MATCH(fdem_Trm_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Trm_Dt'"

IF NOT MATCH(fdem_Term_Reason_Desc,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_Term_Reason_Desc%) AS 'Term_Reason_Desc'"
IF MATCH(fdem_Term_Reason_Desc,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(30) AS 'Term_Reason_Desc'"

IF NOT MATCH(fdem_Mrtl_Sts,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdem_Mrtl_Sts% AS 'Mrtl_Sts'"
IF MATCH(fdem_Mrtl_Sts,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(14) AS 'Mrtl_Sts'"

IF NOT MATCH(fdem_Pref_Nme,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_Pref_Nme%) AS 'Pref_Nme'"
IF MATCH(fdem_Pref_Nme,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(22) AS 'Pref_Nme'"

IF NOT MATCH(fdem_Prev_Sur_Nme,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_Prev_Sur_Nme%) AS 'Prev_Sur_Nme'"
IF MATCH(fdem_Prev_Sur_Nme,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(16) AS 'Prev_Sur_Nme'"

IF NOT MATCH(fdem_PAY_CLASS_CODE,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_PAY_CLASS_CODE%) AS 'PAY_CLASS_CODE'"
IF MATCH(fdem_PAY_CLASS_CODE,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(14) AS 'PAY_CLASS_CODE'"

IF NOT MATCH(fdem_PAY_RATE,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdem_PAY_RATE% AS 'PAY_RATE'"
IF MATCH(fdem_PAY_RATE,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',4) AS 'PAY_RATE'"

IF NOT MATCH(fdem_AVG_TRANS_RATE,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdem_AVG_TRANS_RATE% AS 'AVG_TRANS_RATE'"
IF MATCH(fdem_AVG_TRANS_RATE,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',4) AS 'AVG_TRANS_RATE'"

IF NOT MATCH(fdem_YEARLY_SALARY,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdem_YEARLY_SALARY% AS 'YEARLY_SALARY'"
IF MATCH(fdem_YEARLY_SALARY,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',2) AS 'YEARLY_SALARY'"

IF NOT MATCH(fdem_AUTOPAY_HOURS_DAYS,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdem_AUTOPAY_HOURS_DAYS% AS 'AUTOPAY_HOURS_DAYS'"
IF MATCH(fdem_AUTOPAY_HOURS_DAYS,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',2) AS 'AUTOPAY_HOURS_DAYS'"

IF NOT MATCH(fdem_Emp_Catg,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_Emp_Catg%) AS 'Emp_Catg'"
IF MATCH(fdem_Emp_Catg,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(12) AS 'Emp_Catg'"

IF NOT MATCH(fdem_Created_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdem_Created_Dt% AS 'Created_Dt'"
IF MATCH(fdem_Created_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(10) AS 'Created_Dt'"

IF NOT MATCH(fdem_Modf_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdem_Modf_Dt% AS 'Modf_Dt'"
IF MATCH(fdem_Modf_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(10) AS 'Modf_Dt'"

IF NOT MATCH(fdem_Cha_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_Cha_Field1%) AS 'Cha_Field1'"
IF MATCH(fdem_Cha_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field1'"

IF NOT MATCH(fdem_Cha_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_Cha_Field2%) AS 'Cha_Field2'"
IF MATCH(fdem_Cha_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field2'"

IF NOT MATCH(fdem_Cha_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_Cha_Field3%) AS 'Cha_Field3'"
IF MATCH(fdem_Cha_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field3'"

IF NOT MATCH(fdem_Cha_Field4,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_Cha_Field4%) AS 'Cha_Field4'"
IF MATCH(fdem_Cha_Field4,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field4'"

IF NOT MATCH(fdem_Cha_Field5,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdem_Cha_Field5%) AS 'Cha_Field5'"
IF MATCH(fdem_Cha_Field5,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field5'"

COMM EXTRACT FIELDS %v_Flds_Extract%  TO "%fld_Workings%%trg_EMF%.FIL"

DELETE FIELD _empty_ OK
  
EXTRACT FIELDS %v_Flds_Extract% TO "%fld_Tmps%TMP_Mapping.FIL" OPEN
  
COMM *** Update the fields linkage information into Data mapping Table, So the user can reuse the mapping information next time ***

v_fd="fdem"
v_dm_tbl_Nme="DM_%trg_EMF%"
v_src_tbl_Nme='%src_EMF%'

DO LE004_Upt_Mapping

DELETE FORMAT TMP_Mapping OK
DELETE "%fld_Tmps%TMP_Mapping.FIL" OK


^BATCH    B1004_Loop_Match_Emp               
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - Employee Master File 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


FLAG_Show=F

COMM Jeffrey Alvin 6/4/2013 Add asterisk to Address 1 field to denote mandatory field
%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data File Setup - Employee Master File" WIDTH 994 HEIGHT 689 ) (BUTTONSET TITLE "&OK;&Cancel" AT 744 600 DEFAULT 1 ) (TEXT TITLE "Please link the fields from source file to  standard file - Employee Master File" AT 120 16 WIDTH 488 CENTER ) (ITEM TITLE "C" TO "fdem_Co_Emp_ID" AT 300 84 WIDTH 178 DEFAULT "%fdem_Co_Emp_ID%" ) (TEXT TITLE "Employee Unique Key / ID*" AT 24 88 WIDTH 240 RIGHT ) (ITEM TITLE "C" TO "fdem_Co" AT 300 108 WIDTH 178 DEFAULT "%fdem_Co%" ) (TEXT TITLE "Company Code" AT 24 112 WIDTH 240 RIGHT ) (ITEM TITLE "NC" TO "fdem_Cost_Centre" AT 300 132 WIDTH 179 DEFAULT "%fdem_Cost_Centre%" ) (TEXT TITLE "Cost Center / Department" AT 24 136 WIDTH 240 HEIGHT 20 RIGHT ) (ITEM TITLE "NC" TO "fdem_Emp_Sts" AT 300 156 WIDTH 179 DEFAULT "%fdem_Emp_Sts%" ) (TEXT TITLE "Employee Status *" AT 24 160 WIDTH 240 RIGHT ) (ITEM TITLE "C" TO "fdem_Emp_ID" AT 300 180 WIDTH 179 DEFAULT "%fdem_Emp_ID%" ) (CHECKBOX TITLE "To exit/Escape" TO "exit" AT 744 660 WIDTH 100 ) (TEXT TITLE "Standard Table Fields" AT 108 52 ) (TEXT TITLE "Source Table Fields" AT 312 52 ) (TEXT TITLE "Tax File Number" AT 24 208 WIDTH 240 RIGHT ) (TEXT TITLE "Tax Scale" AT 24 232 WIDTH 240 RIGHT ) (TEXT TITLE "Title" AT 24 256 WIDTH 240 RIGHT ) (TEXT TITLE "First Name" AT 24 280 WIDTH 240 RIGHT ) (TEXT TITLE "Second Given Name" AT 24 304 WIDTH 240 RIGHT ) (TEXT TITLE "SurName / Family Name*" AT 24 328 WIDTH 240 RIGHT ) (TEXT TITLE "Address 1*" AT 24 352 WIDTH 240 RIGHT ) (TEXT TITLE "Suburb / City" AT 24 424 WIDTH 240 RIGHT ) (TEXT TITLE "Post Code" AT 24 472 WIDTH 240 RIGHT ) (TEXT TITLE "Telephone 1" AT 24 520 WIDTH 240 RIGHT ) (TEXT TITLE "Telephone 2" AT 24 544 WIDTH 240 RIGHT ) (TEXT TITLE "Telephone 3" AT 24 568 WIDTH 240 RIGHT ) (TEXT TITLE "Employee Code*" AT 24 184 WIDTH 240 RIGHT ) (TEXT TITLE "Fax" AT 24 592 WIDTH 240 RIGHT ) (ITEM TITLE "C" TO "fdem_Tax_Fle_Num" AT 300 204 WIDTH 179 DEFAULT "%fdem_Tax_Fle_Num%" ) (ITEM TITLE "C" TO "fdem_Tax_Scale" AT 300 228 WIDTH 179 DEFAULT "%fdem_Tax_Scale%" ) (ITEM TITLE "C" TO "fdem_Title" AT 300 252 WIDTH 179 DEFAULT "%fdem_Title%" ) (ITEM TITLE "C" TO "fdem_Frst_Nme" AT 300 276 WIDTH 179 DEFAULT "%fdem_Frst_Nme%" ) (ITEM TITLE "C" TO "fdem_Second_Given_Name" AT 300 300 WIDTH 179 DEFAULT "%fdem_Second_Given_Name%" ) (ITEM TITLE "C" TO "fdem_Sur_Nme" AT 300 324 WIDTH 179 DEFAULT "%fdem_Sur_Nme%" ) (ITEM TITLE "C" TO "fdem_Add1" AT 300 348 WIDTH 179 DEFAULT "%fdem_Add1%" ) (ITEM TITLE "C" TO "fdem_City" AT 300 420 WIDTH 179 DEFAULT "%fdem_City%" ) (ITEM TITLE "C" TO "fdem_State" AT 300 444 WIDTH 179 DEFAULT "%fdem_State%" ) (ITEM TITLE "C" TO "fdem_PCode" AT 300 468 WIDTH 179 DEFAULT "%fdem_PCode%" ) (ITEM TITLE "C" TO "fdem_Cntry" AT 300 492 WIDTH 179 DEFAULT "%fdem_Cntry%" ) (ITEM TITLE "C" TO "fdem_TEL1" AT 300 516 WIDTH 179 DEFAULT "%fdem_TEL1%" ) (ITEM TITLE "C" TO "fdem_TEL2" AT 300 540 WIDTH 179 DEFAULT "%fdem_TEL2%" ) (ITEM TITLE "C" TO "fdem_TEL3" AT 300 564 WIDTH 179 DEFAULT "%fdem_TEL3%" ) (ITEM TITLE "C" TO "fdem_Fax" AT 300 588 WIDTH 179 DEFAULT "%fdem_Fax%" ) (TEXT TITLE "State" AT 24 448 WIDTH 240 RIGHT ) (TEXT TITLE "Source Table Name " AT 612 16 WIDTH 105 RIGHT ) (TEXT TITLE "%src_EMF% " AT 732 16 WIDTH 228 ) (TEXT TITLE "Country" AT 24 496 WIDTH 240 RIGHT ) (TEXT TITLE "Email (Business)" AT 84 640 WIDTH 180 RIGHT ) (TEXT TITLE "Email (Private)" AT 84 616 WIDTH 180 RIGHT ) (TEXT TITLE "Date of Birth" AT 504 136 WIDTH 180 RIGHT ) (TEXT TITLE "Sex" AT 504 160 WIDTH 180 RIGHT ) (TEXT TITLE "Hired Date*" AT 504 88 WIDTH 180 RIGHT ) (TEXT TITLE "Termination Date" AT 504 112 WIDTH 180 RIGHT ) (TEXT TITLE "Termination Reason Description" AT 492 184 WIDTH 195 RIGHT ) (TEXT TITLE "Marital Status" AT 504 208 WIDTH 180 RIGHT ) (TEXT TITLE "Prefer Name" AT 504 232 WIDTH 180 RIGHT ) (TEXT TITLE "Prefer Surname" AT 504 256 WIDTH 180 RIGHT ) (TEXT TITLE "Pay Class Code" AT 504 280 WIDTH 180 RIGHT ) (TEXT TITLE "Pay Rate" AT 504 304 WIDTH 180 RIGHT ) (TEXT TITLE "Average Transaction Rate" AT 504 328 WIDTH 180 RIGHT ) (TEXT TITLE "Yearly Salary" AT 504 352 WIDTH 180 RIGHT ) (TEXT TITLE "Auto Pay Hours / Days" AT 504 376 WIDTH 180 RIGHT ) (TEXT TITLE "Employee Category" AT 504 400 WIDTH 180 RIGHT ) (TEXT TITLE "Standard Table Fields" AT 552 52 CENTER ) (TEXT TITLE "Source Table Fields" AT 756 52 ) (ITEM TITLE "C" TO "fdem_Email_Bus" AT 300 636 WIDTH 179 DEFAULT "%fdem_Email_Bus%" ) (ITEM TITLE "C" TO "fdem_Email_Privt" AT 300 612 WIDTH 179 DEFAULT "%fdem_Email_Privt%" ) (ITEM TITLE "C" TO "fdem_DOB" AT 720 132 WIDTH 178 DEFAULT "%fdem_DOB%" ) (ITEM TITLE "C" TO "fdem_Sex" AT 720 156 WIDTH 178 DEFAULT "%fdem_Sex%" ) (ITEM TITLE "DC" TO "fdem_Hire_Dt" AT 720 84 WIDTH 178 DEFAULT "%fdem_Hire_Dt%" ) (ITEM TITLE "DC" TO "fdem_Trm_Dt" AT 720 108 WIDTH 178 DEFAULT "%fdem_Trm_Dt%" ) (ITEM TITLE "C" TO "fdem_Term_Reason_Desc" AT 720 180 WIDTH 178 DEFAULT "%fdem_Term_Reason_Desc%" ) (ITEM TITLE "C" TO "fdem_Mrtl_Sts" AT 720 204 WIDTH 178 DEFAULT "%fdem_Mrtl_Sts%" ) (ITEM TITLE "C" TO "fdem_Pref_Nme" AT 720 228 WIDTH 178 DEFAULT "%fdem_Pref_Nme%" ) (ITEM TITLE "C" TO "fdem_Prev_Sur_Nme" AT 720 252 WIDTH 178 DEFAULT "%fdem_Prev_Sur_Nme%" ) (ITEM TITLE "C" TO "fdem_Pay_Class_Code" AT 720 276 WIDTH 178 DEFAULT "%fdem_Pay_Class_Code%" ) (ITEM TITLE "CN" TO "fdem_Pay_Rate" AT 720 300 WIDTH 178 DEFAULT "%fdem_Pay_Rate%" ) (ITEM TITLE "CN" TO "fdem_Avg_Trans_Rate" AT 720 324 WIDTH 178 DEFAULT "%fdem_Avg_Trans_Rate%" ) (ITEM TITLE "NC" TO "fdem_Yearly_Salary" AT 720 348 WIDTH 178 DEFAULT "%fdem_Yearly_Salary%" ) (ITEM TITLE "NC" TO "fdem_AutoPay_Hours_Days" AT 720 372 WIDTH 178 DEFAULT "%fdem_AutoPay_Hours_Days%" ) (ITEM TITLE "C" TO "fdem_Emp_Catg" AT 720 396 WIDTH 178 DEFAULT "%fdem_Emp_Catg%" ) (TEXT TITLE "Character Spare Field 1" AT 504 472 WIDTH 180 RIGHT ) (TEXT TITLE "Character Spare Field 2" AT 504 496 WIDTH 180 RIGHT ) (TEXT TITLE "Character Spare Field 3" AT 504 520 WIDTH 180 RIGHT ) (TEXT TITLE "Character Spare Field 4" AT 504 544 WIDTH 180 RIGHT ) (TEXT TITLE "Character Spare Field 5" AT 504 568 WIDTH 180 RIGHT ) (ITEM TITLE "C" TO "fdem_Cha_Field1" AT 720 468 WIDTH 178 DEFAULT "%fdem_Cha_Field1%" ) (ITEM TITLE "C" TO "fdem_Cha_Field2" AT 720 492 WIDTH 178 DEFAULT "%fdem_Cha_Field2%" ) (ITEM TITLE "C" TO "fdem_Cha_Field3" AT 720 516 WIDTH 178 DEFAULT "%fdem_Cha_Field3%" ) (ITEM TITLE "C" TO "fdem_Cha_Field4" AT 720 540 WIDTH 178 DEFAULT "%fdem_Cha_Field4%" ) (ITEM TITLE "C" TO "fdem_Cha_Field5" AT 720 564 WIDTH 178 DEFAULT "%fdem_Cha_Field5%" ) (ITEM TITLE "C" TO "fdem_Add2" AT 300 372 WIDTH 180 DEFAULT "%fdem_Add2%" ) (ITEM TITLE "C" TO "fdem_Add3" AT 300 396 WIDTH 180 DEFAULT "%fdem_Add3%" ) (TEXT TITLE "Address 2" AT 144 376 WIDTH 116 RIGHT ) (TEXT TITLE "Address3" AT 108 400 WIDTH 152 RIGHT ) (ITEM TITLE "dC" TO "fdem_Created_Dt" AT 720 420 WIDTH 177 DEFAULT "%fdem_Created_Dt%" ) (ITEM TITLE "DC" TO "fdem_Modf_Dt" AT 720 444 WIDTH 176 DEFAULT "%fdem_Modf_Dt%" ) (TEXT TITLE "Created Date" AT 504 424 WIDTH 180 RIGHT ) (TEXT TITLE "Modified Date" AT 504 448 WIDTH 180 RIGHT )

IF exit=T ESCAPE

ErrMsg=""
IF MATCH(fdem_Co_Emp_ID,"_empty_"," ") ErrMsg="Unique Key / ID"
IF MATCH(fdem_Emp_ID,"_empty_"," ") ErrMsg=ErrMsg+" Employee Code"
IF MATCH(fdem_Sur_Nme,"_empty_"," ") ErrMsg=ErrMsg+" Surname"
IF MATCH(fdem_Add1,"_empty_"," ") ErrMsg=ErrMsg+" Address"

%v_CCMJob% IF ALLTRIM(ErrMsg)<>"" PAUSE "Please Select a field for "+ErrMsg
^BATCH    B1101_Select_Emp_Bk                
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Convert, Link Fields from Source Data To Target Working File Table's Fields: Emp Bank Account
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF
FLAG_Show=T

DO B1102_Loop_Sel_Emp_Bk WHILE ISBLANK(src_EMF_BK)= T OR FLAG_Show=T

DO B1103_Match_Emp_Bk_Mstr_Flds
IF exit=T ESCAPE


SET SAFETY ON

^BATCH    B1102_Loop_Sel_Emp_Bk              
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - Select the source table that you want to link to the Emp Bank Accounts
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


FLAG_Show=F
SET FOLDER /%fld_Tmps%

COMM *** List Table Names ***
CLOSE
DIR %fld_Sources%*.fil SUB TO "%fld_Tmps%CVT_Tables"

OPEN CVT_Tables
DELETE FIELD Table_Name OK
DEFINE FIELD Table_Name COMPUTED ALLTRIM(SPLIT(SPLIT(FILE_NAME,"\",OCCURS(FILE_NAME,"\")+1),".",1))

v_Table_Names=BLANKS(10000)
v_counter=0
COUNT

GROUP IF NOT ISBLANK(Table_Name)
 LOOP WHILE v_counter<=COUNT1
  v_Table_Names = ALLTRIM(v_Table_Names) + ALLTRIM(RECOFFSET(Table_Name,v_counter)) + ";"
  v_counter = v_counter + 1
 END
END

v_Table_Names=REPLACE(ALLTRIM(REPLACE(v_Table_Names,";"," "))," ",";")

LOCATE IF Table_Name="%src_EMF_BK%"
v_default=RECNO()

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data Mapping - Emp Bank Accounts" WIDTH 523 HEIGHT 167 ) (BUTTONSET TITLE "&OK;&Cancel" AT 372 72 DEFAULT 1 ) (DROPDOWN TITLE "%v_Table_Names%" TO "src_EMF_BK" AT 48 72 WIDTH 234 HEIGHT 126 DEFAULT %v_default%) (TEXT TITLE "Select a source table match to the target table - Vendor Master File Table" AT 48 40 )

%v_CCMJob% IF ISBLANK(src_EMF_BK)= T PAUSE "Please select a file that maps to Employee Bank Account"


^BATCH    B1103_Match_Emp_Bk_Mstr_Flds       
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Link Fields from Source Data To Target Working File Table's Fields: Employee Bank Accounts
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF
exit=F
FLAG_Show=T

OPEN %src_EMF_BK%
DELETE FIELD _empty_ OK
DEFINE FIELD _empty_ COMPUTED ""

DO B1104_Loop_Match_Emp_Bk WHILE FLAG_Show=T OR MATCH(fdeb_Co_Emp_ID,"_empty_"," ") OR MATCH(fdeb_Emp_ID,"_empty_"," ")  OR MATCH(fdeb_Bnk_Acc_Num,"_empty_"," ")

IF exit=T ESCAPE
COMM *** Extracting fields to master table from Source ***

v_Flds_Extract="ALLTRIM(%fdeb_Co_Emp_ID%) AS 'Co_Emp_ID' ALLTRIM(%fdeb_Emp_ID%) AS 'Emp_ID' ALLTRIM(%fdeb_Bnk_Acc_Num%) AS 'Bnk_Acc_Num'"

IF NOT MATCH(fdeb_BSB,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdeb_BSB%) AS 'BSB'"
IF MATCH(fdeb_BSB,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(60) AS 'BSB'"

IF NOT MATCH(fdeb_BSB_Name,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdeb_BSB_Name%) AS 'BSB_Name'"
IF MATCH(fdeb_BSB_Name,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(60) AS 'BSB_Name'"

IF NOT MATCH(fdeb_Bnk_Acc_Name,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdeb_Bnk_Acc_Name%) AS 'Bnk_Acc_Name'"
IF MATCH(fdeb_Bnk_Acc_Name,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(60) AS 'Bnk_Acc_Name'"

IF NOT MATCH(fdeb_Bnk_Acc_Type,"_empty"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdeb_Bnk_Acc_Type%) AS 'Bnk_Acc_Type'"
IF MATCH(fdeb_Bnk_Acc_Type,"_empty"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(60) AS 'Bnk_Acc_Type'"

IF NOT MATCH(fdeb_Chg_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdeb_Chg_Dt% AS 'Chg_Dt'"
IF MATCH(fdeb_Chg_Dt,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(10) AS 'Chg_Dt'"

COMM EXTRACT FIELDS %v_Flds_Extract% TO "%fld_Workings%%trg_EMF_Bk%.FIL"

DELETE FIELD _empty_ OK

EXTRACT FIELDS %v_Flds_Extract% TO "%fld_Tmps%TMP_Mapping.FIL" OPEN
  
COMM *** Update the fields linkage information into Data mapping Table, So the user can reuse the mapping information next time ***

v_fd="fdeb"
v_dm_tbl_Nme="DM_%trg_EMF_BK%"
v_src_tbl_Nme='%src_EMF_BK%'

DO LE004_Upt_Mapping

DELETE FORMAT TMP_Mapping OK
DELETE "%fld_Tmps%TMP_Mapping.FIL" OK
^BATCH    B1104_Loop_Match_Emp_Bk            
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - Vendor Master File 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


FLAG_Show=F

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data File Setup - Employee Bank Account" WIDTH 857 HEIGHT 327 ) (BUTTONSET TITLE "&OK;&Cancel" AT 636 156 DEFAULT 1 ) (TEXT TITLE "Please link the fields from source file to  standard file - Employee Bank Account " AT 168 28 WIDTH 488 CENTER ) (ITEM TITLE "C" TO "fdeb_Co_Emp_ID" AT 348 108 WIDTH 178 DEFAULT "%fdeb_Co_Emp_ID%" ) (TEXT TITLE "Unique Key / ID / Company & Employe ID*" AT 60 112 WIDTH 223 RIGHT ) (CHECKBOX TITLE "To exit/Escape" TO "exit" AT 624 228 WIDTH 100 ) (TEXT TITLE "Standard Table Fields" AT 168 76 ) (TEXT TITLE "Source Table Fields" AT 360 76 ) (TEXT TITLE "BSB Code" AT 72 160 WIDTH 197 RIGHT ) (TEXT TITLE "BSB Name" AT 84 208 WIDTH 183 RIGHT ) (TEXT TITLE "Bank Account Number*" AT 48 184 WIDTH 231 RIGHT ) (TEXT TITLE "Bank Account Name" AT 60 232 WIDTH 213 RIGHT ) (ITEM TITLE "C" TO "fdeb_BSB" AT 348 156 WIDTH 179 DEFAULT "%fdeb_BSB%" ) (ITEM TITLE "C" TO "fdeb_Bnk_Acc_Num" AT 348 180 WIDTH 179 DEFAULT "%fdeb_Bnk_Acc_Num%" ) (ITEM TITLE "C" TO "fdeb_BSB_NAME" AT 348 204 WIDTH 179 DEFAULT "%fdeb_BSB_NAME%" ) (ITEM TITLE "C" TO "fdeb_Bnk_Acc_Name" AT 348 228 WIDTH 179 DEFAULT "%fdeb_Bnk_Acc_Name%" ) (TEXT TITLE "Source Table Name " AT 612 76 ) (TEXT TITLE "%src_EMF_BK%" AT 612 112 WIDTH 140 ) (ITEM TITLE "C" TO "fdeb_Emp_ID" AT 348 132 WIDTH 178 DEFAULT "%fdeb_Emp_ID%" ) (TEXT TITLE "Employee Code*" AT 72 136 WIDTH 201 RIGHT ) (TEXT TITLE "Bank Account Type" AT 144 256 WIDTH 129 RIGHT ) (ITEM TITLE "C" TO "fdeb_Bnk_Acc_Type" AT 348 252 WIDTH 179 DEFAULT "%fdeb_Bnk_Acc_Type%" )(TEXT TITLE "Changed Date" AT 108 280 WIDTH 175 RIGHT ) (ITEM TITLE "DC" TO "fdeb_Chg_Dt" AT 324 276 WIDTH 179 DEFAULT "%fdeb_Chg_Dt%" )


IF exit=T ESCAPE

ErrMsg=""
IF MATCH(fdeb_Co_Emp_ID,"_empty_"," ") ErrMsg="Unique Key / ID"
IF MATCH(fdeb_Emp_ID,"_empty_"," ") ErrMsg=ErrMsg+" Employee Code"
IF MATCH(fdeb_BSB,"_empty_"," ") ErrMsg=ErrMsg+" BSB Code"
IF MATCH(fdeb_Bnk_Acc_Num,"_empty_"," ") ErrMsg=ErrMsg+" Bank Account Number"

%v_CCMJob% IF ALLTRIM(ErrMsg)<>"" PAUSE "Please Select a field for "+ErrMsg


^BATCH    B1201_Select_PR_Pay                
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Convert, Link Fields from Source Data To Target Working File Table's Fields: Payroll Payments
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF
FLAG_Show=T

DO B1202_Loop_Sel_PR_Pay WHILE ISBLANK(src_PR_Pay)= T OR FLAG_Show=T

DO B1203_Match_PR_Pay_Mstr_Flds
IF exit=T ESCAPE


SET SAFETY ON

^BATCH    B1202_Loop_Sel_PR_Pay              
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - Select the source table that you want to link to the Payroll
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


FLAG_Show=F
SET FOLDER /%fld_Tmps%

COMM *** List Table Names ***
CLOSE
DIR %fld_Sources%*.fil SUB TO "%fld_Tmps%CVT_Tables"

OPEN CVT_Tables
DELETE FIELD Table_Name OK
DEFINE FIELD Table_Name COMPUTED ALLTRIM(SPLIT(SPLIT(FILE_NAME,"\",OCCURS(FILE_NAME,"\")+1),".",1))

v_Table_Names=BLANKS(10000)
v_counter=0
COUNT

GROUP IF NOT ISBLANK(Table_Name)
 LOOP WHILE v_counter<=COUNT1
  v_Table_Names = ALLTRIM(v_Table_Names) + ALLTRIM(RECOFFSET(Table_Name,v_counter)) + ";"
  v_counter = v_counter + 1
 END
END

v_Table_Names=REPLACE(ALLTRIM(REPLACE(v_Table_Names,";"," "))," ",";")

LOCATE IF Table_Name="%src_PR_Pay%"
v_default=RECNO()

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data Mapping" WIDTH 523 HEIGHT 167 ) (BUTTONSET TITLE "&OK;&Cancel" AT 372 72 DEFAULT 1 ) (DROPDOWN TITLE "%v_Table_Names%" TO "src_PR_Pay" AT 48 72 WIDTH 234 HEIGHT 126 DEFAULT %v_default%) (TEXT TITLE "Select a source table match to the target table - Vendor Master File Table" AT 48 40 )

%v_CCMJob% IF ISBLANK(src_PR_Pay)= T PAUSE "Please select a file that maps to Payroll Payments


^BATCH    B1203_Match_PR_Pay_Mstr_Flds       
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Link Fields from Source Data To Target Working File Table's Fields: Vendor Master File
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF
exit=F
FLAG_Show=T

OPEN %src_PR_Pay%
DELETE FIELD _empty_ OK
DEFINE FIELD _empty_ COMPUTED ""

DO B1204_Loop_Match_PR_Pay WHILE FLAG_Show=T OR MATCH(fdpr_Co_Emp_ID,"_empty_"," ") OR MATCH(fdpr_Emp_ID,"_empty_"," ") OR MATCH(fdpr_Prd_Dt,"_empty_"," ") OR MATCH(fdpr_PAYCODE,"_empty_"," ") OR MATCH(fdpr_PAYCODE_AMOUNTS,"_empty_"," "))

IF exit=T ESCAPE

COMM *** Extracting fields to master table from Source ***

OPEN %src_PR_Pay%

v_Flds_Extract="ALLTRIM(%fdpr_Co_Emp_ID%) AS 'Co_Emp_ID' ALLTRIM(%fdpr_Emp_ID%) AS 'Emp_ID' %fdpr_Prd_Dt% AS 'Prd_Dt' ALLTRIM(%fdpr_PAYCODE%) AS 'PAYCODE' %fdpr_PAYCODE_AMOUNTS% AS 'PAYCODE_AMOUNTS'"

IF NOT MATCH(fdpr_Co,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpr_Co%) AS 'Co'"
IF MATCH(fdpr_Co,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Co'"

IF NOT MATCH(fdpr_COST_CENTRE,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpr_COST_CENTRE%) AS 'COST_CENTRE'"
IF MATCH(fdpr_COST_CENTRE,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(19) AS 'COST_CENTRE'"

IF NOT MATCH(fdpr_PayCode_Desc,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpr_PayCode_Desc%) AS 'PayCode_Desc'"
IF MATCH(fdpr_PayCode_Desc,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(50) AS 'PayCode_Desc'"

IF NOT MATCH(fdpr_GL_ACCOUNT_NO,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpr_GL_ACCOUNT_NO%) AS 'GL_ACCOUNT_NO'"
IF MATCH(fdpr_GL_ACCOUNT_NO,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'GL_ACCOUNT_NO'"

IF NOT MATCH(fdpr_LINE_NO,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpr_LINE_NO%) AS 'LINE_NO'"
IF MATCH(fdpr_LINE_NO,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'LINE_NO'"

IF NOT MATCH(fdpr_Period,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpr_Period%) AS 'Period'"
IF MATCH(fdpr_Period,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(10) AS 'Period'"

IF NOT MATCH(fdpr_LINE_TYPE,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpr_LINE_TYPE%) AS 'LINE_TYPE'"
IF MATCH(fdpr_LINE_TYPE,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'LINE_TYPE"

IF NOT MATCH(fdpr_PAYCODE_HOURS,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpr_PAYCODE_HOURS% AS 'PAYCODE_HOURS'"
IF MATCH(fdpr_PAYCODE_HOURS,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',2) AS 'PAYCODE_HOURS'"

IF NOT MATCH(fdpr_LINE_DESC,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpr_LINE_DESC%) AS 'LINE_DESC'"
IF MATCH(fdpr_LINE_DESC,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(31) AS 'LINE_DESC'"

IF NOT MATCH(fdpr_PAY_GROUP,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpr_PAY_GROUP%) AS 'PAY_GROUP'"
IF MATCH(fdpr_PAY_GROUP,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(9) AS 'PAY_GROUP'"

IF NOT MATCH(fdpr_Num_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpr_Num_Field1% AS 'Num_Field1'"
IF MATCH(fdpr_Num_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',2) AS 'Num_Field1'"

IF NOT MATCH(fdpr_Num_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpr_Num_Field2% AS 'Num_Field2'"
IF MATCH(fdpr_Num_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',2) AS 'Num_Field2'"

IF NOT MATCH(fdpr_Num_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpr_Num_Field3% AS 'Num_Field3'"
IF MATCH(fdpr_Num_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',2) AS 'Num_Field3'"

IF NOT MATCH(fdpr_Num_Field4,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpr_Num_Field4% AS 'Num_Field4'"
IF MATCH(fdpr_Num_Field4,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',2) AS 'Num_Field4'"

IF NOT MATCH(fdpr_Num_Field5,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpr_Num_Field5% AS 'Num_Field5'"
IF MATCH(fdpr_Num_Field5,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" VALUE('',2) AS 'Num_Field5'"

IF NOT MATCH(fdpr_Dt_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpr_Dt_Field1% AS 'Dt_Field1'"
IF MATCH(fdpr_Dt_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Dt_Field1'"

IF NOT MATCH(fdpr_Dt_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpr_Dt_Field2% AS 'Dt_Field2'"
IF MATCH(fdpr_Dt_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Dt_Field2'"

IF NOT MATCH(fdpr_Dt_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" %fdpr_Dt_Field3% AS 'Dt_Field3'"
IF MATCH(fdpr_Dt_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" CTOD('','DD/MM/YYYY') AS 'Dt_Field3'"

IF NOT MATCH(fdpr_Cha_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpr_Cha_Field1%) AS 'Cha_Field1'"
IF MATCH(fdpr_Cha_Field1,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field1'"

IF NOT MATCH(fdpr_Cha_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpr_Cha_Field2%) AS 'Cha_Field2'"
IF MATCH(fdpr_Cha_Field2,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field2'"

IF NOT MATCH(fdpr_Cha_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpr_Cha_Field3%) AS 'Cha_Field3'"
IF MATCH(fdpr_Cha_Field3,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field3'"

IF NOT MATCH(fdpr_Cha_Field4,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpr_Cha_Field4%) AS 'Cha_Field4'"
IF MATCH(fdpr_Cha_Field4,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field4'"

IF NOT MATCH(fdpr_Cha_Field5,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" ALLTRIM(%fdpr_Cha_Field5%) AS 'Cha_Field5'"
IF MATCH(fdpr_Cha_Field5,"_empty_"," ") v_Flds_Extract=v_Flds_Extract+" BLANKS(20) AS 'Cha_Field5'"

COMM EXTRACT FIELDS %v_Flds_Extract% TO "%fld_Workings%%trg_PR_Pay%.FIL"

DELETE FIELD _empty_ OK

EXTRACT FIELDS %v_Flds_Extract% TO "%fld_Tmps%TMP_Mapping.FIL" FIRST 1
  
COMM *** Update the fields linkage information into Data mapping Table, So the user can reuse the mapping information next time ***

v_fd="fdpr"
v_dm_tbl_Nme="DM_%trg_PR_Pay%"
v_src_tbl_Nme='%src_PR_Pay%'

DO LE004_Upt_Mapping

DELETE FORMAT TMP_Mapping OK
DELETE "%fld_Tmps%TMP_Mapping.FIL" OK

^BATCH    B1204_Loop_Match_PR_Pay            
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - Vendor Master File 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


FLAG_Show=F

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data File Setup - Payroll Payments" WIDTH 960 HEIGHT 521 ) (BUTTONSET TITLE "&OK;&Cancel" AT 696 432 DEFAULT 1 ) (TEXT TITLE "Please link the fields from source file to  standard file - Payroll Payments" AT 84 28 WIDTH 488 CENTER ) (ITEM TITLE "C" TO "fdpr_Co_Emp_ID" AT 300 108 WIDTH 178 DEFAULT "%fdpr_Co_Emp_ID%" ) (TEXT TITLE "Unique Key / ID / Company & Employee ID*" AT 24 112 WIDTH 250 RIGHT ) (ITEM TITLE "C" TO "fdpr_Co" AT 300 132 WIDTH 178 DEFAULT "%fdpr_Co%" ) (TEXT TITLE "Company Code" AT 24 136 WIDTH 250 RIGHT ) (ITEM TITLE "NC" TO "fdpr_COST_CENTRE" AT 300 156 WIDTH 179 DEFAULT "%fdpr_COST_CENTRE%" ) (TEXT TITLE "Cost Centre / Department" AT 24 160 WIDTH 250 HEIGHT 20 RIGHT ) (ITEM TITLE "C" TO "fdpr_Emp_ID" AT 300 180 WIDTH 179 DEFAULT "%fdpr_Emp_ID%" ) (TEXT TITLE "Employee Code *" AT 24 184 WIDTH 250 RIGHT ) (ITEM TITLE "DC" TO "fdpr_Prd_Dt" AT 300 204 WIDTH 179 DEFAULT "%fdpr_Prd_Dt%" ) (CHECKBOX TITLE "To exit/Escape" TO "exit" AT 696 492 WIDTH 100 ) (TEXT TITLE "Standard Table Fields" AT 120 76 ) (TEXT TITLE "Source Table Fields" AT 348 76 ) (TEXT TITLE "Pay Code" AT 24 232 WIDTH 250 RIGHT ) (TEXT TITLE "Pay Code Amount" AT 24 256 WIDTH 250 RIGHT ) (TEXT TITLE "Pay Code Hours" AT 24 280 WIDTH 250 RIGHT ) (TEXT TITLE "GL Account Number" AT 24 304 WIDTH 250 RIGHT ) (TEXT TITLE "Line Number" AT 24 328 WIDTH 250 RIGHT ) (TEXT TITLE "Line Desc" AT 24 352 WIDTH 250 RIGHT ) (TEXT TITLE "Line Type" AT 24 376 WIDTH 250 RIGHT ) (TEXT TITLE "Pay Group" AT 24 400 WIDTH 250 RIGHT ) (TEXT TITLE "Period Date*" AT 24 208 WIDTH 250 RIGHT ) (ITEM TITLE "C" TO "fdpr_PAYCODE" AT 300 228 WIDTH 179 DEFAULT "%fdpr_PAYCODE%" ) (ITEM TITLE "NC" TO "fdpr_PAYCODE_AMOUNTS" AT 300 252 WIDTH 179 DEFAULT "%fdpr_PAYCODE_AMOUNTS%" ) (ITEM TITLE "N" TO "fdpr_PAYCODE_HOURS" AT 300 276 WIDTH 179 DEFAULT "%fdpr_PAYCODE_HOURS%" ) (ITEM TITLE "C" TO "fdpr_GL_ACCOUNT_NO" AT 300 300 WIDTH 179 DEFAULT "%fdpr_GL_ACCOUNT_NO%" ) (ITEM TITLE "C" TO "fdpr_LINE_NO" AT 300 324 WIDTH 179 DEFAULT "%fdpr_LINE_NO%" ) (ITEM TITLE "C" TO "fdpr_LINE_DESC" AT 300 348 WIDTH 179 DEFAULT "%fdpr_LINE_DESC%" ) (ITEM TITLE "C" TO "fdpr_LINE_TYPE" AT 300 372 WIDTH 179 DEFAULT "%fdpr_LINE_TYPE%" ) (ITEM TITLE "C" TO "fdpr_PAY_GROUP" AT 300 396 WIDTH 179 DEFAULT "%fdpr_PAY_GROUP%" ) (ITEM TITLE "CN" TO "fdpr_PERIOD" AT 300 420 WIDTH 179 DEFAULT "%fdpr_PERIOD%" ) (TEXT TITLE "Period" AT 24 424 WIDTH 250 RIGHT ) (TEXT TITLE "Source Table Name " AT 576 28 ) (TEXT TITLE "%src_PR_Pay%" AT 708 28 WIDTH 219 ) (TEXT TITLE "Source Table Fields" AT 696 76 CENTER ) (TEXT TITLE "Numeric Spare Field 1" AT 492 112 WIDTH 170 RIGHT ) (TEXT TITLE "Numeric Spare Field 2" AT 492 136 WIDTH 170 RIGHT ) (TEXT TITLE "Numeric Spare Field 3" AT 492 160 WIDTH 170 RIGHT ) (TEXT TITLE "Numeric Spare Field 4" AT 492 184 WIDTH 170 RIGHT ) (TEXT TITLE "Numeric Spare Field 5" AT 492 208 WIDTH 170 RIGHT ) (TEXT TITLE "Date Spare Field 1" AT 492 232 WIDTH 170 RIGHT ) (TEXT TITLE "Date Spare Field 2" AT 492 256 WIDTH 170 RIGHT ) (TEXT TITLE "Date Spare Field 3" AT 492 280 WIDTH 170 RIGHT ) (TEXT TITLE "Character Spare Field 1" AT 492 304 WIDTH 170 RIGHT ) (TEXT TITLE "Character Spare Field 3" AT 492 352 WIDTH 170 RIGHT ) (TEXT TITLE "Character Spare Field 2" AT 492 328 WIDTH 170 RIGHT ) (TEXT TITLE "Character Spare Field 4" AT 492 376 WIDTH 170 RIGHT ) (TEXT TITLE "Character Spare Field 5" AT 492 400 WIDTH 170 RIGHT ) (ITEM TITLE "NC" TO "fdpp_Num_Field1" AT 684 108 WIDTH 178 DEFAULT "%fdpp_Num_Field1%" ) (ITEM TITLE "NC" TO "fdpp_Num_Field2" AT 684 132 WIDTH 178 DEFAULT "%fdpp_Num_Field2%" ) (ITEM TITLE "NC" TO "fdpp_Num_Field3" AT 684 156 WIDTH 178 DEFAULT "%fdpp_Num_Field3%" ) (ITEM TITLE "NC" TO "fdpp_Num_Field4" AT 684 180 WIDTH 178 DEFAULT "%fdpp_Num_Field4%" ) (ITEM TITLE "NC" TO "fdpp_Num_Field5" AT 684 204 WIDTH 178 DEFAULT "%fdpp_Num_Field5%" ) (ITEM TITLE "DC" TO "fdpp_Dt_Field1" AT 684 228 WIDTH 178 DEFAULT "%fdpp_Dt_Field1%" ) (ITEM TITLE "DC" TO "fdpp_Dt_Field2" AT 684 252 WIDTH 178 DEFAULT "%fdpp_Dt_Field2%" ) (ITEM TITLE "DC" TO "fdpp_Dt_Field3" AT 684 276 WIDTH 178 DEFAULT "%fdpp_Dt_Field3%" ) (ITEM TITLE "C" TO "fdpp_Cha_Field1" AT 684 300 WIDTH 178 DEFAULT "%fdpp_Cha_Field1%" ) (ITEM TITLE "C" TO "fdpp_Cha_Field2" AT 684 324 WIDTH 178 DEFAULT "%fdpp_Cha_Field2%" ) (ITEM TITLE "C" TO "fdpp_Cha_Field3" AT 684 348 WIDTH 178 DEFAULT "%fdpp_Cha_Field3%" ) (ITEM TITLE "C" TO "fdpp_Cha_Field4" AT 684 372 WIDTH 178 DEFAULT "%fdpp_Cha_Field4%" ) (ITEM TITLE "C" TO "fdpp_Cha_Field5" AT 684 396 WIDTH 178 DEFAULT "%fdpp_Cha_Field5%" )

IF exit=T ESCAPE

ErrMsg=""
IF MATCH(fdpr_Co_Emp_ID,"_empty_"," ") ErrMsg="Unique Key / ID / Company & Employee ID"
IF MATCH(fdpr_Emp_ID,"_empty_"," ") ErrMsg=ErrMsg+" Employee Code"
IF MATCH(fdpr_Prd_Dt,"_empty_"," ") ErrMsg=ErrMsg+" Period Date"
IF MATCH(fdpr_PAYCODE_AMOUNTS,"_empty_"," ") ErrMsg=ErrMsg+" Pay Code Amount"
IF MATCH(fdpr_PAYCODE,"_empty_"," ") ErrMsg=ErrMsg+" Pay Code"

%v_CCMJob% IF ALLTRIM(ErrMsg)<>"" PAUSE "Please Select a field for "+ErrMsg

^BATCH    B1301_Select_InvPO                 
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Convert, Link Fields from Source Data To Target Working File Table's Fields: Invoice - PO relationship
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF

DO B1302_Loop_Sel_InvPo WHILE ISBLANK(src_AP_InvPO)= T

DO B1303_Match_InvPO_Flds

IF exit=T ESCAPE


SET SAFETY ON


^BATCH    B1302_Loop_Sel_InvPO               
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - Select the source table that you want to link to Invoice-PO relationship table
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


FLAG_Show=F
SET FOLDER /%fld_Tmps%

COMM *** List Table Names ***
CLOSE
DIR %fld_Sources%*.fil SUB TO "%fld_Tmps%CVT_Tables"

OPEN CVT_Tables
DELETE FIELD Table_Name OK
DEFINE FIELD Table_Name COMPUTED ALLTRIM(SPLIT(SPLIT(FILE_NAME,"\",OCCURS(FILE_NAME,"\")+1),".",1))

v_Table_Names=BLANKS(1000)
v_counter=0
COUNT

GROUP IF NOT ISBLANK(Table_Name)
 LOOP WHILE v_counter<=COUNT1
  v_Table_Names = ALLTRIM(v_Table_Names) + ALLTRIM(RECOFFSET(Table_Name,v_counter)) + ";"
  v_counter = v_counter + 1
 END
END

v_Table_Names=REPLACE(ALLTRIM(REPLACE(v_Table_Names,";"," "))," ",";")

LOCATE IF Table_Name="%src_VMF_InterCo%"
v_default=RECNO()

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data Mapping - Invoices - Purchase Orders Relationship Table" WIDTH 523 HEIGHT 167 ) (BUTTONSET TITLE "&OK;&Cancel" AT 372 72 DEFAULT 1 ) (DROPDOWN TITLE "%v_Table_Names%" TO "src_AP_InvPO" AT 48 72 WIDTH 234 HEIGHT 126 DEFAULT %v_default%) (TEXT TITLE "Select a source table match to the target table - Invoice-PO Relationship" AT 48 40 )

%v_CCMJob% IF ISBLANK(src_AP_InvPO)= T PAUSE "Please select a file that maps to Invoice-PO relationship table"




^BATCH    B1303_Match_InvPO_Flds             
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Link Fields from Source Data To Target Working File Table's Fields: Invoice-PO relationship Table
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF
exit=F
FLAG_Show=T

OPEN %src_VMF_InterCo%

DELETE FIELD _empty_ OK
DEFINE FIELD _empty_ COMPUTED ""

DO B1304_Loop_Match_InvPO WHILE FLAG_Show=T OR MATCH(fdip_Vchr_ID,"_empty"," ") OR MATCH(fdip_PO_NO,"_empty"," ")

IF exit=T ESCAPE

COMM *** Extracting fields to master table from Source ***

OPEN %src_AP_InvPO%

v_Flds_Extract="ALLTRIM(%fdip_Vchr_ID%) AS 'Vchr_ID' ALLTRIM(%fdip_PO_NO%) AS 'PO_NO'"

DELETE FIELD _empty_ OK 
  
EXTRACT FIELDS %v_Flds_Extract% TO "%fld_Tmps%TMP_Mapping.FIL" OPEN
  
COMM *** Update the fields linkage information into Data mapping Table, So the user can reuse the mapping information next time ***

v_fd="fdip"
v_dm_tbl_Nme="DM_%trg_AP_InvPO%"
v_src_tbl_Nme='%src_AP_InvPO%'

DO LE004_Upt_Mapping

DELETE FORMAT TMP_Mapping OK
DELETE "%fld_Tmps%TMP_Mapping.FIL" OK

^BATCH    B1304_Loop_Match_InvPO             
[PARENT_FOLDER_ID] 1430797880
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Data Fields Mapping - Invoice-PO Relationship
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


FLAG_Show=F

%v_CCMJob% DIALOG (DIALOG TITLE "%_Version% Data File Setup - Invoice-PO Relationship" WIDTH 814 HEIGHT 269 ) (BUTTONSET TITLE "&OK;&Cancel" AT 636 144 DEFAULT 1 ) (TEXT TITLE "Please link the fields from source file to  standard file - Invoice-PO Relationship" AT 168 28 WIDTH 488 CENTER ) (ITEM TITLE "C" TO "fdip_Vchr_ID" AT 348 132 WIDTH 178 DEFAULT "%fdip_Vchr_ID%" ) (TEXT TITLE "Invoice Unique Key*" AT 60 136 WIDTH 240 RIGHT ) (CHECKBOX TITLE "To exit/Escape" TO "exit" AT 636 216 WIDTH 100 ) (TEXT TITLE "Standard Table Fields" AT 168 76 ) (TEXT TITLE "Source Table Fields" AT 360 76 ) (TEXT TITLE "Source Table Name " AT 612 76 ) (TEXT TITLE "%src_AP_InvPO%" AT 588 112 WIDTH 203 ) (TEXT TITLE "Purchase Order Number*" AT 60 112 WIDTH 240 RIGHT ) (ITEM TITLE "C" TO "fdip_PO_NO" AT 348 108 WIDTH 178 DEFAULT "%fdip_PO_NO%" )

IF exit=T ESCAPE

ErrMsg=""
IF MATCH(fdip_Vchr_ID,"_empty"," ") ErrMsg="Invoice Unique Key"
IF MATCH(fdip_PO_NO,"_empty"," ") ErrMsg="Purchase Order Number"

%v_CCMJob% IF ALLTRIM(ErrMsg)<>"" PAUSE "Please Select a field for " + ErrMsg
^BATCH    SC001_Com_SAP_All                  
[PARENT_FOLDER_ID] 1430796715
COMMENT
//ANALYTIC C001 Append SAP Tables
 Analytic Description: Append new data to existing data
//DATA BSAK*
//DATA BSIK*
//DATA BSET*
//DATA EKBE*
//DATA EKPO_EKKO*
//DATA CDPOS_CDHDR*
//DATA BSEG*
//DATA BKPF*
//FILE  DataMapping.xlsx
//DATA  EMF_BnkAcc_Chg_History
//DATA  VMF_BnkAcc_Chg_History
//DATA  VMF_Chg_History
//DATA  AP_Invoice_Credits
//DATA  AP_Invoices
//DATA  AP_InvPO
//DATA  AP_Payments
//DATA  AP_PO_Lines
//DATA  AP_PO_Vnd_Sum
//DATA  AP_Vnd_InvGst_Sum
//DATA  AP_VndSite_InvGst_Sum
//DATA  EMF_BnkAcc
//DATA  EMF_Emp_Master_File
//DATA  EMF_TMP_Emp
//DATA  Employee_Address
//DATA  Employee_Bank
//DATA  Employee_Tel
//DATA  VMF_Address
//DATA  VMF_BnkAcc
//DATA  VMF_Emails
//DATA  VMF_InterCompany
//DATA  VMF_Vnd_Master_File
//DATA  VMF_Vnd_OneTime
//DATA  Vnd_Emp_Master
//DATA  ABN_ASIC
//DATA  TBTCO*
//DATA  SAP*
//RESULT LOG
//RESULT FILE  *.mdb
//RESULT FILE  *.LOG
//RESULT FILE  *.csv
END

COMM***************************************************************************
COMM *** Prepare data
COMM *** Created by Nancy Li (0431 057 135) ON 10/07/2013 
COMM***************************************************************************

SET SAFETY OFF
IF FTYPE("_Version")="v" OR FTYPE("_Version")="U" OR FTYPE("fld_Sources")="U" OR FTYPE("v_AX")="U" DO AA002_Variable_Setting

SET DATE "DD/MM/YYYY"


COMM *** Combine / append the AP transactions ***


DO SC002_Com_BSAK_BSIK
DO SC003_Com_BSEG
DO SC004_Com_BSET
DO SC005_Com_EKPO

DO SC013_Com_EKBE

DO SC014_Com_CDPOS_CDHDR

COMMENT Material
COMMENT DO SC006_Com_MSEG

COMMENT Purchase Requisition
COMMENT DO SC007_Com_EBAN

COMMENT DO SC008_Com_RSEG

COMMENT DO SC009_Com_BSEC

COMMENT Cost Centre Master Data
COMMENT DO SC010_Com_COAS

COMMENT DO SC011_Com_BKPF


COMMENT The next script that will be called is SP001_Prep_SAP_All which contains MP001_Convert_VMF, MP002_Convert_AP,etc


SET SAFETY ON
^BATCH    SC002_Com_BSAK_BSIK                
[PARENT_FOLDER_ID] 1430796715
COMM***************************************************************************
COMM *** Preparing data for the tests
COMM *** Created by Nancy Li (0431 057 135) on 05/07/2013
COMM***************************************************************************
IF FTYPE("BSAK")<>"y"  ESCAPE
IF FTYPE("fld_Sources")="U" OR FTYPE("fld_Results")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Sources%

IF FTYPE("BSAK_BSIK_ALL")<>"y" v_First=""
IF FTYPE("BSAK_BSIK_ALL")<>"y" v_Append="COMMENT"
IF FTYPE("BSAK_BSIK_ALL")="y" v_First="COMMENT"
IF FTYPE("BSAK_BSIK_ALL")="y" v_Append=""

COMM *** Combine BSIK and BSAK into BSIK_BSAK, KEEP 2.5 YEARS RECORDS ***
OPEN BSAK

DELETE FIELD Paid OK
DEFINE FIELD Paid COMPUTED 'Y'
EXTRACT FIELDS ALL TO "%fld_Sources%BSAK_BSIK" OPEN

OPEN BSIK

DELETE FIELD Paid OK
DEFINE FIELD Paid COMPUTED 'N'
EXTRACT FIELDS ALL  TO "%fld_Sources%BSAK_BSIK" OPEN APPEND

COMM *** APPEND THE BSAK INTO HISTORICAL BSAK_ALL TABLES, KEEP 2.5 YEARS RECORDS ***
OPEN BSAK_BSIK

DELETE FIELD ID OK
DEFINE FIELD ID COMPUTED SUBSTR(ALLTRIM(BSAK_BUKRS)+ALLTRIM(BSAK_LIFNR) +ALLTRIM(BSAK_BELNR)+ ALLTRIM(BSAK_GJAHR)+ ALLTRIM(BSAK_MANDT)+ALLTRIM(BSAK_BUZEI),1,35)

DELETE FIELD Vnd_Nbr OK
DEFINE FIELD Vnd_Nbr COMPUTED SUBSTR(ALLTRIM(BSAK_LIFNR),1,20)

DELETE FIELD UKey OK
DEFINE FIELD UKey COMPUTED SUBSTR(ALLTRIM(BSAK_MANDT)+ALLTRIM(BSAK_BUKRS)+ALLTRIM(BSAK_BELNR)+ALLTRIM(BSAK_GJAHR)+ALLTRIM(BSAK_LIFNR),1,30)

DELETE FIELD YM OK
DEFINE FIELD YM COMPUTED LAST(ALLTRIM(DATE(BSAK_BUDAT)),4)+SUBSTR(ALLTRIM(DATE(BSAK_BUDAT)),4,2)

DELETE FIELD Void OK
DEFINE FIELD Void COMPUTED 

"Y" IF BSAK_XSTOV="X" OR BSAK_XRAGL="X"
" "

DELETE FIELD InvAmt_Loc OK
DEFINE FIELD InvAmt_Loc COMPUTED 

DEC(-1.00*BSAK_DMBTR,2) IF BSAK_SHKZG='S'
DEC(BSAK_DMBTR,2)

DELETE FIELD InvAmt_Doc OK
DEFINE FIELD InvAmt_Doc COMPUTED 

DEC(-1.00*BSAK_WRBTR,2) IF BSAK_SHKZG='S'
DEC(BSAK_WRBTR,2)

DELETE FIELD IDKey OK
DEFINE FIELD IDKey COMPUTED SUBSTR(ALLTRIM(BSAK_MANDT)+ALLTRIM(BSAK_BUKRS)+ALLTRIM(BSAK_BELNR)+ALLTRIM(BSAK_GJAHR)+ALLTRIM(BSAK_BUZEI),1,30)

INDEX ON ID TO IDX_BSAK_BSIK_ID

%v_First% EXTRACT FIELDS ALL  TO "%fld_Sources%BSAK_BSIK_ALL" OPEN

%v_Append% OPEN BSAK_BSIK_ALL

%v_Append% DELETE FIELD GST_KEY OK
%v_Append% DELETE FIELD GST_Amt_Loc OK
%v_Append% DELETE FIELD GST_Amt_Doc OK
%v_Append% DELETE FIELD Inv_NetAmt_Doc OK
%v_Append% DELETE FIELD Inv_NetAmt_Loc OK
%v_Append% DELETE FIELD MatNo OK
%v_Append% DELETE FIELD MatKey OK
%v_Append% DELETE FIELD MKey OK
%v_Append% DEFINE RELATION ID WITH BSAK_BSIK INDEX IDX_BSAK_BSIK_ID

%v_Append% EXTRACT FIELDS ALL IF ISBLANK(BSAK_BSIK.ID) TO "%fld_Workings%TMP1"

%v_Append% OPEN BSAK_BSIK 

%v_Append% EXTRACT FIELDS ALL TO "%fld_Workings%TMP1" OPEN APPEND

%v_Append% EXTRACT FIELDS ALL IF BSAK_BUDAT>=_Data_Range_Start_Date TO "%fld_Sources%BSAK_BSIK_ALL" OPEN

COMM *** Payments ***
OPEN BSAK_BSIK_ALL

EXTRACT FIELDS ALL IF NOT ISBLANK(BSAK_XZAHL) TO "%fld_Tmps%TMP2" OPEN

DELETE FIELD PayAmt_Loc OK
DEFINE FIELD PayAmt_Loc COMPUTED -1.00*InvAmt_Loc

DELETE FIELD PayAmt_Doc OK
DEFINE FIELD PayAmt_Doc COMPUTED -1.00*InvAmt_Loc

DELETE FIELD PayKey OK
DEFINE FIELD PayKey COMPUTED SUBSTR(ALLTRIM(BSAK_MANDT)+ALLTRIM(BSAK_BUKRS)+ALLTRIM(BSAK_LIFNR)+ALLTRIM(BSAK_BELNR),1,30)

INDEX ON PayKey TO IDX_TMP2

COMM *** Invoices exclude all payment related items***
OPEN BSAK_BSIK_ALL

EXTRACT FIELDS ALL IF ISBLANK(BSAK_XZAHL) AND NOT MATCH(BSAK_BLART,'AB','KZ','ZP','ZS','ZZ') TO "%fld_Sources%SAP_Invoice_Lines" OPEN


DELETE FIELD PayKey OK
DEFINE FIELD PayKey COMPUTED SUBSTR(ALLTRIM(BSAK_MANDT)+ALLTRIM(BSAK_BUKRS)+ALLTRIM(BSAK_LIFNR)+ALLTRIM(BSAK_AUGBL),1,30)

DEFINE RELATION PayKey WITH TMP2 INDEX IDX_TMP2

EXTRACT FIELDS UKey ID VOID InvAmt_Loc InvAmt_Doc TMP2.PayAmt_Loc TMP2.PayAmt_Doc Vnd_Nbr UKey IDKey TMP2.PayKey TMP2.BSAK_LIFNR TMP2.BSAK_BLART TMP2.BSAK_BLDAT TMP2.BSAK_WAERS TMP2.BSAK_BELNR TMP2.BSAK_SGTXT TMP2.BSAK_ZTERM TMP2.BSAK_BUDAT TMP2.BSAK_CPUDT TMP2.BSAK_GJAHR TMP2.BSAK_XSTOV TMP2.BSAK_AUGDT TMP2.BSAK_BUKRS TMP2.BSAK_HKONT  TMP2.BSAK_MANDT IF NOT ISBLANK(TMP2.PayKey) OR MATCH(BSAK_BLART,'KZ','ZP','ZS') TO "%fld_Sources%SAP_Payment_Lines" OPEN

SORT ON BSAK_MANDT BSAK_BUKRS BSAK_GJAHR BSAK_BELNR BSAK_LIFNR PayKey RECNO() TO TMP_SORT1 OPEN

SUMMARIZE ON BSAK_MANDT BSAK_BUKRS BSAK_GJAHR BSAK_BELNR BSAK_LIFNR PayKey SUBTOTAL PayAmt_Loc PayAmt_Doc OTHER BSAK_BLDAT BSAK_BUDAT BSAK_AUGDT ALL  TO %fld_Sources%SAP_Payments 

COMM *** Delete the Temperary Files ***
DO AE003_Del_Tmp

DELETE FORMAT BSAK_BSIK OK
DELETE %fld_Sources%BSAK_BSIK.FIL OK

SET SAFETY ON
^BATCH    SP001_Prep_SAP_All                 
[PARENT_FOLDER_ID] 1430796715
COMMENT
//ANALYTIC C002 Data Conversion
 Analytic Description: Convert the data to be usable for our tests
//DATA BSAK*
//DATA BSIK*
//DATA BSET*
//DATA EKBE*
//DATA EKPO_EKKO*
//DATA CDPOS_CDHDR*
//DATA BSEG*
//DATA BKPF*
//DATA SAP_Invoices
//DATA SAP_Payments
//DATA SAP_Inv_PO
//FILE  DataMapping.xlsx
//DATA  EMF_BnkAcc_Chg_History
//DATA  VMF_BnkAcc_Chg_History
//DATA  VMF_Chg_History
//DATA  AP_Invoice_Credits
//DATA  AP_Invoices
//DATA  AP_InvPO
//DATA  AP_Payments
//DATA  AP_PO_Lines
//DATA  AP_PO_Vnd_Sum
//DATA  AP_Vnd_InvGst_Sum
//DATA  AP_VndSite_InvGst_Sum
//DATA  EMF_BnkAcc
//DATA  EMF_Emp_Master_File
//DATA  EMF_TMP_Emp
//DATA  Employee_Address
//DATA  Employee_Bank
//DATA  Employee_Tel
//DATA  VMF_Address
//DATA  VMF_BnkAcc
//DATA  VMF_Emails
//DATA  VMF_InterCompany
//DATA  VMF_Vnd_Master_File
//DATA  VMF_Vnd_OneTime
//DATA  Vnd_Emp_Master
//DATA  ABN_ASIC
//DATA  TBTCO*
//DATA  SAP*
//RESULT LOG
//RESULT FILE  *.mdb
//RESULT FILE  *.LOG
//RESULT FILE  *.csv
END

IF FTYPE("fld_Sources")="U" DO AA002_Variable_Setting

SET SAFETY OFF

IF FTYPE("LFA1")<>"y" OR FTYPE("LFB1")<>"y" OR FTYPE("BSAK_BSIK_ALL")<>"y"  ESCAPE ALL

COMM *** Prepare data for CCM ***

DO SP002_Pre_Vnd

DO SP003_Pre_Inv

COMMENT DO SP004_Pre_EM

COMMENT Field mapping

Errmsg=""
DM_Flag=F
DO LE003_Imp_Mapping


COMM *** Convert Source data into ACL application ***
DO MP001_Convert_VMF

DO MP002_Convert_AP

COMM ***delete temperary files ***
COMM DO AE003_Del_Tmp


SET SAFETY ON
^BATCH    SP002_Pre_Vnd                      
[PARENT_FOLDER_ID] 1430796715
COMM***************************************************************************
COMM *** Prepare the data for the mapping/conversion  --  Vendor Master File
COMM *** Created by Nancy Li (0431 057 135) on 05/07/2013
COMM***************************************************************************

IF FTYPE("fld_Sources")="U" OR FTYPE("fld_Results")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "YYYY-MM-DD"
SET FOLDER /%fld_Workings%

COMM *** Get the vendor company codes, Payment Methods (a vendor might have more than one company codes***

OPEN LFB1

DELETE FIELD VndNbrCoy OK
DEFINE FIELD VndNbrCoy COMPUTED SUBSTR(ALLTRIM(LFB1_MANDT)+ALLTRIM(LFB1_LIFNR),1,20)

SORT ON VndNbrCoy LFB1_LOEVM LFB1_SPERR LFB1_ERDAT D TO '%fld_Workings%LFB1_TMP1' OPEN

INDEX ON VndNbrCoy TO IDX_LFB1_TMP1

OPEN LFB1_TMP1
v_LFB1_CoCodes = BLANKS(100)
v_LFB1_PymntMeths = BLANKS(100)
v_LFB1_VndNbrCoy = VndNbrCoy
v_LFB1_BUKRS = LFB1_BUKRS
v_LFB1_ZWELS = LFB1_ZWELS
GROUP IF v_LFB1_VndNbrCoy = VndNbrCoy
  v_LFB1_CoCodes = ALL(LFB1_BUKRS) IF ISBLANK(v_LFB1_CoCodes)
  v_LFB1_CoCodes = ALL(v_LFB1_CoCodes)+";"+ALL(LFB1_BUKRS) IF NOT ISBLANK(v_LFB1_CoCodes)
  v_LFB1_PymntMeths = ALL(LFB1_ZWELS) IF ISBLANK(v_LFB1_PymntMeths)
  v_LFB1_PymntMeths = ALL(v_LFB1_PymntMeths)+";"+ALL(LFB1_ZWELS) IF NOT ISBLANK(v_LFB1_PymntMeths)
ELSE
  EXTRACT v_LFB1_VndNbrCoy AS "LFB1_VndNbrCoy" v_LFB1_CoCodes AS "LFB1_CoCodes" v_LFB1_PymntMeths AS 'LFB1_PymntMeths' TO '%fld_Workings%LFB1_TMP2' EOF
  v_LFB1_CoCodes = ALL(LFB1_BUKRS)
  v_LFB1_VndNbrCoy = VndNbrCoy
  v_LFB1_PymntMeths = ALL(LFB1_ZWELS) 
END

OPEN LFB1_TMP2

INDEX ON LFB1_VndNbrCoy TO IDX_LFB1_TMP2

COMM *** Vendor Emails ***
OPEN ADR6

COMMENT
DELETE FIELD VndNbrCoy OK
DEFINE FIELD VndNbrCoy COMPUTED SUBSTR(ALLTRIM(ADR6_CLIENT)+ALLTRIM(ADR6_ADDRNUMBER),1,20)
SUMMARIZE ON VndNbrCoy ADR6_ADDRNUMBER AS 'Vndr_Nbr' ADR6_SMTP_ADDR AS 'Email' IF FIND('@',ADR6_SMTP_ADDR) TO  '%fld_Workings%VMF_Emails' OPEN PRESORT
INDEX ON VndNbrCoy TO IDX_VMF_Emails

INDEX ON ADR6_ADDRNUMBER TO "IDX_ADR6_ADDRNUMBER"

COMM *** Finalize the necessary fields for the CCM ***
OPEN LFA1

DELETE FIELD VndNbrCoy OK
DEFINE FIELD VndNbrCoy COMPUTED SUBSTR(ALLTRIM(LFA1_MANDT)+ALLTRIM(LFA1_LIFNR),1,20)



DEFINE RELATION VndNbrCoy WITH LFB1_TMP1 INDEX IDX_LFB1_TMP1
DEFINE RELATION VndNbrCoy WITH LFB1_TMP2 INDEX IDX_LFB1_TMP2

COMM DEFINE RELATION VndNbrCoy WITH VMF_Emails INDEX IDX_VMF_Emails

DEFINE RELATION LFA1_ADRNR WITH ADR6 INDEX IDX_ADR6_ADDRNUMBER



DELETE FIELD Co OK 
DEFINE FIELD Co COMPUTED LFB1_TMP2.LFB1_CoCodes

DELETE FIELD Email1 OK 
DEFINE FIELD Email1 COMPUTED ADR6.ADR6_SMTP_ADDR

DELETE FIELD Pymnt_Mth OK 
DEFINE FIELD Pymnt_Mth COMPUTED LFB1_TMP2.LFB1_PymntMeths

DELETE FIELD Vnd_Sts OK 
DEFINE FIELD Vnd_Sts COMPUTED 

"I" IF LFA1_LOEVM="X" OR LFA1_SPERR ="X" OR LFA1_SPERM="X" OR LFB1_TMP1.LFB1_LOEVM="X" OR LFB1_TMP1.LFB1_SPERR="X"
"A"

COMM *** Delete the Temperary Files ***
DO AE003_Del_Tmp 

SET SAFETY ON
^BATCH    SP003A_Pre_GST                     
[PARENT_FOLDER_ID] 1430796715
COMM *******************************************
COMM *** Get the GL GST from BSEG and AP GST from BSET
COMM *** Get final GST: if GL GST is null, then get AP GST, always get the GL GST Amt first) ***
COMM *** Created by Nancy Li (0431 057 135) on 05/07/2013
COMM *******************************************


IF FTYPE("fld_Tmps")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

COMM *** Get GL GST ***

COMMENT Link with T001 and SKAT to get SKAT_TXT50. Needed?
COMMENT
OPEN T001
DELETE FIELD T001_KEY OK
DEFINE FIELD T001_KEY COMPUTED SUBSTR(ALLTRIM(T001_MANDT)+ALLTRIM(T001_BUKRS),1,20)
INDEX ON T001_KEY TO IDX_T001_KEY
OPEN SKAT
DELETE FIELD SKAT_KEY OK
DEFINE FIELD SKAT_KEY COMPUTED SUBSTR(ALLTRIM(SKAT_MANDT)+ALLTRIM(SKAT_KTOPL)+ALLTRIM(SKAT_SAKNR),1,40)
INDEX ON SKAT_KEY TO IDX_SKAT_KEY

COMMENT OPEN BSEG_BKPF_ALL

COMMENT Link with T001 and SKAT to get SKAT_TXT50. Needed?
COMMENT
DELETE FIELD T001_KEY OK
DEFINE FIELD T001_KEY COMPUTED SUBSTR(ALLTRIM(BSEG_MANDT)+ALLTRIM(BSEG_BUKRS),1,20)
DEFINE RELATION T001_KEY WITH T001 INDEX IDX_T001_KEY
DELETE FIELD T001_KTOPL OK
DEFINE FIELD T001_KTOPL COMPUTED T001.T001_KTOPL
DELETE FIELD SKAT_KEY OK
DEFINE FIELD SKAT_KEY COMPUTED SUBSTR(ALLTRIM(BSEG_MANDT)+ALLTRIM(T001_KTOPL)+ALLTRIM(BSEG_HKONT),1,40)
DEFINE RELATION SKAT_KEY WITH SKAT INDEX IDX_SKAT_KEY

COMM *** GST GL ACCOUNT CODES ***
COMMENT With T001_KTOPL and SKAT_TXT50:
COMMENT EXTRACT FIELDS BSEG_KOART BSEG_BUKRS BSEG_BELNR BSEG_BUZEI BSEG_SHKZG BSEG_DMBTR BSEG_WRBTR BSEG_HKONT BSEG_SGTXT BSEG_GJAHR BSEG_MANDT T001_KTOPL BSEG_EBELN BSEG_EBELP SKAT.SKAT_TXT50 IF BSEG_KOART="S" AND MATCH(BSEG_HKONT,"0000216400","0000216401","0000113000","0000113002","0000113004","0000113020","0000113022","0000113024") TO "%fld_Tmps%TMP1" OPEN
COMMENT Without T001_KTOPL and SKAT_TXT50:
COMMENT EXTRACT FIELDS BSEG_KOART BSEG_BUKRS BSEG_BELNR BSEG_BUZEI BSEG_SHKZG BSEG_DMBTR BSEG_WRBTR BSEG_HKONT BSEG_SGTXT BSEG_GJAHR BSEG_MANDT BSEG_EBELN BSEG_EBELP IF BSEG_KOART="S" AND MATCH(BSEG_HKONT,"0000216400","0000216401","0000113000","0000113002","0000113004","0000113020","0000113022","0000113024") TO "%fld_Tmps%TMP1" OPEN

COMMENT
DELETE FIELD GL_GSTAmt_Loc OK
DEFINE FIELD GL_GSTAmt_Loc COMPUTED
AS "Local Invoice Amount"
-BSEG_DMBTR IF BSEG_SHKZG = 'H'
BSEG_DMBTR  IF BSEG_SHKZG = 'S'
9999999999.99
COMMENT
DELETE FIELD GL_GSTAmt_Doc OK
DEFINE FIELD GL_GSTAmt_Doc COMPUTED
AS "Document Invoice Amount"
-BSEG_WRBTR IF BSEG_SHKZG = 'H'
BSEG_WRBTR  IF BSEG_SHKZG = 'S'
9999999999.99

COMMENT
DELETE FIELD GST_KEY OK
DEFINE FIELD GST_KEY COMPUTED SUBSTR(ALLTRIM(BSEG_MANDT)+ALLTRIM(BSEG_BUKRS)+ALLTRIM(BSEG_GJAHR)+ALLTRIM(BSEG_BELNR)+ALLTRIM(BSEG_BUZEI),1,50)
SUMMARIZE ON GST_KEY  BSEG_MANDT BSEG_BUKRS BSEG_GJAHR BSEG_BELNR  SUBTOTAL GL_GSTAmt_Doc GL_GSTAmt_Loc TO "%fld_Sources%GST_GL.fil" OPEN PRESORT 
INDEX ON GST_KEY TO IDX_GST_KEY_GL

COMM *** Get AP GST ***

COMMENT Need T007S_TEXT1 ?
COMMENT
OPEN T007S
EXTRACT FIELDS ALL IF (T007S_SPRAS = "E") AND (T007S_KALSM = "TAXAUZ") TO "%fld_tmps%TMP1" OPEN
INDEX ON T007S_MWSKZ TO IDX_T007S

OPEN BSET_ALL

COMMENT Need T007S_TEXT1 ?
COMMENT
DEFINE RELATION  BSET_MWSKZ WITH TMP1 INDEX IDX_T007S

DELETE FIELD AP_GSTAmt_Loc OK
DEFINE FIELD AP_GSTAmt_Loc COMPUTED
AS "Local Invoice Amount"
-BSET_HWSTE IF BSET_SHKZG = 'H'
BSET_HWSTE  IF BSET_SHKZG = 'S'
9999999999.99

DELETE FIELD AP_GSTAmt_Doc OK
DEFINE FIELD AP_GSTAmt_Doc COMPUTED
AS "Document Invoice Amount"
-BSET_FWSTE IF BSET_SHKZG = 'H'
BSET_FWSTE  IF BSET_SHKZG = 'S'
9999999999.99

DELETE FIELD GST_KEY OK
DEFINE FIELD GST_KEY COMPUTED SUBSTR(ALLTRIM(BSET_MANDT)+ALLTRIM(BSET_BUKRS)+ALLTRIM(BSET_GJAHR)+ALLTRIM(BSET_BELNR)+ALLTRIM(BSET_BUZEI),1,50)

COMMENT With T007S_TEXT1
COMMENT SUMMARIZE ON GST_KEY BSET_MANDT BSET_BUKRS BSET_GJAHR BSET_BELNR  BSET_MWSKZ TMP1.T007S_TEXT1 SUBTOTAL AP_GSTAmt_Doc AP_GSTAmt_Loc TO "%fld_Sources%GST_AP_TaxCd.fil" PRESORT
COMMENT Without T007S_TEXT1
COMMENT With BSET_ALL 502334 rows, this takes 14 mins 30 secs
SUMMARIZE ON GST_KEY BSET_MANDT BSET_BUKRS BSET_GJAHR BSET_BELNR  BSET_MWSKZ SUBTOTAL AP_GSTAmt_Doc AP_GSTAmt_Loc TO "%fld_Sources%GST_AP_TaxCd.fil" PRESORT
COMMENT No improvement:
COMMENT SUMMARIZE ON GST_KEY BSET_MWSKZ OTHER BSET_MANDT BSET_BUKRS BSET_GJAHR BSET_BELNR SUBTOTAL AP_GSTAmt_Doc AP_GSTAmt_Loc TO "%fld_Sources%GST_AP_TaxCd.fil" PRESORT

SUMMARIZE ON GST_KEY BSET_MANDT BSET_BUKRS BSET_GJAHR BSET_BELNR SUBTOTAL AP_GSTAmt_Doc AP_GSTAmt_Loc TO "%fld_Sources%GST_AP.fil" OPEN PRESORT 

INDEX ON GST_KEY TO IDX_GST_KEY_AP
COMM *** Get final GST ( if GL GST is null, then get AP GST, always get the GL GST Amt ***

COMMENT
OPEN BSEG_BKPF_ALL
DELETE FIELD SKAT_KEY OK
DELETE FIELD T001_KTOPL OK
DELETE FIELD T001_KEY OK


OPEN BSET_ALL

DELETE FIELD AP_GSTAmt_Loc OK
DELETE FIELD AP_GSTAmt_Doc OK
DELETE FIELD GST_KEY OK
comm DELETE RELATION TMP1 OK


COMM *** Delete the Temperary Files ***
DO AE003_Del_Tmp
^BATCH    SP003_Pre_Inv                      
[PARENT_FOLDER_ID] 1430796715
COMM***************************************************************************
COMM *** NewCrest CCM
COMM *** Prepare the data for the mapping/conversion  -- AP Invoices
COMM *** Created by Nancy Li (0431 057 135) on 05/07/2013
COMM***************************************************************************

IF FTYPE("fld_Sources")="U" OR FTYPE("fld_Results")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Sources%

COMM *** Generate the GST amounts for the Invoices ***
DO SP003A_Pre_GST

COMMENT Daikin: Invoice to PO link
OPEN BSEG_BKPF_ALL
INDEX ON BSEG_BELNR TO IDX_BSEG_BELNR_PO IF BSEG_BUZID="W"

OPEN SAP_Invoice_Lines

DEFINE RELATION BSAK_BELNR WITH BSEG_BKPF_ALL INDEX IDX_BSEG_BELNR_PO

DELETE FIELD PO_Number OK
DEFINE FIELD PO_Number COMPUTED SUBSTR(ALLTRIM(BSEG_BKPF_ALL.BSEG_ZUONR),1,10)

DELETE FIELD PO_Line_Number OK
DEFINE FIELD PO_Line_Number COMPUTED SUBSTR(ALLTRIM(BSEG_BKPF_ALL.BSEG_ZUONR),11,5)

DELETE FIELD GST_KEY OK
DEFINE FIELD GST_KEY COMPUTED SUBSTR(ALLTRIM(BSAK_MANDT)+ALLTRIM(BSAK_BUKRS)+ALLTRIM(BSAK_GJAHR)+ALLTRIM(BSAK_BELNR)+ALLTRIM(BSAK_BUZEI),1,50)

COMMENT DEFINE RELATION GST_KEY WITH GST_GL INDEX IDX_GST_KEY_GL
DEFINE RELATION GST_KEY WITH GST_AP INDEX IDX_GST_KEY_AP

COMM *** Get final GST ( if GL GST is null, then get AP GST, always get the GL GST Amt ***
DELETE FIELD GST_Amt_Loc OK
DEFINE FIELD GST_Amt_Loc COMPUTED GST_AP.AP_GSTAmt_Loc 
COMM
GST_GL.GL_GSTAmt_Loc IF NOT ISBLANK(GST_GL.GST_KEY)
GST_AP.AP_GSTAmt_Loc 

DELETE FIELD GST_Amt_Doc OK
DEFINE FIELD GST_Amt_Doc COMPUTED GST_AP.AP_GSTAmt_Doc
COMM
GST_GL.GL_GSTAmt_Doc IF NOT ISBLANK(GST_GL.GST_KEY)
GST_AP.AP_GSTAmt_Doc

DELETE FIELD Inv_NetAmt_Doc OK
DEFINE FIELD Inv_NetAmt_Doc COMPUTED InvAmt_Doc - GST_Amt_Doc 

DELETE FIELD Inv_NetAmt_Loc OK
DEFINE FIELD Inv_NetAmt_Loc COMPUTED InvAmt_Loc - GST_Amt_Loc

COMM *** get the final SAP Invoice ***
SORT ON UKey BSAK_MANDT BSAK_BUKRS BSAK_GJAHR BSAK_BELNR BSAK_LIFNR RECNO() TO TMP_SORT1 OPEN
SUMMARIZE ON UKey BSAK_MANDT BSAK_BUKRS BSAK_GJAHR BSAK_BELNR BSAK_LIFNR SUBTOTAL InvAmt_Doc InvAmt_Loc GST_Amt_Loc GST_Amt_Doc Inv_NetAmt_Doc Inv_NetAmt_Loc OTHER ALL  TO %fld_Sources%SAP_Invoices 

COMM *** Get the PO(s) for Invoice ***
COMMENT Might not be needed for Daikin
COMMENT
DO SP003B_Pre_InvPO
COMM *** Invoice and PO relationship ***
OPEN SAP_Inv_POLn
EXTRACT FIELDS UKey RSEG_EBELN IF RSEG_EBELN<>'' TO SAP_Inv_PO




COMM *** One Time Vendor Docs BSEC***

COMM *** Delete the Temperary Files ***
DO AE003_Del_Tmp 

SET SAFETY ON
^BATCH    MA002_Convert_Menu                 
[PARENT_FOLDER_ID] 1430796753
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Convert Source Data To Target Working File Tables: Menu
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("fld_Workings")="U" OR FTYPE("trg_VMF")="U" DO AA002_Variable_Setting

CHK_TEST_VMF=F
CHK_TEST_AP=F
CHK_TEST_EMF=F
CHK_TEST_PR=F

exit=F

COMM *** DIALOG ***
IF FILESIZE("Dialogs\Dialog_MA002_Convert_Menu.txt") <=0 ESCAPE
DELETE SCRIPT Dialog_MA002_Convert_Menu OK
%v_CCMJob% DO "Dialogs\Dialog_MA002_Convert_Menu.txt"
DELETE SCRIPT Dialog_MA002_Convert_Menu OK

IF exit=T ESCAPE
 
%v_CCMJob% IF CHK_TEST_VMF=F AND CHK_TEST_AP=F AND CHK_TEST_EMF=F AND CHK_TEST_PR=F PAUSE "Please select the data components you want to convert."
IF CHK_TEST_VMF=T OR CHK_TEST_AP=T OR CHK_TEST_EMF=T OR CHK_TEST_PR=T FLAG1=T

%v_CCMJob% IF CHK_TEST_VMF =T AND FILESIZE("%fld_DataMapping%DM_%trg_VMF%.fil") <= 0 PAUSE "There is no Vendor Master data, please prepare the data first."
IF CHK_TEST_VMF =T AND FILESIZE("%fld_DataMapping%DM_%trg_VMF%.fil") <= 0 FLAG1=F

%v_CCMJob% IF CHK_TEST_AP =T AND FILESIZE("%fld_DataMapping%DM_%trg_AP_Inv%.fil") <= 0 AND FILESIZE("%fld_DataMapping%DM_%trg_VMF%.fil") <= 0 PAUSE "There is no Vendor Master and Invoices data, please prepare the data first."
IF CHK_TEST_AP =T AND FILESIZE("%fld_DataMapping%DM_%trg_AP_Inv%.fil") <= 0 AND FILESIZE("%fld_DataMapping%DM_%trg_VMF%.fil") <= 0 FLAG1=F

%v_CCMJob% IF CHK_TEST_EMF =T AND FILESIZE("%fld_DataMapping%DM_%trg_EMF%.fil") <= 0 PAUSE "There is no Employee Master data, please prepare the data first."
IF CHK_TEST_EMF =T AND FILESIZE("%fld_DataMapping%DM_%trg_EMF%.fil") <= 0 FLAG1=F

%v_CCMJob% IF CHK_TEST_PR =T AND FILESIZE("%fld_DataMapping%DM_%trg_PR%.fil") <= 0 AND FILESIZE("%fld_DataMapping%DM_%trg_EMF%.fil") <= 0 PAUSE "There is no Employee Master and Payroll data, please prepare the data first."
IF CHK_TEST_PR =T AND FILESIZE("%fld_DataMapping%DM_%trg_PR%.fil") <= 0 AND FILESIZE("%fld_DataMapping%DM_%trg_EMF%.fil") <= 0 FLAG1=F

IF FLAG1=T AND CHK_TEST_VMF=T DO MP001_Convert_VMF

IF FLAG1=T AND CHK_TEST_EMF=T DO MP003_Convert_EMF

IF FLAG1=T AND CHK_TEST_PR=T DO MP004_Convert_Payroll

IF FLAG1=T AND CHK_TEST_AP=T AND v_APInvoice_ON=T DO MP002_Convert_AP
IF FLAG1=T AND CHK_TEST_AP=T AND v_APInvoice_ON=F DO MP002_Convert_AP_Empty

IF FLAG1=T AND (CHK_TEST_VMF=T OR CHK_TEST_EMF=T) DO MZ003_Com_VndEmp

COMM IF FLAG1=T PAUSE "Data that you chose has been converted successfully."

^BATCH    MP002_Convert_AP_Empty             
[PARENT_FOLDER_ID] 1430796753
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Convert Source Data To Target Working File Tables: Accounts Payable
COMM *** Called by MA002_Convert_Menu
COMM *** run EVA with without AP Invoice
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


COMM *** prepare Accounts Payable relevant tables for the Tests ***

IF FTYPE("fld_Workings")="U" OR FTYPE("trg_AP")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER/%fld_Workings%

COMM *** convert AP Invoices***

COMM *** Capture the linkage relationships for the data mapping, convert the source data into target standard table ***
OPEN DM_%trg_AP_Inv%

COMM *** Extract the mapping information from the mapping file (e.g. DM_AP_Invoices)***
DO MZ001_Convert

IF v_Flds_Extract<>"" EXTRACT FIELDS %v_Flds_Extract% FIRST 0 TO "%fld_Workings%%trg_AP_Inv%.FIL"

OPEN %trg_AP_Inv%

DELETE FIELD c_Inv_No OK 
DEFINE FIELD c_Inv_No COMPUTED 
Srt Inv_No 
ALLTRIM(STRING(VALUE(INCLUDE(Inv_No,"0123456789"),0),16)) IF LENGTH(ALLTRIM(INCLUDE(Inv_No,"0123456789")))>0
ALLTRIM(INCLUDE(UPPER(Inv_No),"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"))

DELETE FIELD ABS_INVAMT 
DEFINE FIELD ABS_INVAMT COMPUTED 

VALUE(SPLIT(ALLTRIM(STRING(ABS(Inv_Amt),21)),".",1),0) IF OCCURS(ALLTRIM(STRING(ABS(Inv_Amt),21)),".")>=0
VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21 )),0)

DELETE FIELD c_Inv_Dt OK 
DEFINE FIELD c_Inv_Dt COMPUTED ALLTRIM(SUBSTR(DATE(Inv_Dt),7,4))+ALLTRIM(SUBSTR(DATE(Inv_Dt),4,2))+ALLTRIM(SUBSTR(DATE(Inv_Dt),1,2))

IF FILESIZE("%fld_Workings%%trg_AP_Inv%.fil") >= 0 OPEN %trg_AP_Inv%
IF FILESIZE("%fld_Workings%%trg_AP_Inv%.fil") >= 0 DEFINE RELATION Vndr_Site_ID WITH %trg_VMF% INDEX IDX_VndrSiteID

DELETE FIELD Vndr_Mstr_ID OK 
DEFINE FIELD Vndr_Mstr_ID COMPUTED %trg_VMF%.Vndr_Site_ID 

DELETE FIELD Vndr_Nme OK 
DEFINE FIELD Vndr_Nme COMPUTED %trg_VMF%.Vndr_Nme 

DELETE FIELD Vndr_Sts OK 
DEFINE FIELD Vndr_Sts COMPUTED %trg_VMF%.Vndr_Sts 

DELETE FIELD Vndr_Typ OK 
DEFINE FIELD Vndr_Typ COMPUTED %trg_VMF%.Vndr_Typ 

COMM *** Invoices - Credits ***
EXTRACT FIELDS ALL IF Inv_Amt<0.00 TO "%fld_Workings%AP_Invoice_Credits"

IF FILESIZE("%fld_Workings%%trg_VMF%.fil") >= 0 DEFINE RELATION Vndr_Site_ID WITH %trg_VMF% INDEX IDX_VndrSiteID


COMM *** Summary  all statical informtion into one table***
OPEN %trg_AP_Inv%
SORT ON Vndr_Site_ID Vndr_ID c_Inv_Dt D TO "%fld_Workings%TMP1" OPEN

DELETE FIELD InvAmt_Pos OK
DEFINE FIELD InvAmt_Pos COMPUTED

Inv_Amt IF Inv_Amt>0.00
0.00

DELETE FIELD GSTAmt_Pos OK
DEFINE FIELD GSTAmt_Pos COMPUTED

GST_Amt IF Inv_Amt>0.00
0.00

DELETE FIELD Cnt_Pos OK
DEFINE FIELD Cnt_Pos COMPUTED

1 IF Inv_Amt>0.00
0

DELETE FIELD InvAmt_12M OK
DEFINE FIELD InvAmt_12M COMPUTED

Inv_Amt IF Inv_Dt>=CTOD(_LastYearTranCha,"DD/MM/YYYY")
0.00

DELETE FIELD GSTAmt_12M OK
DEFINE FIELD GSTAmt_12M COMPUTED

GST_Amt IF Inv_Dt>=CTOD(_LastYearTranCha,"DD/MM/YYYY")
0.00

DELETE FIELD Cnt_12M OK
DEFINE FIELD Cnt_12M COMPUTED

1 IF Inv_Dt>=CTOD(_LastYearTranCha,"DD/MM/YYYY")
0

DELETE FIELD InvAmt_24M OK
DEFINE FIELD InvAmt_24M COMPUTED

Inv_Amt IF Inv_Dt>=CTOD(_Last2YearTranCha,"DD/MM/YYYY")
0.00

DELETE FIELD GSTAmt_24M OK
DEFINE FIELD GSTAmt_24M COMPUTED

GST_Amt IF Inv_Dt>=CTOD(_Last2YearTranCha,"DD/MM/YYYY")
0.00

DELETE FIELD Cnt_24M OK
DEFINE FIELD Cnt_24M COMPUTED

1 IF Inv_Dt>=CTOD(_Last2YearTranCha,"DD/MM/YYYY")
0

SUMMARIZE ON Vndr_Site_ID Vndr_ID SUBTOTAL Inv_Amt GST_Amt InvAmt_Pos GSTAmt_Pos Cnt_Pos InvAmt_24M GSTAmt_24M Cnt_24M InvAmt_12M GSTAmt_12M Cnt_12M OTHER Inv_Dt c_Inv_Dt TO "%fld_Workings%AP_VndSite_InvGst_Sum.FIL" OPEN 

SORT ON Vndr_ID c_Inv_Dt D TO "%fld_Workings%TMP2" OPEN

SUMMARIZE ON Vndr_ID SUBTOTAL Inv_Amt GST_Amt COUNT AS 'COUNT' InvAmt_Pos GSTAmt_Pos Cnt_Pos InvAmt_24M GSTAmt_24M Cnt_24M InvAmt_12M GSTAmt_12M Cnt_12M OTHER Inv_Dt c_Inv_Dt TO "%fld_Workings%AP_Vnd_InvGst_Sum.FIL" 

COMM *** Summary AP report by Vendor Number ***
OPEN AP_Vnd_InvGst_Sum
INDEX ON Vndr_ID TO IDX_AP_Sum_VndrID

COMM *** Summary AP report by Vendor Site Number ***
OPEN AP_VndSite_InvGst_Sum
INDEX ON Vndr_ID TO IDX_AP_Sum_VndrSiteID

COMM *** Link the summary tables to vendor master file ***
OPEN  %trg_VMF%
DEFINE RELATION Vndr_Site_ID WITH AP_VndSite_InvGst_Sum INDEX IDX_AP_Sum_VndrSiteID
DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum INDEX IDX_AP_Sum_VndrID

DELETE FIELD Max_Inv_Dt OK 
DEFINE FIELD Max_Inv_Dt COMPUTED AP_Vnd_InvGst_Sum.Inv_Dt 

IF FILESIZE("%fld_Workings%%trg_AP_PO%.fil") >= 0 OPEN %trg_AP_PO%
IF FILESIZE("%fld_Workings%%trg_AP_PO%.fil") >= 0 SUMMARIZE ON Vndr_Site_ID Vndr_ID PO_NO SUBTOTAL Amount Rec_Amt PO_Qty Rec_Qty OTHER PO_Date Rec_Dt TO "%fld_Workings%AP_PO_Vnd_Sum.FIL" OPEN PRESORT


^BATCH    MZ003_Com_VndEmp                   
[PARENT_FOLDER_ID] 1430796753
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Combine Vendor and Employee master file into Vnd_Emp_Master ***
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 05/10/2012
COMM***************************************************************************


IF FTYPE("fld_Workings")="U" OR FTYPE("trg_VMF")="U" OR FTYPE("trg_EMF")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER/%fld_Workings%

v_CommVMF=""
v_CommEMF=""

%v_CommVMF% IF FTYPE("VMF_Vnd_Master_File")<>"y" OR FILESIZE("%fld_Workings%VMF_Vnd_Master_File.fil")<=0 v_CommVMF="COMMENT"
%v_CommVMF% IF FTYPE("EMF_TMP_Emp")<>"y" OR FILESIZE("%fld_Workings%EMF_TMP_Emp.fil")<=0 v_CommEMF="COMMENT"

%v_CommVMF% IF FTYPE("VMF_BnkAcc")="y" AND FILESIZE("%fld_Workings%VMF_BnkAcc.FIL") >= 0 OPEN VMF_BnkAcc
%v_CommVMF% IF FTYPE("VMF_BnkAcc")="y" AND FILESIZE("%fld_Workings%VMF_BnkAcc.FIL") >= 0 INDEX ON Vndr_Site_ID TO IDX_VMFBK_VndrSiteID

%v_CommVMF% OPEN VMF_Vnd_Master_File
%v_CommVMF% IF FTYPE("VMF_BnkAcc")="y" AND FILESIZE("%fld_Workings%VMF_BnkAcc.FIL") >= 0 DEFINE RELATION Vndr_Site_ID WITH VMF_BnkAcc INDEX IDX_VMFBK_VndrSiteID
%v_CommVMF% DELETE FIELD Bnk_Acc_Num OK
%v_CommVMF% IF FTYPE("VMF_BnkAcc")<>"y" OR FILESIZE("%fld_Workings%VMF_BnkAcc.FIL") < 0 DEFINE FIELD Bnk_Acc_Num COMPUTED BLANKS(20)
%v_CommVMF% IF FTYPE("VMF_BnkAcc")="y" AND FILESIZE("%fld_Workings%VMF_BnkAcc.FIL") >=0 DEFINE FIELD Bnk_Acc_Num COMPUTED VMF_BnkAcc.Bnk_Acc_Num

%v_CommVMF% DELETE FIELD BSB OK
%v_CommVMF% IF FTYPE("VMF_BnkAcc")<>"y" OR FILESIZE("%fld_Workings%VMF_BnkAcc.FIL") < 0 DEFINE FIELD BSB COMPUTED BLANKS(20)
%v_CommVMF% IF FTYPE("VMF_BnkAcc")="y" AND FILESIZE("%fld_Workings%VMF_BnkAcc.FIL") >= 0 DEFINE FIELD BSB COMPUTED VMF_BnkAcc.BSB

%v_CommVMF% IF FTYPE("AP_Vnd_InvGst_Sum")="y" AND FILESIZE("%fld_Workings%AP_Vnd_InvGst_Sum.FIL") >= 0 DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum INDEX IDX_AP_Sum_VndrID
%v_CommVMF% DELETE FIELD Inv_Amt OK
%v_CommVMF% IF FTYPE("AP_Vnd_InvGst_Sum")<>"y" OR FILESIZE("%fld_Workings%AP_Vnd_InvGst_Sum.FIL") < 0 DEFINE FIELD Inv_Amt COMPUTED 0.00
%v_CommVMF% IF FTYPE("AP_Vnd_InvGst_Sum")="y" AND FILESIZE("%fld_Workings%AP_Vnd_InvGst_Sum.FIL") >= 0 DEFINE FIELD Inv_Amt COMPUTED AP_Vnd_InvGst_Sum.InvAmt_12M

%v_CommVMF% DELETE FIELD GST_Amt OK
%v_CommVMF% IF FTYPE("AP_Vnd_InvGst_Sum")<>"y" OR FILESIZE("%fld_Workings%AP_Vnd_InvGst_Sum.FIL") < 0 DEFINE FIELD GST_Amt COMPUTED  0.00
%v_CommVMF% IF FTYPE("AP_Vnd_InvGst_Sum")="y" AND FILESIZE("%fld_Workings%AP_Vnd_InvGst_Sum.FIL") >= 0 DEFINE FIELD GST_Amt COMPUTED AP_Vnd_InvGst_Sum.GSTAmt_12M

%v_CommVMF% DELETE FIELD COUNT OK
%v_CommVMF% IF FTYPE("AP_Vnd_InvGst_Sum")<>"y" OR FILESIZE("%fld_Workings%AP_Vnd_InvGst_Sum.FIL") < 0 DEFINE FIELD COUNT COMPUTED 0
%v_CommVMF% IF FTYPE("AP_Vnd_InvGst_Sum")="y" AND FILESIZE("%fld_Workings%AP_Vnd_InvGst_Sum.FIL") >= 0 DEFINE FIELD COUNT COMPUTED AP_Vnd_InvGst_Sum.Cnt_12M 

%v_CommEMF% OPEN EMF_TMP_Emp
%v_CommEMF% IF FTYPE("Payroll_Sum_12m")="y" AND FILESIZE("%fld_Workings%Payroll_Sum_12m.FIL")>=0 DEFINE RELATION Co_Emp_ID WITH Payroll_Sum_12m INDEX IDX_Payroll_Sum_ID

%v_CommEMF% DELETE FIELD Total_PayAmt OK
%v_CommEMF% IF FTYPE("Payroll_Sum_12m")<>"y" OR FILESIZE("%fld_Workings%Payroll_Sum_12m.FIL")<0 DEFINE FIELD Total_PayAmt COMPUTED 0.00
%v_CommEMF% IF FTYPE("Payroll_Sum_12m")="y" AND FILESIZE("%fld_Workings%Payroll_Sum_12m.FIL")>=0 DEFINE FIELD Total_PayAmt COMPUTED Payroll_Sum_12m.ActPaidAmt 

%v_CommEMF% DELETE FIELD Total_Pay_Num OK
%v_CommEMF% IF FTYPE("Payroll_Sum_12m")<>"y" OR FILESIZE("%fld_Workings%Payroll_Sum_12m.FIL")<0  DEFINE FIELD Total_Pay_Num COMPUTED  0.00
%v_CommEMF% IF FTYPE("Payroll_Sum_12m")="y" AND FILESIZE("%fld_Workings%Payroll_Sum_12m.FIL")>=0 DEFINE FIELD Total_Pay_Num COMPUTED Payroll_Sum_12m.COUNT

IF v_CommVMF<>"" or v_CommEMF<>"" ESCAPE

OPEN VMF_Vnd_Master_File
EXTRACT FIELDS SUBSTR("VM",1,2) AS "VM_EM" SUBSTR(Vndr_Site_ID,1,20) AS "Vndr_Site_ID" SUBSTR(Vndr_Sts,1,2) AS "Vndr_Sts" SUBSTR(Vndr_ID,1,20) AS "Vndr_ID" SUBSTR(Vndr_Nme,1,65) AS "Vndr_Nme" SUBSTR(Vndr_Typ,1,20) AS "Vndr_Typ"  SUBSTR(ADD1,1,61) AS "ADD1" SUBSTR(ADD2,1,61) AS "ADD2" SUBSTR(ADD3,1,61) AS "ADD3" SUBSTR(City,1,35) AS "City" SUBSTR(State,1,29) AS "State" SUBSTR(Pcode,1,11) AS "PCode" SUBSTR(Cntry,1,61) AS "Cntry" SUBSTR(TEL1,1,21) AS "TEL1" SUBSTR(TEL2,1,21) AS "TEL2" SUBSTR(TEL3,1,21) AS "TEL3" SUBSTR(FAX,1,21) AS "FAX" SUBSTR(ABN,1,20) AS "ABN" SUBSTR(BSB,1,20) AS "BSB" SUBSTR(Bnk_Acc_Num,1,20) AS "Bnk_Acc_Num" SUBSTR(Email1,1,60) AS "Email1" SUBSTR(Email2,1,60) AS "Email2" VALUE(STRING(Inv_Amt,15),2) AS "Inv_Amt" VALUE(STRING(GST_Amt ,15),2) AS "GST_Amt" VALUE(STRING(COUNT,9),0) AS "COUNT" SUBSTR(" ",1,10) AS "Hire_Dt" SUBSTR(" ",1,10) AS "Trm_Dt" SUBSTR(ALLTRIM(DATE(Created_Dt)),1,10) AS "Created_Dt" SUBSTR(ALLTRIM(DATE(Modf_Dt)),1,10) AS "Modf_Dt" TO "%fld_Workings%Vnd_Emp_Master" OPEN

OPEN EMF_TMP_Emp
EXTRACT FIELDS SUBSTR("EM",1,2) AS "VM_EM" SUBSTR(Co_Emp_ID,1,20) AS "Co_Emp_ID" SUBSTR(Emp_Sts, 1,2) AS "Emp_Sts" SUBSTR(ALLTRIM(EMP_ID),1,20) AS "EMP_ID" SUBSTR(ALLTRIM(Emp_Nme),1,65) AS "Emp_Nme" SUBSTR(ALLTRIM("HR-EMP"),1,20) as "Vndr_Typ" SUBSTR(ALLTRIM(Add1),1,61) AS "Add1" SUBSTR(ALLTRIM(Add2),1,61) AS "Add2" SUBSTR(ALLTRIM(Add3),1,61) AS "Add3" SUBSTR(ALLTRIM(City),1,35) AS "City" SUBSTR(ALLTRIM(State),1,29) AS "State" SUBSTR(ALLTRIM(PCode),1,11) as "Pcode" SUBSTR(ALLTRIM(Cntry),1,61) AS "Cntry" SUBSTR(ALLTRIM(TEL1),1,21) as "Tel1" SUBSTR(ALLTRIM(TEL2),1,21) as "Tel2" SUBSTR(ALLTRIM(TEL3),1,21) AS "Tel2" SUBSTR(ALLTRIM(FAX),1,21) AS "Fax" SUBSTR(ALLTRIM(Tax_Fle_Num),1,20) AS "ABN" SUBSTR(BSB,1,20) AS "BSB" SUBSTR(Bnk_Acc_Num,1,20) AS "Bnk_Acc_Num" SUBSTR(Email_Privt,1,60) AS "Email1" SUBSTR(Email_Bus,1,60) AS "Email2" VALUE(STRING(Total_PayAmt,15),2) AS "TtlInvAmt" VALUE(STRING(0.00,15),2) AS "TtlGstAmt" VALUE(STRING(0,9),0) as "Count" SUBSTR(ALLTRIM(DATE(Hire_Dt)),1,10) AS "Hire_Dt" SUBSTR(ALLTRIM(DATE(Trm_Dt)),1,10) AS "Trm_Dt" SUBSTR(ALLTRIM(DATE(Created_Dt)),1,10) AS "Created_Dt" SUBSTR(ALLTRIM(DATE(Modf_Dt)),1,10) AS "Modf_Dt" TO "%fld_Workings%Vnd_Emp_Master" OPEN APPEND


DELETE FIELD KEY1 OK
DEFINE FIELD KEY1 COMPUTED SUBSTR(ALLTRIM(VM_EM)+ALLTRIM(Vndr_ID),1,22)

DELETE FIELD KEY OK
DEFINE FIELD KEY COMPUTED SUBSTR(ALLTRIM(VM_EM)+ALLTRIM(Vndr_Site_ID),1,22)


INDEX ON KEY TO IDX_VndEmp_KEY

INDEX ON KEY1 TO IDX_VndEmp_KEY1


^BATCH    MZ005_EmpBk_Chg_His                
[PARENT_FOLDER_ID] 1430796753
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Save all historical changes of the employee bank accounts into EMF_BnkAcc_Chg_History
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 8/11/2012
COMM***************************************************************************

IF FTYPE("v_AppAX")="U" DO AA002_Variable_Setting

OPEN %trg_EMF_BK%

EXTRACT ALL _RptRunDateTime AS 'RptRunDateTime' TO %fld_Tmps%TMP6 OPEN
COMM*** If the record length is changed, then clean up the history file, and capture the change history again ***
v_RecLen1=RECLEN()
v_RecLen2=0

IF FTYPE("EMF_BnkAcc_Chg_History")="y" OPEN EMF_BnkAcc_Chg_History
%v_AppAX% IF FTYPE("EMF_BnkAcc_Chg_History")="y" EXTRACT FIELDS ALL TO "%fld_Tmps%AXTmp1"
%v_AppAX% IF FTYPE("EMF_BnkAcc_Chg_History")="y" EXTRACT FIELDS ALL TO "%fld_Workings%EMF_BnkAcc_Chg_History" OPEN
IF FTYPE("EMF_BnkAcc_Chg_History")="y" AND FILESIZE("%fld_Workings%EMF_BnkAcc_Chg_History.fil") >=0 v_RecLen2=RECLEN()

IF v_RecLen1<>v_RecLen2 DELETE FORMAT EMF_BnkAcc_Chg_History OK
IF v_RecLen1<>v_RecLen2 DELETE "%fld_Workings%EMF_BnkAcc_Chg_History.fil" OK

OPEN TMP6
IF FTYPE("EMF_BnkAcc_Chg_History")<>"y" OR FILESIZE("%fld_Workings%EMF_BnkAcc_Chg_History.fil") <=0 EXTRACT FIELDS ALL TO "%fld_Workings%EMF_BnkAcc_Chg_History" OPEN
IF FTYPE("EMF_BnkAcc_Chg_History")="y" AND FILESIZE("%fld_Workings%EMF_BnkAcc_Chg_History.fil") >0 OPEN EMF_BnkAcc_Chg_History

COMM *** If it is the first time to capture the Bank master change history file, then don't need to do the following logic ***
IF v_RecLen1<>v_RecLen2 ESCAPE

COMM *** Select the lastest banks set for the employee ***
SET FOLDER /%fld_Tmps%
SORT ON Co_Emp_ID ALLTRIM(SUBSTR(RptRunDateTime,7,4)+ "-"+SUBSTR(RptRunDateTime,4,2)+"-"+ SUBSTR(RptRunDateTime,1,2)+SUBSTR(RptRunDateTime,11,9)) D TO %fld_Tmps%TMP1 OPEN
DELETE FIELD KEY1 OK
DEFINE FIELD KEY1 COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+ALLTRIM(RptRunDateTime),1,39)

COMMENT Do not use PRESORT because it is already sorted above. Also ACL 11 PRESORT will ruin the sort order.
SUMMARIZE ON Co_Emp_ID OTHER KEY1 TO  %fld_Tmps%TMP2 OPEN 


INDEX ON KEY1 TO IDX_TMP2
OPEN TMP1
DEFINE RELATION KEY1 WITH TMP2 INDEX IDX_TMP2

EXTRACT FIELDS ALL IF KEY1=TMP2.KEY1 TO %fld_Tmps%TMP3 OPEN
DELETE FIELD KEY OK
DEFINE FIELD KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+ALLTRIM(Bnk_Acc_Type)+INCLUDE(BSB+Bnk_Acc_Num,"1234567890"),1,65)
INDEX ON KEY TO IDX_TMP

OPEN TMP6
DELETE FIELD KEY OK
DEFINE FIELD KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+ALLTRIM(Bnk_Acc_Type)+INCLUDE(BSB+Bnk_Acc_Num,"1234567890"),1,65)

DEFINE RELATION KEY WITH TMP3 INDEX IDX_TMP
SUMMARIZE ON Co_Emp_ID IF ISBLANK(TMP3.KEY) TO %fld_Tmps%TMP4 OPEN PRESORT
INDEX ON Co_Emp_ID TO IDX_TMP6

COMM *** If there is any change, then append the whole bank accounts data set for this employee into the history table *** 
OPEN TMP6
DEFINE RELATION Co_Emp_ID WITH TMP4 INDEX IDX_TMP6

SET FOLDER/%fld_Workings%
EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "%fld_Workings%EMF_BnkAcc_Chg_History" APPEND



^BATCH    MA001_Main_Menu                    
[PARENT_FOLDER_ID] 1430796753
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Convert Source Data To Target Working File Tables: Main Menu
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET SAFETY OFF

IF FTYPE("_Version")="U" OR FTYPE("fld_Sources") ="U" DO AA002_Variable_Setting

FLAG1=F
DO MA002_Convert_Menu WHILE FLAG1=F

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    MZ006_VndBk_Chg_His                
[PARENT_FOLDER_ID] 1430796753
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Save all historical changes of the employee bank accounts into VMF_BnkAcc_Chg_History
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 8/11/2012
COMM***************************************************************************
IF FTYPE("v_AppAX")="U" DO AA002_Variable_Setting
SET SAFETY OFF

IF FTYPE("%trg_VMF_BK%")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF_BK%.fil") <= 0 ESCAPE

OPEN %trg_VMF_BK%
COMM
EXTRACT Vndr_Site_ID Vndr_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type Chg_Dt _RptRunDateTime AS 'RptRunDateTime' TO %fld_Tmps%TMP6 OPEN
COMM*** If the record length is changed, then clean up the history file, and capture the change history again ***

EXTRACT Vndr_Site_ID Vndr_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type Chg_Dt _RptRunDateTime AS 'RptRunDateTime' TO %fld_Tmps%TMP6 OPEN
COMM*** If the record length is changed, then clean up the history file, and capture the change history again ***


v_RecLen1=RECLEN()
v_RecLen2=0

IF FTYPE("VMF_BnkAcc_Chg_History")="y"  OPEN VMF_BnkAcc_Chg_History

IF FTYPE("VMF_BnkAcc_Chg_History")="y"  v_RecLen2=RECLEN()

IF v_RecLen1<>v_RecLen2 DELETE FORMAT VMF_BnkAcc_Chg_History OK
IF v_RecLen1<>v_RecLen2 DELETE "%fld_Workings%VMF_BnkAcc_Chg_History.fil" OK

OPEN TMP6

IF FTYPE("VMF_BnkAcc_Chg_History")<>"y" EXTRACT FIELDS ALL TO "%fld_Workings%VMF_BnkAcc_Chg_History" OPEN
IF FTYPE("VMF_BnkAcc_Chg_History")="y"  OPEN VMF_BnkAcc_Chg_History

COMM *** If it is the first time to capture the Bank master change history file, then don't need to do the following logic ***

IF v_RecLen1<>v_RecLen2 ESCAPE

COMM *** Select the lastest banks set for the employee ***
SET FOLDER /%fld_Tmps%

EXTRACT FIELDS ALL TO "%fld_Tmps%Tmp_Chg"

SORT ON Vndr_Site_ID ALLTRIM(SUBSTR(RptRunDateTime,7,4)+ "-"+SUBSTR(RptRunDateTime,4,2)+"-"+ SUBSTR(RptRunDateTime,1,2)+SUBSTR(RptRunDateTime,11,9)) D TO %fld_Tmps%TMP1 OPEN

DELETE FIELD KEY1 OK
DEFINE FIELD KEY1 COMPUTED SUBSTR(ALLTRIM(Vndr_Site_ID)+ALLTRIM(RptRunDateTime),1,39)

SUMMARIZE ON Vndr_Site_ID OTHER KEY1 TO  %fld_Tmps%TMP2 OPEN PRESORT

INDEX ON KEY1 TO IDX_TMP2

OPEN TMP1

DEFINE RELATION KEY1 WITH TMP2 INDEX IDX_TMP2

EXTRACT FIELDS ALL IF KEY1=TMP2.KEY1 TO %fld_Tmps%TMP3 OPEN

DELETE FIELD skKEY OK
DEFINE FIELD skKEY COMPUTED SUBSTR(ALLTRIM(Vndr_Site_ID)+ALLTRIM(Bnk_Acc_Type)+INCLUDE(BSB+Bnk_Acc_Num,"1234567890"),1,65)

INDEX ON skKEY TO IDX_TMP

OPEN TMP6

DELETE FIELD skKEY OK
DEFINE FIELD skKEY COMPUTED SUBSTR(ALLTRIM(Vndr_Site_ID)+ALLTRIM(Bnk_Acc_Type)+INCLUDE(BSB+Bnk_Acc_Num,"1234567890"),1,65)

DEFINE RELATION skKEY WITH TMP3 INDEX IDX_TMP

SUMMARIZE ON Vndr_Site_ID IF ISBLANK(TMP3.skKEY) TO %fld_Tmps%TMP4 OPEN PRESORT

INDEX ON Vndr_Site_ID TO IDX_TMP4

COMM *** If there is any change, then append the whole bank accounts data set for this employee into the history table *** 
OPEN TMP6

DEFINE RELATION Vndr_Site_ID WITH TMP4 INDEX IDX_TMP4

SET FOLDER/%fld_Workings%

COMM
EXTRACT FIELDS Vndr_Site_ID Vndr_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type Chg_Dt _RptRunDateTime AS 'RptRunDateTime' IF Vndr_Site_ID=TMP4.Vndr_Site_ID TO "%fld_Workings%Tmp_Chg" APPEND

EXTRACT FIELDS Vndr_Site_ID Vndr_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type Chg_Dt _RptRunDateTime AS 'RptRunDateTime' IF Vndr_Site_ID=TMP4.Vndr_Site_ID TO "%fld_Workings%Tmp_Chg" APPEND

COMM *** FOR AX ***

OPEN Tmp_Chg

EXTRACT FIELDS ALL TO "%fld_Workings%VMF_BnkAcc_Chg_History" OPEN
^BATCH    CB007_Imp_VMBnk_SubA               
[PARENT_FOLDER_ID] 1341537122
SET SAFETY OFF

SET FOLDER /%fld_Sources%
IF FTYPE("_Last2YearTranDt")="U" DO AA002_Variable_Setting

COMM ********************************
COMM *** Combine: AP_INVOICES_ALL ***
COMM ********************************
SET DATE "DD/MM/YYYY"

OPEN AP_VendorMasterBnkAcc_ALL_New 

DELETE FIELD C_KEY OK
DEFINE FIELD C_KEY COMPUTED SUBSTR(ALLTRIM(_VENDOR_SITE_ID_)+ALLTRIM(VENDOR_ID__)+ALLTRIM(_VENDOR_BSB_)+ALLTRIM(_VENDOR_BANK_ACCOUNT_NUMBER_),1,50)


INDEX ON C_KEY TO IDX_NewVMBnk_Key

COMM *** Include all new invoices
EXTRACT RECORD TO "%fld_Tmps%TMP3.FIL"

OPEN AP_VendorMasterBnkAcc_ALL



EXTRACT RECORD TO AP_VendorMasterBnkAcc_ALL_Old OPEN


DEFINE FIELD c_StartDate       COMPUTED 
SPLIT(_ACCT_START_DATE_,"/",1)+"/"+SPLIT(_ACCT_START_DATE_,"/",2)+"/"+SUBSTRING(SPLIT(_ACCT_START_DATE_,"/",3),1,4) IF _ACCT_START_DATE_<>" "
 " "
DEFINE FIELD c_StartDate1       COMPUTED 
WIDTH 27  
 CTOD(c_StartDate,"DD/MM/YYYY")
DEFINE FIELD c_EndDate       COMPUTED 
SPLIT(_ACCT_END_DATE,"/",1)+"/"+SPLIT(_ACCT_END_DATE,"/",2)+"/"+SUBSTRING(SPLIT(_ACCT_END_DATE,"/",3),1,4) IF _ACCT_END_DATE<>" "
 " "
DEFINE FIELD c_EndDate1       COMPUTED 
WIDTH 27  
 CTOD(c_EndDate,"DD/MM/YYYY")



DELETE FIELD C_KEY OK
DEFINE FIELD C_KEY COMPUTED SUBSTR(ALLTRIM(_VENDOR_SITE_ID_)+ALLTRIM(VENDOR_ID__)+ALLTRIM(_VENDOR_BSB_)+ALLTRIM(_VENDOR_BANK_ACCOUNT_NUMBER_),1,50)

DEFINE RELATION C_KEY WITH AP_VendorMasterBnkAcc_ALL_New INDEX IDX_NewVMBnk_Key

COMM *** Include only old invoices which are not recently added/updated
COMM
EXTRACT RECORD TO "%fld_Tmps%TMP3.FIL" IF NOT MATCH(AP_VendorMasterBnkAcc_ALL_New.C_KEY AP_VendorMasterBnkAcc_ALL_Old.C_KEY) AND ((c_StartDate1 >= _Last2YearTranDt ) OR (c_EndDate1 >= _Last2YearTranDt)) APPEND OPEN
END

EXTRACT RECORD TO "%fld_Tmps%TMP3.FIL" IF NOT MATCH(AP_VendorMasterBnkAcc_ALL_New.C_KEY AP_VendorMasterBnkAcc_ALL_Old.C_KEY)  APPEND OPEN

COMM *** Remove key field
DELETE FIELD C_KEY OK
EXTRACT RECORD TO AP_VendorMasterBnkAcc_ALL

^FOLDER   Tmp_Files                           1430899205
[PARENT_FOLDER_ID] 0
^BATCH    AP001_Dup_Clean_Dup_Aft_23         
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP001. For the DUP1- Same Vendor, InvNo, Amount and Date, if it has been included in other dup report, no necessary show it again. 
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("_Version")="U" OR FTYPE("trg_VMF")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

COMM *** Start Clean up ***
OPEN AP002_Dup_Amt_Inv_Vndr
IF FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil")>=0 AND (FILESIZE("%fld_History%AP002_History.fil") >0 AND FTYPE("AP002_History")="y") OPEN AP002_History
IF FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil")>=0 AND (FILESIZE("%fld_History%AP002_History.fil") <=0 OR FTYPE("AP002_History")<>"y") OPEN AP002_Dup_Amt_Inv_Vndr
IF FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil")>=0 AND (FTYPE("AP002_History")="y" OR FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil")>=0) EXTRACT FIELDS Vchr_ID TO "%fld_Tmps%TMP_AP_Dups" 

OPEN AP003_Dup_Amt_Dt_Inv

IF FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil")>=0 AND (FILESIZE("%fld_History%AP003_History.fil") >0 AND FTYPE("AP003_History")="y") OPEN AP003_History
IF FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil")>=0 AND (FILESIZE("%fld_History%AP003_History.fil") <=0 OR FTYPE("AP003_History")<>"y") OPEN AP003_Dup_Amt_Dt_Inv
IF FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil")>=0 AND (FTYPE("AP003_History")="y" OR FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil")>=0) EXTRACT FIELDS Vchr_ID TO "%fld_Tmps%TMP_AP_Dups" APPEND

OPEN AP_Dups_Rev
EXTRACT FIELDS Vchr_ID TO "%fld_Tmps%TMP_AP_Dups" APPEND

OPEN TMP_AP_Dups
INDEX ON Vchr_ID TO IDX_TMP_AP_Dups_ID


OPEN AP001_TMP
DEFINE RELATION Vchr_ID WITH TMP_AP_Dups INDEX IDX_TMP_AP_Dups_ID
SUMMARIZE ON DUP_KEY IF Vchr_ID<> TMP_AP_Dups.Vchr_ID AND Flag="O" TO "%fld_Tmps%TMP_AP_Dups_1.FIL" OPEN PRESORT


INDEX ON DUP_KEY TO IDX_TMP_AP_Dups_1_DUP_KEY

OPEN AP001_TMP
DEFINE RELATION DUP_KEY WITH TMP_AP_Dups_1 INDEX IDX_TMP_AP_Dups_1_DUP_KEY

EXTRACT RECORD IF DUP_KEY= TMP_AP_Dups_1.DUP_KEY TO "%fld_Tmps%TMP_AP_Dups_2" OPEN 

SUMMARIZE ON DUP_KEY SUBTOTAL Inv_Amt TO "%fld_Tmps%TMP_DUP_SUM.FIL" OPEN PRESORT 
 

INDEX ON DUP_KEY TO IDX_TMP_DUP_SUM_DUP_KEY

OPEN TMP_AP_Dups_2
DEFINE RELATION DUP_KEY WITH TMP_DUP_SUM INDEX IDX_TMP_DUP_SUM_DUP_KEY

DELETE FIELD RANK OK
DEFINE FIELD RANK COMPUTED

"2" IF TMP_DUP_SUM.Inv_Amt>0
"1" IF TMP_DUP_SUM.Inv_Amt<0
"0" 

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vchr_ID)+"~"+ALLTRIM(DUP_KEY),1,85)
v_ID_KEY="ID_KEY"
v_TEST_NO="AP001"
v_DUP_KEY="DUP_KEY"
v_Filter="AND FLAG='O'"
IF v_Exc_History =T DO AE001_Dup_History
IF v_Chk_CCM=T DO AE006_Dup_CCM
COMM *** End ***

COMM *** keep the RANK information***
IF v_Exc_History =F EXTRACT FIELDS ALL TO "%fld_Tmps%TMP11" OPEN

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(RANK)+"~"+ZONED(ABS_INVAMT,21)+"~"+ALLTRIM(DUP_KEY)+"~"+ALLTRIM(Flag) +"~"+ALLTRIM(c_Inv_Dt),1,80)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "DupAmt_Rank ABS_InvAmt Flag DUP_KEY Inv_Date D"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "H"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP001. Duplicated Invoices by InvNo,Amt,Date and VndNbr"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

COMM create a quoted invoice id field - to prevent issue with stripping of leading zeros in excel spreadsheet
DELETE FIELD c_QUOTED_INV_ID
DEFINE FIELD c_QUOTED_INV_ID COMPUTED "'"+ ALLTRIM(Inv_No) + "'"


comm *** finalize the result  ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr" OPEN

DEFINE RELATION Vndr_Site_ID WITH %trg_VMF% INDEX IDX_VndrSiteID


SET FOLDER /%fld_Tmps%

v_Exp_Fields_AP001 = "Flag VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description'  Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc" 

 OPEN AP001_Dup_Amt_Dt_Inv_Vndr
 EXTRACT %v_Exp_Fields_AP001% TO  TMP_AP001


SET FOLDER /%fld_Results%

COMM *** Delete All the TMP files for Dups processing ***
DO AZ002_Dup_DelTmp

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    MP001_Convert_VMF                  
[PARENT_FOLDER_ID] 1430796753
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Convert Source Data To Target Working File Tables: Vendor Master File
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("fld_Workings")="U" OR FTYPE("trg_VMF")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER/%fld_Workings%

COMM *** convert Vendor master file ***

COMM *** Capture the linkage relationships for the data mapping, convert the source data into target standard table ***
OPEN DM_%trg_VMF%

COMM *** Extract the mapping information from the mapping file (e.g. DM_VMF_Vnd_Master_File)***
DO MZ001_Convert

COMM *** IF relationship between source table and target table has not been build, need to build the relationship first, goto the menu "Link fields/Mapping" ***
IF src_File_Name="" OR v_COUNT=0 OR v_Flds_Extract="" PAUSE "There is no data mapping information - Vendor Master File, please link/map the source fields to the standard fields first."
IF src_File_Name="" OR v_COUNT=0 OR v_Flds_Extract="" DO LE001_Link_Menu

COMM *** IF relationship between source table and target table has been build, convert data directely. ***

IF src_File_Name<>"" AND v_Flds_Extract<>""  OPEN %src_File_Name%
IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS %v_Flds_Extract%  TO "%fld_Workings%%trg_VMF%.FIL"

IF FTYPE("%trg_VMF%")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF%.fil")<=0 PAUSE "Vendor Master File Table has not been converted properly. Please check the fields mapping and convert it again."
IF FTYPE("%trg_VMF%")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF%.fil")<=0 ESCAPE

COMM *** convert Vendor Address***
OPEN DM_%trg_VMF_Add%
DO MZ001_Convert
IF src_File_Name<>"" AND v_Flds_Extract<>""  OPEN %src_File_Name%
IF v_Flds_Extract<>"" EXTRACT FIELDS %v_Flds_Extract% FIRST 0 TO "%fld_Workings%%trg_VMF_Add%.FIL"
IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS %v_Flds_Extract%  TO "%fld_Workings%%trg_VMF_Add%.FIL" APPEND

COMM *** convert Vendor Bank Account ***
OPEN DM_%trg_VMF_BK%
DO MZ001_Convert
IF src_File_Name<>"" AND v_Flds_Extract<>""  OPEN %src_File_Name%
IF v_Flds_Extract<>"" EXTRACT FIELDS %v_Flds_Extract% FIRST 0 TO "%fld_Workings%%trg_VMF_BK%_Tmp.FIL" 
IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS %v_Flds_Extract%  TO "%fld_Workings%%trg_VMF_BK%_Tmp.FIL" OPEN APPEND

OPEN %trg_VMF_BK%_Tmp
SUMMARIZE ON %v_flds_VMF_BK%  IF NOT ISBLANK(INCLUDE(ALLTRIM(BSB)+ALLTRIM(Bnk_Acc_Num),"0123456789")) TO "%fld_Workings%%trg_VMF_BK%.FIL" 

INDEX ON Vndr_Site_ID TO IDX_BnkVndrSiteID

COMM *** convert Vendor Inter Company ***
OPEN DM_%trg_VMF_InterCo%
DO MZ001_Convert
IF src_File_Name<>"" AND v_Flds_Extract<>""  OPEN %src_File_Name%
IF v_Flds_Extract<>"" EXTRACT FIELDS %v_Flds_Extract% FIRST 0 TO "%fld_Workings%%trg_VMF_InterCo%.FIL"
IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS %v_Flds_Extract%  TO "%fld_Workings%%trg_VMF_InterCo%.FIL" APPEND

COMM *** convert One Time Vendor ***
OPEN DM_%trg_VMF_OTV%
DO MZ001_Convert
IF src_File_Name<>"" AND v_Flds_Extract<>""  OPEN %src_File_Name%
IF v_Flds_Extract<>"" EXTRACT FIELDS %v_Flds_Extract% FIRST 0 TO "%fld_Workings%%trg_VMF_OTV%.FIL"
IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS %v_Flds_Extract%  TO "%fld_Workings%%trg_VMF_OTV%.FIL" APPEND


COMM *** prepare vendor master file ***

OPEN %trg_VMF%
INDEX ON Vndr_Site_ID TO IDX_VndrSiteID
INDEX ON Vndr_ID TO IDX_Vndr_ID

DELETE FIELD c_Vndr_ID OK
DEFINE FIELD c_Vndr_ID COMPUTED 

ALLTRIM(INCLUDE(Vndr_ID,"0123456789")) IF LENGTH(ALLTRIM(INCLUDE(Vndr_ID,"0123456789"))) > LENGTH(ALLTRIM(INCLUDE(UPPER(Vndr_ID),"ABCDEFGHIJKLMNOPQRSTUVWXYZ"))) 
ALLTRIM(INCLUDE(UPPER(Vndr_ID),"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) IF LENGTH(ALLTRIM(INCLUDE(Vndr_ID,"0123456789"))) < LENGTH(ALLTRIM(INCLUDE(UPPER(Vndr_ID),"ABCDEFGHIJKLMNOPQRSTUVWXYZ"))) 
Vndr_ID

DELETE FIELD ABN_CLN OK 
DEFINE FIELD ABN_CLN COMPUTED SUBSTR(ALLTRIM(INCLUDE(ABN,"0123456789")),1,20)

DELETE FIELD InvABN OK
DEFINE FIELD InvABN COMPUTED

"T" IF (LAST( ALLTRIM( STRING( (1.00 * ((VALUE( SUBSTR(ABN_CLN, 1, 1), 0) - 1) * 10 + (VALUE( SUBSTR( ABN_CLN, 2, 1), 0) * 1) + (VALUE( SUBSTR( ABN_CLN, 3, 1), 0) * 3) + (VALUE( SUBSTR( ABN_CLN, 4, 1), 0) * 5) + (VALUE( SUBSTR( ABN_CLN, 5, 1), 0) * 7) + (VALUE( SUBSTR( ABN_CLN, 6, 1), 0) * 9) + (VALUE( SUBSTR( ABN_CLN, 7, 1), 0) * 11) + (VALUE( SUBSTR( ABN_CLN, 8, 1), 0) * 13) + (VALUE( SUBSTR( ABN_CLN, 9, 1), 0) * 15) + (VALUE( SUBSTR( ABN_CLN, 10, 1), 0) * 17) + (VALUE( SUBSTR( ABN_CLN, 11, 1), 0) * 19))) / 89.00, 12 )), 2) <> "00"  OR ((NOT MAP( ABN_CLN, "99999999999") OR (LENGTH( ALLTRIM( ABN_CLN)) <>11)))) AND LENGTH(ALLTRIM(ABN_CLN))>1 AND MATCH(UPPER(Cntry),"AU","AUST","AUS","AUSTRALIA"," ")
"M" IF LENGTH(ALLTRIM(ABN_CLN))<=1 AND VALUE(ABN_CLN,0) =0 AND MATCH(UPPER(Cntry),"AU","AUST","AUS","AUSTRALIA"," ") 
"O" IF NOT MATCH(UPPER(Cntry),"AU","AUST","AUS","AUSTRALIA"," ")
"E" IF MATCH(Vndr_Typ,"1E","2E","3E")
"F" 


COMM *** Save all historical changes into VMF_Chg_History ***
DO MZ004_Vnd_Chg_His

DO MZ006_VndBk_Chg_His

COMM *** Create relations between tables ***

IF FTYPE("%%trg_VMF_Add%%")="y" AND FILESIZE("%fld_Workings%%trg_VMF_Add%.fil") >= 0 OPEN %trg_VMF_Add%
IF FTYPE("%%trg_VMF_Add%%")="y" AND FILESIZE("%fld_Workings%%trg_VMF_Add%.fil") >= 0 DEFINE RELATION Vndr_Site_ID WITH %trg_VMF% INDEX IDX_VndrSiteID

IF FTYPE("%trg_VMF_BK%")="y" AND FILESIZE("%fld_Workings%%trg_VMF_BK%.fil") >= 0 OPEN %trg_VMF_BK%
IF FTYPE("%trg_VMF_BK%")="y" AND FILESIZE("%fld_Workings%%trg_VMF_BK%.fil") >= 0 DEFINE RELATION Vndr_Site_ID WITH %trg_VMF% INDEX IDX_VndrSiteID

IF FTYPE("%trg_VMF_OTV%")="y" AND FILESIZE("%fld_Workings%%trg_VMF_OTV%.fil") >= 0 OPEN %trg_VMF_OTV%
IF FTYPE("%trg_VMF_OTV%")="y" AND FILESIZE("%fld_Workings%%trg_VMF_OTV%.fil") >= 0 INDEX ON Vndr_Site_ID TO IDX_VMF_OTV_VndrSiteID
IF FTYPE("%trg_VMF_OTV%")="y" AND FILESIZE("%fld_Workings%%trg_VMF_OTV%.fil") >= 0 OPEN %trg_VMF%
IF FTYPE("%trg_VMF_OTV%")="y" AND FILESIZE("%fld_Workings%%trg_VMF_OTV%.fil") >= 0 DEFINE RELATION Vndr_Site_ID WITH %trg_VMF_OTV% IDX_VMF_OTV_VndrSiteID

IF FTYPE("%trg_VMF_InterCo%")="y" AND FILESIZE("%fld_Workings%%trg_VMF_InterCo%.fil") >= 0 OPEN %trg_VMF_InterCo%
IF FTYPE("%trg_VMF_InterCo%")="y" AND FILESIZE("%fld_Workings%%trg_VMF_InterCo%.fil") >= 0 INDEX ON Vndr_Site_ID TO IDX_VMF_InterCo_VndrSiteID
IF FTYPE("%trg_VMF_InterCo%")="y" AND FILESIZE("%fld_Workings%%trg_VMF_InterCo%.fil") >= 0 OPEN %trg_VMF%
IF FTYPE("%trg_VMF_InterCo%")="y" AND FILESIZE("%fld_Workings%%trg_VMF_InterCo%.fil") >= 0 DEFINE RELATION Vndr_Site_ID WITH %trg_VMF_InterCo% IDX_VMF_InterCo_VndrSiteID

IF FTYPE("%trg_AP_Inv%")="y" AND FILESIZE("%fld_Workings%%trg_AP_Inv%.fil") >= 0 OPEN %trg_AP_Inv%
IF FTYPE("%trg_AP_Inv%")="y" AND FILESIZE("%fld_Workings%%trg_AP_Inv%.fil") >= 0 DEFINE RELATION Vndr_Site_ID WITH %trg_VMF% INDEX IDX_VndrSiteID

IF FTYPE("%trg_AP_Pay%")="y" AND FILESIZE("%fld_Workings%%trg_AP_Pay%.fil") >= 0 OPEN %trg_AP_Pay%
IF FTYPE("%trg_AP_Pay%")="y" AND FILESIZE("%fld_Workings%%trg_AP_Pay%.fil") >= 0 DEFINE RELATION Vndr_Site_ID WITH %trg_VMF% INDEX IDX_VndrSiteID

IF FTYPE("AP_VndSite_InvGst_Sum")="y" AND FILESIZE("%fld_Workings%AP_VndSite_InvGst_Sum.FIL") >= 0 OPEN  %trg_VMF%
IF FTYPE("AP_VndSite_InvGst_Sum")="y" AND FILESIZE("%fld_Workings%AP_VndSite_InvGst_Sum.FIL") >= 0 DEFINE RELATION Vndr_Site_ID WITH AP_VndSite_InvGst_Sum INDEX IDX_AP_Sum_VndrSiteID

IF FTYPE("AP_Vnd_InvGst_Sum")="y" AND FILESIZE("%fld_Workings%AP_Vnd_InvGst_Sum.FIL") >= 0 OPEN %trg_VMF%
IF FTYPE("AP_Vnd_InvGst_Sum")="y" AND FILESIZE("%fld_Workings%AP_Vnd_InvGst_Sum.FIL") >= 0 DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum INDEX IDX_AP_Sum_VndrID
IF FTYPE("AP_Vnd_InvGst_Sum")="y" AND FILESIZE("%fld_Workings%AP_Vnd_InvGst_Sum.FIL") >= 0 DELETE FIELD Max_Inv_Dt OK 
IF FTYPE("AP_Vnd_InvGst_Sum")="y" AND FILESIZE("%fld_Workings%AP_Vnd_InvGst_Sum.FIL") >= 0 DEFINE FIELD Max_Inv_Dt COMPUTED AP_Vnd_InvGst_Sum.Inv_Dt 


DELETE FORMAT %trg_VMF_BK%_Tmp OK
DELETE "%fld_Workings%%trg_VMF_BK%_Tmp.FIL" OK

DO VMZ03_Prepare_ABN


SET SAFETY ON
^BATCH    New_Script3                        
[PARENT_FOLDER_ID] 1431654050
DO AA002_Variable_Setting

COMM
DO VM001_Dup_Vnd_BankAcc
DO VM002_Dup_Vnd_ABN
DO VM003_Dup_Vnd_Add
DO VM004_Dup_Vnd_Tel
DO VM005_Dup_Vnd_Name
DO VM006_Mis_Details
DO VM007_Invld_Frmt_ABN
DO VM008_Can_ABN
DO VM009_Invld_ABN_ABR

COMM
DO AP000_Dup_All_123
DO AP004_Dup_Amt_Dt_Vndr
DO AP006_Pay_Not_In_VMF
DO AP014_No_Trans_xx_Mon

COMM *** Export the file into delimited or access files 1: Access; 4: delimited; 2: Excel***
rad1=4

DO UZ006_CHK_Exp_F
CHK_Exp_VM001=T
CHK_Exp_VM002=T
CHK_Exp_VM003=T
CHK_Exp_VM004=T
CHK_Exp_VM005=T
CHK_Exp_VM006=T
CHK_Exp_VM007=T
CHK_Exp_VM008=T
CHK_Exp_VM009=T

CHK_Exp_AP001=T
CHK_Exp_AP002=T
CHK_Exp_AP003=T
CHK_Exp_AP004=T
CHK_Exp_AP006=T
CHK_Exp_AP014=T

DO UU001_Export

COMM *** delete tmp files and relations ***
DO AE003_Del_Tmp
CLOSE
^FOLDER   Convert                             1430796753
[PARENT_FOLDER_ID] 1430796652
^BATCH    AZ003_Dup_FixedUp                  
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Start removing reversals after done the dups
COMM *** Remove all the potential reversals: Match on Clean Invoice number and Whole Invoice/Credit Amounts (no cents)
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 12/06/2012
COMM***************************************************************************


SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

OPEN TMP_AP_DUPS

COMM *** Reversal logic: same Vndr_ID, ABS_InvAmt ***
COMM *** Reversal logic is to be applied on whole invoice amounts not on dollar of invoice amount


DELETE FIELD REV_KEY OK
DEFINE FIELD REV_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+"~"+ALLTRIM(c_Inv_No)+"~"+ALLTRIM(STRING(ABS_INVAMT_CENT,21)),1,54)
 

DELETE FIELD CREDIT_KEY OK
DEFINE FIELD CREDIT_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+"~"+ALLTRIM(STRING(ABS_INVAMT_CENT,21)),1,40)


INDEX ON CREDIT_KEY TO IDX_DUP_CREDIT_KEY 
INDEX ON REV_KEY TO IDX_DUP_REV_KEY 
INDEX ON Vchr_ID TO IDX_DUP_INV_ID1

EXTRACT FIELDS "O" AS "Flag" REV_KEY DUP_KEY CREDIT_KEY %v_flds_AP_Inv% TO "%fld_Tmps%TMP_AP_DUPS_1" 

COMM *** Get Credits Back to the Dups with same vendor and amount ***
OPEN AP_Invoice_Credits
DELETE FIELD REV_KEY OK
DEFINE FIELD REV_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+"~"+ALLTRIM(c_Inv_No)+"~"+ALLTRIM(STRING(ABS_INVAMT_CENT,21)),1,54)

DELETE FIELD CREDIT_KEY OK
DEFINE FIELD CREDIT_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+"~"+ALLTRIM(STRING(ABS_INVAMT_CENT,21)),1,40) 


DEFINE RELATION Vchr_ID WITH TMP_AP_DUPS IDX_DUP_INV_ID1

EXTRACT RECORD IF ABS_INVAMT<>0.00 AND ISBLANK(TMP_AP_DUPS.Vchr_ID) TO "%fld_Tmps%TMP_AP_CREDIT" OPEN
DEFINE RELATION REV_KEY WITH TMP_AP_DUPS IDX_DUP_REV_KEY  
OPEN TMP_AP_CREDIT
EXTRACT FIELDS "D" AS "Flag" REV_KEY TMP_AP_DUPS.DUP_KEY CREDIT_KEY %v_flds_AP_Inv% IF REV_KEY = TMP_AP_DUPS.REV_KEY TO "%fld_Tmps%TMP_AP_DUPS_1" OPEN APPEND

INDEX ON Vchr_ID TO IDX_DUP_INV_Vchr_ID1

COMM *** Get Credits Back to the Dups with same vendor and amount ***

COMM *** Start removing reversals ***
OPEN TMP_AP_DUPS_1
SUMMARIZE ON DUP_KEY REV_KEY SUBTOTAL Inv_Amt ABS_INVAMT IF Inv_Amt< 0.00 TO "%fld_Tmps%Dup_Neg.FIL" OPEN PRESORT
DELETE FIELD KEY OK
DEFINE FIELD KEY COMPUTED ALLTRIM(DUP_KEY)+ALLTRIM(REV_KEY)
INDEX ON KEY TO IDX_NEG_KEY  

OPEN TMP_AP_DUPS_1
SUMMARIZE ON DUP_KEY REV_KEY SUBTOTAL Inv_Amt ABS_INVAMT IF Inv_Amt> 0.00 TO "%fld_Tmps%Dup_Pos.FIL" PRESORT

OPEN Dup_Pos
DELETE FIELD KEY OK
DEFINE FIELD KEY COMPUTED ALLTRIM(DUP_KEY)+ALLTRIM(REV_KEY)

DEFINE RELATION KEY WITH Dup_Neg INDEX IDX_NEG_KEY
INDEX ON KEY TO IDX_POS_KEY 

EXTRACT FIELDS DUP_KEY COUNT-Dup_Neg.COUNT AS "COUNT" "Pos" AS "Type" ABS_INVAMT AS "Inv_Amt" IF ISBLANK(Dup_Neg.KEY) OR (KEY=Dup_Neg.KEY AND ABS_INVAMT <>Dup_Neg.ABS_INVAMT AND (COUNT-Dup_Neg.COUNT)>=1) TO "%fld_Tmps%Dup_RevF"

OPEN Dup_Neg
DEFINE RELATION KEY WITH Dup_Pos INDEX IDX_POS_KEY
EXTRACT FIELDS DUP_KEY COUNT-Dup_Pos.COUNT AS "COUNT" "Neg" AS "Type" ABS_INVAMT*-1 AS "Inv_Amt" IF ISBLANK(Dup_Pos.KEY) OR (KEY=Dup_Pos.KEY AND ABS_INVAMT <>Dup_Pos.ABS_INVAMT AND (COUNT-Dup_Pos.COUNT)>=1) TO "%fld_Tmps%Dup_RevF" APPEND

OPEN Dup_RevF
SUMMARIZE ON DUP_KEY SUBTOTAL Inv_Amt COUNT TO "%fld_Tmps%Dup_RevF_Sum.FIL" OPEN PRESORT

EXTRACT FIELDS DUP_KEY IF COUNT>1 AND Inv_Amt<>0 TO "%fld_Tmps%Dup_Keys" OPEN
INDEX ON DUP_KEY TO IDX_Dup_Keys  

OPEN TMP_AP_DUPS_1
DEFINE RELATION DUP_KEY WITH Dup_Keys INDEX IDX_Dup_Keys 

COMM *** Keep the Reversals
OPEN TMP_AP_DUPS_1
IF v_TestNo="AP001" EXTRACT FIELDS v_TestNo AS "Dup_No" DUP_KEY Flag %v_flds_AP_Inv% _RptRunDate AS "RptRunDate" IF ISBLANK(Dup_Keys.DUP_KEY) TO "%fld_Tmps%AP_Dups_Rev"
IF v_TestNo<>"AP001" DO AZ004_Dup_FixedUp_Rev

COMM *** Get the dups after fixed up
OPEN TMP_AP_DUPS_1
INDEX ON CREDIT_KEY TO IDX_DUP_CREDIT_KEY1
INDEX ON Vchr_ID TO IDX_DUP_INV_ID2
EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY %v_flds_AP_Inv% IF NOT ISBLANK(Dup_Keys.DUP_KEY) TO "%fld_Tmps%TMP_AP_DUPS_2" OPEN 
INDEX ON CREDIT_KEY TO IDX_DUP_CREDIT_KEY2

COMM *** END removing reversals ***

COMM *** Get Potential reversals - same Vndr_ID, ABS_InvAmt ***

OPEN TMP_AP_CREDIT
DELETE RELATION TMP_AP_DUPS OK

DEFINE RELATION Vchr_ID WITH TMP_AP_DUPS_1 IDX_DUP_INV_ID2

EXTRACT FIELDS CREDIT_KEY REV_KEY %v_flds_AP_Inv% IF ABS_INVAMT<>0.00 AND ISBLANK(TMP_AP_DUPS_1.Vchr_ID) TO "%fld_Tmps%TMP_AP_CREDIT1" OPEN

DEFINE RELATION CREDIT_KEY WITH TMP_AP_DUPS_2 INDEX IDX_DUP_CREDIT_KEY2  

EXTRACT FIELDS "C" AS "Flag" TMP_AP_DUPS_2.DUP_KEY CREDIT_KEY %v_flds_AP_Inv% IF NOT ISBLANK(TMP_AP_DUPS_2.CREDIT_KEY) TO "%fld_Tmps%TMP_AP_DUPS_5" OPEN 

EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY %v_flds_AP_Inv% TO "%fld_Tmps%TMP_AP_DUPS_2" APPEND







^BATCH    Dialog_AC003_Batch_Menu        
[PARENT_FOLDER_ID] 1340167442
DIALOG (DIALOG TITLE '%_Version% - Exception Tests' WIDTH 503 HEIGHT 132+100 ) (BUTTONSET TITLE '&OK;&Cancel' AT 360 132 DEFAULT 1 ) (TEXT TITLE 'Select Test Components' AT 132 16 ) (CHECKBOX TITLE 'Check to Exit/Escape' TO 'exit' AT 12 132+24 WIDTH 132 ) (CHECKBOX TITLE 'Accounts Payable Exception Tests' TO 'CHK_TEST_AP' AT 12 60 )(CHECKBOX TITLE 'Vendor Master File Exception Tests' TO 'CHK_TEST_VMF' AT 12 84 )(CHECKBOX TITLE 'Employee Master File Exception Tests' TO 'CHK_TEST_EMF' AT 12 108 )(CHECKBOX TITLE 'Payroll Exception Tests' TO 'CHK_TEST_PR' AT 12 132 )
^BATCH    CB007_Imp_VMF_SubA                 
[PARENT_FOLDER_ID] 1341537122
SET SAFETY OFF

SET FOLDER /%fld_Sources%
IF FTYPE("_Last2YearTranDt")="U" DO AA002_Variable_Setting

COMM ********************************
COMM *** Combine: AP_INVOICES_ALL ***
COMM ********************************


OPEN AP_VendorMaster_ALL_New

DELETE FIELD C_KEY OK
DEFINE FIELD C_KEY COMPUTED SUBSTR(ALLTRIM(STRING(VALUE(VENDOR_SITE_ID,0),20,"999999")),1,20)

INDEX ON C_KEY TO IDX_NewVMF_Key

COMM *** Include all new invoices
EXTRACT RECORD TO "%fld_Tmps%TMP3.FIL"

OPEN AP_VendorMaster_ALL
EXTRACT RECORD TO AP_VendorMaster_ALL_Old OPEN



DELETE FIELD C_KEY OK
DEFINE FIELD C_KEY COMPUTED SUBSTR(ALLTRIM(STRING(VALUE(VENDOR_SITE_ID,0),20,"999999")),1,20)

DEFINE RELATION C_KEY WITH AP_VendorMaster_ALL_New INDEX IDX_NewVMF_Key

COMM *** Include only old invoices which are not recently added/updated
EXTRACT RECORD TO "%fld_Tmps%TMP3.FIL" IF NOT MATCH(AP_VendorMaster_ALL_New.C_KEY AP_VendorMaster_ALL_Old.C_KEY)  APPEND OPEN


COMM *** Remove key field
DELETE FIELD C_KEY OK
EXTRACT RECORD TO AP_VendorMaster_ALL
^BATCH    CB007_Imp_Inv_SubA                 
[PARENT_FOLDER_ID] 1341537122
SET SAFETY OFF

SET FOLDER /%fld_Sources%
IF FTYPE("_Last2YearTranDt")="U" DO AA002_Variable_Setting

COMM ********************************
COMM *** Combine: AP_INVOICES_ALL ***
COMM ********************************


OPEN AP_INVOICES_ALL_New

DELETE FIELD C_KEY OK
DEFINE FIELD C_KEY COMPUTED SUBSTR(ALLTRIM(STRING(VALUE(INVOICE_ID,0),20,"9999999")),1,20)

INDEX ON C_KEY TO IDX_NewInv_Key

COMM *** Include all new invoices
EXTRACT RECORD TO "%fld_Tmps%TMP3.FIL"

OPEN AP_INVOICES_ALL
EXTRACT RECORD TO AP_INVOICES_ALL_Old OPEN


DELETE FIELD c_MONTH OK
DEFINE FIELD c_MONTH COMPUTED 

"01" IF SUBSTR(INVOICE_DATE,4,3) = 'JAN'
"02" IF SUBSTR(INVOICE_DATE,4,3) = 'FEB'
"03" IF SUBSTR(INVOICE_DATE,4,3) = 'MAR'
"04" IF SUBSTR(INVOICE_DATE,4,3) = 'APR'
"05" IF SUBSTR(INVOICE_DATE,4,3) = 'MAY'
"06" IF SUBSTR(INVOICE_DATE,4,3) = 'JUN'
"07" IF SUBSTR(INVOICE_DATE,4,3) = 'JUL'
"08" IF SUBSTR(INVOICE_DATE,4,3) = 'AUG'
"09" IF SUBSTR(INVOICE_DATE,4,3) = 'SEP'
"10" IF SUBSTR(INVOICE_DATE,4,3) = 'OCT'
"11" IF SUBSTR(INVOICE_DATE,4,3) = 'NOV'
"12" IF SUBSTR(INVOICE_DATE,4,3) = 'DEC'
"00"


DELETE FIELD c_DAY OK
DEFINE FIELD c_DAY COMPUTED SUBSTR(INVOICE_DATE,1,2)

DELETE FIELD c_YEAR OK
DEFINE FIELD c_YEAR COMPUTED "20"+ SUBSTR(INVOICE_DATE,8,2)

DELETE FIELD c_INVOICE_DATE_CLN OK
DEFINE FIELD c_INVOICE_DATE_CLN COMPUTED c_DAY + '/' + c_MONTH + '/' + c_YEAR

DELETE FIELD c_INVOICE_DATE OK
DEFINE FIELD  c_INVOICE_DATE COMPUTED CTOD(c_INVOICE_DATE_CLN ,'DD/MM/YYYY' )

DELETE FIELD C_KEY OK
DEFINE FIELD C_KEY COMPUTED SUBSTR(ALLTRIM(STRING(VALUE(INVOICE_ID,0),20,"9999999")),1,20)

DEFINE RELATION C_KEY WITH AP_INVOICES_ALL_New INDEX IDX_NewInv_Key

COMM *** Include only old invoices which are not recently added/updated
EXTRACT RECORD TO "%fld_Tmps%TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN


COMM *** Remove key field
DELETE FIELD C_KEY OK
EXTRACT RECORD TO AP_INVOICES_ALL
^BATCH    MP002_Convert_AP                   
[PARENT_FOLDER_ID] 1430796753
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Convert Source Data To Target Working File Tables: Accounts Payable
COMM *** Called by MA002_Convert_Menu
COMM *** run EVA with AP Invoice
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("fld_Workings")="U" OR FTYPE("trg_AP")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Workings%

COMM *** convert AP Invoices***

COMM *** Capture the linkage relationships for the data mapping, convert the source data into target standard table ***
OPEN DM_%trg_AP_Inv%

COMM *** Extract the mapping information from the mapping file (e.g. DM_AP_Invoices)***
DO MZ001_Convert

COMM *** IF relationship between source table and target table has not been build, need to build the relationship first, goto the menu "Link fields/Mapping" ***
IF src_File_Name="" OR v_COUNT=0 OR v_Flds_Extract="" PAUSE "There is no data mapping information - AP Invoices, please link/map the source fields to the standard fields first."

IF src_File_Name="" OR v_COUNT=0 OR v_Flds_Extract="" DO LE001_Link_Menu

COMM *** IF relationship between source table and target table has been build, convert data directely. ***

IF src_File_Name<>"" AND v_Flds_Extract<>""  OPEN %src_File_Name%
IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS %v_Flds_Extract%  TO "%fld_Workings%TMP_Inv.FIL" OPEN

EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "%fld_Workings%%trg_AP_Inv%.FIL"

IF FILESIZE("%fld_Workings%%trg_AP_Inv%.fil")<=0 PAUSE "AP_Invoices Table has not been converted properly. Please check the field mapping and convert it again."

IF FILESIZE("%fld_Workings%%trg_AP_Inv%.fil")<=0 ESCAPE

COMM *** convert AP Payments***
OPEN DM_%trg_AP_Pay%
DO MZ001_Convert
IF src_File_Name<>"" AND v_Flds_Extract<>""  OPEN %src_File_Name%
IF v_Flds_Extract<>"" EXTRACT FIELDS %v_Flds_Extract% FIRST 0 TO "%fld_Workings%%trg_AP_Pay%.FIL"
IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS %v_Flds_Extract% TO "%fld_Workings%%trg_AP_Pay%.FIL" APPEND

COMM *** convert PO Lines ***
OPEN DM_%trg_AP_PO%
DO MZ001_Convert
IF src_File_Name<>"" AND v_Flds_Extract<>""  OPEN %src_File_Name%
IF v_Flds_Extract<>"" EXTRACT FIELDS %v_Flds_Extract% FIRST 0 TO "%fld_Workings%%trg_AP_PO%.FIL"
IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS %v_Flds_Extract%  TO "%fld_Workings%%trg_AP_PO%.FIL" APPEND

COMM *** convert Invoice-PO Relationship table (AP_InvPO) ***
OPEN DM_%trg_AP_InvPO%
DO MZ001_Convert
IF src_File_Name<>"" AND v_Flds_Extract<>""  OPEN %src_File_Name%
IF v_Flds_Extract<>"" EXTRACT FIELDS %v_Flds_Extract% FIRST 0 TO "%fld_Workings%%trg_AP_InvPO%.FIL"
IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS %v_Flds_Extract%  TO "%fld_Workings%%trg_AP_InvPO%.FIL" APPEND

COMM *** prepare Accounts Payable relevant tables for the Tests ***
OPEN %trg_AP_Inv%

DELETE FIELD c_Inv_No2 OK
DEFINE FIELD c_Inv_No2 COMPUTED REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(UPPER(Inv_No),"JAN","01"),"FEB","02"),"MAR","03"),"APR","04"),"MAY","05"),"JUN","06"),"JUL","07"),"AUG","08"),"SEP","09"),"OCT","10"),"NOV","11"),"DEC","12")

DELETE FIELD c_Inv_No OK 
DEFINE FIELD c_Inv_No COMPUTED 
Srt Inv_No 
SUBSTR(ALLTRIM(STRING(VALUE(INCLUDE(c_Inv_No2,"0123456789"),0),16)),1,20) IF LENGTH(ALLTRIM(INCLUDE(c_Inv_No2,"0123456789")))>0
SUBSTR(ALLTRIM(INCLUDE(UPPER(c_Inv_No2),"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789")),1,20)
COMM
DELETE FIELD c_Inv_No OK 
DEFINE FIELD c_Inv_No COMPUTED 
Srt Inv_No 
SUBSTR(ALLTRIM(STRING(VALUE(INCLUDE(Inv_No,"0123456789"),0),16)),1,20) IF LENGTH(ALLTRIM(INCLUDE(Inv_No,"0123456789")))>0
SUBSTR(ALLTRIM(INCLUDE(UPPER(Inv_No),"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789")),1,20)

DELETE FIELD ABS_INVAMT OK
DEFINE FIELD ABS_INVAMT COMPUTED 

VALUE(SPLIT(ALLTRIM(STRING(ABS(Inv_Amt),21)),".",1),0) IF OCCURS(ALLTRIM(STRING(ABS(Inv_Amt),21)),".")>=0
VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21 )),0)

COMMENT ABS Invoice amount to include cents
DELETE FIELD ABS_INVAMT_CENT OK
DEFINE FIELD ABS_INVAMT_CENT COMPUTED 

VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21)),4) IF OCCURS(ALLTRIM(STRING(ABS(Inv_Amt),21)),".")>=0
VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21 )),4)

DELETE FIELD c_Inv_Dt OK 
DEFINE FIELD c_Inv_Dt COMPUTED ALLTRIM(SUBSTR(DATE(Inv_Dt),7,4))+ALLTRIM(SUBSTR(DATE(Inv_Dt),4,2))+ALLTRIM(SUBSTR(DATE(Inv_Dt),1,2))

COMM IDX_VndrSiteID.INX
IF FILESIZE("%fld_Workings%%trg_AP_Inv%.fil") >= 0 AND FILESIZE("IDX_VndrSiteID.INX") = -1 PAUSE "Error: You must run Convert Source Data for Vendor Master File first before running Convert Source Data for Accounts Payable."
IF FILESIZE("%fld_Workings%%trg_AP_Inv%.fil") >= 0 AND FILESIZE("IDX_VndrSiteID.INX") = -1 ESCAPE ALL
IF FILESIZE("%fld_Workings%%trg_AP_Inv%.fil") >= 0 OPEN %trg_AP_Inv%
IF FILESIZE("%fld_Workings%%trg_AP_Inv%.fil") >= 0 DEFINE RELATION Vndr_Site_ID WITH %trg_VMF% INDEX IDX_VndrSiteID

DELETE FIELD Vndr_Mstr_ID OK 
DEFINE FIELD Vndr_Mstr_ID COMPUTED %trg_VMF%.Vndr_Site_ID 

DELETE FIELD Vndr_Nme OK 
DEFINE FIELD Vndr_Nme COMPUTED %trg_VMF%.Vndr_Nme 

DELETE FIELD Vndr_Sts OK 
DEFINE FIELD Vndr_Sts COMPUTED %trg_VMF%.Vndr_Sts 

DELETE FIELD Vndr_Typ OK 
DEFINE FIELD Vndr_Typ COMPUTED %trg_VMF%.Vndr_Typ 

COMM *** Invoices - Credits ***
EXTRACT FIELDS ALL IF Inv_Amt<0.00 TO "%fld_Workings%AP_Invoice_Credits"

IF FILESIZE("%fld_Workings%%trg_VMF%.fil") >= 0 DEFINE RELATION Vndr_Site_ID WITH %trg_VMF% INDEX IDX_VndrSiteID

COMM *** Summary  all statical informtion into one table***
OPEN %trg_AP_Inv%
SORT ON Vndr_Site_ID Vndr_ID c_Inv_Dt D TO "%fld_Workings%TMP1" OPEN

DELETE FIELD InvAmt_Pos OK
DEFINE FIELD InvAmt_Pos COMPUTED

Inv_Amt IF Inv_Amt>0.00
0.00

DELETE FIELD GSTAmt_Pos OK
DEFINE FIELD GSTAmt_Pos COMPUTED

GST_Amt IF Inv_Amt>0.00
0.00

DELETE FIELD Cnt_Pos OK
DEFINE FIELD Cnt_Pos COMPUTED

1 IF Inv_Amt>0.00
0

DELETE FIELD InvAmt_12M OK
DEFINE FIELD InvAmt_12M COMPUTED

Inv_Amt IF Inv_Dt>=CTOD(_LastYearTranCha,"DD/MM/YYYY")
0.00

DELETE FIELD GSTAmt_12M OK
DEFINE FIELD GSTAmt_12M COMPUTED

GST_Amt IF Inv_Dt>=CTOD(_LastYearTranCha,"DD/MM/YYYY")
0.00

DELETE FIELD Cnt_12M OK
DEFINE FIELD Cnt_12M COMPUTED

1 IF Inv_Dt>=CTOD(_LastYearTranCha,"DD/MM/YYYY")
0

DELETE FIELD InvAmt_24M OK
DEFINE FIELD InvAmt_24M COMPUTED

Inv_Amt IF Inv_Dt>=CTOD(_Last2YearTranCha,"DD/MM/YYYY")
0.00

DELETE FIELD GSTAmt_24M OK
DEFINE FIELD GSTAmt_24M COMPUTED

GST_Amt IF Inv_Dt>=CTOD(_Last2YearTranCha,"DD/MM/YYYY")
0.00

DELETE FIELD Cnt_24M OK
DEFINE FIELD Cnt_24M COMPUTED

1 IF Inv_Dt>=CTOD(_Last2YearTranCha,"DD/MM/YYYY")
0

SUMMARIZE ON Vndr_Site_ID Vndr_ID SUBTOTAL Inv_Amt GST_Amt InvAmt_Pos GSTAmt_Pos Cnt_Pos InvAmt_24M GSTAmt_24M Cnt_24M InvAmt_12M GSTAmt_12M Cnt_12M OTHER Inv_Dt c_Inv_Dt TO "%fld_Workings%AP_VndSite_InvGst_Sum.FIL" OPEN 

SORT ON Vndr_ID c_Inv_Dt D TO "%fld_Workings%TMP2" OPEN

SUMMARIZE ON Vndr_ID SUBTOTAL Inv_Amt GST_Amt COUNT AS 'COUNT' InvAmt_Pos GSTAmt_Pos Cnt_Pos InvAmt_24M GSTAmt_24M Cnt_24M InvAmt_12M GSTAmt_12M Cnt_12M OTHER Inv_Dt c_Inv_Dt TO "%fld_Workings%AP_Vnd_InvGst_Sum.FIL" 

COMM *** Summary AP report by Vendor Number ***
OPEN AP_Vnd_InvGst_Sum
INDEX ON Vndr_ID TO IDX_AP_Sum_VndrID

COMM *** Summary AP report by Vendor Site Number ***
OPEN AP_VndSite_InvGst_Sum
INDEX ON Vndr_ID TO IDX_AP_Sum_VndrSiteID

COMM *** Link the summary tables to vendor master file ***
OPEN  %trg_VMF%
DEFINE RELATION Vndr_Site_ID WITH AP_VndSite_InvGst_Sum INDEX IDX_AP_Sum_VndrSiteID
DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum INDEX IDX_AP_Sum_VndrID

DELETE FIELD Max_Inv_Dt OK 
DEFINE FIELD Max_Inv_Dt COMPUTED AP_Vnd_InvGst_Sum.Inv_Dt 

IF FILESIZE("%fld_Workings%%trg_AP_PO%.fil") >= 0 OPEN %trg_AP_PO%
COMMENT Should work with ACL 11 because PO_Date Rec_Dt are attached to PO_NO
IF FILESIZE("%fld_Workings%%trg_AP_PO%.fil") >= 0 SUMMARIZE ON Vndr_Site_ID Vndr_ID PO_NO SUBTOTAL Amount Rec_Amt PO_Qty Rec_Qty OTHER PO_Date Rec_Dt TO "%fld_Workings%AP_PO_Vnd_Sum.FIL" OPEN PRESORT


COMM *** Payments ***
OPEN %trg_AP_Pay%

DELETE FIELD c_Pay_No OK 
DEFINE FIELD c_Pay_No COMPUTED 
Srt Pay_No 
ALLTRIM(STRING(VALUE(INCLUDE(Pay_No,"0123456789"),0),16)) IF LENGTH(ALLTRIM(INCLUDE(Pay_No,"0123456789")))>0
ALLTRIM(INCLUDE(UPPER(Pay_No),"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"))

DELETE FIELD ABS_INVAMT OK
DEFINE FIELD ABS_INVAMT COMPUTED 

VALUE(SPLIT(ALLTRIM(STRING(ABS(Pay_Amt),21)),".",1),0) IF OCCURS(ALLTRIM(STRING(ABS(Pay_Amt),21)),".")>=0
VALUE(ALLTRIM(STRING(ABS(Pay_Amt),21 )),0)

DELETE FIELD c_Pay_Dt OK 
DEFINE FIELD c_Pay_Dt COMPUTED ALLTRIM(SUBSTR(DATE(Pay_Dt),7,4))+ALLTRIM(SUBSTR(DATE(Pay_Dt),4,2))+ALLTRIM(SUBSTR(DATE(Pay_Dt),1,2))

IF FTYPE("%trg_AP_Pay%")="y" AND FILESIZE("%fld_Workings%%trg_AP_Pay%.fil") >= 0 OPEN %trg_AP_Pay%
IF FTYPE("%trg_AP_Pay%")="y" AND FILESIZE("%fld_Workings%%trg_AP_Pay%.fil") >= 0 DEFINE RELATION Vndr_Site_ID WITH %trg_VMF% INDEX IDX_VndrSiteID

DELETE FIELD Vndr_Mstr_ID OK 
DEFINE FIELD Vndr_Mstr_ID COMPUTED %trg_VMF%.Vndr_Site_ID 

DELETE FIELD Vndr_Nme OK 
DEFINE FIELD Vndr_Nme COMPUTED %trg_VMF%.Vndr_Nme 

DELETE FIELD Vndr_Sts OK 
DEFINE FIELD Vndr_Sts COMPUTED %trg_VMF%.Vndr_Sts 

DELETE FIELD Vndr_Typ OK 
DEFINE FIELD Vndr_Typ COMPUTED %trg_VMF%.Vndr_Typ 


COMM *** Create relations between tables ***

IF FTYPE("%trg_AP_Inv%")="y" AND FILESIZE("%fld_Workings%%trg_AP_Inv%.fil") >= 0 OPEN %trg_AP_Inv%
IF FTYPE("%trg_AP_Inv%")="y" AND FILESIZE("%fld_Workings%%trg_AP_Inv%.fil") >= 0 INDEX ON Vchr_ID TO "IDX_AP_INV_Vchr_ID"

IF FTYPE("%trg_AP_Pay%")="y" AND FILESIZE("%fld_Workings%%trg_AP_Pay%.fil") >= 0 OPEN %trg_AP_Pay%
IF FTYPE("%trg_AP_Pay%")="y" AND FILESIZE("%fld_Workings%%trg_AP_Pay%.fil") >= 0 INDEX ON Vchr_ID TO "IDX_AP_Pay_Vchr_ID"

IF FTYPE("%trg_AP_Pay%")="y" AND FILESIZE("%fld_Workings%%trg_AP_Pay%.fil") >= 0 OPEN %trg_AP_Pay%
IF FTYPE("%trg_AP_Pay%")="y" AND FILESIZE("%fld_Workings%%trg_AP_Pay%.fil") >= 0 DEFINE RELATION Vndr_Site_ID WITH %trg_VMF% INDEX IDX_VndrSiteID

IF FTYPE("%trg_AP_PO%")="y" AND FILESIZE("%fld_Workings%%trg_AP_PO%.fil") >= 0 OPEN %trg_AP_PO%
IF FTYPE("%trg_AP_PO%")="y" AND FILESIZE("%fld_Workings%%trg_AP_PO%.fil") >= 0 INDEX ON PO_NO TO "IDX_AP_PO_NO"

IF FTYPE("%trg_AP_PO%")="y" AND FILESIZE("%fld_Workings%%trg_AP_PO%.fil") >= 0 OPEN %trg_AP_PO%
IF FTYPE("%trg_AP_PO%")="y" AND FILESIZE("%fld_Workings%%trg_AP_PO%.fil") >= 0 DEFINE RELATION Vndr_Site_ID WITH %trg_VMF% INDEX IDX_VndrSiteID


COMM *** get the AP data range ***
v_Comment="COMMENT"
DELETE LOW1 OK
DELETE HIGH1 OK
IF FTYPE("%trg_AP_Inv%")="y" AND FILESIZE("%fld_Workings%%trg_AP_Inv%.fil") >= 0 v_Comment=""
%v_Comment% OPEN %trg_AP_Inv%
%v_Comment% STATISTICS ON Pst_Dt TO SCREEN NUMBER 1
%v_Comment% _Data_Range_Start_Date=CTOD(DATETIME(LOW1,"DD/MM/YYYY"),"DD/MM/YYYY") 
%v_Comment% _Data_Range_End_Date=CTOD(DATETIME(HIGH1,"DD/MM/YYYY"),"DD/MM/YYYY")
%v_Comment% IF ISBLANK(DATETIME(_Data_Range_Start_Date)) STATISTICS ON Inv_Dt TO SCREEN NUMBER 1
%v_Comment% IF ISBLANK(DATETIME(_Data_Range_Start_Date)) _Data_Range_Start_Date=CTOD(DATETIME(LOW1,"DD/MM/YYYY"),"DD/MM/YYYY")
%v_Comment% IF ISBLANK(DATETIME(_Data_Range_End_Date)) _Data_Range_End_Date=CTOD(DATETIME(HIGH1,"DD/MM/YYYY"),"DD/MM/YYYY")

DELETE FORMAT TMP1 OK
DELETE "%fld_Workings%TMP1.FIL" OK
DELETE FORMAT TMP_Inv OK
DELETE "%fld_Workings%TMP_Inv.FIL" OK


SET SAFETY ON

^BATCH    AP000_Dup_Amt_Inv                  
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP001. Identify possible Duplicate Invoice: by Invoice number, amount
COMM *** For the Tests AP001 (All Same), AP002 (Diff Date) and AP003 (Diff vendor number)
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_AP_Inv")="U" OR FTYPE("trg_VMF")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

COMM *** Delete All the TMP files for Dups processing ***
OPEN AP_Invoices

SET FILTER ABS_INVAMT<>0.00
DUPLICATES ON c_Inv_No ABS_INVAMT OTHER %v_flds_AP_Inv% PRESORT OPEN TO "%fld_Tmps%AP_Dups_Amt_Inv.FIL"
COMMENT change needed to AP003 and AP004 to include duplicates on absolute value of Invoice Amount including cents
DELETE FIELD ABS_INVAMT_CENT OK
DEFINE FIELD ABS_INVAMT_CENT COMPUTED 

VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21)),4) IF OCCURS(ALLTRIM(STRING(ABS(Inv_Amt),21)),".")>=0
VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21 )),4)


DEFINE RELATION Vndr_Site_ID WITH %trg_VMF% INDEX IDX_VndrSiteID


SET SAFETY ON
^BATCH    AP003_Dup_Amt_Dt_Inv               
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP003. Identify possible Duplicate Invoice: by Invoice number, amount, and date (different vendor number)
COMM *** Run the Dups based on the invoices excluding Charity vendors listed on the Grey List
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_AP_Inv")="U" OR FTYPE("trg_VMF")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

COMM *** Delete All the TMP files for Dups processing ***
DO AZ002_Dup_DelTmp

v_TestNo="AP003"

OPEN AP_Dups_Amt_Inv
COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_Site_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

DUPLICATES ON c_Inv_No ABS_INVAMT_CENT  Inv_Dt OTHER %v_flds_AP_Inv% PRESORT OPEN TO "%fld_Tmps%AP_TMP.FIL"

DELETE FIELD DUP_KEY OK
DEFINE FIELD DUP_KEY COMPUTED SUBSTR(ALLTRIM(c_Inv_No) +"~"+ALLTRIM(STRING(ABS_INVAMT_CENT ,21))+"~"+ALLTRIM(c_Inv_Dt),1,72)

COMM *** identify DIFF Vendor ***
OPEN AP_TMP
DUPLICATES ON c_Inv_No ABS_INVAMT_CENT  Vndr_ID Inv_Dt OTHER %v_flds_AP_Inv% IF ABS_INVAMT_CENT <>0.00 PRESORT TO "%fld_Tmps%AP_TMP3.FIL" OPEN
INDEX ON Vchr_ID TO AP_TMP3_ID


OPEN AP_TMP
DEFINE RELATION Vchr_ID WITH AP_TMP3 INDEX AP_TMP3_ID
SUMMARIZE ON DUP_KEY IF Vchr_ID<> AP_TMP3.Vchr_ID TO "%fld_Tmps%AP_TMP2.FIL" OPEN PRESORT


INDEX ON DUP_KEY TO AP_TMP2_DUP_KEY

OPEN AP_TMP
DEFINE RELATION DUP_KEY WITH AP_TMP2 AP_TMP2_DUP_KEY

EXTRACT FIELDS %v_flds_AP_Inv% DUP_KEY IF DUP_KEY= AP_TMP2.DUP_KEY TO "%fld_Tmps%TMP_AP_DUPS" OPEN
DELETE FIELD ABS_INVAMT_CENT OK
DEFINE FIELD ABS_INVAMT_CENT COMPUTED 

VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21)),4) IF OCCURS(ALLTRIM(STRING(ABS(Inv_Amt),21)),".")>=0
VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21 )),4)


COMM *** Start removing reversals ***
DO AZ003_Dup_FixedUp
COMM *** End removing reversals ***

COMM *** Start DeDup: compare to AP001 ***
DO AZ001_Dup_DeDup
COMM *** End DeDup ***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vchr_ID)+"~"+ALLTRIM(DUP_KEY),1,85)
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
v_DUP_KEY="DUP_KEY"
v_Filter="AND FLAG='O'"
IF v_Exc_History =T DO AE001_Dup_History
IF v_Chk_CCM=T DO AE006_Dup_CCM
COMM *** End ***

COMM *** keep the RANK information***
IF v_Exc_History =F EXTRACT FIELDS ALL TO "%fld_Tmps%TMP11" OPEN

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP003. Duplicated Invoices by InvNo,Amt and Date (Diff VndNbr)"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

COMM create a quoted invoice id field - to prevent issue with stripping of leading zeros in excel spreadsheet
DELETE FIELD c_QUOTED_INV_ID
DEFINE FIELD c_QUOTED_INV_ID COMPUTED "'"+ ALLTRIM(Inv_No) + "'"

comm *** finalize the result  ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%AP003_Dup_Amt_Dt_Inv"  OPEN

DEFINE RELATION Vndr_Site_ID WITH %trg_VMF% INDEX IDX_VndrSiteID

SET FOLDER /%fld_Tmps%

v_Exp_Fields_AP003 = "Flag VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description' Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc" 

OPEN AP003_Dup_Amt_Dt_Inv
COMM Exclude Vendor Type FOXBOUNTY 27/7/2015
EXTRACT %v_Exp_Fields_AP003% TO  TMP_AP003 IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT" 

SET FOLDER /%fld_Results%

COMM *** Delete All the TMP files for Dups processing ***
DO AZ002_Dup_DelTmp

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp


SET SAFETY ON
^BATCH    AP004_Dup_Amt_Dt_Vndr              
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP004. Identify possible Duplicate Invoice: by Vendor Number, amount, and date (different Invoice number)
COMM *** Run the Dups based on the invoices excluding Charity vendors listed on the Grey List
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_AP_Inv")="U" OR FTYPE("trg_VMF")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

COMM *** Delete All the TMP files for Dups processing ***
DO AZ002_Dup_DelTmp

v_TestNo="AP004"

OPEN AP_Invoices
COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_Site_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***
COMMENT - 10/06/2015 Custom Duplicate test be done on ABS(invoice_amount) to cent and not rounded to dollar
COM
DUPLICATES ON ABS_INVAMT Inv_Dt Vndr_ID OTHER %v_flds_AP_Inv% IF ABS_INVAMT<>0.00 PRESORT OPEN TO "%fld_Tmps%AP_TMP.FIL"
DELETE FIELD DUP_KEY OK
DEFINE FIELD DUP_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+"~"+ALLTRIM(STRING(ABS_INVAMT,21))+"~"+ALLTRIM(c_Inv_Dt),1,72)

COMM *** identify DIFF Invoice Number ***
COMM
DUPLICATES ON c_Inv_No ABS_INVAMT Vndr_ID Inv_Dt OTHER %v_flds_AP_Inv% PRESORT TO "%fld_Tmps%AP_TMP3.FIL" OPEN
INDEX ON Vchr_ID TO AP_TMP3_ID
END


DUPLICATES ON ABS_INVAMT_CENT Inv_Dt Vndr_ID OTHER %v_flds_AP_Inv% IF ABS_INVAMT_CENT <>0.00 PRESORT OPEN TO "%fld_Tmps%AP_TMP.FIL"
DELETE FIELD DUP_KEY OK
DEFINE FIELD DUP_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+"~"+ALLTRIM(STRING(ABS_INVAMT_CENT,21))+"~"+ALLTRIM(c_Inv_Dt),1,72)

DUPLICATES ON c_Inv_No ABS_INVAMT_CENT Vndr_ID Inv_Dt OTHER %v_flds_AP_Inv% PRESORT TO "%fld_Tmps%AP_TMP3.FIL" OPEN
INDEX ON Vchr_ID TO AP_TMP3_ID

OPEN AP_TMP
DEFINE RELATION Vchr_ID WITH AP_TMP3 INDEX AP_TMP3_ID
SUMMARIZE ON DUP_KEY IF Vchr_ID<> AP_TMP3.Vchr_ID TO "%fld_Tmps%AP_TMP2.FIL" OPEN PRESORT


INDEX ON DUP_KEY TO AP_TMP2_DUP_KEY

OPEN AP_TMP
DEFINE RELATION DUP_KEY WITH AP_TMP2 AP_TMP2_DUP_KEY

EXTRACT FIELDS DUP_KEY %v_flds_AP_Inv% IF DUP_KEY= AP_TMP2.DUP_KEY TO "%fld_Tmps%TMP_AP_DUPS" OPEN 

COMMENT ABS Invoice amount to include cents
DELETE FIELD ABS_INVAMT_CENT OK
DEFINE FIELD ABS_INVAMT_CENT COMPUTED 

VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21)),4) IF OCCURS(ALLTRIM(STRING(ABS(Inv_Amt),21)),".")>=0
VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21 )),4)

COMM *** Start removing reversals ***
DO AZ003_Dup_FixedUp
COMM *** End removing reversals ***

COMM *** Start DeDup: compare to AP001 ***
DO AZ001_Dup_DeDup
COMM *** End DeDup ***

COMM *** deDups, compare to AP001, AP002 and AP003 ***
COMMENT
OPEN AP001_Dup_Amt_Dt_Inv_Vndr
EXTRACT FIELDS Vchr_ID TO "%fld_Tmps%TMP_AP_Dups"
OPEN AP002_Dup_Amt_Inv_Vndr
EXTRACT FIELDS Vchr_ID TO "%fld_Tmps%TMP_AP_Dups" APPEND
OPEN AP003_Dup_Amt_Dt_Inv
EXTRACT FIELDS Vchr_ID TO "%fld_Tmps%TMP_AP_Dups" APPEND
OPEN AP_Dups_Rev
EXTRACT FIELDS Vchr_ID TO "%fld_Tmps%TMP_AP_Dups" APPEND
OPEN TMP_AP_Dups
INDEX ON Vchr_ID TO IDX_TMP_AP_Dups_ID
END

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vchr_ID)+"~"+ALLTRIM(DUP_KEY),1,85)
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
v_DUP_KEY="DUP_KEY"
v_Filter="AND FLAG='O'"
IF v_Exc_History =T DO AE001_Dup_History
IF v_Chk_CCM=T DO AE006_Dup_CCM
COMM *** End ***

COMM *** keep the RANK information***
IF v_Exc_History =F EXTRACT FIELDS ALL TO "%fld_Tmps%TMP11" OPEN

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP004. Duplicated Invoices by Vendor,Amt and Date (Diff Invoice Number)"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

COMMENT ABS Invoice amount to include cents
DELETE FIELD ABS_INVAMT_CENT OK
DEFINE FIELD ABS_INVAMT_CENT COMPUTED 

VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21)),4) IF OCCURS(ALLTRIM(STRING(ABS(Inv_Amt),21)),".")>=0
VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21 )),4)


DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ZONED(ABS_INVAMT_CENT,21) +"~"+ ALLTRIM(Flag) +"~"+ ALLTRIM(Vndr_ID) +"~"+ ALLTRIM(c_Inv_Dt),1,64)

SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%AP004_Dup_Amt_Dt_Vndr"  OPEN

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

COMM create a quoted invoice id field - to prevent issue with stripping of leading zeros in excel spreadsheet
DELETE FIELD c_QUOTED_INV_ID
DEFINE FIELD c_QUOTED_INV_ID COMPUTED "'"+ ALLTRIM(Inv_No) + "'"

DEFINE RELATION Vndr_Site_ID WITH %trg_VMF% INDEX IDX_VndrSiteID

SET FOLDER /%fld_Tmps%
v_Exp_Fields_AP004 = "Flag VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description'  Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc" 

OPEN AP004_Dup_Amt_Dt_Vndr
COMM EXCLUDE VENDOR TYPE FOXBOUNTY 27/7/2015
EXTRACT %v_Exp_Fields_AP004% TO  TMP_AP004 IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT" 

SET FOLDER /%fld_Results%

COMM *** Delete All the TMP files for Dups processing ***
DO AZ002_Dup_DelTmp

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    AP006_Pay_Not_In_VMF               
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP006. Identify payments made to vendors not in vendor master file
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_AP_Inv")="U" OR FTYPE("trg_VMF")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="AP006"

OPEN AP_Invoices
EXTRACT FIELDS ALL IF ISBLANK(Vndr_Mstr_ID) TO "%fld_Tmps%AP_TMP" OPEN

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_Site_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vchr_ID),1,85)

v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ALLTRIM(Vndr_ID) +"~"+ALLTRIM(c_Inv_Dt)+"~"+ALLTRIM(ZONED(ABS_INVAMT,12))

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Vndr_ID c_Inv_Dt ABS_INVAMT D"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "H"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP006.Identify payments made to vendors not in vendor master file"

COMM EXCLUDE VENDOR TYPE FOXBOUNTY 27/7/2015
EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN

COMM create a quoted invoice id field - to prevent issue with stripping of leading zeros in excel spreadsheet
DELETE FIELD c_QUOTED_INV_ID
DEFINE FIELD c_QUOTED_INV_ID COMPUTED "'"+ ALLTRIM(Inv_No) + "'"

SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%AP006_Pay_Not_In_VMF" 

DELETE FORMAT AP_TMP OK
DELETE "%fld_Tmps%AP_TMP.FIL" OK

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    AP014_No_Trans_xx_Mon              
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP014. Identify active vendors without transactions in the past x months
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_VMF")="U" OR FTYPE("trg_AP_Inv")="U" OR  FTYPE("trg_VMF")="U" DO AA002_Variable_Setting
IF FTYPE("TXT_AP014_Months")="U" DO AC002_Test_Var_Input
IF FTYPE("AP_Invoices")<>"y" OR FILESIZE("%fld_Workings%AP_Invoices.FIL")<=0 OR FILESIZE("%fld_Workings%VMF_Vnd_Master_FIle.FIL")<=0 Errmsg=Errmsg+" AP014"
IF FTYPE("AP_Invoices")<>"y" OR FILESIZE("%fld_Workings%AP_Invoices.FIL")<=0 OR FILESIZE("%fld_Workings%VMF_Vnd_Master_FIle.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="AP014"

OPEN AP_Invoices
COMMENT Get transactions in the last x months.
SUMMARIZE ON Vndr_Site_ID Vndr_ID SUBTOTAL Inv_Amt GST_Amt IF VMF_Vnd_Master_File.Vndr_Sts="A" AND Inv_Amt<>0 AND Inv_Dt>=CTOD(DATE(_RptRunDate- VALUE(TXT_AP014_Months,0)*30),"DD/MM/YYYY") TO "%fld_Tmps%TMP1.FIL" PRESORT OPEN 
INDEX ON Vndr_Site_ID TO IDX_TMP1_VndrSiteID

OPEN VMF_Vnd_Master_FIle
DEFINE RELATION Vndr_Site_ID WITH TMP1 INDEX IDX_TMP1_VndrSiteID  
COMMENT Get vendors with 0 transactions in the last x months.
EXTRACT FIELDS %v_flds_VMF% IF Dt_Field2<=CTOD(DATE(_RptRunDate-540),"DD/MM/YYYY") AND (TMP1.COUNT=0 OR TMP1.Inv_Amt=0.00) AND  VMF_Vnd_Master_File.Vndr_Sts="A" TO "%fld_Tmps%TMP2" OPEN

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_Site_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_Site_ID),1,85)
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID),1,20)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Vndr_ID"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "L"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
CTOD(DATE(_RptRunDate- VALUE(TXT_AP014_Months,0)*30),"DD/MM/YYYY") 

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP014. Identify active vendors without transactions in the past %TXT_AP014_Months% months"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" IF Vndr_Typ<> "EMPLOYEE" AND UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT" 

OPEN "%fld_Tmps%TMP10" 


SET FOLDER /%fld_Results%
SORT ON SORT_KEY TO %fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon

OPEN VMF_Vnd_Master_FIle
DELETE RELATION TMP1 OK

OPEN VMF_Vnd_Master_FIle
INDEX ON Vndr_Site_ID TO IDX_VMF1_VndrSiteID

OPEN AP014_No_Trans_%TXT_AP014_Months%_Mon 
DEFINE RELATION Vndr_Site_ID WITH VMF_Vnd_Master_File INDEX IDX_VMF1_VndrSiteID

SET FOLDER /%fld_Tmps%

SET FOLDER /%fld_Results%

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    VM004_Dup_Vnd_Tel                  
[PARENT_FOLDER_ID] 1340167398
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Vendor Master File Exception Tests
COMM *** VM004. Identify Duplicate Vendors by Telephone No/Mobile Number (Cleaned)
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_VMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_VMF")="U" DO AA002_Variable_Setting
IF FTYPE("%trg_VMF%")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF%.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%
v_TestNo="VM004"

OPEN VMF_Vnd_Master_File

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

EXTRACT FIELDS Vndr_Site_ID Vndr_ID ALLTRIM(STRING(VALUE(INCLUDE(Tel1, "0123456789"),0),21)) AS "Tel" IF Vndr_Sts="A" AND LENGTH(ALLTRIM(STRING(VALUE(INCLUDE(Tel1, "0123456789"),0),21)))>3 TO "%fld_Tmps%TMP1" 
EXTRACT FIELDS Vndr_Site_ID Vndr_ID ALLTRIM(STRING(VALUE(INCLUDE(Tel2, "0123456789"),0),21)) AS "Tel" IF Vndr_Sts="A" AND LENGTH(ALLTRIM(STRING(VALUE(INCLUDE(Tel2, "0123456789"),0),21)))>3 TO "%fld_Tmps%TMP1" APPEND
EXTRACT FIELDS Vndr_Site_ID Vndr_ID ALLTRIM(STRING(VALUE(INCLUDE(Tel3, "0123456789"),0),21)) AS "Tel" IF Vndr_Sts="A" AND LENGTH(ALLTRIM(STRING(VALUE(INCLUDE(Tel3, "0123456789"),0),21)))>3 TO "%fld_Tmps%TMP1" APPEND
EXTRACT FIELDS Vndr_Site_ID Vndr_ID ALLTRIM(STRING(VALUE(INCLUDE(Fax , "0123456789"),0),21)) AS "Tel" IF Vndr_Sts="A" AND LENGTH(ALLTRIM(STRING(VALUE(INCLUDE(Fax , "0123456789"),0),21)))>3 TO "%fld_Tmps%TMP1" APPEND

OPEN TMP1
DELETE FIELD c_Tel OK
DEFINE FIELD c_Tel COMPUTED 

ALLTRIM(STRING(VALUE(SUBSTR(Tel, 3, 19),0),21)) IF SUBSTR( Tel, 1, 2) = "61"  AND LENGTH(ALLTRIM(Tel))>7
Tel

COMMENT Fine for ACL 11
SUMMARIZE ON Vndr_ID c_Tel OTHER Vndr_Site_ID TO "%fld_Tmps%TMP_TEL.FIL" OPEN PRESORT

DUPLICATES ON c_Tel OTHER Vndr_Site_ID Vndr_ID PRESORT OPEN TO "%fld_Tmps%TMP1.FIL"

DELETE FIELD DUP_KEY OK
DEFINE FIELD DUP_KEY COMPUTED ALLTRIM(c_Tel)

COMM *** Begin Clean Dup exists in dup VM001, 2,3,4,5 ***
EXTRACT FIELDS Vndr_ID FIRST 0 TO "%fld_Tmps%TMP_Dups"

IF FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil")>=0 AND (FILESIZE("%fld_History%VM001_History.fil") >0 AND FTYPE("VM001_History")="y") OPEN VM001_History
IF FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil")>=0 AND (FILESIZE("%fld_History%VM001_History.fil") <=0 OR FTYPE("VM001_History")<>"y") OPEN VM001_Dup_Vnd_BankAcc
IF FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil")>=0 AND (FTYPE("VM001_History")="y" OR FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil")>=0) EXTRACT Vndr_ID TO "%fld_Tmps%TMP_Dups" APPEND

IF FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil")>=0 AND (FILESIZE("%fld_History%VM002_History.fil") >0 AND FTYPE("VM002_History")="y") OPEN VM002_History
IF FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil")>=0 AND (FILESIZE("%fld_History%VM002_History.fil") <=0 OR FTYPE("VM002_History")<>"y") OPEN VM002_Dup_Vnd_ABN
IF FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil")>=0 AND (FTYPE("VM002_History")="y" OR FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil")>=0) EXTRACT Vndr_ID TO "%fld_Tmps%TMP_Dups" APPEND

IF FILESIZE("%fld_Results%VM003_Dup_Vnd_Add.fil")>=0 AND (FILESIZE("%fld_History%VM003_History.fil") >0 AND FTYPE("VM003_History")="y") OPEN VM003_History
IF FILESIZE("%fld_Results%VM003_Dup_Vnd_Add.fil")>=0 AND (FILESIZE("%fld_History%VM003_History.fil") <=0 OR FTYPE("VM003_History")<>"y") OPEN VM003_Dup_Vnd_Add
IF FILESIZE("%fld_Results%VM003_Dup_Vnd_Add.fil")>=0 AND (FTYPE("VM003_History")="y" OR FILESIZE("%fld_Results%VM003_Dup_Vnd_Add.fil")>=0) EXTRACT Vndr_ID TO "%fld_Tmps%TMP_Dups" APPEND

OPEN TMP_Dups
INDEX ON Vndr_ID TO IDX_VND_DUP_A

OPEN TMP1
DEFINE RELATION Vndr_ID WITH TMP_Dups INDEX IDX_VND_DUP_A

SUMMARIZE ON DUP_KEY IF Vndr_ID  <> TMP_Dups.Vndr_ID  TO "%fld_Tmps%TMP2.FIL" OPEN PRESORT

INDEX ON DUP_KEY TO IDX_TMP2_Dup_KEY

OPEN TMP1
DEFINE RELATION DUP_KEY WITH TMP2 INDEX IDX_TMP2_Dup_KEY

comm EXTRACT FIELDS ALL IF NOT ISBLANK(TMP2.DUP_KEY) TO "%fld_Tmps%TMP3" OPEN
COMMENT Fixed for ACL 11: Need to summarize first or table relation won't get the correct DUP_KEY
EXTRACT FIELDS ALL IF DUP_KEY=TMP2.DUP_KEY TO "%fld_Tmps%TMP2A" OPEN
DELETE FIELD Vnd_DUP_Key OK
DEFINE FIELD Vnd_DUP_Key COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+"~"+ALLTRIM(DUP_KEY),1,50)

SORT ON Vnd_DUP_Key  TO TMP_SORT1 OPEN
SUMMARIZE ON Vnd_DUP_Key OTHER Vndr_ID c_Tel Vndr_Site_ID DUP_KEY TO "%fld_Tmps%TMP3" OPEN 

COMM *** End clean***

COMM *** Emilinate the duplicate dups ***

INDEX ON Vnd_DUP_Key TO IDX_TMP3_VndrSiteID

COMMENT Fixed for ACL 11
OPEN TMP2A

COMMENT Fine for ACL 11
SUMMARIZE ON Vnd_DUP_Key OTHER DUP_KEY Vndr_ID Vndr_Site_ID TO "%fld_Tmps%TMP34.FIL" OPEN PRESORT
DEFINE RELATION Vnd_DUP_Key WITH TMP3 INDEX IDX_TMP3_VndrSiteID
DEFINE RELATION Vndr_Site_ID WITH VMF_Vnd_Master_File INDEX IDX_VndrSiteID

EXTRACT FIELDS %v_flds_VMF% TMP3.DUP_KEY TMP3.c_Tel IF Vndr_ID=TMP3.Vndr_ID AND Vndr_Site_ID=VMF_Vnd_Master_File.Vndr_Site_ID TO "%fld_Tmps%TMP4" OPEN

COMM *** Start - eliminate the duplicate dups by Alvin  ***
v_Dupl_Table="TMP4"
DO VZ001_DeDup
COMM *** End - eliminate the duplicate dups by Alvin ***

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+"~"+ALLTRIM(DUP_KEY),1,85)

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
v_DUP_KEY="DUP_KEY"
v_Filter=""
IF v_Exc_History =T DO AE001_Dup_History
IF v_Chk_CCM=T DO AE006_Dup_CCM
COMM *** End ***

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP1" OPEN

COMM *** Identify the same or difference of the clean Vendor Number on the same dup ***
DUPLICATES ON DUP_KEY c_Vndr_ID OTHER Vndr_Site_ID Vndr_ID PRESORT OPEN TO "%fld_Tmps%TMP5.FIL"

INDEX ON DUP_KEY TO IDX_TMP5_DUP_KEY

OPEN TMP1
DEFINE RELATION DUP_KEY WITH TMP5 INDEX IDX_TMP5_DUP_KEY

DELETE FIELD Vndr_Same_Diff OK
DEFINE FIELD Vndr_Same_Diff COMPUTED 

"Y" IF DUP_KEY=TMP5.DUP_KEY
"N"

COMM *** Put the dup with difference clean Vendor Number on the Top of the report ***
DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_Same_Diff)+"~"+ALLTRIM(DUP_KEY)+"~"+ALLTRIM(Vndr_Site_ID) ,1,40)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Vndr_ID_Same_Diff Tel_CLN Vndr_Site_ID"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "VM004. Identify Duplicate Vendors by Telephone No/Mobile Number/Fax"

SORT ON SORT_KEY TO "%fld_Tmps%TMP6" OPEN

COMM *** Finalize the results ***
SET FOLDER /%fld_Results%
COMM EXCLUDE VENDOR TYPE FOXBOUNTY 27/7/2015
EXTRACT FIELDS ALL TO "%fld_Results%VM004_Dup_Vnd_Tel" IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN 
DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum IDX_AP_Sum_VndrID

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    VM007_Invld_Frmt_ABN               
[PARENT_FOLDER_ID] 1340167398
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Vendor Master File Exception Tests
COMM *** VM007. Identify vendors with incorrect ABN format
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_VMF")="U" OR FTYPE("trg_AP_Inv")="U" OR  FTYPE("trg_VMF")="U" DO AA002_Variable_Setting
IF FTYPE("%trg_VMF%")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF%.FIL")<0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="VM007"

OPEN VMF_Vnd_Master_FIle
EXTRACT FIELDS %v_flds_VMF% AP_Vnd_InvGst_Sum.Inv_Amt AP_Vnd_InvGst_Sum.GST_Amt AP_Vnd_InvGst_Sum.COUNT IF Vndr_Sts="A" AND InvABN="T" TO "%fld_Tmps%\TMP_Vnd" OPEN

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_Site_ID)+"~"+ALLTRIM(ABN_CLN),1,85)

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ALLTRIM(ZONED(Inv_Amt,15))+ALLTRIM(Vndr_ID)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Total_InvAmt Vndr_ID"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "H"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate  

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "VM007. Identify Vendor with Incorrect ABN Format"


SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%VM007_Invld_Frmt_ABN" OPEN

DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum IDX_AP_Sum_VndrID

INDEX ON Vndr_Site_ID TO IDX_VM007_VndrSiteID

COMM *** VM007D/AP016 Invoice Details ***
SET FOLDER /%fld_Tmps%
OPEN AP_Invoices
DEFINE RELATION Vndr_Site_ID WITH VM007_Invld_Frmt_ABN INDEX IDX_VM007_VndrSiteID

EXTRACT FIELDS ALL IF NOT ISBLANK(VM007_Invld_Frmt_ABN.Vndr_ID) TO "TMP_1" OPEN

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+"~"+ALLTRIM(c_Inv_Dt),1,30)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Vndr_ID Inv_Date"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "H"

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "VM007D. Identify transactions against vendors with Incorrect ABN Format"
COMM EXCLUDE VENDOR TYPE FOXBOUNTY 27/7/2015
EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN
comm *** finalize the result  ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%VM007D_Invld_Frmt_ABN" OPEN

DEFINE RELATION Vndr_Site_ID WITH VMF_Vnd_Master_File INDEX IDX_VndrSiteID

OPEN AP_Invoices
DELETE RELATION VM007_Invld_Frmt_ABN OK

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    VM009_Invld_ABN_ABR                
[PARENT_FOLDER_ID] 1340167398
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Vendor Master File Exception Tests
COMM *** VM009. Identify Valid ABN but not on ABR site (not found)
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_VMF")="U" OR FTYPE("trg_AP_Inv")="U" OR  FTYPE("trg_VMF")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%
v_TestNo="VM009"

DELETE FORMAT ABN_ASIC OK
 
COMM *** Importing data For ABN tests ***
DO VMZ02_Import_ABR

IF FTYPE("ABN_ASIC")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF%.FIL")<=0 Errmsg=Errmsg+" VM009"
IF FTYPE("ABN_ASIC")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF%.FIL")<=0 ESCAPE


COMM *** IF ABR website connection failed, then escape, don't process this test ***
OPEN ABN_ASIC
SET FILTER TO ASIC_entityStatusCode="Connection erro"
COUNT
IF COUNT1>0 Errmsg=Errmsg+" VM008"
IF COUNT1>0 ESCAPE
SET FILTER 

COMM ***Start run test ***

OPEN VMF_Vnd_Master_File
DEFINE RELATION ABN_CLN WITH ABN_ASIC INDEX INXABN

EXTRACT FIELDS %v_flds_VMF% ABN_ASIC.ASIC_entityStatusCode CTOD(ABN_ASIC.ASIC_entityStatusEF,"YYYY-MM-DD") AS "ASIC_entityStatusEF" CTOD(ABN_ASIC.ASIC_GST_effFrom,"YYYY-MM-DD") AS "ASIC_GST_effFrom" CTOD(ABN_ASIC.ASIC_GST_effTo,"YYYY-MM-DD") AS "ASIC_GST_effTo" ABN_ASIC.ASIC_entityDescription AP_Vnd_InvGst_Sum.Inv_Amt AP_Vnd_InvGst_Sum.GST_Amt AP_Vnd_InvGst_Sum.COUNT IF LENGTH(ALLTRIM(ABN_CLN))>1 AND Vndr_Sts="A" AND InvABN="F" AND (MATCH(ABN_ASIC.ASIC_entityStatusCode,"Not Found")) TO "%fld_Tmps%TMP1" OPEN

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+"~"+ALLTRIM(ABN_CLN),1,85)

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP_Vnd" OPEN
INDEX ON Vndr_Site_ID TO IDX_TMP_VndrSiteID

COMM *** VM009D/AP016. Identify invoices with Inv_Dt >Cancelled Effective Date ***

OPEN AP_Invoices
DEFINE RELATION Vndr_Site_ID WITH TMP_Vnd INDEX IDX_TMP_VndrSiteID
SORT ON Vndr_ID c_Inv_Dt D IF Vndr_ID=TMP_Vnd.Vndr_ID TO "%fld_Tmps%TMP_VM009" OPEN

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ALLTRIM(Vndr_ID)+"~"+ALLTRIM(c_Inv_Dt)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Vndr_ID c_Inv_Date D"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "H"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "VM009D. Identify Transactions against Vendors with Invalid ABN against ABR"

SET FOLDER /%fld_Results%
SUMMARIZE ON Vndr_Site_ID Vndr_ID SUBTOTAL GST_Amt Inv_Amt TO "%fld_Results%VM009Z_Invld_ABN_ABR_Sum.FIL" OPEN PRESORT
INDEX ON Vndr_Site_ID TO IDX_VM009Z_VndrSiteID

OPEN TMP_Vnd
DEFINE RELATION Vndr_Site_ID WITH VM009Z_Invld_ABN_ABR_Sum INDEX IDX_VM009Z_VndrSiteID

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ZONED(VM009Z_Invld_ABN_ABR_Sum.Inv_Amt,15)+ALLTRIM(Vndr_ID),1,25)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Total_InvAmt Vndr_ID"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate  

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "H"

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "VM009. Identify Valid ABN but not on ABR site (not found)"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN

comm *** finalize the result  ***
SORT ON SORT_KEY TO "%fld_Results%VM009_Invld_ABN_ABR" OPEN
INDEX ON Vndr_Site_ID TO IDX_VM009_VndrSiteID
DEFINE RELATION Vndr_Site_ID WITH VM009Z_Invld_ABN_ABR_Sum INDEX IDX_VM009Z_VndrSiteID
DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum IDX_AP_Sum_VndrID

OPEN TMP_VM009
DEFINE RELATION Vndr_Site_ID WITH VM009_Invld_ABN_ABR INDEX IDX_VM009_VndrSiteID

EXTRACT FIELDS ALL TMP_Vnd.ASIC_entityStatusEF IF NOT ISBLANK(VM009_Invld_ABN_ABR.Vndr_ID) TO "%fld_Results%VM009D_Invld_ABN_ABR" OPEN
DEFINE RELATION Vndr_Site_ID WITH VM009_Invld_ABN_ABR INDEX IDX_VM009_VndrSiteID

OPEN AP_Invoices
DELETE RELATION TMP_Vnd OK
OPEN TMP_Vnd
DELETE RELATION VM009Z_Invld_ABN_ABR_Sum OK
OPEN TMP_VM009
DELETE RELATION VM009_Invld_ABN_ABR OK

DELETE FORMAT TMP_VM009 OK
DELETE "%fld_Tmps%TMP_VM009.FIL" OK
DELETE FORMAT TMP_Vnd OK
DELETE "%fld_Tmps%TMP_Vnd.FIL" OK

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    VM010_DeReg_GST                    
[PARENT_FOLDER_ID] 1340167398
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Vendor Master File Exception Tests
COMM *** VM010. Identify ABN deregistered for GST against ABR site 
COMM *** VM010D. Identify invoices with Inv_Dt >=GST expired Date
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_VMF")="U" OR FTYPE("trg_AP_Inv")="U" OR  FTYPE("trg_VMF")="U" DO AA002_Variable_Setting


SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="VM010"

DELETE FORMAT ABN_ASIC OK
 
COMM *** Importing data For ABN tests ***
DO VMZ02_Import_ABR

IF FTYPE("ABN_ASIC")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF%.FIL")<=0 Errmsg=Errmsg+" VM010"
IF FTYPE("ABN_ASIC")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF%.FIL")<=0 ESCAPE


COMM *** IF ABR website connection failed, then escape, don't process this test ***
OPEN ABN_ASIC
SET FILTER TO ASIC_entityStatusCode="Connection erro"
COUNT
IF COUNT1>0 Errmsg=Errmsg+" VM008"
IF COUNT1>0 ESCAPE
SET FILTER 

COMM ***Start run test ***

OPEN VMF_Vnd_Master_File
DEFINE RELATION ABN_CLN WITH ABN_ASIC INDEX INXABN

EXTRACT FIELDS ALL ABN_ASIC.ASIC_entityStatusCode CTOD(ABN_ASIC.ASIC_entityStatusEF,"YYYY-MM-DD") AS "ASIC_entityStatusEF" CTOD(ABN_ASIC.ASIC_GST_effFrom,"YYYY-MM-DD") AS "ASIC_GST_effFrom" CTOD(ABN_ASIC.ASIC_GST_effTo,"YYYY-MM-DD") AS "ASIC_GST_effTo" ABN_ASIC.ASIC_entityDescription IF LENGTH(ALLTRIM(ABN_CLN))>1 AND Vndr_Sts="A" AND InvABN="F" AND (((ABN_ASIC.ASIC_entityStatusCode = "Active") AND ISBLANK(ABN_ASIC.ASIC_GST_effFrom)) OR ((ABN_ASIC.ASIC_entityStatusCode = "Active") AND NOT ISBLANK(ABN_ASIC.ASIC_GST_effTo))) TO "%fld_Tmps%TMP1" OPEN

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+"~"+ALLTRIM(ABN_CLN),1,85)

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP_Vnd"  OPEN
INDEX ON Vndr_Site_ID TO IDX_TMP_VndrSiteID

COMM *** VM003D. Identify invoices with Inv_Dt >=GST expired Date ***
INDEX ON Vndr_Site_ID TO IDX_TMP_Vnd_VndrSiteID

OPEN AP_Invoices
DEFINE RELATION Vndr_Site_ID WITH TMP_Vnd INDEX IDX_TMP_Vnd_VndrSiteID

SORT ON Vndr_ID c_Inv_Dt D IF GST_Amt <> 0.00 AND NOT ISBLANK(TMP_Vnd.Vndr_ID) AND (Inv_Dt > TMP_Vnd.ASIC_GST_effTo OR ISBLANK(DATE(TMP_Vnd.ASIC_GST_effFrom))) TO "%fld_Tmps%TMP_VM010D" OPEN

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+"~"+ALLTRIM(c_Inv_Dt),1,30)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Vndr_ID Inv_Date"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "H"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "VM010D. Identify transactions by vendors not registered for GST or Inv_Dt >GST expired Date"

SET FOLDER /%fld_Results%

SUMMARIZE ON Vndr_Site_ID SUBTOTAL GST_Amt Inv_Amt TO "%fld_Results%VM010D_DeReg_GST_Sum.FIL" OPEN PRESORT
INDEX ON Vndr_Site_ID TO IDX_VM010D_Sum_VndrSiteID

SET FOLDER /%fld_Tmps%

OPEN TMP_Vnd
DEFINE RELATION Vndr_Site_ID WITH VM010D_DeReg_GST_Sum INDEX IDX_VM010D_Sum_VndrSiteID

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ALLTRIM(ZONED(VM010D_DeReg_GST_Sum.GST_Amt,12))+ALLTRIM(Vndr_ID)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Total_InvAmt_PostGST_Expiry Vndr_ID"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate  

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "VM010. Identify ABN deregistered for GST against ABR site"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SORT ON SORT_KEY D TO "%fld_Tmps%TMP_VM010" OPEN
DEFINE RELATION Vndr_Site_ID WITH VM010D_DeReg_GST_Sum INDEX IDX_VM010D_Sum_VndrSiteID

COMM *** Finalize results ***
SET FOLDER /%fld_Results%
OPEN TMP_VM010
DEFINE RELATION Vndr_Site_ID WITH VMF_Vnd_Master_File INDEX IDX_VndrSiteID
EXTRACT FIELDS ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription VM010D_DeReg_GST_Sum.Inv_Amt VM010D_DeReg_GST_Sum.GST_Amt VM010D_DeReg_GST_Sum.COUNT %v_flds_VMF% Priority TEST_NAME RptRunDate SORT_KEY SORT_KEY_Desc TO "%fld_Results%VM010_DeReg_GST" OPEN
INDEX ON Vndr_Site_ID TO IDX_VM010_VndrSiteID
DEFINE RELATION Vndr_Site_ID WITH VM010D_DeReg_GST_Sum INDEX IDX_VM010D_Sum_VndrSiteID
    
OPEN TMP_VM010D
DEFINE RELATION Vndr_Site_ID WITH VM010_DeReg_GST INDEX IDX_VM010_VndrSiteID

EXTRACT FIELDS VM010_DeReg_GST.ASIC_GST_effTo %v_flds_AP_Inv% Priority TEST_NAME RptRunDate Data_Range_Start_Date Data_Range_End_Date SORT_KEY SORT_KEY_Desc TO "%fld_Results%VM010D_DeReg_GST" OPEN
DEFINE RELATION Vndr_Site_ID WITH VM010_DeReg_GST INDEX IDX_VM010_VndrSiteID

OPEN AP_Invoices
DELETE RELATION TMP_Vnd OK
OPEN TMP_VM010D
DELETE RELATION VM010_DeReg_GST OK

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    CB001_Imp_AP_VM                    
[PARENT_FOLDER_ID] 1341537122
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** User can customize data after importing source data
COMM *** This script imports source data. Need to be customised for each client.
COMM *** Prepare the data for the mapping/conversion  -- Accounts payable and Vendor Master file
COMM *** DATE: 06/10/2012
COMM***************************************************************************


IF FTYPE("fld_Sources")="U" OR FTYPE("fld_Data")="U" OR FTYPE("fld_Data_Path") = "U" DO AA002_Variable_Setting
 
SET SAFETY OFF

COMMENT  Custom File Import Routine


SET DATE "DD/MM/YYYY"

SET FOLDER /%fld_Sources%

COMM *** Source: Vendor Master File ***

DO CB001_Imp_AP_VMF_SUB

COMM *** Source: Vendor Bank Accounts *** 

DO CB001_Imp_AP_VMBnk_SUB


COMM *** Source: AP Invoice Listing  ***

DO CB007_Imp_Inv


SET SAFETY ON
^BATCH    CB002_Pre_APVM_Hist                
[PARENT_FOLDER_ID] 1341537122
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** User can customize data after importing source data
COMM *** Prepare the data for the mapping/conversion  -- AP Invoices, PO Items and Vendor Master File
COMM *** CREATED BY NANCY LI ON 08/10/2012
COMM***************************************************************************


IF FTYPE("fld_Sources")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET FOLDER /%fld_Tmps%
SET DATE "DD/MM/YYYY"



SET FOLDER /%fld_Sources%

COMM Prepare Invoices
OPEN AP_INVOICES_ALL
DELETE FIELD c_MONTH OK
DEFINE FIELD c_MONTH COMPUTED 

"01" IF SUBSTR(INVOICE_DATE,4,3) = 'JAN' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"02" IF SUBSTR(INVOICE_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"03" IF SUBSTR(INVOICE_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"04" IF SUBSTR(INVOICE_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"05" IF SUBSTR(INVOICE_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"06" IF SUBSTR(INVOICE_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"07" IF SUBSTR(INVOICE_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"08" IF SUBSTR(INVOICE_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"09" IF SUBSTR(INVOICE_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"10" IF SUBSTR(INVOICE_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"11" IF SUBSTR(INVOICE_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"12" IF SUBSTR(INVOICE_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"00"


DELETE FIELD c_DAY OK
DEFINE FIELD c_DAY COMPUTED SUBSTR(INVOICE_DATE,1,2) 

DELETE FIELD c_YEAR OK
DEFINE FIELD c_YEAR COMPUTED 

"20"+ SUBSTR(INVOICE_DATE,8,2) IF  LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
SUBSTR(INVOICE_DATE,6,4)

DELETE FIELD c_INVOICE_DATE_CLN OK
DEFINE FIELD c_INVOICE_DATE_CLN COMPUTED c_DAY + '/' + c_MONTH + '/' + c_YEAR

DELETE FIELD c_INVOICE_DATE OK
DEFINE FIELD  c_INVOICE_DATE COMPUTED 

CTOD(c_INVOICE_DATE_CLN ,'DD/MM/YYYY' ) IF LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
CTOD(INVOICE_DATE ,'DD/MM/YYYY' )

DELETE FIELD c_INVOICE_AMOUNT OK
DEFINE FIELD c_INVOICE_AMOUNT COMPUTED VALUE(INVOICE_AMOUNT,2)


DELETE FIELD c_MONTH1 OK
DEFINE FIELD c_MONTH1 COMPUTED 

"01" IF SUBSTR(CANCELLED_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"02" IF SUBSTR(CANCELLED_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"03" IF SUBSTR(CANCELLED_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"04" IF SUBSTR(CANCELLED_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"05" IF SUBSTR(CANCELLED_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"06" IF SUBSTR(CANCELLED_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"07" IF SUBSTR(CANCELLED_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"08" IF SUBSTR(CANCELLED_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"09" IF SUBSTR(CANCELLED_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"10" IF SUBSTR(CANCELLED_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"11" IF SUBSTR(CANCELLED_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"12" IF SUBSTR(CANCELLED_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"00"

DELETE FIELD c_DAY1 OK
DEFINE FIELD c_DAY1 COMPUTED SUBSTR(CANCELLED_DATE,1,2)

DELETE FIELD c_YEAR1 OK
DEFINE FIELD c_YEAR1 COMPUTED 

"20"+ SUBSTR(CANCELLED_DATE,8,2) IF LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(INVOICE_DATE,8,2),0) <= 30
"19"+ SUBSTR(CANCELLED_DATE,8,2) IF LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(INVOICE_DATE,8,2),0) > 30
SUBSTR(CANCELLED_DATE,6,4)

DELETE FIELD c_CANCELLED_DATE_CLN OK
DEFINE FIELD c_CANCELLED_DATE_CLN COMPUTED c_DAY1 + '/' + c_MONTH1 + '/' + c_YEAR1

DELETE FIELD c_CANCELLED_DATE OK
DEFINE FIELD c_CANCELLED_DATE COMPUTED 

CTOD(c_CANCELLED_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
CTOD(CANCELLED_DATE ,'DD/MM/YYYY' )

COMMENT
EXTRACT FOR HISTORICAL

EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF BETWEEN(c_INVOICE_DATE,CTOD(_Data_Range_From,"DD/MM/YYYY"),CTOD(_Data_Range_To,"DD/MM/YYYY"))

v_invoice_count = 0
OPEN AP_INVOICES_ALL_FMT
COUNT
v_invoice_count = COUNT1

COMM Prepare Vendor Master
OPEN AP_VendorMaster_ALL

DELETE FIELD c_VENDOR_ID OK
DEFINE FIELD c_VENDOR_ID COMPUTED REPLACE(ALLTRIM(VENDOR_ID_),'~','') 

COMM Transform character based Date to DD/MM/YYYY for Header_Inactive_Date

DELETE FIELD c_MONTH2 OK
DEFINE FIELD c_MONTH2 COMPUTED 

"01" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"02" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"03" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"04" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"05" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"06" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"07" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"08" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"09" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"10" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"11" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"12" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"00"

DELETE FIELD c_DAY2 OK
DEFINE FIELD c_DAY2 COMPUTED SUBSTR(HEADER_INACTIVE_DATE,1,2)

DELETE FIELD c_YEAR2 OK
DEFINE FIELD c_YEAR2 COMPUTED 

"20"+ SUBSTR(HEADER_INACTIVE_DATE,8,2) IF LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(HEADER_INACTIVE_DATE,8,2),0) <= 30
"19"+ SUBSTR(HEADER_INACTIVE_DATE,8,2) IF LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(HEADER_INACTIVE_DATE,8,2),0) > 30
SUBSTR(HEADER_INACTIVE_DATE,6,4)

DELETE FIELD c_HEADER_INACTIVE_DATE_CLN OK
DEFINE FIELD c_HEADER_INACTIVE_DATE_CLN COMPUTED c_DAY2 + '/' + c_MONTH2 + '/' + c_YEAR2

DELETE FIELD c_HEADER_INACTIVE_DATE OK
DEFINE FIELD c_HEADER_INACTIVE_DATE COMPUTED 

CTOD(c_HEADER_INACTIVE_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 
CTOD(c_HEADER_INACTIVE_DATE_CLN ,'DD/MM/YYYY' )

COMM Header Inactive Date Transform --

COMM Transform character based Date to DD/MM/YYYY for SITE_INACTIVE_DATE

DELETE FIELD c_MONTH3 OK
DEFINE FIELD c_MONTH3 COMPUTED 

"01" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"02" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"03" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"04" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"05" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"06" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"07" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"08" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"09" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"10" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"11" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"12" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"00"

DELETE FIELD c_DAY3 OK
DEFINE FIELD c_DAY3 COMPUTED SUBSTR(SITE_INACTIVE_DATE,1,2)

DELETE FIELD c_YEAR3 OK
DEFINE FIELD c_YEAR3 COMPUTED 

"20"+ SUBSTR(SITE_INACTIVE_DATE,8,2) IF LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(SITE_INACTIVE_DATE,8,2),0) <= 30
"19"+ SUBSTR(SITE_INACTIVE_DATE,8,2) IF LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(SITE_INACTIVE_DATE,8,2),0) > 30
SUBSTR(SITE_INACTIVE_DATE,6,4)


DELETE FIELD c_SITE_INACTIVE_DATE_CLN OK
DEFINE FIELD c_SITE_INACTIVE_DATE_CLN COMPUTED c_DAY3 + '/' + c_MONTH3 + '/' + c_YEAR3

DELETE FIELD c_SITE_INACTIVE_DATE OK
DEFINE FIELD c_SITE_INACTIVE_DATE COMPUTED 

CTOD(c_SITE_INACTIVE_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
CTOD(c_SITE_INACTIVE_DATE_CLN ,'DD/MM/YYYY' )

COMM SITE_INACTIVE_DATE Transform --


COMM Transform character based Date to DD/MM/YYYY for HEADER_CREATION_DATE

DELETE FIELD c_MONTH4 OK
DEFINE FIELD c_MONTH4 COMPUTED 

"01" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"02" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"03" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"04" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"05" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"06" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"07" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"08" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"09" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"10" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"11" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"12" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"00"

DELETE FIELD c_DAY4 OK
DEFINE FIELD c_DAY4 COMPUTED SUBSTR(HEADER_CREATION_DATE,1,2)

DELETE FIELD c_YEAR4 OK
DEFINE FIELD c_YEAR4 COMPUTED 

"20"+ SUBSTR(HEADER_CREATION_DATE,8,2) IF LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(HEADER_CREATION_DATE,8,2),0) <= 30
"19"+ SUBSTR(HEADER_CREATION_DATE,8,2) IF LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(HEADER_CREATION_DATE,8,2),0) > 30
SUBSTR(HEADER_CREATION_DATE,6,4)

DELETE FIELD c_HEADER_CREATION_DATE_CLN OK
DEFINE FIELD c_HEADER_CREATION_DATE_CLN COMPUTED c_DAY4 + '/' + c_MONTH4 + '/' + c_YEAR4

DELETE FIELD c_HEADER_CREATION_DATE OK
DEFINE FIELD c_HEADER_CREATION_DATE COMPUTED 

CTOD(c_HEADER_CREATION_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
CTOD(c_HEADER_CREATION_DATE_CLN ,'DD/MM/YYYY' )

COMM HEADER_CREATION_DATE Transform --

COMM Transform character based Date to DD/MM/YYYY for SITE_CREATION_DATE

DELETE FIELD c_MONTH5 OK
DEFINE FIELD c_MONTH5 COMPUTED 

"01" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"02" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"03" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"04" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"05" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"06" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"07" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"08" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"09" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"10" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"11" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"12" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"00"

DELETE FIELD c_DAY5 OK
DEFINE FIELD c_DAY5 COMPUTED SUBSTR(SITE_CREATION_DATE,1,2)

DELETE FIELD c_YEAR5 OK
DEFINE FIELD c_YEAR5 COMPUTED 

"20"+ SUBSTR(SITE_CREATION_DATE,8,2) IF LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(SITE_CREATION_DATE,8,2),0) <= 30
"19"+ SUBSTR(SITE_CREATION_DATE,8,2) IF LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(SITE_CREATION_DATE,8,2),0) > 30
SUBSTR(SITE_CREATION_DATE,6,4)

DELETE FIELD c_SITE_CREATION_DATE_CLN OK
DEFINE FIELD c_SITE_CREATION_DATE_CLN COMPUTED c_DAY5 + '/' + c_MONTH5 + '/' + c_YEAR5

DELETE FIELD c_SITE_CREATION_DATE OK
DEFINE FIELD c_SITE_CREATION_DATE COMPUTED 

CTOD(c_SITE_CREATION_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
CTOD(c_SITE_CREATION_DATE_CLN ,'DD/MM/YYYY' )

COMM SITE_CREATION_DATE Transform --

COMM HEADER_LAST_UPDATE_DATE Transform --

COMM Transform character based Date to DD/MM/YYYY for HEADER_LAST_UPDATE_DATE

DELETE FIELD c_MONTH8 OK
DEFINE FIELD c_MONTH8 COMPUTED 

"01" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"02" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"03" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"04" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"05" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"06" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"07" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"08" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"09" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"10" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"11" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"12" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"00"

DELETE FIELD c_DAY8 OK
DEFINE FIELD c_DAY8 COMPUTED SUBSTR(HEADER_LAST_UPDATE_DATE,1,2)

DELETE FIELD c_YEAR8 OK
DEFINE FIELD c_YEAR8 COMPUTED 

"20"+ SUBSTR(HEADER_LAST_UPDATE_DATE,8,2) IF LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(HEADER_LAST_UPDATE_DATE,8,2),0) <= 30
"19"+ SUBSTR(HEADER_LAST_UPDATE_DATE,8,2) IF LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(HEADER_LAST_UPDATE_DATE,8,2),0) > 30
SUBSTR(HEADER_LAST_UPDATE_DATE,6,4)

DELETE FIELD c_HEADER_LAST_UPDATE_DATE_CLN OK
DEFINE FIELD c_HEADER_LAST_UPDATE_DATE_CLN COMPUTED c_DAY8 + '/' + c_MONTH8 + '/' + c_YEAR8

DELETE FIELD c_HEADER_LAST_UPDATE_DATE OK
DEFINE FIELD c_HEADER_LAST_UPDATE_DATE COMPUTED 

CTOD(c_HEADER_LAST_UPDATE_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
CTOD(c_HEADER_LAST_UPDATE_DATE_CLN ,'DD/MM/YYYY' )

COMM HEADER_LAST_UPDATE_DATE Transform --

COMM SITE_LAST_UPDATE_DATE Transform --

COMM Transform character based Date to DD/MM/YYYY for SITE_LAST_UPDATE_DATE

DELETE FIELD c_MONTH9 OK
DEFINE FIELD c_MONTH9 COMPUTED 

"01" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"02" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"03" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"04" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"05" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"06" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"07" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"08" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"09" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"10" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"11" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"12" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"00"

DELETE FIELD c_DAY9 OK
DEFINE FIELD c_DAY9 COMPUTED SUBSTR(SITE_LAST_UPDATE_DATE,1,2)

DELETE FIELD c_YEAR9 OK
DEFINE FIELD c_YEAR9 COMPUTED 

"20"+ SUBSTR(SITE_LAST_UPDATE_DATE,8,2) IF LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(SITE_LAST_UPDATE_DATE,8,2),0) <= 30
"19"+ SUBSTR(SITE_LAST_UPDATE_DATE,8,2) IF LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(SITE_LAST_UPDATE_DATE,8,2),0) > 30
SUBSTR(SITE_LAST_UPDATE_DATE,6,4)

DELETE FIELD c_SITE_LAST_UPDATE_DATE_CLN OK
DEFINE FIELD c_SITE_LAST_UPDATE_DATE_CLN COMPUTED c_DAY9 + '/' + c_MONTH9 + '/' + c_YEAR9

DELETE FIELD c_SITE_LAST_UPDATE_DATE OK
DEFINE FIELD c_SITE_LAST_UPDATE_DATE COMPUTED 

CTOD(c_SITE_LAST_UPDATE_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
CTOD(c_SITE_LAST_UPDATE_DATE_CLN ,'DD/MM/YYYY' )

COMM SITE_LAST_UPDATE_DATE Transform --


DELETE FIELD c_VENDOR_STATUS OK
DEFINE FIELD c_VENDOR_STATUS COMPUTED
c_VENDOR_STATUS
"A" IF c_HEADER_INACTIVE_DATE = `19000101` AND c_SITE_INACTIVE_DATE = `19000101`
"A" IF (c_HEADER_INACTIVE_DATE > TODAY()) OR (c_SITE_INACTIVE_DATE > TODAY())
"I"

DELETE FIELD c_Tel OK
DEFINE FIELD c_Tel COMPUTED INCLUDE(AREA_CODE,'0123456789') + INCLUDE(PHONE,'0123456789')

DELETE FIELD c_Fax OK
DEFINE FIELD c_Fax COMPUTED INCLUDE(AREA_CODE,'0123456789') + INCLUDE(FAX,'0123456789')

COMM 
EXTRACT BELOW JUST FOR HISTORICAL VM DATA

EXTRACT FIELDS ALL 'R11' AS 'SourceFlag' TO "AP_VendorMaster_ALL_FMT.FIL" IF BETWEEN(c_SITE_LAST_UPDATE_DATE,CTOD(_Data_Range_From_VM,"DD/MM/YYYY"),CTOD(_Data_Range_To_VM,"DD/MM/YYYY")) AND BETWEEN(c_HEADER_LAST_UPDATE_DATE,CTOD(_Data_Range_From_VM,"DD/MM/YYYY"),CTOD(_Data_Range_To_VM,"DD/MM/YYYY")) 

v_vm_count = 0
OPEN AP_VendorMaster_ALL_FMT
COUNT
v_vm_count = COUNT1


COMM *** Vendors ***
SET FOLDER /%fld_Sources%


COMM Prepare Vendor Bank Accounts

OPEN AP_VendorMasterBnkAcc_ALL
DELETE FIELD c_VENDOR_ID OK
DEFINE FIELD c_VENDOR_ID COMPUTED REPLACE(ALLTRIM(VENDOR_ID__),'~','')


COMM Transform character based Date to DD/MM/YYYY for ACCT_START_DATE

DELETE FIELD c_MONTH6 OK
DEFINE FIELD c_MONTH6 COMPUTED 

"01" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'JAN' AND  LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"02" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'FEB' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"03" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'MAR' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"04" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'APR' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"05" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'MAY' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"06" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'JUN' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"07" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'JUL' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"08" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'AUG' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"09" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'SEP' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"10" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'OCT' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"11" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'NOV' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"12" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'DEC' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"00"

DELETE FIELD c_DAY6 OK
DEFINE FIELD c_DAY6 COMPUTED SUBSTR(_ACCT_START_DATE_,1,2)

DELETE FIELD c_YEAR6 OK
DEFINE FIELD c_YEAR6 COMPUTED 

"20"+ SUBSTR(_ACCT_START_DATE_,8,2) IF LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(_ACCT_START_DATE_,8,2),0) <= 30
"19"+ SUBSTR(_ACCT_START_DATE_,8,2) IF LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(_ACCT_START_DATE_,8,2),0) > 30
SUBSTR(_ACCT_START_DATE_,6,4)

DELETE FIELD c_ACCT_START_DATE_CLN OK
DEFINE FIELD c_ACCT_START_DATE_CLN COMPUTED c_DAY6 + '/' + c_MONTH6 + '/' + c_YEAR6

DELETE FIELD c_ACCT_START_DATE OK
DEFINE FIELD c_ACCT_START_DATE COMPUTED 

CTOD(c_ACCT_START_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
CTOD(c_ACCT_START_DATE_CLN ,'DD/MM/YYYY' )

COMM ACCT_START_DATE Transform --

COMM Transform character based Date to DD/MM/YYYY for ACCT_END_DATE

DELETE FIELD c_MONTH7 OK
DEFINE FIELD c_MONTH7 COMPUTED 

"01" IF SUBSTR(_ACCT_END_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"02" IF SUBSTR(_ACCT_END_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"03" IF SUBSTR(_ACCT_END_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"04" IF SUBSTR(_ACCT_END_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"05" IF SUBSTR(_ACCT_END_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"06" IF SUBSTR(_ACCT_END_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"07" IF SUBSTR(_ACCT_END_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"08" IF SUBSTR(_ACCT_END_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"09" IF SUBSTR(_ACCT_END_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"10" IF SUBSTR(_ACCT_END_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"11" IF SUBSTR(_ACCT_END_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"12" IF SUBSTR(_ACCT_END_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"00"

DELETE FIELD c_DAY7 OK
DEFINE FIELD c_DAY7 COMPUTED SUBSTR(_ACCT_END_DATE,1,2)

DELETE FIELD c_YEAR7 OK
DEFINE FIELD c_YEAR7 COMPUTED 

"20"+ SUBSTR(_ACCT_END_DATE,8,2) IF LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(_ACCT_END_DATE,8,2),0) <= 30
"19"+ SUBSTR(_ACCT_END_DATE,8,2) IF LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(_ACCT_END_DATE,8,2),0) > 30
SUBSTR(_ACCT_END_DATE,6,4)

DELETE FIELD c_ACCT_END_DATE_CLN OK
DEFINE FIELD c_ACCT_END_DATE_CLN COMPUTED c_DAY7 + '/' + c_MONTH7 + '/' + c_YEAR7

DELETE FIELD c_ACCT_END_DATE OK
DEFINE FIELD c_ACCT_END_DATE COMPUTED 

CTOD(c_ACCT_END_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
CTOD(c_ACCT_END_DATE_CLN ,'DD/MM/YYYY' )

COMM LAST_UPDATE_DATE Transform --

COMM Transform character based Date to DD/MM/YYYY for LAST_UPDATE_DATE

DELETE FIELD c_MONTH10 OK
DEFINE FIELD c_MONTH10 COMPUTED 

"01" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"02" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"03" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"04" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"05" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"06" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"07" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"08" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"09" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"10" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"11" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"12" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"00"

DELETE FIELD c_DAY10 OK
DEFINE FIELD c_DAY10 COMPUTED SUBSTR(LAST_UPDATE_DATE,1,2)

DELETE FIELD c_YEAR10 OK
DEFINE FIELD c_YEAR10 COMPUTED 

"20"+ SUBSTR(LAST_UPDATE_DATE,8,2) IF LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(LAST_UPDATE_DATE,8,2),0) <= 30
"19"+ SUBSTR(LAST_UPDATE_DATE,8,2) IF LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(LAST_UPDATE_DATE,8,2),0) > 30
SUBSTR(LAST_UPDATE_DATE,6,4)

DELETE FIELD c_LAST_UPDATE_DATE_CLN OK
DEFINE FIELD c_LAST_UPDATE_DATE_CLN COMPUTED c_DAY10 + '/' + c_MONTH10 + '/' + c_YEAR10

DELETE FIELD c_LAST_UPDATE_DATE OK
DEFINE FIELD c_LAST_UPDATE_DATE COMPUTED 

CTOD(c_LAST_UPDATE_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
CTOD(c_LAST_UPDATE_DATE_CLN ,'DD/MM/YYYY' )

COMM LAST_UPDATE_DATE Transform --

COMM Transform character based Date to DD/MM/YYYY for ACCT_END_DATE
COMM 
EXTRACT BELOW JUST FOR HISTORICAL VM DATA

EXTRACT FIELDS SUBSTR(c_VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTR(_VENDOR_SITE_ID_,1,20) AS 'VENDOR_SITE_ID' SUBSTR(_VENDOR_BANK_ACCT_NAME_,1,60) AS 'VENDOR_BANK_ACCT_NAME' SUBSTR(_VENDOR_BSB_,1,20) AS 'VENDOR_BSB'   SUBSTR(_VENDOR_BANK_ACCOUNT_NUMBER_,1,30) AS 'VENDOR_BANK_ACCOUNT_NUMBER' c_ACCT_START_DATE AS 'ACCT_START_DATE'  c_ACCT_END_DATE AS 'ACCT_END_DATE' c_LAST_UPDATE_DATE AS 'LAST_UPDATE_DATE'  'R11' AS 'SourceFlag' File_Name TO "AP_VendorMasterBnkAcc_ALL_FMT.FIL" IF BETWEEN(c_LAST_UPDATE_DATE,CTOD(_Data_Range_From_VM,"DD/MM/YYYY"),CTOD(_Data_Range_To_VM,"DD/MM/YYYY")) 

v_vm_bnk_count = 0
OPEN AP_VendorMasterBnkAcc_ALL_FMT
COUNT
v_vm_bnk_count = COUNT1



COMM *** Delete temporary tables ***

DO AE003_Del_Tmp

SET SAFETY ON

^BATCH    CB001_Extract_APVM                 
[PARENT_FOLDER_ID] 1341537122
SET SAFETY OFF
CLOSE PRIMARY SECONDARY
SET FOLDER /%fld_Tmps%

COM *** List all .7z file(s) in the input folder

COMM set var for import count if there are files to import
v_ImportExists = 0 

DIRECTORY "%fld_Data_Path%*.7z" SUPPRESS TO "%fld_Tmps%TMP1"

OPEN TMP1
SORT ON FILE_WRITE_DATE TO "%fld_Tmps%TMP2"

OPEN TMP2
COUNT
v_TotalFiles = COUNT1
v_ImportExists = COUNT1 

v_index = 1

DO CB001_Extract_APVM_SUB WHILE v_index <= v_TotalFiles
^BATCH    CB001_Imp_AP_VMF_SUB               
[PARENT_FOLDER_ID] 1341537122
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Import Vendor Master Files (fixed and delta)
COMM *** DATE: 06/10/2015
COMM***************************************************************************


IF FTYPE("fld_Sources")="U" OR FTYPE("fld_Data")="U" OR FTYPE("fld_VM_AP_VMF_Fld")="U" OR  FTYPE("fld_VM_AP_VMF_Ext") = "U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"

SET FOLDER /%fld_Tmps%

COMM *** List Table Names ***
CLOSE

DIR "%fld_VM_AP_VMF_Fld%*" TO "%fld_Tmps%TMP4"
OPEN TMP4
SORT ON FILE_CREATE_DATE  FILE_CREATE_TIME  TO "%fld_Tmps%Data_VMF_Lst"
DELETE FIELD c_Folder OK
DEFINE FIELD c_Folder COMPUTED SUBSTR(REPLACE(ALLTRIM(REPLACE(FILE_NAME,'%fld_VM_AP_VMF_Fld%','')),'%fld_VM_AP_VMF_Ext%',''),1,20)

SET FILTER TO MAP(c_Folder,"99999999")
SORT ON c_Folder TO "%fld_Tmps%Lst_Fld" OPEN
COUNT
v_counter=1

DO CB007_Imp_VMF_Sub WHILE v_counter<=COUNT1



COMM *** delete all temp files ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    CB007_Imp_VMF_Sub                  
[PARENT_FOLDER_ID] 1341537122
SET SAFETY OFF

IF FTYPE("fld_Data_Path")="U" DO AA002_Variable_Setting

SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%


OPEN TMP4
LOCATE RECORD v_counter

v_FILE_NAME = ALLTRIM(FILE_NAME)


IMPORT DELIMITED TO TMP1 "%fld_Tmps%TMP1.fil" FROM "%v_FILE_NAME%" 0 SEPARATOR "|" QUALIFIER "~" CONSECUTIVE STARTLINE 1 KEEPTITLE FIELD "VENDOR_ID_" C AT 1 DEC 0 WID 20 PIC "" AS "" FIELD "VENDOR_NUMBER" C AT 21 DEC 0 WID 20 PIC "" AS "" FIELD "VENDOR_NAME" C AT 41 DEC 0 WID 100 PIC "" AS "" FIELD "VENDOR_SITE_ID" C AT 141 DEC 0 WID 20 PIC "" AS "" FIELD "VENDOR_SITE" C AT 161 DEC 0 WID 30 PIC "" AS "" FIELD "VENDOR_ADDRESS" C AT 191 DEC 0 WID 133 PIC "" AS "" FIELD "CITY" C AT 324 DEC 0 WID 35 PIC "" AS "" FIELD "STATE" C AT 359 DEC 0 WID 18 PIC "" AS "" FIELD "POSTCODE" C AT 377 DEC 0 WID 13 PIC "" AS "" FIELD "COUNTRY" C AT 390 DEC 0 WID 10 PIC "" AS "" FIELD "HEADER_INACTIVE_DATE" C AT 400 DEC 0 WID 20 PIC "" AS "" FIELD "SITE_INACTIVE_DATE" C AT 420 DEC 0 WID 20 PIC "" AS "" FIELD "VENDOR_ABN" C AT 440 DEC 0 WID 20 PIC "" AS "" FIELD "GST_REGISTRATION_STATUS" C AT 460 DEC 0 WID 35 PIC "" AS "" FIELD "AREA_CODE" C AT 495 DEC 0 WID 10 PIC "" AS "" FIELD "PHONE" C AT 505 DEC 0 WID 25 PIC "" AS "" FIELD "FAX" C AT 530 DEC 0 WID 25 PIC "" AS "" FIELD "EMAIL_ADDRESS" C AT 555 DEC 0 WID 100 PIC "" AS "" FIELD "VENDOR_TYPE" C AT 655 DEC 0 WID 23 PIC "" AS "" FIELD "PAYMENT_METHOD" C AT 678 DEC 0 WID 15 PIC "" AS "" FIELD "HEADER_CREATION_DATE" C AT 693 DEC 0 WID 20 PIC "" AS "" FIELD "SITE_CREATION_DATE" C AT 713 DEC 0 WID 20 PIC "" AS ""FIELD HEADER_LAST_UPDATE_DATE C AT 733 DEC 0 WID 20 PIC "" AS "" FIELD SITE_LAST_UPDATE_DATE C AT 753 DEC 0 WID 20 PIC "" AS "" 

OPEN TMP1


COMMENT Determine if this table is the first Vendor file and not deltas
SET FOLDER /%fld_Sources%
v_NewFlag = 1
COMM 
IF FILESIZE("AP_VendorMaster_ALL.fil") = -1  v_NewFlag = 1 

IF v_NewFlag = 1 EXTRACT FIELDS ALL SUBSTR("%v_FILE_NAME%",1,50) AS 'File_Name' TO  AP_VendorMaster_ALL 

v_CleanFileName = ALLTRIM(REPLACE(v_FILE_NAME,"E:\Data\",""))


COMM Move processed files into Archive
RENAME FILE "%fld_Data_Path%%v_CleanFileName%" "%fld_Archive_Path%%v_CleanFilename%" OK


OPEN Lst_Fld
v_counter=v_counter+1

SET SAFETY ON


^BATCH    CB007_Imp_VMBnk_Sub                
[PARENT_FOLDER_ID] 1341537122
SET SAFETY OFF

IF FTYPE("fld_Data_Path")="U" DO AA002_Variable_Setting

SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%


OPEN TMP4
LOCATE RECORD v_counter

v_FILE_NAME = ALLTRIM(FILE_NAME)


IMPORT DELIMITED TO TMP1 "%fld_Tmps%TMP1.FIL" FROM "%v_FILE_NAME%" 0 SEPARATOR "|" QUALIFIER "~" CONSECUTIVE STARTLINE 1 KEEPTITLE FIELD "VENDOR_ID__" C AT 1 DEC 0 WID 11 PIC "" AS "" FIELD "_VENDOR_SITE_ID_" C AT 12 DEC 0 WID 16 PIC "" AS "" FIELD "_VENDOR_BANK_ACCT_NAME_" C AT 28 DEC 0 WID 48 PIC "" AS "" FIELD "_VENDOR_BSB_" C AT 76 DEC 0 WID 12 PIC "" AS "" FIELD "_VENDOR_BANK_ACCOUNT_NUMBER_" C AT 88 DEC 0 WID 28 PIC "" AS "" FIELD "_ACCT_START_DATE_" C AT 116 DEC 0 WID 22 PIC "" AS "" FIELD "_ACCT_END_DATE" C AT 138 DEC 0 WID 22 PIC "" AS ""  FIELD "LAST_UPDATE_DATE" C AT 160 DEC 0 WID 22 PIC "" AS ""


 
OPEN TMP1

Comment there are duplicate bank accounts in a single file therefore sort and summarise on key of Vendor Site ID, Vendor ID, Vendor BSB, Vendor Bank Account Number taking the latest Start Date as the current
SORT ON _VENDOR_SITE_ID_ VENDOR_ID__ _VENDOR_BSB_ _VENDOR_BANK_ACCOUNT_NUMBER_ _ACCT_START_DATE_  D  TO "TMP_2" OPEN
OPEN "TMP_2"
SUMMARIZE ON _VENDOR_SITE_ID_ VENDOR_ID__ _VENDOR_BSB_ _VENDOR_BANK_ACCOUNT_NUMBER_ OTHER _VENDOR_SITE_ID_ VENDOR_ID__ _VENDOR_BSB_ _VENDOR_BANK_ACCOUNT_NUMBER_ _VENDOR_BANK_ACCT_NAME_ _ACCT_START_DATE_ _ACCT_END_DATE LAST_UPDATE_DATE TO "TMP_3.FIL" OPEN PRESORT

COMMENT
Format Numeric and Date fields from characters



OPEN TMP_3
COMMENT Determine if this table is the first Invoice file and not deltas
SET FOLDER /%fld_Sources%
v_NewFlag = 0 
IF FILESIZE("AP_VendorMasterBnkAcc_ALL.fil") = -1  v_NewFlag = 1 
IF v_NewFlag = 1 EXTRACT FIELDS ALL SUBSTR("%v_FILE_NAME%",1,50) AS 'File_Name' TO  AP_VendorMasterBnkAcc_ALL 

IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("%v_FILE_NAME%",1,50) AS 'File_Name' TO  AP_VendorMasterBnkAcc_ALL_New  

IF v_NewFlag = 0  DO CB007_Imp_VMBnk_SubA 

v_CleanFileName = ALLTRIM(REPLACE(v_FILE_NAME,"E:\Data\",""))


COMM Move processed files into Archive
RENAME FILE "%fld_Data_Path%%v_CleanFileName%" "%fld_Archive_Path%%v_CleanFilename%" OK



OPEN Lst_Fld
v_counter=v_counter+1

SET SAFETY ON


^BATCH    CB007_Imp_Inv_Sub                  
[PARENT_FOLDER_ID] 1341537122
SET SAFETY OFF

IF FTYPE("fld_Data_Path")="U" DO AA002_Variable_Setting

SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%


DELETE FORMAT _DIR OK
DIR *.AC TO _DIR

OPEN _DIR 

DELETE FORMAT "FIXED_5000.FIL" OK
EXTRACT BLANKS(5000) AS "ALLREC" TO "FIXED_5000.FIL" FIRST 0

DELETE FORMAT "GENERIC.FIL" OK
EXTRACT BLANKS(5000) AS "ALLREC" TO "GENERIC.FIL" FIRST 0
COMM OPEN "filename.txt" FORMAT FIXED_5000 -- dialogue prompt for filename

OPEN TMP4
LOCATE RECORD v_counter

v_FILE_NAME = ALLTRIM(FILE_NAME)

OPEN "%v_FILE_NAME%" FORMAT FIXED_5000


DEFINE FIELD c_PIPE COMPUTED OCCURS(ALLREC,'|')
DEFINE FIELD c_TILDE COMPUTED OCCURS(ALLREC,'~')
GROUP
EXTRACT REGEXREPLACE(ALLREC,"[(\x00-\x09)(\x0B-\x0C)(\x0E-\x1F)]",' ') TO "Invoice_fixed.fil"
STATISTICS ON c_PIPE
STATISTICS ON c_TILDE
END


OPEN "Invoice_fixed.fil" FORMAT GENERIC CRLF 

v_buffer=BLANKS(5000)
v_delimiters=0
fdebug=F
GROUP
 v_buffer=ALLTRIM(v_buffer)+ALLTRIM(ALLREC)
 v_delimiters = OCCURS(v_buffer,'~|~')
IF fdebug EXTRACT v_delimiters v_buffer TO debug
EXPORT '~'+ ALLTRIM(v_buffer) + '~' TO "Invoice_Clean.txt" IF v_delimiters >= 14
 v_buffer='' IF v_delimiters >= 14
 v_delimiters = 0 IF v_delimiters >= 14
END


IMPORT DELIMITED TO TMP1 "%fld_Tmps%TMP1.FIL" FROM "Invoice_Clean.txt" 0 SEPARATOR "|" QUALIFIER "~" CONSECUTIVE STARTLINE 1 KEEPTITLE  FIELD "VENDOR_ID" C AT 1 DEC 0 WID 20 PIC "" AS ""  FIELD "VENDOR_SITE_ID" C AT 21 DEC 0 WID 20 PIC "" AS ""  FIELD "INVOICE_ID" C AT 41 DEC 0 WID 10 PIC "" AS ""  FIELD "INVOICE_NUM" C AT 51 DEC 0 WID 50 PIC "" AS ""  FIELD "INVOICE_TYPE" C AT 101 DEC 0 WID 10 PIC "" AS ""  FIELD "INVOICE_DATE" C AT 111 DEC 0 WID 10 PIC "" AS ""  FIELD "INVOICE_AMOUNT" C AT 121 DEC 0 WID 12 PIC "" AS ""  FIELD "INV_DIST_NUMBER" C AT 133 DEC 0 WID 15 PIC "" AS ""  FIELD "INV_DIST_AMOUNT" C AT 148 DEC 0 WID 15 PIC "" AS ""  FIELD "DESCRIPTION" C AT 163 DEC 0 WID 500 PIC "" AS ""  FIELD "CHARGECODE" C AT 663 DEC 0 WID 35 PIC "" AS ""  FIELD "PAYMENT_STATUS_FLAG" C AT 698 DEC 0 WID 20 PIC "" AS ""  FIELD "CANCELLED_DATE" C AT 718 DEC 0 WID 20 PIC "" AS ""  FIELD "GST_STATUS" C AT 738 DEC 0 WID 20 PIC "" AS ""  FIELD "APPROVAL_STATUS" C AT 758 DEC 0 WID 30 PIC "" AS "" 

OPEN TMP1


SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN  



OPEN TMP2 

COMMENT Determine if this table is the first Invoice file and not deltas
SET FOLDER /%fld_Sources%
v_NewFlag = 0 
IF FILESIZE("AP_INVOICES_ALL.fil") = -1  v_NewFlag = 1 
IF v_NewFlag = 1 EXTRACT FIELDS ALL SUBSTR("%v_FILE_NAME%",1,50) AS 'File_Name' TO  AP_INVOICES_ALL 

IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("%v_FILE_NAME%",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New  

IF v_NewFlag = 0  DO CB007_Imp_Inv_SubA 

v_CleanFileName = ALLTRIM(REPLACE(v_FILE_NAME,"E:\Data\",""))


COMM Move processed files into Archive
RENAME FILE "%fld_Data_Path%%v_CleanFileName%" "%fld_Archive_Path%%v_CleanFilename%" OK

DELETE FIELD RptRunDateTime
DEFINE FIELD RptRunDateTime COMPUTED _RptRunDateTime
DELETE FIELD REC_KEY
DEFINE FIELD REC_KEY COMPUTED SUBSTR(ALLTRIM(INVOICE_ID)+ALLTRIM(VENDOR_SITE_ID),1,60)

COMMENT
IF v_counter=1 EXTRACT FIELDS ALL SUBSTR("%v_FILE_NAME%",1,50) AS 'File_Name' TO %fld_Sources%AP_InvoiceListing_S 
SET FOLDER /%fld_Tmps%
IF v_counter>1 OPEN AP_InvoiceListing_S
IF v_counter>1 EXTRACT FIELDS ALL TO %fld_Tmps%TMP2 OPEN
IF v_counter>1 INDEX ON REC_KEY TO IDX_TMP2
IF v_counter>1 OPEN TMP1 
IF v_counter>1 DEFINE RELATION REC_KEY WITH TMP2 INDEX IDX_TMP2
IF v_counter>1 EXTRACT FIELDS ALL SUBSTR("%v_FILE_NAME%",1,50) AS 'File_Name' IF ISBLANK(TMP2.REC_KEY) TO %fld_Sources%AP_InvoiceListing_S Append
END
OPEN Lst_Fld
v_counter=v_counter+1

SET SAFETY ON


^BATCH    AP002_Dup_Amt_Inv_Vndr             
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP002. Identify possible Duplicate Invoice: by Invoice number, vendor number and amount (different date)
COMM *** Run the Dups based on the invoices excluding rental vendors listed on the Grey List
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_AP_Inv")="U" OR FTYPE("trg_VMF")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

COMM *** Delete All the TMP files for Dups processing ***
DO AZ002_Dup_DelTmp

v_TestNo="AP002"

OPEN AP_Dups_Amt_Inv
COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_Site_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***


DUPLICATES ON c_Inv_No ABS_INVAMT_CENT  Vndr_ID OTHER %v_flds_AP_Inv% IF ABS_INVAMT_CENT <>0.00 PRESORT OPEN TO "%fld_Tmps%AP_TMP.FIL"

DELETE FIELD DUP_KEY OK
DEFINE FIELD DUP_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+"~"+ALLTRIM(c_Inv_No) +"~"+ALLTRIM(STRING(ABS_INVAMT_CENT ,21)),1,72)

COMM *** identify DIFF Date ***
DUPLICATES ON c_Inv_No ABS_INVAMT_CENT  Vndr_ID Inv_Dt OTHER %v_flds_AP_Inv% PRESORT TO "%fld_Tmps%AP_TMP3.FIL" OPEN
INDEX ON Vchr_ID TO AP_TMP3_ID


OPEN AP_TMP
DEFINE RELATION Vchr_ID WITH AP_TMP3 INDEX AP_TMP3_ID
SUMMARIZE ON DUP_KEY IF Vchr_ID<> AP_TMP3.Vchr_ID TO "%fld_Tmps%AP_TMP2.FIL" OPEN PRESORT


INDEX ON DUP_KEY TO AP_TMP2_DUP_KEY

OPEN AP_TMP
DEFINE RELATION DUP_KEY WITH AP_TMP2 AP_TMP2_DUP_KEY

EXTRACT FIELDS %v_flds_AP_Inv% DUP_KEY IF DUP_KEY= AP_TMP2.DUP_KEY TO "%fld_Tmps%TMP_AP_DUPS" OPEN 
DELETE FIELD ABS_INVAMT_CENT OK
DEFINE FIELD ABS_INVAMT_CENT COMPUTED 

VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21)),4) IF OCCURS(ALLTRIM(STRING(ABS(Inv_Amt),21)),".")>=0
VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21 )),4)


COMM *** Start removing reversals ***
DO AZ003_Dup_FixedUp
COMM *** End removing reversals ***

COMM *** Start DeDup: compare to AP001 ***
DO AZ001_Dup_DeDup
COMM *** End DeDup ***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vchr_ID)+"~"+ALLTRIM(DUP_KEY),1,85)
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
v_DUP_KEY="DUP_KEY"
v_Filter= "AND FLAG='O'"
IF v_Exc_History =T DO AE001_Dup_History
IF v_Chk_CCM=T DO AE006_Dup_CCM
COMM *** End ***

COMM *** keep the RANK information***
IF v_Exc_History =F EXTRACT FIELDS ALL TO "%fld_Tmps%TMP11" OPEN

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "AP002. Duplicated Invoices by InvNo,Amt and VndNbr (Diff Date)"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

COMM create a quoted invoice id field - to prevent issue with stripping of leading zeros in excel spreadsheet
DELETE FIELD c_QUOTED_INV_ID
DEFINE FIELD c_QUOTED_INV_ID COMPUTED "'"+ ALLTRIM(Inv_No) + "'"

comm *** finalize the result  ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%AP002_Dup_Amt_Inv_Vndr" OPEN 

DEFINE RELATION Vndr_Site_ID WITH %trg_VMF% INDEX IDX_VndrSiteID

SET FOLDER /%fld_Tmps%

v_Exp_Fields_AP002 = "Flag VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description' Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc" 

OPEN AP002_Dup_Amt_Inv_Vndr
COMM Exclude Vendor Types FOXBOUNTY 27/7/2015
EXTRACT %v_Exp_Fields_AP002% TO  TMP_AP002 IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT" 

SET FOLDER /%fld_Results%

COMM *** Delete All the TMP files for Dups processing ***
DO AZ002_Dup_DelTmp

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    CB001_Extract_APVM_SUB             
[PARENT_FOLDER_ID] 1341537122
CLOSE PRIMARY SECONDARY
OPEN TMP2
LOCATE RECORD v_index
v_CurrFile = ALLTRIM(FILE_NAME)

COM Command line: 7z e <current 7z file complete path> -o<output folder> -p<password> -y
EXECUTE '"%fld_7Z_Path%7z" e "%fld_Data_Path%%v_CurrFile%" -o"%fld_Data_Path%" -p%v_7Z_Pwd% -y'


v_folder = ALLTRIM(replace(v_CurrFile,".7z",""))
EXECUTE 'cmd /c rmdir %fld_Data_Path%%v_folder%'

RENAME "%fld_Data_Path%%v_CurrFile%" "%fld_Archive_Path%7z\%v_CurrFile%" OK 

v_index = v_index + 1
^FOLDER   History                             1439254479
[PARENT_FOLDER_ID] 0
^BATCH    AP001_Dup_Amt_Dt_Inv_Vndr          
[PARENT_FOLDER_ID] 1340167380
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** AP001. Identify possible Duplicate Invoice: by Invoice number, amount, date, and vendor number
COMM *** Run the Dups based on the invoices excluding vendor Synnex
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_AP_Inv")="U" OR FTYPE("trg_VMF")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

COMM *** Delete All the TMP files for Dups processing ***
DO AZ002_Dup_DelTmp

v_TestNo="AP001"

OPEN AP_Dups_Amt_Inv

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_Site_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

SET FILTER ABS_INVAMT_CENT <>0.00
DUPLICATES ON c_Inv_No ABS_INVAMT_CENT  Inv_Dt Vndr_ID OTHER %v_flds_AP_Inv% PRESORT OPEN TO "%fld_Tmps%TMP_AP_DUPS.FIL"

DELETE FIELD DUP_KEY OK
COMM original (before adding ~)
COMM DEFINE FIELD DUP_KEY COMPUTED SUBSTR(ZONED(ABS_INVAMT,21)+ALLTRIM(Vndr_ID)+ALLTRIM(c_Inv_No) +ALLTRIM(c_Inv_Dt),1,64)


DEFINE FIELD DUP_KEY COMPUTED SUBSTR(ZONED(ABS_INVAMT_CENT ,21)+"~"+ALLTRIM(Vndr_ID)+"~"+ALLTRIM(c_Inv_No) +"~"+ ALLTRIM(c_Inv_Dt),1,72)


DEFINE FIELD ABS_INVAMT_CENT COMPUTED 

VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21)),4) IF OCCURS(ALLTRIM(STRING(ABS(Inv_Amt),21)),".")>=0
VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21 )),4)

COMM *** Start removing reversals ***
DO AZ003_Dup_FixedUp
COMM *** End removing reversals ***

OPEN TMP_AP_DUPS_2
DELETE FIELD ABS_INVAMT_CENT OK
DEFINE FIELD ABS_INVAMT_CENT COMPUTED 

VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21)),4) IF OCCURS(ALLTRIM(STRING(ABS(Inv_Amt),21)),".")>=0
VALUE(ALLTRIM(STRING(ABS(Inv_Amt),21 )),4)

DELETE FIELD SORT_KEY OK
COMM original (before adding ~)
COMM DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ZONED(ABS_INVAMT,21)+ALLTRIM(Flag)+ALLTRIM(Vndr_ID) +ALLTRIM(c_Inv_Dt),1,64)
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ZONED(ABS_INVAMT_CENT ,21) +"~"+ ALLTRIM(Flag) +"~"+ ALLTRIM(Vndr_ID) +"~"+ ALLTRIM(c_Inv_Dt),1,64)

SORT ON SORT_KEY D TO "%fld_Tmps%AP001_TMP" IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN

COMM *** Delete All the TMP files for Dups processing ***
DO AZ002_Dup_DelTmp

SET SAFETY ON
^FORMAT   zHIST1_AP003_Dup_Amt_Dt_Inv        zHIST1_AP003_Dup_Amt_Dt_Inv      "E:\CaseWareACL_06082015\5d6d9eb0-a8d1-4ecb-a0e2-70f6daa3546f\WorkingDirectory\Results" "zHIST1_AP003_Dup_Amt_Dt_Inv.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
[LASTVIEW] "Default_View"
^FORMAT   zHIST1_AP004_Dup_Amt_Dt_Vndr       zHIST1_AP004_Dup_Amt_Dt_Vndr     "E:\CaseWareACL_06082015\5d6d9eb0-a8d1-4ecb-a0e2-70f6daa3546f\WorkingDirectory\Results" "zHIST1_AP004_Dup_Amt_Dt_Vndr.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
[LASTVIEW] "Default_View"
^FORMAT   zHIST1_AP002_Dup_Amt_Inv_Vndr      zHIST1_AP002_Dup_Amt_Inv_Vndr    "E:\CaseWareACL_06082015\5d6d9eb0-a8d1-4ecb-a0e2-70f6daa3546f\WorkingDirectory\Results" "zHIST1_AP002_Dup_Amt_Inv_Vndr.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
[LASTVIEW] "Default_View"
^REPORT   Default_View                       AP002_History                    D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Flag                 WIDTH 3 PICTURE ""
[LINE] 1
DUP_KEY              WIDTH 20 PICTURE ""
[LINE] 1
CREDIT_KEY           WIDTH 13 PICTURE ""
[LINE] 1
Vndr_Site_ID         WIDTH 8 PICTURE ""
[LINE] 1
Vndr_ID              WIDTH 5 PICTURE ""
[LINE] 1
Vchr_ID              WIDTH 6 PICTURE ""
[LINE] 1
ABS_INVAMT           WIDTH 8 PICTURE ""
[LINE] 1
isPaid               WIDTH 4 PICTURE ""
[LINE] 1
Doc_Typ              WIDTH 7 PICTURE ""
[LINE] 1
Inv_Dt               WIDTH 8 PICTURE ""
[LINE] 1
Inv_No               WIDTH 16 PICTURE ""
[LINE] 1
Inv_Amt              WIDTH 6 PICTURE ""
[LINE] 1
Inv_Amt_Doc          WIDTH 9 PICTURE ""
[LINE] 1
Curncy               WIDTH 5 PICTURE ""
[LINE] 1
Inv_Net_Amt          WIDTH 9 PICTURE ""
[LINE] 1
GST_Amt              WIDTH 6 PICTURE ""
[LINE] 1
Btch_No              WIDTH 6 PICTURE ""
[LINE] 1
Due_Dt               WIDTH 5 PICTURE ""
[LINE] 1
PO_No                WIDTH 5 PICTURE ""
[LINE] 1
PO_Net_Amt           WIDTH 8 PICTURE ""
[LINE] 1
Descrp               WIDTH 5 PICTURE ""
[LINE] 1
Pd_Dt                WIDTH 5 PICTURE ""
[LINE] 1
Pymnt_Trms           WIDTH 8 PICTURE ""
[LINE] 1
Modf_By              WIDTH 6 PICTURE ""
[LINE] 1
Modf_Dt              WIDTH 6 PICTURE ""
[LINE] 1
Pst_Dt               WIDTH 5 PICTURE ""
[LINE] 1
Ex_Rate              WIDTH 6 PICTURE ""
[LINE] 1
VOIDED               WIDTH 5 PICTURE ""
[LINE] 1
Void_Dt              WIDTH 5 PICTURE ""
[LINE] 1
Num_Field1           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field2           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field3           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field4           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field5           WIDTH 7 PICTURE ""
[LINE] 1
Dt_Field1            WIDTH 6 PICTURE ""
[LINE] 1
Dt_Field2            WIDTH 6 PICTURE ""
[LINE] 1
Dt_Field3            WIDTH 6 PICTURE ""
[LINE] 1
Cha_Field1           WIDTH 7 PICTURE ""
[LINE] 1
Cha_Field2           WIDTH 7 PICTURE ""
[LINE] 1
Cha_Field3           WIDTH 7 PICTURE ""
[LINE] 1
Cha_Field4           WIDTH 16 PICTURE ""
[LINE] 1
Cha_Field5           WIDTH 7 PICTURE ""
[LINE] 1
c_Inv_No             WIDTH 7 PICTURE ""
[LINE] 1
c_Inv_Dt             WIDTH 7 PICTURE ""
[LINE] 1
Vndr_Mstr_ID         WIDTH 9 PICTURE ""
[LINE] 1
Vndr_Nme             WIDTH 24 PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 6 PICTURE ""
[LINE] 1
Vndr_Typ             WIDTH 6 PICTURE ""
[LINE] 1
RANK                 WIDTH 4 PICTURE ""
[LINE] 1
SORT_KEY             WIDTH 43 PICTURE ""
[LINE] 1
SORT_KEY_Desc        WIDTH 33 AS "SORT_KEY_Desc" PICTURE ""
[LINE] 1
Priority             WIDTH 5 AS "Priority" PICTURE ""
[LINE] 1
RptRunDate           WIDTH 11 AS "Report Run Date" PICTURE ""
[LINE] 1
Data_Range_Start_Date WIDTH 14 AS "Data Range Start Date" PICTURE ""
[LINE] 1
Data_Range_End_Date  WIDTH 14 AS "Date Range End Date" PICTURE ""
[LINE] 1
ID_KEY               WIDTH 26 PICTURE ""
^REPORT   Default_View                       AP001_History                    D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Flag                 WIDTH 3 PICTURE ""
[LINE] 1
DUP_KEY              WIDTH 20 PICTURE ""
[LINE] 1
CREDIT_KEY           WIDTH 13 PICTURE ""
[LINE] 1
Vndr_Site_ID         WIDTH 8 PICTURE ""
[LINE] 1
Vndr_ID              WIDTH 5 PICTURE ""
[LINE] 1
Vchr_ID              WIDTH 6 PICTURE ""
[LINE] 1
ABS_INVAMT           WIDTH 8 PICTURE ""
[LINE] 1
isPaid               WIDTH 4 PICTURE ""
[LINE] 1
Doc_Typ              WIDTH 7 PICTURE ""
[LINE] 1
Inv_Dt               WIDTH 8 PICTURE ""
[LINE] 1
Inv_No               WIDTH 16 PICTURE ""
[LINE] 1
Inv_Amt              WIDTH 6 PICTURE ""
[LINE] 1
Inv_Amt_Doc          WIDTH 9 PICTURE ""
[LINE] 1
Curncy               WIDTH 5 PICTURE ""
[LINE] 1
Inv_Net_Amt          WIDTH 9 PICTURE ""
[LINE] 1
GST_Amt              WIDTH 6 PICTURE ""
[LINE] 1
Btch_No              WIDTH 6 PICTURE ""
[LINE] 1
Due_Dt               WIDTH 5 PICTURE ""
[LINE] 1
PO_No                WIDTH 5 PICTURE ""
[LINE] 1
PO_Net_Amt           WIDTH 8 PICTURE ""
[LINE] 1
Descrp               WIDTH 5 PICTURE ""
[LINE] 1
Pd_Dt                WIDTH 5 PICTURE ""
[LINE] 1
Pymnt_Trms           WIDTH 8 PICTURE ""
[LINE] 1
Modf_By              WIDTH 6 PICTURE ""
[LINE] 1
Modf_Dt              WIDTH 6 PICTURE ""
[LINE] 1
Pst_Dt               WIDTH 5 PICTURE ""
[LINE] 1
Ex_Rate              WIDTH 6 PICTURE ""
[LINE] 1
VOIDED               WIDTH 5 PICTURE ""
[LINE] 1
Void_Dt              WIDTH 5 PICTURE ""
[LINE] 1
Num_Field1           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field2           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field3           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field4           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field5           WIDTH 7 PICTURE ""
[LINE] 1
Dt_Field1            WIDTH 6 PICTURE ""
[LINE] 1
Dt_Field2            WIDTH 6 PICTURE ""
[LINE] 1
Dt_Field3            WIDTH 6 PICTURE ""
[LINE] 1
Cha_Field1           WIDTH 7 PICTURE ""
[LINE] 1
Cha_Field2           WIDTH 7 PICTURE ""
[LINE] 1
Cha_Field3           WIDTH 7 PICTURE ""
[LINE] 1
Cha_Field4           WIDTH 16 PICTURE ""
[LINE] 1
Cha_Field5           WIDTH 7 PICTURE ""
[LINE] 1
c_Inv_No             WIDTH 7 PICTURE ""
[LINE] 1
c_Inv_Dt             WIDTH 7 PICTURE ""
[LINE] 1
Vndr_Mstr_ID         WIDTH 9 PICTURE ""
[LINE] 1
Vndr_Nme             WIDTH 24 PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 6 PICTURE ""
[LINE] 1
Vndr_Typ             WIDTH 6 PICTURE ""
[LINE] 1
ABS_INVAMT_CENT      WIDTH 12 PICTURE ""
[LINE] 1
SORT_KEY             WIDTH 43 PICTURE ""
[LINE] 1
RANK                 WIDTH 33 PICTURE ""
[LINE] 1
ID_KEY               WIDTH 5 PICTURE ""
^REPORT   Default_View                       AP003_History                    D.T,
[SKIP] 0
[TLINES] 0
[RLINES] 1
[LINE] 1
Flag                 WIDTH 4 PICTURE ""
[LINE] 1
DUP_KEY              PICTURE ""
[LINE] 1
CREDIT_KEY           PICTURE ""
[LINE] 1
Vndr_Site_ID         PICTURE ""
[LINE] 1
Vndr_ID              PICTURE ""
[LINE] 1
Vchr_ID              PICTURE ""
[LINE] 1
ABS_INVAMT           PICTURE ""
[LINE] 1
isPaid               WIDTH 6 PICTURE ""
[LINE] 1
Doc_Typ              PICTURE ""
[LINE] 1
Inv_Dt               PICTURE ""
[LINE] 1
Inv_No               PICTURE ""
[LINE] 1
Inv_Amt              PICTURE ""
[LINE] 1
Inv_Amt_Doc          PICTURE ""
[LINE] 1
Curncy               PICTURE ""
[LINE] 1
Inv_Net_Amt          PICTURE ""
[LINE] 1
GST_Amt              PICTURE ""
[LINE] 1
Btch_No              PICTURE ""
[LINE] 1
Due_Dt               PICTURE ""
[LINE] 1
PO_No                PICTURE ""
[LINE] 1
PO_Net_Amt           PICTURE ""
[LINE] 1
Descrp               PICTURE ""
[LINE] 1
Pd_Dt                PICTURE ""
[LINE] 1
Pymnt_Trms           PICTURE ""
[LINE] 1
Modf_By              PICTURE ""
[LINE] 1
Modf_Dt              PICTURE ""
[LINE] 1
Pst_Dt               PICTURE ""
[LINE] 1
Ex_Rate              PICTURE ""
[LINE] 1
VOIDED               WIDTH 6 PICTURE ""
[LINE] 1
Void_Dt              PICTURE ""
[LINE] 1
Num_Field1           PICTURE ""
[LINE] 1
Num_Field2           PICTURE ""
[LINE] 1
Num_Field3           PICTURE ""
[LINE] 1
Num_Field4           PICTURE ""
[LINE] 1
Num_Field5           PICTURE ""
[LINE] 1
Dt_Field1            PICTURE ""
[LINE] 1
Dt_Field2            PICTURE ""
[LINE] 1
Dt_Field3            PICTURE ""
[LINE] 1
Cha_Field1           PICTURE ""
[LINE] 1
Cha_Field2           PICTURE ""
[LINE] 1
Cha_Field3           PICTURE ""
[LINE] 1
Cha_Field4           PICTURE ""
[LINE] 1
Cha_Field5           PICTURE ""
[LINE] 1
c_Inv_No             PICTURE ""
[LINE] 1
c_Inv_Dt             PICTURE ""
[LINE] 1
Vndr_Mstr_ID         PICTURE ""
[LINE] 1
Vndr_Nme             PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 8 PICTURE ""
[LINE] 1
Vndr_Typ             PICTURE ""
[LINE] 1
RANK                 WIDTH 4 PICTURE ""
[LINE] 1
SORT_KEY             PICTURE ""
[LINE] 1
SORT_KEY_Desc        PICTURE ""
[LINE] 1
Priority             WIDTH 8 PICTURE ""
[LINE] 1
RptRunDate           PICTURE ""
[LINE] 1
Data_Range_Start_Date PICTURE ""
[LINE] 1
Data_Range_End_Date  PICTURE ""
[LINE] 1
ID_KEY               PICTURE ""
^REPORT   Default_View                       AP006_History                    D.T,
[SKIP] 0
[TLINES] 0
[RLINES] 1
[LINE] 1
Vchr_ID              PICTURE ""
[LINE] 1
Vndr_Site_ID         PICTURE ""
[LINE] 1
Vndr_ID              PICTURE ""
[LINE] 1
Doc_Typ              PICTURE ""
[LINE] 1
Inv_Dt               PICTURE ""
[LINE] 1
Inv_No               PICTURE ""
[LINE] 1
Inv_Amt              PICTURE ""
[LINE] 1
Inv_Amt_Doc          PICTURE ""
[LINE] 1
Curncy               PICTURE ""
[LINE] 1
Ex_Rate              PICTURE ""
[LINE] 1
Inv_Net_Amt          PICTURE ""
[LINE] 1
GST_Amt              PICTURE ""
[LINE] 1
Btch_No              PICTURE ""
[LINE] 1
Due_Dt               PICTURE ""
[LINE] 1
PO_No                PICTURE ""
[LINE] 1
PO_Net_Amt           PICTURE ""
[LINE] 1
Descrp               PICTURE ""
[LINE] 1
Pd_Dt                PICTURE ""
[LINE] 1
Pymnt_Trms           PICTURE ""
[LINE] 1
Modf_Dt              PICTURE ""
[LINE] 1
Modf_By              PICTURE ""
[LINE] 1
Pst_Dt               PICTURE ""
[LINE] 1
VOIDED               WIDTH 6 PICTURE ""
[LINE] 1
Void_Dt              PICTURE ""
[LINE] 1
isPaid               WIDTH 6 PICTURE ""
[LINE] 1
Num_Field1           PICTURE ""
[LINE] 1
Num_Field2           PICTURE ""
[LINE] 1
Num_Field3           PICTURE ""
[LINE] 1
Num_Field4           PICTURE ""
[LINE] 1
Num_Field5           PICTURE ""
[LINE] 1
Dt_Field1            PICTURE ""
[LINE] 1
Dt_Field2            PICTURE ""
[LINE] 1
Dt_Field3            PICTURE ""
[LINE] 1
Cha_Field1           PICTURE ""
[LINE] 1
Cha_Field2           PICTURE ""
[LINE] 1
Cha_Field3           PICTURE ""
[LINE] 1
Cha_Field4           PICTURE ""
[LINE] 1
Cha_Field5           PICTURE ""
[LINE] 1
c_Inv_No2            PICTURE ""
[LINE] 1
c_Inv_No             PICTURE ""
[LINE] 1
ABS_INVAMT           PICTURE ""
[LINE] 1
ABS_INVAMT_CENT      PICTURE ""
[LINE] 1
c_Inv_Dt             PICTURE ""
[LINE] 1
Vndr_Mstr_ID         PICTURE ""
[LINE] 1
Vndr_Nme             PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 8 PICTURE ""
[LINE] 1
Vndr_Typ             PICTURE ""
[LINE] 1
ID_KEY               PICTURE ""
^REPORT   Default_View                       AP014_History                    D.T,
[SKIP] 0
[TLINES] 0
[RLINES] 1
[LINE] 1
Vndr_Site_ID         PICTURE ""
[LINE] 1
Co                   PICTURE ""
[LINE] 1
Vndr_ID              PICTURE ""
[LINE] 1
Vndr_Nme             PICTURE ""
[LINE] 1
ABN                  PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 8 PICTURE ""
[LINE] 1
Vndr_Typ             PICTURE ""
[LINE] 1
Vndr_Add_Typ         PICTURE ""
[LINE] 1
ADD1                 PICTURE ""
[LINE] 1
ADD2                 PICTURE ""
[LINE] 1
ADD3                 PICTURE ""
[LINE] 1
City                 PICTURE ""
[LINE] 1
State                PICTURE ""
[LINE] 1
Pcode                PICTURE ""
[LINE] 1
Cntry                PICTURE ""
[LINE] 1
TEL1                 PICTURE ""
[LINE] 1
TEL2                 PICTURE ""
[LINE] 1
TEL3                 PICTURE ""
[LINE] 1
FAX                  PICTURE ""
[LINE] 1
Email1               PICTURE ""
[LINE] 1
Email2               PICTURE ""
[LINE] 1
Pymnt_Trm            PICTURE ""
[LINE] 1
Created_Dt           PICTURE ""
[LINE] 1
Modf_Dt              PICTURE ""
[LINE] 1
Vndr_InvlDt          PICTURE ""
[LINE] 1
Cha_Field1           PICTURE ""
[LINE] 1
Cha_Field2           PICTURE ""
[LINE] 1
Cha_Field3           WIDTH 10 PICTURE ""
[LINE] 1
Cha_Field4           PICTURE ""
[LINE] 1
Cha_Field5           PICTURE ""
[LINE] 1
Num_Field1           PICTURE ""
[LINE] 1
Num_Field2           PICTURE ""
[LINE] 1
Num_Field3           PICTURE ""
[LINE] 1
Num_Field4           PICTURE ""
[LINE] 1
Num_Field5           PICTURE ""
[LINE] 1
Dt_Field1            PICTURE ""
[LINE] 1
Dt_Field2            PICTURE ""
[LINE] 1
Dt_Field3            PICTURE ""
[LINE] 1
ABN_CLN              PICTURE ""
[LINE] 1
Max_Inv_Dt           PICTURE ""
[LINE] 1
c_Vndr_ID            PICTURE ""
[LINE] 1
ID_KEY               PICTURE ""
^INDEX    ACLQSTMP31                         AP004_History                    "" "ACLQSTMP31.INX" 
*INDEX ON INV_DT D TO "ACLQSTMP31"
^REPORT   Default_View                       AP004_History                    D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Flag                 WIDTH 3 PICTURE ""
[LINE] 1
DUP_KEY              WIDTH 16 PICTURE ""
[LINE] 1
CREDIT_KEY           WIDTH 9 PICTURE ""
[LINE] 1
Vndr_Site_ID         WIDTH 8 PICTURE ""
[LINE] 1
Vndr_ID              WIDTH 5 PICTURE ""
[LINE] 1
Vchr_ID              WIDTH 6 PICTURE ""
[LINE] 1
ABS_INVAMT           WIDTH 8 PICTURE ""
[LINE] 1
isPaid               WIDTH 4 PICTURE ""
[LINE] 1
Doc_Typ              WIDTH 6 PICTURE ""
[LINE] 1
Inv_Dt               WIDTH 8 PICTURE ""
[LINE] 1
Inv_No               WIDTH 8 PICTURE ""
[LINE] 1
Inv_Amt              WIDTH 6 PICTURE ""
[LINE] 1
Inv_Amt_Doc          WIDTH 9 PICTURE ""
[LINE] 1
Curncy               WIDTH 5 PICTURE ""
[LINE] 1
Inv_Net_Amt          WIDTH 9 PICTURE ""
[LINE] 1
GST_Amt              WIDTH 6 PICTURE ""
[LINE] 1
Btch_No              WIDTH 6 PICTURE ""
[LINE] 1
Due_Dt               WIDTH 5 PICTURE ""
[LINE] 1
PO_No                WIDTH 5 PICTURE ""
[LINE] 1
PO_Net_Amt           WIDTH 8 PICTURE ""
[LINE] 1
Descrp               WIDTH 5 PICTURE ""
[LINE] 1
Pd_Dt                WIDTH 5 PICTURE ""
[LINE] 1
Pymnt_Trms           WIDTH 8 PICTURE ""
[LINE] 1
Modf_By              WIDTH 6 PICTURE ""
[LINE] 1
Modf_Dt              WIDTH 6 PICTURE ""
[LINE] 1
Pst_Dt               WIDTH 5 PICTURE ""
[LINE] 1
Ex_Rate              WIDTH 6 PICTURE ""
[LINE] 1
VOIDED               WIDTH 5 PICTURE ""
[LINE] 1
Void_Dt              WIDTH 5 PICTURE ""
[LINE] 1
Num_Field1           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field2           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field3           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field4           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field5           WIDTH 7 PICTURE ""
[LINE] 1
Dt_Field1            WIDTH 6 PICTURE ""
[LINE] 1
Dt_Field2            WIDTH 6 PICTURE ""
[LINE] 1
Dt_Field3            WIDTH 6 PICTURE ""
[LINE] 1
Cha_Field1           WIDTH 7 PICTURE ""
[LINE] 1
Cha_Field2           WIDTH 7 PICTURE ""
[LINE] 1
Cha_Field3           WIDTH 7 PICTURE ""
[LINE] 1
Cha_Field4           WIDTH 7 PICTURE ""
[LINE] 1
Cha_Field5           WIDTH 7 PICTURE ""
[LINE] 1
c_Inv_No             WIDTH 8 PICTURE ""
[LINE] 1
c_Inv_Dt             WIDTH 7 PICTURE ""
[LINE] 1
Vndr_Mstr_ID         WIDTH 9 PICTURE ""
[LINE] 1
Vndr_Nme             WIDTH 21 PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 6 PICTURE ""
[LINE] 1
Vndr_Typ             WIDTH 6 PICTURE ""
[LINE] 1
RANK                 WIDTH 4 PICTURE ""
[LINE] 1
SORT_KEY             WIDTH 39 PICTURE ""
[LINE] 1
SORT_KEY_Desc        WIDTH 33 PICTURE ""
[LINE] 1
Priority             WIDTH 5 PICTURE ""
[LINE] 1
RptRunDate           WIDTH 11 PICTURE ""
[LINE] 1
Data_Range_Start_Date WIDTH 14 PICTURE ""
[LINE] 1
Data_Range_End_Date  WIDTH 14 PICTURE ""
[LINE] 1
ID_KEY               WIDTH 22 PICTURE ""
^INDEX    ACLQSTMP32                         AP001_History                    "" "ACLQSTMP32.INX" 
*INDEX ON INV_DT D TO "ACLQSTMP32"
^INDEX    ACLQSTMP50                         AP001_History                    "" "ACLQSTMP50.INX" 
*INDEX ON INV_DT D TO "ACLQSTMP50"
^INDEX    ACLQSTMP53                         AP001_History                    "" "ACLQSTMP53.INX" 
*INDEX ON INV_DT D TO "ACLQSTMP53"
^INDEX    ACLQSTMP54                         AP002_History                    "" "ACLQSTMP54.INX" 
*INDEX ON INV_DT D TO "ACLQSTMP54"
^INDEX    ACLQSTMP55                         AP003_History                    "" "ACLQSTMP55.INX" 
*INDEX ON INV_DT D TO "ACLQSTMP55"
^INDEX    ACLQSTMP56                         AP004_History                    "" "ACLQSTMP56.INX" 
*INDEX ON INV_DT D TO "ACLQSTMP56"
^FORMAT   zHIST1_AP001_Dup_Amt_Dt_Inv_Vnd    zHIST1_AP001_Dup_Amt_Dt_Inv_Vnd  "E:\CaseWareACL_06082015\5d6d9eb0-a8d1-4ecb-a0e2-70f6daa3546f\WorkingDirectory\Results" "zHIST1_AP001_Dup_Amt_Dt_Inv_Vndr.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
[LASTVIEW] "Default_View"
^REPORT   Default_View                       zHIST1_AP001_Dup_Amt_Dt_Inv_Vnd  D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Flag                 WIDTH 3 PICTURE ""
[LINE] 1
VMF_Vnd_Master_File.Cha_Field1 AS "Cha_Field1" PICTURE ""
[LINE] 1
VMF_Vnd_Master_File.Cha_Field4 AS "Cha_Field4" PICTURE ""
[LINE] 1
DUP_KEY              WIDTH 37 PICTURE ""
[LINE] 1
CREDIT_KEY           WIDTH 13 PICTURE ""
[LINE] 1
Vndr_Site_ID         WIDTH 10 PICTURE ""
[LINE] 1
Vndr_ID              WIDTH 5 PICTURE ""
[LINE] 1
Vchr_ID              WIDTH 6 PICTURE ""
[LINE] 1
ABS_INVAMT           WIDTH 8 PICTURE ""
[LINE] 1
isPaid               WIDTH 4 PICTURE ""
[LINE] 1
Doc_Typ              WIDTH 8 PICTURE ""
[LINE] 1
Inv_Dt               WIDTH 8 PICTURE ""
[LINE] 1
Inv_No               WIDTH 15 PICTURE ""
[LINE] 1
Inv_Amt              WIDTH 7 PICTURE ""
[LINE] 1
Inv_Amt_Doc          WIDTH 9 PICTURE ""
[LINE] 1
Curncy               WIDTH 5 PICTURE ""
[LINE] 1
Inv_Net_Amt          WIDTH 9 PICTURE ""
[LINE] 1
GST_Amt              WIDTH 6 PICTURE ""
[LINE] 1
Btch_No              WIDTH 6 PICTURE ""
[LINE] 1
Due_Dt               WIDTH 5 PICTURE ""
[LINE] 1
PO_No                WIDTH 5 PICTURE ""
[LINE] 1
PO_Net_Amt           WIDTH 8 PICTURE ""
[LINE] 1
Descrp               WIDTH 5 PICTURE ""
[LINE] 1
Pd_Dt                WIDTH 5 PICTURE ""
[LINE] 1
Pymnt_Trms           WIDTH 8 PICTURE ""
[LINE] 1
Modf_By              WIDTH 6 PICTURE ""
[LINE] 1
Modf_Dt              WIDTH 6 PICTURE ""
[LINE] 1
Pst_Dt               WIDTH 5 PICTURE ""
[LINE] 1
Ex_Rate              WIDTH 6 PICTURE ""
[LINE] 1
VOIDED               WIDTH 5 PICTURE ""
[LINE] 1
Void_Dt              WIDTH 5 PICTURE ""
[LINE] 1
Num_Field1           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field2           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field3           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field4           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field5           WIDTH 7 PICTURE ""
[LINE] 1
Dt_Field1            WIDTH 6 PICTURE ""
[LINE] 1
Dt_Field2            WIDTH 6 PICTURE ""
[LINE] 1
Dt_Field3            WIDTH 6 PICTURE ""
[LINE] 1
Cha_Field1           WIDTH 7 PICTURE ""
[LINE] 1
Cha_Field2           WIDTH 7 PICTURE ""
[LINE] 1
Cha_Field3           WIDTH 7 PICTURE ""
[LINE] 1
Cha_Field4           WIDTH 16 PICTURE ""
[LINE] 1
Cha_Field5           WIDTH 7 PICTURE ""
[LINE] 1
c_Inv_No             WIDTH 9 PICTURE ""
[LINE] 1
c_Inv_Dt             WIDTH 7 PICTURE ""
[LINE] 1
Vndr_Mstr_ID         WIDTH 9 PICTURE ""
[LINE] 1
Vndr_Nme             WIDTH 34 PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 6 PICTURE ""
[LINE] 1
Vndr_Typ             WIDTH 8 PICTURE ""
[LINE] 1
ABS_INVAMT_CENT      WIDTH 12 PICTURE ""
[LINE] 1
RANK                 WIDTH 4 PICTURE ""
[LINE] 1
ID_KEY               WIDTH 44 PICTURE ""
[LINE] 1
SORT_KEY             WIDTH 63 PICTURE ""
[LINE] 1
SORT_KEY_Desc        WIDTH 33 PICTURE ""
[LINE] 1
Priority             WIDTH 5 PICTURE ""
[LINE] 1
RptRunDate           WIDTH 11 PICTURE ""
[LINE] 1
Data_Range_Start_Date WIDTH 14 PICTURE ""
[LINE] 1
Data_Range_End_Date  WIDTH 14 PICTURE ""
[LINE] 1
TEST_NAME            WIDTH 36 PICTURE ""
[LINE] 1
c_QUOTED_INV_ID      WIDTH 16 PICTURE ""
^REPORT   Default_View                       zHIST1_AP002_Dup_Amt_Inv_Vndr    D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Flag                 WIDTH 3 PICTURE ""
[LINE] 1
VMF_Vnd_Master_File.Cha_Field1 AS "Cha_Field1" PICTURE ""
[LINE] 1
VMF_Vnd_Master_File.Cha_Field4 AS "Cha_Field4" PICTURE ""
[LINE] 1
DUP_KEY              WIDTH 37 PICTURE ""
[LINE] 1
CREDIT_KEY           WIDTH 13 PICTURE ""
[LINE] 1
Vndr_Site_ID         WIDTH 8 PICTURE ""
[LINE] 1
Vndr_ID              WIDTH 5 PICTURE ""
[LINE] 1
Vchr_ID              WIDTH 6 PICTURE ""
[LINE] 1
ABS_INVAMT           WIDTH 8 PICTURE ""
[LINE] 1
isPaid               WIDTH 4 PICTURE ""
[LINE] 1
Doc_Typ              WIDTH 8 PICTURE ""
[LINE] 1
Inv_Dt               WIDTH 8 PICTURE ""
[LINE] 1
Inv_No               WIDTH 15 PICTURE ""
[LINE] 1
Inv_Amt              WIDTH 7 PICTURE ""
[LINE] 1
Inv_Amt_Doc          WIDTH 9 PICTURE ""
[LINE] 1
Curncy               WIDTH 5 PICTURE ""
[LINE] 1
Inv_Net_Amt          WIDTH 9 PICTURE ""
[LINE] 1
GST_Amt              WIDTH 6 PICTURE ""
[LINE] 1
Btch_No              WIDTH 6 PICTURE ""
[LINE] 1
Due_Dt               WIDTH 5 PICTURE ""
[LINE] 1
PO_No                WIDTH 5 PICTURE ""
[LINE] 1
PO_Net_Amt           WIDTH 8 PICTURE ""
[LINE] 1
Descrp               WIDTH 5 PICTURE ""
[LINE] 1
Pd_Dt                WIDTH 5 PICTURE ""
[LINE] 1
Pymnt_Trms           WIDTH 8 PICTURE ""
[LINE] 1
Modf_By              WIDTH 6 PICTURE ""
[LINE] 1
Modf_Dt              WIDTH 6 PICTURE ""
[LINE] 1
Pst_Dt               WIDTH 5 PICTURE ""
[LINE] 1
Ex_Rate              WIDTH 6 PICTURE ""
[LINE] 1
VOIDED               WIDTH 5 PICTURE ""
[LINE] 1
Void_Dt              WIDTH 5 PICTURE ""
[LINE] 1
Num_Field1           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field2           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field3           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field4           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field5           WIDTH 7 PICTURE ""
[LINE] 1
Dt_Field1            WIDTH 6 PICTURE ""
[LINE] 1
Dt_Field2            WIDTH 6 PICTURE ""
[LINE] 1
Dt_Field3            WIDTH 6 PICTURE ""
[LINE] 1
Cha_Field1           WIDTH 7 PICTURE ""
[LINE] 1
Cha_Field2           WIDTH 7 PICTURE ""
[LINE] 1
Cha_Field3           WIDTH 7 PICTURE ""
[LINE] 1
Cha_Field4           WIDTH 16 PICTURE ""
[LINE] 1
Cha_Field5           WIDTH 7 PICTURE ""
[LINE] 1
c_Inv_No             WIDTH 9 PICTURE ""
[LINE] 1
c_Inv_Dt             WIDTH 7 PICTURE ""
[LINE] 1
Vndr_Mstr_ID         WIDTH 9 PICTURE ""
[LINE] 1
Vndr_Nme             WIDTH 34 PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 6 PICTURE ""
[LINE] 1
Vndr_Typ             WIDTH 8 PICTURE ""
[LINE] 1
RANK                 WIDTH 8 PICTURE ""
[LINE] 1
SORT_KEY             WIDTH 7 PICTURE ""
[LINE] 1
SORT_KEY_Desc        WIDTH 44 PICTURE ""
[LINE] 1
Priority             WIDTH 63 PICTURE ""
[LINE] 1
RptRunDate           WIDTH 33 PICTURE ""
[LINE] 1
Data_Range_Start_Date WIDTH 14 PICTURE ""
[LINE] 1
Data_Range_End_Date  WIDTH 14 PICTURE ""
[LINE] 1
ID_KEY               WIDTH 8 PICTURE ""
[LINE] 1
TEST_NAME            WIDTH 8 PICTURE ""
[LINE] 1
c_QUOTED_INV_ID      WIDTH 36 PICTURE ""
^REPORT   Default_View                       zHIST1_AP003_Dup_Amt_Dt_Inv      D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Flag                 WIDTH 3 PICTURE ""
[LINE] 1
VMF_Vnd_Master_File.Cha_Field1 AS "Cha_Field1" PICTURE ""
[LINE] 1
VMF_Vnd_Master_File.Cha_Field4 AS "Cha_Field4" PICTURE ""
[LINE] 1
DUP_KEY              WIDTH 21 PICTURE ""
[LINE] 1
CREDIT_KEY           WIDTH 13 PICTURE ""
[LINE] 1
Vndr_Site_ID         WIDTH 8 PICTURE ""
[LINE] 1
Vndr_ID              WIDTH 5 PICTURE ""
[LINE] 1
Vchr_ID              WIDTH 6 PICTURE ""
[LINE] 1
ABS_INVAMT           WIDTH 8 PICTURE ""
[LINE] 1
isPaid               WIDTH 4 PICTURE ""
[LINE] 1
Doc_Typ              WIDTH 7 PICTURE ""
[LINE] 1
Inv_Dt               WIDTH 8 PICTURE ""
[LINE] 1
Inv_No               WIDTH 13 PICTURE ""
[LINE] 1
Inv_Amt              WIDTH 7 PICTURE ""
[LINE] 1
Inv_Amt_Doc          WIDTH 9 PICTURE ""
[LINE] 1
Curncy               WIDTH 5 PICTURE ""
[LINE] 1
Inv_Net_Amt          WIDTH 9 PICTURE ""
[LINE] 1
GST_Amt              WIDTH 6 PICTURE ""
[LINE] 1
Btch_No              WIDTH 6 PICTURE ""
[LINE] 1
Due_Dt               WIDTH 5 PICTURE ""
[LINE] 1
PO_No                WIDTH 5 PICTURE ""
[LINE] 1
PO_Net_Amt           WIDTH 8 PICTURE ""
[LINE] 1
Descrp               WIDTH 5 PICTURE ""
[LINE] 1
Pd_Dt                WIDTH 5 PICTURE ""
[LINE] 1
Pymnt_Trms           WIDTH 8 PICTURE ""
[LINE] 1
Modf_By              WIDTH 6 PICTURE ""
[LINE] 1
Modf_Dt              WIDTH 6 PICTURE ""
[LINE] 1
Pst_Dt               WIDTH 5 PICTURE ""
[LINE] 1
Ex_Rate              WIDTH 6 PICTURE ""
[LINE] 1
VOIDED               WIDTH 5 PICTURE ""
[LINE] 1
Void_Dt              WIDTH 5 PICTURE ""
[LINE] 1
Num_Field1           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field2           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field3           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field4           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field5           WIDTH 7 PICTURE ""
[LINE] 1
Dt_Field1            WIDTH 6 PICTURE ""
[LINE] 1
Dt_Field2            WIDTH 6 PICTURE ""
[LINE] 1
Dt_Field3            WIDTH 6 PICTURE ""
[LINE] 1
Cha_Field1           WIDTH 7 PICTURE ""
[LINE] 1
Cha_Field2           WIDTH 7 PICTURE ""
[LINE] 1
Cha_Field3           WIDTH 7 PICTURE ""
[LINE] 1
Cha_Field4           WIDTH 16 PICTURE ""
[LINE] 1
Cha_Field5           WIDTH 7 PICTURE ""
[LINE] 1
c_Inv_No             WIDTH 7 PICTURE ""
[LINE] 1
c_Inv_Dt             WIDTH 7 PICTURE ""
[LINE] 1
Vndr_Mstr_ID         WIDTH 9 PICTURE ""
[LINE] 1
Vndr_Nme             WIDTH 29 PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 6 PICTURE ""
[LINE] 1
Vndr_Typ             WIDTH 8 PICTURE ""
[LINE] 1
RANK                 WIDTH 4 PICTURE ""
[LINE] 1
SORT_KEY             WIDTH 45 PICTURE ""
[LINE] 1
SORT_KEY_Desc        WIDTH 33 PICTURE ""
[LINE] 1
Priority             WIDTH 5 PICTURE ""
[LINE] 1
RptRunDate           WIDTH 11 PICTURE ""
[LINE] 1
Data_Range_Start_Date WIDTH 14 PICTURE ""
[LINE] 1
Data_Range_End_Date  WIDTH 14 PICTURE ""
[LINE] 1
ID_KEY               WIDTH 27 PICTURE ""
[LINE] 1
TEST_NAME            WIDTH 40 PICTURE ""
[LINE] 1
c_QUOTED_INV_ID      WIDTH 13 PICTURE ""
^REPORT   Default_View                       zHIST1_AP004_Dup_Amt_Dt_Vndr     D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Flag                 WIDTH 3 PICTURE ""
[LINE] 1
VMF_Vnd_Master_File.Cha_Field1 PICTURE ""
[LINE] 1
VMF_Vnd_Master_File.Cha_Field4 PICTURE ""
[LINE] 1
DUP_KEY              WIDTH 26 PICTURE ""
[LINE] 1
CREDIT_KEY           WIDTH 14 PICTURE ""
[LINE] 1
Vndr_Site_ID         WIDTH 8 PICTURE ""
[LINE] 1
Vndr_ID              WIDTH 5 PICTURE ""
[LINE] 1
Vchr_ID              WIDTH 6 PICTURE ""
[LINE] 1
ABS_INVAMT           WIDTH 8 PICTURE ""
[LINE] 1
isPaid               WIDTH 4 PICTURE ""
[LINE] 1
Doc_Typ              WIDTH 8 PICTURE ""
[LINE] 1
Inv_Dt               WIDTH 8 PICTURE ""
[LINE] 1
Inv_No               WIDTH 24 PICTURE ""
[LINE] 1
Inv_Amt              WIDTH 7 PICTURE ""
[LINE] 1
Inv_Amt_Doc          WIDTH 9 PICTURE ""
[LINE] 1
Curncy               WIDTH 5 PICTURE ""
[LINE] 1
Inv_Net_Amt          WIDTH 9 PICTURE ""
[LINE] 1
GST_Amt              WIDTH 6 PICTURE ""
[LINE] 1
Btch_No              WIDTH 6 PICTURE ""
[LINE] 1
Due_Dt               WIDTH 5 PICTURE ""
[LINE] 1
PO_No                WIDTH 5 PICTURE ""
[LINE] 1
PO_Net_Amt           WIDTH 8 PICTURE ""
[LINE] 1
Descrp               WIDTH 5 PICTURE ""
[LINE] 1
Pd_Dt                WIDTH 5 PICTURE ""
[LINE] 1
Pymnt_Trms           WIDTH 8 PICTURE ""
[LINE] 1
Modf_By              WIDTH 6 PICTURE ""
[LINE] 1
Modf_Dt              WIDTH 6 PICTURE ""
[LINE] 1
Pst_Dt               WIDTH 5 PICTURE ""
[LINE] 1
Ex_Rate              WIDTH 6 PICTURE ""
[LINE] 1
VOIDED               WIDTH 5 PICTURE ""
[LINE] 1
Void_Dt              WIDTH 5 PICTURE ""
[LINE] 1
Num_Field1           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field2           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field3           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field4           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field5           WIDTH 7 PICTURE ""
[LINE] 1
Dt_Field1            WIDTH 6 PICTURE ""
[LINE] 1
Dt_Field2            WIDTH 6 PICTURE ""
[LINE] 1
Dt_Field3            WIDTH 6 PICTURE ""
[LINE] 1
Cha_Field1           WIDTH 7 PICTURE ""
[LINE] 1
Cha_Field2           WIDTH 7 PICTURE ""
[LINE] 1
Cha_Field3           WIDTH 7 PICTURE ""
[LINE] 1
Cha_Field4           WIDTH 15 PICTURE ""
[LINE] 1
Cha_Field5           WIDTH 7 PICTURE ""
[LINE] 1
c_Inv_No             WIDTH 10 PICTURE ""
[LINE] 1
c_Inv_Dt             WIDTH 7 PICTURE ""
[LINE] 1
Vndr_Mstr_ID         WIDTH 9 PICTURE ""
[LINE] 1
Vndr_Nme             WIDTH 45 PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 6 PICTURE ""
[LINE] 1
Vndr_Typ             WIDTH 6 PICTURE ""
[LINE] 1
RANK                 WIDTH 4 PICTURE ""
[LINE] 1
SORT_KEY_Desc        WIDTH 49 PICTURE ""
[LINE] 1
RptRunDate           WIDTH 33 PICTURE ""
[LINE] 1
Data_Range_Start_Date WIDTH 14 PICTURE ""
[LINE] 1
Data_Range_End_Date  WIDTH 14 PICTURE ""
[LINE] 1
ID_KEY               WIDTH 8 PICTURE ""
[LINE] 1
TEST_NAME            WIDTH 8 PICTURE ""
[LINE] 1
ABS_INVAMT_CENT      WIDTH 32 PICTURE ""
[LINE] 1
SORT_KEY             WIDTH 40 PICTURE ""
[LINE] 1
Priority             WIDTH 25 PICTURE ""
[LINE] 1
c_QUOTED_INV_ID      WIDTH 12 PICTURE ""
^BATCH    UU001_Exp_AP_HIST                  
[PARENT_FOLDER_ID] 1430796679
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Export Test Results into spesfic file format (e.g. Access, Excel, Text, Del and XML)
COMM *** Called by UA001_Export_Menu
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("TXT_Exp_filepath")="U" DO AA002_Variable_Setting
IF ISBLANK(TXT_Exp_filepath) TXT_Exp_filepath="Reports\"
IF LAST(ALLTRIM(TXT_Exp_filepath),1)<>"\" TXT_Exp_filepath=ALLTRIM(TXT_Exp_filepath)+"\"
IF FTYPE("TXT_AP014_Months")="U" DO AC002_Test_Var_Input

SET SAFETY OFF
SET ECHO ON

COMM For delimited files, define the separator and the qualifier on this line: IF (rad1=4) v_fileOpt       = "KEEPTITLE SEPARATOR TAB QUALIFIER ''"

IF (rad1=1) v_exporttype    = "ACCESS"
IF (rad1=1) v_fileext       = "MDB"
IF (rad1=1) v_fileOpt       = ""
IF (rad1=2) v_exporttype    = "EXCEL"
IF (rad1=2) v_fileext       = ""
IF (rad1=2) v_fileOpt       = ""
IF (rad1=3) v_exporttype    = "ASCII"
IF (rad1=3) v_fileext       = ""
IF (rad1=3) v_fileOpt       = "KEEPTITLE"
IF (rad1=4) v_exporttype    = "DELIMITED"
IF (rad1=4) v_fileext       = "DEL"
IF (rad1=4) v_fileOpt       = "KEEPTITLE SEPARATOR TAB"
IF (rad1=5) v_exporttype    = "XML"
IF (rad1=5) v_fileext       = "XML"
IF (rad1=5) v_fileOpt       = ""
IF (rad1=6) v_exporttype    = ""  
IF (rad1=6) v_fileext       = ""
IF (rad1=6) v_fileOpt       = ""
IF (rad1=6) v_EXPORT       = "EXTRACT"
IF (rad1<>6) v_EXPORT       = "EXPORT"
IF (rad1=6) v_Pre       = "RP_"
IF (rad1<>6) v_Pre       = ""
IF (rad1=6) SET FOLDER /%fld_Reports%
IF (rad1<>6) SET FOLDER /%fld_Tmps%

v_cmt="COMMENT"
v_if=""
IF rad1=5 AND v_AppCWM="" v_cmt=""
IF rad1=5 AND v_AppCWM="" v_if=" AND COUNT1>0 "

COMM *** Alvin's note: need to change Data Range Start and End Dates for all VM tests
COMM *** Vendor Master File Tests Output***
v_Exp_Fields_VM001 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' VMF_BnkAcc.BSB AS 'BSB' VMF_BnkAcc.Bnk_Acc_Num AS 'Bnk_Acc_Num' VMF_BnkAcc.Bnk_Acc_Name AS 'Bank Account Name' VMF_BnkAcc.Dt_Field1 VMF_BnkAcc.Dt_Field2 AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM001 = " Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' BSB Bnk_Acc_Num AS 'Bank Account Number' Bnk_Acc_Name AS 'Bank Account Name' VMF_BnkAcc.Dt_Field1 AS 'Start_Date' VMF_BnkAcc.Dt_Field2 AS 'End_Date' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date' Cha_Field2 AS 'Gst Registration Status' TEL1 AS 'Phone' FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System' TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_VM002 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM002= "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN Vndr_Sts AS 'Vendor Status' Vndr_Typ AS 'Vendor Type' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date'  TEL1 AS 'Phone'  FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System' TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_VM003 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM003 = "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status'  ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' TEL1 AS 'Phone'  FAX AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date' Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System'  TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_VM004 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' TEL1 AS 'Phone' FAX AS 'Fax' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM004 = "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status'  TEL1 AS 'Phone'  FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode Cntry AS 'Country'  AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System' TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_VM005 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM005 = "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date'  TEL1 AS 'Phone' FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System'  TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

COMM *** Missing Details ABN/Address/Tel ***
v_Exp_Fields_VM006 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN Cha_Field2 AS 'GST Status' Vndr_Typ AS 'Vendor Type' Pymnt_Trm  AS 'Payment Method' VMF_BnkAcc.BSB VMF_BnkAcc.Bnk_Acc_Num AS 'Bank Account Number' VMF_BnkAcc.Bnk_Acc_Name AS 'Bank Account Name' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM006 = "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN AS 'ABN' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Inv_Amt AS 'Total Invoice Amount' GST_AMT AS 'Total GST Amount' COUNT AS 'Total Trans Num'  DATE(Max_Inv_Dt) AS 'Last Invoice Date' TEL1 AS 'Phone' FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode Cntry AS 'Country'  Pymnt_Trm AS 'Payment Method' Co AS 'Company' DATE(Modf_Dt) AS 'Modified Date' Priority Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System'  TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"

COMM *** Missing Details ABN/Address/Tel Invoice Details***

v_Exp_Fields_VM006D = "VM006_Mis_Details.Cha_Field1 AS 'Vendor Site'  VM006_Mis_Details.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status'  ' '+ Inv_No AS 'Invoice Number' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Doc_Typ AS 'Document Type' Descrp AS 'Description'   isPaid AS 'Paid' Vchr_ID AS 'Voucher Number' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM *** Invalid ABN Format ***
v_Exp_Fields_VM007 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM007 = "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN AS 'ABN' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Inv_Amt AS 'Total Invoice Amount' GST_AMT AS 'Total GST Amount' COUNT AS 'Total Trans Num'  DATE(Max_Inv_Dt) AS 'Last Invoice Date' TEL1 AS 'Phone' FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode Cntry AS 'Country'  Pymnt_Trm AS 'Payment Method' Co AS 'Company' DATE(Modf_Dt) AS 'Modified Date' Priority Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System'  TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

COMM *** Invalid ABN Format Details***
COMM
v_Exp_Fields_VM007D = "Cha_Field1 AS 'Vendor Site'  Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name'  Vndr_Sts AS 'Vendor Status'  ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount'  GST_AMT AS 'GST Amount' Inv_Net_Amt AS 'Applied Amount' Num_Field1 AS 'Pay Amount' Vchr_ID AS 'Trans Num' Btch_No AS 'Trans Ref' Cha_Field1 AS 'Pay Reference' Cha_Field2 AS 'Pay Method' Pymnt_Trms AS 'Payment Method' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_VM007D =  "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' VMF_VND_Master_File.Cha_Field4 AS 'Vendor Number' VMF_VND_Master_File.Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"

COMM *** Cancelled / Registration ABN ***
v_Exp_Fields_VM008 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN ASIC_entityStatusCode AS 'ABN Status' ASIC_entityStatusEF AS 'ABN Status Eff Date' Vndr_Typ AS 'Vendor Type' VM008Z_Can_ABN_Sum.Inv_Amt AS 'Total Invoice Amount' VM008Z_Can_ABN_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM008 =  "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN AS 'ABN' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' VM008Z_Can_ABN_Sum.Inv_Amt AS 'Total Invoice Amount' GST_AMT AS 'Total GST Amount' COUNT AS 'Total Trans Num'  DATE(Max_Inv_Dt) AS 'Last Invoice Date' TEL1 AS 'Phone' FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode Cntry AS 'Country'  Pymnt_Trm AS 'Payment Method' Co AS 'Company' DATE(Modf_Dt) AS 'Modified Date' Priority Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System'  TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"


v_Exp_Fields_VM008D = "VM008_can_ABN.Cha_Field1  AS 'Vendor Site'  VM008_can_ABN.Cha_Field4 AS 'Vendor Number' VM008_can_ABN.Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"

COMM *** Invalid ABN Format against ABR***
v_Exp_Fields_VM009 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM009 = "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN AS 'ABN' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Inv_Amt AS 'Total Invoice Amount' GST_AMT AS 'Total GST Amount' COUNT AS 'Total Trans Num'  DATE(Max_Inv_Dt) AS 'Last Invoice Date' TEL1 AS 'Phone' FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode Cntry AS 'Country'  Pymnt_Trm AS 'Payment Method' Co AS 'Company' DATE(Modf_Dt) AS 'Modified Date' Priority Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System'  TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"

COMM *** Invalid ABN Format against ABR Details***
v_Exp_Fields_VM009D = "VM009_Invld_ABN_ABR.Cha_Field1 AS 'Vendor Site'  VM009_Invld_ABN_ABR.Cha_Field4 AS 'Vendor Number' VM009_Invld_ABN_ABR.Vndr_Nme AS 'Vendor Name'   Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"


COMM
v_Exp_Fields_VM010 = "Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status' ABN ASIC_entityStatusCode AS 'ABN Status' DATE(ASIC_entityStatusEF) AS 'ABN Registration Date' DATE(ASIC_GST_effFrom) AS 'GST Registration Date' DATE(ASIC_GST_effTo) AS 'GST Expiry Date' VM010D_DeReg_GST_Sum.Inv_Amt AS 'Total Invoice Amount Post GST Expiry' VM010D_DeReg_GST_Sum.GST_Amt AS 'GST Paid Post GST Expiry' VM010D_DeReg_GST_Sum.COUNT AS 'Num Transactions Post GST Expiry' DATE(Max_Inv_Dt) AS 'Last Invoice Date' ASIC_entityDescription AS 'ASIC Description' ADD1 TEL1 Email1 Pymnt_Trm AS 'Payment Terms' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM010D = "Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status'  ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' ASIC_GST_effTo AS 'GST Expired Date' Inv_Amt AS 'Invoice Amount'  GST_AMT AS 'GST Amount' Inv_Net_Amt AS 'Applied Amount' Num_Field1 AS 'Pay Amount' Vchr_ID AS 'Trans Num' Btch_No AS 'Trans Ref' Cha_Field1 AS 'Pay Reference' Cha_Field2 AS 'Pay Method' Pymnt_Trms AS 'Term Code Desc' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM011 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status'ABN TEL1 TEL2 TEL3 ADD1 AS 'Address1' ADD2 AS 'Address2' ADD3 AS 'Address3' City AS 'City' State AS 'State' Email1 Email2 AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM012 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Vndr_InvlDt AS 'InActive Date' ABN Inv_Amt AS 'Total Invoice Amount Post InActive' GST_AMT AS 'Total GST Amount Post InActive' COUNT AS 'Total Trans Num Post InActive' DATE(Max_Inv_Dt) AS 'Last Invoice Date' ADD1 ADD2 ADD3 City State Cntry AS 'Country' TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm AS 'Payment Terms' Co AS 'Company' DATE(Modf_Dt) AS 'Modified Date' Priority  TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM012D = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' VM012_Inac_xx_Mon.Vndr_InvlDt AS 'Vendor InActive Date' Inv_Amt AS 'Invoice Amount' GST_AMT AS 'GST Amount' Inv_Net_Amt AS 'Inv Net Amount' DATE(Pd_Dt) AS 'Payment Date' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  isPaid AS 'Paid' Vchr_ID AS 'Voucher Number' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM013 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Trans_Num AS 'Trans Number' Inv_Amt AS 'Total Invoice Amount' GST_Amt AS 'Total GST Amount' DATE(Max_Inv_Dt) AS 'Last Invoice Date' ABN TEL1 City State Cntry AS 'Country' Pymnt_Trm AS 'Payment Terms' Created_Dt AS 'Created Date' DATE(Modf_Dt) AS 'Modified Date' Co AS 'Company' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM013D = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' GST_Amt AS 'GST Amount' Inv_Net_Amt AS 'Inv Net Amount' DATE(Pd_Dt) AS 'Payment Date' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM014 = "VM_EM Vndr_Site_ID Vndr_ID Vndr_Nme Vndr_Typ ABN BSB Bnk_Acc_Num ADD1 ADD2 ADD3 City State PCode Cntry TEL1 TEL2 TEL3 FAX Email1 Inv_Amt GST_Amt COUNT ABN Vndr_Sts Hire_Dt Created_Dt Modf_Dt Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM015 = "VM_EM Vndr_Site_ID Vndr_ID Vndr_Nme Vndr_Typ ABN BSB Bnk_Acc_Num ADD1 ADD2 ADD3 City State PCode Cntry TEL1 TEL2 TEL3 FAX Email1 Inv_Amt GST_Amt COUNT ABN Vndr_Sts Hire_Dt Created_Dt Modf_Dt Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM016 = "VM_EM Vndr_Site_ID Vndr_ID Vndr_Nme Vndr_Typ ABN BSB Bnk_Acc_Num ADD1 ADD2 ADD3 City State PCode Cntry TEL1 TEL2 TEL3 FAX Email1 Inv_Amt GST_Amt COUNT ABN Vndr_Sts Hire_Dt Created_Dt Modf_Dt Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM017 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date' Email1 Email2 ABN TEL1 TEL2 TEL3 ADD1 AS 'Address1' ADD2 AS 'Address2' ADD3 AS 'Address3' City AS 'City' State AS 'State' Pcode Cntry AS 'Country' TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

COMM *** Accounts Payable Tests Output***
COMM
v_Exp_Fields_AP001 = "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' VMF_VND_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"

v_Exp_Fields_AP001 = "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' VMF_VND_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"

COMM v_Exp_Fields_AP001 = "Flag VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description'  Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc" 

v_Exp_Fields_AP002 = "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' VMF_VND_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_AP002 = "Flag VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description' Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc" 

v_Exp_Fields_AP003 = "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' VMF_VND_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_AP003 = "Flag VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description' Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc" 

v_Exp_Fields_AP004 = "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' VMF_VND_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_AP004 = "Flag VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description'  Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc" 

COMM
v_Exp_Fields_AP005 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Inv_No AS 'Invoice Reference Seq Start' DATE(Inv_Dt) AS 'Invoice Date 1' ' '+ Inv_No2 AS 'Invoice Reference Seq End' DATE(Inv_Dt2) AS 'Invoice Date 2' Consec_Num AS 'Consecutive Num' Priority TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' REC_KEY SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP005D = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' GST_Amt AS 'GST Amount' Inv_Net_Amt AS 'Inv Net Amount' DATE(Pd_Dt) AS 'Payment Date' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' REC_KEY SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_AP006 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_AP006 = " Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description'  Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc" 

COMM
v_Exp_Fields_AP008 = "Cha_Field1 AS 'BUSINESS' Vndr_Sts AS 'Vendor Status' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' AllowLimit Inv_Amt AS 'Invoice Amount' DiffAmt AS 'Over Limit Amount' GST_Amt AS 'GST Amount' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invice Date' Vchr_ID AS 'Voucher Number' Doc_Typ AS 'Doc Type' Descrp AS 'Description' Curncy AS 'Currrency' DATE(Pd_Dt) AS 'Paid Date' PO_No isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date'  SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP009 = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status'  ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' GST_Amt AS 'GST Amount' GST_Pct Inv_Net_Amt AS 'Inv Net Amount' DATE(Pd_Dt) AS 'Payment Date' Doc_Typ AS 'Document Type' VMF_Vnd_Master_File.State AS 'State' VMF_Vnd_Master_File.Cntry AS 'Country' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP010 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Avg_Inv_Amt AS 'Average Invoice Amount' Max_Inv_Amt AS 'Largest Amount' Snd_Inv_Amt AS 'Second Largest Amount' Min_Inv_Amt AS 'Smallest Amount' c_Max_Avg_Pct AS 'Pct Largest to Average' c_Max_Snd_Pct AS 'Pct Largest to Second' Ttl_Inv_Amt_75 AS 'Total Invoice Amount 75' Count_75 AS 'Total Num 75' Ttl_Inv_Amt AS 'Total Invoice Amount' Ttl_Count AS 'Total Trans Num' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP010D = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Avg_Inv_Amt AS 'Average Invoice Amount' c_Inv_Avg_Pct AS 'Pct Invoice Amount to Average' GST_Amt AS 'GST Amount' Inv_Net_Amt AS 'Inv Net Amount' DATE(Pd_Dt) AS 'Payment Date' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM OLD AP011
COMM
v_Exp_Fields_AP011 = "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status'  Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' VMF_VND_Master_File.TEL1 AS 'Phone' VMF_VND_Master_File.FAX AS 'FAX' VMF_VND_Master_File.ADD1 AS 'Address' VMF_VND_Master_File.City AS 'City' VMF_VND_Master_File.State AS 'State' VMF_VND_Master_File.Pcode AS 'Postcode'  VMF_VND_Master_File.Cntry AS 'Country' VMF_VND_Master_File.Pymnt_Trms AS 'Payment Method' VMF_VND_Master_File.Vndr_Site_ID AS 'Vendor Site ID' VMF_VND_Master_File.Cha_Field3 AS 'Source System'  Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM
v_Exp_Fields_AP012 = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' DATE(Pd_Dt) AS 'Payment Date'  Inv_Amt AS 'Invoice Amount' PO_NO Rec_Qty AS 'Received Quantity' Rec_Amt AS 'Received Amount' Rec_Dt AS 'Received Date' PO_Date Amount AS 'PO Amount' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' GST_Amt AS 'GST Amount' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP013 = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Inv_Net_Amt AS 'Inv Net Amount' PO_NO Pst_Dt as 'Post Date' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' GST_Amt AS 'GST Amount' DATE(Pd_Dt) AS 'Payment Date' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM


v_Exp_Fields_AP014  = "VMF_Vnd_Master_File.Cha_Field1 AS 'Vendor Site' VMF_Vnd_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status'  Vndr_Typ AS 'Vendor Type' VMF_VND_Master_File.TEL1 AS 'Phone' VMF_VND_Master_File.FAX AS 'FAX' VMF_VND_Master_File.ADD1 AS 'Address' VMF_VND_Master_File.City AS 'City' VMF_VND_Master_File.State AS 'State' VMF_VND_Master_File.Pcode AS 'Postcode'  VMF_VND_Master_File.Cntry AS 'Country' VMF_Vnd_Master_File.Pymnt_Trm AS 'Payment Method' VMF_VND_Master_File.Vndr_Site_ID AS 'Vendor Site ID' VMF_VND_Master_File.Cha_Field3 AS 'Source System'  Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM
v_Exp_Fields_AP014  = "VMF_Vnd_Master_File.Cha_Field1 AS 'Vendor Site' VMF_Vnd_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
END

COMM v_Exp_Fields_AP014  = "VMF_Vnd_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status'  Vndr_Typ AS 'Vendor Type' VMF_VND_Master_File.TEL1 AS 'Phone' VMF_VND_Master_File.FAX AS 'FAX' VMF_VND_Master_File.ADD1 AS 'Address' VMF_VND_Master_File.City AS 'City' VMF_VND_Master_File.State AS 'State' VMF_VND_Master_File.Pcode AS 'Postcode'  VMF_VND_Master_File.Cntry AS 'Country' VMF_Vnd_Master_File.Pymnt_Trm AS 'Payment Method' VMF_VND_Master_File.Vndr_Site_ID AS 'Vendor Site ID' VMF_VND_Master_File.Cha_Field3 AS 'Source System'  Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM OLD copy of AP0014
COMM
v_Exp_Fields_AP014 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' ABN TEL1 City State Cntry AS 'Country' Pymnt_Trm AS 'Payment Terms' DATE(Max_Inv_Dt) AS 'Last Invoice Date' Created_Dt AS 'Created Date' DATE(Modf_Dt) AS 'Modified Date' Co AS 'Company' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP015 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Ttl_Inv_Amt AS 'Total Invoice Amount' Ttl_GST_Amt AS 'Total GST Amount' Count AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date' DATE(Modf_Dt) AS 'Modified Date' City State Cntry AS 'Country' TEL1 Pymnt_Trm AS 'Payment Terms' Co AS 'Company' DATE(Modf_Dt) AS 'Modified Date' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP015D = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' GST_Amt AS 'GST Amount' Inv_Net_Amt AS 'Inv Net Amount' DATE(Pd_Dt) AS 'Payment Date' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM *** Tech One***
COMM
v_Exp_Fields_AP015=""
v_Exp_Fields_AP015D = "isPaid AS 'Paid'  Vndr_ID Vndr_Nme Vndr_Sts Vndr_Typ Sub_Vnd_Nme Add City_PCode Inv_No Inv_Dt Inv_Amt Gst_Amt Inv_NetAmt Currency Pst_Dt Doc_Typ Trans_Typ TrType_Desc PO_NO Pay_DocNbr Pay_Date Pay_DocTyp Trans_Nbr Alloc_Trans_Nbr Period Pst_User  Vchr_ID AS 'Voucher Number' Priority TEST_NAME RptRunDate AS 'Test Date' Data_Rage_Start_Date AS 'Data_Range_Start_Date' Data_Rage_End_Date AS 'Data_Range_End_Date' Grp_KEY SORT_KEY SORT_KEY_Desc"

COMM *** SAP ***
COMM
v_Exp_Fields_AP015 = "Cha_Field4 AS 'Co' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' BSEC_NAME1 AS 'One Time Vendor Name' Inv_Amt AS 'Total Invoice Amount' Doc_Num AS 'Trans Number' BSEC_BANKL AS 'BSB' BSEC_BANKN AS 'Bank Acc Number' BSEC_STRAS AS 'Address' BSEC_PSTLZ AS 'Post Code' BSEC_ORT01 AS 'City' BSEC_REGIO AS 'State' BSEC_STCD1 AS 'TaxNbr' Curncy AS 'Currency' TEST_NAME RptRunDate AS 'Test Date' Data_Rage_Start_Date Data_Rage_End_Date SORT_KEY SORT_KEY_Desc Grp_KEY ID_KEY"
v_Exp_Fields_AP015D = "isPaid Cha_Field4 AS 'Co' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' BSEC_NAME1 AS 'One Time Vendor Name' BSEC_BANKL AS 'BSB' BSEC_BANKN AS 'Bank Acc Number'  Inv_No  AS 'Invoice Reference' DATETIME(Inv_Dt,'DD/MM/YYYY') AS 'Invoice Date' Inv_Amt AS 'Doc Invoice Amount' Curncy AS 'Currency' Inv_Amt_Loc AS 'Local Invoice Amount'  Doc_Typ AS 'Doc Type' Btch_No AS 'Doc Number' Descrp VOIDED Pst_Dt as 'Post Date' Cha_Field2 AS 'Clr_DocNbr' Pymnt_Trms Cha_Field1 AS 'Fiscal Year' Cha_Field3 AS 'Reversal Doc' Priority TEST_NAME RptRunDate AS 'Test Date' Data_Rage_Start_Date Data_Rage_End_Date SORT_KEY SORT_KEY_Desc Grp_KEY"


COMM *** Missing ABN***
COMM
v_Exp_Fields_AP016 = "Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status' Inv_Amt AS 'Total Invoice Amount' GST_AMT AS 'Total GST Amount' COUNT AS 'Total Trans Num' ABN AS 'ABN' DATE(Max_Inv_Dt) AS 'Last Invoice Date' ADD1 TEL1 Email1 Pymnt_Trm AS 'Payment Terms' Priority  TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"

COMM *** Missing ABN Invoice Details***
COMM
v_Exp_Fields_AP016D = "Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status'  ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount'  GST_AMT AS 'GST Amount' Inv_Net_Amt AS 'Applied Amount' Num_Field1 AS 'Pay Amount' Vchr_ID AS 'Trans Num' Btch_No AS 'Trans Ref' Cha_Field1 AS 'Pay Reference' Cha_Field2 AS 'Pay Method' Pymnt_Trms AS 'Term Code Desc' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP017 = "Vndr_Sts AS 'Vendor Status' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Inv_Amt AS 'Total Invoice Amount' GST_Amt AS 'Total GST Amount' COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date' ABN ADD1 AS 'Address1' State AS 'State' Cntry AS 'Country' TEL1 Priority TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date'  SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP017D = "Cha_Field1 AS 'BUSINESS' isPaid Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Inv_Amt AS 'Invoice Amount' GST_Amt AS 'GST Amount' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' DATE(Pd_Dt) AS 'Payment Date' Descrp AS 'Description' Curncy AS 'Currency' Priority TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date'  SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP018 = "Cha_Field1 AS 'BUSINESS' Vndr_Sts AS 'Vendor Status' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' AllowLimit Inv_Amt AS 'Invoice Amount' DiffAmt AS 'Under/Over Limit Amount' GST_Amt AS 'GST Amount' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invice Date' Vchr_ID AS 'Voucher Number' Doc_Typ AS 'Doc Type' Descrp AS 'Description' Curncy AS 'Currrency' DATE(Pd_Dt) AS 'Paid Date' PO_No isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date'  SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP019="Cha_Field1 AS 'BUSINESS' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status' Doc_Typ AS 'Document Type' DATE(Pd_Dt) AS 'Payment Date' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' GST_Amt AS 'GST Amount' Inv_Net_Amt AS 'Inv Net Amount' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP020="Vndr_Site_ID AS 'Compnay Vendor Number' %trg_VMF%.Vndr_Nme AS 'Vendor Name' %trg_VMF%.Vndr_Typ AS 'Vendor Type' %trg_VMF%.Vndr_Sts AS 'Vendor Status' %trg_VMF%.ABN YM AS 'Month of Year' Mon_Pmnt_Num AS 'Total Payments of Month' c_Btch_No AS 'Check Number' Pay_Pmnt_Num AS 'Payments Count' Pay_Amt AS 'Total Payment Amount' GST_Amt AS 'Total GST Paid Amount' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP020D="Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Remit Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' DATE(Pay_Dt) AS 'CHECK_DATE' Pay_No AS 'INVOICE_PAYMENT_ID' Btch_No AS 'Check Number' Pay_Amt AS 'Payment Amount'  GST_AMT AS 'GST Amount' Curncy AS 'Currency' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Pymnt_Trms AS 'Status Lookup Code' Pymnt_Mth AS 'PAYMENT_METHOD_CODE' Cha_Field2 AS 'INVOICING_VENDOR_SITE_ID' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP021="GAP_START_EXCLUSIVE GAP_END_EXCLUSIVE NUMBER_ITEMS_MISSING Priority TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP022=""
v_Exp_Fields_AP023=""
COMM
v_Exp_Fields_AP024="Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Trans_Num AS 'Trans Number' Inv_Amt AS 'Total Invoice Amount' GST_Amt AS 'Total GST Amount' Months AS 'Low Activity Months' DATE(Max_Inv_Dt) AS 'Last Invoice Date' ABN TEL1 City State Cntry AS 'Country' Pymnt_Trm AS 'Payment Terms' Created_Dt AS 'Created Date' DATE(Modf_Dt) AS 'Modified Date' Co AS 'Company' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM *** Employee Master File Tests Output***
COMM
v_Exp_Fields_EM001 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM002 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE  BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Tax_Fle_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM003 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM004 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE Dup_Add1 Dup_Add2 Dup_Add3 Dup_City Dup_State Dup_PCode Dup_Cntry Total_PayAmt Total_Pay_Num Tax_Fle_Num  TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM005 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE TEL1 TEL2 TEL3 Fax Total_PayAmt Total_Pay_Num Tax_Fle_Num Add1 Add2 Add3 City State PCode Cntry Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM006 = "Emp_ID AS 'Employee Number' Emp_Sts Co AS 'BUSINESS' COST_CENTRE Title Emp_Nme AS 'Emp Name' DATE(DOB) AS 'DOB' Sex Tax_Fle_Num DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM007 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM008 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM009 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM010 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM011 = "EMF_TMP_Emp.Emp_ID AS 'Employee Number' EMF_TMP_Emp.Emp_Nme AS 'Emp Name' EMF_TMP_Emp.Co As 'BUSINESS' EMF_TMP_Emp.COST_CENTRE BSB Bnk_Acc_Num BSB_NAME EMF_TMP_Emp.Tax_Fle_Num EMF_TMP_Emp.Add1 EMF_TMP_Emp.Add2 EMF_TMP_Emp.Add3 EMF_TMP_Emp.City EMF_TMP_Emp.State EMF_TMP_Emp.PCode EMF_TMP_Emp.Cntry EMF_TMP_Emp.TEL1 EMF_TMP_Emp.TEL2 EMF_TMP_Emp.TEL3 EMF_TMP_Emp.Fax EMF_TMP_Emp.Email_Bus EMF_TMP_Emp.Email_Privt EMF_TMP_Emp.Title DATE(EMF_TMP_Emp.DOB) AS 'DOB' EMF_TMP_Emp.Sex DATE(EMF_TMP_Emp.Hire_Dt) AS 'Hired Date' DATE(EMF_TMP_Emp.Trm_Dt) AS 'TERM_DATE' EMF_TMP_Emp.Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM012 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM013 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM014 = "Emp_Sts Co AS 'Emp Company' COST_CENTRE Emp_ID AS 'Emp_Code' Tax_Fle_Num Tax_Scale Total_PayAmt Total_Pay_Num Title Frst_Nme AS 'Given Name' Second_Given_Name Sur_Nme AS 'SurName' DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc State AS 'State' PCode As 'Post Code' Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM015 = "'~'+Emp_ID AS 'Employee Code' Frst_Nme AS 'First Name' Sur_Nme AS 'Last Name' Emp_Sts AS 'Emp Status' Emp_Catg AS 'Emp Type Desc' '~'+COST_CENTRE AS 'Cost Centre Code' DATETIME(Hire_Dt,'DD/MM/YYYY') AS 'Start Date' DATETIME(Commencement_Dt, 'DD/MM/YYYY') AS 'Commencement Date' Lv_Hrs_Taken Lv_Days_Taken Cal_Days_Taken Lst_Lv_EndDt AS 'Lst_Lv_End_Date' Lst_LvCode AS 'Lst Lv Reason Code' Lst_LvHrs AS 'Lst_Lv_TtlHrs' '~'+Tax_Fle_Num AS  'Tax_Fle_Num' Total_PayAmt AS 'Total_12M_PayAmt' Total_Pay_Num AS 'Total_12M_TranNum' '~'+Bnk_Acc_Num AS 'Bank Account' TEL1 AS 'Home Phone' TEL2 AS 'Mobile' ALLTRIM(Add1)+' ' + ALLTRIM(Add2) AS 'Address' City PCode AS 'Post Code' State DATETIME(DOB,'DD/MM/YYYY') AS 'Birth Date' Title AS 'Position Code' '~'+Cha_Field1 AS 'Dept Code' '~'+Cha_Field2 AS 'Location Code' Cha_Field3 AS 'Work Area Code' Test_Name DATETIME(RptRunDate,'DD/MM/YYYY') AS 'Test Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM016 = "'~'+Emp_ID AS 'Employee Code' Frst_Nme AS 'First Name' Sur_Nme AS 'Last Name' Emp_Sts AS 'Emp Status' Emp_Catg AS 'Emp Type Desc' '~'+COST_CENTRE AS 'Cost Centre Code' DATETIME(Hire_Dt,'DD/MM/YYYY') AS 'Start Date' DATETIME(Commencement_Dt, 'DD/MM/YYYY') AS 'Commencement Date' Lv_Code AS 'Leave Reason Code' AnnYear1 AS 'AnnY1_Hire_Date' AnnYear1_Lv_Days_Taken AS 'AnnY1_Sum_Lv_Days_Taken' AnnYear2 AS 'AnnY2_Hire_Date' AnnYear2_Lv_Days_Taken AS 'AnnY2_Sum_Lv_Days_Taken' AnnYear1_Cal_Days_Taken AS 'Y1_Calendar_Days' AnnYear2_Cal_Days_Taken AS 'Y2_Calendar_Days' DATETIME(DOB,'DD/MM/YYYY') AS 'Birth Date' '~'+Tax_Fle_Num AS  'Tax_Fle_Num' Total_PayAmt AS 'Total_12M_PayAmt' Total_Pay_Num AS 'Total_12M_TranNum' '~'+Bnk_Acc_Num AS 'Bank Account' TEL1 AS 'Home Phone' TEL2 AS 'Mobile' ALLTRIM(Add1)+' ' + ALLTRIM(Add2) AS 'Address' City PCode AS 'Post Code' State Title AS 'Position Code' '~'+Cha_Field1 AS 'Dept Code' '~'+Cha_Field2 AS 'Location Code' Cha_Field3 AS 'Work Area Code' Test_Name DATETIME(RptRunDate,'DD/MM/YYYY') AS 'Test Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM016D = "'~'+Emp_ID AS 'Employee Code' Frst_Nme AS 'First Name' Sur_Nme AS 'Last Name' Emp_Sts AS 'Emp Status' Emp_Catg AS 'Emp Type Desc' '~'+COST_CENTRE AS 'Cost Centre Code' DATETIME(Hire_Dt,'DD/MM/YYYY') AS 'Start Date' DATETIME(Commencement_Dt, 'DD/MM/YYYY') AS 'Commencement Date' ExceptionAnnYear ReasonCode StartDate AS 'Lv Start Date' EndDate AS 'Lv End Date' UnitsRequested AS 'Lv Hours Taken' TypeOfUnits ApprovedByCode ApprovedDate AS 'Approved Date' ProcessedDate AS 'Processed Date' c_Notes AS 'Notes'  Test_Name RptRunDate AS 'Test_Date'SORT_KEY"

COMM
v_Exp_Fields_EM017="'~'+Emp_ID AS 'Employee Code' Frst_Nme AS 'First Name' Sur_Nme AS 'Last Name' Emp_Sts AS 'Emp Status' Emp_Catg AS 'Emp Type Desc' '~'+COST_CENTRE AS 'Cost Centre Code' DATETIME(Hire_Dt,'DD/MM/YYYY') AS 'Start Date' DATETIME(Commencement_Dt, 'DD/MM/YYYY') AS 'Commencement Date' 'SICK' AS 'Leave Reason Code' SLTotalUnits AS 'Balance_SLTotalHrs' TtlSLHrs_Taken EndDate AS 'Lv End Date' ApprovedByCode ApprovedDate AS 'Approved Date' Notes DATETIME(DOB,'DD/MM/YYYY') AS 'Birth Date' '~'+Tax_Fle_Num AS  'Tax_Fle_Num' '~'+Bnk_Acc_Num AS 'Bank Account' TEL1 AS 'Home Phone' TEL2 AS 'Mobile' ALLTRIM(Add1)+' ' + ALLTRIM(Add2) AS 'Address' City PCode AS 'Post Code' State Title AS 'Position Code' '~'+Cha_Field1 AS 'Dept Code' '~'+Cha_Field2 AS 'Location Code' Cha_Field3 AS 'Work Area Code' Test_Name DATETIME(RptRunDate,'DD/MM/YYYY') AS 'Test Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM017D = "'~'+Emp_ID AS 'Employee Code' Frst_Nme AS 'First Name' Sur_Nme AS 'Last Name' Emp_Sts AS 'Emp Status' Emp_Catg AS 'Emp Type Desc' '~'+COST_CENTRE AS 'Cost Centre Code' DATETIME(Hire_Dt,'DD/MM/YYYY') AS 'Start Date' DATETIME(Commencement_Dt, 'DD/MM/YYYY') AS 'Commencement Date' ReasonCode StartDate AS 'Lv Start Date' EndDate AS 'Lv End Date' UnitsRequested AS 'Lv Hours Taken' TypeOfUnits ApprovedByCode ApprovedDate AS 'Approved Date' ProcessedDate AS 'Processed Date' c_Notes AS 'Notes'  Test_Name RptRunDate AS 'Test_Date'SORT_KEY"


COMM *** Payroll Tests Output***
COMM
v_Exp_Fields_PR001 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR002 = "Co As 'BUSINESS' COST_CENTRE Emp_ID AS 'Employee Number' DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR003 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Trm_Dt) AS 'TERM_DATE' DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY Title  STATE PCode AS 'Post Code' DATE(Hire_Dt) AS 'Hired Date'  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR004 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY Title  DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR005 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Trm_Dt) AS 'TERM_DATE' DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY Title DATE(Hire_Dt) AS 'Hired Date'  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR006 = ""
COMM
v_Exp_Fields_PR007 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours AUTOPAY_HOURS_DAYS LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY Title DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR008 = "Emp_ID AS 'Employee Number' Co As 'BUSINESS' COST_CENTRE PAYCODE_AMOUNT PAYCODE_HOURS Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR008D = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY Title  DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR009="Co As 'BUSINESS' Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' DATE(Prd_Dt) AS 'Prd_Dt' PayCode_Amount PayCode_Hours Avg_PayCode_Amount Avg_PayCode_Hours Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR009D = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY Title  DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"

COMM *** EXPORT STATICSTIC Reports *** 
COMM
v_Exp_Fields_ST001 = "Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Ttl_Issues AS 'Total Issues Found' COUNT AS 'Number of Test Failed' Priority DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_ST001D = "Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' COUNT AS 'Total Issues Found in the Test' TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_ST002 = "Rev_Days_1 AS 'Rev_Days' Count AS 'Total Reversals Num' FIELD_PERCENTAGE ABS_InvAmt"
COMM
v_Exp_Fields_ST003 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status' Total_InvAmt AS 'Total Invoices Amount' Trns_Num AS 'Total Invoices Num' Dup_InvAmt Dup_Num  Cln_Dup_InvAmt Cln_Dup_Num PCT_Cln_Dup_Trns_Amt PCT_Cln_Dup_Trns_Num  Rev_InvAmt Rev_Num PCT_Rev_Dup_Amt PCT_Rev_Dup_Num Vndr_Typ AS 'Vednor Type' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_ST004 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_Nme AS 'Vendor Name' Inv_Amt AS 'Invoices Amount' GST_Amt AS 'GST Amount' COUNT AS 'Total Trans Num' COUNT_PERCENTAGE AS 'Trans Num Pct' FIELD_PERCENTAGE AS 'Inv Amt Pct' Priority RptRunDate SORT_KEY"
COMM
v_Exp_Fields_ST005 = "YM AS 'Month' Inv_Amt AS 'Invoices Amount' GST_Amt AS 'GST Amount' COUNT AS 'Total Trans Num' COUNT_PERCENTAGE AS 'Trans Num Pct' Priority RptRunDate SORT_KEY"
COMM
v_Exp_Fields_ST006 = ""

COMM *** Export Vendor Master File Tests***

IF (CHK_Exp_VM001=T AND FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM001)) OPEN VM001_Dup_Vnd_BankAcc
%v_cmt% IF (CHK_Exp_VM001=T AND FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM001)) COUNT
IF (CHK_Exp_VM001=T AND FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM001)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM001%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM001_Dup_Vnd_BankAcc" %v_fileOpt%

IF (CHK_Exp_VM002=T AND FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM002)) OPEN VM002_Dup_Vnd_ABN
%v_cmt% IF (CHK_Exp_VM002=T AND FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM002)) COUNT
IF (CHK_Exp_VM002=T AND FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM002)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM002%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM002_Dup_Vnd_ABN" %v_fileOpt%

IF (CHK_Exp_VM003=T AND FILESIZE("%fld_Results%VM003_Dup_Vnd_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM003)) OPEN VM003_Dup_Vnd_Add
%v_cmt% IF (CHK_Exp_VM003=T AND FILESIZE("%fld_Results%VM003_Dup_Vnd_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM003)) COUNT
IF (CHK_Exp_VM003=T AND FILESIZE("%fld_Results%VM003_Dup_Vnd_Add.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM003)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM003%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM003_Dup_Vnd_Add" %v_fileOpt%

IF (CHK_Exp_VM004=T AND FILESIZE("%fld_Results%VM004_Dup_Vnd_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM004)) OPEN VM004_Dup_Vnd_Tel
%v_cmt% IF (CHK_Exp_VM004=T AND FILESIZE("%fld_Results%VM004_Dup_Vnd_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM004)) COUNT
IF (CHK_Exp_VM004=T AND FILESIZE("%fld_Results%VM004_Dup_Vnd_Tel.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM004)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM004%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM004_Dup_Vnd_Tel" %v_fileOpt%


IF (CHK_Exp_VM005=T AND FILESIZE("%fld_Results%VM005_Dup_Vnd_Name.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM005)) OPEN VM005_Dup_Vnd_Name
%v_cmt% IF (CHK_Exp_VM005=T AND FILESIZE("%fld_Results%VM005_Dup_Vnd_Name.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM005)) COUNT
IF (CHK_Exp_VM005=T AND FILESIZE("%fld_Results%VM005_Dup_Vnd_Name.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM005)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM005%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM005_Dup_Vnd_Name" %v_fileOpt%


IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006)) OPEN VM006_Mis_Details
%v_cmt% IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006)) COUNT
IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006_Mis_Details.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM006)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM006%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM006_Mis_Details" %v_fileOpt%


IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006D_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006D)) OPEN VM006D_Mis_Details
%v_cmt% IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006D_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006D)) COUNT
IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006D_Mis_Details.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM006D)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM006D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM006D_Mis_Details" %v_fileOpt%

COMMENT
IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006D_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006D)) OPEN TMP_VM006D
%v_cmt% IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006D_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006D)) COUNT
IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006D_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006D)) %v_if% %v_EXPORT% FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM006D_Mis_Details" %v_fileOpt%
END

IF ((CHK_Exp_VM007=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM007_Invld_Frmt_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM007)) OPEN VM007_Invld_Frmt_ABN
%v_cmt% IF ((CHK_Exp_VM007=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM007_Invld_Frmt_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM007)) COUNT
IF ((CHK_Exp_VM007=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM007_Invld_Frmt_ABN.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM007)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM007%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM007_Invld_Frmt_ABN" %v_fileOpt%

IF ((CHK_Exp_VM007=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM007D_Invld_Frmt_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM007D)) OPEN VM007D_Invld_Frmt_ABN
%v_cmt% IF ((CHK_Exp_VM007=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM007D_Invld_Frmt_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM007D)) COUNT
IF ((CHK_Exp_VM007=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM007D_Invld_Frmt_ABN.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM007D)) %v_EXPORT% FIELDS %v_Exp_Fields_VM007D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM007_Invld_Frmt_ABN" %v_fileOpt%

IF ((CHK_Exp_VM008=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM008_Can_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM008)) OPEN VM008_Can_ABN
%v_cmt% IF ((CHK_Exp_VM008=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM008_Can_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM008)) COUNT
IF ((CHK_Exp_VM008=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM008_Can_ABN.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM008)) %v_EXPORT% FIELDS %v_Exp_Fields_VM008%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM008_Can_ABN" %v_fileOpt%

IF ((CHK_Exp_VM008=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM008D_Can_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM008D)) OPEN TMP_VM008D
%v_cmt% IF ((CHK_Exp_VM008=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM008D_Can_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM008D)) COUNT
IF ((CHK_Exp_VM008=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM008D_Can_ABN.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM008D)) %v_EXPORT% FIELDS FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM008D_Can_ABN" %v_fileOpt%

IF ((CHK_Exp_VM009=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM009_Invld_ABN_ABR.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM009)) OPEN VM009_Invld_ABN_ABR
%v_cmt% IF ((CHK_Exp_VM009=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM009_Invld_ABN_ABR.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM009)) COUNT
IF ((CHK_Exp_VM009=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM009_Invld_ABN_ABR.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM009)) %v_EXPORT% FIELDS %v_Exp_Fields_VM009%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM009_Invld_ABN_ABR" %v_fileOpt%

IF ((CHK_Exp_VM009=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM009D_Invld_ABN_ABR.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM009D)) OPEN VM009D_Invld_ABN_ABR
%v_cmt% IF ((CHK_Exp_VM009=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM009D_Invld_ABN_ABR.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM009D)) COUNT
IF ((CHK_Exp_VM009=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM009D_Invld_ABN_ABR.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM009D)) %v_EXPORT% FIELDS %v_Exp_Fields_VM009D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM009D_Invld_ABN_ABR" %v_fileOpt%

COMM
COMM *** AP007 --> VM010/VM010D DeReg GST***
IF ((CHK_Exp_VM010=T OR CHK_Exp_AP007=T ) AND FILESIZE("%fld_Results%VM010_DeReg_GST.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM010)) OPEN VM010_DeReg_GST
%v_cmt% IF ((CHK_Exp_VM010=T OR CHK_Exp_AP007=T ) AND FILESIZE("%fld_Results%VM010_DeReg_GST.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM010)) COUNT
IF ((CHK_Exp_VM010=T OR CHK_Exp_AP007=T ) AND FILESIZE("%fld_Results%VM010_DeReg_GST.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM010)) %v_EXPORT% FIELDS %v_Exp_Fields_VM010%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM010_DeReg_GST" %v_fileOpt%
COMM
IF ((CHK_Exp_VM010=T OR CHK_Exp_AP007=T) AND FILESIZE("%fld_Results%VM010D_DeReg_GST.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM010)) OPEN VM010D_DeReg_GST
%v_cmt% IF ((CHK_Exp_VM010=T OR CHK_Exp_AP007=T) AND FILESIZE("%fld_Results%VM010D_DeReg_GST.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM010)) COUNT
IF ((CHK_Exp_VM010=T OR CHK_Exp_AP007=T) AND FILESIZE("%fld_Results%VM010D_DeReg_GST.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM010)) %v_EXPORT% FIELDS %v_Exp_Fields_VM010D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM010D_DeReg_GST" %v_fileOpt%
COMM
IF (CHK_Exp_VM011=T AND FILESIZE("%fld_Results%VM011_Upd_Mul_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM011)) OPEN VM011_Upd_Mul_xx_Mon
%v_cmt% IF (CHK_Exp_VM011=T AND FILESIZE("%fld_Results%VM011_Upd_Mul_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM011)) COUNT
IF (CHK_Exp_VM011=T AND FILESIZE("%fld_Results%VM011_Upd_Mul_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM011)) %v_EXPORT% FIELDS %v_Exp_Fields_VM011%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM011_Upd_Mul_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_VM012=T AND FILESIZE("%fld_Results%VM012_Inac_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM012)) OPEN VM012_Inac_xx_Mon
%v_cmt% IF (CHK_Exp_VM012=T AND FILESIZE("%fld_Results%VM012_Inac_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM012)) COUNT
IF (CHK_Exp_VM012=T AND FILESIZE("%fld_Results%VM012_Inac_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM012)) %v_EXPORT% FIELDS %v_Exp_Fields_VM012%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM012_Inac_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_VM012=T AND FILESIZE("%fld_Results%VM012D_Inac_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM012D)) OPEN VM012D_Inac_xx_Mon
%v_cmt% IF (CHK_Exp_VM012=T AND FILESIZE("%fld_Results%VM012D_Inac_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM012D)) COUNT
IF (CHK_Exp_VM012=T AND FILESIZE("%fld_Results%VM012D_Inac_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM012D)) %v_EXPORT% FIELDS %v_Exp_Fields_VM012D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM012D_Inac_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_VM013=T AND FILESIZE("%fld_Results%VM013_OneTim_Vnd_Spend.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM013)) OPEN VM013_OneTim_Vnd_Spend
%v_cmt% IF (CHK_Exp_VM013=T AND FILESIZE("%fld_Results%VM013_OneTim_Vnd_Spend.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM013)) COUNT
IF (CHK_Exp_VM013=T AND FILESIZE("%fld_Results%VM013_OneTim_Vnd_Spend.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM013)) %v_EXPORT% FIELDS %v_Exp_Fields_VM013%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM013_OneTim_Vnd_Spend" %v_fileOpt%
COMM
IF (CHK_Exp_VM013=T AND FILESIZE("%fld_Results%VM013D_OneTim_Vnd_Spend.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM013D)) OPEN VM013D_OneTim_Vnd_Spend
%v_cmt% IF (CHK_Exp_VM013=T AND FILESIZE("%fld_Results%VM013D_OneTim_Vnd_Spend.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM013D)) COUNT
IF (CHK_Exp_VM013=T AND FILESIZE("%fld_Results%VM013D_OneTim_Vnd_Spend.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM013D)) %v_EXPORT% FIELDS %v_Exp_Fields_VM013D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM013D_OneTim_Vnd_Spend" %v_fileOpt%
COMM
IF (CHK_Exp_VM014=T AND FILESIZE("%fld_Results%VM014_VndEmp_BankAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM014)) OPEN VM014_VndEmp_BankAcc
%v_cmt% IF (CHK_Exp_VM014=T AND FILESIZE("%fld_Results%VM014_VndEmp_BankAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM014)) COUNT
IF (CHK_Exp_VM014=T AND FILESIZE("%fld_Results%VM014_VndEmp_BankAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM014)) %v_EXPORT% FIELDS %v_Exp_Fields_VM014%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM014_VndEmp_BankAcc" %v_fileOpt%

COMM
IF (CHK_Exp_VM015=T AND FILESIZE("%fld_Results%VM015_VndEmp_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM015)) OPEN VM015_VndEmp_Add
%v_cmt% IF (CHK_Exp_VM015=T AND FILESIZE("%fld_Results%VM015_VndEmp_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM015)) COUNT
IF (CHK_Exp_VM015=T AND FILESIZE("%fld_Results%VM015_VndEmp_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM015)) %v_EXPORT% FIELDS %v_Exp_Fields_VM015%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM015_VndEmp_Add" %v_fileOpt%
COMM
IF (CHK_Exp_VM016=T AND FILESIZE("%fld_Results%VM016_VndEmp_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM016)) OPEN VM016_VndEmp_Tel
%v_cmt% IF (CHK_Exp_VM016=T AND FILESIZE("%fld_Results%VM016_VndEmp_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM016)) COUNT
IF (CHK_Exp_VM016=T AND FILESIZE("%fld_Results%VM016_VndEmp_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM016)) %v_EXPORT% FIELDS %v_Exp_Fields_VM016%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM016_VndEmp_Tel" %v_fileOpt%
COMM
IF (CHK_Exp_VM017=T AND FILESIZE("%fld_Results%VM017_Dup_Vnd_Email.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM017)) OPEN VM017_Dup_Vnd_Email
%v_cmt% IF (CHK_Exp_VM017=T AND FILESIZE("%fld_Results%VM017_Dup_Vnd_Email.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM017)) COUNT
IF (CHK_Exp_VM017=T AND FILESIZE("%fld_Results%VM017_Dup_Vnd_Email.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM017)) %v_EXPORT% FIELDS %v_Exp_Fields_VM017%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM017_Dup_Vnd_Email" %v_fileOpt%

COMM *** %v_EXPORT% Accounts Payable Tests ***

IF (CHK_Exp_AP001=T AND FILESIZE("%fld_Results%zHIST1_AP001_Dup_Amt_Dt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP001)) OPEN zHIST1_AP001_Dup_Amt_Dt_Inv_Vnd
%v_cmt% IF (CHK_Exp_AP001=T AND FILESIZE("%fld_Results%zHIST1_AP001_Dup_Amt_Dt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP001)) COUNT
IF (CHK_Exp_AP001=T AND FILESIZE("%fld_Results%zHIST1_AP001_Dup_Amt_Dt_Inv_Vndr.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP001)) %v_EXPORT% FIELDS %v_Exp_Fields_AP001%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%Hist1_AP001_Dup_Amt_Dt_Inv_Vndr" %v_fileOpt%

COMM
IF (CHK_Exp_AP001=T AND FILESIZE("%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP001)) OPEN TMP_AP001
%v_cmt% IF (CHK_Exp_AP001=T AND FILESIZE("%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP001)) COUNT
IF (CHK_Exp_AP001=T AND FILESIZE("%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP001)) %v_EXPORT% FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP001_Dup_Amt_Dt_Inv_Vndr" %v_fileOpt%
END



IF (CHK_Exp_AP002=T AND FILESIZE("%fld_Results%zHIST1_AP002_Dup_Amt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP002)) OPEN zHIST1_AP002_Dup_Amt_Inv_Vndr
%v_cmt% IF (CHK_Exp_AP002=T AND FILESIZE("%fld_Results%zHIST1_AP002_Dup_Amt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP002)) COUNT
IF (CHK_Exp_AP002=T AND FILESIZE("%fld_Results%zHIST1_AP002_Dup_Amt_Inv_Vndr.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP002)) %v_EXPORT% FIELDS %v_Exp_Fields_AP002%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%Hist1_AP002_Dup_Amt_Inv_Vndr" %v_fileOpt%

COMM
IF (CHK_Exp_AP002=T AND FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP002)) OPEN TMP_AP002
%v_cmt% IF (CHK_Exp_AP002=T AND FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP002)) COUNT
IF (CHK_Exp_AP002=T AND FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP002)) %v_EXPORT% FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP002_Dup_Amt_Inv_Vndr" %v_fileOpt%
END


IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%zHIST1_AP003_Dup_Amt_Dt_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) OPEN zHIST1_AP003_Dup_Amt_Dt_Inv
%v_cmt% IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%zHIST1_AP003_Dup_Amt_Dt_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) COUNT
IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%zHIST1_AP003_Dup_Amt_Dt_Inv.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) %v_EXPORT% FIELDS %v_Exp_Fields_AP003%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%Hist1_AP003_Dup_Amt_Dt_Inv" %v_fileOpt%

COMM
IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) OPEN TMP_AP003
%v_cmt% IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) COUNT
IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) %v_EXPORT% FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP003_Dup_Amt_Dt_Inv" %v_fileOpt%
END


IF (CHK_Exp_AP004=T AND FILESIZE("%fld_Results%zHIST1_AP004_Dup_Amt_Dt_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP004)) OPEN zHIST1_AP004_Dup_Amt_Dt_Vndr
%v_cmt% IF (CHK_Exp_AP004=T AND FILESIZE("%fld_Results%zHIST1_AP004_Dup_Amt_Dt_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP004)) COUNT
IF (CHK_Exp_AP004=T AND FILESIZE("%fld_Results%zHIST1_AP004_Dup_Amt_Dt_Vndr.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) %v_EXPORT% FIELDS %v_Exp_Fields_AP004%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%Hist1_AP004_Dup_Amt_Dt_Vndr" %v_fileOpt%

COMM
IF (CHK_Exp_AP004=T AND FILESIZE("%fld_Results%AP004_Dup_Amt_Dt_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) OPEN TMP_AP004
%v_cmt% IF (CHK_Exp_AP004=T AND FILESIZE("%fld_Results%AP004_Dup_Amt_Dt_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) COUNT
IF (CHK_Exp_AP004=T AND FILESIZE("%fld_Results%AP004_Dup_Amt_Dt_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) %v_EXPORT% FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP004_Dup_Amt_Dt_Vndr" %v_fileOpt%
END

COMM
IF (CHK_Exp_AP005=T AND FILESIZE("%fld_Results%AP005_3Cons_InvNo.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP005)) OPEN AP005_3Cons_InvNo
%v_cmt% IF (CHK_Exp_AP005=T AND FILESIZE("%fld_Results%AP005_3Cons_InvNo.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP005))  COUNT
IF (CHK_Exp_AP005=T AND FILESIZE("%fld_Results%AP005_3Cons_InvNo.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP005)) %v_EXPORT% FIELDS %v_Exp_Fields_AP005%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP005_3Cons_InvNo" %v_fileOpt%
COMM
IF (CHK_Exp_AP005=T AND FILESIZE("%fld_Results%AP005D_3Cons_InvNo_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP005D)) OPEN AP005D_3Cons_InvNo_Details
%v_cmt% IF (CHK_Exp_AP005=T AND FILESIZE("%fld_Results%AP005D_3Cons_InvNo_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP005D)) COUNT
IF (CHK_Exp_AP005=T AND FILESIZE("%fld_Results%AP005D_3Cons_InvNo_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP005D)) %v_EXPORT% FIELDS %v_Exp_Fields_AP005D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP005D_3Cons_InvNo_Details" %v_fileOpt%

IF (CHK_Exp_AP006=T AND FILESIZE("%fld_Results%AP006_Pay_Not_In_VMF.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP006)) OPEN AP006_Pay_Not_In_VMF
%v_cmt% IF (CHK_Exp_AP006=T AND FILESIZE("%fld_Results%AP006_Pay_Not_In_VMF.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP006)) COUNT
IF (CHK_Exp_AP006=T AND FILESIZE("%fld_Results%AP006_Pay_Not_In_VMF.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP006)) %v_EXPORT% FIELDS %v_Exp_Fields_AP006%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP006_Pay_Not_In_VMF" %v_fileOpt%

COMM *** AP007 --> VM010/VM010D DeReg_GST ***

COMm *** AP008 Exc_Alw_Limit ***
COMM
IF (CHK_Exp_AP008=T AND FILESIZE("%fld_Results%AP008_Exc_Alw_Limit.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP008)) OPEN AP008_Exc_Alw_Limit
%v_cmt% IF (CHK_Exp_AP008=T AND FILESIZE("%fld_Results%AP008_Exc_Alw_Limit.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP008)) COUNT
IF (CHK_Exp_AP008=T AND FILESIZE("%fld_Results%AP008_Exc_Alw_Limit.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP008)) %v_EXPORT% FIELDS %v_Exp_Fields_AP008%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP008_Exc_Alw_Limit" %v_fileOpt%
COMM
IF (CHK_Exp_AP009=T AND FILESIZE("%fld_Results%AP009_GST_Over_Char.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP009)) OPEN AP009_GST_Over_Char
%v_cmt% IF (CHK_Exp_AP009=T AND FILESIZE("%fld_Results%AP009_GST_Over_Char.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP009)) COUNT
IF (CHK_Exp_AP009=T AND FILESIZE("%fld_Results%AP009_GST_Over_Char.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP009)) %v_EXPORT% FIELDS %v_Exp_Fields_AP009%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP009_GST_Over_Char" %v_fileOpt%
COMM
IF (CHK_Exp_AP010=T AND FILESIZE("%fld_Results%AP010_Large_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP010)) OPEN AP010_Large_Inv
%v_cmt% IF (CHK_Exp_AP010=T AND FILESIZE("%fld_Results%AP010_Large_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP010)) COUNT
IF (CHK_Exp_AP010=T AND FILESIZE("%fld_Results%AP010_Large_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP010)) %v_EXPORT% FIELDS %v_Exp_Fields_AP010%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP010_Large_Inv" %v_fileOpt%
COMM
IF (CHK_Exp_AP010=T AND FILESIZE("%fld_Results%AP010D_Large_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP010D)) OPEN AP010D_Large_Inv
%v_cmt% IF (CHK_Exp_AP010=T AND FILESIZE("%fld_Results%AP010D_Large_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP010D)) COUNT
IF (CHK_Exp_AP010=T AND FILESIZE("%fld_Results%AP010D_Large_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP010D)) %v_EXPORT% FIELDS %v_Exp_Fields_AP010D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP010D_Large_Inv" %v_fileOpt%
COMM
IF (CHK_Exp_AP011=T AND FILESIZE("%fld_Results%AP011_PODt_Aft_InvDt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP011)) OPEN AP011_PODt_Aft_InvDt
%v_cmt% IF (CHK_Exp_AP011=T AND FILESIZE("%fld_Results%AP011_PODt_Aft_InvDt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP011)) COUNT
IF (CHK_Exp_AP011=T AND FILESIZE("%fld_Results%AP011_PODt_Aft_InvDt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP011)) %v_EXPORT% FIELDS %v_Exp_Fields_AP011%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP011_PODt_Aft_InvDt" %v_fileOpt%
COMM
IF (CHK_Exp_AP012=T AND FILESIZE("%fld_Results%AP012_POs_No_Goods.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP012)) OPEN AP012_POs_No_Goods
%v_cmt% IF (CHK_Exp_AP012=T AND FILESIZE("%fld_Results%AP012_POs_No_Goods.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP012)) COUNT
IF (CHK_Exp_AP012=T AND FILESIZE("%fld_Results%AP012_POs_No_Goods.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP012)) %v_EXPORT% FIELDS %v_Exp_Fields_AP012%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP012_POs_No_Goods" %v_fileOpt%
COMM
IF (CHK_Exp_AP013=T AND FILESIZE("%fld_Results%AP013_PO_Mul_Diff_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP013)) OPEN AP013_PO_Mul_Diff_Vnd
%v_cmt% IF (CHK_Exp_AP013=T AND FILESIZE("%fld_Results%AP013_PO_Mul_Diff_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP013)) COUNT
IF (CHK_Exp_AP013=T AND FILESIZE("%fld_Results%AP013_PO_Mul_Diff_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP013)) %v_EXPORT% FIELDS %v_Exp_Fields_AP013%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP013_PO_Mul_Diff_Vnd" %v_fileOpt%

COMM
IF (CHK_Exp_AP014=T AND FILESIZE("%fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP014)) OPEN TMP_AP014
%v_cmt% IF (CHK_Exp_AP014=T AND FILESIZE("%fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP014)) COUNT
IF (CHK_Exp_AP014=T AND FILESIZE("%fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP014)) %v_EXPORT% FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP014_No_Trans_%TXT_AP014_Months%_Mon" %v_fileOpt%
END 

IF (CHK_Exp_AP006=T AND FILESIZE("%fld_Results%AP006_Pay_Not_In_VMF.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP006)) OPEN AP006_Pay_Not_In_VMF
%v_cmt% IF (CHK_Exp_AP006=T AND FILESIZE("%fld_Results%AP006_Pay_Not_In_VMF.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP006)) COUNT
IF (CHK_Exp_AP006=T AND FILESIZE("%fld_Results%AP006_Pay_Not_In_VMF.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP006)) %v_EXPORT% FIELDS %v_Exp_Fields_AP006%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP006_Pay_Not_In_VMF" %v_fileOpt%

IF (CHK_Exp_AP014=T AND FILESIZE("%fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP014)) OPEN AP014_No_Trans_%TXT_AP014_Months%_Mon
%v_cmt% IF (CHK_Exp_AP014=T AND FILESIZE("%fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP014)) COUNT
IF (CHK_Exp_AP014=T AND FILESIZE("%fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP014)) %v_EXPORT% FIELDS %v_Exp_Fields_AP014%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP014_No_Trans_%TXT_AP014_Months%_Mon" %v_fileOpt%


COMM
IF (CHK_Exp_AP015=T AND FILESIZE("%fld_Results%AP015_Mul_Trans_OneTim_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP015)) OPEN AP015_Mul_Trans_OneTim_Vnd
%v_cmt% IF (CHK_Exp_AP015=T AND FILESIZE("%fld_Results%AP015_Mul_Trans_OneTim_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP015)) COUNT
IF (CHK_Exp_AP015=T AND FILESIZE("%fld_Results%AP015_Mul_Trans_OneTim_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP015)) %v_EXPORT% FIELDS %v_Exp_Fields_AP015%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP015_Mul_Trans_OneTim_Vnd" %v_fileOpt%
COMM
IF (CHK_Exp_AP015=T AND FILESIZE("%fld_Results%AP015D_Mul_Trans_OneTim_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP015D)) OPEN AP015D_Mul_Trans_OneTim_Vnd
%v_cmt% IF (CHK_Exp_AP015=T AND FILESIZE("%fld_Results%AP015D_Mul_Trans_OneTim_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP015D)) COUNT
IF (CHK_Exp_AP015=T AND FILESIZE("%fld_Results%AP015D_Mul_Trans_OneTim_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP015D)) %v_EXPORT% FIELDS %v_Exp_Fields_AP015D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP015D_Mul_Trans_OneTim_Vnd" %v_fileOpt%
COMM
IF (CHK_Exp_AP016=T AND FILESIZE("%fld_Results%AP016_Mis_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP016)) OPEN AP016_Mis_ABN
%v_cmt% IF (CHK_Exp_AP016=T AND FILESIZE("%fld_Results%AP016_Mis_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP016)) COUNT
IF (CHK_Exp_AP016=T AND FILESIZE("%fld_Results%AP016_Mis_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP016)) %v_EXPORT% FIELDS %v_Exp_Fields_AP016%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP016_Mis_ABN" %v_fileOpt%
COMM
IF (CHK_Exp_AP016=T AND FILESIZE("%fld_Results%AP016D_Mis_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP016D)) OPEN AP016D_Mis_ABN
%v_cmt% IF (CHK_Exp_AP016=T AND FILESIZE("%fld_Results%AP016D_Mis_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP016D)) COUNT
IF (CHK_Exp_AP016=T AND FILESIZE("%fld_Results%AP016D_Mis_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP016D)) %v_EXPORT% FIELDS %v_Exp_Fields_AP016D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP016D_Mis_ABN" %v_fileOpt%

COMM *** AP016 -> AP016, VM007, VM008, VM009 ***
COMM
IF (CHK_Exp_AP017=T AND FILESIZE("%fld_Results%AP017_Top_xx_Vnd_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP017)) OPEN AP017_Top_xx_Vnd_xx_Mon
%v_cmt% IF (CHK_Exp_AP017=T AND FILESIZE("%fld_Results%AP017_Top_xx_Vnd_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP017)) COUNT
IF (CHK_Exp_AP017=T AND FILESIZE("%fld_Results%AP017_Top_xx_Vnd_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP017)) %v_EXPORT% FIELDS %v_Exp_Fields_AP017%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP017_Top_xx_Vnd_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_AP017=T AND FILESIZE("%fld_Results%AP017D_Top_xx_Vnd_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP017D)) OPEN AP017D_Top_xx_Vnd_xx_Mon
%v_cmt% IF (CHK_Exp_AP017=T AND FILESIZE("%fld_Results%AP017D_Top_xx_Vnd_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP017D)) COUNT
IF (CHK_Exp_AP017=T AND FILESIZE("%fld_Results%AP017D_Top_xx_Vnd_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP017D)) %v_EXPORT% FIELDS %v_Exp_Fields_AP017D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP017D_Top_xx_Vnd_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_AP018=T AND FILESIZE("%fld_Results%AP018_Near_Alw_Limit.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP018)) OPEN AP018_Near_Alw_Limit
%v_cmt% IF (CHK_Exp_AP018=T AND FILESIZE("%fld_Results%AP018_Near_Alw_Limit.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP018)) COUNT
IF (CHK_Exp_AP018=T AND FILESIZE("%fld_Results%AP018_Near_Alw_Limit.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP018)) %v_EXPORT% FIELDS %v_Exp_Fields_AP018%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP018_Near_Alw_Limit" %v_fileOpt%
COMM
IF (CHK_Exp_AP019=T AND FILESIZE("%fld_Results%AP019_CreditNt_Paid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP019)) OPEN AP019_CreditNt_Paid
%v_cmt% IF (CHK_Exp_AP019=T AND FILESIZE("%fld_Results%AP019_CreditNt_Paid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP019)) COUNT
IF (CHK_Exp_AP019=T AND FILESIZE("%fld_Results%AP019_CreditNt_Paid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP019)) %v_EXPORT% FIELDS %v_Exp_Fields_AP019%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP019_CreditNt_Paid" %v_fileOpt%
COMM
IF (CHK_Exp_AP020=T AND FILESIZE("%fld_Results%AP020_Mul_Paid_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP020)) OPEN AP020_Mul_Paid_Mon
%v_cmt% IF (CHK_Exp_AP020=T AND FILESIZE("%fld_Results%AP020_Mul_Paid_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP020)) COUNT
IF (CHK_Exp_AP020=T AND FILESIZE("%fld_Results%AP020_Mul_Paid_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP020)) %v_EXPORT% FIELDS %v_Exp_Fields_AP020%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP020_Mul_Paid_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_AP020=T AND FILESIZE("%fld_Results%AP020D_Mul_Paid_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP020D)) OPEN AP020D_Mul_Paid_Mon
%v_cmt% IF (CHK_Exp_AP020=T AND FILESIZE("%fld_Results%AP020D_Mul_Paid_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP020D)) COUNT
IF (CHK_Exp_AP020=T AND FILESIZE("%fld_Results%AP020D_Mul_Paid_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP020D)) %v_EXPORT% FIELDS %v_Exp_Fields_AP020D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP020D_Mul_Paid_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_AP021=T AND FILESIZE("%fld_Results%AP021_Chq_Out_Seq.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP021)) OPEN AP021_Chq_Out_Seq
%v_cmt% IF (CHK_Exp_AP021=T AND FILESIZE("%fld_Results%AP021_Chq_Out_Seq.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP021)) COUNT
IF (CHK_Exp_AP021=T AND FILESIZE("%fld_Results%AP021_Chq_Out_Seq.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP021)) %v_EXPORT% FIELDS %v_Exp_Fields_AP021%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP021_Chq_Out_Seq" %v_fileOpt%
COMM
IF (CHK_Exp_AP022=T AND FILESIZE("%fld_Results%AP022_Disc_Mis.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP022)) OPEN AP022_Disc_Mis
%v_cmt% IF (CHK_Exp_AP022=T AND FILESIZE("%fld_Results%AP022_Disc_Mis.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP022)) COUNT
IF (CHK_Exp_AP022=T AND FILESIZE("%fld_Results%AP022_Disc_Mis.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP022)) %v_EXPORT% FIELDS %v_Exp_Fields_AP022%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP022_Disc_Mis" %v_fileOpt%
COMM
IF (CHK_Exp_AP023=T AND FILESIZE("%fld_Results%AP023_Disc_Not_Awd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP023)) OPEN AP023_Disc_Not_Awd
%v_cmt% IF (CHK_Exp_AP023=T AND FILESIZE("%fld_Results%AP023_Disc_Not_Awd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP023)) COUNT
IF (CHK_Exp_AP023=T AND FILESIZE("%fld_Results%AP023_Disc_Not_Awd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP023)) %v_EXPORT% FIELDS %v_Exp_Fields_AP023%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP023_Disc_Not_Awd" %v_fileOpt%
COMM
IF (CHK_Exp_AP024=T AND FILESIZE("%fld_Results%AP024_Low_Act_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP024)) OPEN AP024_Low_Act_Vnd
%v_cmt% IF (CHK_Exp_AP024=T AND FILESIZE("%fld_Results%AP024_Low_Act_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP024)) COUNT
IF (CHK_Exp_AP024=T AND FILESIZE("%fld_Results%AP024_Low_Act_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP024)) %v_EXPORT% FIELDS %v_Exp_Fields_AP024%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP024_Low_Act_Vnd" %v_fileOpt%

COMM *** %v_EXPORT% Employee Master File Tests***
COMM
IF (CHK_Exp_EM001=T AND FILESIZE("%fld_Results%EM001_Dup_TFN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM001)) OPEN EM001_Dup_TFN
%v_cmt% IF (CHK_Exp_EM001=T AND FILESIZE("%fld_Results%EM001_Dup_TFN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM001)) COUNT
IF (CHK_Exp_EM001=T AND FILESIZE("%fld_Results%EM001_Dup_TFN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM001)) %v_EXPORT% FIELDS %v_Exp_Fields_EM001%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM001_Dup_TFN" %v_fileOpt%
COMM
IF (CHK_Exp_EM002=T AND FILESIZE("%fld_Results%EM002_Dup_BnkAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM002)) OPEN EM002_Dup_BnkAcc
%v_cmt% IF (CHK_Exp_EM002=T AND FILESIZE("%fld_Results%EM002_Dup_BnkAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM002)) COUNT
IF (CHK_Exp_EM002=T AND FILESIZE("%fld_Results%EM002_Dup_BnkAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM002)) %v_EXPORT% FIELDS %v_Exp_Fields_EM002%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM002_Dup_BnkAcc" %v_fileOpt%
COMM
IF (CHK_Exp_EM003=T AND FILESIZE("%fld_Results%EM003_Dup_Name.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM003)) OPEN EM003_Dup_Name
%v_cmt% IF (CHK_Exp_EM003=T AND FILESIZE("%fld_Results%EM003_Dup_Name.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM003)) COUNT
IF (CHK_Exp_EM003=T AND FILESIZE("%fld_Results%EM003_Dup_Name.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM003)) %v_EXPORT% FIELDS %v_Exp_Fields_EM003%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM003_Dup_Name" %v_fileOpt%
COMM
IF (CHK_Exp_EM004=T AND FILESIZE("%fld_Results%EM004_Dup_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM004)) OPEN EM004_Dup_Add
%v_cmt% IF (CHK_Exp_EM004=T AND FILESIZE("%fld_Results%EM004_Dup_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM004)) COUNT
IF (CHK_Exp_EM004=T AND FILESIZE("%fld_Results%EM004_Dup_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM004)) %v_EXPORT% FIELDS %v_Exp_Fields_EM004%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM004_Dup_Add" %v_fileOpt%
COMM
IF (CHK_Exp_EM005=T AND FILESIZE("%fld_Results%EM005_Dup_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM005)) OPEN EM005_Dup_Tel
%v_cmt% IF (CHK_Exp_EM005=T AND FILESIZE("%fld_Results%EM005_Dup_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM005)) COUNT
IF (CHK_Exp_EM005=T AND FILESIZE("%fld_Results%EM005_Dup_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM005)) %v_EXPORT% FIELDS %v_Exp_Fields_EM005%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM005_Dup_Tel" %v_fileOpt%
COMM
IF (CHK_Exp_EM006=T AND FILESIZE("%fld_Results%EM006_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM006)) OPEN EM006_Mis_Details
%v_cmt% IF (CHK_Exp_EM006=T AND FILESIZE("%fld_Results%EM006_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM006)) COUNT
IF (CHK_Exp_EM006=T AND FILESIZE("%fld_Results%EM006_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM006)) %v_EXPORT% FIELDS %v_Exp_Fields_EM006%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM006_Mis_Details" %v_fileOpt%
COMM
IF (CHK_Exp_EM007=T AND FILESIZE("%fld_Results%EM007_StartDt_Bf_DOB.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM007)) OPEN EM007_StartDt_Bf_DOB
%v_cmt% IF (CHK_Exp_EM007=T AND FILESIZE("%fld_Results%EM007_StartDt_Bf_DOB.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM007)) COUNT
IF (CHK_Exp_EM007=T AND FILESIZE("%fld_Results%EM007_StartDt_Bf_DOB.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM007)) %v_EXPORT% FIELDS %v_Exp_Fields_EM001%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM007_StartDt_Bf_DOB" %v_fileOpt%
COMM
IF (CHK_Exp_EM008=T AND FILESIZE("%fld_Results%EM008_unKnown_CstCtr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM008)) OPEN EM008_unKnown_CstCtr
%v_cmt% IF (CHK_Exp_EM008=T AND FILESIZE("%fld_Results%EM008_unKnown_CstCtr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM008)) COUNT
IF (CHK_Exp_EM008=T AND FILESIZE("%fld_Results%EM008_unKnown_CstCtr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM008)) %v_EXPORT% FIELDS %v_Exp_Fields_EM008%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM008_unKnown_CstCtr" %v_fileOpt%
COMM
IF (CHK_Exp_EM009=T AND FILESIZE("%fld_Results%EM009_TFN_Invld_Frmt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM009)) OPEN EM009_TFN_Invld_Frmt
%v_cmt% IF (CHK_Exp_EM009=T AND FILESIZE("%fld_Results%EM009_TFN_Invld_Frmt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM009)) COUNT
IF (CHK_Exp_EM009=T AND FILESIZE("%fld_Results%EM009_TFN_Invld_Frmt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM009)) %v_EXPORT% FIELDS %v_Exp_Fields_EM009%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM009_TFN_Invld_Frmt" %v_fileOpt%
COMM
IF (CHK_Exp_EM010=T AND FILESIZE("%fld_Results%EM010_TFN_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM010)) OPEN EM010_TFN_Valid
%v_cmt% IF (CHK_Exp_EM010=T AND FILESIZE("%fld_Results%EM010_TFN_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM010)) COUNT
IF (CHK_Exp_EM010=T AND FILESIZE("%fld_Results%EM010_TFN_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM010)) %v_EXPORT% FIELDS %v_Exp_Fields_EM010%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM010_TFN_Valid" %v_fileOpt%
COMM
IF (CHK_Exp_EM011=T AND FILESIZE("%fld_Results%EM011_BnkAcc_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM011)) OPEN EM011_BnkAcc_Valid
%v_cmt% IF (CHK_Exp_EM011=T AND FILESIZE("%fld_Results%EM011_BnkAcc_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM011)) COUNT
IF (CHK_Exp_EM011=T AND FILESIZE("%fld_Results%EM011_BnkAcc_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM011)) %v_EXPORT% FIELDS %v_Exp_Fields_EM011%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM011_BnkAcc_Valid" %v_fileOpt%
COMM
IF (CHK_Exp_EM012=T AND FILESIZE("%fld_Results%EM012_DOB_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM012)) OPEN EM012_DOB_Valid
%v_cmt% IF (CHK_Exp_EM012=T AND FILESIZE("%fld_Results%EM012_DOB_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM012)) COUNT
IF (CHK_Exp_EM012=T AND FILESIZE("%fld_Results%EM012_DOB_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM012)) %v_EXPORT% FIELDS %v_Exp_Fields_EM012%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM012_DOB_Valid" %v_fileOpt%
COMM
IF (CHK_Exp_EM013=T AND FILESIZE("%fld_Results%EM013_StartDt_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM013)) OPEN EM013_StartDt_Valid
%v_cmt% IF (CHK_Exp_EM013=T AND FILESIZE("%fld_Results%EM013_StartDt_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM013)) COUNT
IF (CHK_Exp_EM013=T AND FILESIZE("%fld_Results%EM013_StartDt_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM013)) %v_EXPORT% FIELDS %v_Exp_Fields_EM013%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM013_StartDt_Valid" %v_fileOpt%
COMM
IF (CHK_Exp_EM014=T AND FILESIZE("%fld_Results%EM014_Tmp_No_EndDt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM014)) OPEN EM014_Tmp_No_EndDt
%v_cmt% IF (CHK_Exp_EM014=T AND FILESIZE("%fld_Results%EM014_Tmp_No_EndDt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM014)) COUNT
IF (CHK_Exp_EM014=T AND FILESIZE("%fld_Results%EM014_Tmp_No_EndDt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM014)) %v_EXPORT% FIELDS %v_Exp_Fields_EM014%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM014_Tmp_No_EndDt" %v_fileOpt%
COMM
IF (CHK_Exp_EM014=T AND FILESIZE("%fld_Results%EM015_Not_Taken_Leave.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM014)) OPEN EM015_Not_Taken_Leave
%v_cmt% IF (CHK_Exp_EM014=T AND FILESIZE("%fld_Results%EM015_Not_Taken_Leave.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM014)) COUNT
IF (CHK_Exp_EM014=T AND FILESIZE("%fld_Results%EM015_Not_Taken_Leave.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM014)) %v_EXPORT% FIELDS %v_Exp_Fields_EM014%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM015_Not_Taken_Leave" %v_fileOpt%
COMM
IF (CHK_Exp_EM015=T AND FILESIZE("%fld_Results%EM015_Not_Taken_AL.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM015)) OPEN EM015_Not_Taken_AL
IF (CHK_Exp_EM015=T AND FILESIZE("%fld_Results%EM015_Not_Taken_AL.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM015)) %v_EXPORT% FIELDS %v_Exp_Fields_EM015%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM015_Not_Taken_AL%suffix%" %v_fileOpt%
COMM
IF (CHK_Exp_EM016=T AND FILESIZE("%fld_Results%EM016_TooMuch_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM016)) OPEN EM016_TooMuch_SickLv
IF (CHK_Exp_EM016=T AND FILESIZE("%fld_Results%EM016_TooMuch_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM016)) %v_EXPORT% FIELDS %v_Exp_Fields_EM016%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM016_TooMuch_SickLv%suffix%" %v_fileOpt%
COMM
IF (CHK_Exp_EM016=T AND FILESIZE("%fld_Results%EM016D_TooMuch_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM016D)) OPEN EM016D_TooMuch_SickLv
IF (CHK_Exp_EM016=T AND FILESIZE("%fld_Results%EM016D_TooMuch_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM016D)) %v_EXPORT% FIELDS %v_Exp_Fields_EM016D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM016D_TooMuch_SickLv%suffix%" %v_fileOpt%
COMM
IF (CHK_Exp_EM017=T AND FILESIZE("%fld_Results%EM017_Neg_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM017)) OPEN EM017_Neg_SickLv
IF (CHK_Exp_EM017=T AND FILESIZE("%fld_Results%EM017_Neg_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM017)) %v_EXPORT% FIELDS %v_Exp_Fields_EM016%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM016_Neg_SickLv%suffix%" %v_fileOpt%
COMM
IF (CHK_Exp_EM017=T AND FILESIZE("%fld_Results%EM017D_Neg_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM017D)) OPEN EM017D_Neg_SickLv
IF (CHK_Exp_EM017=T AND FILESIZE("%fld_Results%EM017D_Neg_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM017D)) %v_EXPORT% FIELDS %v_Exp_Fields_EM016D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM016D_Neg_SickLv%suffix%" %v_fileOpt%



COMM *** %v_EXPORT% Payroll Tests ***
COMM
IF (CHK_Exp_PR001=T AND FILESIZE("%fld_Results%PR001_Mul_Paid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR001)) OPEN PR001_Mul_Paid
%v_cmt% IF (CHK_Exp_PR001=T AND FILESIZE("%fld_Results%PR001_Mul_Paid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR001)) COUNT
IF (CHK_Exp_PR001=T AND FILESIZE("%fld_Results%PR001_Mul_Paid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR001)) %v_EXPORT% FIELDS %v_Exp_Fields_PR001%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR001_Mul_Paid" %v_fileOpt%
COMM
IF (CHK_Exp_PR002=T AND FILESIZE("%fld_Results%PR002_Not_in_Emf.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR002)) OPEN PR002_Not_in_Emf
%v_cmt% IF (CHK_Exp_PR002=T AND FILESIZE("%fld_Results%PR002_Not_in_Emf.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR002)) COUNT
IF (CHK_Exp_PR002=T AND FILESIZE("%fld_Results%PR002_Not_in_Emf.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR002)) %v_EXPORT% FIELDS %v_Exp_Fields_PR002%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR002_Not_in_Emf" %v_fileOpt%
COMM
IF (CHK_Exp_PR003=T AND FILESIZE("%fld_Results%PR003_Pay_30D_Af_Trm.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR003)) OPEN PR003_Pay_30D_Af_Trm
%v_cmt% IF (CHK_Exp_PR003=T AND FILESIZE("%fld_Results%PR003_Pay_30D_Af_Trm.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR003)) COUNT
IF (CHK_Exp_PR003=T AND FILESIZE("%fld_Results%PR003_Pay_30D_Af_Trm.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR003)) %v_EXPORT% FIELDS %v_Exp_Fields_PR003%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR003_Pay_30D_Af_Trm" %v_fileOpt%
COMM
IF (CHK_Exp_PR004=T AND FILESIZE("%fld_Results%PR004_Spec_Leave_3Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR004)) OPEN PR004_Spec_Leave_3Mon
%v_cmt% IF (CHK_Exp_PR004=T AND FILESIZE("%fld_Results%PR004_Spec_Leave_3Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR004)) COUNT
IF (CHK_Exp_PR004=T AND FILESIZE("%fld_Results%PR004_Spec_Leave_3Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR004)) %v_EXPORT% FIELDS %v_Exp_Fields_PR004%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR004_Spec_Leave_3Mon" %v_fileOpt%
COMM
IF (CHK_Exp_PR005=T AND FILESIZE("%fld_Results%PR005_Pay_TrmAmt_Sleeper.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR005)) OPEN PR005_Pay_TrmAmt_Sleeper
%v_cmt% IF (CHK_Exp_PR005=T AND FILESIZE("%fld_Results%PR005_Pay_TrmAmt_Sleeper.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR005)) COUNT
IF (CHK_Exp_PR005=T AND FILESIZE("%fld_Results%PR005_Pay_TrmAmt_Sleeper.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR005)) %v_EXPORT% FIELDS %v_Exp_Fields_PR005%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR005_Pay_TrmAmt_Sleeper" %v_fileOpt%
COMM
IF (CHK_Exp_PR006=T AND FILESIZE("%fld_Results%PR006_Unusual_Super.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR006)) OPEN PR006_Unusual_Super
%v_cmt% IF (CHK_Exp_PR006=T AND FILESIZE("%fld_Results%PR006_Unusual_Super.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR006)) COUNT
IF (CHK_Exp_PR006=T AND FILESIZE("%fld_Results%PR006_Unusual_Super.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR006)) %v_EXPORT% FIELDS %v_Exp_Fields_PR006%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR006_Unusual_Super" %v_fileOpt%
COMM
IF (CHK_Exp_PR007=T AND FILESIZE("%fld_Results%PR007_Hourly_Emp.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR007)) OPEN PR007_Hourly_Emp
%v_cmt% IF (CHK_Exp_PR007=T AND FILESIZE("%fld_Results%PR007_Hourly_Emp.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR007)) COUNT
IF (CHK_Exp_PR007=T AND FILESIZE("%fld_Results%PR007_Hourly_Emp.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR007)) %v_EXPORT% FIELDS %v_Exp_Fields_PR007%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR007_Hourly_Emp" %v_fileOpt%
COMM
IF (CHK_Exp_PR008=T AND FILESIZE("%fld_Results%PR008_Top_xx_Over_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR008)) OPEN PR008_Top_xx_Over_xx_Mon
%v_cmt% IF (CHK_Exp_PR008=T AND FILESIZE("%fld_Results%PR008_Top_xx_Over_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR008)) COUNT
IF (CHK_Exp_PR008=T AND FILESIZE("%fld_Results%PR008_Top_xx_Over_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR008)) %v_EXPORT% FIELDS %v_Exp_Fields_PR008%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR008_Top_xx_Over_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_PR008=T AND FILESIZE("%fld_Results%PR008D_Top_xx_Over_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR008D)) OPEN PR008D_Top_xx_Over_xx_Mon
%v_cmt% IF (CHK_Exp_PR008=T AND FILESIZE("%fld_Results%PR008D_Top_xx_Over_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR008D)) COUNT
IF (CHK_Exp_PR008=T AND FILESIZE("%fld_Results%PR008D_Top_xx_Over_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR008D)) %v_EXPORT% FIELDS %v_Exp_Fields_PR008D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR008D_Top_xx_Over_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_PR009=T AND FILESIZE("%fld_Results%PR009_Pay_x_Times_Avg.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR009)) OPEN PR009_Pay_x_Times_Avg
%v_cmt% IF (CHK_Exp_PR009=T AND FILESIZE("%fld_Results%PR009_Pay_x_Times_Avg.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR009)) COUNT
IF (CHK_Exp_PR009=T AND FILESIZE("%fld_Results%PR009_Pay_x_Times_Avg.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR009)) %v_EXPORT% FIELDS %v_Exp_Fields_PR009%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR009_Pay_x_Times_Avg" %v_fileOpt%
COMM
IF (CHK_Exp_PR009=T AND FILESIZE("%fld_Results%PR009D_Pay_x_Times_Avg.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR009D)) OPEN PR009D_Pay_x_Times_Avg
%v_cmt% IF (CHK_Exp_PR009=T AND FILESIZE("%fld_Results%PR009D_Pay_x_Times_Avg.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR009D)) COUNT
IF (CHK_Exp_PR009=T AND FILESIZE("%fld_Results%PR009D_Pay_x_Times_Avg.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR009D)) %v_EXPORT% FIELDS %v_Exp_Fields_PR009D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR009D_Pay_x_Times_Avg" %v_fileOpt%
COMM
COMM *** %v_EXPORT% Statistics Summary Reports ***
IF (CHK_Exp_ST001=T AND FILESIZE("%fld_Results%ST001_Vnd_Tst_Sum.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST001)) OPEN ST001_Vnd_Tst_Sum
%v_cmt% IF (CHK_Exp_ST001=T AND FILESIZE("%fld_Results%ST001_Vnd_Tst_Sum.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST001)) COUNT
IF (CHK_Exp_ST001=T AND FILESIZE("%fld_Results%ST001_Vnd_Tst_Sum.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST001)) %v_EXPORT% FIELDS %v_Exp_Fields_ST001%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%ST001_Vnd_Tst_Sum" %v_fileOpt%
COMM
IF (CHK_Exp_ST001=T AND FILESIZE("%fld_Results%ST001D_Vnd_Tst_Sum.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST001D)) OPEN ST001D_Vnd_Tst_Sum
%v_cmt% IF (CHK_Exp_ST001=T AND FILESIZE("%fld_Results%ST001D_Vnd_Tst_Sum.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST001D)) COUNT
IF (CHK_Exp_ST001=T AND FILESIZE("%fld_Results%ST001D_Vnd_Tst_Sum.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST001D)) %v_EXPORT% FIELDS %v_Exp_Fields_ST001D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%ST001D_Vnd_Tst_Sum" %v_fileOpt%
COMM
IF (CHK_Exp_ST002=T AND FILESIZE("%fld_Results%ST002_Rev_Sum_RevDays.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST002)) OPEN ST002_Rev_Sum_RevDays
%v_cmt% IF (CHK_Exp_ST002=T AND FILESIZE("%fld_Results%ST002_Rev_Sum_RevDays.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST002)) COUNT
IF (CHK_Exp_ST002=T AND FILESIZE("%fld_Results%ST002_Rev_Sum_RevDays.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST002)) %v_EXPORT% FIELDS %v_Exp_Fields_ST002%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%ST002_Rev_Sum_RevDays" %v_fileOpt%
COMM
IF (CHK_Exp_ST003=T AND FILESIZE("%fld_Results%ST003_Rev_Vnd_Dup.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST003)) OPEN ST003_Rev_Vnd_Dup
%v_cmt% IF (CHK_Exp_ST003=T AND FILESIZE("%fld_Results%ST003_Rev_Vnd_Dup.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST003)) COUNT
IF (CHK_Exp_ST003=T AND FILESIZE("%fld_Results%ST003_Rev_Vnd_Dup.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST003)) %v_EXPORT% FIELDS %v_Exp_Fields_ST003%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%ST003_Rev_Vnd_Dup" %v_fileOpt%
COMM
IF (CHK_Exp_ST004=T AND FILESIZE("%fld_Results%ST004_Vnd_Ranking.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST004)) OPEN ST004_Vnd_Ranking
%v_cmt% IF (CHK_Exp_ST004=T AND FILESIZE("%fld_Results%ST004_Vnd_Ranking.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST004)) COUNT
IF (CHK_Exp_ST004=T AND FILESIZE("%fld_Results%ST004_Vnd_Ranking.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST004)) %v_EXPORT% FIELDS %v_Exp_Fields_ST004%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%ST004_Vnd_Ranking" %v_fileOpt%
COMM
IF (CHK_Exp_ST005=T AND FILESIZE("%fld_Results%ST005_Distr_Inv_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST005)) OPEN ST005_Distr_Inv_Mon
%v_cmt% IF (CHK_Exp_ST005=T AND FILESIZE("%fld_Results%ST005_Distr_Inv_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST005)) COUNT
IF (CHK_Exp_ST005=T AND FILESIZE("%fld_Results%ST005_Distr_Inv_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST005)) %v_EXPORT% FIELDS %v_Exp_Fields_ST005%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%ST005_Distr_Inv_Mon" %v_fileOpt%


SET SAFETY ON

^BATCH    UU001_Exp_AP_HIST2                 
[PARENT_FOLDER_ID] 1430796679
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Export Test Results into spesfic file format (e.g. Access, Excel, Text, Del and XML)
COMM *** Called by UA001_Export_Menu
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("TXT_Exp_filepath")="U" DO AA002_Variable_Setting
IF ISBLANK(TXT_Exp_filepath) TXT_Exp_filepath="Reports\"
IF LAST(ALLTRIM(TXT_Exp_filepath),1)<>"\" TXT_Exp_filepath=ALLTRIM(TXT_Exp_filepath)+"\"
IF FTYPE("TXT_AP014_Months")="U" DO AC002_Test_Var_Input

SET SAFETY OFF
SET ECHO ON

COMM For delimited files, define the separator and the qualifier on this line: IF (rad1=4) v_fileOpt       = "KEEPTITLE SEPARATOR TAB QUALIFIER ''"

IF (rad1=1) v_exporttype    = "ACCESS"
IF (rad1=1) v_fileext       = "MDB"
IF (rad1=1) v_fileOpt       = ""
IF (rad1=2) v_exporttype    = "EXCEL"
IF (rad1=2) v_fileext       = ""
IF (rad1=2) v_fileOpt       = ""
IF (rad1=3) v_exporttype    = "ASCII"
IF (rad1=3) v_fileext       = ""
IF (rad1=3) v_fileOpt       = "KEEPTITLE"
IF (rad1=4) v_exporttype    = "DELIMITED"
IF (rad1=4) v_fileext       = "DEL"
IF (rad1=4) v_fileOpt       = "KEEPTITLE SEPARATOR TAB"
IF (rad1=5) v_exporttype    = "XML"
IF (rad1=5) v_fileext       = "XML"
IF (rad1=5) v_fileOpt       = ""
IF (rad1=6) v_exporttype    = ""  
IF (rad1=6) v_fileext       = ""
IF (rad1=6) v_fileOpt       = ""
IF (rad1=6) v_EXPORT       = "EXTRACT"
IF (rad1<>6) v_EXPORT       = "EXPORT"
IF (rad1=6) v_Pre       = "RP_"
IF (rad1<>6) v_Pre       = ""
IF (rad1=6) SET FOLDER /%fld_Reports%
IF (rad1<>6) SET FOLDER /%fld_Tmps%

v_cmt="COMMENT"
v_if=""
IF rad1=5 AND v_AppCWM="" v_cmt=""
IF rad1=5 AND v_AppCWM="" v_if=" AND COUNT1>0 "

COMM *** Alvin's note: need to change Data Range Start and End Dates for all VM tests
COMM *** Vendor Master File Tests Output***
v_Exp_Fields_VM001 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' VMF_BnkAcc.BSB AS 'BSB' VMF_BnkAcc.Bnk_Acc_Num AS 'Bnk_Acc_Num' VMF_BnkAcc.Bnk_Acc_Name AS 'Bank Account Name' VMF_BnkAcc.Dt_Field1 VMF_BnkAcc.Dt_Field2 AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM001 = " Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' BSB Bnk_Acc_Num AS 'Bank Account Number' Bnk_Acc_Name AS 'Bank Account Name' VMF_BnkAcc.Dt_Field1 AS 'Start_Date' VMF_BnkAcc.Dt_Field2 AS 'End_Date' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date' Cha_Field2 AS 'Gst Registration Status' TEL1 AS 'Phone' FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System' TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_VM002 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM002= "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN Vndr_Sts AS 'Vendor Status' Vndr_Typ AS 'Vendor Type' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date'  TEL1 AS 'Phone'  FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System' TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_VM003 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM003 = "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status'  ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' TEL1 AS 'Phone'  FAX AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date' Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System'  TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_VM004 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' TEL1 AS 'Phone' FAX AS 'Fax' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM004 = "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status'  TEL1 AS 'Phone'  FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode Cntry AS 'Country'  AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System' TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_VM005 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM005 = "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date'  TEL1 AS 'Phone' FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System'  TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

COMM *** Missing Details ABN/Address/Tel ***
v_Exp_Fields_VM006 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN Cha_Field2 AS 'GST Status' Vndr_Typ AS 'Vendor Type' Pymnt_Trm  AS 'Payment Method' VMF_BnkAcc.BSB VMF_BnkAcc.Bnk_Acc_Num AS 'Bank Account Number' VMF_BnkAcc.Bnk_Acc_Name AS 'Bank Account Name' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM006 = "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN AS 'ABN' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Inv_Amt AS 'Total Invoice Amount' GST_AMT AS 'Total GST Amount' COUNT AS 'Total Trans Num'  DATE(Max_Inv_Dt) AS 'Last Invoice Date' TEL1 AS 'Phone' FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode Cntry AS 'Country'  Pymnt_Trm AS 'Payment Method' Co AS 'Company' DATE(Modf_Dt) AS 'Modified Date' Priority Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System'  TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"

COMM *** Missing Details ABN/Address/Tel Invoice Details***

v_Exp_Fields_VM006D = "VM006_Mis_Details.Cha_Field1 AS 'Vendor Site'  VM006_Mis_Details.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status'  ' '+ Inv_No AS 'Invoice Number' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Doc_Typ AS 'Document Type' Descrp AS 'Description'   isPaid AS 'Paid' Vchr_ID AS 'Voucher Number' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM *** Invalid ABN Format ***
v_Exp_Fields_VM007 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM007 = "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN AS 'ABN' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Inv_Amt AS 'Total Invoice Amount' GST_AMT AS 'Total GST Amount' COUNT AS 'Total Trans Num'  DATE(Max_Inv_Dt) AS 'Last Invoice Date' TEL1 AS 'Phone' FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode Cntry AS 'Country'  Pymnt_Trm AS 'Payment Method' Co AS 'Company' DATE(Modf_Dt) AS 'Modified Date' Priority Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System'  TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

COMM *** Invalid ABN Format Details***
COMM
v_Exp_Fields_VM007D = "Cha_Field1 AS 'Vendor Site'  Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name'  Vndr_Sts AS 'Vendor Status'  ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount'  GST_AMT AS 'GST Amount' Inv_Net_Amt AS 'Applied Amount' Num_Field1 AS 'Pay Amount' Vchr_ID AS 'Trans Num' Btch_No AS 'Trans Ref' Cha_Field1 AS 'Pay Reference' Cha_Field2 AS 'Pay Method' Pymnt_Trms AS 'Payment Method' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_VM007D =  "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' VMF_VND_Master_File.Cha_Field4 AS 'Vendor Number' VMF_VND_Master_File.Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"

COMM *** Cancelled / Registration ABN ***
v_Exp_Fields_VM008 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN ASIC_entityStatusCode AS 'ABN Status' ASIC_entityStatusEF AS 'ABN Status Eff Date' Vndr_Typ AS 'Vendor Type' VM008Z_Can_ABN_Sum.Inv_Amt AS 'Total Invoice Amount' VM008Z_Can_ABN_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM008 =  "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN AS 'ABN' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' VM008Z_Can_ABN_Sum.Inv_Amt AS 'Total Invoice Amount' GST_AMT AS 'Total GST Amount' COUNT AS 'Total Trans Num'  DATE(Max_Inv_Dt) AS 'Last Invoice Date' TEL1 AS 'Phone' FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode Cntry AS 'Country'  Pymnt_Trm AS 'Payment Method' Co AS 'Company' DATE(Modf_Dt) AS 'Modified Date' Priority Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System'  TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"


v_Exp_Fields_VM008D = "VM008_can_ABN.Cha_Field1  AS 'Vendor Site'  VM008_can_ABN.Cha_Field4 AS 'Vendor Number' VM008_can_ABN.Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"

COMM *** Invalid ABN Format against ABR***
v_Exp_Fields_VM009 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM009 = "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN AS 'ABN' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Inv_Amt AS 'Total Invoice Amount' GST_AMT AS 'Total GST Amount' COUNT AS 'Total Trans Num'  DATE(Max_Inv_Dt) AS 'Last Invoice Date' TEL1 AS 'Phone' FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode Cntry AS 'Country'  Pymnt_Trm AS 'Payment Method' Co AS 'Company' DATE(Modf_Dt) AS 'Modified Date' Priority Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System'  TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"

COMM *** Invalid ABN Format against ABR Details***
v_Exp_Fields_VM009D = "VM009_Invld_ABN_ABR.Cha_Field1 AS 'Vendor Site'  VM009_Invld_ABN_ABR.Cha_Field4 AS 'Vendor Number' VM009_Invld_ABN_ABR.Vndr_Nme AS 'Vendor Name'   Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"


COMM
v_Exp_Fields_VM010 = "Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status' ABN ASIC_entityStatusCode AS 'ABN Status' DATE(ASIC_entityStatusEF) AS 'ABN Registration Date' DATE(ASIC_GST_effFrom) AS 'GST Registration Date' DATE(ASIC_GST_effTo) AS 'GST Expiry Date' VM010D_DeReg_GST_Sum.Inv_Amt AS 'Total Invoice Amount Post GST Expiry' VM010D_DeReg_GST_Sum.GST_Amt AS 'GST Paid Post GST Expiry' VM010D_DeReg_GST_Sum.COUNT AS 'Num Transactions Post GST Expiry' DATE(Max_Inv_Dt) AS 'Last Invoice Date' ASIC_entityDescription AS 'ASIC Description' ADD1 TEL1 Email1 Pymnt_Trm AS 'Payment Terms' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM010D = "Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status'  ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' ASIC_GST_effTo AS 'GST Expired Date' Inv_Amt AS 'Invoice Amount'  GST_AMT AS 'GST Amount' Inv_Net_Amt AS 'Applied Amount' Num_Field1 AS 'Pay Amount' Vchr_ID AS 'Trans Num' Btch_No AS 'Trans Ref' Cha_Field1 AS 'Pay Reference' Cha_Field2 AS 'Pay Method' Pymnt_Trms AS 'Term Code Desc' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM011 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status'ABN TEL1 TEL2 TEL3 ADD1 AS 'Address1' ADD2 AS 'Address2' ADD3 AS 'Address3' City AS 'City' State AS 'State' Email1 Email2 AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM012 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Vndr_InvlDt AS 'InActive Date' ABN Inv_Amt AS 'Total Invoice Amount Post InActive' GST_AMT AS 'Total GST Amount Post InActive' COUNT AS 'Total Trans Num Post InActive' DATE(Max_Inv_Dt) AS 'Last Invoice Date' ADD1 ADD2 ADD3 City State Cntry AS 'Country' TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm AS 'Payment Terms' Co AS 'Company' DATE(Modf_Dt) AS 'Modified Date' Priority  TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM012D = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' VM012_Inac_xx_Mon.Vndr_InvlDt AS 'Vendor InActive Date' Inv_Amt AS 'Invoice Amount' GST_AMT AS 'GST Amount' Inv_Net_Amt AS 'Inv Net Amount' DATE(Pd_Dt) AS 'Payment Date' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  isPaid AS 'Paid' Vchr_ID AS 'Voucher Number' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM013 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Trans_Num AS 'Trans Number' Inv_Amt AS 'Total Invoice Amount' GST_Amt AS 'Total GST Amount' DATE(Max_Inv_Dt) AS 'Last Invoice Date' ABN TEL1 City State Cntry AS 'Country' Pymnt_Trm AS 'Payment Terms' Created_Dt AS 'Created Date' DATE(Modf_Dt) AS 'Modified Date' Co AS 'Company' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM013D = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' GST_Amt AS 'GST Amount' Inv_Net_Amt AS 'Inv Net Amount' DATE(Pd_Dt) AS 'Payment Date' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM014 = "VM_EM Vndr_Site_ID Vndr_ID Vndr_Nme Vndr_Typ ABN BSB Bnk_Acc_Num ADD1 ADD2 ADD3 City State PCode Cntry TEL1 TEL2 TEL3 FAX Email1 Inv_Amt GST_Amt COUNT ABN Vndr_Sts Hire_Dt Created_Dt Modf_Dt Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM015 = "VM_EM Vndr_Site_ID Vndr_ID Vndr_Nme Vndr_Typ ABN BSB Bnk_Acc_Num ADD1 ADD2 ADD3 City State PCode Cntry TEL1 TEL2 TEL3 FAX Email1 Inv_Amt GST_Amt COUNT ABN Vndr_Sts Hire_Dt Created_Dt Modf_Dt Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM016 = "VM_EM Vndr_Site_ID Vndr_ID Vndr_Nme Vndr_Typ ABN BSB Bnk_Acc_Num ADD1 ADD2 ADD3 City State PCode Cntry TEL1 TEL2 TEL3 FAX Email1 Inv_Amt GST_Amt COUNT ABN Vndr_Sts Hire_Dt Created_Dt Modf_Dt Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM017 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date' Email1 Email2 ABN TEL1 TEL2 TEL3 ADD1 AS 'Address1' ADD2 AS 'Address2' ADD3 AS 'Address3' City AS 'City' State AS 'State' Pcode Cntry AS 'Country' TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

COMM *** Accounts Payable Tests Output***

v_Exp_Fields_AP001 = "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' VMF_VND_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_AP001 = "Flag VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description'  Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc" 

v_Exp_Fields_AP002 = "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' VMF_VND_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_AP002 = "Flag VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description' Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc" 

v_Exp_Fields_AP003 = "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' VMF_VND_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_AP003 = "Flag VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description' Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc" 

v_Exp_Fields_AP004 = "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' VMF_VND_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_AP004 = "Flag VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description'  Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc" 

COMM
v_Exp_Fields_AP005 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Inv_No AS 'Invoice Reference Seq Start' DATE(Inv_Dt) AS 'Invoice Date 1' ' '+ Inv_No2 AS 'Invoice Reference Seq End' DATE(Inv_Dt2) AS 'Invoice Date 2' Consec_Num AS 'Consecutive Num' Priority TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' REC_KEY SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP005D = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' GST_Amt AS 'GST Amount' Inv_Net_Amt AS 'Inv Net Amount' DATE(Pd_Dt) AS 'Payment Date' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' REC_KEY SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_AP006 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_AP006 = " Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description'  Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc" 

COMM
v_Exp_Fields_AP008 = "Cha_Field1 AS 'BUSINESS' Vndr_Sts AS 'Vendor Status' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' AllowLimit Inv_Amt AS 'Invoice Amount' DiffAmt AS 'Over Limit Amount' GST_Amt AS 'GST Amount' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invice Date' Vchr_ID AS 'Voucher Number' Doc_Typ AS 'Doc Type' Descrp AS 'Description' Curncy AS 'Currrency' DATE(Pd_Dt) AS 'Paid Date' PO_No isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date'  SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP009 = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status'  ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' GST_Amt AS 'GST Amount' GST_Pct Inv_Net_Amt AS 'Inv Net Amount' DATE(Pd_Dt) AS 'Payment Date' Doc_Typ AS 'Document Type' VMF_Vnd_Master_File.State AS 'State' VMF_Vnd_Master_File.Cntry AS 'Country' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP010 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Avg_Inv_Amt AS 'Average Invoice Amount' Max_Inv_Amt AS 'Largest Amount' Snd_Inv_Amt AS 'Second Largest Amount' Min_Inv_Amt AS 'Smallest Amount' c_Max_Avg_Pct AS 'Pct Largest to Average' c_Max_Snd_Pct AS 'Pct Largest to Second' Ttl_Inv_Amt_75 AS 'Total Invoice Amount 75' Count_75 AS 'Total Num 75' Ttl_Inv_Amt AS 'Total Invoice Amount' Ttl_Count AS 'Total Trans Num' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP010D = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Avg_Inv_Amt AS 'Average Invoice Amount' c_Inv_Avg_Pct AS 'Pct Invoice Amount to Average' GST_Amt AS 'GST Amount' Inv_Net_Amt AS 'Inv Net Amount' DATE(Pd_Dt) AS 'Payment Date' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM OLD AP011
COMM
v_Exp_Fields_AP011 = "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status'  Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' VMF_VND_Master_File.TEL1 AS 'Phone' VMF_VND_Master_File.FAX AS 'FAX' VMF_VND_Master_File.ADD1 AS 'Address' VMF_VND_Master_File.City AS 'City' VMF_VND_Master_File.State AS 'State' VMF_VND_Master_File.Pcode AS 'Postcode'  VMF_VND_Master_File.Cntry AS 'Country' VMF_VND_Master_File.Pymnt_Trms AS 'Payment Method' VMF_VND_Master_File.Vndr_Site_ID AS 'Vendor Site ID' VMF_VND_Master_File.Cha_Field3 AS 'Source System'  Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM
v_Exp_Fields_AP012 = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' DATE(Pd_Dt) AS 'Payment Date'  Inv_Amt AS 'Invoice Amount' PO_NO Rec_Qty AS 'Received Quantity' Rec_Amt AS 'Received Amount' Rec_Dt AS 'Received Date' PO_Date Amount AS 'PO Amount' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' GST_Amt AS 'GST Amount' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP013 = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Inv_Net_Amt AS 'Inv Net Amount' PO_NO Pst_Dt as 'Post Date' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' GST_Amt AS 'GST Amount' DATE(Pd_Dt) AS 'Payment Date' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM


v_Exp_Fields_AP014  = "VMF_Vnd_Master_File.Cha_Field1 AS 'Vendor Site' VMF_Vnd_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status'  Vndr_Typ AS 'Vendor Type' VMF_VND_Master_File.TEL1 AS 'Phone' VMF_VND_Master_File.FAX AS 'FAX' VMF_VND_Master_File.ADD1 AS 'Address' VMF_VND_Master_File.City AS 'City' VMF_VND_Master_File.State AS 'State' VMF_VND_Master_File.Pcode AS 'Postcode'  VMF_VND_Master_File.Cntry AS 'Country' VMF_Vnd_Master_File.Pymnt_Trm AS 'Payment Method' VMF_VND_Master_File.Vndr_Site_ID AS 'Vendor Site ID' VMF_VND_Master_File.Cha_Field3 AS 'Source System'  Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM
v_Exp_Fields_AP014  = "VMF_Vnd_Master_File.Cha_Field1 AS 'Vendor Site' VMF_Vnd_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
END

COMM v_Exp_Fields_AP014  = "VMF_Vnd_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status'  Vndr_Typ AS 'Vendor Type' VMF_VND_Master_File.TEL1 AS 'Phone' VMF_VND_Master_File.FAX AS 'FAX' VMF_VND_Master_File.ADD1 AS 'Address' VMF_VND_Master_File.City AS 'City' VMF_VND_Master_File.State AS 'State' VMF_VND_Master_File.Pcode AS 'Postcode'  VMF_VND_Master_File.Cntry AS 'Country' VMF_Vnd_Master_File.Pymnt_Trm AS 'Payment Method' VMF_VND_Master_File.Vndr_Site_ID AS 'Vendor Site ID' VMF_VND_Master_File.Cha_Field3 AS 'Source System'  Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM OLD copy of AP0014
COMM
v_Exp_Fields_AP014 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' ABN TEL1 City State Cntry AS 'Country' Pymnt_Trm AS 'Payment Terms' DATE(Max_Inv_Dt) AS 'Last Invoice Date' Created_Dt AS 'Created Date' DATE(Modf_Dt) AS 'Modified Date' Co AS 'Company' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP015 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Ttl_Inv_Amt AS 'Total Invoice Amount' Ttl_GST_Amt AS 'Total GST Amount' Count AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date' DATE(Modf_Dt) AS 'Modified Date' City State Cntry AS 'Country' TEL1 Pymnt_Trm AS 'Payment Terms' Co AS 'Company' DATE(Modf_Dt) AS 'Modified Date' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP015D = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' GST_Amt AS 'GST Amount' Inv_Net_Amt AS 'Inv Net Amount' DATE(Pd_Dt) AS 'Payment Date' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM *** Tech One***
COMM
v_Exp_Fields_AP015=""
v_Exp_Fields_AP015D = "isPaid AS 'Paid'  Vndr_ID Vndr_Nme Vndr_Sts Vndr_Typ Sub_Vnd_Nme Add City_PCode Inv_No Inv_Dt Inv_Amt Gst_Amt Inv_NetAmt Currency Pst_Dt Doc_Typ Trans_Typ TrType_Desc PO_NO Pay_DocNbr Pay_Date Pay_DocTyp Trans_Nbr Alloc_Trans_Nbr Period Pst_User  Vchr_ID AS 'Voucher Number' Priority TEST_NAME RptRunDate AS 'Test Date' Data_Rage_Start_Date AS 'Data_Range_Start_Date' Data_Rage_End_Date AS 'Data_Range_End_Date' Grp_KEY SORT_KEY SORT_KEY_Desc"

COMM *** SAP ***
COMM
v_Exp_Fields_AP015 = "Cha_Field4 AS 'Co' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' BSEC_NAME1 AS 'One Time Vendor Name' Inv_Amt AS 'Total Invoice Amount' Doc_Num AS 'Trans Number' BSEC_BANKL AS 'BSB' BSEC_BANKN AS 'Bank Acc Number' BSEC_STRAS AS 'Address' BSEC_PSTLZ AS 'Post Code' BSEC_ORT01 AS 'City' BSEC_REGIO AS 'State' BSEC_STCD1 AS 'TaxNbr' Curncy AS 'Currency' TEST_NAME RptRunDate AS 'Test Date' Data_Rage_Start_Date Data_Rage_End_Date SORT_KEY SORT_KEY_Desc Grp_KEY ID_KEY"
v_Exp_Fields_AP015D = "isPaid Cha_Field4 AS 'Co' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' BSEC_NAME1 AS 'One Time Vendor Name' BSEC_BANKL AS 'BSB' BSEC_BANKN AS 'Bank Acc Number'  Inv_No  AS 'Invoice Reference' DATETIME(Inv_Dt,'DD/MM/YYYY') AS 'Invoice Date' Inv_Amt AS 'Doc Invoice Amount' Curncy AS 'Currency' Inv_Amt_Loc AS 'Local Invoice Amount'  Doc_Typ AS 'Doc Type' Btch_No AS 'Doc Number' Descrp VOIDED Pst_Dt as 'Post Date' Cha_Field2 AS 'Clr_DocNbr' Pymnt_Trms Cha_Field1 AS 'Fiscal Year' Cha_Field3 AS 'Reversal Doc' Priority TEST_NAME RptRunDate AS 'Test Date' Data_Rage_Start_Date Data_Rage_End_Date SORT_KEY SORT_KEY_Desc Grp_KEY"


COMM *** Missing ABN***
COMM
v_Exp_Fields_AP016 = "Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status' Inv_Amt AS 'Total Invoice Amount' GST_AMT AS 'Total GST Amount' COUNT AS 'Total Trans Num' ABN AS 'ABN' DATE(Max_Inv_Dt) AS 'Last Invoice Date' ADD1 TEL1 Email1 Pymnt_Trm AS 'Payment Terms' Priority  TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"

COMM *** Missing ABN Invoice Details***
COMM
v_Exp_Fields_AP016D = "Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status'  ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount'  GST_AMT AS 'GST Amount' Inv_Net_Amt AS 'Applied Amount' Num_Field1 AS 'Pay Amount' Vchr_ID AS 'Trans Num' Btch_No AS 'Trans Ref' Cha_Field1 AS 'Pay Reference' Cha_Field2 AS 'Pay Method' Pymnt_Trms AS 'Term Code Desc' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP017 = "Vndr_Sts AS 'Vendor Status' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Inv_Amt AS 'Total Invoice Amount' GST_Amt AS 'Total GST Amount' COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date' ABN ADD1 AS 'Address1' State AS 'State' Cntry AS 'Country' TEL1 Priority TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date'  SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP017D = "Cha_Field1 AS 'BUSINESS' isPaid Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Inv_Amt AS 'Invoice Amount' GST_Amt AS 'GST Amount' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' DATE(Pd_Dt) AS 'Payment Date' Descrp AS 'Description' Curncy AS 'Currency' Priority TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date'  SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP018 = "Cha_Field1 AS 'BUSINESS' Vndr_Sts AS 'Vendor Status' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' AllowLimit Inv_Amt AS 'Invoice Amount' DiffAmt AS 'Under/Over Limit Amount' GST_Amt AS 'GST Amount' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invice Date' Vchr_ID AS 'Voucher Number' Doc_Typ AS 'Doc Type' Descrp AS 'Description' Curncy AS 'Currrency' DATE(Pd_Dt) AS 'Paid Date' PO_No isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date'  SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP019="Cha_Field1 AS 'BUSINESS' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status' Doc_Typ AS 'Document Type' DATE(Pd_Dt) AS 'Payment Date' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' GST_Amt AS 'GST Amount' Inv_Net_Amt AS 'Inv Net Amount' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP020="Vndr_Site_ID AS 'Compnay Vendor Number' %trg_VMF%.Vndr_Nme AS 'Vendor Name' %trg_VMF%.Vndr_Typ AS 'Vendor Type' %trg_VMF%.Vndr_Sts AS 'Vendor Status' %trg_VMF%.ABN YM AS 'Month of Year' Mon_Pmnt_Num AS 'Total Payments of Month' c_Btch_No AS 'Check Number' Pay_Pmnt_Num AS 'Payments Count' Pay_Amt AS 'Total Payment Amount' GST_Amt AS 'Total GST Paid Amount' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP020D="Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Remit Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' DATE(Pay_Dt) AS 'CHECK_DATE' Pay_No AS 'INVOICE_PAYMENT_ID' Btch_No AS 'Check Number' Pay_Amt AS 'Payment Amount'  GST_AMT AS 'GST Amount' Curncy AS 'Currency' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Pymnt_Trms AS 'Status Lookup Code' Pymnt_Mth AS 'PAYMENT_METHOD_CODE' Cha_Field2 AS 'INVOICING_VENDOR_SITE_ID' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP021="GAP_START_EXCLUSIVE GAP_END_EXCLUSIVE NUMBER_ITEMS_MISSING Priority TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP022=""
v_Exp_Fields_AP023=""
COMM
v_Exp_Fields_AP024="Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Trans_Num AS 'Trans Number' Inv_Amt AS 'Total Invoice Amount' GST_Amt AS 'Total GST Amount' Months AS 'Low Activity Months' DATE(Max_Inv_Dt) AS 'Last Invoice Date' ABN TEL1 City State Cntry AS 'Country' Pymnt_Trm AS 'Payment Terms' Created_Dt AS 'Created Date' DATE(Modf_Dt) AS 'Modified Date' Co AS 'Company' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM *** Employee Master File Tests Output***
COMM
v_Exp_Fields_EM001 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM002 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE  BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Tax_Fle_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM003 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM004 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE Dup_Add1 Dup_Add2 Dup_Add3 Dup_City Dup_State Dup_PCode Dup_Cntry Total_PayAmt Total_Pay_Num Tax_Fle_Num  TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM005 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE TEL1 TEL2 TEL3 Fax Total_PayAmt Total_Pay_Num Tax_Fle_Num Add1 Add2 Add3 City State PCode Cntry Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM006 = "Emp_ID AS 'Employee Number' Emp_Sts Co AS 'BUSINESS' COST_CENTRE Title Emp_Nme AS 'Emp Name' DATE(DOB) AS 'DOB' Sex Tax_Fle_Num DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM007 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM008 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM009 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM010 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM011 = "EMF_TMP_Emp.Emp_ID AS 'Employee Number' EMF_TMP_Emp.Emp_Nme AS 'Emp Name' EMF_TMP_Emp.Co As 'BUSINESS' EMF_TMP_Emp.COST_CENTRE BSB Bnk_Acc_Num BSB_NAME EMF_TMP_Emp.Tax_Fle_Num EMF_TMP_Emp.Add1 EMF_TMP_Emp.Add2 EMF_TMP_Emp.Add3 EMF_TMP_Emp.City EMF_TMP_Emp.State EMF_TMP_Emp.PCode EMF_TMP_Emp.Cntry EMF_TMP_Emp.TEL1 EMF_TMP_Emp.TEL2 EMF_TMP_Emp.TEL3 EMF_TMP_Emp.Fax EMF_TMP_Emp.Email_Bus EMF_TMP_Emp.Email_Privt EMF_TMP_Emp.Title DATE(EMF_TMP_Emp.DOB) AS 'DOB' EMF_TMP_Emp.Sex DATE(EMF_TMP_Emp.Hire_Dt) AS 'Hired Date' DATE(EMF_TMP_Emp.Trm_Dt) AS 'TERM_DATE' EMF_TMP_Emp.Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM012 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM013 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM014 = "Emp_Sts Co AS 'Emp Company' COST_CENTRE Emp_ID AS 'Emp_Code' Tax_Fle_Num Tax_Scale Total_PayAmt Total_Pay_Num Title Frst_Nme AS 'Given Name' Second_Given_Name Sur_Nme AS 'SurName' DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc State AS 'State' PCode As 'Post Code' Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM015 = "'~'+Emp_ID AS 'Employee Code' Frst_Nme AS 'First Name' Sur_Nme AS 'Last Name' Emp_Sts AS 'Emp Status' Emp_Catg AS 'Emp Type Desc' '~'+COST_CENTRE AS 'Cost Centre Code' DATETIME(Hire_Dt,'DD/MM/YYYY') AS 'Start Date' DATETIME(Commencement_Dt, 'DD/MM/YYYY') AS 'Commencement Date' Lv_Hrs_Taken Lv_Days_Taken Cal_Days_Taken Lst_Lv_EndDt AS 'Lst_Lv_End_Date' Lst_LvCode AS 'Lst Lv Reason Code' Lst_LvHrs AS 'Lst_Lv_TtlHrs' '~'+Tax_Fle_Num AS  'Tax_Fle_Num' Total_PayAmt AS 'Total_12M_PayAmt' Total_Pay_Num AS 'Total_12M_TranNum' '~'+Bnk_Acc_Num AS 'Bank Account' TEL1 AS 'Home Phone' TEL2 AS 'Mobile' ALLTRIM(Add1)+' ' + ALLTRIM(Add2) AS 'Address' City PCode AS 'Post Code' State DATETIME(DOB,'DD/MM/YYYY') AS 'Birth Date' Title AS 'Position Code' '~'+Cha_Field1 AS 'Dept Code' '~'+Cha_Field2 AS 'Location Code' Cha_Field3 AS 'Work Area Code' Test_Name DATETIME(RptRunDate,'DD/MM/YYYY') AS 'Test Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM016 = "'~'+Emp_ID AS 'Employee Code' Frst_Nme AS 'First Name' Sur_Nme AS 'Last Name' Emp_Sts AS 'Emp Status' Emp_Catg AS 'Emp Type Desc' '~'+COST_CENTRE AS 'Cost Centre Code' DATETIME(Hire_Dt,'DD/MM/YYYY') AS 'Start Date' DATETIME(Commencement_Dt, 'DD/MM/YYYY') AS 'Commencement Date' Lv_Code AS 'Leave Reason Code' AnnYear1 AS 'AnnY1_Hire_Date' AnnYear1_Lv_Days_Taken AS 'AnnY1_Sum_Lv_Days_Taken' AnnYear2 AS 'AnnY2_Hire_Date' AnnYear2_Lv_Days_Taken AS 'AnnY2_Sum_Lv_Days_Taken' AnnYear1_Cal_Days_Taken AS 'Y1_Calendar_Days' AnnYear2_Cal_Days_Taken AS 'Y2_Calendar_Days' DATETIME(DOB,'DD/MM/YYYY') AS 'Birth Date' '~'+Tax_Fle_Num AS  'Tax_Fle_Num' Total_PayAmt AS 'Total_12M_PayAmt' Total_Pay_Num AS 'Total_12M_TranNum' '~'+Bnk_Acc_Num AS 'Bank Account' TEL1 AS 'Home Phone' TEL2 AS 'Mobile' ALLTRIM(Add1)+' ' + ALLTRIM(Add2) AS 'Address' City PCode AS 'Post Code' State Title AS 'Position Code' '~'+Cha_Field1 AS 'Dept Code' '~'+Cha_Field2 AS 'Location Code' Cha_Field3 AS 'Work Area Code' Test_Name DATETIME(RptRunDate,'DD/MM/YYYY') AS 'Test Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM016D = "'~'+Emp_ID AS 'Employee Code' Frst_Nme AS 'First Name' Sur_Nme AS 'Last Name' Emp_Sts AS 'Emp Status' Emp_Catg AS 'Emp Type Desc' '~'+COST_CENTRE AS 'Cost Centre Code' DATETIME(Hire_Dt,'DD/MM/YYYY') AS 'Start Date' DATETIME(Commencement_Dt, 'DD/MM/YYYY') AS 'Commencement Date' ExceptionAnnYear ReasonCode StartDate AS 'Lv Start Date' EndDate AS 'Lv End Date' UnitsRequested AS 'Lv Hours Taken' TypeOfUnits ApprovedByCode ApprovedDate AS 'Approved Date' ProcessedDate AS 'Processed Date' c_Notes AS 'Notes'  Test_Name RptRunDate AS 'Test_Date'SORT_KEY"

COMM
v_Exp_Fields_EM017="'~'+Emp_ID AS 'Employee Code' Frst_Nme AS 'First Name' Sur_Nme AS 'Last Name' Emp_Sts AS 'Emp Status' Emp_Catg AS 'Emp Type Desc' '~'+COST_CENTRE AS 'Cost Centre Code' DATETIME(Hire_Dt,'DD/MM/YYYY') AS 'Start Date' DATETIME(Commencement_Dt, 'DD/MM/YYYY') AS 'Commencement Date' 'SICK' AS 'Leave Reason Code' SLTotalUnits AS 'Balance_SLTotalHrs' TtlSLHrs_Taken EndDate AS 'Lv End Date' ApprovedByCode ApprovedDate AS 'Approved Date' Notes DATETIME(DOB,'DD/MM/YYYY') AS 'Birth Date' '~'+Tax_Fle_Num AS  'Tax_Fle_Num' '~'+Bnk_Acc_Num AS 'Bank Account' TEL1 AS 'Home Phone' TEL2 AS 'Mobile' ALLTRIM(Add1)+' ' + ALLTRIM(Add2) AS 'Address' City PCode AS 'Post Code' State Title AS 'Position Code' '~'+Cha_Field1 AS 'Dept Code' '~'+Cha_Field2 AS 'Location Code' Cha_Field3 AS 'Work Area Code' Test_Name DATETIME(RptRunDate,'DD/MM/YYYY') AS 'Test Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM017D = "'~'+Emp_ID AS 'Employee Code' Frst_Nme AS 'First Name' Sur_Nme AS 'Last Name' Emp_Sts AS 'Emp Status' Emp_Catg AS 'Emp Type Desc' '~'+COST_CENTRE AS 'Cost Centre Code' DATETIME(Hire_Dt,'DD/MM/YYYY') AS 'Start Date' DATETIME(Commencement_Dt, 'DD/MM/YYYY') AS 'Commencement Date' ReasonCode StartDate AS 'Lv Start Date' EndDate AS 'Lv End Date' UnitsRequested AS 'Lv Hours Taken' TypeOfUnits ApprovedByCode ApprovedDate AS 'Approved Date' ProcessedDate AS 'Processed Date' c_Notes AS 'Notes'  Test_Name RptRunDate AS 'Test_Date'SORT_KEY"


COMM *** Payroll Tests Output***
COMM
v_Exp_Fields_PR001 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR002 = "Co As 'BUSINESS' COST_CENTRE Emp_ID AS 'Employee Number' DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR003 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Trm_Dt) AS 'TERM_DATE' DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY Title  STATE PCode AS 'Post Code' DATE(Hire_Dt) AS 'Hired Date'  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR004 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY Title  DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR005 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Trm_Dt) AS 'TERM_DATE' DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY Title DATE(Hire_Dt) AS 'Hired Date'  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR006 = ""
COMM
v_Exp_Fields_PR007 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours AUTOPAY_HOURS_DAYS LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY Title DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR008 = "Emp_ID AS 'Employee Number' Co As 'BUSINESS' COST_CENTRE PAYCODE_AMOUNT PAYCODE_HOURS Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR008D = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY Title  DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR009="Co As 'BUSINESS' Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' DATE(Prd_Dt) AS 'Prd_Dt' PayCode_Amount PayCode_Hours Avg_PayCode_Amount Avg_PayCode_Hours Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR009D = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY Title  DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"

COMM *** EXPORT STATICSTIC Reports *** 
COMM
v_Exp_Fields_ST001 = "Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Ttl_Issues AS 'Total Issues Found' COUNT AS 'Number of Test Failed' Priority DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_ST001D = "Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' COUNT AS 'Total Issues Found in the Test' TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_ST002 = "Rev_Days_1 AS 'Rev_Days' Count AS 'Total Reversals Num' FIELD_PERCENTAGE ABS_InvAmt"
COMM
v_Exp_Fields_ST003 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status' Total_InvAmt AS 'Total Invoices Amount' Trns_Num AS 'Total Invoices Num' Dup_InvAmt Dup_Num  Cln_Dup_InvAmt Cln_Dup_Num PCT_Cln_Dup_Trns_Amt PCT_Cln_Dup_Trns_Num  Rev_InvAmt Rev_Num PCT_Rev_Dup_Amt PCT_Rev_Dup_Num Vndr_Typ AS 'Vednor Type' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_ST004 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_Nme AS 'Vendor Name' Inv_Amt AS 'Invoices Amount' GST_Amt AS 'GST Amount' COUNT AS 'Total Trans Num' COUNT_PERCENTAGE AS 'Trans Num Pct' FIELD_PERCENTAGE AS 'Inv Amt Pct' Priority RptRunDate SORT_KEY"
COMM
v_Exp_Fields_ST005 = "YM AS 'Month' Inv_Amt AS 'Invoices Amount' GST_Amt AS 'GST Amount' COUNT AS 'Total Trans Num' COUNT_PERCENTAGE AS 'Trans Num Pct' Priority RptRunDate SORT_KEY"
COMM
v_Exp_Fields_ST006 = ""

COMM *** Export Vendor Master File Tests***

IF (CHK_Exp_VM001=T AND FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM001)) OPEN VM001_Dup_Vnd_BankAcc
%v_cmt% IF (CHK_Exp_VM001=T AND FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM001)) COUNT
IF (CHK_Exp_VM001=T AND FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM001)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM001%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM001_Dup_Vnd_BankAcc" %v_fileOpt%

IF (CHK_Exp_VM002=T AND FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM002)) OPEN VM002_Dup_Vnd_ABN
%v_cmt% IF (CHK_Exp_VM002=T AND FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM002)) COUNT
IF (CHK_Exp_VM002=T AND FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM002)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM002%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM002_Dup_Vnd_ABN" %v_fileOpt%

IF (CHK_Exp_VM003=T AND FILESIZE("%fld_Results%VM003_Dup_Vnd_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM003)) OPEN VM003_Dup_Vnd_Add
%v_cmt% IF (CHK_Exp_VM003=T AND FILESIZE("%fld_Results%VM003_Dup_Vnd_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM003)) COUNT
IF (CHK_Exp_VM003=T AND FILESIZE("%fld_Results%VM003_Dup_Vnd_Add.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM003)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM003%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM003_Dup_Vnd_Add" %v_fileOpt%

IF (CHK_Exp_VM004=T AND FILESIZE("%fld_Results%VM004_Dup_Vnd_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM004)) OPEN VM004_Dup_Vnd_Tel
%v_cmt% IF (CHK_Exp_VM004=T AND FILESIZE("%fld_Results%VM004_Dup_Vnd_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM004)) COUNT
IF (CHK_Exp_VM004=T AND FILESIZE("%fld_Results%VM004_Dup_Vnd_Tel.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM004)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM004%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM004_Dup_Vnd_Tel" %v_fileOpt%


IF (CHK_Exp_VM005=T AND FILESIZE("%fld_Results%VM005_Dup_Vnd_Name.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM005)) OPEN VM005_Dup_Vnd_Name
%v_cmt% IF (CHK_Exp_VM005=T AND FILESIZE("%fld_Results%VM005_Dup_Vnd_Name.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM005)) COUNT
IF (CHK_Exp_VM005=T AND FILESIZE("%fld_Results%VM005_Dup_Vnd_Name.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM005)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM005%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM005_Dup_Vnd_Name" %v_fileOpt%


IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006)) OPEN VM006_Mis_Details
%v_cmt% IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006)) COUNT
IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006_Mis_Details.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM006)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM006%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM006_Mis_Details" %v_fileOpt%


IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006D_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006D)) OPEN VM006D_Mis_Details
%v_cmt% IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006D_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006D)) COUNT
IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006D_Mis_Details.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM006D)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM006D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM006D_Mis_Details" %v_fileOpt%

COMMENT
IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006D_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006D)) OPEN TMP_VM006D
%v_cmt% IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006D_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006D)) COUNT
IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006D_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006D)) %v_if% %v_EXPORT% FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM006D_Mis_Details" %v_fileOpt%
END

IF ((CHK_Exp_VM007=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM007_Invld_Frmt_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM007)) OPEN VM007_Invld_Frmt_ABN
%v_cmt% IF ((CHK_Exp_VM007=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM007_Invld_Frmt_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM007)) COUNT
IF ((CHK_Exp_VM007=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM007_Invld_Frmt_ABN.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM007)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM007%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM007_Invld_Frmt_ABN" %v_fileOpt%

IF ((CHK_Exp_VM007=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM007D_Invld_Frmt_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM007D)) OPEN VM007D_Invld_Frmt_ABN
%v_cmt% IF ((CHK_Exp_VM007=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM007D_Invld_Frmt_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM007D)) COUNT
IF ((CHK_Exp_VM007=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM007D_Invld_Frmt_ABN.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM007D)) %v_EXPORT% FIELDS %v_Exp_Fields_VM007D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM007_Invld_Frmt_ABN" %v_fileOpt%

IF ((CHK_Exp_VM008=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM008_Can_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM008)) OPEN VM008_Can_ABN
%v_cmt% IF ((CHK_Exp_VM008=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM008_Can_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM008)) COUNT
IF ((CHK_Exp_VM008=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM008_Can_ABN.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM008)) %v_EXPORT% FIELDS %v_Exp_Fields_VM008%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM008_Can_ABN" %v_fileOpt%

IF ((CHK_Exp_VM008=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM008D_Can_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM008D)) OPEN TMP_VM008D
%v_cmt% IF ((CHK_Exp_VM008=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM008D_Can_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM008D)) COUNT
IF ((CHK_Exp_VM008=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM008D_Can_ABN.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM008D)) %v_EXPORT% FIELDS FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM008D_Can_ABN" %v_fileOpt%

IF ((CHK_Exp_VM009=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM009_Invld_ABN_ABR.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM009)) OPEN VM009_Invld_ABN_ABR
%v_cmt% IF ((CHK_Exp_VM009=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM009_Invld_ABN_ABR.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM009)) COUNT
IF ((CHK_Exp_VM009=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM009_Invld_ABN_ABR.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM009)) %v_EXPORT% FIELDS %v_Exp_Fields_VM009%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM009_Invld_ABN_ABR" %v_fileOpt%

IF ((CHK_Exp_VM009=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM009D_Invld_ABN_ABR.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM009D)) OPEN VM009D_Invld_ABN_ABR
%v_cmt% IF ((CHK_Exp_VM009=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM009D_Invld_ABN_ABR.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM009D)) COUNT
IF ((CHK_Exp_VM009=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM009D_Invld_ABN_ABR.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM009D)) %v_EXPORT% FIELDS %v_Exp_Fields_VM009D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM009D_Invld_ABN_ABR" %v_fileOpt%

COMM
COMM *** AP007 --> VM010/VM010D DeReg GST***
IF ((CHK_Exp_VM010=T OR CHK_Exp_AP007=T ) AND FILESIZE("%fld_Results%VM010_DeReg_GST.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM010)) OPEN VM010_DeReg_GST
%v_cmt% IF ((CHK_Exp_VM010=T OR CHK_Exp_AP007=T ) AND FILESIZE("%fld_Results%VM010_DeReg_GST.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM010)) COUNT
IF ((CHK_Exp_VM010=T OR CHK_Exp_AP007=T ) AND FILESIZE("%fld_Results%VM010_DeReg_GST.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM010)) %v_EXPORT% FIELDS %v_Exp_Fields_VM010%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM010_DeReg_GST" %v_fileOpt%
COMM
IF ((CHK_Exp_VM010=T OR CHK_Exp_AP007=T) AND FILESIZE("%fld_Results%VM010D_DeReg_GST.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM010)) OPEN VM010D_DeReg_GST
%v_cmt% IF ((CHK_Exp_VM010=T OR CHK_Exp_AP007=T) AND FILESIZE("%fld_Results%VM010D_DeReg_GST.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM010)) COUNT
IF ((CHK_Exp_VM010=T OR CHK_Exp_AP007=T) AND FILESIZE("%fld_Results%VM010D_DeReg_GST.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM010)) %v_EXPORT% FIELDS %v_Exp_Fields_VM010D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM010D_DeReg_GST" %v_fileOpt%
COMM
IF (CHK_Exp_VM011=T AND FILESIZE("%fld_Results%VM011_Upd_Mul_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM011)) OPEN VM011_Upd_Mul_xx_Mon
%v_cmt% IF (CHK_Exp_VM011=T AND FILESIZE("%fld_Results%VM011_Upd_Mul_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM011)) COUNT
IF (CHK_Exp_VM011=T AND FILESIZE("%fld_Results%VM011_Upd_Mul_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM011)) %v_EXPORT% FIELDS %v_Exp_Fields_VM011%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM011_Upd_Mul_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_VM012=T AND FILESIZE("%fld_Results%VM012_Inac_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM012)) OPEN VM012_Inac_xx_Mon
%v_cmt% IF (CHK_Exp_VM012=T AND FILESIZE("%fld_Results%VM012_Inac_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM012)) COUNT
IF (CHK_Exp_VM012=T AND FILESIZE("%fld_Results%VM012_Inac_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM012)) %v_EXPORT% FIELDS %v_Exp_Fields_VM012%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM012_Inac_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_VM012=T AND FILESIZE("%fld_Results%VM012D_Inac_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM012D)) OPEN VM012D_Inac_xx_Mon
%v_cmt% IF (CHK_Exp_VM012=T AND FILESIZE("%fld_Results%VM012D_Inac_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM012D)) COUNT
IF (CHK_Exp_VM012=T AND FILESIZE("%fld_Results%VM012D_Inac_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM012D)) %v_EXPORT% FIELDS %v_Exp_Fields_VM012D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM012D_Inac_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_VM013=T AND FILESIZE("%fld_Results%VM013_OneTim_Vnd_Spend.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM013)) OPEN VM013_OneTim_Vnd_Spend
%v_cmt% IF (CHK_Exp_VM013=T AND FILESIZE("%fld_Results%VM013_OneTim_Vnd_Spend.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM013)) COUNT
IF (CHK_Exp_VM013=T AND FILESIZE("%fld_Results%VM013_OneTim_Vnd_Spend.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM013)) %v_EXPORT% FIELDS %v_Exp_Fields_VM013%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM013_OneTim_Vnd_Spend" %v_fileOpt%
COMM
IF (CHK_Exp_VM013=T AND FILESIZE("%fld_Results%VM013D_OneTim_Vnd_Spend.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM013D)) OPEN VM013D_OneTim_Vnd_Spend
%v_cmt% IF (CHK_Exp_VM013=T AND FILESIZE("%fld_Results%VM013D_OneTim_Vnd_Spend.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM013D)) COUNT
IF (CHK_Exp_VM013=T AND FILESIZE("%fld_Results%VM013D_OneTim_Vnd_Spend.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM013D)) %v_EXPORT% FIELDS %v_Exp_Fields_VM013D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM013D_OneTim_Vnd_Spend" %v_fileOpt%
COMM
IF (CHK_Exp_VM014=T AND FILESIZE("%fld_Results%VM014_VndEmp_BankAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM014)) OPEN VM014_VndEmp_BankAcc
%v_cmt% IF (CHK_Exp_VM014=T AND FILESIZE("%fld_Results%VM014_VndEmp_BankAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM014)) COUNT
IF (CHK_Exp_VM014=T AND FILESIZE("%fld_Results%VM014_VndEmp_BankAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM014)) %v_EXPORT% FIELDS %v_Exp_Fields_VM014%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM014_VndEmp_BankAcc" %v_fileOpt%

COMM
IF (CHK_Exp_VM015=T AND FILESIZE("%fld_Results%VM015_VndEmp_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM015)) OPEN VM015_VndEmp_Add
%v_cmt% IF (CHK_Exp_VM015=T AND FILESIZE("%fld_Results%VM015_VndEmp_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM015)) COUNT
IF (CHK_Exp_VM015=T AND FILESIZE("%fld_Results%VM015_VndEmp_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM015)) %v_EXPORT% FIELDS %v_Exp_Fields_VM015%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM015_VndEmp_Add" %v_fileOpt%
COMM
IF (CHK_Exp_VM016=T AND FILESIZE("%fld_Results%VM016_VndEmp_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM016)) OPEN VM016_VndEmp_Tel
%v_cmt% IF (CHK_Exp_VM016=T AND FILESIZE("%fld_Results%VM016_VndEmp_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM016)) COUNT
IF (CHK_Exp_VM016=T AND FILESIZE("%fld_Results%VM016_VndEmp_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM016)) %v_EXPORT% FIELDS %v_Exp_Fields_VM016%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM016_VndEmp_Tel" %v_fileOpt%
COMM
IF (CHK_Exp_VM017=T AND FILESIZE("%fld_Results%VM017_Dup_Vnd_Email.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM017)) OPEN VM017_Dup_Vnd_Email
%v_cmt% IF (CHK_Exp_VM017=T AND FILESIZE("%fld_Results%VM017_Dup_Vnd_Email.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM017)) COUNT
IF (CHK_Exp_VM017=T AND FILESIZE("%fld_Results%VM017_Dup_Vnd_Email.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM017)) %v_EXPORT% FIELDS %v_Exp_Fields_VM017%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM017_Dup_Vnd_Email" %v_fileOpt%

COMM *** %v_EXPORT% Accounts Payable Tests ***

IF (CHK_Exp_AP001=T AND FILESIZE("%fld_Results%HIST2_AP001_Amt_Dt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP001)) OPEN HIST2_AP001_Dup_Amt_Dt_Inv_Vndr
%v_cmt% IF (CHK_Exp_AP001=T AND FILESIZE("%fld_Results%HIST2_AP001_Amt_Dt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP001)) COUNT
IF (CHK_Exp_AP001=T AND FILESIZE("%fld_Results%HIST2_AP001_Amt_Dt_Inv_Vndr.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP001)) %v_EXPORT% FIELDS %v_Exp_Fields_AP001%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%Hist2_AP001_Dup_Amt_Dt_Inv_Vndr" %v_fileOpt%

COMM
IF (CHK_Exp_AP001=T AND FILESIZE("%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP001)) OPEN TMP_AP001
%v_cmt% IF (CHK_Exp_AP001=T AND FILESIZE("%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP001)) COUNT
IF (CHK_Exp_AP001=T AND FILESIZE("%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP001)) %v_EXPORT% FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP001_Dup_Amt_Dt_Inv_Vndr" %v_fileOpt%
END



IF (CHK_Exp_AP002=T AND FILESIZE("%fld_Results%HIST2_AP002_Dup_Amt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP002)) OPEN HIST2_AP002_Dup_Amt_Inv_Vndr
%v_cmt% IF (CHK_Exp_AP002=T AND FILESIZE("%fld_Results%HIST2_AP002_Dup_Amt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP002)) COUNT
IF (CHK_Exp_AP002=T AND FILESIZE("%fld_Results%HIST2_AP002_Dup_Amt_Inv_Vndr.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP002)) %v_EXPORT% FIELDS %v_Exp_Fields_AP002%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%Hist2_AP002_Dup_Amt_Inv_Vndr" %v_fileOpt%

COMM
IF (CHK_Exp_AP002=T AND FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP002)) OPEN TMP_AP002
%v_cmt% IF (CHK_Exp_AP002=T AND FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP002)) COUNT
IF (CHK_Exp_AP002=T AND FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP002)) %v_EXPORT% FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP002_Dup_Amt_Inv_Vndr" %v_fileOpt%
END


IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%HIST2_AP003_Dup_Amt_Dt_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) OPEN HIST2_AP003_Dup_Amt_Dt_Inv
%v_cmt% IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%HIST2_AP003_Dup_Amt_Dt_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) COUNT
IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%HIST2_AP003_Dup_Amt_Dt_Inv.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) %v_EXPORT% FIELDS %v_Exp_Fields_AP003%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%Hist2_AP003_Dup_Amt_Dt_Inv" %v_fileOpt%

COMM
IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) OPEN TMP_AP003
%v_cmt% IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) COUNT
IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) %v_EXPORT% FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP003_Dup_Amt_Dt_Inv" %v_fileOpt%
END


IF (CHK_Exp_AP004=T AND FILESIZE("%fld_Results%HIST2_AP004_Dup_Amt_Dt_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP004)) OPEN HIST2_AP004_Dup_Amt_Dt_Vndr
%v_cmt% IF (CHK_Exp_AP004=T AND FILESIZE("%fld_Results%HIST2_AP004_Dup_Amt_Dt_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP004)) COUNT
IF (CHK_Exp_AP004=T AND FILESIZE("%fld_Results%HIST2_AP004_Dup_Amt_Dt_Vndr.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) %v_EXPORT% FIELDS %v_Exp_Fields_AP004%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%Hist2_AP004_Dup_Amt_Dt_Vndr" %v_fileOpt%
COMM
IF (CHK_Exp_AP004=T AND FILESIZE("%fld_Results%AP004_Dup_Amt_Dt_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) OPEN TMP_AP004
%v_cmt% IF (CHK_Exp_AP004=T AND FILESIZE("%fld_Results%AP004_Dup_Amt_Dt_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) COUNT
IF (CHK_Exp_AP004=T AND FILESIZE("%fld_Results%AP004_Dup_Amt_Dt_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) %v_EXPORT% FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP004_Dup_Amt_Dt_Vndr" %v_fileOpt%
END

COMM
IF (CHK_Exp_AP005=T AND FILESIZE("%fld_Results%AP005_3Cons_InvNo.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP005)) OPEN AP005_3Cons_InvNo
%v_cmt% IF (CHK_Exp_AP005=T AND FILESIZE("%fld_Results%AP005_3Cons_InvNo.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP005))  COUNT
IF (CHK_Exp_AP005=T AND FILESIZE("%fld_Results%AP005_3Cons_InvNo.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP005)) %v_EXPORT% FIELDS %v_Exp_Fields_AP005%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP005_3Cons_InvNo" %v_fileOpt%
COMM
IF (CHK_Exp_AP005=T AND FILESIZE("%fld_Results%AP005D_3Cons_InvNo_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP005D)) OPEN AP005D_3Cons_InvNo_Details
%v_cmt% IF (CHK_Exp_AP005=T AND FILESIZE("%fld_Results%AP005D_3Cons_InvNo_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP005D)) COUNT
IF (CHK_Exp_AP005=T AND FILESIZE("%fld_Results%AP005D_3Cons_InvNo_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP005D)) %v_EXPORT% FIELDS %v_Exp_Fields_AP005D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP005D_3Cons_InvNo_Details" %v_fileOpt%

IF (CHK_Exp_AP006=T AND FILESIZE("%fld_Results%AP006_Pay_Not_In_VMF.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP006)) OPEN AP006_Pay_Not_In_VMF
%v_cmt% IF (CHK_Exp_AP006=T AND FILESIZE("%fld_Results%AP006_Pay_Not_In_VMF.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP006)) COUNT
IF (CHK_Exp_AP006=T AND FILESIZE("%fld_Results%AP006_Pay_Not_In_VMF.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP006)) %v_EXPORT% FIELDS %v_Exp_Fields_AP006%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP006_Pay_Not_In_VMF" %v_fileOpt%

COMM *** AP007 --> VM010/VM010D DeReg_GST ***

COMm *** AP008 Exc_Alw_Limit ***
COMM
IF (CHK_Exp_AP008=T AND FILESIZE("%fld_Results%AP008_Exc_Alw_Limit.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP008)) OPEN AP008_Exc_Alw_Limit
%v_cmt% IF (CHK_Exp_AP008=T AND FILESIZE("%fld_Results%AP008_Exc_Alw_Limit.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP008)) COUNT
IF (CHK_Exp_AP008=T AND FILESIZE("%fld_Results%AP008_Exc_Alw_Limit.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP008)) %v_EXPORT% FIELDS %v_Exp_Fields_AP008%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP008_Exc_Alw_Limit" %v_fileOpt%
COMM
IF (CHK_Exp_AP009=T AND FILESIZE("%fld_Results%AP009_GST_Over_Char.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP009)) OPEN AP009_GST_Over_Char
%v_cmt% IF (CHK_Exp_AP009=T AND FILESIZE("%fld_Results%AP009_GST_Over_Char.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP009)) COUNT
IF (CHK_Exp_AP009=T AND FILESIZE("%fld_Results%AP009_GST_Over_Char.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP009)) %v_EXPORT% FIELDS %v_Exp_Fields_AP009%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP009_GST_Over_Char" %v_fileOpt%
COMM
IF (CHK_Exp_AP010=T AND FILESIZE("%fld_Results%AP010_Large_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP010)) OPEN AP010_Large_Inv
%v_cmt% IF (CHK_Exp_AP010=T AND FILESIZE("%fld_Results%AP010_Large_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP010)) COUNT
IF (CHK_Exp_AP010=T AND FILESIZE("%fld_Results%AP010_Large_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP010)) %v_EXPORT% FIELDS %v_Exp_Fields_AP010%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP010_Large_Inv" %v_fileOpt%
COMM
IF (CHK_Exp_AP010=T AND FILESIZE("%fld_Results%AP010D_Large_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP010D)) OPEN AP010D_Large_Inv
%v_cmt% IF (CHK_Exp_AP010=T AND FILESIZE("%fld_Results%AP010D_Large_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP010D)) COUNT
IF (CHK_Exp_AP010=T AND FILESIZE("%fld_Results%AP010D_Large_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP010D)) %v_EXPORT% FIELDS %v_Exp_Fields_AP010D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP010D_Large_Inv" %v_fileOpt%
COMM
IF (CHK_Exp_AP011=T AND FILESIZE("%fld_Results%AP011_PODt_Aft_InvDt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP011)) OPEN AP011_PODt_Aft_InvDt
%v_cmt% IF (CHK_Exp_AP011=T AND FILESIZE("%fld_Results%AP011_PODt_Aft_InvDt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP011)) COUNT
IF (CHK_Exp_AP011=T AND FILESIZE("%fld_Results%AP011_PODt_Aft_InvDt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP011)) %v_EXPORT% FIELDS %v_Exp_Fields_AP011%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP011_PODt_Aft_InvDt" %v_fileOpt%
COMM
IF (CHK_Exp_AP012=T AND FILESIZE("%fld_Results%AP012_POs_No_Goods.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP012)) OPEN AP012_POs_No_Goods
%v_cmt% IF (CHK_Exp_AP012=T AND FILESIZE("%fld_Results%AP012_POs_No_Goods.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP012)) COUNT
IF (CHK_Exp_AP012=T AND FILESIZE("%fld_Results%AP012_POs_No_Goods.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP012)) %v_EXPORT% FIELDS %v_Exp_Fields_AP012%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP012_POs_No_Goods" %v_fileOpt%
COMM
IF (CHK_Exp_AP013=T AND FILESIZE("%fld_Results%AP013_PO_Mul_Diff_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP013)) OPEN AP013_PO_Mul_Diff_Vnd
%v_cmt% IF (CHK_Exp_AP013=T AND FILESIZE("%fld_Results%AP013_PO_Mul_Diff_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP013)) COUNT
IF (CHK_Exp_AP013=T AND FILESIZE("%fld_Results%AP013_PO_Mul_Diff_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP013)) %v_EXPORT% FIELDS %v_Exp_Fields_AP013%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP013_PO_Mul_Diff_Vnd" %v_fileOpt%

COMM
IF (CHK_Exp_AP014=T AND FILESIZE("%fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP014)) OPEN TMP_AP014
%v_cmt% IF (CHK_Exp_AP014=T AND FILESIZE("%fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP014)) COUNT
IF (CHK_Exp_AP014=T AND FILESIZE("%fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP014)) %v_EXPORT% FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP014_No_Trans_%TXT_AP014_Months%_Mon" %v_fileOpt%
END 

IF (CHK_Exp_AP006=T AND FILESIZE("%fld_Results%AP006_Pay_Not_In_VMF.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP006)) OPEN AP006_Pay_Not_In_VMF
%v_cmt% IF (CHK_Exp_AP006=T AND FILESIZE("%fld_Results%AP006_Pay_Not_In_VMF.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP006)) COUNT
IF (CHK_Exp_AP006=T AND FILESIZE("%fld_Results%AP006_Pay_Not_In_VMF.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP006)) %v_EXPORT% FIELDS %v_Exp_Fields_AP006%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP006_Pay_Not_In_VMF" %v_fileOpt%

IF (CHK_Exp_AP014=T AND FILESIZE("%fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP014)) OPEN AP014_No_Trans_%TXT_AP014_Months%_Mon
%v_cmt% IF (CHK_Exp_AP014=T AND FILESIZE("%fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP014)) COUNT
IF (CHK_Exp_AP014=T AND FILESIZE("%fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP014)) %v_EXPORT% FIELDS %v_Exp_Fields_AP014%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP014_No_Trans_%TXT_AP014_Months%_Mon" %v_fileOpt%


COMM
IF (CHK_Exp_AP015=T AND FILESIZE("%fld_Results%AP015_Mul_Trans_OneTim_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP015)) OPEN AP015_Mul_Trans_OneTim_Vnd
%v_cmt% IF (CHK_Exp_AP015=T AND FILESIZE("%fld_Results%AP015_Mul_Trans_OneTim_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP015)) COUNT
IF (CHK_Exp_AP015=T AND FILESIZE("%fld_Results%AP015_Mul_Trans_OneTim_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP015)) %v_EXPORT% FIELDS %v_Exp_Fields_AP015%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP015_Mul_Trans_OneTim_Vnd" %v_fileOpt%
COMM
IF (CHK_Exp_AP015=T AND FILESIZE("%fld_Results%AP015D_Mul_Trans_OneTim_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP015D)) OPEN AP015D_Mul_Trans_OneTim_Vnd
%v_cmt% IF (CHK_Exp_AP015=T AND FILESIZE("%fld_Results%AP015D_Mul_Trans_OneTim_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP015D)) COUNT
IF (CHK_Exp_AP015=T AND FILESIZE("%fld_Results%AP015D_Mul_Trans_OneTim_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP015D)) %v_EXPORT% FIELDS %v_Exp_Fields_AP015D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP015D_Mul_Trans_OneTim_Vnd" %v_fileOpt%
COMM
IF (CHK_Exp_AP016=T AND FILESIZE("%fld_Results%AP016_Mis_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP016)) OPEN AP016_Mis_ABN
%v_cmt% IF (CHK_Exp_AP016=T AND FILESIZE("%fld_Results%AP016_Mis_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP016)) COUNT
IF (CHK_Exp_AP016=T AND FILESIZE("%fld_Results%AP016_Mis_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP016)) %v_EXPORT% FIELDS %v_Exp_Fields_AP016%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP016_Mis_ABN" %v_fileOpt%
COMM
IF (CHK_Exp_AP016=T AND FILESIZE("%fld_Results%AP016D_Mis_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP016D)) OPEN AP016D_Mis_ABN
%v_cmt% IF (CHK_Exp_AP016=T AND FILESIZE("%fld_Results%AP016D_Mis_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP016D)) COUNT
IF (CHK_Exp_AP016=T AND FILESIZE("%fld_Results%AP016D_Mis_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP016D)) %v_EXPORT% FIELDS %v_Exp_Fields_AP016D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP016D_Mis_ABN" %v_fileOpt%

COMM *** AP016 -> AP016, VM007, VM008, VM009 ***
COMM
IF (CHK_Exp_AP017=T AND FILESIZE("%fld_Results%AP017_Top_xx_Vnd_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP017)) OPEN AP017_Top_xx_Vnd_xx_Mon
%v_cmt% IF (CHK_Exp_AP017=T AND FILESIZE("%fld_Results%AP017_Top_xx_Vnd_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP017)) COUNT
IF (CHK_Exp_AP017=T AND FILESIZE("%fld_Results%AP017_Top_xx_Vnd_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP017)) %v_EXPORT% FIELDS %v_Exp_Fields_AP017%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP017_Top_xx_Vnd_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_AP017=T AND FILESIZE("%fld_Results%AP017D_Top_xx_Vnd_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP017D)) OPEN AP017D_Top_xx_Vnd_xx_Mon
%v_cmt% IF (CHK_Exp_AP017=T AND FILESIZE("%fld_Results%AP017D_Top_xx_Vnd_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP017D)) COUNT
IF (CHK_Exp_AP017=T AND FILESIZE("%fld_Results%AP017D_Top_xx_Vnd_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP017D)) %v_EXPORT% FIELDS %v_Exp_Fields_AP017D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP017D_Top_xx_Vnd_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_AP018=T AND FILESIZE("%fld_Results%AP018_Near_Alw_Limit.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP018)) OPEN AP018_Near_Alw_Limit
%v_cmt% IF (CHK_Exp_AP018=T AND FILESIZE("%fld_Results%AP018_Near_Alw_Limit.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP018)) COUNT
IF (CHK_Exp_AP018=T AND FILESIZE("%fld_Results%AP018_Near_Alw_Limit.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP018)) %v_EXPORT% FIELDS %v_Exp_Fields_AP018%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP018_Near_Alw_Limit" %v_fileOpt%
COMM
IF (CHK_Exp_AP019=T AND FILESIZE("%fld_Results%AP019_CreditNt_Paid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP019)) OPEN AP019_CreditNt_Paid
%v_cmt% IF (CHK_Exp_AP019=T AND FILESIZE("%fld_Results%AP019_CreditNt_Paid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP019)) COUNT
IF (CHK_Exp_AP019=T AND FILESIZE("%fld_Results%AP019_CreditNt_Paid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP019)) %v_EXPORT% FIELDS %v_Exp_Fields_AP019%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP019_CreditNt_Paid" %v_fileOpt%
COMM
IF (CHK_Exp_AP020=T AND FILESIZE("%fld_Results%AP020_Mul_Paid_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP020)) OPEN AP020_Mul_Paid_Mon
%v_cmt% IF (CHK_Exp_AP020=T AND FILESIZE("%fld_Results%AP020_Mul_Paid_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP020)) COUNT
IF (CHK_Exp_AP020=T AND FILESIZE("%fld_Results%AP020_Mul_Paid_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP020)) %v_EXPORT% FIELDS %v_Exp_Fields_AP020%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP020_Mul_Paid_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_AP020=T AND FILESIZE("%fld_Results%AP020D_Mul_Paid_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP020D)) OPEN AP020D_Mul_Paid_Mon
%v_cmt% IF (CHK_Exp_AP020=T AND FILESIZE("%fld_Results%AP020D_Mul_Paid_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP020D)) COUNT
IF (CHK_Exp_AP020=T AND FILESIZE("%fld_Results%AP020D_Mul_Paid_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP020D)) %v_EXPORT% FIELDS %v_Exp_Fields_AP020D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP020D_Mul_Paid_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_AP021=T AND FILESIZE("%fld_Results%AP021_Chq_Out_Seq.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP021)) OPEN AP021_Chq_Out_Seq
%v_cmt% IF (CHK_Exp_AP021=T AND FILESIZE("%fld_Results%AP021_Chq_Out_Seq.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP021)) COUNT
IF (CHK_Exp_AP021=T AND FILESIZE("%fld_Results%AP021_Chq_Out_Seq.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP021)) %v_EXPORT% FIELDS %v_Exp_Fields_AP021%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP021_Chq_Out_Seq" %v_fileOpt%
COMM
IF (CHK_Exp_AP022=T AND FILESIZE("%fld_Results%AP022_Disc_Mis.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP022)) OPEN AP022_Disc_Mis
%v_cmt% IF (CHK_Exp_AP022=T AND FILESIZE("%fld_Results%AP022_Disc_Mis.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP022)) COUNT
IF (CHK_Exp_AP022=T AND FILESIZE("%fld_Results%AP022_Disc_Mis.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP022)) %v_EXPORT% FIELDS %v_Exp_Fields_AP022%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP022_Disc_Mis" %v_fileOpt%
COMM
IF (CHK_Exp_AP023=T AND FILESIZE("%fld_Results%AP023_Disc_Not_Awd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP023)) OPEN AP023_Disc_Not_Awd
%v_cmt% IF (CHK_Exp_AP023=T AND FILESIZE("%fld_Results%AP023_Disc_Not_Awd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP023)) COUNT
IF (CHK_Exp_AP023=T AND FILESIZE("%fld_Results%AP023_Disc_Not_Awd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP023)) %v_EXPORT% FIELDS %v_Exp_Fields_AP023%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP023_Disc_Not_Awd" %v_fileOpt%
COMM
IF (CHK_Exp_AP024=T AND FILESIZE("%fld_Results%AP024_Low_Act_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP024)) OPEN AP024_Low_Act_Vnd
%v_cmt% IF (CHK_Exp_AP024=T AND FILESIZE("%fld_Results%AP024_Low_Act_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP024)) COUNT
IF (CHK_Exp_AP024=T AND FILESIZE("%fld_Results%AP024_Low_Act_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP024)) %v_EXPORT% FIELDS %v_Exp_Fields_AP024%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP024_Low_Act_Vnd" %v_fileOpt%

COMM *** %v_EXPORT% Employee Master File Tests***
COMM
IF (CHK_Exp_EM001=T AND FILESIZE("%fld_Results%EM001_Dup_TFN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM001)) OPEN EM001_Dup_TFN
%v_cmt% IF (CHK_Exp_EM001=T AND FILESIZE("%fld_Results%EM001_Dup_TFN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM001)) COUNT
IF (CHK_Exp_EM001=T AND FILESIZE("%fld_Results%EM001_Dup_TFN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM001)) %v_EXPORT% FIELDS %v_Exp_Fields_EM001%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM001_Dup_TFN" %v_fileOpt%
COMM
IF (CHK_Exp_EM002=T AND FILESIZE("%fld_Results%EM002_Dup_BnkAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM002)) OPEN EM002_Dup_BnkAcc
%v_cmt% IF (CHK_Exp_EM002=T AND FILESIZE("%fld_Results%EM002_Dup_BnkAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM002)) COUNT
IF (CHK_Exp_EM002=T AND FILESIZE("%fld_Results%EM002_Dup_BnkAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM002)) %v_EXPORT% FIELDS %v_Exp_Fields_EM002%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM002_Dup_BnkAcc" %v_fileOpt%
COMM
IF (CHK_Exp_EM003=T AND FILESIZE("%fld_Results%EM003_Dup_Name.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM003)) OPEN EM003_Dup_Name
%v_cmt% IF (CHK_Exp_EM003=T AND FILESIZE("%fld_Results%EM003_Dup_Name.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM003)) COUNT
IF (CHK_Exp_EM003=T AND FILESIZE("%fld_Results%EM003_Dup_Name.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM003)) %v_EXPORT% FIELDS %v_Exp_Fields_EM003%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM003_Dup_Name" %v_fileOpt%
COMM
IF (CHK_Exp_EM004=T AND FILESIZE("%fld_Results%EM004_Dup_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM004)) OPEN EM004_Dup_Add
%v_cmt% IF (CHK_Exp_EM004=T AND FILESIZE("%fld_Results%EM004_Dup_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM004)) COUNT
IF (CHK_Exp_EM004=T AND FILESIZE("%fld_Results%EM004_Dup_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM004)) %v_EXPORT% FIELDS %v_Exp_Fields_EM004%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM004_Dup_Add" %v_fileOpt%
COMM
IF (CHK_Exp_EM005=T AND FILESIZE("%fld_Results%EM005_Dup_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM005)) OPEN EM005_Dup_Tel
%v_cmt% IF (CHK_Exp_EM005=T AND FILESIZE("%fld_Results%EM005_Dup_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM005)) COUNT
IF (CHK_Exp_EM005=T AND FILESIZE("%fld_Results%EM005_Dup_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM005)) %v_EXPORT% FIELDS %v_Exp_Fields_EM005%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM005_Dup_Tel" %v_fileOpt%
COMM
IF (CHK_Exp_EM006=T AND FILESIZE("%fld_Results%EM006_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM006)) OPEN EM006_Mis_Details
%v_cmt% IF (CHK_Exp_EM006=T AND FILESIZE("%fld_Results%EM006_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM006)) COUNT
IF (CHK_Exp_EM006=T AND FILESIZE("%fld_Results%EM006_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM006)) %v_EXPORT% FIELDS %v_Exp_Fields_EM006%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM006_Mis_Details" %v_fileOpt%
COMM
IF (CHK_Exp_EM007=T AND FILESIZE("%fld_Results%EM007_StartDt_Bf_DOB.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM007)) OPEN EM007_StartDt_Bf_DOB
%v_cmt% IF (CHK_Exp_EM007=T AND FILESIZE("%fld_Results%EM007_StartDt_Bf_DOB.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM007)) COUNT
IF (CHK_Exp_EM007=T AND FILESIZE("%fld_Results%EM007_StartDt_Bf_DOB.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM007)) %v_EXPORT% FIELDS %v_Exp_Fields_EM001%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM007_StartDt_Bf_DOB" %v_fileOpt%
COMM
IF (CHK_Exp_EM008=T AND FILESIZE("%fld_Results%EM008_unKnown_CstCtr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM008)) OPEN EM008_unKnown_CstCtr
%v_cmt% IF (CHK_Exp_EM008=T AND FILESIZE("%fld_Results%EM008_unKnown_CstCtr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM008)) COUNT
IF (CHK_Exp_EM008=T AND FILESIZE("%fld_Results%EM008_unKnown_CstCtr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM008)) %v_EXPORT% FIELDS %v_Exp_Fields_EM008%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM008_unKnown_CstCtr" %v_fileOpt%
COMM
IF (CHK_Exp_EM009=T AND FILESIZE("%fld_Results%EM009_TFN_Invld_Frmt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM009)) OPEN EM009_TFN_Invld_Frmt
%v_cmt% IF (CHK_Exp_EM009=T AND FILESIZE("%fld_Results%EM009_TFN_Invld_Frmt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM009)) COUNT
IF (CHK_Exp_EM009=T AND FILESIZE("%fld_Results%EM009_TFN_Invld_Frmt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM009)) %v_EXPORT% FIELDS %v_Exp_Fields_EM009%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM009_TFN_Invld_Frmt" %v_fileOpt%
COMM
IF (CHK_Exp_EM010=T AND FILESIZE("%fld_Results%EM010_TFN_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM010)) OPEN EM010_TFN_Valid
%v_cmt% IF (CHK_Exp_EM010=T AND FILESIZE("%fld_Results%EM010_TFN_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM010)) COUNT
IF (CHK_Exp_EM010=T AND FILESIZE("%fld_Results%EM010_TFN_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM010)) %v_EXPORT% FIELDS %v_Exp_Fields_EM010%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM010_TFN_Valid" %v_fileOpt%
COMM
IF (CHK_Exp_EM011=T AND FILESIZE("%fld_Results%EM011_BnkAcc_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM011)) OPEN EM011_BnkAcc_Valid
%v_cmt% IF (CHK_Exp_EM011=T AND FILESIZE("%fld_Results%EM011_BnkAcc_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM011)) COUNT
IF (CHK_Exp_EM011=T AND FILESIZE("%fld_Results%EM011_BnkAcc_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM011)) %v_EXPORT% FIELDS %v_Exp_Fields_EM011%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM011_BnkAcc_Valid" %v_fileOpt%
COMM
IF (CHK_Exp_EM012=T AND FILESIZE("%fld_Results%EM012_DOB_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM012)) OPEN EM012_DOB_Valid
%v_cmt% IF (CHK_Exp_EM012=T AND FILESIZE("%fld_Results%EM012_DOB_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM012)) COUNT
IF (CHK_Exp_EM012=T AND FILESIZE("%fld_Results%EM012_DOB_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM012)) %v_EXPORT% FIELDS %v_Exp_Fields_EM012%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM012_DOB_Valid" %v_fileOpt%
COMM
IF (CHK_Exp_EM013=T AND FILESIZE("%fld_Results%EM013_StartDt_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM013)) OPEN EM013_StartDt_Valid
%v_cmt% IF (CHK_Exp_EM013=T AND FILESIZE("%fld_Results%EM013_StartDt_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM013)) COUNT
IF (CHK_Exp_EM013=T AND FILESIZE("%fld_Results%EM013_StartDt_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM013)) %v_EXPORT% FIELDS %v_Exp_Fields_EM013%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM013_StartDt_Valid" %v_fileOpt%
COMM
IF (CHK_Exp_EM014=T AND FILESIZE("%fld_Results%EM014_Tmp_No_EndDt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM014)) OPEN EM014_Tmp_No_EndDt
%v_cmt% IF (CHK_Exp_EM014=T AND FILESIZE("%fld_Results%EM014_Tmp_No_EndDt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM014)) COUNT
IF (CHK_Exp_EM014=T AND FILESIZE("%fld_Results%EM014_Tmp_No_EndDt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM014)) %v_EXPORT% FIELDS %v_Exp_Fields_EM014%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM014_Tmp_No_EndDt" %v_fileOpt%
COMM
IF (CHK_Exp_EM014=T AND FILESIZE("%fld_Results%EM015_Not_Taken_Leave.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM014)) OPEN EM015_Not_Taken_Leave
%v_cmt% IF (CHK_Exp_EM014=T AND FILESIZE("%fld_Results%EM015_Not_Taken_Leave.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM014)) COUNT
IF (CHK_Exp_EM014=T AND FILESIZE("%fld_Results%EM015_Not_Taken_Leave.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM014)) %v_EXPORT% FIELDS %v_Exp_Fields_EM014%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM015_Not_Taken_Leave" %v_fileOpt%
COMM
IF (CHK_Exp_EM015=T AND FILESIZE("%fld_Results%EM015_Not_Taken_AL.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM015)) OPEN EM015_Not_Taken_AL
IF (CHK_Exp_EM015=T AND FILESIZE("%fld_Results%EM015_Not_Taken_AL.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM015)) %v_EXPORT% FIELDS %v_Exp_Fields_EM015%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM015_Not_Taken_AL%suffix%" %v_fileOpt%
COMM
IF (CHK_Exp_EM016=T AND FILESIZE("%fld_Results%EM016_TooMuch_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM016)) OPEN EM016_TooMuch_SickLv
IF (CHK_Exp_EM016=T AND FILESIZE("%fld_Results%EM016_TooMuch_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM016)) %v_EXPORT% FIELDS %v_Exp_Fields_EM016%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM016_TooMuch_SickLv%suffix%" %v_fileOpt%
COMM
IF (CHK_Exp_EM016=T AND FILESIZE("%fld_Results%EM016D_TooMuch_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM016D)) OPEN EM016D_TooMuch_SickLv
IF (CHK_Exp_EM016=T AND FILESIZE("%fld_Results%EM016D_TooMuch_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM016D)) %v_EXPORT% FIELDS %v_Exp_Fields_EM016D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM016D_TooMuch_SickLv%suffix%" %v_fileOpt%
COMM
IF (CHK_Exp_EM017=T AND FILESIZE("%fld_Results%EM017_Neg_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM017)) OPEN EM017_Neg_SickLv
IF (CHK_Exp_EM017=T AND FILESIZE("%fld_Results%EM017_Neg_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM017)) %v_EXPORT% FIELDS %v_Exp_Fields_EM016%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM016_Neg_SickLv%suffix%" %v_fileOpt%
COMM
IF (CHK_Exp_EM017=T AND FILESIZE("%fld_Results%EM017D_Neg_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM017D)) OPEN EM017D_Neg_SickLv
IF (CHK_Exp_EM017=T AND FILESIZE("%fld_Results%EM017D_Neg_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM017D)) %v_EXPORT% FIELDS %v_Exp_Fields_EM016D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM016D_Neg_SickLv%suffix%" %v_fileOpt%



COMM *** %v_EXPORT% Payroll Tests ***
COMM
IF (CHK_Exp_PR001=T AND FILESIZE("%fld_Results%PR001_Mul_Paid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR001)) OPEN PR001_Mul_Paid
%v_cmt% IF (CHK_Exp_PR001=T AND FILESIZE("%fld_Results%PR001_Mul_Paid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR001)) COUNT
IF (CHK_Exp_PR001=T AND FILESIZE("%fld_Results%PR001_Mul_Paid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR001)) %v_EXPORT% FIELDS %v_Exp_Fields_PR001%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR001_Mul_Paid" %v_fileOpt%
COMM
IF (CHK_Exp_PR002=T AND FILESIZE("%fld_Results%PR002_Not_in_Emf.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR002)) OPEN PR002_Not_in_Emf
%v_cmt% IF (CHK_Exp_PR002=T AND FILESIZE("%fld_Results%PR002_Not_in_Emf.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR002)) COUNT
IF (CHK_Exp_PR002=T AND FILESIZE("%fld_Results%PR002_Not_in_Emf.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR002)) %v_EXPORT% FIELDS %v_Exp_Fields_PR002%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR002_Not_in_Emf" %v_fileOpt%
COMM
IF (CHK_Exp_PR003=T AND FILESIZE("%fld_Results%PR003_Pay_30D_Af_Trm.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR003)) OPEN PR003_Pay_30D_Af_Trm
%v_cmt% IF (CHK_Exp_PR003=T AND FILESIZE("%fld_Results%PR003_Pay_30D_Af_Trm.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR003)) COUNT
IF (CHK_Exp_PR003=T AND FILESIZE("%fld_Results%PR003_Pay_30D_Af_Trm.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR003)) %v_EXPORT% FIELDS %v_Exp_Fields_PR003%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR003_Pay_30D_Af_Trm" %v_fileOpt%
COMM
IF (CHK_Exp_PR004=T AND FILESIZE("%fld_Results%PR004_Spec_Leave_3Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR004)) OPEN PR004_Spec_Leave_3Mon
%v_cmt% IF (CHK_Exp_PR004=T AND FILESIZE("%fld_Results%PR004_Spec_Leave_3Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR004)) COUNT
IF (CHK_Exp_PR004=T AND FILESIZE("%fld_Results%PR004_Spec_Leave_3Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR004)) %v_EXPORT% FIELDS %v_Exp_Fields_PR004%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR004_Spec_Leave_3Mon" %v_fileOpt%
COMM
IF (CHK_Exp_PR005=T AND FILESIZE("%fld_Results%PR005_Pay_TrmAmt_Sleeper.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR005)) OPEN PR005_Pay_TrmAmt_Sleeper
%v_cmt% IF (CHK_Exp_PR005=T AND FILESIZE("%fld_Results%PR005_Pay_TrmAmt_Sleeper.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR005)) COUNT
IF (CHK_Exp_PR005=T AND FILESIZE("%fld_Results%PR005_Pay_TrmAmt_Sleeper.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR005)) %v_EXPORT% FIELDS %v_Exp_Fields_PR005%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR005_Pay_TrmAmt_Sleeper" %v_fileOpt%
COMM
IF (CHK_Exp_PR006=T AND FILESIZE("%fld_Results%PR006_Unusual_Super.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR006)) OPEN PR006_Unusual_Super
%v_cmt% IF (CHK_Exp_PR006=T AND FILESIZE("%fld_Results%PR006_Unusual_Super.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR006)) COUNT
IF (CHK_Exp_PR006=T AND FILESIZE("%fld_Results%PR006_Unusual_Super.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR006)) %v_EXPORT% FIELDS %v_Exp_Fields_PR006%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR006_Unusual_Super" %v_fileOpt%
COMM
IF (CHK_Exp_PR007=T AND FILESIZE("%fld_Results%PR007_Hourly_Emp.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR007)) OPEN PR007_Hourly_Emp
%v_cmt% IF (CHK_Exp_PR007=T AND FILESIZE("%fld_Results%PR007_Hourly_Emp.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR007)) COUNT
IF (CHK_Exp_PR007=T AND FILESIZE("%fld_Results%PR007_Hourly_Emp.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR007)) %v_EXPORT% FIELDS %v_Exp_Fields_PR007%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR007_Hourly_Emp" %v_fileOpt%
COMM
IF (CHK_Exp_PR008=T AND FILESIZE("%fld_Results%PR008_Top_xx_Over_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR008)) OPEN PR008_Top_xx_Over_xx_Mon
%v_cmt% IF (CHK_Exp_PR008=T AND FILESIZE("%fld_Results%PR008_Top_xx_Over_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR008)) COUNT
IF (CHK_Exp_PR008=T AND FILESIZE("%fld_Results%PR008_Top_xx_Over_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR008)) %v_EXPORT% FIELDS %v_Exp_Fields_PR008%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR008_Top_xx_Over_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_PR008=T AND FILESIZE("%fld_Results%PR008D_Top_xx_Over_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR008D)) OPEN PR008D_Top_xx_Over_xx_Mon
%v_cmt% IF (CHK_Exp_PR008=T AND FILESIZE("%fld_Results%PR008D_Top_xx_Over_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR008D)) COUNT
IF (CHK_Exp_PR008=T AND FILESIZE("%fld_Results%PR008D_Top_xx_Over_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR008D)) %v_EXPORT% FIELDS %v_Exp_Fields_PR008D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR008D_Top_xx_Over_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_PR009=T AND FILESIZE("%fld_Results%PR009_Pay_x_Times_Avg.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR009)) OPEN PR009_Pay_x_Times_Avg
%v_cmt% IF (CHK_Exp_PR009=T AND FILESIZE("%fld_Results%PR009_Pay_x_Times_Avg.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR009)) COUNT
IF (CHK_Exp_PR009=T AND FILESIZE("%fld_Results%PR009_Pay_x_Times_Avg.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR009)) %v_EXPORT% FIELDS %v_Exp_Fields_PR009%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR009_Pay_x_Times_Avg" %v_fileOpt%
COMM
IF (CHK_Exp_PR009=T AND FILESIZE("%fld_Results%PR009D_Pay_x_Times_Avg.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR009D)) OPEN PR009D_Pay_x_Times_Avg
%v_cmt% IF (CHK_Exp_PR009=T AND FILESIZE("%fld_Results%PR009D_Pay_x_Times_Avg.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR009D)) COUNT
IF (CHK_Exp_PR009=T AND FILESIZE("%fld_Results%PR009D_Pay_x_Times_Avg.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR009D)) %v_EXPORT% FIELDS %v_Exp_Fields_PR009D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR009D_Pay_x_Times_Avg" %v_fileOpt%
COMM
COMM *** %v_EXPORT% Statistics Summary Reports ***
IF (CHK_Exp_ST001=T AND FILESIZE("%fld_Results%ST001_Vnd_Tst_Sum.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST001)) OPEN ST001_Vnd_Tst_Sum
%v_cmt% IF (CHK_Exp_ST001=T AND FILESIZE("%fld_Results%ST001_Vnd_Tst_Sum.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST001)) COUNT
IF (CHK_Exp_ST001=T AND FILESIZE("%fld_Results%ST001_Vnd_Tst_Sum.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST001)) %v_EXPORT% FIELDS %v_Exp_Fields_ST001%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%ST001_Vnd_Tst_Sum" %v_fileOpt%
COMM
IF (CHK_Exp_ST001=T AND FILESIZE("%fld_Results%ST001D_Vnd_Tst_Sum.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST001D)) OPEN ST001D_Vnd_Tst_Sum
%v_cmt% IF (CHK_Exp_ST001=T AND FILESIZE("%fld_Results%ST001D_Vnd_Tst_Sum.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST001D)) COUNT
IF (CHK_Exp_ST001=T AND FILESIZE("%fld_Results%ST001D_Vnd_Tst_Sum.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST001D)) %v_EXPORT% FIELDS %v_Exp_Fields_ST001D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%ST001D_Vnd_Tst_Sum" %v_fileOpt%
COMM
IF (CHK_Exp_ST002=T AND FILESIZE("%fld_Results%ST002_Rev_Sum_RevDays.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST002)) OPEN ST002_Rev_Sum_RevDays
%v_cmt% IF (CHK_Exp_ST002=T AND FILESIZE("%fld_Results%ST002_Rev_Sum_RevDays.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST002)) COUNT
IF (CHK_Exp_ST002=T AND FILESIZE("%fld_Results%ST002_Rev_Sum_RevDays.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST002)) %v_EXPORT% FIELDS %v_Exp_Fields_ST002%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%ST002_Rev_Sum_RevDays" %v_fileOpt%
COMM
IF (CHK_Exp_ST003=T AND FILESIZE("%fld_Results%ST003_Rev_Vnd_Dup.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST003)) OPEN ST003_Rev_Vnd_Dup
%v_cmt% IF (CHK_Exp_ST003=T AND FILESIZE("%fld_Results%ST003_Rev_Vnd_Dup.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST003)) COUNT
IF (CHK_Exp_ST003=T AND FILESIZE("%fld_Results%ST003_Rev_Vnd_Dup.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST003)) %v_EXPORT% FIELDS %v_Exp_Fields_ST003%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%ST003_Rev_Vnd_Dup" %v_fileOpt%
COMM
IF (CHK_Exp_ST004=T AND FILESIZE("%fld_Results%ST004_Vnd_Ranking.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST004)) OPEN ST004_Vnd_Ranking
%v_cmt% IF (CHK_Exp_ST004=T AND FILESIZE("%fld_Results%ST004_Vnd_Ranking.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST004)) COUNT
IF (CHK_Exp_ST004=T AND FILESIZE("%fld_Results%ST004_Vnd_Ranking.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST004)) %v_EXPORT% FIELDS %v_Exp_Fields_ST004%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%ST004_Vnd_Ranking" %v_fileOpt%
COMM
IF (CHK_Exp_ST005=T AND FILESIZE("%fld_Results%ST005_Distr_Inv_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST005)) OPEN ST005_Distr_Inv_Mon
%v_cmt% IF (CHK_Exp_ST005=T AND FILESIZE("%fld_Results%ST005_Distr_Inv_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST005)) COUNT
IF (CHK_Exp_ST005=T AND FILESIZE("%fld_Results%ST005_Distr_Inv_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST005)) %v_EXPORT% FIELDS %v_Exp_Fields_ST005%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%ST005_Distr_Inv_Mon" %v_fileOpt%


SET SAFETY ON

^BATCH    UU001_Exp_VM_HIST1                 
[PARENT_FOLDER_ID] 1430796679
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Export Test Results into spesfic file format (e.g. Access, Excel, Text, Del and XML)
COMM *** Called by UA001_Export_Menu
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("TXT_Exp_filepath")="U" DO AA002_Variable_Setting
IF ISBLANK(TXT_Exp_filepath) TXT_Exp_filepath="Reports\"
IF LAST(ALLTRIM(TXT_Exp_filepath),1)<>"\" TXT_Exp_filepath=ALLTRIM(TXT_Exp_filepath)+"\"
IF FTYPE("TXT_AP014_Months")="U" DO AC002_Test_Var_Input

SET SAFETY OFF
SET ECHO ON

COMM For delimited files, define the separator and the qualifier on this line: IF (rad1=4) v_fileOpt       = "KEEPTITLE SEPARATOR TAB QUALIFIER ''"

IF (rad1=1) v_exporttype    = "ACCESS"
IF (rad1=1) v_fileext       = "MDB"
IF (rad1=1) v_fileOpt       = ""
IF (rad1=2) v_exporttype    = "EXCEL"
IF (rad1=2) v_fileext       = ""
IF (rad1=2) v_fileOpt       = ""
IF (rad1=3) v_exporttype    = "ASCII"
IF (rad1=3) v_fileext       = ""
IF (rad1=3) v_fileOpt       = "KEEPTITLE"
IF (rad1=4) v_exporttype    = "DELIMITED"
IF (rad1=4) v_fileext       = "DEL"
IF (rad1=4) v_fileOpt       = "KEEPTITLE SEPARATOR TAB"
IF (rad1=5) v_exporttype    = "XML"
IF (rad1=5) v_fileext       = "XML"
IF (rad1=5) v_fileOpt       = ""
IF (rad1=6) v_exporttype    = ""  
IF (rad1=6) v_fileext       = ""
IF (rad1=6) v_fileOpt       = ""
IF (rad1=6) v_EXPORT       = "EXTRACT"
IF (rad1<>6) v_EXPORT       = "EXPORT"
IF (rad1=6) v_Pre       = "RP_"
IF (rad1<>6) v_Pre       = ""
IF (rad1=6) SET FOLDER /%fld_Reports%
IF (rad1<>6) SET FOLDER /%fld_Tmps%

v_cmt="COMMENT"
v_if=""
IF rad1=5 AND v_AppCWM="" v_cmt=""
IF rad1=5 AND v_AppCWM="" v_if=" AND COUNT1>0 "

COMM *** Alvin's note: need to change Data Range Start and End Dates for all VM tests
COMM *** Vendor Master File Tests Output***
v_Exp_Fields_VM001 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' VMF_BnkAcc.BSB AS 'BSB' VMF_BnkAcc.Bnk_Acc_Num AS 'Bnk_Acc_Num' VMF_BnkAcc.Bnk_Acc_Name AS 'Bank Account Name' VMF_BnkAcc.Dt_Field1 VMF_BnkAcc.Dt_Field2 AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM001 = " Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' BSB Bnk_Acc_Num AS 'Bank Account Number' Bnk_Acc_Name AS 'Bank Account Name' VMF_BnkAcc.Dt_Field1 AS 'Start_Date' VMF_BnkAcc.Dt_Field2 AS 'End_Date' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date' Cha_Field2 AS 'Gst Registration Status' TEL1 AS 'Phone' FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System' TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_VM002 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM002= "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN Vndr_Sts AS 'Vendor Status' Vndr_Typ AS 'Vendor Type' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date'  TEL1 AS 'Phone'  FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System' TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_VM003 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM003 = "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status'  ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' TEL1 AS 'Phone'  FAX AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date' Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System'  TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_VM004 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' TEL1 AS 'Phone' FAX AS 'Fax' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM004 = "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status'  TEL1 AS 'Phone'  FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode Cntry AS 'Country'  AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System' TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_VM005 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM005 = "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date'  TEL1 AS 'Phone' FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System'  TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

COMM *** Missing Details ABN/Address/Tel ***
v_Exp_Fields_VM006 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN Cha_Field2 AS 'GST Status' Vndr_Typ AS 'Vendor Type' Pymnt_Trm  AS 'Payment Method' VMF_BnkAcc.BSB VMF_BnkAcc.Bnk_Acc_Num AS 'Bank Account Number' VMF_BnkAcc.Bnk_Acc_Name AS 'Bank Account Name' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM006 = "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN AS 'ABN' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Inv_Amt AS 'Total Invoice Amount' GST_AMT AS 'Total GST Amount' COUNT AS 'Total Trans Num'  DATE(Max_Inv_Dt) AS 'Last Invoice Date' TEL1 AS 'Phone' FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode Cntry AS 'Country'  Pymnt_Trm AS 'Payment Method' Co AS 'Company' DATE(Modf_Dt) AS 'Modified Date' Priority Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System'  TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"

COMM *** Missing Details ABN/Address/Tel Invoice Details***

v_Exp_Fields_VM006D = "HIST1_VM006_Mis_Details.Cha_Field1 AS 'Vendor Site'  HIST1_VM006_Mis_Details.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status'  ' '+ Inv_No AS 'Invoice Number' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Doc_Typ AS 'Document Type' Descrp AS 'Description'   isPaid AS 'Paid' Vchr_ID AS 'Voucher Number' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM *** Invalid ABN Format ***
v_Exp_Fields_VM007 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM007 = "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN AS 'ABN' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Inv_Amt AS 'Total Invoice Amount' GST_AMT AS 'Total GST Amount' COUNT AS 'Total Trans Num'  DATE(Max_Inv_Dt) AS 'Last Invoice Date' TEL1 AS 'Phone' FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode Cntry AS 'Country'  Pymnt_Trm AS 'Payment Method' Co AS 'Company' DATE(Modf_Dt) AS 'Modified Date' Priority Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System'  TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

COMM *** Invalid ABN Format Details***
COMM
v_Exp_Fields_VM007D = "Cha_Field1 AS 'Vendor Site'  Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name'  Vndr_Sts AS 'Vendor Status'  ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount'  GST_AMT AS 'GST Amount' Inv_Net_Amt AS 'Applied Amount' Num_Field1 AS 'Pay Amount' Vchr_ID AS 'Trans Num' Btch_No AS 'Trans Ref' Cha_Field1 AS 'Pay Reference' Cha_Field2 AS 'Pay Method' Pymnt_Trms AS 'Payment Method' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_VM007D =  "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' VMF_VND_Master_File.Cha_Field4 AS 'Vendor Number' VMF_VND_Master_File.Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"

COMM *** Cancelled / Registration ABN ***
v_Exp_Fields_VM008 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN ASIC_entityStatusCode AS 'ABN Status' ASIC_entityStatusEF AS 'ABN Status Eff Date' Vndr_Typ AS 'Vendor Type' HIST1_VM008Z_Can_ABN_Sum.Inv_Amt AS 'Total Invoice Amount' HIST1_VM008Z_Can_ABN_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM008 =  "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN AS 'ABN' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' VM008Z_Can_ABN_Sum.Inv_Amt AS 'Total Invoice Amount' GST_AMT AS 'Total GST Amount' COUNT AS 'Total Trans Num'  DATE(Max_Inv_Dt) AS 'Last Invoice Date' TEL1 AS 'Phone' FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode Cntry AS 'Country'  Pymnt_Trm AS 'Payment Method' Co AS 'Company' DATE(Modf_Dt) AS 'Modified Date' Priority Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System'  TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"


v_Exp_Fields_VM008D = "VM008_can_ABN.Cha_Field1  AS 'Vendor Site'  VM008_can_ABN.Cha_Field4 AS 'Vendor Number' VM008_can_ABN.Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"

COMM *** Invalid ABN Format against ABR***
v_Exp_Fields_VM009 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM009 = "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN AS 'ABN' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Inv_Amt AS 'Total Invoice Amount' GST_AMT AS 'Total GST Amount' COUNT AS 'Total Trans Num'  DATE(Max_Inv_Dt) AS 'Last Invoice Date' TEL1 AS 'Phone' FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode Cntry AS 'Country'  Pymnt_Trm AS 'Payment Method' Co AS 'Company' DATE(Modf_Dt) AS 'Modified Date' Priority Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System'  TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"

COMM *** Invalid ABN Format against ABR Details***
v_Exp_Fields_VM009D = "VM009_Invld_ABN_ABR.Cha_Field1 AS 'Vendor Site'  VM009_Invld_ABN_ABR.Cha_Field4 AS 'Vendor Number' VM009_Invld_ABN_ABR.Vndr_Nme AS 'Vendor Name'   Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"



v_Exp_Fields_VM010 = "Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status' ABN ASIC_entityStatusCode AS 'ABN Status' DATE(ASIC_entityStatusEF) AS 'ABN Registration Date' DATE(ASIC_GST_effFrom) AS 'GST Registration Date' DATE(ASIC_GST_effTo) AS 'GST Expiry Date' HIST1_VM010D_DeReg_GST_Sum.Inv_Amt AS 'Total Invoice Amount Post GST Expiry' HIST1_VM010D_DeReg_GST_Sum.GST_Amt AS 'GST Paid Post GST Expiry' HIST1_VM010D_DeReg_GST_Sum.COUNT AS 'Num Transactions Post GST Expiry' DATE(Max_Inv_Dt) AS 'Last Invoice Date' ASIC_entityDescription AS 'ASIC Description' ADD1 TEL1 Email1 Pymnt_Trm AS 'Payment Terms' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_VM010D = "Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status'  ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' ASIC_GST_effTo AS 'GST Expired Date' Inv_Amt AS 'Invoice Amount'  GST_AMT AS 'GST Amount' Inv_Net_Amt AS 'Applied Amount' Num_Field1 AS 'Pay Amount' Vchr_ID AS 'Trans Num' Btch_No AS 'Trans Ref' Cha_Field1 AS 'Pay Reference' Cha_Field2 AS 'Pay Method' Pymnt_Trms AS 'Term Code Desc' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM011 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status'ABN TEL1 TEL2 TEL3 ADD1 AS 'Address1' ADD2 AS 'Address2' ADD3 AS 'Address3' City AS 'City' State AS 'State' Email1 Email2 AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM012 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Vndr_InvlDt AS 'InActive Date' ABN Inv_Amt AS 'Total Invoice Amount Post InActive' GST_AMT AS 'Total GST Amount Post InActive' COUNT AS 'Total Trans Num Post InActive' DATE(Max_Inv_Dt) AS 'Last Invoice Date' ADD1 ADD2 ADD3 City State Cntry AS 'Country' TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm AS 'Payment Terms' Co AS 'Company' DATE(Modf_Dt) AS 'Modified Date' Priority  TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM012D = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' VM012_Inac_xx_Mon.Vndr_InvlDt AS 'Vendor InActive Date' Inv_Amt AS 'Invoice Amount' GST_AMT AS 'GST Amount' Inv_Net_Amt AS 'Inv Net Amount' DATE(Pd_Dt) AS 'Payment Date' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  isPaid AS 'Paid' Vchr_ID AS 'Voucher Number' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM013 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Trans_Num AS 'Trans Number' Inv_Amt AS 'Total Invoice Amount' GST_Amt AS 'Total GST Amount' DATE(Max_Inv_Dt) AS 'Last Invoice Date' ABN TEL1 City State Cntry AS 'Country' Pymnt_Trm AS 'Payment Terms' Created_Dt AS 'Created Date' DATE(Modf_Dt) AS 'Modified Date' Co AS 'Company' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM013D = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' GST_Amt AS 'GST Amount' Inv_Net_Amt AS 'Inv Net Amount' DATE(Pd_Dt) AS 'Payment Date' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM014 = "VM_EM Vndr_Site_ID Vndr_ID Vndr_Nme Vndr_Typ ABN BSB Bnk_Acc_Num ADD1 ADD2 ADD3 City State PCode Cntry TEL1 TEL2 TEL3 FAX Email1 Inv_Amt GST_Amt COUNT ABN Vndr_Sts Hire_Dt Created_Dt Modf_Dt Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM015 = "VM_EM Vndr_Site_ID Vndr_ID Vndr_Nme Vndr_Typ ABN BSB Bnk_Acc_Num ADD1 ADD2 ADD3 City State PCode Cntry TEL1 TEL2 TEL3 FAX Email1 Inv_Amt GST_Amt COUNT ABN Vndr_Sts Hire_Dt Created_Dt Modf_Dt Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM016 = "VM_EM Vndr_Site_ID Vndr_ID Vndr_Nme Vndr_Typ ABN BSB Bnk_Acc_Num ADD1 ADD2 ADD3 City State PCode Cntry TEL1 TEL2 TEL3 FAX Email1 Inv_Amt GST_Amt COUNT ABN Vndr_Sts Hire_Dt Created_Dt Modf_Dt Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM017 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date' Email1 Email2 ABN TEL1 TEL2 TEL3 ADD1 AS 'Address1' ADD2 AS 'Address2' ADD3 AS 'Address3' City AS 'City' State AS 'State' Pcode Cntry AS 'Country' TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

COMM *** Accounts Payable Tests Output***

v_Exp_Fields_AP001 = "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' VMF_VND_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_AP001 = "Flag VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description'  Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc" 

v_Exp_Fields_AP002 = "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' VMF_VND_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_AP002 = "Flag VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description' Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc" 

v_Exp_Fields_AP003 = "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' VMF_VND_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_AP003 = "Flag VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description' Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc" 

v_Exp_Fields_AP004 = "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' VMF_VND_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_AP004 = "Flag VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description'  Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc" 

COMM
v_Exp_Fields_AP005 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Inv_No AS 'Invoice Reference Seq Start' DATE(Inv_Dt) AS 'Invoice Date 1' ' '+ Inv_No2 AS 'Invoice Reference Seq End' DATE(Inv_Dt2) AS 'Invoice Date 2' Consec_Num AS 'Consecutive Num' Priority TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' REC_KEY SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP005D = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' GST_Amt AS 'GST Amount' Inv_Net_Amt AS 'Inv Net Amount' DATE(Pd_Dt) AS 'Payment Date' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' REC_KEY SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_AP006 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_AP006 = " Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description'  Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc" 

COMM
v_Exp_Fields_AP008 = "Cha_Field1 AS 'BUSINESS' Vndr_Sts AS 'Vendor Status' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' AllowLimit Inv_Amt AS 'Invoice Amount' DiffAmt AS 'Over Limit Amount' GST_Amt AS 'GST Amount' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invice Date' Vchr_ID AS 'Voucher Number' Doc_Typ AS 'Doc Type' Descrp AS 'Description' Curncy AS 'Currrency' DATE(Pd_Dt) AS 'Paid Date' PO_No isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date'  SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP009 = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status'  ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' GST_Amt AS 'GST Amount' GST_Pct Inv_Net_Amt AS 'Inv Net Amount' DATE(Pd_Dt) AS 'Payment Date' Doc_Typ AS 'Document Type' VMF_Vnd_Master_File.State AS 'State' VMF_Vnd_Master_File.Cntry AS 'Country' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP010 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Avg_Inv_Amt AS 'Average Invoice Amount' Max_Inv_Amt AS 'Largest Amount' Snd_Inv_Amt AS 'Second Largest Amount' Min_Inv_Amt AS 'Smallest Amount' c_Max_Avg_Pct AS 'Pct Largest to Average' c_Max_Snd_Pct AS 'Pct Largest to Second' Ttl_Inv_Amt_75 AS 'Total Invoice Amount 75' Count_75 AS 'Total Num 75' Ttl_Inv_Amt AS 'Total Invoice Amount' Ttl_Count AS 'Total Trans Num' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP010D = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Avg_Inv_Amt AS 'Average Invoice Amount' c_Inv_Avg_Pct AS 'Pct Invoice Amount to Average' GST_Amt AS 'GST Amount' Inv_Net_Amt AS 'Inv Net Amount' DATE(Pd_Dt) AS 'Payment Date' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM OLD AP011
COMM
v_Exp_Fields_AP011 = "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status'  Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' VMF_VND_Master_File.TEL1 AS 'Phone' VMF_VND_Master_File.FAX AS 'FAX' VMF_VND_Master_File.ADD1 AS 'Address' VMF_VND_Master_File.City AS 'City' VMF_VND_Master_File.State AS 'State' VMF_VND_Master_File.Pcode AS 'Postcode'  VMF_VND_Master_File.Cntry AS 'Country' VMF_VND_Master_File.Pymnt_Trms AS 'Payment Method' VMF_VND_Master_File.Vndr_Site_ID AS 'Vendor Site ID' VMF_VND_Master_File.Cha_Field3 AS 'Source System'  Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM
v_Exp_Fields_AP012 = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' DATE(Pd_Dt) AS 'Payment Date'  Inv_Amt AS 'Invoice Amount' PO_NO Rec_Qty AS 'Received Quantity' Rec_Amt AS 'Received Amount' Rec_Dt AS 'Received Date' PO_Date Amount AS 'PO Amount' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' GST_Amt AS 'GST Amount' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP013 = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Inv_Net_Amt AS 'Inv Net Amount' PO_NO Pst_Dt as 'Post Date' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' GST_Amt AS 'GST Amount' DATE(Pd_Dt) AS 'Payment Date' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM


v_Exp_Fields_AP014  = "VMF_Vnd_Master_File.Cha_Field1 AS 'Vendor Site' VMF_Vnd_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status'  Vndr_Typ AS 'Vendor Type' VMF_VND_Master_File.TEL1 AS 'Phone' VMF_VND_Master_File.FAX AS 'FAX' VMF_VND_Master_File.ADD1 AS 'Address' VMF_VND_Master_File.City AS 'City' VMF_VND_Master_File.State AS 'State' VMF_VND_Master_File.Pcode AS 'Postcode'  VMF_VND_Master_File.Cntry AS 'Country' VMF_Vnd_Master_File.Pymnt_Trm AS 'Payment Method' VMF_VND_Master_File.Vndr_Site_ID AS 'Vendor Site ID' VMF_VND_Master_File.Cha_Field3 AS 'Source System'  Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM
v_Exp_Fields_AP014  = "VMF_Vnd_Master_File.Cha_Field1 AS 'Vendor Site' VMF_Vnd_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
END

COMM v_Exp_Fields_AP014  = "VMF_Vnd_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status'  Vndr_Typ AS 'Vendor Type' VMF_VND_Master_File.TEL1 AS 'Phone' VMF_VND_Master_File.FAX AS 'FAX' VMF_VND_Master_File.ADD1 AS 'Address' VMF_VND_Master_File.City AS 'City' VMF_VND_Master_File.State AS 'State' VMF_VND_Master_File.Pcode AS 'Postcode'  VMF_VND_Master_File.Cntry AS 'Country' VMF_Vnd_Master_File.Pymnt_Trm AS 'Payment Method' VMF_VND_Master_File.Vndr_Site_ID AS 'Vendor Site ID' VMF_VND_Master_File.Cha_Field3 AS 'Source System'  Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM OLD copy of AP0014
COMM
v_Exp_Fields_AP014 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' ABN TEL1 City State Cntry AS 'Country' Pymnt_Trm AS 'Payment Terms' DATE(Max_Inv_Dt) AS 'Last Invoice Date' Created_Dt AS 'Created Date' DATE(Modf_Dt) AS 'Modified Date' Co AS 'Company' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP015 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Ttl_Inv_Amt AS 'Total Invoice Amount' Ttl_GST_Amt AS 'Total GST Amount' Count AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date' DATE(Modf_Dt) AS 'Modified Date' City State Cntry AS 'Country' TEL1 Pymnt_Trm AS 'Payment Terms' Co AS 'Company' DATE(Modf_Dt) AS 'Modified Date' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP015D = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' GST_Amt AS 'GST Amount' Inv_Net_Amt AS 'Inv Net Amount' DATE(Pd_Dt) AS 'Payment Date' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM *** Tech One***
COMM
v_Exp_Fields_AP015=""
v_Exp_Fields_AP015D = "isPaid AS 'Paid'  Vndr_ID Vndr_Nme Vndr_Sts Vndr_Typ Sub_Vnd_Nme Add City_PCode Inv_No Inv_Dt Inv_Amt Gst_Amt Inv_NetAmt Currency Pst_Dt Doc_Typ Trans_Typ TrType_Desc PO_NO Pay_DocNbr Pay_Date Pay_DocTyp Trans_Nbr Alloc_Trans_Nbr Period Pst_User  Vchr_ID AS 'Voucher Number' Priority TEST_NAME RptRunDate AS 'Test Date' Data_Rage_Start_Date AS 'Data_Range_Start_Date' Data_Rage_End_Date AS 'Data_Range_End_Date' Grp_KEY SORT_KEY SORT_KEY_Desc"

COMM *** SAP ***
COMM
v_Exp_Fields_AP015 = "Cha_Field4 AS 'Co' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' BSEC_NAME1 AS 'One Time Vendor Name' Inv_Amt AS 'Total Invoice Amount' Doc_Num AS 'Trans Number' BSEC_BANKL AS 'BSB' BSEC_BANKN AS 'Bank Acc Number' BSEC_STRAS AS 'Address' BSEC_PSTLZ AS 'Post Code' BSEC_ORT01 AS 'City' BSEC_REGIO AS 'State' BSEC_STCD1 AS 'TaxNbr' Curncy AS 'Currency' TEST_NAME RptRunDate AS 'Test Date' Data_Rage_Start_Date Data_Rage_End_Date SORT_KEY SORT_KEY_Desc Grp_KEY ID_KEY"
v_Exp_Fields_AP015D = "isPaid Cha_Field4 AS 'Co' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' BSEC_NAME1 AS 'One Time Vendor Name' BSEC_BANKL AS 'BSB' BSEC_BANKN AS 'Bank Acc Number'  Inv_No  AS 'Invoice Reference' DATETIME(Inv_Dt,'DD/MM/YYYY') AS 'Invoice Date' Inv_Amt AS 'Doc Invoice Amount' Curncy AS 'Currency' Inv_Amt_Loc AS 'Local Invoice Amount'  Doc_Typ AS 'Doc Type' Btch_No AS 'Doc Number' Descrp VOIDED Pst_Dt as 'Post Date' Cha_Field2 AS 'Clr_DocNbr' Pymnt_Trms Cha_Field1 AS 'Fiscal Year' Cha_Field3 AS 'Reversal Doc' Priority TEST_NAME RptRunDate AS 'Test Date' Data_Rage_Start_Date Data_Rage_End_Date SORT_KEY SORT_KEY_Desc Grp_KEY"


COMM *** Missing ABN***
COMM
v_Exp_Fields_AP016 = "Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status' Inv_Amt AS 'Total Invoice Amount' GST_AMT AS 'Total GST Amount' COUNT AS 'Total Trans Num' ABN AS 'ABN' DATE(Max_Inv_Dt) AS 'Last Invoice Date' ADD1 TEL1 Email1 Pymnt_Trm AS 'Payment Terms' Priority  TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"

COMM *** Missing ABN Invoice Details***
COMM
v_Exp_Fields_AP016D = "Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status'  ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount'  GST_AMT AS 'GST Amount' Inv_Net_Amt AS 'Applied Amount' Num_Field1 AS 'Pay Amount' Vchr_ID AS 'Trans Num' Btch_No AS 'Trans Ref' Cha_Field1 AS 'Pay Reference' Cha_Field2 AS 'Pay Method' Pymnt_Trms AS 'Term Code Desc' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP017 = "Vndr_Sts AS 'Vendor Status' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Inv_Amt AS 'Total Invoice Amount' GST_Amt AS 'Total GST Amount' COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date' ABN ADD1 AS 'Address1' State AS 'State' Cntry AS 'Country' TEL1 Priority TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date'  SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP017D = "Cha_Field1 AS 'BUSINESS' isPaid Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Inv_Amt AS 'Invoice Amount' GST_Amt AS 'GST Amount' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' DATE(Pd_Dt) AS 'Payment Date' Descrp AS 'Description' Curncy AS 'Currency' Priority TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date'  SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP018 = "Cha_Field1 AS 'BUSINESS' Vndr_Sts AS 'Vendor Status' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' AllowLimit Inv_Amt AS 'Invoice Amount' DiffAmt AS 'Under/Over Limit Amount' GST_Amt AS 'GST Amount' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invice Date' Vchr_ID AS 'Voucher Number' Doc_Typ AS 'Doc Type' Descrp AS 'Description' Curncy AS 'Currrency' DATE(Pd_Dt) AS 'Paid Date' PO_No isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date'  SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP019="Cha_Field1 AS 'BUSINESS' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status' Doc_Typ AS 'Document Type' DATE(Pd_Dt) AS 'Payment Date' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' GST_Amt AS 'GST Amount' Inv_Net_Amt AS 'Inv Net Amount' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP020="Vndr_Site_ID AS 'Compnay Vendor Number' %trg_VMF%.Vndr_Nme AS 'Vendor Name' %trg_VMF%.Vndr_Typ AS 'Vendor Type' %trg_VMF%.Vndr_Sts AS 'Vendor Status' %trg_VMF%.ABN YM AS 'Month of Year' Mon_Pmnt_Num AS 'Total Payments of Month' c_Btch_No AS 'Check Number' Pay_Pmnt_Num AS 'Payments Count' Pay_Amt AS 'Total Payment Amount' GST_Amt AS 'Total GST Paid Amount' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP020D="Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Remit Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' DATE(Pay_Dt) AS 'CHECK_DATE' Pay_No AS 'INVOICE_PAYMENT_ID' Btch_No AS 'Check Number' Pay_Amt AS 'Payment Amount'  GST_AMT AS 'GST Amount' Curncy AS 'Currency' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Pymnt_Trms AS 'Status Lookup Code' Pymnt_Mth AS 'PAYMENT_METHOD_CODE' Cha_Field2 AS 'INVOICING_VENDOR_SITE_ID' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP021="GAP_START_EXCLUSIVE GAP_END_EXCLUSIVE NUMBER_ITEMS_MISSING Priority TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP022=""
v_Exp_Fields_AP023=""
COMM
v_Exp_Fields_AP024="Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Trans_Num AS 'Trans Number' Inv_Amt AS 'Total Invoice Amount' GST_Amt AS 'Total GST Amount' Months AS 'Low Activity Months' DATE(Max_Inv_Dt) AS 'Last Invoice Date' ABN TEL1 City State Cntry AS 'Country' Pymnt_Trm AS 'Payment Terms' Created_Dt AS 'Created Date' DATE(Modf_Dt) AS 'Modified Date' Co AS 'Company' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM *** Employee Master File Tests Output***
COMM
v_Exp_Fields_EM001 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM002 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE  BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Tax_Fle_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM003 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM004 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE Dup_Add1 Dup_Add2 Dup_Add3 Dup_City Dup_State Dup_PCode Dup_Cntry Total_PayAmt Total_Pay_Num Tax_Fle_Num  TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM005 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE TEL1 TEL2 TEL3 Fax Total_PayAmt Total_Pay_Num Tax_Fle_Num Add1 Add2 Add3 City State PCode Cntry Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM006 = "Emp_ID AS 'Employee Number' Emp_Sts Co AS 'BUSINESS' COST_CENTRE Title Emp_Nme AS 'Emp Name' DATE(DOB) AS 'DOB' Sex Tax_Fle_Num DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM007 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM008 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM009 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM010 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM011 = "EMF_TMP_Emp.Emp_ID AS 'Employee Number' EMF_TMP_Emp.Emp_Nme AS 'Emp Name' EMF_TMP_Emp.Co As 'BUSINESS' EMF_TMP_Emp.COST_CENTRE BSB Bnk_Acc_Num BSB_NAME EMF_TMP_Emp.Tax_Fle_Num EMF_TMP_Emp.Add1 EMF_TMP_Emp.Add2 EMF_TMP_Emp.Add3 EMF_TMP_Emp.City EMF_TMP_Emp.State EMF_TMP_Emp.PCode EMF_TMP_Emp.Cntry EMF_TMP_Emp.TEL1 EMF_TMP_Emp.TEL2 EMF_TMP_Emp.TEL3 EMF_TMP_Emp.Fax EMF_TMP_Emp.Email_Bus EMF_TMP_Emp.Email_Privt EMF_TMP_Emp.Title DATE(EMF_TMP_Emp.DOB) AS 'DOB' EMF_TMP_Emp.Sex DATE(EMF_TMP_Emp.Hire_Dt) AS 'Hired Date' DATE(EMF_TMP_Emp.Trm_Dt) AS 'TERM_DATE' EMF_TMP_Emp.Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM012 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM013 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM014 = "Emp_Sts Co AS 'Emp Company' COST_CENTRE Emp_ID AS 'Emp_Code' Tax_Fle_Num Tax_Scale Total_PayAmt Total_Pay_Num Title Frst_Nme AS 'Given Name' Second_Given_Name Sur_Nme AS 'SurName' DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc State AS 'State' PCode As 'Post Code' Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM015 = "'~'+Emp_ID AS 'Employee Code' Frst_Nme AS 'First Name' Sur_Nme AS 'Last Name' Emp_Sts AS 'Emp Status' Emp_Catg AS 'Emp Type Desc' '~'+COST_CENTRE AS 'Cost Centre Code' DATETIME(Hire_Dt,'DD/MM/YYYY') AS 'Start Date' DATETIME(Commencement_Dt, 'DD/MM/YYYY') AS 'Commencement Date' Lv_Hrs_Taken Lv_Days_Taken Cal_Days_Taken Lst_Lv_EndDt AS 'Lst_Lv_End_Date' Lst_LvCode AS 'Lst Lv Reason Code' Lst_LvHrs AS 'Lst_Lv_TtlHrs' '~'+Tax_Fle_Num AS  'Tax_Fle_Num' Total_PayAmt AS 'Total_12M_PayAmt' Total_Pay_Num AS 'Total_12M_TranNum' '~'+Bnk_Acc_Num AS 'Bank Account' TEL1 AS 'Home Phone' TEL2 AS 'Mobile' ALLTRIM(Add1)+' ' + ALLTRIM(Add2) AS 'Address' City PCode AS 'Post Code' State DATETIME(DOB,'DD/MM/YYYY') AS 'Birth Date' Title AS 'Position Code' '~'+Cha_Field1 AS 'Dept Code' '~'+Cha_Field2 AS 'Location Code' Cha_Field3 AS 'Work Area Code' Test_Name DATETIME(RptRunDate,'DD/MM/YYYY') AS 'Test Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM016 = "'~'+Emp_ID AS 'Employee Code' Frst_Nme AS 'First Name' Sur_Nme AS 'Last Name' Emp_Sts AS 'Emp Status' Emp_Catg AS 'Emp Type Desc' '~'+COST_CENTRE AS 'Cost Centre Code' DATETIME(Hire_Dt,'DD/MM/YYYY') AS 'Start Date' DATETIME(Commencement_Dt, 'DD/MM/YYYY') AS 'Commencement Date' Lv_Code AS 'Leave Reason Code' AnnYear1 AS 'AnnY1_Hire_Date' AnnYear1_Lv_Days_Taken AS 'AnnY1_Sum_Lv_Days_Taken' AnnYear2 AS 'AnnY2_Hire_Date' AnnYear2_Lv_Days_Taken AS 'AnnY2_Sum_Lv_Days_Taken' AnnYear1_Cal_Days_Taken AS 'Y1_Calendar_Days' AnnYear2_Cal_Days_Taken AS 'Y2_Calendar_Days' DATETIME(DOB,'DD/MM/YYYY') AS 'Birth Date' '~'+Tax_Fle_Num AS  'Tax_Fle_Num' Total_PayAmt AS 'Total_12M_PayAmt' Total_Pay_Num AS 'Total_12M_TranNum' '~'+Bnk_Acc_Num AS 'Bank Account' TEL1 AS 'Home Phone' TEL2 AS 'Mobile' ALLTRIM(Add1)+' ' + ALLTRIM(Add2) AS 'Address' City PCode AS 'Post Code' State Title AS 'Position Code' '~'+Cha_Field1 AS 'Dept Code' '~'+Cha_Field2 AS 'Location Code' Cha_Field3 AS 'Work Area Code' Test_Name DATETIME(RptRunDate,'DD/MM/YYYY') AS 'Test Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM016D = "'~'+Emp_ID AS 'Employee Code' Frst_Nme AS 'First Name' Sur_Nme AS 'Last Name' Emp_Sts AS 'Emp Status' Emp_Catg AS 'Emp Type Desc' '~'+COST_CENTRE AS 'Cost Centre Code' DATETIME(Hire_Dt,'DD/MM/YYYY') AS 'Start Date' DATETIME(Commencement_Dt, 'DD/MM/YYYY') AS 'Commencement Date' ExceptionAnnYear ReasonCode StartDate AS 'Lv Start Date' EndDate AS 'Lv End Date' UnitsRequested AS 'Lv Hours Taken' TypeOfUnits ApprovedByCode ApprovedDate AS 'Approved Date' ProcessedDate AS 'Processed Date' c_Notes AS 'Notes'  Test_Name RptRunDate AS 'Test_Date'SORT_KEY"

COMM
v_Exp_Fields_EM017="'~'+Emp_ID AS 'Employee Code' Frst_Nme AS 'First Name' Sur_Nme AS 'Last Name' Emp_Sts AS 'Emp Status' Emp_Catg AS 'Emp Type Desc' '~'+COST_CENTRE AS 'Cost Centre Code' DATETIME(Hire_Dt,'DD/MM/YYYY') AS 'Start Date' DATETIME(Commencement_Dt, 'DD/MM/YYYY') AS 'Commencement Date' 'SICK' AS 'Leave Reason Code' SLTotalUnits AS 'Balance_SLTotalHrs' TtlSLHrs_Taken EndDate AS 'Lv End Date' ApprovedByCode ApprovedDate AS 'Approved Date' Notes DATETIME(DOB,'DD/MM/YYYY') AS 'Birth Date' '~'+Tax_Fle_Num AS  'Tax_Fle_Num' '~'+Bnk_Acc_Num AS 'Bank Account' TEL1 AS 'Home Phone' TEL2 AS 'Mobile' ALLTRIM(Add1)+' ' + ALLTRIM(Add2) AS 'Address' City PCode AS 'Post Code' State Title AS 'Position Code' '~'+Cha_Field1 AS 'Dept Code' '~'+Cha_Field2 AS 'Location Code' Cha_Field3 AS 'Work Area Code' Test_Name DATETIME(RptRunDate,'DD/MM/YYYY') AS 'Test Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM017D = "'~'+Emp_ID AS 'Employee Code' Frst_Nme AS 'First Name' Sur_Nme AS 'Last Name' Emp_Sts AS 'Emp Status' Emp_Catg AS 'Emp Type Desc' '~'+COST_CENTRE AS 'Cost Centre Code' DATETIME(Hire_Dt,'DD/MM/YYYY') AS 'Start Date' DATETIME(Commencement_Dt, 'DD/MM/YYYY') AS 'Commencement Date' ReasonCode StartDate AS 'Lv Start Date' EndDate AS 'Lv End Date' UnitsRequested AS 'Lv Hours Taken' TypeOfUnits ApprovedByCode ApprovedDate AS 'Approved Date' ProcessedDate AS 'Processed Date' c_Notes AS 'Notes'  Test_Name RptRunDate AS 'Test_Date'SORT_KEY"


COMM *** Payroll Tests Output***
COMM
v_Exp_Fields_PR001 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR002 = "Co As 'BUSINESS' COST_CENTRE Emp_ID AS 'Employee Number' DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR003 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Trm_Dt) AS 'TERM_DATE' DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY Title  STATE PCode AS 'Post Code' DATE(Hire_Dt) AS 'Hired Date'  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR004 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY Title  DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR005 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Trm_Dt) AS 'TERM_DATE' DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY Title DATE(Hire_Dt) AS 'Hired Date'  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR006 = ""
COMM
v_Exp_Fields_PR007 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours AUTOPAY_HOURS_DAYS LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY Title DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR008 = "Emp_ID AS 'Employee Number' Co As 'BUSINESS' COST_CENTRE PAYCODE_AMOUNT PAYCODE_HOURS Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR008D = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY Title  DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR009="Co As 'BUSINESS' Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' DATE(Prd_Dt) AS 'Prd_Dt' PayCode_Amount PayCode_Hours Avg_PayCode_Amount Avg_PayCode_Hours Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR009D = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY Title  DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"

COMM *** EXPORT STATICSTIC Reports *** 
COMM
v_Exp_Fields_ST001 = "Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Ttl_Issues AS 'Total Issues Found' COUNT AS 'Number of Test Failed' Priority DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_ST001D = "Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' COUNT AS 'Total Issues Found in the Test' TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_ST002 = "Rev_Days_1 AS 'Rev_Days' Count AS 'Total Reversals Num' FIELD_PERCENTAGE ABS_InvAmt"
COMM
v_Exp_Fields_ST003 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status' Total_InvAmt AS 'Total Invoices Amount' Trns_Num AS 'Total Invoices Num' Dup_InvAmt Dup_Num  Cln_Dup_InvAmt Cln_Dup_Num PCT_Cln_Dup_Trns_Amt PCT_Cln_Dup_Trns_Num  Rev_InvAmt Rev_Num PCT_Rev_Dup_Amt PCT_Rev_Dup_Num Vndr_Typ AS 'Vednor Type' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_ST004 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_Nme AS 'Vendor Name' Inv_Amt AS 'Invoices Amount' GST_Amt AS 'GST Amount' COUNT AS 'Total Trans Num' COUNT_PERCENTAGE AS 'Trans Num Pct' FIELD_PERCENTAGE AS 'Inv Amt Pct' Priority RptRunDate SORT_KEY"
COMM
v_Exp_Fields_ST005 = "YM AS 'Month' Inv_Amt AS 'Invoices Amount' GST_Amt AS 'GST Amount' COUNT AS 'Total Trans Num' COUNT_PERCENTAGE AS 'Trans Num Pct' Priority RptRunDate SORT_KEY"
COMM
v_Exp_Fields_ST006 = ""

COMM *** Export Vendor Master File Tests***

IF (CHK_Exp_VM001=T AND FILESIZE("HIST1_VM001_Dup_Vnd_BankAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM001)) OPEN HIST1_VM001_Dup_Vnd_BankAcc
%v_cmt% IF (CHK_Exp_VM001=T AND FILESIZE("HIST1_VM001_Dup_Vnd_BankAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM001)) COUNT
IF (CHK_Exp_VM001=T AND FILESIZE("HIST1_VM001_Dup_Vnd_BankAcc.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM001)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM001%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%Hist1_VM001_Dup_Vnd_BankAcc" %v_fileOpt%

IF (CHK_Exp_VM002=T AND FILESIZE("HIST1_VM002_Dup_Vnd_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM002)) OPEN HIST1_VM002_Dup_Vnd_ABN
%v_cmt% IF (CHK_Exp_VM002=T AND FILESIZE("HIST1_VM002_Dup_Vnd_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM002)) COUNT
IF (CHK_Exp_VM002=T AND FILESIZE("HIST1_VM002_Dup_Vnd_ABN.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM002)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM002%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%Hist1_VM002_Dup_Vnd_ABN" %v_fileOpt%

IF (CHK_Exp_VM003=T AND FILESIZE("HIST1_VM003_Dup_Vnd_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM003)) OPEN HIST1_VM003_Dup_Vnd_Add
%v_cmt% IF (CHK_Exp_VM003=T AND FILESIZE("HIST1_VM003_Dup_Vnd_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM003)) COUNT
IF (CHK_Exp_VM003=T AND FILESIZE("HIST1_VM003_Dup_Vnd_Add.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM003)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM003%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%Hist1_VM003_Dup_Vnd_Add" %v_fileOpt%

IF (CHK_Exp_VM004=T AND FILESIZE("VM004_Dup_Vnd_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM004)) OPEN VM004_Dup_Vnd_Tel
%v_cmt% IF (CHK_Exp_VM004=T AND FILESIZE("VM004_Dup_Vnd_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM004)) COUNT
IF (CHK_Exp_VM004=T AND FILESIZE("VM004_Dup_Vnd_Tel.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM004)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM004%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM004_Dup_Vnd_Tel" %v_fileOpt%


IF (CHK_Exp_VM005=T AND FILESIZE("HIST1_VM005_Dup_Vnd_Name.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM005)) OPEN HIST1_VM005_Dup_Vnd_Name
%v_cmt% IF (CHK_Exp_VM005=T AND FILESIZE("HIST1_VM005_Dup_Vnd_Name.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM005)) COUNT
IF (CHK_Exp_VM005=T AND FILESIZE("HIST1_VM005_Dup_Vnd_Name.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM005)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM005%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%Hist1_VM005_Dup_Vnd_Name" %v_fileOpt%


IF (CHK_Exp_VM006=T AND FILESIZE("HIST1_VM006_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006)) OPEN HIST1_VM006_Mis_Details
%v_cmt% IF (CHK_Exp_VM006=T AND FILESIZE("HIST1_VM006_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006)) COUNT
IF (CHK_Exp_VM006=T AND FILESIZE("HIST1_VM006_Mis_Details.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM006)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM006%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%Hist1_VM006_Mis_Details" %v_fileOpt%


IF (CHK_Exp_VM006=T AND FILESIZE("HIST1_VM006D_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006D)) OPEN HIST1_VM006D_Mis_Details
%v_cmt% IF (CHK_Exp_VM006=T AND FILESIZE("HIST1_VM006D_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006D)) COUNT
IF (CHK_Exp_VM006=T AND FILESIZE("HIST1_VM006D_Mis_Details.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM006D)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM006D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%Hist1_VM006D_Mis_Details" %v_fileOpt%

COMMENT
IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006D_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006D)) OPEN TMP_VM006D
%v_cmt% IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006D_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006D)) COUNT
IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006D_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006D)) %v_if% %v_EXPORT% FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM006D_Mis_Details" %v_fileOpt%
END

IF ((CHK_Exp_VM007=T OR CHK_Exp_AP016=T) AND FILESIZE("HIST1_VM007_Invld_Frmt_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM007)) OPEN HIST1_VM007_Invld_Frmt_ABN
%v_cmt% IF ((CHK_Exp_VM007=T OR CHK_Exp_AP016=T) AND FILESIZE("HIST1_VM007_Invld_Frmt_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM007)) COUNT
IF ((CHK_Exp_VM007=T OR CHK_Exp_AP016=T) AND FILESIZE("HIST1_VM007_Invld_Frmt_ABN.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM007)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM007%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%Hist1_VM007_Invld_Frmt_ABN" %v_fileOpt%

IF ((CHK_Exp_VM007=T OR CHK_Exp_AP016=T) AND FILESIZE("HIST1_VM007D_Invld_Frmt_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM007D)) OPEN HIST1_VM007D_Invld_Frmt_ABN
%v_cmt% IF ((CHK_Exp_VM007=T OR CHK_Exp_AP016=T) AND FILESIZE("HIST1_VM007D_Invld_Frmt_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM007D)) COUNT
IF ((CHK_Exp_VM007=T OR CHK_Exp_AP016=T) AND FILESIZE("HIST1_VM007D_Invld_Frmt_ABN.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM007D)) %v_EXPORT% FIELDS %v_Exp_Fields_VM007D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%Hist1_VM007_Invld_Frmt_ABN" %v_fileOpt%

IF ((CHK_Exp_VM008=T OR CHK_Exp_AP016=T) AND FILESIZE("HIST1_VM008_Can_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM008)) OPEN HIST1_VM008_Can_ABN
%v_cmt% IF ((CHK_Exp_VM008=T OR CHK_Exp_AP016=T) AND FILESIZE("HIST1_VM008_Can_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM008)) COUNT
IF ((CHK_Exp_VM008=T OR CHK_Exp_AP016=T) AND FILESIZE("HIST1_VM008_Can_ABN.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM008)) %v_EXPORT% FIELDS %v_Exp_Fields_VM008%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%Hist1_VM008_Can_ABN" %v_fileOpt%

IF ((CHK_Exp_VM008=T OR CHK_Exp_AP016=T) AND FILESIZE("HIST1_VM008D_Can_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM008D)) OPEN VM008D_Can_ABN
%v_cmt% IF ((CHK_Exp_VM008=T OR CHK_Exp_AP016=T) AND FILESIZE("HIST1_VM008D_Can_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM008D)) COUNT
IF ((CHK_Exp_VM008=T OR CHK_Exp_AP016=T) AND FILESIZE("HIST1_VM008D_Can_ABN.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM008D)) %v_EXPORT% FIELDS FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%Hist1_VM008D_Can_ABN" %v_fileOpt%

IF ((CHK_Exp_VM009=T OR CHK_Exp_AP016=T) AND FILESIZE("HIST1_VM009_Invld_ABN_ABR.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM009)) OPEN HIST1_VM009_Invld_ABN_ABR
%v_cmt% IF ((CHK_Exp_VM009=T OR CHK_Exp_AP016=T) AND FILESIZE("HIST1_VM009_Invld_ABN_ABR.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM009)) COUNT
IF ((CHK_Exp_VM009=T OR CHK_Exp_AP016=T) AND FILESIZE("HIST1_VM009_Invld_ABN_ABR.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM009)) %v_EXPORT% FIELDS %v_Exp_Fields_VM009%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%Hist1_VM009_Invld_ABN_ABR" %v_fileOpt%

IF ((CHK_Exp_VM009=T OR CHK_Exp_AP016=T) AND FILESIZE("HIST1_VM009D_Invld_ABN_ABR.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM009D)) OPEN HIST1_VM009D_Invld_ABN_ABR
%v_cmt% IF ((CHK_Exp_VM009=T OR CHK_Exp_AP016=T) AND FILESIZE("HIST1_VM009D_Invld_ABN_ABR.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM009D)) COUNT
IF ((CHK_Exp_VM009=T OR CHK_Exp_AP016=T) AND FILESIZE("HIST1_VM009D_Invld_ABN_ABR.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM009D)) %v_EXPORT% FIELDS %v_Exp_Fields_VM009D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%Hist1_VM009D_Invld_ABN_ABR" %v_fileOpt%


COMM *** AP007 --> VM010/VM010D DeReg GST***
IF ((CHK_Exp_VM010=T OR CHK_Exp_AP007=T ) AND FILESIZE("HIST1_VM010_DeReg_GST.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM010)) OPEN HIST1_VM010_DeReg_GST
%v_cmt% IF ((CHK_Exp_VM010=T OR CHK_Exp_AP007=T ) AND FILESIZE("HIST1_VM010_DeReg_GST.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM010)) COUNT
IF ((CHK_Exp_VM010=T OR CHK_Exp_AP007=T ) AND FILESIZE("HIST1_VM010_DeReg_GST.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM010)) %v_EXPORT% FIELDS %v_Exp_Fields_VM010%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%Hist1_VM010_DeReg_GST" %v_fileOpt%

IF ((CHK_Exp_VM010=T OR CHK_Exp_AP007=T) AND FILESIZE("HIST1_VM010D_DeReg_GST.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM010)) OPEN HIST1_VM010D_DeReg_GST
%v_cmt% IF ((CHK_Exp_VM010=T OR CHK_Exp_AP007=T) AND FILESIZE("HIST1_VM010D_DeReg_GST.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM010)) COUNT
IF ((CHK_Exp_VM010=T OR CHK_Exp_AP007=T) AND FILESIZE("HIST1_VM010D_DeReg_GST.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM010)) %v_EXPORT% FIELDS %v_Exp_Fields_VM010D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%Hist1_VM010D_DeReg_GST" %v_fileOpt%
COMM
IF (CHK_Exp_VM011=T AND FILESIZE("%fld_Results%VM011_Upd_Mul_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM011)) OPEN VM011_Upd_Mul_xx_Mon
%v_cmt% IF (CHK_Exp_VM011=T AND FILESIZE("%fld_Results%VM011_Upd_Mul_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM011)) COUNT
IF (CHK_Exp_VM011=T AND FILESIZE("%fld_Results%VM011_Upd_Mul_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM011)) %v_EXPORT% FIELDS %v_Exp_Fields_VM011%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM011_Upd_Mul_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_VM012=T AND FILESIZE("%fld_Results%VM012_Inac_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM012)) OPEN VM012_Inac_xx_Mon
%v_cmt% IF (CHK_Exp_VM012=T AND FILESIZE("%fld_Results%VM012_Inac_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM012)) COUNT
IF (CHK_Exp_VM012=T AND FILESIZE("%fld_Results%VM012_Inac_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM012)) %v_EXPORT% FIELDS %v_Exp_Fields_VM012%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM012_Inac_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_VM012=T AND FILESIZE("%fld_Results%VM012D_Inac_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM012D)) OPEN VM012D_Inac_xx_Mon
%v_cmt% IF (CHK_Exp_VM012=T AND FILESIZE("%fld_Results%VM012D_Inac_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM012D)) COUNT
IF (CHK_Exp_VM012=T AND FILESIZE("%fld_Results%VM012D_Inac_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM012D)) %v_EXPORT% FIELDS %v_Exp_Fields_VM012D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM012D_Inac_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_VM013=T AND FILESIZE("%fld_Results%VM013_OneTim_Vnd_Spend.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM013)) OPEN VM013_OneTim_Vnd_Spend
%v_cmt% IF (CHK_Exp_VM013=T AND FILESIZE("%fld_Results%VM013_OneTim_Vnd_Spend.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM013)) COUNT
IF (CHK_Exp_VM013=T AND FILESIZE("%fld_Results%VM013_OneTim_Vnd_Spend.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM013)) %v_EXPORT% FIELDS %v_Exp_Fields_VM013%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM013_OneTim_Vnd_Spend" %v_fileOpt%
COMM
IF (CHK_Exp_VM013=T AND FILESIZE("%fld_Results%VM013D_OneTim_Vnd_Spend.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM013D)) OPEN VM013D_OneTim_Vnd_Spend
%v_cmt% IF (CHK_Exp_VM013=T AND FILESIZE("%fld_Results%VM013D_OneTim_Vnd_Spend.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM013D)) COUNT
IF (CHK_Exp_VM013=T AND FILESIZE("%fld_Results%VM013D_OneTim_Vnd_Spend.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM013D)) %v_EXPORT% FIELDS %v_Exp_Fields_VM013D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM013D_OneTim_Vnd_Spend" %v_fileOpt%
COMM
IF (CHK_Exp_VM014=T AND FILESIZE("%fld_Results%VM014_VndEmp_BankAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM014)) OPEN VM014_VndEmp_BankAcc
%v_cmt% IF (CHK_Exp_VM014=T AND FILESIZE("%fld_Results%VM014_VndEmp_BankAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM014)) COUNT
IF (CHK_Exp_VM014=T AND FILESIZE("%fld_Results%VM014_VndEmp_BankAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM014)) %v_EXPORT% FIELDS %v_Exp_Fields_VM014%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM014_VndEmp_BankAcc" %v_fileOpt%

COMM
IF (CHK_Exp_VM015=T AND FILESIZE("%fld_Results%VM015_VndEmp_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM015)) OPEN VM015_VndEmp_Add
%v_cmt% IF (CHK_Exp_VM015=T AND FILESIZE("%fld_Results%VM015_VndEmp_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM015)) COUNT
IF (CHK_Exp_VM015=T AND FILESIZE("%fld_Results%VM015_VndEmp_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM015)) %v_EXPORT% FIELDS %v_Exp_Fields_VM015%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM015_VndEmp_Add" %v_fileOpt%
COMM
IF (CHK_Exp_VM016=T AND FILESIZE("%fld_Results%VM016_VndEmp_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM016)) OPEN VM016_VndEmp_Tel
%v_cmt% IF (CHK_Exp_VM016=T AND FILESIZE("%fld_Results%VM016_VndEmp_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM016)) COUNT
IF (CHK_Exp_VM016=T AND FILESIZE("%fld_Results%VM016_VndEmp_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM016)) %v_EXPORT% FIELDS %v_Exp_Fields_VM016%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM016_VndEmp_Tel" %v_fileOpt%
COMM
IF (CHK_Exp_VM017=T AND FILESIZE("%fld_Results%VM017_Dup_Vnd_Email.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM017)) OPEN VM017_Dup_Vnd_Email
%v_cmt% IF (CHK_Exp_VM017=T AND FILESIZE("%fld_Results%VM017_Dup_Vnd_Email.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM017)) COUNT
IF (CHK_Exp_VM017=T AND FILESIZE("%fld_Results%VM017_Dup_Vnd_Email.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM017)) %v_EXPORT% FIELDS %v_Exp_Fields_VM017%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM017_Dup_Vnd_Email" %v_fileOpt%

COMM *** %v_EXPORT% Accounts Payable Tests ***
IF (CHK_Exp_AP001=T AND FILESIZE("%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP001)) OPEN AP001_Dup_Amt_Dt_Inv_Vndr
%v_cmt% IF (CHK_Exp_AP001=T AND FILESIZE("%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP001)) COUNT
IF (CHK_Exp_AP001=T AND FILESIZE("%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP001)) %v_EXPORT% FIELDS %v_Exp_Fields_AP001%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP001_Dup_Amt_Dt_Inv_Vndr" %v_fileOpt%

COMM
IF (CHK_Exp_AP001=T AND FILESIZE("%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP001)) OPEN TMP_AP001
%v_cmt% IF (CHK_Exp_AP001=T AND FILESIZE("%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP001)) COUNT
IF (CHK_Exp_AP001=T AND FILESIZE("%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP001)) %v_EXPORT% FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP001_Dup_Amt_Dt_Inv_Vndr" %v_fileOpt%
END



IF (CHK_Exp_AP002=T AND FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP002)) OPEN AP002_Dup_Amt_Inv_Vndr
%v_cmt% IF (CHK_Exp_AP002=T AND FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP002)) COUNT
IF (CHK_Exp_AP002=T AND FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP002)) %v_EXPORT% FIELDS %v_Exp_Fields_AP002%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP002_Dup_Amt_Inv_Vndr" %v_fileOpt%

COMM
IF (CHK_Exp_AP002=T AND FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP002)) OPEN TMP_AP002
%v_cmt% IF (CHK_Exp_AP002=T AND FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP002)) COUNT
IF (CHK_Exp_AP002=T AND FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP002)) %v_EXPORT% FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP002_Dup_Amt_Inv_Vndr" %v_fileOpt%
END


IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) OPEN AP003_Dup_Amt_Dt_Inv
%v_cmt% IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) COUNT
IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) %v_EXPORT% FIELDS %v_Exp_Fields_AP003%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP003_Dup_Amt_Dt_Inv" %v_fileOpt%
IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) %v_EXPORT% FIELDS %v_Exp_Fields_AP003%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP003_Dup_Amt_Dt_Inv" %v_fileOpt%

COMM
IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) OPEN TMP_AP003
%v_cmt% IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) COUNT
IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) %v_EXPORT% FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP003_Dup_Amt_Dt_Inv" %v_fileOpt%
END


IF (CHK_Exp_AP004=T AND FILESIZE("%fld_Results%AP004_Dup_Amt_Dt_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) OPEN AP004_Dup_Amt_Dt_Vndr
%v_cmt% IF (CHK_Exp_AP004=T AND FILESIZE("%fld_Results%AP004_Dup_Amt_Dt_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) COUNT
IF (CHK_Exp_AP004=T AND FILESIZE("%fld_Results%AP004_Dup_Amt_Dt_Vndr.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) %v_EXPORT% FIELDS %v_Exp_Fields_AP004%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP004_Dup_Amt_Dt_Vndr" %v_fileOpt%

COMM
IF (CHK_Exp_AP004=T AND FILESIZE("%fld_Results%AP004_Dup_Amt_Dt_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) OPEN TMP_AP004
%v_cmt% IF (CHK_Exp_AP004=T AND FILESIZE("%fld_Results%AP004_Dup_Amt_Dt_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) COUNT
IF (CHK_Exp_AP004=T AND FILESIZE("%fld_Results%AP004_Dup_Amt_Dt_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) %v_EXPORT% FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP004_Dup_Amt_Dt_Vndr" %v_fileOpt%
END

COMM
IF (CHK_Exp_AP005=T AND FILESIZE("%fld_Results%AP005_3Cons_InvNo.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP005)) OPEN AP005_3Cons_InvNo
%v_cmt% IF (CHK_Exp_AP005=T AND FILESIZE("%fld_Results%AP005_3Cons_InvNo.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP005))  COUNT
IF (CHK_Exp_AP005=T AND FILESIZE("%fld_Results%AP005_3Cons_InvNo.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP005)) %v_EXPORT% FIELDS %v_Exp_Fields_AP005%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP005_3Cons_InvNo" %v_fileOpt%
COMM
IF (CHK_Exp_AP005=T AND FILESIZE("%fld_Results%AP005D_3Cons_InvNo_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP005D)) OPEN AP005D_3Cons_InvNo_Details
%v_cmt% IF (CHK_Exp_AP005=T AND FILESIZE("%fld_Results%AP005D_3Cons_InvNo_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP005D)) COUNT
IF (CHK_Exp_AP005=T AND FILESIZE("%fld_Results%AP005D_3Cons_InvNo_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP005D)) %v_EXPORT% FIELDS %v_Exp_Fields_AP005D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP005D_3Cons_InvNo_Details" %v_fileOpt%

IF (CHK_Exp_AP006=T AND FILESIZE("%fld_Results%AP006_Pay_Not_In_VMF.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP006)) OPEN AP006_Pay_Not_In_VMF
%v_cmt% IF (CHK_Exp_AP006=T AND FILESIZE("%fld_Results%AP006_Pay_Not_In_VMF.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP006)) COUNT
IF (CHK_Exp_AP006=T AND FILESIZE("%fld_Results%AP006_Pay_Not_In_VMF.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP006)) %v_EXPORT% FIELDS %v_Exp_Fields_AP006%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP006_Pay_Not_In_VMF" %v_fileOpt%

COMM *** AP007 --> VM010/VM010D DeReg_GST ***

COMm *** AP008 Exc_Alw_Limit ***
COMM
IF (CHK_Exp_AP008=T AND FILESIZE("%fld_Results%AP008_Exc_Alw_Limit.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP008)) OPEN AP008_Exc_Alw_Limit
%v_cmt% IF (CHK_Exp_AP008=T AND FILESIZE("%fld_Results%AP008_Exc_Alw_Limit.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP008)) COUNT
IF (CHK_Exp_AP008=T AND FILESIZE("%fld_Results%AP008_Exc_Alw_Limit.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP008)) %v_EXPORT% FIELDS %v_Exp_Fields_AP008%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP008_Exc_Alw_Limit" %v_fileOpt%
COMM
IF (CHK_Exp_AP009=T AND FILESIZE("%fld_Results%AP009_GST_Over_Char.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP009)) OPEN AP009_GST_Over_Char
%v_cmt% IF (CHK_Exp_AP009=T AND FILESIZE("%fld_Results%AP009_GST_Over_Char.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP009)) COUNT
IF (CHK_Exp_AP009=T AND FILESIZE("%fld_Results%AP009_GST_Over_Char.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP009)) %v_EXPORT% FIELDS %v_Exp_Fields_AP009%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP009_GST_Over_Char" %v_fileOpt%
COMM
IF (CHK_Exp_AP010=T AND FILESIZE("%fld_Results%AP010_Large_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP010)) OPEN AP010_Large_Inv
%v_cmt% IF (CHK_Exp_AP010=T AND FILESIZE("%fld_Results%AP010_Large_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP010)) COUNT
IF (CHK_Exp_AP010=T AND FILESIZE("%fld_Results%AP010_Large_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP010)) %v_EXPORT% FIELDS %v_Exp_Fields_AP010%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP010_Large_Inv" %v_fileOpt%
COMM
IF (CHK_Exp_AP010=T AND FILESIZE("%fld_Results%AP010D_Large_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP010D)) OPEN AP010D_Large_Inv
%v_cmt% IF (CHK_Exp_AP010=T AND FILESIZE("%fld_Results%AP010D_Large_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP010D)) COUNT
IF (CHK_Exp_AP010=T AND FILESIZE("%fld_Results%AP010D_Large_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP010D)) %v_EXPORT% FIELDS %v_Exp_Fields_AP010D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP010D_Large_Inv" %v_fileOpt%
COMM
IF (CHK_Exp_AP011=T AND FILESIZE("%fld_Results%AP011_PODt_Aft_InvDt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP011)) OPEN AP011_PODt_Aft_InvDt
%v_cmt% IF (CHK_Exp_AP011=T AND FILESIZE("%fld_Results%AP011_PODt_Aft_InvDt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP011)) COUNT
IF (CHK_Exp_AP011=T AND FILESIZE("%fld_Results%AP011_PODt_Aft_InvDt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP011)) %v_EXPORT% FIELDS %v_Exp_Fields_AP011%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP011_PODt_Aft_InvDt" %v_fileOpt%
COMM
IF (CHK_Exp_AP012=T AND FILESIZE("%fld_Results%AP012_POs_No_Goods.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP012)) OPEN AP012_POs_No_Goods
%v_cmt% IF (CHK_Exp_AP012=T AND FILESIZE("%fld_Results%AP012_POs_No_Goods.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP012)) COUNT
IF (CHK_Exp_AP012=T AND FILESIZE("%fld_Results%AP012_POs_No_Goods.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP012)) %v_EXPORT% FIELDS %v_Exp_Fields_AP012%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP012_POs_No_Goods" %v_fileOpt%
COMM
IF (CHK_Exp_AP013=T AND FILESIZE("%fld_Results%AP013_PO_Mul_Diff_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP013)) OPEN AP013_PO_Mul_Diff_Vnd
%v_cmt% IF (CHK_Exp_AP013=T AND FILESIZE("%fld_Results%AP013_PO_Mul_Diff_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP013)) COUNT
IF (CHK_Exp_AP013=T AND FILESIZE("%fld_Results%AP013_PO_Mul_Diff_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP013)) %v_EXPORT% FIELDS %v_Exp_Fields_AP013%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP013_PO_Mul_Diff_Vnd" %v_fileOpt%

COMM
IF (CHK_Exp_AP014=T AND FILESIZE("%fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP014)) OPEN TMP_AP014
%v_cmt% IF (CHK_Exp_AP014=T AND FILESIZE("%fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP014)) COUNT
IF (CHK_Exp_AP014=T AND FILESIZE("%fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP014)) %v_EXPORT% FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP014_No_Trans_%TXT_AP014_Months%_Mon" %v_fileOpt%
END 

IF (CHK_Exp_AP006=T AND FILESIZE("%fld_Results%AP006_Pay_Not_In_VMF.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP006)) OPEN AP006_Pay_Not_In_VMF
%v_cmt% IF (CHK_Exp_AP006=T AND FILESIZE("%fld_Results%AP006_Pay_Not_In_VMF.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP006)) COUNT
IF (CHK_Exp_AP006=T AND FILESIZE("%fld_Results%AP006_Pay_Not_In_VMF.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP006)) %v_EXPORT% FIELDS %v_Exp_Fields_AP006%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP006_Pay_Not_In_VMF" %v_fileOpt%

IF (CHK_Exp_AP014=T AND FILESIZE("%fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP014)) OPEN AP014_No_Trans_%TXT_AP014_Months%_Mon
%v_cmt% IF (CHK_Exp_AP014=T AND FILESIZE("%fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP014)) COUNT
IF (CHK_Exp_AP014=T AND FILESIZE("%fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP014)) %v_EXPORT% FIELDS %v_Exp_Fields_AP014%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP014_No_Trans_%TXT_AP014_Months%_Mon" %v_fileOpt%


COMM
IF (CHK_Exp_AP015=T AND FILESIZE("%fld_Results%AP015_Mul_Trans_OneTim_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP015)) OPEN AP015_Mul_Trans_OneTim_Vnd
%v_cmt% IF (CHK_Exp_AP015=T AND FILESIZE("%fld_Results%AP015_Mul_Trans_OneTim_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP015)) COUNT
IF (CHK_Exp_AP015=T AND FILESIZE("%fld_Results%AP015_Mul_Trans_OneTim_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP015)) %v_EXPORT% FIELDS %v_Exp_Fields_AP015%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP015_Mul_Trans_OneTim_Vnd" %v_fileOpt%
COMM
IF (CHK_Exp_AP015=T AND FILESIZE("%fld_Results%AP015D_Mul_Trans_OneTim_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP015D)) OPEN AP015D_Mul_Trans_OneTim_Vnd
%v_cmt% IF (CHK_Exp_AP015=T AND FILESIZE("%fld_Results%AP015D_Mul_Trans_OneTim_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP015D)) COUNT
IF (CHK_Exp_AP015=T AND FILESIZE("%fld_Results%AP015D_Mul_Trans_OneTim_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP015D)) %v_EXPORT% FIELDS %v_Exp_Fields_AP015D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP015D_Mul_Trans_OneTim_Vnd" %v_fileOpt%
COMM
IF (CHK_Exp_AP016=T AND FILESIZE("%fld_Results%AP016_Mis_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP016)) OPEN AP016_Mis_ABN
%v_cmt% IF (CHK_Exp_AP016=T AND FILESIZE("%fld_Results%AP016_Mis_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP016)) COUNT
IF (CHK_Exp_AP016=T AND FILESIZE("%fld_Results%AP016_Mis_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP016)) %v_EXPORT% FIELDS %v_Exp_Fields_AP016%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP016_Mis_ABN" %v_fileOpt%
COMM
IF (CHK_Exp_AP016=T AND FILESIZE("%fld_Results%AP016D_Mis_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP016D)) OPEN AP016D_Mis_ABN
%v_cmt% IF (CHK_Exp_AP016=T AND FILESIZE("%fld_Results%AP016D_Mis_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP016D)) COUNT
IF (CHK_Exp_AP016=T AND FILESIZE("%fld_Results%AP016D_Mis_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP016D)) %v_EXPORT% FIELDS %v_Exp_Fields_AP016D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP016D_Mis_ABN" %v_fileOpt%

COMM *** AP016 -> AP016, VM007, VM008, VM009 ***
COMM
IF (CHK_Exp_AP017=T AND FILESIZE("%fld_Results%AP017_Top_xx_Vnd_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP017)) OPEN AP017_Top_xx_Vnd_xx_Mon
%v_cmt% IF (CHK_Exp_AP017=T AND FILESIZE("%fld_Results%AP017_Top_xx_Vnd_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP017)) COUNT
IF (CHK_Exp_AP017=T AND FILESIZE("%fld_Results%AP017_Top_xx_Vnd_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP017)) %v_EXPORT% FIELDS %v_Exp_Fields_AP017%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP017_Top_xx_Vnd_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_AP017=T AND FILESIZE("%fld_Results%AP017D_Top_xx_Vnd_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP017D)) OPEN AP017D_Top_xx_Vnd_xx_Mon
%v_cmt% IF (CHK_Exp_AP017=T AND FILESIZE("%fld_Results%AP017D_Top_xx_Vnd_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP017D)) COUNT
IF (CHK_Exp_AP017=T AND FILESIZE("%fld_Results%AP017D_Top_xx_Vnd_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP017D)) %v_EXPORT% FIELDS %v_Exp_Fields_AP017D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP017D_Top_xx_Vnd_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_AP018=T AND FILESIZE("%fld_Results%AP018_Near_Alw_Limit.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP018)) OPEN AP018_Near_Alw_Limit
%v_cmt% IF (CHK_Exp_AP018=T AND FILESIZE("%fld_Results%AP018_Near_Alw_Limit.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP018)) COUNT
IF (CHK_Exp_AP018=T AND FILESIZE("%fld_Results%AP018_Near_Alw_Limit.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP018)) %v_EXPORT% FIELDS %v_Exp_Fields_AP018%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP018_Near_Alw_Limit" %v_fileOpt%
COMM
IF (CHK_Exp_AP019=T AND FILESIZE("%fld_Results%AP019_CreditNt_Paid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP019)) OPEN AP019_CreditNt_Paid
%v_cmt% IF (CHK_Exp_AP019=T AND FILESIZE("%fld_Results%AP019_CreditNt_Paid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP019)) COUNT
IF (CHK_Exp_AP019=T AND FILESIZE("%fld_Results%AP019_CreditNt_Paid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP019)) %v_EXPORT% FIELDS %v_Exp_Fields_AP019%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP019_CreditNt_Paid" %v_fileOpt%
COMM
IF (CHK_Exp_AP020=T AND FILESIZE("%fld_Results%AP020_Mul_Paid_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP020)) OPEN AP020_Mul_Paid_Mon
%v_cmt% IF (CHK_Exp_AP020=T AND FILESIZE("%fld_Results%AP020_Mul_Paid_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP020)) COUNT
IF (CHK_Exp_AP020=T AND FILESIZE("%fld_Results%AP020_Mul_Paid_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP020)) %v_EXPORT% FIELDS %v_Exp_Fields_AP020%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP020_Mul_Paid_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_AP020=T AND FILESIZE("%fld_Results%AP020D_Mul_Paid_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP020D)) OPEN AP020D_Mul_Paid_Mon
%v_cmt% IF (CHK_Exp_AP020=T AND FILESIZE("%fld_Results%AP020D_Mul_Paid_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP020D)) COUNT
IF (CHK_Exp_AP020=T AND FILESIZE("%fld_Results%AP020D_Mul_Paid_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP020D)) %v_EXPORT% FIELDS %v_Exp_Fields_AP020D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP020D_Mul_Paid_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_AP021=T AND FILESIZE("%fld_Results%AP021_Chq_Out_Seq.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP021)) OPEN AP021_Chq_Out_Seq
%v_cmt% IF (CHK_Exp_AP021=T AND FILESIZE("%fld_Results%AP021_Chq_Out_Seq.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP021)) COUNT
IF (CHK_Exp_AP021=T AND FILESIZE("%fld_Results%AP021_Chq_Out_Seq.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP021)) %v_EXPORT% FIELDS %v_Exp_Fields_AP021%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP021_Chq_Out_Seq" %v_fileOpt%
COMM
IF (CHK_Exp_AP022=T AND FILESIZE("%fld_Results%AP022_Disc_Mis.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP022)) OPEN AP022_Disc_Mis
%v_cmt% IF (CHK_Exp_AP022=T AND FILESIZE("%fld_Results%AP022_Disc_Mis.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP022)) COUNT
IF (CHK_Exp_AP022=T AND FILESIZE("%fld_Results%AP022_Disc_Mis.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP022)) %v_EXPORT% FIELDS %v_Exp_Fields_AP022%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP022_Disc_Mis" %v_fileOpt%
COMM
IF (CHK_Exp_AP023=T AND FILESIZE("%fld_Results%AP023_Disc_Not_Awd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP023)) OPEN AP023_Disc_Not_Awd
%v_cmt% IF (CHK_Exp_AP023=T AND FILESIZE("%fld_Results%AP023_Disc_Not_Awd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP023)) COUNT
IF (CHK_Exp_AP023=T AND FILESIZE("%fld_Results%AP023_Disc_Not_Awd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP023)) %v_EXPORT% FIELDS %v_Exp_Fields_AP023%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP023_Disc_Not_Awd" %v_fileOpt%
COMM
IF (CHK_Exp_AP024=T AND FILESIZE("%fld_Results%AP024_Low_Act_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP024)) OPEN AP024_Low_Act_Vnd
%v_cmt% IF (CHK_Exp_AP024=T AND FILESIZE("%fld_Results%AP024_Low_Act_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP024)) COUNT
IF (CHK_Exp_AP024=T AND FILESIZE("%fld_Results%AP024_Low_Act_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP024)) %v_EXPORT% FIELDS %v_Exp_Fields_AP024%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP024_Low_Act_Vnd" %v_fileOpt%

COMM *** %v_EXPORT% Employee Master File Tests***
COMM
IF (CHK_Exp_EM001=T AND FILESIZE("%fld_Results%EM001_Dup_TFN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM001)) OPEN EM001_Dup_TFN
%v_cmt% IF (CHK_Exp_EM001=T AND FILESIZE("%fld_Results%EM001_Dup_TFN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM001)) COUNT
IF (CHK_Exp_EM001=T AND FILESIZE("%fld_Results%EM001_Dup_TFN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM001)) %v_EXPORT% FIELDS %v_Exp_Fields_EM001%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM001_Dup_TFN" %v_fileOpt%
COMM
IF (CHK_Exp_EM002=T AND FILESIZE("%fld_Results%EM002_Dup_BnkAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM002)) OPEN EM002_Dup_BnkAcc
%v_cmt% IF (CHK_Exp_EM002=T AND FILESIZE("%fld_Results%EM002_Dup_BnkAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM002)) COUNT
IF (CHK_Exp_EM002=T AND FILESIZE("%fld_Results%EM002_Dup_BnkAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM002)) %v_EXPORT% FIELDS %v_Exp_Fields_EM002%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM002_Dup_BnkAcc" %v_fileOpt%
COMM
IF (CHK_Exp_EM003=T AND FILESIZE("%fld_Results%EM003_Dup_Name.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM003)) OPEN EM003_Dup_Name
%v_cmt% IF (CHK_Exp_EM003=T AND FILESIZE("%fld_Results%EM003_Dup_Name.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM003)) COUNT
IF (CHK_Exp_EM003=T AND FILESIZE("%fld_Results%EM003_Dup_Name.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM003)) %v_EXPORT% FIELDS %v_Exp_Fields_EM003%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM003_Dup_Name" %v_fileOpt%
COMM
IF (CHK_Exp_EM004=T AND FILESIZE("%fld_Results%EM004_Dup_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM004)) OPEN EM004_Dup_Add
%v_cmt% IF (CHK_Exp_EM004=T AND FILESIZE("%fld_Results%EM004_Dup_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM004)) COUNT
IF (CHK_Exp_EM004=T AND FILESIZE("%fld_Results%EM004_Dup_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM004)) %v_EXPORT% FIELDS %v_Exp_Fields_EM004%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM004_Dup_Add" %v_fileOpt%
COMM
IF (CHK_Exp_EM005=T AND FILESIZE("%fld_Results%EM005_Dup_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM005)) OPEN EM005_Dup_Tel
%v_cmt% IF (CHK_Exp_EM005=T AND FILESIZE("%fld_Results%EM005_Dup_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM005)) COUNT
IF (CHK_Exp_EM005=T AND FILESIZE("%fld_Results%EM005_Dup_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM005)) %v_EXPORT% FIELDS %v_Exp_Fields_EM005%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM005_Dup_Tel" %v_fileOpt%
COMM
IF (CHK_Exp_EM006=T AND FILESIZE("%fld_Results%EM006_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM006)) OPEN EM006_Mis_Details
%v_cmt% IF (CHK_Exp_EM006=T AND FILESIZE("%fld_Results%EM006_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM006)) COUNT
IF (CHK_Exp_EM006=T AND FILESIZE("%fld_Results%EM006_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM006)) %v_EXPORT% FIELDS %v_Exp_Fields_EM006%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM006_Mis_Details" %v_fileOpt%
COMM
IF (CHK_Exp_EM007=T AND FILESIZE("%fld_Results%EM007_StartDt_Bf_DOB.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM007)) OPEN EM007_StartDt_Bf_DOB
%v_cmt% IF (CHK_Exp_EM007=T AND FILESIZE("%fld_Results%EM007_StartDt_Bf_DOB.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM007)) COUNT
IF (CHK_Exp_EM007=T AND FILESIZE("%fld_Results%EM007_StartDt_Bf_DOB.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM007)) %v_EXPORT% FIELDS %v_Exp_Fields_EM001%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM007_StartDt_Bf_DOB" %v_fileOpt%
COMM
IF (CHK_Exp_EM008=T AND FILESIZE("%fld_Results%EM008_unKnown_CstCtr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM008)) OPEN EM008_unKnown_CstCtr
%v_cmt% IF (CHK_Exp_EM008=T AND FILESIZE("%fld_Results%EM008_unKnown_CstCtr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM008)) COUNT
IF (CHK_Exp_EM008=T AND FILESIZE("%fld_Results%EM008_unKnown_CstCtr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM008)) %v_EXPORT% FIELDS %v_Exp_Fields_EM008%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM008_unKnown_CstCtr" %v_fileOpt%
COMM
IF (CHK_Exp_EM009=T AND FILESIZE("%fld_Results%EM009_TFN_Invld_Frmt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM009)) OPEN EM009_TFN_Invld_Frmt
%v_cmt% IF (CHK_Exp_EM009=T AND FILESIZE("%fld_Results%EM009_TFN_Invld_Frmt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM009)) COUNT
IF (CHK_Exp_EM009=T AND FILESIZE("%fld_Results%EM009_TFN_Invld_Frmt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM009)) %v_EXPORT% FIELDS %v_Exp_Fields_EM009%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM009_TFN_Invld_Frmt" %v_fileOpt%
COMM
IF (CHK_Exp_EM010=T AND FILESIZE("%fld_Results%EM010_TFN_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM010)) OPEN EM010_TFN_Valid
%v_cmt% IF (CHK_Exp_EM010=T AND FILESIZE("%fld_Results%EM010_TFN_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM010)) COUNT
IF (CHK_Exp_EM010=T AND FILESIZE("%fld_Results%EM010_TFN_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM010)) %v_EXPORT% FIELDS %v_Exp_Fields_EM010%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM010_TFN_Valid" %v_fileOpt%
COMM
IF (CHK_Exp_EM011=T AND FILESIZE("%fld_Results%EM011_BnkAcc_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM011)) OPEN EM011_BnkAcc_Valid
%v_cmt% IF (CHK_Exp_EM011=T AND FILESIZE("%fld_Results%EM011_BnkAcc_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM011)) COUNT
IF (CHK_Exp_EM011=T AND FILESIZE("%fld_Results%EM011_BnkAcc_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM011)) %v_EXPORT% FIELDS %v_Exp_Fields_EM011%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM011_BnkAcc_Valid" %v_fileOpt%
COMM
IF (CHK_Exp_EM012=T AND FILESIZE("%fld_Results%EM012_DOB_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM012)) OPEN EM012_DOB_Valid
%v_cmt% IF (CHK_Exp_EM012=T AND FILESIZE("%fld_Results%EM012_DOB_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM012)) COUNT
IF (CHK_Exp_EM012=T AND FILESIZE("%fld_Results%EM012_DOB_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM012)) %v_EXPORT% FIELDS %v_Exp_Fields_EM012%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM012_DOB_Valid" %v_fileOpt%
COMM
IF (CHK_Exp_EM013=T AND FILESIZE("%fld_Results%EM013_StartDt_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM013)) OPEN EM013_StartDt_Valid
%v_cmt% IF (CHK_Exp_EM013=T AND FILESIZE("%fld_Results%EM013_StartDt_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM013)) COUNT
IF (CHK_Exp_EM013=T AND FILESIZE("%fld_Results%EM013_StartDt_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM013)) %v_EXPORT% FIELDS %v_Exp_Fields_EM013%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM013_StartDt_Valid" %v_fileOpt%
COMM
IF (CHK_Exp_EM014=T AND FILESIZE("%fld_Results%EM014_Tmp_No_EndDt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM014)) OPEN EM014_Tmp_No_EndDt
%v_cmt% IF (CHK_Exp_EM014=T AND FILESIZE("%fld_Results%EM014_Tmp_No_EndDt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM014)) COUNT
IF (CHK_Exp_EM014=T AND FILESIZE("%fld_Results%EM014_Tmp_No_EndDt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM014)) %v_EXPORT% FIELDS %v_Exp_Fields_EM014%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM014_Tmp_No_EndDt" %v_fileOpt%
COMM
IF (CHK_Exp_EM014=T AND FILESIZE("%fld_Results%EM015_Not_Taken_Leave.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM014)) OPEN EM015_Not_Taken_Leave
%v_cmt% IF (CHK_Exp_EM014=T AND FILESIZE("%fld_Results%EM015_Not_Taken_Leave.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM014)) COUNT
IF (CHK_Exp_EM014=T AND FILESIZE("%fld_Results%EM015_Not_Taken_Leave.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM014)) %v_EXPORT% FIELDS %v_Exp_Fields_EM014%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM015_Not_Taken_Leave" %v_fileOpt%
COMM
IF (CHK_Exp_EM015=T AND FILESIZE("%fld_Results%EM015_Not_Taken_AL.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM015)) OPEN EM015_Not_Taken_AL
IF (CHK_Exp_EM015=T AND FILESIZE("%fld_Results%EM015_Not_Taken_AL.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM015)) %v_EXPORT% FIELDS %v_Exp_Fields_EM015%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM015_Not_Taken_AL%suffix%" %v_fileOpt%
COMM
IF (CHK_Exp_EM016=T AND FILESIZE("%fld_Results%EM016_TooMuch_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM016)) OPEN EM016_TooMuch_SickLv
IF (CHK_Exp_EM016=T AND FILESIZE("%fld_Results%EM016_TooMuch_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM016)) %v_EXPORT% FIELDS %v_Exp_Fields_EM016%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM016_TooMuch_SickLv%suffix%" %v_fileOpt%
COMM
IF (CHK_Exp_EM016=T AND FILESIZE("%fld_Results%EM016D_TooMuch_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM016D)) OPEN EM016D_TooMuch_SickLv
IF (CHK_Exp_EM016=T AND FILESIZE("%fld_Results%EM016D_TooMuch_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM016D)) %v_EXPORT% FIELDS %v_Exp_Fields_EM016D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM016D_TooMuch_SickLv%suffix%" %v_fileOpt%
COMM
IF (CHK_Exp_EM017=T AND FILESIZE("%fld_Results%EM017_Neg_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM017)) OPEN EM017_Neg_SickLv
IF (CHK_Exp_EM017=T AND FILESIZE("%fld_Results%EM017_Neg_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM017)) %v_EXPORT% FIELDS %v_Exp_Fields_EM016%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM016_Neg_SickLv%suffix%" %v_fileOpt%
COMM
IF (CHK_Exp_EM017=T AND FILESIZE("%fld_Results%EM017D_Neg_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM017D)) OPEN EM017D_Neg_SickLv
IF (CHK_Exp_EM017=T AND FILESIZE("%fld_Results%EM017D_Neg_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM017D)) %v_EXPORT% FIELDS %v_Exp_Fields_EM016D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM016D_Neg_SickLv%suffix%" %v_fileOpt%



COMM *** %v_EXPORT% Payroll Tests ***
COMM
IF (CHK_Exp_PR001=T AND FILESIZE("%fld_Results%PR001_Mul_Paid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR001)) OPEN PR001_Mul_Paid
%v_cmt% IF (CHK_Exp_PR001=T AND FILESIZE("%fld_Results%PR001_Mul_Paid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR001)) COUNT
IF (CHK_Exp_PR001=T AND FILESIZE("%fld_Results%PR001_Mul_Paid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR001)) %v_EXPORT% FIELDS %v_Exp_Fields_PR001%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR001_Mul_Paid" %v_fileOpt%
COMM
IF (CHK_Exp_PR002=T AND FILESIZE("%fld_Results%PR002_Not_in_Emf.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR002)) OPEN PR002_Not_in_Emf
%v_cmt% IF (CHK_Exp_PR002=T AND FILESIZE("%fld_Results%PR002_Not_in_Emf.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR002)) COUNT
IF (CHK_Exp_PR002=T AND FILESIZE("%fld_Results%PR002_Not_in_Emf.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR002)) %v_EXPORT% FIELDS %v_Exp_Fields_PR002%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR002_Not_in_Emf" %v_fileOpt%
COMM
IF (CHK_Exp_PR003=T AND FILESIZE("%fld_Results%PR003_Pay_30D_Af_Trm.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR003)) OPEN PR003_Pay_30D_Af_Trm
%v_cmt% IF (CHK_Exp_PR003=T AND FILESIZE("%fld_Results%PR003_Pay_30D_Af_Trm.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR003)) COUNT
IF (CHK_Exp_PR003=T AND FILESIZE("%fld_Results%PR003_Pay_30D_Af_Trm.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR003)) %v_EXPORT% FIELDS %v_Exp_Fields_PR003%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR003_Pay_30D_Af_Trm" %v_fileOpt%
COMM
IF (CHK_Exp_PR004=T AND FILESIZE("%fld_Results%PR004_Spec_Leave_3Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR004)) OPEN PR004_Spec_Leave_3Mon
%v_cmt% IF (CHK_Exp_PR004=T AND FILESIZE("%fld_Results%PR004_Spec_Leave_3Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR004)) COUNT
IF (CHK_Exp_PR004=T AND FILESIZE("%fld_Results%PR004_Spec_Leave_3Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR004)) %v_EXPORT% FIELDS %v_Exp_Fields_PR004%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR004_Spec_Leave_3Mon" %v_fileOpt%
COMM
IF (CHK_Exp_PR005=T AND FILESIZE("%fld_Results%PR005_Pay_TrmAmt_Sleeper.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR005)) OPEN PR005_Pay_TrmAmt_Sleeper
%v_cmt% IF (CHK_Exp_PR005=T AND FILESIZE("%fld_Results%PR005_Pay_TrmAmt_Sleeper.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR005)) COUNT
IF (CHK_Exp_PR005=T AND FILESIZE("%fld_Results%PR005_Pay_TrmAmt_Sleeper.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR005)) %v_EXPORT% FIELDS %v_Exp_Fields_PR005%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR005_Pay_TrmAmt_Sleeper" %v_fileOpt%
COMM
IF (CHK_Exp_PR006=T AND FILESIZE("%fld_Results%PR006_Unusual_Super.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR006)) OPEN PR006_Unusual_Super
%v_cmt% IF (CHK_Exp_PR006=T AND FILESIZE("%fld_Results%PR006_Unusual_Super.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR006)) COUNT
IF (CHK_Exp_PR006=T AND FILESIZE("%fld_Results%PR006_Unusual_Super.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR006)) %v_EXPORT% FIELDS %v_Exp_Fields_PR006%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR006_Unusual_Super" %v_fileOpt%
COMM
IF (CHK_Exp_PR007=T AND FILESIZE("%fld_Results%PR007_Hourly_Emp.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR007)) OPEN PR007_Hourly_Emp
%v_cmt% IF (CHK_Exp_PR007=T AND FILESIZE("%fld_Results%PR007_Hourly_Emp.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR007)) COUNT
IF (CHK_Exp_PR007=T AND FILESIZE("%fld_Results%PR007_Hourly_Emp.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR007)) %v_EXPORT% FIELDS %v_Exp_Fields_PR007%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR007_Hourly_Emp" %v_fileOpt%
COMM
IF (CHK_Exp_PR008=T AND FILESIZE("%fld_Results%PR008_Top_xx_Over_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR008)) OPEN PR008_Top_xx_Over_xx_Mon
%v_cmt% IF (CHK_Exp_PR008=T AND FILESIZE("%fld_Results%PR008_Top_xx_Over_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR008)) COUNT
IF (CHK_Exp_PR008=T AND FILESIZE("%fld_Results%PR008_Top_xx_Over_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR008)) %v_EXPORT% FIELDS %v_Exp_Fields_PR008%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR008_Top_xx_Over_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_PR008=T AND FILESIZE("%fld_Results%PR008D_Top_xx_Over_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR008D)) OPEN PR008D_Top_xx_Over_xx_Mon
%v_cmt% IF (CHK_Exp_PR008=T AND FILESIZE("%fld_Results%PR008D_Top_xx_Over_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR008D)) COUNT
IF (CHK_Exp_PR008=T AND FILESIZE("%fld_Results%PR008D_Top_xx_Over_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR008D)) %v_EXPORT% FIELDS %v_Exp_Fields_PR008D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR008D_Top_xx_Over_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_PR009=T AND FILESIZE("%fld_Results%PR009_Pay_x_Times_Avg.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR009)) OPEN PR009_Pay_x_Times_Avg
%v_cmt% IF (CHK_Exp_PR009=T AND FILESIZE("%fld_Results%PR009_Pay_x_Times_Avg.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR009)) COUNT
IF (CHK_Exp_PR009=T AND FILESIZE("%fld_Results%PR009_Pay_x_Times_Avg.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR009)) %v_EXPORT% FIELDS %v_Exp_Fields_PR009%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR009_Pay_x_Times_Avg" %v_fileOpt%
COMM
IF (CHK_Exp_PR009=T AND FILESIZE("%fld_Results%PR009D_Pay_x_Times_Avg.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR009D)) OPEN PR009D_Pay_x_Times_Avg
%v_cmt% IF (CHK_Exp_PR009=T AND FILESIZE("%fld_Results%PR009D_Pay_x_Times_Avg.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR009D)) COUNT
IF (CHK_Exp_PR009=T AND FILESIZE("%fld_Results%PR009D_Pay_x_Times_Avg.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR009D)) %v_EXPORT% FIELDS %v_Exp_Fields_PR009D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR009D_Pay_x_Times_Avg" %v_fileOpt%
COMM
COMM *** %v_EXPORT% Statistics Summary Reports ***
IF (CHK_Exp_ST001=T AND FILESIZE("%fld_Results%ST001_Vnd_Tst_Sum.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST001)) OPEN ST001_Vnd_Tst_Sum
%v_cmt% IF (CHK_Exp_ST001=T AND FILESIZE("%fld_Results%ST001_Vnd_Tst_Sum.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST001)) COUNT
IF (CHK_Exp_ST001=T AND FILESIZE("%fld_Results%ST001_Vnd_Tst_Sum.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST001)) %v_EXPORT% FIELDS %v_Exp_Fields_ST001%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%ST001_Vnd_Tst_Sum" %v_fileOpt%
COMM
IF (CHK_Exp_ST001=T AND FILESIZE("%fld_Results%ST001D_Vnd_Tst_Sum.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST001D)) OPEN ST001D_Vnd_Tst_Sum
%v_cmt% IF (CHK_Exp_ST001=T AND FILESIZE("%fld_Results%ST001D_Vnd_Tst_Sum.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST001D)) COUNT
IF (CHK_Exp_ST001=T AND FILESIZE("%fld_Results%ST001D_Vnd_Tst_Sum.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST001D)) %v_EXPORT% FIELDS %v_Exp_Fields_ST001D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%ST001D_Vnd_Tst_Sum" %v_fileOpt%
COMM
IF (CHK_Exp_ST002=T AND FILESIZE("%fld_Results%ST002_Rev_Sum_RevDays.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST002)) OPEN ST002_Rev_Sum_RevDays
%v_cmt% IF (CHK_Exp_ST002=T AND FILESIZE("%fld_Results%ST002_Rev_Sum_RevDays.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST002)) COUNT
IF (CHK_Exp_ST002=T AND FILESIZE("%fld_Results%ST002_Rev_Sum_RevDays.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST002)) %v_EXPORT% FIELDS %v_Exp_Fields_ST002%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%ST002_Rev_Sum_RevDays" %v_fileOpt%
COMM
IF (CHK_Exp_ST003=T AND FILESIZE("%fld_Results%ST003_Rev_Vnd_Dup.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST003)) OPEN ST003_Rev_Vnd_Dup
%v_cmt% IF (CHK_Exp_ST003=T AND FILESIZE("%fld_Results%ST003_Rev_Vnd_Dup.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST003)) COUNT
IF (CHK_Exp_ST003=T AND FILESIZE("%fld_Results%ST003_Rev_Vnd_Dup.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST003)) %v_EXPORT% FIELDS %v_Exp_Fields_ST003%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%ST003_Rev_Vnd_Dup" %v_fileOpt%
COMM
IF (CHK_Exp_ST004=T AND FILESIZE("%fld_Results%ST004_Vnd_Ranking.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST004)) OPEN ST004_Vnd_Ranking
%v_cmt% IF (CHK_Exp_ST004=T AND FILESIZE("%fld_Results%ST004_Vnd_Ranking.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST004)) COUNT
IF (CHK_Exp_ST004=T AND FILESIZE("%fld_Results%ST004_Vnd_Ranking.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST004)) %v_EXPORT% FIELDS %v_Exp_Fields_ST004%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%ST004_Vnd_Ranking" %v_fileOpt%
COMM
IF (CHK_Exp_ST005=T AND FILESIZE("%fld_Results%ST005_Distr_Inv_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST005)) OPEN ST005_Distr_Inv_Mon
%v_cmt% IF (CHK_Exp_ST005=T AND FILESIZE("%fld_Results%ST005_Distr_Inv_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST005)) COUNT
IF (CHK_Exp_ST005=T AND FILESIZE("%fld_Results%ST005_Distr_Inv_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST005)) %v_EXPORT% FIELDS %v_Exp_Fields_ST005%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%ST005_Distr_Inv_Mon" %v_fileOpt%


SET SAFETY ON

^INDEX    IDX_HVM006_VndrSiteID              HIST1_VM006_Mis_Details          "" "IDX_HVM006_VndrSiteID.INX" 
*INDEX ON VNDR_SITE_ID TO IDX_HVM006_VNDRSITEID
^INDEX    IDX_HVM008Z_VndrSiteID             HIST1_VM008Z_Can_ABN_Sum         "" "IDX_HVM008Z_VndrSiteID.INX" 
*INDEX ON VNDR_SITE_ID TO IDX_HVM008Z_VNDRSITEID
^INDEX    IDX_HVM008_VndrSiteID              HIST1_VM008_Can_ABN              "" "IDX_HVM008_VndrSiteID.INX" 
*INDEX ON VNDR_SITE_ID TO IDX_HVM008_VNDRSITEID
^INDEX    IDX_HVM010D_Sum_VndrSiteID         HIST1_VM010D_DeReg_GST_Sum       "" "IDX_HVM010D_Sum_VndrSiteID.INX" 
*INDEX ON VNDR_SITE_ID TO IDX_HVM010D_SUM_VNDRSITEID
^INDEX    IDX_HVM010_VndrSiteID              HIST1_VM010_DeReg_GST            "" "IDX_HVM010_VndrSiteID.INX" 
*INDEX ON VNDR_SITE_ID TO IDX_HVM010_VNDRSITEID
^REPORT   Default_View                       HIST1_VM001_Dup_Vnd_BankAcc      D.T,
[SKIP] 0
[TLINES] 0
[RLINES] 1
[LINE] 1
Vndr_Site_ID         PICTURE ""
[LINE] 1
Co                   PICTURE ""
[LINE] 1
Vndr_ID              PICTURE ""
[LINE] 1
Vndr_Nme             PICTURE ""
[LINE] 1
ABN                  PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 8 PICTURE ""
[LINE] 1
Vndr_Typ             PICTURE ""
[LINE] 1
Vndr_Add_Typ         PICTURE ""
[LINE] 1
ADD1                 PICTURE ""
[LINE] 1
ADD2                 PICTURE ""
[LINE] 1
ADD3                 PICTURE ""
[LINE] 1
City                 PICTURE ""
[LINE] 1
State                PICTURE ""
[LINE] 1
Pcode                PICTURE ""
[LINE] 1
Cntry                PICTURE ""
[LINE] 1
TEL1                 PICTURE ""
[LINE] 1
TEL2                 PICTURE ""
[LINE] 1
TEL3                 PICTURE ""
[LINE] 1
FAX                  PICTURE ""
[LINE] 1
Email1               PICTURE ""
[LINE] 1
Email2               PICTURE ""
[LINE] 1
Pymnt_Trm            PICTURE ""
[LINE] 1
Created_Dt           PICTURE ""
[LINE] 1
Modf_Dt              PICTURE ""
[LINE] 1
Vndr_InvlDt          PICTURE ""
[LINE] 1
Cha_Field1           PICTURE ""
[LINE] 1
Cha_Field2           PICTURE ""
[LINE] 1
Cha_Field3           WIDTH 10 PICTURE ""
[LINE] 1
Cha_Field4           PICTURE ""
[LINE] 1
Cha_Field5           PICTURE ""
[LINE] 1
Num_Field1           PICTURE ""
[LINE] 1
Num_Field2           PICTURE ""
[LINE] 1
Num_Field3           PICTURE ""
[LINE] 1
Num_Field4           PICTURE ""
[LINE] 1
Num_Field5           PICTURE ""
[LINE] 1
Dt_Field1            PICTURE ""
[LINE] 1
Dt_Field2            PICTURE ""
[LINE] 1
Dt_Field3            PICTURE ""
[LINE] 1
ABN_CLN              PICTURE ""
[LINE] 1
Max_Inv_Dt           PICTURE ""
[LINE] 1
c_Vndr_ID            PICTURE ""
[LINE] 1
DUP_KEY              PICTURE ""
[LINE] 1
DUP_KEY2             PICTURE ""
[LINE] 1
Bnk_KEY              PICTURE ""
[LINE] 1
Vndr_Site_ID2        PICTURE ""
[LINE] 1
Vndr_ID2             PICTURE ""
[LINE] 1
BSB                  PICTURE ""
[LINE] 1
Bnk_Acc_Num          PICTURE ""
[LINE] 1
BSB_NAME             PICTURE ""
[LINE] 1
Bnk_Acc_Name         PICTURE ""
[LINE] 1
ID_KEY               PICTURE ""
[LINE] 1
Vndr_Same_Diff       WIDTH 14 PICTURE ""
[LINE] 1
SORT_KEY             PICTURE ""
[LINE] 1
SORT_KEY_Desc        PICTURE ""
[LINE] 1
RptRunDate           PICTURE ""
[LINE] 1
TEST_NAME            PICTURE ""
[LINE] 1
Priority             WIDTH 8 PICTURE ""
[LINE] 1
c_VALID              PICTURE ""
[LINE] 1
cVndrSiteVndrID      PICTURE ""
^FORMAT   HIST1_VM001_Dup_Vnd_BankAcc        HIST1_VM001_Dup_Vnd_BankAcc      "" "HIST1_VM001_Dup_Vnd_BankAcc.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.12/08/2015   11:43:48 TMP1 SORT ON _VENDOR_SITE_ID_ VENDOR_ID__ _VENDOR_BSB_ _VENDOR_BANK_ACCOUNT_NUMBER_ _ACCT_START_DATE_  D  TO "TMP_2" OPEN
~Input : Records:32259       Control Total:0                    
~Output: Records:32259       Control Total:0                    
~.12/08/2015   11:43:48 TMP_2 SUMMARIZE ON _VENDOR_SITE_ID_ VENDOR_ID__ _VENDOR_BSB_ _VENDOR_BANK_ACCOUNT_NUMBER_ OTHER _VENDOR_SITE_ID_ VENDOR_ID__ _VENDOR_BSB_ _VENDOR_BANK_ACCOUNT_NUMBER_ _VENDOR_BANK_ACCT_NAME_ _ACCT_START_DATE_ _ACCT_END_DATE LAST_UPDATE_DATE TO "TMP_3.FIL" OPEN PRESORT
~Input : Records:32259       Control Total:0                    
~Output: Records:32125       Control Total:0                    
~.12/08/2015   11:43:48 TMP_3 IF v_NewFlag = 1 EXTRACT FIELDS ALL SUBSTR("E:\Data\VendorBankAccount_20150723.txt",1,50) AS 'File_Name' TO  AP_VendorMasterBnkAcc_ALL
~Input : Records:32125       Control Total:0                    
~Output: Records:32125       Control Total:0                    
~.12/08/2015   17:56:33 AP_VendorMasterBnkAcc_ALL EXTRACT FIELDS SUBSTR(c_VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTR(_VENDOR_SITE_ID_,1,20) AS 'VENDOR_SITE_ID' SUBSTR(_VENDOR_BANK_ACCT_NAME_,1,60) AS 'VENDOR_BANK_ACCT_NAME' SUBSTR(_VENDOR_BSB_,1,20) AS 'VENDOR_BSB'   SUBSTR(_VENDOR_BANK_ACCOUNT_NUMBER_,1,30) AS 'VENDOR_BANK_ACCOUNT_NUMBER' c_ACCT_START_DATE AS 'ACCT_START_DATE'  c_ACCT_END_DATE AS 'ACCT_END_DATE' c_LAST_UPDATE_DATE AS 'LAST_UPDATE_DATE'  'R11' AS 'SourceFlag' File_Name TO "AP_VendorMasterBnkAcc_ALL_FMT.FIL" IF BETWEEN(c_LAST_UPDATE_DATE,CTOD(_Data_Range_From_VM,"DD/MM/YYYY"),CTOD(_Data_Range_To_VM,"DD/MM/YYYY"))
~Input : Records:32125       Control Total:0                    
~Output: Records:31076       Control Total:0                    
~.12/08/2015   17:56:47 AP_VendorMasterBnkAcc_ALL_FMT IF v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,16))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,11))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_BSB),1,12))) AS 'BSB' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_BANK_ACCOUNT_NUMBER),1,28))) AS 'Bnk_Acc_Num' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_BSB),1,12))) AS 'BSB_NAME' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_BANK_ACCT_NAME),1,48))) AS 'Bnk_Acc_Name' BLANKS(20) AS 'Bnk_Acc_Type' CTOD('', 'DD/MM/YYYY') AS 'Chg_Dt' ACCT_START_DATE AS 'Dt_Field1' ACCT_END_DATE AS 'Dt_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(SourceFlag),1,3))) AS 'Cha_Field1'  FIRST 0 TO "Working_Files\VMF_BnkAcc_Tmp.FIL"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:56:47 AP_VendorMasterBnkAcc_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,16))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,11))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_BSB),1,12))) AS 'BSB' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_BANK_ACCOUNT_NUMBER),1,28))) AS 'Bnk_Acc_Num' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_BSB),1,12))) AS 'BSB_NAME' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_BANK_ACCT_NAME),1,48))) AS 'Bnk_Acc_Name' BLANKS(20) AS 'Bnk_Acc_Type' CTOD('', 'DD/MM/YYYY') AS 'Chg_Dt' ACCT_START_DATE AS 'Dt_Field1' ACCT_END_DATE AS 'Dt_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(SourceFlag),1,3))) AS 'Cha_Field1'   TO "Working_Files\VMF_BnkAcc_Tmp.FIL" OPEN APPEND
~Input : Records:31076       Control Total:0                    
~Output: Records:31076       Control Total:0                    
~.12/08/2015   17:56:47 VMF_BnkAcc_Tmp SUMMARIZE ON Vndr_Site_ID Vndr_ID BSB  Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Bnk_Acc_Type Chg_Dt CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' Cha_Field1  IF NOT ISBLANK(INCLUDE(ALLTRIM(BSB)+ALLTRIM(Bnk_Acc_Num),"0123456789")) TO "Working_Files\VMF_BnkAcc.FIL"
~Input : Records:31076       Control Total:0                    
~Output: Records:31076       Control Total:0                    
~.12/08/2015   17:57:05 VMF_BnkAcc EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:31076       Control Total:0                    
~Output: Records:31076       Control Total:0                    
~.12/08/2015   17:57:05 TMP_GL EXTRACT FIELDS ALL IF Vndr_ID<> GreyList_VM001.Vndr_ID TO TMP_GL1 OPEN
~Input : Records:31076       Control Total:0                    
~Output: Records:31076       Control Total:0                    
~.12/08/2015   17:57:06 TMP_GL1 EXTRACT RECORD IF VMF_Vnd_Master_File.Vndr_Sts="A" TO "Tmp_Files\TMP_BnkAcc" OPEN
~Input : Records:31076       Control Total:0                    
~Output: Records:15313       Control Total:0                    
~.12/08/2015   17:57:06 TMP_BnkAcc SUMMARIZE ON Vndr_ID c_Bank OTHER Vndr_Site_ID Bnk_KEY IF LENGTH(ALLTRIM(c_Bank))>3 AND VALUE(c_Bank,0)<>0 TO "Tmp_Files\TMP1.FIL" OPEN PRESORT
~Input : Records:15313       Control Total:0                    
~Output: Records:14894       Control Total:0                    
~.12/08/2015   17:57:06 TMP1 DUPLICATES ON c_Bank OTHER Vndr_Site_ID c_Bank Bnk_KEY PRESORT OPEN TO "Tmp_Files\TMP2.FIL"
~Input : Records:14894       Control Total:0                    
~Output: Records:14894       Control Total:0                    
~.12/08/2015   17:57:06 TMP2 EXTRACT FIELDS DUP_KEY Bnk_KEY Vndr_Site_ID TMP_BnkAcc.Vndr_ID TMP_BnkAcc.BSB TMP_BnkAcc.Bnk_Acc_Num TMP_BnkAcc.BSB_NAME TMP_BnkAcc.Bnk_Acc_Name IF NOT ISBLANK(TMP_BnkAcc.Bnk_KEY) TO "Tmp_Files\TMP3" OPEN
~Input : Records:352         Control Total:0                    
~Output: Records:352         Control Total:0                    
~.12/08/2015   17:57:06 TMP3 EXTRACT FIELDS VMF_Vnd_Master_File.Vndr_Site_ID VMF_Vnd_Master_File.Co VMF_Vnd_Master_File.Vndr_ID VMF_Vnd_Master_File.Vndr_Nme VMF_Vnd_Master_File.ABN VMF_Vnd_Master_File.Vndr_Sts VMF_Vnd_Master_File.Vndr_Typ VMF_Vnd_Master_File.Vndr_Add_Typ VMF_Vnd_Master_File.ADD1 VMF_Vnd_Master_File.ADD2 VMF_Vnd_Master_File.ADD3 VMF_Vnd_Master_File.City VMF_Vnd_Master_File.State VMF_Vnd_Master_File.Pcode VMF_Vnd_Master_File.Cntry VMF_Vnd_Master_File.TEL1 VMF_Vnd_Master_File.TEL2 VMF_Vnd_Master_File.TEL3 VMF_Vnd_Master_File.FAX VMF_Vnd_Master_File.Email1 VMF_Vnd_Master_File.Email2 VMF_Vnd_Master_File.Pymnt_Trm CTOD(DATE(VMF_Vnd_Master_File.Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(VMF_Vnd_Master_File.Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(VMF_Vnd_Master_File.Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' VMF_Vnd_Master_File.Cha_Field1 VMF_Vnd_Master_File.Cha_Field2 VMF_Vnd_Master_File.Cha_Field3 VMF_Vnd_Master_File.Cha_Field4 VMF_Vnd_Master_File.Cha_Field5 VMF_Vnd_Master_File.Num_Field1 VMF_Vnd_Master_File.Num_Field2 VMF_Vnd_Master_File.Num_Field3 VMF_Vnd_Master_File.Num_Field4 VMF_Vnd_Master_File.Num_Field5 CTOD(DATE(VMF_Vnd_Master_File.Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' VMF_Vnd_Master_File.ABN_CLN VMF_Vnd_Master_File.Max_Inv_Dt VMF_Vnd_Master_File.c_Vndr_ID TMP3.DUP_KEY TMP3.DUP_KEY TMP3.Bnk_KEY Vndr_Site_ID TMP3.Vndr_ID TMP3.BSB TMP3.Bnk_Acc_Num  TMP3.BSB_NAME  TMP3.Bnk_Acc_Name IF NOT ISBLANK(TMP3.Vndr_Site_ID) AND NOT ISBLANK(VMF_Vnd_Master_File.Vndr_Site_ID) AND VMF_Vnd_Master_File.Vndr_Sts="A" TO "Tmp_Files\TMP4" OPEN
~Input : Records:352         Control Total:0                    
~Output: Records:352         Control Total:0                    
~.12/08/2015   17:57:06 TMP4 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:352         Control Total:0                    
~Output: Records:352         Control Total:0                    
~.12/08/2015   17:57:06 TMP_Cur EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY DUP_KEY2 Bnk_KEY Vndr_Site_ID2 Vndr_ID2 BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name ID_KEY IF DUP_KEY= TMP_His.DUP_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:352         Control Total:0                    
~Output: Records:352         Control Total:0                    
~.12/08/2015   17:57:06 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP1" OPEN
~Input : Records:352         Control Total:0                    
~Output: Records:352         Control Total:0                    
~.12/08/2015   17:57:06 TMP1 SORT ON SORT_KEY TO "Tmp_Files\TMP6" OPEN
~Input : Records:352         Control Total:0                    
~Output: Records:352         Control Total:0                    
~.12/08/2015   17:57:06 TMP6 EXTRACT FIELDS ALL TO "Results\VM001_Dup_Vnd_BankAcc" IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN
~Input : Records:352         Control Total:0                    
~Output: Records:329         Control Total:0                    
~.12/08/2015   17:57:52 VM001_Dup_Vnd_BankAcc IF FILESIZE("Results\VM001_Dup_Vnd_BankAcc.fil")>0 EXTRACT FIELDS ALL TO HIST1_VM001_Dup_Vnd_BankAcc
~Input : Records:329         Control Total:0                    
~Output: Records:329         Control Total:0                    
[LASTVIEW] "Default_View"
^REPORT   Default_View                       HIST1_VM002_Dup_Vnd_ABN          D.T,
[SKIP] 0
[TLINES] 0
[RLINES] 1
[LINE] 1
ABN_CLN              PICTURE ""
[LINE] 1
Vndr_Site_ID         PICTURE ""
[LINE] 1
Co                   PICTURE ""
[LINE] 1
Vndr_ID              PICTURE ""
[LINE] 1
Vndr_Nme             PICTURE ""
[LINE] 1
ABN                  PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 8 PICTURE ""
[LINE] 1
Vndr_Typ             PICTURE ""
[LINE] 1
Vndr_Add_Typ         PICTURE ""
[LINE] 1
ADD1                 PICTURE ""
[LINE] 1
ADD2                 PICTURE ""
[LINE] 1
ADD3                 PICTURE ""
[LINE] 1
City                 PICTURE ""
[LINE] 1
State                PICTURE ""
[LINE] 1
Pcode                PICTURE ""
[LINE] 1
Cntry                PICTURE ""
[LINE] 1
TEL1                 PICTURE ""
[LINE] 1
TEL2                 PICTURE ""
[LINE] 1
TEL3                 PICTURE ""
[LINE] 1
FAX                  PICTURE ""
[LINE] 1
Email1               PICTURE ""
[LINE] 1
Email2               PICTURE ""
[LINE] 1
Pymnt_Trm            PICTURE ""
[LINE] 1
Created_Dt           PICTURE ""
[LINE] 1
Modf_Dt              PICTURE ""
[LINE] 1
Vndr_InvlDt          PICTURE ""
[LINE] 1
Cha_Field1           PICTURE ""
[LINE] 1
Cha_Field2           PICTURE ""
[LINE] 1
Cha_Field3           WIDTH 10 PICTURE ""
[LINE] 1
Cha_Field4           PICTURE ""
[LINE] 1
Cha_Field5           PICTURE ""
[LINE] 1
Num_Field1           PICTURE ""
[LINE] 1
Num_Field2           PICTURE ""
[LINE] 1
Num_Field3           PICTURE ""
[LINE] 1
Num_Field4           PICTURE ""
[LINE] 1
Num_Field5           PICTURE ""
[LINE] 1
Dt_Field1            PICTURE ""
[LINE] 1
Dt_Field2            PICTURE ""
[LINE] 1
Dt_Field3            PICTURE ""
[LINE] 1
Max_Inv_Dt           PICTURE ""
[LINE] 1
c_Vndr_ID            PICTURE ""
[LINE] 1
DUP_KEY              PICTURE ""
[LINE] 1
ID_KEY               PICTURE ""
[LINE] 1
Vndr_Same_Diff       WIDTH 14 PICTURE ""
[LINE] 1
SORT_KEY             PICTURE ""
[LINE] 1
SORT_KEY_Desc        PICTURE ""
[LINE] 1
RptRunDate           PICTURE ""
[LINE] 1
Priority             WIDTH 8 PICTURE ""
[LINE] 1
TEST_NAME            PICTURE ""
^FORMAT   HIST1_VM002_Dup_Vnd_ABN            HIST1_VM002_Dup_Vnd_ABN          "" "HIST1_VM002_Dup_Vnd_ABN.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.12/08/2015   11:43:47 TMP1 IF v_NewFlag = 1 EXTRACT FIELDS ALL SUBSTR("E:\Data\VendorMasterfile_20150723.txt",1,50) AS 'File_Name' TO  AP_VendorMaster_ALL
~Input : Records:64304       Control Total:0                    
~Output: Records:64304       Control Total:0                    
~.12/08/2015   17:56:32 AP_VendorMaster_ALL EXTRACT FIELDS ALL 'R11' AS 'SourceFlag' TO "AP_VendorMaster_ALL_FMT.FIL" IF BETWEEN(c_SITE_LAST_UPDATE_DATE,CTOD(_Data_Range_From_VM,"DD/MM/YYYY"),CTOD(_Data_Range_To_VM,"DD/MM/YYYY")) AND BETWEEN(c_HEADER_LAST_UPDATE_DATE,CTOD(_Data_Range_From_VM,"DD/MM/YYYY"),CTOD(_Data_Range_To_VM,"DD/MM/YYYY"))
~Input : Records:64304       Control Total:0                    
~Output: Records:61585       Control Total:0                    
~.12/08/2015   17:56:46 AP_VendorMaster_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Co' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NAME),1,73))) AS 'Vndr_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ABN),1,20))) AS 'ABN' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_STATUS),1,1))) AS 'Vndr_Sts' CTOD('', 'DD/MM/YYYY') AS 'Vndr_InvlDt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_TYPE),1,11))) AS 'Vndr_Typ' BLANKS(15) AS 'Vndr_Add_Typ' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ADDRESS),1,125))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(CITY),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(STATE),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(POSTCODE),1,12))) AS 'Pcode' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(COUNTRY),1,61))) AS 'Cntry' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Tel),1,21))) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Fax),1,21))) AS 'FAX' BLANKS(60) AS 'Email1' BLANKS(60) AS 'Email2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_METHOD),1,21))) AS 'Pymnt_Trm' c_SITE_CREATION_DATE AS 'Created_Dt' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE),1,30))) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_REGISTRATION_STATUS),1,30))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(SourceFlag),1,3))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NUMBER),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' c_SITE_INACTIVE_DATE AS 'Dt_Field1' c_SITE_CREATION_DATE AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3'   TO "Working_Files\VMF_Vnd_Master_File.FIL"
~Input : Records:61585       Control Total:0                    
~Output: Records:61585       Control Total:0                    
~.12/08/2015   17:57:11 VMF_Vnd_Master_File EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:61585       Control Total:0                    
~Output: Records:61585       Control Total:0                    
~.12/08/2015   17:57:12 TMP_GL EXTRACT FIELDS ALL IF Vndr_ID<> GreyList_VM002.Vndr_ID TO TMP_GL1 OPEN
~Input : Records:61585       Control Total:0                    
~Output: Records:61585       Control Total:0                    
~.12/08/2015   17:57:12 TMP_GL1 SUMMARIZE ON ABN_CLN Vndr_ID OTHER Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm CTOD(DATE(Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' ABN_CLN Max_Inv_Dt c_Vndr_ID IF Vndr_Sts="A" AND LENGTH(ALLTRIM(ABN_CLN))>1 TO "Tmp_Files\TMP10.FIL" OPEN PRESORT
~Input : Records:61585       Control Total:0                    
~Output: Records:12279       Control Total:0                    
~.12/08/2015   17:57:13 TMP10 DUPLICATES ON ABN_CLN OTHER Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm CTOD(DATE(Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' ABN_CLN Max_Inv_Dt c_Vndr_ID PRESORT OPEN TO "Tmp_Files\TMP1.FIL"
~Input : Records:12279       Control Total:0                    
~Output: Records:12279       Control Total:0                    
~.12/08/2015   17:57:13 TMP1 EXTRACT FIELDS ALL IF NOT ISBLANK(TMP3.DUP_KEY) TO "Tmp_Files\TMP4" OPEN
~Input : Records:386         Control Total:0                    
~Output: Records:302         Control Total:0                    
~.12/08/2015   17:57:13 TMP4 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:302         Control Total:0                    
~Output: Records:302         Control Total:0                    
~.12/08/2015   17:57:13 TMP_Cur EXTRACT FIELDS ABN_CLN Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY IF DUP_KEY= TMP_His.DUP_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:302         Control Total:0                    
~Output: Records:302         Control Total:0                    
~.12/08/2015   17:57:13 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP1" IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN
~Input : Records:302         Control Total:0                    
~Output: Records:263         Control Total:0                    
~.12/08/2015   17:57:13 TMP1 SORT ON SORT_KEY TO "Tmp_Files\TMP6" OPEN
~Input : Records:263         Control Total:0                    
~Output: Records:263         Control Total:0                    
~.12/08/2015   17:57:13 TMP6 EXTRACT FIELDS ALL TO "Results\VM002_Dup_Vnd_ABN" OPEN
~Input : Records:263         Control Total:0                    
~Output: Records:263         Control Total:0                    
~.12/08/2015   17:57:52 VM002_Dup_Vnd_ABN IF FILESIZE("Results\VM002_Dup_Vnd_ABN.fil")>0 EXTRACT FIELDS ALL TO HIST1_VM002_Dup_Vnd_ABN
~Input : Records:263         Control Total:0                    
~Output: Records:263         Control Total:0                    
[LASTVIEW] "Default_View"
^REPORT   Default_View                       HIST1_VM003_Dup_Vnd_Add          D.T,
[SKIP] 0
[TLINES] 0
[RLINES] 1
[LINE] 1
Vndr_Site_ID         PICTURE ""
[LINE] 1
Co                   PICTURE ""
[LINE] 1
Vndr_ID              PICTURE ""
[LINE] 1
Vndr_Nme             PICTURE ""
[LINE] 1
ABN                  PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 8 PICTURE ""
[LINE] 1
Vndr_Typ             PICTURE ""
[LINE] 1
Vndr_Add_Typ         PICTURE ""
[LINE] 1
ADD1                 PICTURE ""
[LINE] 1
ADD2                 PICTURE ""
[LINE] 1
ADD3                 PICTURE ""
[LINE] 1
City                 PICTURE ""
[LINE] 1
State                PICTURE ""
[LINE] 1
Pcode                PICTURE ""
[LINE] 1
Cntry                PICTURE ""
[LINE] 1
TEL1                 PICTURE ""
[LINE] 1
TEL2                 PICTURE ""
[LINE] 1
TEL3                 PICTURE ""
[LINE] 1
FAX                  PICTURE ""
[LINE] 1
Email1               PICTURE ""
[LINE] 1
Email2               PICTURE ""
[LINE] 1
Pymnt_Trm            PICTURE ""
[LINE] 1
Created_Dt           PICTURE ""
[LINE] 1
Modf_Dt              PICTURE ""
[LINE] 1
Vndr_InvlDt          PICTURE ""
[LINE] 1
Cha_Field1           PICTURE ""
[LINE] 1
Cha_Field2           PICTURE ""
[LINE] 1
Cha_Field3           WIDTH 10 PICTURE ""
[LINE] 1
Cha_Field4           PICTURE ""
[LINE] 1
Cha_Field5           PICTURE ""
[LINE] 1
Num_Field1           PICTURE ""
[LINE] 1
Num_Field2           PICTURE ""
[LINE] 1
Num_Field3           PICTURE ""
[LINE] 1
Num_Field4           PICTURE ""
[LINE] 1
Num_Field5           PICTURE ""
[LINE] 1
Dt_Field1            PICTURE ""
[LINE] 1
Dt_Field2            PICTURE ""
[LINE] 1
Dt_Field3            PICTURE ""
[LINE] 1
ABN_CLN              PICTURE ""
[LINE] 1
Max_Inv_Dt           PICTURE ""
[LINE] 1
c_Vndr_ID            PICTURE ""
[LINE] 1
DUP_KEY              PICTURE ""
[LINE] 1
Add_KEY              PICTURE ""
[LINE] 1
Dup_Vndr_Add_Typ     WIDTH 16 PICTURE ""
[LINE] 1
Dup_ADD1             PICTURE ""
[LINE] 1
Dup_ADD2             PICTURE ""
[LINE] 1
Dup_ADD3             PICTURE ""
[LINE] 1
Dup_City             PICTURE ""
[LINE] 1
Dup_State            PICTURE ""
[LINE] 1
Dup_Pcode            PICTURE ""
[LINE] 1
Dup_Cntry            PICTURE ""
[LINE] 1
ID_KEY               PICTURE ""
[LINE] 1
Vndr_Same_Diff       WIDTH 14 PICTURE ""
[LINE] 1
SORT_KEY             PICTURE ""
[LINE] 1
SORT_KEY_Desc        PICTURE ""
[LINE] 1
RptRunDate           PICTURE ""
[LINE] 1
TEST_NAME            PICTURE ""
[LINE] 1
Priority             WIDTH 8 PICTURE ""
^FORMAT   HIST1_VM003_Dup_Vnd_Add            HIST1_VM003_Dup_Vnd_Add          "" "HIST1_VM003_Dup_Vnd_Add.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~**** SOME HISTORY DELETED ****
~.12/08/2015   17:57:13 VMF_Address EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:61585       Control Total:0                    
~Output: Records:61585       Control Total:0                    
~.12/08/2015   17:57:14 TMP_GL EXTRACT FIELDS ALL IF Vndr_ID<> GreyList_VM003.Vndr_ID TO TMP_GL1 OPEN
~Input : Records:61585       Control Total:0                    
~Output: Records:61585       Control Total:0                    
~.12/08/2015   17:57:15 TMP_GL1 EXTRACT FIELDS ALL IF VMF_Vnd_Master_File.Vndr_Sts="A" TO "Tmp_Files\TMP_Address" OPEN
~Input : Records:61585       Control Total:0                    
~Output: Records:20530       Control Total:0                    
~.12/08/2015   17:57:16 TMP_Address EXTRACT FIELDS Add_ID Vndr_Site_ID Vndr_ID c_Pcode SUBSTR(INCLUDE(c_Add1, "0123456789"),1,50) AS "Address" "PO" AS "Type" IF  c_Add1F="PO" TO "Tmp_Files\TMP1" OPEN
~Input : Records:20530       Control Total:0                    
~Output: Records:5534        Control Total:0                    
~.12/08/2015   17:57:17 TMP_Address EXTRACT FIELDS Add_ID Vndr_Site_ID Vndr_ID c_Pcode SUBSTR(INCLUDE(c_Add2, "0123456789"),1,50) AS "Address" "PO" AS "Type" IF c_Add2F="PO" TO "Tmp_Files\TMP1" OPEN APPEND
~Input : Records:20530       Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:57:18 TMP_Address EXTRACT FIELDS Add_ID Vndr_Site_ID Vndr_ID c_Pcode SUBSTR(INCLUDE(c_Add3, "0123456789"),1,50) AS "Address" "PO" AS "Type" IF c_Add3F="PO" TO "Tmp_Files\TMP1" OPEN APPEND
~Input : Records:20530       Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:57:21 TMP_Address EXTRACT FIELDS Add_ID Vndr_Site_ID Vndr_ID c_Pcode SUBSTR(INCLUDE(c_Add1 +c_Add2+c_Add3,"QWERTYUIOPASDFGHJKLZXCVBNM0123456789"),1,50) AS "Address" "ST" AS "Type" IF c_Add1F<>"PO" AND c_Add2F<>"PO" AND c_Add3F<>"PO" TO "Tmp_Files\TMP1" OPEN APPEND
~Input : Records:20530       Control Total:0                    
~Output: Records:14996       Control Total:0                    
~.12/08/2015   17:57:21 TMP1 SUMMARIZE ON Add_KEY Vndr_ID c_Pcode Address Type OTHER Vndr_Site_ID IF LENGTH(ALLTRIM(Address))>0 TO "Tmp_Files\SUM_Address.FIL" OPEN PRESORT
~Input : Records:20530       Control Total:0                    
~Output: Records:20518       Control Total:0                    
~.12/08/2015   17:57:21 SUM_Address DUPLICATES ON Address c_Pcode OTHER Type Vndr_Site_ID Vndr_ID Address c_Pcode PRESORT IF Type = "PO" AND ALLTRIM(Address)<>"" OPEN TO "Tmp_Files\TMP2.FIL"
~Input : Records:20518       Control Total:0                    
~Output: Records:5531        Control Total:0                    
~.12/08/2015   17:57:21 SUM_Address DUPLICATES ON Address c_Pcode OTHER Type Vndr_Site_ID Vndr_ID Address c_Pcode PRESORT IF Type <> "PO" AND ALLTRIM(Address)<>"" APPEND OPEN TO "Tmp_Files\TMP2.FIL"
~Input : Records:20518       Control Total:0                    
~Output: Records:14987       Control Total:0                    
~.12/08/2015   17:57:21 TMP2 EXTRACT FIELDS DUP_KEY Add_KEY Vndr_Site_ID Vndr_ID TMP1.Add_ID IF NOT ISBLANK(TMP1.Add_KEY) TO "Tmp_Files\TMP3" OPEN
~Input : Records:2345        Control Total:0                    
~Output: Records:2345        Control Total:0                    
~.12/08/2015   17:57:21 TMP3 EXTRACT FIELDS DUP_KEY Add_KEY Vndr_Site_ID Vndr_ID TMP_Address.Vndr_Add_Typ TMP_Address.ADD1 TMP_Address.ADD2 TMP_Address.ADD3 TMP_Address.City TMP_Address.State TMP_Address.Pcode TMP_Address.Cntry TO "Tmp_Files\TMP7" OPEN
~Input : Records:2345        Control Total:0                    
~Output: Records:2345        Control Total:0                    
~.12/08/2015   17:57:22 TMP7 EXTRACT FIELDS ALL IF NOT ISBLANK(TMP8.DUP_KEY) TO "Tmp_Files\TMP9" OPEN
~Input : Records:2345        Control Total:0                    
~Output: Records:2084        Control Total:0                    
~.12/08/2015   17:57:22 TMP9 EXTRACT FIELDS VMF_Vnd_Master_File.Vndr_Site_ID VMF_Vnd_Master_File.Co VMF_Vnd_Master_File.Vndr_ID VMF_Vnd_Master_File.Vndr_Nme VMF_Vnd_Master_File.ABN VMF_Vnd_Master_File.Vndr_Sts VMF_Vnd_Master_File.Vndr_Typ VMF_Vnd_Master_File.Vndr_Add_Typ VMF_Vnd_Master_File.ADD1 VMF_Vnd_Master_File.ADD2 VMF_Vnd_Master_File.ADD3 VMF_Vnd_Master_File.City VMF_Vnd_Master_File.State VMF_Vnd_Master_File.Pcode VMF_Vnd_Master_File.Cntry VMF_Vnd_Master_File.TEL1 VMF_Vnd_Master_File.TEL2 VMF_Vnd_Master_File.TEL3 VMF_Vnd_Master_File.FAX VMF_Vnd_Master_File.Email1 VMF_Vnd_Master_File.Email2 VMF_Vnd_Master_File.Pymnt_Trm CTOD(DATE(VMF_Vnd_Master_File.Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(VMF_Vnd_Master_File.Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(VMF_Vnd_Master_File.Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' VMF_Vnd_Master_File.Cha_Field1 VMF_Vnd_Master_File.Cha_Field2 VMF_Vnd_Master_File.Cha_Field3 VMF_Vnd_Master_File.Cha_Field4 VMF_Vnd_Master_File.Cha_Field5 VMF_Vnd_Master_File.Num_Field1 VMF_Vnd_Master_File.Num_Field2 VMF_Vnd_Master_File.Num_Field3 VMF_Vnd_Master_File.Num_Field4 VMF_Vnd_Master_File.Num_Field5 CTOD(DATE(VMF_Vnd_Master_File.Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' VMF_Vnd_Master_File.ABN_CLN VMF_Vnd_Master_File.Max_Inv_Dt VMF_Vnd_Master_File.c_Vndr_ID TMP9.DUP_KEY TMP9.Add_KEY TMP9.Vndr_Add_Typ AS 'Dup_Vndr_Add_Typ' TMP9.ADD1 AS 'Dup_ADD1' TMP9.ADD2 AS 'Dup_ADD2' TMP9.ADD3 AS 'Dup_ADD3' TMP9.City AS 'Dup_City' TMP9.State AS 'Dup_State' TMP9.Pcode AS 'Dup_Pcode' TMP9.Cntry AS 'Dup_Cntry' IF NOT ISBLANK(TMP9.Vndr_Site_ID) AND NOT ISBLANK(VMF_Vnd_Master_File.Vndr_Site_ID) TO "Tmp_Files\TMP4" OPEN
~Input : Records:2084        Control Total:0                    
~Output: Records:2084        Control Total:0                    
~.12/08/2015   17:57:22 TMP4 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:2084        Control Total:0                    
~Output: Records:2084        Control Total:0                    
~.12/08/2015   17:57:22 TMP_Cur EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY Add_KEY Dup_Vndr_Add_Typ Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry ID_KEY IF DUP_KEY= TMP_His.DUP_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:2084        Control Total:0                    
~Output: Records:2084        Control Total:0                    
~.12/08/2015   17:57:22 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP1" OPEN
~Input : Records:2084        Control Total:0                    
~Output: Records:2084        Control Total:0                    
~.12/08/2015   17:57:22 TMP1 SORT ON SORT_KEY TO "Tmp_Files\TMP6" OPEN
~Input : Records:2084        Control Total:0                    
~Output: Records:2084        Control Total:0                    
~.12/08/2015   17:57:22 TMP6 EXTRACT FIELDS ALL TO "Results\VM003_Dup_Vnd_Add"  IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN
~Input : Records:2084        Control Total:0                    
~Output: Records:1707        Control Total:0                    
~.12/08/2015   17:57:52 VM003_Dup_Vnd_Add IF FILESIZE("Results\VM003_Dup_Vnd_Add.fil")>0 EXTRACT FIELDS ALL TO HIST1_VM003_Dup_Vnd_Add
~Input : Records:1707        Control Total:0                    
~Output: Records:1707        Control Total:0                    
[LASTVIEW] "Default_View"
^REPORT   Default_View                       HIST1_VM005_Dup_Vnd_Name         D.T,
[SKIP] 0
[TLINES] 0
[RLINES] 1
[LINE] 1
c_Name               PICTURE ""
[LINE] 1
Vndr_Site_ID         PICTURE ""
[LINE] 1
Co                   PICTURE ""
[LINE] 1
Vndr_ID              PICTURE ""
[LINE] 1
Vndr_Nme             PICTURE ""
[LINE] 1
ABN                  PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 8 PICTURE ""
[LINE] 1
Vndr_Typ             PICTURE ""
[LINE] 1
Vndr_Add_Typ         PICTURE ""
[LINE] 1
ADD1                 PICTURE ""
[LINE] 1
ADD2                 PICTURE ""
[LINE] 1
ADD3                 PICTURE ""
[LINE] 1
City                 PICTURE ""
[LINE] 1
State                PICTURE ""
[LINE] 1
Pcode                PICTURE ""
[LINE] 1
Cntry                PICTURE ""
[LINE] 1
TEL1                 PICTURE ""
[LINE] 1
TEL2                 PICTURE ""
[LINE] 1
TEL3                 PICTURE ""
[LINE] 1
FAX                  PICTURE ""
[LINE] 1
Email1               PICTURE ""
[LINE] 1
Email2               PICTURE ""
[LINE] 1
Pymnt_Trm            PICTURE ""
[LINE] 1
Created_Dt           PICTURE ""
[LINE] 1
Modf_Dt              PICTURE ""
[LINE] 1
Vndr_InvlDt          PICTURE ""
[LINE] 1
Cha_Field1           PICTURE ""
[LINE] 1
Cha_Field2           PICTURE ""
[LINE] 1
Cha_Field3           WIDTH 10 PICTURE ""
[LINE] 1
Cha_Field4           PICTURE ""
[LINE] 1
Cha_Field5           PICTURE ""
[LINE] 1
Num_Field1           PICTURE ""
[LINE] 1
Num_Field2           PICTURE ""
[LINE] 1
Num_Field3           PICTURE ""
[LINE] 1
Num_Field4           PICTURE ""
[LINE] 1
Num_Field5           PICTURE ""
[LINE] 1
Dt_Field1            PICTURE ""
[LINE] 1
Dt_Field2            PICTURE ""
[LINE] 1
Dt_Field3            PICTURE ""
[LINE] 1
ABN_CLN              PICTURE ""
[LINE] 1
Max_Inv_Dt           PICTURE ""
[LINE] 1
c_Vndr_ID            PICTURE ""
[LINE] 1
DUP_KEY              PICTURE ""
[LINE] 1
ID_KEY               PICTURE ""
[LINE] 1
Vndr_Same_Diff       WIDTH 14 PICTURE ""
[LINE] 1
SORT_KEY             PICTURE ""
[LINE] 1
SORT_KEY_Desc        PICTURE ""
[LINE] 1
RptRunDate           PICTURE ""
[LINE] 1
TEST_NAME            PICTURE ""
[LINE] 1
Priority             WIDTH 8 PICTURE ""
^FORMAT   HIST1_VM005_Dup_Vnd_Name           HIST1_VM005_Dup_Vnd_Name         "" "HIST1_VM005_Dup_Vnd_Name.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.12/08/2015   11:43:47 TMP1 IF v_NewFlag = 1 EXTRACT FIELDS ALL SUBSTR("E:\Data\VendorMasterfile_20150723.txt",1,50) AS 'File_Name' TO  AP_VendorMaster_ALL
~Input : Records:64304       Control Total:0                    
~Output: Records:64304       Control Total:0                    
~.12/08/2015   17:56:32 AP_VendorMaster_ALL EXTRACT FIELDS ALL 'R11' AS 'SourceFlag' TO "AP_VendorMaster_ALL_FMT.FIL" IF BETWEEN(c_SITE_LAST_UPDATE_DATE,CTOD(_Data_Range_From_VM,"DD/MM/YYYY"),CTOD(_Data_Range_To_VM,"DD/MM/YYYY")) AND BETWEEN(c_HEADER_LAST_UPDATE_DATE,CTOD(_Data_Range_From_VM,"DD/MM/YYYY"),CTOD(_Data_Range_To_VM,"DD/MM/YYYY"))
~Input : Records:64304       Control Total:0                    
~Output: Records:61585       Control Total:0                    
~.12/08/2015   17:56:46 AP_VendorMaster_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Co' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NAME),1,73))) AS 'Vndr_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ABN),1,20))) AS 'ABN' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_STATUS),1,1))) AS 'Vndr_Sts' CTOD('', 'DD/MM/YYYY') AS 'Vndr_InvlDt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_TYPE),1,11))) AS 'Vndr_Typ' BLANKS(15) AS 'Vndr_Add_Typ' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ADDRESS),1,125))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(CITY),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(STATE),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(POSTCODE),1,12))) AS 'Pcode' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(COUNTRY),1,61))) AS 'Cntry' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Tel),1,21))) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Fax),1,21))) AS 'FAX' BLANKS(60) AS 'Email1' BLANKS(60) AS 'Email2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_METHOD),1,21))) AS 'Pymnt_Trm' c_SITE_CREATION_DATE AS 'Created_Dt' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE),1,30))) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_REGISTRATION_STATUS),1,30))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(SourceFlag),1,3))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NUMBER),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' c_SITE_INACTIVE_DATE AS 'Dt_Field1' c_SITE_CREATION_DATE AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3'   TO "Working_Files\VMF_Vnd_Master_File.FIL"
~Input : Records:61585       Control Total:0                    
~Output: Records:61585       Control Total:0                    
~.12/08/2015   17:57:27 VMF_Vnd_Master_File EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:61585       Control Total:0                    
~Output: Records:61585       Control Total:0                    
~.12/08/2015   17:57:28 TMP_GL EXTRACT FIELDS ALL IF Vndr_ID<> GreyList_VM005.Vndr_ID TO TMP_GL1 OPEN
~Input : Records:61585       Control Total:0                    
~Output: Records:61585       Control Total:0                    
~.12/08/2015   17:57:29 TMP_GL1 SUMMARIZE ON Vndr_ID c_Name OTHER Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm CTOD(DATE(Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' ABN_CLN Max_Inv_Dt c_Vndr_ID IF Vndr_Sts="A" AND c_Name<>" " TO "Tmp_Files\TMP2.FIL" OPEN PRESORT
~Input : Records:61585       Control Total:0                    
~Output: Records:19887       Control Total:0                    
~.12/08/2015   17:57:29 TMP2 DUPLICATES ON c_Name OTHER Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm CTOD(DATE(Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' ABN_CLN Max_Inv_Dt c_Vndr_ID PRESORT OPEN TO "Tmp_Files\TMP1.FIL"
~Input : Records:19887       Control Total:0                    
~Output: Records:19887       Control Total:0                    
~.12/08/2015   17:57:29 TMP1 EXTRACT FIELDS ALL IF DUP_KEY=TMP2.DUP_KEY TO "Tmp_Files\TMP4" OPEN
~Input : Records:55          Control Total:0                    
~Output: Records:31          Control Total:0                    
~.12/08/2015   17:57:29 TMP4 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:31          Control Total:0                    
~Output: Records:31          Control Total:0                    
~.12/08/2015   17:57:30 TMP_Cur EXTRACT FIELDS c_Name Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY IF DUP_KEY= TMP_His.DUP_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:31          Control Total:0                    
~Output: Records:31          Control Total:0                    
~.12/08/2015   17:57:30 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP1" OPEN
~Input : Records:31          Control Total:0                    
~Output: Records:31          Control Total:0                    
~.12/08/2015   17:57:30 TMP1 SORT ON SORT_KEY TO "Tmp_Files\TMP6" OPEN
~Input : Records:31          Control Total:0                    
~Output: Records:31          Control Total:0                    
~.12/08/2015   17:57:30 TMP6 EXTRACT FIELDS ALL TO "Results\VM005_Dup_Vnd_Name" IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN
~Input : Records:31          Control Total:0                    
~Output: Records:27          Control Total:0                    
~.12/08/2015   17:58:08 VM005_Dup_Vnd_Name IF FILESIZE("Results\VM005_Dup_Vnd_Name.fil")>0 EXTRACT FIELDS ALL TO HIST1_VM005_Dup_Vnd_Name
~Input : Records:27          Control Total:0                    
~Output: Records:27          Control Total:0                    
[LASTVIEW] "Default_View"
^REPORT   Default_View                       HIST1_VM006_Mis_Details          D.T,
[SKIP] 0
[TLINES] 0
[RLINES] 1
[LINE] 1
Vndr_Site_ID         PICTURE ""
[LINE] 1
Vndr_ID              PICTURE ""
[LINE] 1
TstCd                PICTURE ""
[LINE] 1
COUNT2               PICTURE ""
[LINE] 1
Co                   PICTURE ""
[LINE] 1
Vndr_Nme             PICTURE ""
[LINE] 1
ABN                  PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 8 PICTURE ""
[LINE] 1
Vndr_Typ             PICTURE ""
[LINE] 1
Vndr_Add_Typ         PICTURE ""
[LINE] 1
ADD1                 PICTURE ""
[LINE] 1
ADD2                 PICTURE ""
[LINE] 1
ADD3                 PICTURE ""
[LINE] 1
City                 PICTURE ""
[LINE] 1
State                PICTURE ""
[LINE] 1
Pcode                PICTURE ""
[LINE] 1
Cntry                PICTURE ""
[LINE] 1
TEL1                 PICTURE ""
[LINE] 1
TEL2                 PICTURE ""
[LINE] 1
TEL3                 PICTURE ""
[LINE] 1
FAX                  PICTURE ""
[LINE] 1
Email1               PICTURE ""
[LINE] 1
Email2               PICTURE ""
[LINE] 1
Pymnt_Trm            PICTURE ""
[LINE] 1
Created_Dt           PICTURE ""
[LINE] 1
Modf_Dt              PICTURE ""
[LINE] 1
Vndr_InvlDt          PICTURE ""
[LINE] 1
Cha_Field1           PICTURE ""
[LINE] 1
Cha_Field2           PICTURE ""
[LINE] 1
Cha_Field3           WIDTH 10 PICTURE ""
[LINE] 1
Cha_Field4           PICTURE ""
[LINE] 1
Cha_Field5           PICTURE ""
[LINE] 1
Num_Field1           PICTURE ""
[LINE] 1
Num_Field2           PICTURE ""
[LINE] 1
Num_Field3           PICTURE ""
[LINE] 1
Num_Field4           PICTURE ""
[LINE] 1
Num_Field5           PICTURE ""
[LINE] 1
Dt_Field1            PICTURE ""
[LINE] 1
Dt_Field2            PICTURE ""
[LINE] 1
Dt_Field3            PICTURE ""
[LINE] 1
ABN_CLN              PICTURE ""
[LINE] 1
Max_Inv_Dt           PICTURE ""
[LINE] 1
c_Vndr_ID            PICTURE ""
[LINE] 1
Inv_Amt              PICTURE ""
[LINE] 1
GST_Amt              PICTURE ""
[LINE] 1
COUNT                PICTURE ""
[LINE] 1
c_TstCd              WIDTH 7 PICTURE ""
[LINE] 1
NEW_TstCd_1          PICTURE ""
[LINE] 1
NEW_TstCd_2          WIDTH 11 PICTURE ""
[LINE] 1
NEW_TstCd_3          WIDTH 11 PICTURE ""
[LINE] 1
NEW_TstCd_4          WIDTH 11 PICTURE ""
[LINE] 1
NEW_TstCd1           PICTURE ""
[LINE] 1
NEW_TstCd2           PICTURE ""
[LINE] 1
NEW_TstCd            PICTURE ""
[LINE] 1
TEST_NAME            PICTURE ""
[LINE] 1
SORT_KEY             PICTURE ""
[LINE] 1
SORT_KEY_Desc        PICTURE ""
[LINE] 1
RptRunDate           PICTURE ""
[LINE] 1
Priority             WIDTH 8 PICTURE ""
[LINE] 1
ID_KEY               PICTURE ""
[LINE] 1
c_VALID              PICTURE ""
^FORMAT   HIST1_VM006_Mis_Details            HIST1_VM006_Mis_Details          "" "HIST1_VM006_Mis_Details.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.12/08/2015   11:43:47 TMP1 IF v_NewFlag = 1 EXTRACT FIELDS ALL SUBSTR("E:\Data\VendorMasterfile_20150723.txt",1,50) AS 'File_Name' TO  AP_VendorMaster_ALL
~Input : Records:64304       Control Total:0                    
~Output: Records:64304       Control Total:0                    
~.12/08/2015   17:56:32 AP_VendorMaster_ALL EXTRACT FIELDS ALL 'R11' AS 'SourceFlag' TO "AP_VendorMaster_ALL_FMT.FIL" IF BETWEEN(c_SITE_LAST_UPDATE_DATE,CTOD(_Data_Range_From_VM,"DD/MM/YYYY"),CTOD(_Data_Range_To_VM,"DD/MM/YYYY")) AND BETWEEN(c_HEADER_LAST_UPDATE_DATE,CTOD(_Data_Range_From_VM,"DD/MM/YYYY"),CTOD(_Data_Range_To_VM,"DD/MM/YYYY"))
~Input : Records:64304       Control Total:0                    
~Output: Records:61585       Control Total:0                    
~.12/08/2015   17:56:46 AP_VendorMaster_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Co' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NAME),1,73))) AS 'Vndr_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ABN),1,20))) AS 'ABN' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_STATUS),1,1))) AS 'Vndr_Sts' CTOD('', 'DD/MM/YYYY') AS 'Vndr_InvlDt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_TYPE),1,11))) AS 'Vndr_Typ' BLANKS(15) AS 'Vndr_Add_Typ' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ADDRESS),1,125))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(CITY),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(STATE),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(POSTCODE),1,12))) AS 'Pcode' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(COUNTRY),1,61))) AS 'Cntry' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Tel),1,21))) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Fax),1,21))) AS 'FAX' BLANKS(60) AS 'Email1' BLANKS(60) AS 'Email2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_METHOD),1,21))) AS 'Pymnt_Trm' c_SITE_CREATION_DATE AS 'Created_Dt' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE),1,30))) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_REGISTRATION_STATUS),1,30))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(SourceFlag),1,3))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NUMBER),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' c_SITE_INACTIVE_DATE AS 'Dt_Field1' c_SITE_CREATION_DATE AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3'   TO "Working_Files\VMF_Vnd_Master_File.FIL"
~Input : Records:61585       Control Total:0                    
~Output: Records:61585       Control Total:0                    
~.12/08/2015   17:57:31 VMF_Vnd_Master_File SET FILTER Vndr_Sts="A" AND InvABN="M"
~.12/08/2015   17:57:31 VMF_Vnd_Master_File EXTRACT FIELDS 100 AS "TstCd" VMF_Vnd_Master_File.Vndr_Site_ID VMF_Vnd_Master_File.Co VMF_Vnd_Master_File.Vndr_ID VMF_Vnd_Master_File.Vndr_Nme VMF_Vnd_Master_File.ABN VMF_Vnd_Master_File.Vndr_Sts VMF_Vnd_Master_File.Vndr_Typ VMF_Vnd_Master_File.Vndr_Add_Typ VMF_Vnd_Master_File.ADD1 VMF_Vnd_Master_File.ADD2 VMF_Vnd_Master_File.ADD3 VMF_Vnd_Master_File.City VMF_Vnd_Master_File.State VMF_Vnd_Master_File.Pcode VMF_Vnd_Master_File.Cntry VMF_Vnd_Master_File.TEL1 VMF_Vnd_Master_File.TEL2 VMF_Vnd_Master_File.TEL3 VMF_Vnd_Master_File.FAX VMF_Vnd_Master_File.Email1 VMF_Vnd_Master_File.Email2 VMF_Vnd_Master_File.Pymnt_Trm CTOD(DATE(VMF_Vnd_Master_File.Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(VMF_Vnd_Master_File.Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(VMF_Vnd_Master_File.Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' VMF_Vnd_Master_File.Cha_Field1 VMF_Vnd_Master_File.Cha_Field2 VMF_Vnd_Master_File.Cha_Field3 VMF_Vnd_Master_File.Cha_Field4 VMF_Vnd_Master_File.Cha_Field5 VMF_Vnd_Master_File.Num_Field1 VMF_Vnd_Master_File.Num_Field2 VMF_Vnd_Master_File.Num_Field3 VMF_Vnd_Master_File.Num_Field4 VMF_Vnd_Master_File.Num_Field5 CTOD(DATE(VMF_Vnd_Master_File.Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' VMF_Vnd_Master_File.ABN_CLN VMF_Vnd_Master_File.Max_Inv_Dt VMF_Vnd_Master_File.c_Vndr_ID AP_Vnd_InvGst_Sum.Inv_Amt AP_Vnd_InvGst_Sum.GST_Amt AP_Vnd_InvGst_Sum.COUNT IF COUNT1<>v_Cnt TO "Tmp_Files\TMP_VM006"
~Input : Records:61585       Control Total:0                    
~Output: Records:7421        Control Total:0                    
~.12/08/2015   17:57:31 VMF_Vnd_Master_File SET FILTER Vndr_Sts="A" AND LENGTH(ALLTRIM(INCLUDE(UPPER(ADD1+ADD2+ADD3),"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789")))<6
~.12/08/2015   17:57:31 VMF_Vnd_Master_File EXTRACT FIELDS 10 AS "TstCd" VMF_Vnd_Master_File.Vndr_Site_ID VMF_Vnd_Master_File.Co VMF_Vnd_Master_File.Vndr_ID VMF_Vnd_Master_File.Vndr_Nme VMF_Vnd_Master_File.ABN VMF_Vnd_Master_File.Vndr_Sts VMF_Vnd_Master_File.Vndr_Typ VMF_Vnd_Master_File.Vndr_Add_Typ VMF_Vnd_Master_File.ADD1 VMF_Vnd_Master_File.ADD2 VMF_Vnd_Master_File.ADD3 VMF_Vnd_Master_File.City VMF_Vnd_Master_File.State VMF_Vnd_Master_File.Pcode VMF_Vnd_Master_File.Cntry VMF_Vnd_Master_File.TEL1 VMF_Vnd_Master_File.TEL2 VMF_Vnd_Master_File.TEL3 VMF_Vnd_Master_File.FAX VMF_Vnd_Master_File.Email1 VMF_Vnd_Master_File.Email2 VMF_Vnd_Master_File.Pymnt_Trm CTOD(DATE(VMF_Vnd_Master_File.Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(VMF_Vnd_Master_File.Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(VMF_Vnd_Master_File.Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' VMF_Vnd_Master_File.Cha_Field1 VMF_Vnd_Master_File.Cha_Field2 VMF_Vnd_Master_File.Cha_Field3 VMF_Vnd_Master_File.Cha_Field4 VMF_Vnd_Master_File.Cha_Field5 VMF_Vnd_Master_File.Num_Field1 VMF_Vnd_Master_File.Num_Field2 VMF_Vnd_Master_File.Num_Field3 VMF_Vnd_Master_File.Num_Field4 VMF_Vnd_Master_File.Num_Field5 CTOD(DATE(VMF_Vnd_Master_File.Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' VMF_Vnd_Master_File.ABN_CLN VMF_Vnd_Master_File.Max_Inv_Dt VMF_Vnd_Master_File.c_Vndr_ID AP_Vnd_InvGst_Sum.Inv_Amt AP_Vnd_InvGst_Sum.GST_Amt AP_Vnd_InvGst_Sum.COUNT IF COUNT1<>v_Cnt TO "Tmp_Files\TMP_VM006" APPEND
~Input : Records:61585       Control Total:0                    
~Output: Records:36          Control Total:0                    
~.12/08/2015   17:57:33 VMF_Vnd_Master_File SET FILTER Vndr_Sts="A" AND LENGTH(ALLTRIM(INCLUDE(VMF_BnkAcc.BSB+VMF_BnkAcc.Bnk_Acc_Num,"1234567890")))<=3 AND VALUE(INCLUDE(VMF_BnkAcc.BSB+VMF_BnkAcc.Bnk_Acc_Num,"1234567890"),0)=0
~.12/08/2015   17:57:33 VMF_Vnd_Master_File  EXTRACT FIELDS 1000 AS "TstCd" VMF_Vnd_Master_File.Vndr_Site_ID VMF_Vnd_Master_File.Co VMF_Vnd_Master_File.Vndr_ID VMF_Vnd_Master_File.Vndr_Nme VMF_Vnd_Master_File.ABN VMF_Vnd_Master_File.Vndr_Sts VMF_Vnd_Master_File.Vndr_Typ VMF_Vnd_Master_File.Vndr_Add_Typ VMF_Vnd_Master_File.ADD1 VMF_Vnd_Master_File.ADD2 VMF_Vnd_Master_File.ADD3 VMF_Vnd_Master_File.City VMF_Vnd_Master_File.State VMF_Vnd_Master_File.Pcode VMF_Vnd_Master_File.Cntry VMF_Vnd_Master_File.TEL1 VMF_Vnd_Master_File.TEL2 VMF_Vnd_Master_File.TEL3 VMF_Vnd_Master_File.FAX VMF_Vnd_Master_File.Email1 VMF_Vnd_Master_File.Email2 VMF_Vnd_Master_File.Pymnt_Trm CTOD(DATE(VMF_Vnd_Master_File.Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(VMF_Vnd_Master_File.Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(VMF_Vnd_Master_File.Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' VMF_Vnd_Master_File.Cha_Field1 VMF_Vnd_Master_File.Cha_Field2 VMF_Vnd_Master_File.Cha_Field3 VMF_Vnd_Master_File.Cha_Field4 VMF_Vnd_Master_File.Cha_Field5 VMF_Vnd_Master_File.Num_Field1 VMF_Vnd_Master_File.Num_Field2 VMF_Vnd_Master_File.Num_Field3 VMF_Vnd_Master_File.Num_Field4 VMF_Vnd_Master_File.Num_Field5 CTOD(DATE(VMF_Vnd_Master_File.Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' VMF_Vnd_Master_File.ABN_CLN VMF_Vnd_Master_File.Max_Inv_Dt VMF_Vnd_Master_File.c_Vndr_ID AP_Vnd_InvGst_Sum.Inv_Amt AP_Vnd_InvGst_Sum.GST_Amt AP_Vnd_InvGst_Sum.COUNT IF COUNT1<>v_Cnt TO "Tmp_Files\TMP_VM006" APPEND
~Input : Records:61585       Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:57:33 TMP_VM006 SUMMARIZE ON Vndr_Site_ID Vndr_ID SUBTOTAL TstCd OTHER ALL TO "Tmp_Files\TMP_TstCd.FIL" OPEN PRESORT
~Input : Records:7457        Control Total:0                    
~Output: Records:7434        Control Total:0                    
~.12/08/2015   17:57:33 TMP_TstCd EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:7434        Control Total:0                    
~Output: Records:7434        Control Total:0                    
~.12/08/2015   17:57:34 TMP_GL EXTRACT FIELDS ALL IF Vndr_ID<> GreyList_VM006.Vndr_ID TO TMP_GL1 OPEN
~Input : Records:7434        Control Total:0                    
~Output: Records:7434        Control Total:0                    
~.12/08/2015   17:57:34 TMP_GL1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:7434        Control Total:0                    
~Output: Records:7434        Control Total:0                    
~.12/08/2015   17:57:34 TMP_Cur EXTRACT FIELDS Vndr_Site_ID Vndr_ID TstCd COUNT2 Co Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT c_TstCd NEW_TstCd_1 NEW_TstCd_2 NEW_TstCd_3 NEW_TstCd_4 NEW_TstCd1 NEW_TstCd2 NEW_TstCd TEST_NAME SORT_KEY SORT_KEY_Desc RptRunDate Priority ID_KEY IF ID_KEY<> VM006_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:7434        Control Total:0                    
~Output: Records:7434        Control Total:0                    
~.12/08/2015   17:57:34 TMP_Cur1 SORT ON SORT_KEY D TO "Tmp_Files\TMP2" OPEN
~Input : Records:7434        Control Total:0                    
~Output: Records:7434        Control Total:0                    
~.12/08/2015   17:57:34 TMP2 EXTRACT FIELDS ALL  TO "Results\VM006_Mis_Details"  IF c_VALID = 1 AND Vndr_Typ<>"EMPLOYEE" AND UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"
~Input : Records:7434        Control Total:0                    
~Output: Records:290         Control Total:0                    
~.12/08/2015   17:58:08 VM006_Mis_Details IF FILESIZE("Results\VM006_Mis_Details.fil")>=0 EXTRACT FIELDS ALL TO HIST1_VM006_Mis_Details
~Input : Records:290         Control Total:0                    
~Output: Records:290         Control Total:0                    
[LASTVIEW] "Default_View"
^REPORT   Default_View                       HIST1_VM006D_Mis_Details         D.T,
[SKIP] 0
[TLINES] 0
[RLINES] 1
[LINE] 1
Vchr_ID              PICTURE ""
[LINE] 1
Vndr_Site_ID         PICTURE ""
[LINE] 1
Vndr_ID              PICTURE ""
[LINE] 1
Doc_Typ              PICTURE ""
[LINE] 1
Inv_Dt               PICTURE ""
[LINE] 1
Inv_No               PICTURE ""
[LINE] 1
Inv_Amt              PICTURE ""
[LINE] 1
Inv_Amt_Doc          PICTURE ""
[LINE] 1
Curncy               PICTURE ""
[LINE] 1
Ex_Rate              PICTURE ""
[LINE] 1
Inv_Net_Amt          PICTURE ""
[LINE] 1
GST_Amt              PICTURE ""
[LINE] 1
Btch_No              PICTURE ""
[LINE] 1
Due_Dt               PICTURE ""
[LINE] 1
PO_No                PICTURE ""
[LINE] 1
PO_Net_Amt           PICTURE ""
[LINE] 1
Descrp               PICTURE ""
[LINE] 1
Pd_Dt                PICTURE ""
[LINE] 1
Pymnt_Trms           PICTURE ""
[LINE] 1
Modf_Dt              PICTURE ""
[LINE] 1
Modf_By              PICTURE ""
[LINE] 1
Pst_Dt               PICTURE ""
[LINE] 1
VOIDED               WIDTH 6 PICTURE ""
[LINE] 1
Void_Dt              PICTURE ""
[LINE] 1
isPaid               WIDTH 6 PICTURE ""
[LINE] 1
Num_Field1           PICTURE ""
[LINE] 1
Num_Field2           PICTURE ""
[LINE] 1
Num_Field3           PICTURE ""
[LINE] 1
Num_Field4           PICTURE ""
[LINE] 1
Num_Field5           PICTURE ""
[LINE] 1
Dt_Field1            PICTURE ""
[LINE] 1
Dt_Field2            PICTURE ""
[LINE] 1
Dt_Field3            PICTURE ""
[LINE] 1
Cha_Field1           PICTURE ""
[LINE] 1
Cha_Field2           PICTURE ""
[LINE] 1
Cha_Field3           PICTURE ""
[LINE] 1
Cha_Field4           PICTURE ""
[LINE] 1
Cha_Field5           PICTURE ""
[LINE] 1
c_Inv_No2            PICTURE ""
[LINE] 1
c_Inv_No             PICTURE ""
[LINE] 1
ABS_INVAMT           PICTURE ""
[LINE] 1
ABS_INVAMT_CENT      PICTURE ""
[LINE] 1
c_Inv_Dt             PICTURE ""
[LINE] 1
Vndr_Mstr_ID         PICTURE ""
[LINE] 1
Vndr_Nme             PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 8 PICTURE ""
[LINE] 1
Vndr_Typ             PICTURE ""
[LINE] 1
c_TstCd              WIDTH 7 PICTURE ""
[LINE] 1
TEST_NAME            PICTURE ""
[LINE] 1
SORT_KEY             PICTURE ""
[LINE] 1
SORT_KEY_Desc        PICTURE ""
[LINE] 1
RptRunDate           PICTURE ""
[LINE] 1
Data_Range_Start_Date PICTURE ""
[LINE] 1
Data_Range_End_Date  PICTURE ""
[LINE] 1
Priority             WIDTH 8 PICTURE ""
^FORMAT   HIST1_VM006D_Mis_Details           HIST1_VM006D_Mis_Details         "" "HIST1_VM006D_Mis_Details.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.11/08/2015   15:34:08 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:14947       Control Total:0                    
~Output: Records:5876        Control Total:0                    
~.11/08/2015   15:34:08 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20150806.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:5876        Control Total:0                    
~Output: Records:5876        Control Total:0                    
~.11/08/2015   15:34:08 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:5876        Control Total:0                    
~Output: Records:5876        Control Total:0                    
~.11/08/2015   15:34:14 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:261372      Control Total:0                    
~Output: Records:255841      Control Total:0                    
~.11/08/2015   15:34:14 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:261717      Control Total:0                    
~Output: Records:261717      Control Total:0                    
~.12/08/2015   17:56:29 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF BETWEEN(c_INVOICE_DATE,CTOD(_Data_Range_From,"DD/MM/YYYY"),CTOD(_Data_Range_To,"DD/MM/YYYY"))
~Input : Records:261717      Control Total:0                    
~Output: Records:261690      Control Total:0                    
~.12/08/2015   17:56:56 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:261690      Control Total:0                    
~Output: Records:261690      Control Total:0                    
~.12/08/2015   17:56:58 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:261690      Control Total:0                    
~Output: Records:252739      Control Total:0                    
~.12/08/2015   17:57:36 AP_Invoices EXTRACT FIELDS ALL VM006_Mis_Details.c_TstCd IF Vndr_ID=VM006_Mis_Details.Vndr_ID TO "TMP_1" OPEN
~Input : Records:252739      Control Total:0                    
~Output: Records:388         Control Total:0                    
~.12/08/2015   17:57:36 TMP_1 SORT ON SORT_KEY D TO "Tmp_Files\TMP3" OPEN
~Input : Records:388         Control Total:0                    
~Output: Records:388         Control Total:0                    
~.12/08/2015   17:57:36 TMP3 EXTRACT FIELDS ALL TO "Results\VM006D_Mis_Details"
~Input : Records:388         Control Total:0                    
~Output: Records:388         Control Total:0                    
~.12/08/2015   17:58:08 VM006D_Mis_Details IF FILESIZE("Results\VM006D_Mis_Details.fil")>=0 EXTRACT FIELDS ALL TO HIST1_VM006D_Mis_Details
~Input : Records:388         Control Total:0                    
~Output: Records:388         Control Total:0                    
[LASTVIEW] "Default_View"
^REPORT   Default_View                       HIST1_VM007_Invld_Frmt_ABN       D.T,
[SKIP] 0
[TLINES] 0
[RLINES] 1
[LINE] 1
Vndr_Site_ID         PICTURE ""
[LINE] 1
Co                   PICTURE ""
[LINE] 1
Vndr_ID              PICTURE ""
[LINE] 1
Vndr_Nme             PICTURE ""
[LINE] 1
ABN                  PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 8 PICTURE ""
[LINE] 1
Vndr_Typ             PICTURE ""
[LINE] 1
Vndr_Add_Typ         PICTURE ""
[LINE] 1
ADD1                 PICTURE ""
[LINE] 1
ADD2                 PICTURE ""
[LINE] 1
ADD3                 PICTURE ""
[LINE] 1
City                 PICTURE ""
[LINE] 1
State                PICTURE ""
[LINE] 1
Pcode                PICTURE ""
[LINE] 1
Cntry                PICTURE ""
[LINE] 1
TEL1                 PICTURE ""
[LINE] 1
TEL2                 PICTURE ""
[LINE] 1
TEL3                 PICTURE ""
[LINE] 1
FAX                  PICTURE ""
[LINE] 1
Email1               PICTURE ""
[LINE] 1
Email2               PICTURE ""
[LINE] 1
Pymnt_Trm            PICTURE ""
[LINE] 1
Created_Dt           PICTURE ""
[LINE] 1
Modf_Dt              PICTURE ""
[LINE] 1
Vndr_InvlDt          PICTURE ""
[LINE] 1
Cha_Field1           PICTURE ""
[LINE] 1
Cha_Field2           PICTURE ""
[LINE] 1
Cha_Field3           WIDTH 10 PICTURE ""
[LINE] 1
Cha_Field4           PICTURE ""
[LINE] 1
Cha_Field5           PICTURE ""
[LINE] 1
Num_Field1           PICTURE ""
[LINE] 1
Num_Field2           PICTURE ""
[LINE] 1
Num_Field3           PICTURE ""
[LINE] 1
Num_Field4           PICTURE ""
[LINE] 1
Num_Field5           PICTURE ""
[LINE] 1
Dt_Field1            PICTURE ""
[LINE] 1
Dt_Field2            PICTURE ""
[LINE] 1
Dt_Field3            PICTURE ""
[LINE] 1
ABN_CLN              PICTURE ""
[LINE] 1
Max_Inv_Dt           PICTURE ""
[LINE] 1
c_Vndr_ID            PICTURE ""
[LINE] 1
Inv_Amt              PICTURE ""
[LINE] 1
GST_Amt              PICTURE ""
[LINE] 1
COUNT                PICTURE ""
[LINE] 1
ID_KEY               PICTURE ""
[LINE] 1
SORT_KEY             PICTURE ""
[LINE] 1
SORT_KEY_Desc        PICTURE ""
[LINE] 1
Priority             WIDTH 8 PICTURE ""
[LINE] 1
RptRunDate           PICTURE ""
[LINE] 1
TEST_NAME            PICTURE ""
^FORMAT   HIST1_VM007_Invld_Frmt_ABN         HIST1_VM007_Invld_Frmt_ABN       "" "HIST1_VM007_Invld_Frmt_ABN.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.12/08/2015   11:43:47 TMP1 IF v_NewFlag = 1 EXTRACT FIELDS ALL SUBSTR("E:\Data\VendorMasterfile_20150723.txt",1,50) AS 'File_Name' TO  AP_VendorMaster_ALL
~Input : Records:64304       Control Total:0                    
~Output: Records:64304       Control Total:0                    
~.12/08/2015   17:56:32 AP_VendorMaster_ALL EXTRACT FIELDS ALL 'R11' AS 'SourceFlag' TO "AP_VendorMaster_ALL_FMT.FIL" IF BETWEEN(c_SITE_LAST_UPDATE_DATE,CTOD(_Data_Range_From_VM,"DD/MM/YYYY"),CTOD(_Data_Range_To_VM,"DD/MM/YYYY")) AND BETWEEN(c_HEADER_LAST_UPDATE_DATE,CTOD(_Data_Range_From_VM,"DD/MM/YYYY"),CTOD(_Data_Range_To_VM,"DD/MM/YYYY"))
~Input : Records:64304       Control Total:0                    
~Output: Records:61585       Control Total:0                    
~.12/08/2015   17:56:46 AP_VendorMaster_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Co' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NAME),1,73))) AS 'Vndr_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ABN),1,20))) AS 'ABN' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_STATUS),1,1))) AS 'Vndr_Sts' CTOD('', 'DD/MM/YYYY') AS 'Vndr_InvlDt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_TYPE),1,11))) AS 'Vndr_Typ' BLANKS(15) AS 'Vndr_Add_Typ' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ADDRESS),1,125))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(CITY),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(STATE),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(POSTCODE),1,12))) AS 'Pcode' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(COUNTRY),1,61))) AS 'Cntry' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Tel),1,21))) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Fax),1,21))) AS 'FAX' BLANKS(60) AS 'Email1' BLANKS(60) AS 'Email2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_METHOD),1,21))) AS 'Pymnt_Trm' c_SITE_CREATION_DATE AS 'Created_Dt' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE),1,30))) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_REGISTRATION_STATUS),1,30))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(SourceFlag),1,3))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NUMBER),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' c_SITE_INACTIVE_DATE AS 'Dt_Field1' c_SITE_CREATION_DATE AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3'   TO "Working_Files\VMF_Vnd_Master_File.FIL"
~Input : Records:61585       Control Total:0                    
~Output: Records:61585       Control Total:0                    
~.12/08/2015   17:57:37 VMF_Vnd_Master_File EXTRACT FIELDS VMF_Vnd_Master_File.Vndr_Site_ID VMF_Vnd_Master_File.Co VMF_Vnd_Master_File.Vndr_ID VMF_Vnd_Master_File.Vndr_Nme VMF_Vnd_Master_File.ABN VMF_Vnd_Master_File.Vndr_Sts VMF_Vnd_Master_File.Vndr_Typ VMF_Vnd_Master_File.Vndr_Add_Typ VMF_Vnd_Master_File.ADD1 VMF_Vnd_Master_File.ADD2 VMF_Vnd_Master_File.ADD3 VMF_Vnd_Master_File.City VMF_Vnd_Master_File.State VMF_Vnd_Master_File.Pcode VMF_Vnd_Master_File.Cntry VMF_Vnd_Master_File.TEL1 VMF_Vnd_Master_File.TEL2 VMF_Vnd_Master_File.TEL3 VMF_Vnd_Master_File.FAX VMF_Vnd_Master_File.Email1 VMF_Vnd_Master_File.Email2 VMF_Vnd_Master_File.Pymnt_Trm CTOD(DATE(VMF_Vnd_Master_File.Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(VMF_Vnd_Master_File.Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(VMF_Vnd_Master_File.Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' VMF_Vnd_Master_File.Cha_Field1 VMF_Vnd_Master_File.Cha_Field2 VMF_Vnd_Master_File.Cha_Field3 VMF_Vnd_Master_File.Cha_Field4 VMF_Vnd_Master_File.Cha_Field5 VMF_Vnd_Master_File.Num_Field1 VMF_Vnd_Master_File.Num_Field2 VMF_Vnd_Master_File.Num_Field3 VMF_Vnd_Master_File.Num_Field4 VMF_Vnd_Master_File.Num_Field5 CTOD(DATE(VMF_Vnd_Master_File.Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' VMF_Vnd_Master_File.ABN_CLN VMF_Vnd_Master_File.Max_Inv_Dt VMF_Vnd_Master_File.c_Vndr_ID AP_Vnd_InvGst_Sum.Inv_Amt AP_Vnd_InvGst_Sum.GST_Amt AP_Vnd_InvGst_Sum.COUNT IF Vndr_Sts="A" AND InvABN="T" TO "Tmp_Files\\TMP_Vnd" OPEN
~Input : Records:61585       Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:57:37 TMP_Vnd EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:57:37 TMP_GL EXTRACT FIELDS ALL IF Vndr_ID<> GreyList_VM007.Vndr_ID TO TMP_GL1 OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:57:37 TMP_GL1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:57:37 TMP_Cur EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT ID_KEY IF ID_KEY<> VM007_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:57:37 TMP_Cur1 SORT ON SORT_KEY D TO "Results\VM007_Invld_Frmt_ABN" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:58:08 VM007_Invld_Frmt_ABN IF FILESIZE("Results\VM007_Invld_Frmt_ABN.fil")>=0 EXTRACT FIELDS ALL TO HIST1_VM007_Invld_Frmt_ABN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
[LASTVIEW] "Default_View"
^REPORT   Default_View                       HIST1_VM007D_Invld_Frmt_ABN      D.T,
[SKIP] 0
[TLINES] 0
[RLINES] 1
[LINE] 1
Vchr_ID              PICTURE ""
[LINE] 1
Vndr_Site_ID         PICTURE ""
[LINE] 1
Vndr_ID              PICTURE ""
[LINE] 1
Doc_Typ              PICTURE ""
[LINE] 1
Inv_Dt               PICTURE ""
[LINE] 1
Inv_No               PICTURE ""
[LINE] 1
Inv_Amt              PICTURE ""
[LINE] 1
Inv_Amt_Doc          PICTURE ""
[LINE] 1
Curncy               PICTURE ""
[LINE] 1
Ex_Rate              PICTURE ""
[LINE] 1
Inv_Net_Amt          PICTURE ""
[LINE] 1
GST_Amt              PICTURE ""
[LINE] 1
Btch_No              PICTURE ""
[LINE] 1
Due_Dt               PICTURE ""
[LINE] 1
PO_No                PICTURE ""
[LINE] 1
PO_Net_Amt           PICTURE ""
[LINE] 1
Descrp               PICTURE ""
[LINE] 1
Pd_Dt                PICTURE ""
[LINE] 1
Pymnt_Trms           PICTURE ""
[LINE] 1
Modf_Dt              PICTURE ""
[LINE] 1
Modf_By              PICTURE ""
[LINE] 1
Pst_Dt               PICTURE ""
[LINE] 1
VOIDED               WIDTH 6 PICTURE ""
[LINE] 1
Void_Dt              PICTURE ""
[LINE] 1
isPaid               WIDTH 6 PICTURE ""
[LINE] 1
Num_Field1           PICTURE ""
[LINE] 1
Num_Field2           PICTURE ""
[LINE] 1
Num_Field3           PICTURE ""
[LINE] 1
Num_Field4           PICTURE ""
[LINE] 1
Num_Field5           PICTURE ""
[LINE] 1
Dt_Field1            PICTURE ""
[LINE] 1
Dt_Field2            PICTURE ""
[LINE] 1
Dt_Field3            PICTURE ""
[LINE] 1
Cha_Field1           PICTURE ""
[LINE] 1
Cha_Field2           PICTURE ""
[LINE] 1
Cha_Field3           PICTURE ""
[LINE] 1
Cha_Field4           PICTURE ""
[LINE] 1
Cha_Field5           PICTURE ""
[LINE] 1
c_Inv_No2            PICTURE ""
[LINE] 1
c_Inv_No             PICTURE ""
[LINE] 1
ABS_INVAMT           PICTURE ""
[LINE] 1
ABS_INVAMT_CENT      PICTURE ""
[LINE] 1
c_Inv_Dt             PICTURE ""
[LINE] 1
Vndr_Mstr_ID         PICTURE ""
[LINE] 1
Vndr_Nme             PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 8 PICTURE ""
[LINE] 1
Vndr_Typ             PICTURE ""
[LINE] 1
SORT_KEY             PICTURE ""
[LINE] 1
SORT_KEY_Desc        PICTURE ""
[LINE] 1
RptRunDate           PICTURE ""
[LINE] 1
Data_Range_Start_Date PICTURE ""
[LINE] 1
Data_Range_End_Date  PICTURE ""
[LINE] 1
Priority             WIDTH 8 PICTURE ""
[LINE] 1
TEST_NAME            PICTURE ""
^FORMAT   HIST1_VM007D_Invld_Frmt_ABN        HIST1_VM007D_Invld_Frmt_ABN      "" "HIST1_VM007D_Invld_Frmt_ABN.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.11/08/2015   15:34:08 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:14947       Control Total:0                    
~Output: Records:5876        Control Total:0                    
~.11/08/2015   15:34:08 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20150806.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:5876        Control Total:0                    
~Output: Records:5876        Control Total:0                    
~.11/08/2015   15:34:08 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:5876        Control Total:0                    
~Output: Records:5876        Control Total:0                    
~.11/08/2015   15:34:14 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:261372      Control Total:0                    
~Output: Records:255841      Control Total:0                    
~.11/08/2015   15:34:14 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:261717      Control Total:0                    
~Output: Records:261717      Control Total:0                    
~.12/08/2015   17:56:29 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF BETWEEN(c_INVOICE_DATE,CTOD(_Data_Range_From,"DD/MM/YYYY"),CTOD(_Data_Range_To,"DD/MM/YYYY"))
~Input : Records:261717      Control Total:0                    
~Output: Records:261690      Control Total:0                    
~.12/08/2015   17:56:56 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:261690      Control Total:0                    
~Output: Records:261690      Control Total:0                    
~.12/08/2015   17:56:58 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:261690      Control Total:0                    
~Output: Records:252739      Control Total:0                    
~.12/08/2015   17:57:38 AP_Invoices EXTRACT FIELDS ALL IF NOT ISBLANK(VM007_Invld_Frmt_ABN.Vndr_ID) TO "TMP_1" OPEN
~Input : Records:252739      Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:57:38 TMP_1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:57:39 TMP10 SORT ON SORT_KEY D TO "Results\VM007D_Invld_Frmt_ABN" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:58:08 VM007D_Invld_Frmt_ABN IF FILESIZE("Results\VM007D_Invld_Frmt_ABN.fil")>=0 EXTRACT FIELDS ALL TO HIST1_VM007D_Invld_Frmt_ABN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
[LASTVIEW] "Default_View"
^REPORT   Default_View                       HIST1_VM008_Can_ABN              D.T,
[SKIP] 0
[TLINES] 0
[RLINES] 1
[LINE] 1
Vndr_Site_ID         PICTURE ""
[LINE] 1
Co                   PICTURE ""
[LINE] 1
Vndr_ID              PICTURE ""
[LINE] 1
Vndr_Nme             PICTURE ""
[LINE] 1
ABN                  PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 8 PICTURE ""
[LINE] 1
Vndr_Typ             PICTURE ""
[LINE] 1
Vndr_Add_Typ         PICTURE ""
[LINE] 1
ADD1                 PICTURE ""
[LINE] 1
ADD2                 PICTURE ""
[LINE] 1
ADD3                 PICTURE ""
[LINE] 1
City                 PICTURE ""
[LINE] 1
State                PICTURE ""
[LINE] 1
Pcode                PICTURE ""
[LINE] 1
Cntry                PICTURE ""
[LINE] 1
TEL1                 PICTURE ""
[LINE] 1
TEL2                 PICTURE ""
[LINE] 1
TEL3                 PICTURE ""
[LINE] 1
FAX                  PICTURE ""
[LINE] 1
Email1               PICTURE ""
[LINE] 1
Email2               PICTURE ""
[LINE] 1
Pymnt_Trm            PICTURE ""
[LINE] 1
Created_Dt           PICTURE ""
[LINE] 1
Modf_Dt              PICTURE ""
[LINE] 1
Vndr_InvlDt          PICTURE ""
[LINE] 1
Cha_Field1           PICTURE ""
[LINE] 1
Cha_Field2           PICTURE ""
[LINE] 1
Cha_Field3           WIDTH 10 PICTURE ""
[LINE] 1
Cha_Field4           PICTURE ""
[LINE] 1
Cha_Field5           PICTURE ""
[LINE] 1
Num_Field1           PICTURE ""
[LINE] 1
Num_Field2           PICTURE ""
[LINE] 1
Num_Field3           PICTURE ""
[LINE] 1
Num_Field4           PICTURE ""
[LINE] 1
Num_Field5           PICTURE ""
[LINE] 1
Dt_Field1            PICTURE ""
[LINE] 1
Dt_Field2            PICTURE ""
[LINE] 1
Dt_Field3            PICTURE ""
[LINE] 1
ABN_CLN              PICTURE ""
[LINE] 1
Max_Inv_Dt           PICTURE ""
[LINE] 1
c_Vndr_ID            PICTURE ""
[LINE] 1
ASIC_entityStatusCode PICTURE ""
[LINE] 1
ASIC_entityStatusEF  WIDTH 19 PICTURE ""
[LINE] 1
ASIC_GST_effFrom     WIDTH 16 PICTURE ""
[LINE] 1
ASIC_GST_effTo       WIDTH 14 PICTURE ""
[LINE] 1
ASIC_entityDescription PICTURE ""
[LINE] 1
Inv_Amt              PICTURE ""
[LINE] 1
GST_Amt              PICTURE ""
[LINE] 1
COUNT                PICTURE ""
[LINE] 1
ID_KEY               PICTURE ""
[LINE] 1
SORT_KEY             PICTURE ""
[LINE] 1
SORT_KEY_Desc        PICTURE ""
[LINE] 1
RptRunDate           PICTURE ""
[LINE] 1
Priority             WIDTH 8 PICTURE ""
[LINE] 1
TEST_NAME            PICTURE ""
^FORMAT   HIST1_VM008_Can_ABN                HIST1_VM008_Can_ABN              "" "HIST1_VM008_Can_ABN.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.12/08/2015   11:43:47 TMP1 IF v_NewFlag = 1 EXTRACT FIELDS ALL SUBSTR("E:\Data\VendorMasterfile_20150723.txt",1,50) AS 'File_Name' TO  AP_VendorMaster_ALL
~Input : Records:64304       Control Total:0                    
~Output: Records:64304       Control Total:0                    
~.12/08/2015   17:56:32 AP_VendorMaster_ALL EXTRACT FIELDS ALL 'R11' AS 'SourceFlag' TO "AP_VendorMaster_ALL_FMT.FIL" IF BETWEEN(c_SITE_LAST_UPDATE_DATE,CTOD(_Data_Range_From_VM,"DD/MM/YYYY"),CTOD(_Data_Range_To_VM,"DD/MM/YYYY")) AND BETWEEN(c_HEADER_LAST_UPDATE_DATE,CTOD(_Data_Range_From_VM,"DD/MM/YYYY"),CTOD(_Data_Range_To_VM,"DD/MM/YYYY"))
~Input : Records:64304       Control Total:0                    
~Output: Records:61585       Control Total:0                    
~.12/08/2015   17:56:46 AP_VendorMaster_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Co' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NAME),1,73))) AS 'Vndr_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ABN),1,20))) AS 'ABN' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_STATUS),1,1))) AS 'Vndr_Sts' CTOD('', 'DD/MM/YYYY') AS 'Vndr_InvlDt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_TYPE),1,11))) AS 'Vndr_Typ' BLANKS(15) AS 'Vndr_Add_Typ' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ADDRESS),1,125))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(CITY),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(STATE),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(POSTCODE),1,12))) AS 'Pcode' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(COUNTRY),1,61))) AS 'Cntry' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Tel),1,21))) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Fax),1,21))) AS 'FAX' BLANKS(60) AS 'Email1' BLANKS(60) AS 'Email2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_METHOD),1,21))) AS 'Pymnt_Trm' c_SITE_CREATION_DATE AS 'Created_Dt' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE),1,30))) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_REGISTRATION_STATUS),1,30))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(SourceFlag),1,3))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NUMBER),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' c_SITE_INACTIVE_DATE AS 'Dt_Field1' c_SITE_CREATION_DATE AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3'   TO "Working_Files\VMF_Vnd_Master_File.FIL"
~Input : Records:61585       Control Total:0                    
~Output: Records:61585       Control Total:0                    
~.12/08/2015   17:57:41 VMF_Vnd_Master_File EXTRACT FIELDS VMF_Vnd_Master_File.Vndr_Site_ID VMF_Vnd_Master_File.Co VMF_Vnd_Master_File.Vndr_ID VMF_Vnd_Master_File.Vndr_Nme VMF_Vnd_Master_File.ABN VMF_Vnd_Master_File.Vndr_Sts VMF_Vnd_Master_File.Vndr_Typ VMF_Vnd_Master_File.Vndr_Add_Typ VMF_Vnd_Master_File.ADD1 VMF_Vnd_Master_File.ADD2 VMF_Vnd_Master_File.ADD3 VMF_Vnd_Master_File.City VMF_Vnd_Master_File.State VMF_Vnd_Master_File.Pcode VMF_Vnd_Master_File.Cntry VMF_Vnd_Master_File.TEL1 VMF_Vnd_Master_File.TEL2 VMF_Vnd_Master_File.TEL3 VMF_Vnd_Master_File.FAX VMF_Vnd_Master_File.Email1 VMF_Vnd_Master_File.Email2 VMF_Vnd_Master_File.Pymnt_Trm CTOD(DATE(VMF_Vnd_Master_File.Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(VMF_Vnd_Master_File.Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(VMF_Vnd_Master_File.Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' VMF_Vnd_Master_File.Cha_Field1 VMF_Vnd_Master_File.Cha_Field2 VMF_Vnd_Master_File.Cha_Field3 VMF_Vnd_Master_File.Cha_Field4 VMF_Vnd_Master_File.Cha_Field5 VMF_Vnd_Master_File.Num_Field1 VMF_Vnd_Master_File.Num_Field2 VMF_Vnd_Master_File.Num_Field3 VMF_Vnd_Master_File.Num_Field4 VMF_Vnd_Master_File.Num_Field5 CTOD(DATE(VMF_Vnd_Master_File.Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' VMF_Vnd_Master_File.ABN_CLN VMF_Vnd_Master_File.Max_Inv_Dt VMF_Vnd_Master_File.c_Vndr_ID ABN_ASIC.ASIC_entityStatusCode CTOD(ABN_ASIC.ASIC_entityStatusEF,"YYYY-MM-DD") AS "ASIC_entityStatusEF" CTOD(ABN_ASIC.ASIC_GST_effFrom,"YYYY-MM-DD") AS "ASIC_GST_effFrom" CTOD(ABN_ASIC.ASIC_GST_effTo,"YYYY-MM-DD") AS "ASIC_GST_effTo" ABN_ASIC.ASIC_entityDescription AP_Vnd_InvGst_Sum.Inv_Amt AP_Vnd_InvGst_Sum.GST_Amt AP_Vnd_InvGst_Sum.COUNT IF Vndr_Sts="A" AND (MATCH(ABN_ASIC.ASIC_entityStatusCode,"Cancelled")) AND UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  TO "Tmp_Files\TMP1" OPEN
~Input : Records:61585       Control Total:0                    
~Output: Records:31          Control Total:0                    
~.12/08/2015   17:57:41 TMP1 EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:31          Control Total:0                    
~Output: Records:31          Control Total:0                    
~.12/08/2015   17:57:41 TMP_GL EXTRACT FIELDS ALL IF Vndr_ID<> GreyList_VM008.Vndr_ID TO TMP_GL1 OPEN
~Input : Records:31          Control Total:0                    
~Output: Records:31          Control Total:0                    
~.12/08/2015   17:57:41 TMP_GL1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:31          Control Total:0                    
~Output: Records:31          Control Total:0                    
~.12/08/2015   17:57:41 TMP_Cur EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY IF ID_KEY<> VM008_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:31          Control Total:0                    
~Output: Records:31          Control Total:0                    
~.12/08/2015   17:57:41 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP_Vnd" OPEN
~Input : Records:31          Control Total:0                    
~Output: Records:31          Control Total:0                    
~.12/08/2015   17:57:43 TMP_Vnd SORT ON SORT_KEY D TO "Results\VM008_Can_ABN" OPEN
~Input : Records:31          Control Total:0                    
~Output: Records:31          Control Total:0                    
~.12/08/2015   17:58:08 VM008_Can_ABN IF FILESIZE("Results\VM008_Can_ABN.fil")>=0 EXTRACT FIELDS ALL TO HIST1_VM008_Can_ABN
~Input : Records:31          Control Total:0                    
~Output: Records:31          Control Total:0                    
[LASTVIEW] "Default_View"
^REPORT   Default_View                       HIST1_VM008D_Can_ABN             D.T,
[SKIP] 0
[TLINES] 0
[RLINES] 1
[LINE] 1
Vchr_ID              PICTURE ""
[LINE] 1
Vndr_Site_ID         PICTURE ""
[LINE] 1
Vndr_ID              PICTURE ""
[LINE] 1
Doc_Typ              PICTURE ""
[LINE] 1
Inv_Dt               PICTURE ""
[LINE] 1
Inv_No               PICTURE ""
[LINE] 1
Inv_Amt              PICTURE ""
[LINE] 1
Inv_Amt_Doc          PICTURE ""
[LINE] 1
Curncy               PICTURE ""
[LINE] 1
Ex_Rate              PICTURE ""
[LINE] 1
Inv_Net_Amt          PICTURE ""
[LINE] 1
GST_Amt              PICTURE ""
[LINE] 1
Btch_No              PICTURE ""
[LINE] 1
Due_Dt               PICTURE ""
[LINE] 1
PO_No                PICTURE ""
[LINE] 1
PO_Net_Amt           PICTURE ""
[LINE] 1
Descrp               PICTURE ""
[LINE] 1
Pd_Dt                PICTURE ""
[LINE] 1
Pymnt_Trms           PICTURE ""
[LINE] 1
Modf_Dt              PICTURE ""
[LINE] 1
Modf_By              PICTURE ""
[LINE] 1
Pst_Dt               PICTURE ""
[LINE] 1
VOIDED               WIDTH 6 PICTURE ""
[LINE] 1
Void_Dt              PICTURE ""
[LINE] 1
isPaid               WIDTH 6 PICTURE ""
[LINE] 1
Num_Field1           PICTURE ""
[LINE] 1
Num_Field2           PICTURE ""
[LINE] 1
Num_Field3           PICTURE ""
[LINE] 1
Num_Field4           PICTURE ""
[LINE] 1
Num_Field5           PICTURE ""
[LINE] 1
Dt_Field1            PICTURE ""
[LINE] 1
Dt_Field2            PICTURE ""
[LINE] 1
Dt_Field3            PICTURE ""
[LINE] 1
Cha_Field1           PICTURE ""
[LINE] 1
Cha_Field2           PICTURE ""
[LINE] 1
Cha_Field3           PICTURE ""
[LINE] 1
Cha_Field4           PICTURE ""
[LINE] 1
Cha_Field5           PICTURE ""
[LINE] 1
c_Inv_No2            PICTURE ""
[LINE] 1
c_Inv_No             PICTURE ""
[LINE] 1
ABS_INVAMT           PICTURE ""
[LINE] 1
ABS_INVAMT_CENT      PICTURE ""
[LINE] 1
c_Inv_Dt             PICTURE ""
[LINE] 1
Vndr_Mstr_ID         PICTURE ""
[LINE] 1
Vndr_Nme             PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 8 PICTURE ""
[LINE] 1
Vndr_Typ             PICTURE ""
[LINE] 1
SORT_KEY             PICTURE ""
[LINE] 1
SORT_KEY_Desc        PICTURE ""
[LINE] 1
Priority             WIDTH 8 PICTURE ""
[LINE] 1
RptRunDate           PICTURE ""
[LINE] 1
Data_Range_Start_Date PICTURE ""
[LINE] 1
Data_Range_End_Date  PICTURE ""
[LINE] 1
TEST_NAME            PICTURE ""
[LINE] 1
ASIC_entityStatusEF  WIDTH 19 PICTURE ""
^FORMAT   HIST1_VM008D_Can_ABN               HIST1_VM008D_Can_ABN             "" "HIST1_VM008D_Can_ABN.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.11/08/2015   15:34:08 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:14947       Control Total:0                    
~Output: Records:5876        Control Total:0                    
~.11/08/2015   15:34:08 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20150806.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:5876        Control Total:0                    
~Output: Records:5876        Control Total:0                    
~.11/08/2015   15:34:08 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:5876        Control Total:0                    
~Output: Records:5876        Control Total:0                    
~.11/08/2015   15:34:14 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:261372      Control Total:0                    
~Output: Records:255841      Control Total:0                    
~.11/08/2015   15:34:14 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:261717      Control Total:0                    
~Output: Records:261717      Control Total:0                    
~.12/08/2015   17:56:29 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF BETWEEN(c_INVOICE_DATE,CTOD(_Data_Range_From,"DD/MM/YYYY"),CTOD(_Data_Range_To,"DD/MM/YYYY"))
~Input : Records:261717      Control Total:0                    
~Output: Records:261690      Control Total:0                    
~.12/08/2015   17:56:56 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:261690      Control Total:0                    
~Output: Records:261690      Control Total:0                    
~.12/08/2015   17:56:58 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:261690      Control Total:0                    
~Output: Records:252739      Control Total:0                    
~.12/08/2015   17:57:43 AP_Invoices SORT ON Vndr_ID c_Inv_Dt D IF Vndr_ID=TMP_Vnd.Vndr_ID AND Inv_Dt > TMP_Vnd.ASIC_entityStatusEF TO "Tmp_Files\TMP_VM008" OPEN
~Input : Records:252739      Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:57:43 TMP_VM008 EXTRACT FIELDS ALL TMP_Vnd.ASIC_entityStatusEF IF NOT ISBLANK(VM008_can_ABN.Vndr_ID) AND  UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"   TO "Results\VM008D_Can_ABN"  OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:58:08 VM008D_Can_ABN IF FILESIZE("Results\VM008D_Can_ABN.fil")>=0 EXTRACT FIELDS ALL TO HIST1_VM008D_Can_ABN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
[LASTVIEW] "Default_View"
^REPORT   Default_View                       HIST1_VM008Z_Can_ABN_Sum         D.T,
[SKIP] 0
[TLINES] 0
[RLINES] 1
[LINE] 1
Vndr_Site_ID         PICTURE ""
[LINE] 1
Vndr_ID              PICTURE ""
[LINE] 1
GST_Amt              PICTURE ""
[LINE] 1
Inv_Amt              PICTURE ""
[LINE] 1
COUNT                PICTURE ""
^FORMAT   HIST1_VM008Z_Can_ABN_Sum           HIST1_VM008Z_Can_ABN_Sum         "" "HIST1_VM008Z_Can_ABN_Sum.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.11/08/2015   15:34:08 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:14947       Control Total:0                    
~Output: Records:5876        Control Total:0                    
~.11/08/2015   15:34:08 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20150806.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:5876        Control Total:0                    
~Output: Records:5876        Control Total:0                    
~.11/08/2015   15:34:08 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:5876        Control Total:0                    
~Output: Records:5876        Control Total:0                    
~.11/08/2015   15:34:14 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:261372      Control Total:0                    
~Output: Records:255841      Control Total:0                    
~.11/08/2015   15:34:14 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:261717      Control Total:0                    
~Output: Records:261717      Control Total:0                    
~.12/08/2015   17:56:29 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF BETWEEN(c_INVOICE_DATE,CTOD(_Data_Range_From,"DD/MM/YYYY"),CTOD(_Data_Range_To,"DD/MM/YYYY"))
~Input : Records:261717      Control Total:0                    
~Output: Records:261690      Control Total:0                    
~.12/08/2015   17:56:56 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:261690      Control Total:0                    
~Output: Records:261690      Control Total:0                    
~.12/08/2015   17:56:58 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:261690      Control Total:0                    
~Output: Records:252739      Control Total:0                    
~.12/08/2015   17:57:43 AP_Invoices SORT ON Vndr_ID c_Inv_Dt D IF Vndr_ID=TMP_Vnd.Vndr_ID AND Inv_Dt > TMP_Vnd.ASIC_entityStatusEF TO "Tmp_Files\TMP_VM008" OPEN
~Input : Records:252739      Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:57:43 TMP_VM008 SUMMARIZE ON Vndr_Site_ID Vndr_ID SUBTOTAL GST_Amt Inv_Amt TO "Results\VM008Z_Can_ABN_Sum.FIL" OPEN PRESORT
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:58:08 VM008Z_Can_ABN_Sum IF FILESIZE("Results\VM008Z_Can_ABN_Sum.fil")>=0 EXTRACT FIELDS ALL TO HIST1_VM008Z_Can_ABN_Sum
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
[LASTVIEW] "Default_View"
^REPORT   Default_View                       HIST1_VM009_Invld_ABN_ABR        D.T,
[SKIP] 0
[TLINES] 0
[RLINES] 1
[LINE] 1
Vndr_Site_ID         PICTURE ""
[LINE] 1
Co                   PICTURE ""
[LINE] 1
Vndr_ID              PICTURE ""
[LINE] 1
Vndr_Nme             PICTURE ""
[LINE] 1
ABN                  PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 8 PICTURE ""
[LINE] 1
Vndr_Typ             PICTURE ""
[LINE] 1
Vndr_Add_Typ         PICTURE ""
[LINE] 1
ADD1                 PICTURE ""
[LINE] 1
ADD2                 PICTURE ""
[LINE] 1
ADD3                 PICTURE ""
[LINE] 1
City                 PICTURE ""
[LINE] 1
State                PICTURE ""
[LINE] 1
Pcode                PICTURE ""
[LINE] 1
Cntry                PICTURE ""
[LINE] 1
TEL1                 PICTURE ""
[LINE] 1
TEL2                 PICTURE ""
[LINE] 1
TEL3                 PICTURE ""
[LINE] 1
FAX                  PICTURE ""
[LINE] 1
Email1               PICTURE ""
[LINE] 1
Email2               PICTURE ""
[LINE] 1
Pymnt_Trm            PICTURE ""
[LINE] 1
Created_Dt           PICTURE ""
[LINE] 1
Modf_Dt              PICTURE ""
[LINE] 1
Vndr_InvlDt          PICTURE ""
[LINE] 1
Cha_Field1           PICTURE ""
[LINE] 1
Cha_Field2           PICTURE ""
[LINE] 1
Cha_Field3           WIDTH 10 PICTURE ""
[LINE] 1
Cha_Field4           PICTURE ""
[LINE] 1
Cha_Field5           PICTURE ""
[LINE] 1
Num_Field1           PICTURE ""
[LINE] 1
Num_Field2           PICTURE ""
[LINE] 1
Num_Field3           PICTURE ""
[LINE] 1
Num_Field4           PICTURE ""
[LINE] 1
Num_Field5           PICTURE ""
[LINE] 1
Dt_Field1            PICTURE ""
[LINE] 1
Dt_Field2            PICTURE ""
[LINE] 1
Dt_Field3            PICTURE ""
[LINE] 1
ABN_CLN              PICTURE ""
[LINE] 1
Max_Inv_Dt           PICTURE ""
[LINE] 1
c_Vndr_ID            PICTURE ""
[LINE] 1
ASIC_entityStatusCode PICTURE ""
[LINE] 1
ASIC_entityStatusEF  WIDTH 19 PICTURE ""
[LINE] 1
ASIC_GST_effFrom     WIDTH 16 PICTURE ""
[LINE] 1
ASIC_GST_effTo       WIDTH 14 PICTURE ""
[LINE] 1
ASIC_entityDescription PICTURE ""
[LINE] 1
Inv_Amt              PICTURE ""
[LINE] 1
GST_Amt              PICTURE ""
[LINE] 1
COUNT                PICTURE ""
[LINE] 1
ID_KEY               PICTURE ""
[LINE] 1
SORT_KEY             PICTURE ""
[LINE] 1
SORT_KEY_Desc        PICTURE ""
[LINE] 1
RptRunDate           PICTURE ""
[LINE] 1
Priority             WIDTH 8 PICTURE ""
[LINE] 1
TEST_NAME            PICTURE ""
^FORMAT   HIST1_VM009_Invld_ABN_ABR          HIST1_VM009_Invld_ABN_ABR        "" "HIST1_VM009_Invld_ABN_ABR.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.12/08/2015   11:43:47 TMP1 IF v_NewFlag = 1 EXTRACT FIELDS ALL SUBSTR("E:\Data\VendorMasterfile_20150723.txt",1,50) AS 'File_Name' TO  AP_VendorMaster_ALL
~Input : Records:64304       Control Total:0                    
~Output: Records:64304       Control Total:0                    
~.12/08/2015   17:56:32 AP_VendorMaster_ALL EXTRACT FIELDS ALL 'R11' AS 'SourceFlag' TO "AP_VendorMaster_ALL_FMT.FIL" IF BETWEEN(c_SITE_LAST_UPDATE_DATE,CTOD(_Data_Range_From_VM,"DD/MM/YYYY"),CTOD(_Data_Range_To_VM,"DD/MM/YYYY")) AND BETWEEN(c_HEADER_LAST_UPDATE_DATE,CTOD(_Data_Range_From_VM,"DD/MM/YYYY"),CTOD(_Data_Range_To_VM,"DD/MM/YYYY"))
~Input : Records:64304       Control Total:0                    
~Output: Records:61585       Control Total:0                    
~.12/08/2015   17:56:46 AP_VendorMaster_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Co' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NAME),1,73))) AS 'Vndr_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ABN),1,20))) AS 'ABN' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_STATUS),1,1))) AS 'Vndr_Sts' CTOD('', 'DD/MM/YYYY') AS 'Vndr_InvlDt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_TYPE),1,11))) AS 'Vndr_Typ' BLANKS(15) AS 'Vndr_Add_Typ' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ADDRESS),1,125))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(CITY),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(STATE),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(POSTCODE),1,12))) AS 'Pcode' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(COUNTRY),1,61))) AS 'Cntry' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Tel),1,21))) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Fax),1,21))) AS 'FAX' BLANKS(60) AS 'Email1' BLANKS(60) AS 'Email2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_METHOD),1,21))) AS 'Pymnt_Trm' c_SITE_CREATION_DATE AS 'Created_Dt' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE),1,30))) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_REGISTRATION_STATUS),1,30))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(SourceFlag),1,3))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NUMBER),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' c_SITE_INACTIVE_DATE AS 'Dt_Field1' c_SITE_CREATION_DATE AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3'   TO "Working_Files\VMF_Vnd_Master_File.FIL"
~Input : Records:61585       Control Total:0                    
~Output: Records:61585       Control Total:0                    
~.12/08/2015   17:57:46 VMF_Vnd_Master_File EXTRACT FIELDS VMF_Vnd_Master_File.Vndr_Site_ID VMF_Vnd_Master_File.Co VMF_Vnd_Master_File.Vndr_ID VMF_Vnd_Master_File.Vndr_Nme VMF_Vnd_Master_File.ABN VMF_Vnd_Master_File.Vndr_Sts VMF_Vnd_Master_File.Vndr_Typ VMF_Vnd_Master_File.Vndr_Add_Typ VMF_Vnd_Master_File.ADD1 VMF_Vnd_Master_File.ADD2 VMF_Vnd_Master_File.ADD3 VMF_Vnd_Master_File.City VMF_Vnd_Master_File.State VMF_Vnd_Master_File.Pcode VMF_Vnd_Master_File.Cntry VMF_Vnd_Master_File.TEL1 VMF_Vnd_Master_File.TEL2 VMF_Vnd_Master_File.TEL3 VMF_Vnd_Master_File.FAX VMF_Vnd_Master_File.Email1 VMF_Vnd_Master_File.Email2 VMF_Vnd_Master_File.Pymnt_Trm CTOD(DATE(VMF_Vnd_Master_File.Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(VMF_Vnd_Master_File.Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(VMF_Vnd_Master_File.Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' VMF_Vnd_Master_File.Cha_Field1 VMF_Vnd_Master_File.Cha_Field2 VMF_Vnd_Master_File.Cha_Field3 VMF_Vnd_Master_File.Cha_Field4 VMF_Vnd_Master_File.Cha_Field5 VMF_Vnd_Master_File.Num_Field1 VMF_Vnd_Master_File.Num_Field2 VMF_Vnd_Master_File.Num_Field3 VMF_Vnd_Master_File.Num_Field4 VMF_Vnd_Master_File.Num_Field5 CTOD(DATE(VMF_Vnd_Master_File.Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' VMF_Vnd_Master_File.ABN_CLN VMF_Vnd_Master_File.Max_Inv_Dt VMF_Vnd_Master_File.c_Vndr_ID ABN_ASIC.ASIC_entityStatusCode CTOD(ABN_ASIC.ASIC_entityStatusEF,"YYYY-MM-DD") AS "ASIC_entityStatusEF" CTOD(ABN_ASIC.ASIC_GST_effFrom,"YYYY-MM-DD") AS "ASIC_GST_effFrom" CTOD(ABN_ASIC.ASIC_GST_effTo,"YYYY-MM-DD") AS "ASIC_GST_effTo" ABN_ASIC.ASIC_entityDescription AP_Vnd_InvGst_Sum.Inv_Amt AP_Vnd_InvGst_Sum.GST_Amt AP_Vnd_InvGst_Sum.COUNT IF LENGTH(ALLTRIM(ABN_CLN))>1 AND Vndr_Sts="A" AND InvABN="F" AND (MATCH(ABN_ASIC.ASIC_entityStatusCode,"Not Found")) TO "Tmp_Files\TMP1" OPEN
~Input : Records:61585       Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:57:46 TMP1 EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:57:46 TMP_GL EXTRACT FIELDS ALL IF Vndr_ID<> GreyList_VM009.Vndr_ID TO TMP_GL1 OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:57:46 TMP_GL1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:57:46 TMP_Cur EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY IF ID_KEY<> VM009_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:57:46 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP_Vnd" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:57:48 TMP_Vnd EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:57:48 TMP10 SORT ON SORT_KEY TO "Results\VM009_Invld_ABN_ABR" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:58:08 VM009_Invld_ABN_ABR IF FILESIZE("Results\VM009_Invld_ABN_ABR.fil")>=0 EXTRACT FIELDS ALL TO HIST1_VM009_Invld_ABN_ABR
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
[LASTVIEW] "Default_View"
^REPORT   Default_View                       HIST1_VM009D_Invld_ABN_ABR       D.T,
[SKIP] 0
[TLINES] 0
[RLINES] 1
[LINE] 1
Vchr_ID              PICTURE ""
[LINE] 1
Vndr_Site_ID         PICTURE ""
[LINE] 1
Vndr_ID              PICTURE ""
[LINE] 1
Doc_Typ              PICTURE ""
[LINE] 1
Inv_Dt               PICTURE ""
[LINE] 1
Inv_No               PICTURE ""
[LINE] 1
Inv_Amt              PICTURE ""
[LINE] 1
Inv_Amt_Doc          PICTURE ""
[LINE] 1
Curncy               PICTURE ""
[LINE] 1
Ex_Rate              PICTURE ""
[LINE] 1
Inv_Net_Amt          PICTURE ""
[LINE] 1
GST_Amt              PICTURE ""
[LINE] 1
Btch_No              PICTURE ""
[LINE] 1
Due_Dt               PICTURE ""
[LINE] 1
PO_No                PICTURE ""
[LINE] 1
PO_Net_Amt           PICTURE ""
[LINE] 1
Descrp               PICTURE ""
[LINE] 1
Pd_Dt                PICTURE ""
[LINE] 1
Pymnt_Trms           PICTURE ""
[LINE] 1
Modf_Dt              PICTURE ""
[LINE] 1
Modf_By              PICTURE ""
[LINE] 1
Pst_Dt               PICTURE ""
[LINE] 1
VOIDED               WIDTH 6 PICTURE ""
[LINE] 1
Void_Dt              PICTURE ""
[LINE] 1
isPaid               WIDTH 6 PICTURE ""
[LINE] 1
Num_Field1           PICTURE ""
[LINE] 1
Num_Field2           PICTURE ""
[LINE] 1
Num_Field3           PICTURE ""
[LINE] 1
Num_Field4           PICTURE ""
[LINE] 1
Num_Field5           PICTURE ""
[LINE] 1
Dt_Field1            PICTURE ""
[LINE] 1
Dt_Field2            PICTURE ""
[LINE] 1
Dt_Field3            PICTURE ""
[LINE] 1
Cha_Field1           PICTURE ""
[LINE] 1
Cha_Field2           PICTURE ""
[LINE] 1
Cha_Field3           PICTURE ""
[LINE] 1
Cha_Field4           PICTURE ""
[LINE] 1
Cha_Field5           PICTURE ""
[LINE] 1
c_Inv_No2            PICTURE ""
[LINE] 1
c_Inv_No             PICTURE ""
[LINE] 1
ABS_INVAMT           PICTURE ""
[LINE] 1
ABS_INVAMT_CENT      PICTURE ""
[LINE] 1
c_Inv_Dt             PICTURE ""
[LINE] 1
Vndr_Mstr_ID         PICTURE ""
[LINE] 1
Vndr_Nme             PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 8 PICTURE ""
[LINE] 1
Vndr_Typ             PICTURE ""
[LINE] 1
SORT_KEY             PICTURE ""
[LINE] 1
SORT_KEY_Desc        PICTURE ""
[LINE] 1
Priority             WIDTH 8 PICTURE ""
[LINE] 1
RptRunDate           PICTURE ""
[LINE] 1
Data_Range_Start_Date PICTURE ""
[LINE] 1
Data_Range_End_Date  PICTURE ""
[LINE] 1
TEST_NAME            PICTURE ""
[LINE] 1
ASIC_entityStatusEF  WIDTH 19 PICTURE ""
^FORMAT   HIST1_VM009D_Invld_ABN_ABR         HIST1_VM009D_Invld_ABN_ABR       "" "HIST1_VM009D_Invld_ABN_ABR.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.11/08/2015   15:34:08 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:14947       Control Total:0                    
~Output: Records:5876        Control Total:0                    
~.11/08/2015   15:34:08 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20150806.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:5876        Control Total:0                    
~Output: Records:5876        Control Total:0                    
~.11/08/2015   15:34:08 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:5876        Control Total:0                    
~Output: Records:5876        Control Total:0                    
~.11/08/2015   15:34:14 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:261372      Control Total:0                    
~Output: Records:255841      Control Total:0                    
~.11/08/2015   15:34:14 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:261717      Control Total:0                    
~Output: Records:261717      Control Total:0                    
~.12/08/2015   17:56:29 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF BETWEEN(c_INVOICE_DATE,CTOD(_Data_Range_From,"DD/MM/YYYY"),CTOD(_Data_Range_To,"DD/MM/YYYY"))
~Input : Records:261717      Control Total:0                    
~Output: Records:261690      Control Total:0                    
~.12/08/2015   17:56:56 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:261690      Control Total:0                    
~Output: Records:261690      Control Total:0                    
~.12/08/2015   17:56:58 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:261690      Control Total:0                    
~Output: Records:252739      Control Total:0                    
~.12/08/2015   17:57:48 AP_Invoices SORT ON Vndr_ID c_Inv_Dt D IF Vndr_ID=TMP_Vnd.Vndr_ID TO "Tmp_Files\TMP_VM009" OPEN
~Input : Records:252739      Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:57:48 TMP_VM009 EXTRACT FIELDS ALL TMP_Vnd.ASIC_entityStatusEF IF NOT ISBLANK(VM009_Invld_ABN_ABR.Vndr_ID) TO "Results\VM009D_Invld_ABN_ABR" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:58:08 VM009D_Invld_ABN_ABR IF FILESIZE("Results\VM009D_Invld_ABN_ABR.fil")>=0 EXTRACT FIELDS ALL TO HIST1_VM009D_Invld_ABN_ABR
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
[LASTVIEW] "Default_View"
^REPORT   Default_View                       HIST1_VM010_DeReg_GST            D.T,
[SKIP] 0
[TLINES] 0
[RLINES] 1
[LINE] 1
ASIC_entityStatusCode PICTURE ""
[LINE] 1
ASIC_entityStatusEF  WIDTH 19 PICTURE ""
[LINE] 1
ASIC_GST_effFrom     WIDTH 16 PICTURE ""
[LINE] 1
ASIC_GST_effTo       WIDTH 14 PICTURE ""
[LINE] 1
ASIC_entityDescription PICTURE ""
[LINE] 1
Inv_Amt              PICTURE ""
[LINE] 1
GST_Amt              PICTURE ""
[LINE] 1
COUNT                PICTURE ""
[LINE] 1
Vndr_Site_ID         PICTURE ""
[LINE] 1
Co                   PICTURE ""
[LINE] 1
Vndr_ID              PICTURE ""
[LINE] 1
Vndr_Nme             PICTURE ""
[LINE] 1
ABN                  PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 8 PICTURE ""
[LINE] 1
Vndr_Typ             PICTURE ""
[LINE] 1
Vndr_Add_Typ         PICTURE ""
[LINE] 1
ADD1                 PICTURE ""
[LINE] 1
ADD2                 PICTURE ""
[LINE] 1
ADD3                 PICTURE ""
[LINE] 1
City                 PICTURE ""
[LINE] 1
State                PICTURE ""
[LINE] 1
Pcode                PICTURE ""
[LINE] 1
Cntry                PICTURE ""
[LINE] 1
TEL1                 PICTURE ""
[LINE] 1
TEL2                 PICTURE ""
[LINE] 1
TEL3                 PICTURE ""
[LINE] 1
FAX                  PICTURE ""
[LINE] 1
Email1               PICTURE ""
[LINE] 1
Email2               PICTURE ""
[LINE] 1
Pymnt_Trm            PICTURE ""
[LINE] 1
Created_Dt           PICTURE ""
[LINE] 1
Modf_Dt              PICTURE ""
[LINE] 1
Vndr_InvlDt          PICTURE ""
[LINE] 1
Cha_Field1           PICTURE ""
[LINE] 1
Cha_Field2           PICTURE ""
[LINE] 1
Cha_Field3           WIDTH 10 PICTURE ""
[LINE] 1
Cha_Field4           PICTURE ""
[LINE] 1
Cha_Field5           PICTURE ""
[LINE] 1
Num_Field1           PICTURE ""
[LINE] 1
Num_Field2           PICTURE ""
[LINE] 1
Num_Field3           PICTURE ""
[LINE] 1
Num_Field4           PICTURE ""
[LINE] 1
Num_Field5           PICTURE ""
[LINE] 1
Dt_Field1            PICTURE ""
[LINE] 1
Dt_Field2            PICTURE ""
[LINE] 1
Dt_Field3            PICTURE ""
[LINE] 1
ABN_CLN              PICTURE ""
[LINE] 1
Max_Inv_Dt           PICTURE ""
[LINE] 1
c_Vndr_ID            PICTURE ""
[LINE] 1
Priority             WIDTH 8 PICTURE ""
[LINE] 1
TEST_NAME            PICTURE ""
[LINE] 1
RptRunDate           PICTURE ""
[LINE] 1
SORT_KEY             PICTURE ""
[LINE] 1
SORT_KEY_Desc        PICTURE ""
^FORMAT   HIST1_VM010_DeReg_GST              HIST1_VM010_DeReg_GST            "" "HIST1_VM010_DeReg_GST.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.12/08/2015   11:43:47 TMP1 IF v_NewFlag = 1 EXTRACT FIELDS ALL SUBSTR("E:\Data\VendorMasterfile_20150723.txt",1,50) AS 'File_Name' TO  AP_VendorMaster_ALL
~Input : Records:64304       Control Total:0                    
~Output: Records:64304       Control Total:0                    
~.12/08/2015   17:56:32 AP_VendorMaster_ALL EXTRACT FIELDS ALL 'R11' AS 'SourceFlag' TO "AP_VendorMaster_ALL_FMT.FIL" IF BETWEEN(c_SITE_LAST_UPDATE_DATE,CTOD(_Data_Range_From_VM,"DD/MM/YYYY"),CTOD(_Data_Range_To_VM,"DD/MM/YYYY")) AND BETWEEN(c_HEADER_LAST_UPDATE_DATE,CTOD(_Data_Range_From_VM,"DD/MM/YYYY"),CTOD(_Data_Range_To_VM,"DD/MM/YYYY"))
~Input : Records:64304       Control Total:0                    
~Output: Records:61585       Control Total:0                    
~.12/08/2015   17:56:46 AP_VendorMaster_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Co' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NAME),1,73))) AS 'Vndr_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ABN),1,20))) AS 'ABN' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_STATUS),1,1))) AS 'Vndr_Sts' CTOD('', 'DD/MM/YYYY') AS 'Vndr_InvlDt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_TYPE),1,11))) AS 'Vndr_Typ' BLANKS(15) AS 'Vndr_Add_Typ' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ADDRESS),1,125))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(CITY),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(STATE),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(POSTCODE),1,12))) AS 'Pcode' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(COUNTRY),1,61))) AS 'Cntry' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Tel),1,21))) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Fax),1,21))) AS 'FAX' BLANKS(60) AS 'Email1' BLANKS(60) AS 'Email2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_METHOD),1,21))) AS 'Pymnt_Trm' c_SITE_CREATION_DATE AS 'Created_Dt' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE),1,30))) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_REGISTRATION_STATUS),1,30))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(SourceFlag),1,3))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NUMBER),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' c_SITE_INACTIVE_DATE AS 'Dt_Field1' c_SITE_CREATION_DATE AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3'   TO "Working_Files\VMF_Vnd_Master_File.FIL"
~Input : Records:61585       Control Total:0                    
~Output: Records:61585       Control Total:0                    
~.12/08/2015   17:57:50 VMF_Vnd_Master_File EXTRACT FIELDS ALL ABN_ASIC.ASIC_entityStatusCode CTOD(ABN_ASIC.ASIC_entityStatusEF,"YYYY-MM-DD") AS "ASIC_entityStatusEF" CTOD(ABN_ASIC.ASIC_GST_effFrom,"YYYY-MM-DD") AS "ASIC_GST_effFrom" CTOD(ABN_ASIC.ASIC_GST_effTo,"YYYY-MM-DD") AS "ASIC_GST_effTo" ABN_ASIC.ASIC_entityDescription IF LENGTH(ALLTRIM(ABN_CLN))>1 AND Vndr_Sts="A" AND InvABN="F" AND (((ABN_ASIC.ASIC_entityStatusCode = "Active") AND ISBLANK(ABN_ASIC.ASIC_GST_effFrom)) OR ((ABN_ASIC.ASIC_entityStatusCode = "Active") AND NOT ISBLANK(ABN_ASIC.ASIC_GST_effTo))) TO "Tmp_Files\TMP1" OPEN
~Input : Records:61585       Control Total:0                    
~Output: Records:1225        Control Total:0                    
~.12/08/2015   17:57:50 TMP1 EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:1225        Control Total:0                    
~Output: Records:1225        Control Total:0                    
~.12/08/2015   17:57:51 TMP_GL EXTRACT FIELDS ALL IF Vndr_ID<> GreyList_VM010.Vndr_ID TO TMP_GL1 OPEN
~Input : Records:1225        Control Total:0                    
~Output: Records:1225        Control Total:0                    
~.12/08/2015   17:57:51 TMP_GL1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:1225        Control Total:0                    
~Output: Records:1225        Control Total:0                    
~.12/08/2015   17:57:51 TMP_Cur EXTRACT FIELDS Co Vndr_Site_ID Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_InvlDt Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 c_Vndr_ID ABN_CLN Max_Inv_Dt Bnk_Acc_Num BSB Inv_Amt GST_Amt COUNT InvABN ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription ID_KEY IF ID_KEY<> VM010_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:1225        Control Total:0                    
~Output: Records:1225        Control Total:0                    
~.12/08/2015   17:57:51 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP_Vnd"  OPEN
~Input : Records:1225        Control Total:0                    
~Output: Records:1225        Control Total:0                    
~.12/08/2015   17:57:51 TMP_Vnd EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:1225        Control Total:0                    
~Output: Records:1225        Control Total:0                    
~.12/08/2015   17:57:51 TMP10 SORT ON SORT_KEY D TO "Tmp_Files\TMP_VM010" OPEN
~Input : Records:1225        Control Total:0                    
~Output: Records:1225        Control Total:0                    
~.12/08/2015   17:57:51 TMP_VM010 EXTRACT FIELDS ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription VM010D_DeReg_GST_Sum.Inv_Amt VM010D_DeReg_GST_Sum.GST_Amt VM010D_DeReg_GST_Sum.COUNT VMF_Vnd_Master_File.Vndr_Site_ID VMF_Vnd_Master_File.Co VMF_Vnd_Master_File.Vndr_ID VMF_Vnd_Master_File.Vndr_Nme VMF_Vnd_Master_File.ABN VMF_Vnd_Master_File.Vndr_Sts VMF_Vnd_Master_File.Vndr_Typ VMF_Vnd_Master_File.Vndr_Add_Typ VMF_Vnd_Master_File.ADD1 VMF_Vnd_Master_File.ADD2 VMF_Vnd_Master_File.ADD3 VMF_Vnd_Master_File.City VMF_Vnd_Master_File.State VMF_Vnd_Master_File.Pcode VMF_Vnd_Master_File.Cntry VMF_Vnd_Master_File.TEL1 VMF_Vnd_Master_File.TEL2 VMF_Vnd_Master_File.TEL3 VMF_Vnd_Master_File.FAX VMF_Vnd_Master_File.Email1 VMF_Vnd_Master_File.Email2 VMF_Vnd_Master_File.Pymnt_Trm CTOD(DATE(VMF_Vnd_Master_File.Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(VMF_Vnd_Master_File.Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(VMF_Vnd_Master_File.Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' VMF_Vnd_Master_File.Cha_Field1 VMF_Vnd_Master_File.Cha_Field2 VMF_Vnd_Master_File.Cha_Field3 VMF_Vnd_Master_File.Cha_Field4 VMF_Vnd_Master_File.Cha_Field5 VMF_Vnd_Master_File.Num_Field1 VMF_Vnd_Master_File.Num_Field2 VMF_Vnd_Master_File.Num_Field3 VMF_Vnd_Master_File.Num_Field4 VMF_Vnd_Master_File.Num_Field5 CTOD(DATE(VMF_Vnd_Master_File.Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' VMF_Vnd_Master_File.ABN_CLN VMF_Vnd_Master_File.Max_Inv_Dt VMF_Vnd_Master_File.c_Vndr_ID Priority TEST_NAME RptRunDate SORT_KEY SORT_KEY_Desc TO "Results\VM010_DeReg_GST" OPEN
~Input : Records:1225        Control Total:0                    
~Output: Records:1225        Control Total:0                    
~.12/08/2015   17:58:08 VM010_DeReg_GST IF FILESIZE("Results\VM010_DeReg_GST.fil")>=0 EXTRACT FIELDS ALL TO HIST1_VM010_DeReg_GST
~Input : Records:1225        Control Total:0                    
~Output: Records:1225        Control Total:0                    
[LASTVIEW] "Default_View"
^REPORT   Default_View                       HIST1_VM010D_DeReg_GST           D.T,
[SKIP] 0
[TLINES] 0
[RLINES] 1
[LINE] 1
ASIC_GST_effTo       WIDTH 14 PICTURE ""
[LINE] 1
Vndr_Site_ID         PICTURE ""
[LINE] 1
Vndr_ID              PICTURE ""
[LINE] 1
Vchr_ID              PICTURE ""
[LINE] 1
ABS_INVAMT           PICTURE ""
[LINE] 1
isPaid               WIDTH 6 PICTURE ""
[LINE] 1
Doc_Typ              PICTURE ""
[LINE] 1
Inv_Dt               PICTURE ""
[LINE] 1
Inv_No               PICTURE ""
[LINE] 1
Inv_Amt              PICTURE ""
[LINE] 1
Inv_Amt_Doc          PICTURE ""
[LINE] 1
Curncy               PICTURE ""
[LINE] 1
Inv_Net_Amt          PICTURE ""
[LINE] 1
GST_Amt              PICTURE ""
[LINE] 1
Btch_No              PICTURE ""
[LINE] 1
Due_Dt               PICTURE ""
[LINE] 1
PO_No                PICTURE ""
[LINE] 1
PO_Net_Amt           PICTURE ""
[LINE] 1
Descrp               PICTURE ""
[LINE] 1
Pd_Dt                PICTURE ""
[LINE] 1
Pymnt_Trms           PICTURE ""
[LINE] 1
Modf_By              PICTURE ""
[LINE] 1
Modf_Dt              PICTURE ""
[LINE] 1
Pst_Dt               PICTURE ""
[LINE] 1
Ex_Rate              PICTURE ""
[LINE] 1
VOIDED               WIDTH 6 PICTURE ""
[LINE] 1
Void_Dt              PICTURE ""
[LINE] 1
Num_Field1           PICTURE ""
[LINE] 1
Num_Field2           PICTURE ""
[LINE] 1
Num_Field3           PICTURE ""
[LINE] 1
Num_Field4           PICTURE ""
[LINE] 1
Num_Field5           PICTURE ""
[LINE] 1
Dt_Field1            PICTURE ""
[LINE] 1
Dt_Field2            PICTURE ""
[LINE] 1
Dt_Field3            PICTURE ""
[LINE] 1
Cha_Field1           PICTURE ""
[LINE] 1
Cha_Field2           PICTURE ""
[LINE] 1
Cha_Field3           PICTURE ""
[LINE] 1
Cha_Field4           PICTURE ""
[LINE] 1
Cha_Field5           PICTURE ""
[LINE] 1
c_Inv_No             PICTURE ""
[LINE] 1
c_Inv_Dt             PICTURE ""
[LINE] 1
Vndr_Mstr_ID         PICTURE ""
[LINE] 1
Vndr_Nme             PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 8 PICTURE ""
[LINE] 1
Vndr_Typ             PICTURE ""
[LINE] 1
Priority             WIDTH 8 PICTURE ""
[LINE] 1
TEST_NAME            PICTURE ""
[LINE] 1
RptRunDate           PICTURE ""
[LINE] 1
Data_Range_Start_Date PICTURE ""
[LINE] 1
Data_Range_End_Date  PICTURE ""
[LINE] 1
SORT_KEY             PICTURE ""
[LINE] 1
SORT_KEY_Desc        PICTURE ""
^FORMAT   HIST1_VM010D_DeReg_GST             HIST1_VM010D_DeReg_GST           "" "HIST1_VM010D_DeReg_GST.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.11/08/2015   15:34:08 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:14947       Control Total:0                    
~Output: Records:5876        Control Total:0                    
~.11/08/2015   15:34:08 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20150806.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:5876        Control Total:0                    
~Output: Records:5876        Control Total:0                    
~.11/08/2015   15:34:08 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:5876        Control Total:0                    
~Output: Records:5876        Control Total:0                    
~.11/08/2015   15:34:14 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:261372      Control Total:0                    
~Output: Records:255841      Control Total:0                    
~.11/08/2015   15:34:14 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:261717      Control Total:0                    
~Output: Records:261717      Control Total:0                    
~.12/08/2015   17:56:29 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF BETWEEN(c_INVOICE_DATE,CTOD(_Data_Range_From,"DD/MM/YYYY"),CTOD(_Data_Range_To,"DD/MM/YYYY"))
~Input : Records:261717      Control Total:0                    
~Output: Records:261690      Control Total:0                    
~.12/08/2015   17:56:56 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:261690      Control Total:0                    
~Output: Records:261690      Control Total:0                    
~.12/08/2015   17:56:58 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:261690      Control Total:0                    
~Output: Records:252739      Control Total:0                    
~.12/08/2015   17:57:51 AP_Invoices SORT ON Vndr_ID c_Inv_Dt D IF GST_Amt <> 0.00 AND NOT ISBLANK(TMP_Vnd.Vndr_ID) AND (Inv_Dt > TMP_Vnd.ASIC_GST_effTo OR ISBLANK(DATE(TMP_Vnd.ASIC_GST_effFrom))) TO "Tmp_Files\TMP_VM010D" OPEN
~Input : Records:252739      Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:57:51 TMP_VM010D EXTRACT FIELDS VM010_DeReg_GST.ASIC_GST_effTo Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ Priority TEST_NAME RptRunDate Data_Range_Start_Date Data_Range_End_Date SORT_KEY SORT_KEY_Desc TO "Results\VM010D_DeReg_GST" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:58:08 VM010D_DeReg_GST IF FILESIZE("Results\VM010D_DeReg_GST.fil")>=0 EXTRACT FIELDS ALL TO HIST1_VM010D_DeReg_GST
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
[LASTVIEW] "Default_View"
^REPORT   Default_View                       HIST1_VM010D_DeReg_GST_Sum       D.T,
[SKIP] 0
[TLINES] 0
[RLINES] 1
[LINE] 1
Vndr_Site_ID         PICTURE ""
[LINE] 1
GST_Amt              PICTURE ""
[LINE] 1
Inv_Amt              PICTURE ""
[LINE] 1
COUNT                PICTURE ""
^FORMAT   HIST1_VM010D_DeReg_GST_Sum         HIST1_VM010D_DeReg_GST_Sum       "" "HIST1_VM010D_DeReg_GST_Sum.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.11/08/2015   15:34:08 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:14947       Control Total:0                    
~Output: Records:5876        Control Total:0                    
~.11/08/2015   15:34:08 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20150806.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:5876        Control Total:0                    
~Output: Records:5876        Control Total:0                    
~.11/08/2015   15:34:08 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:5876        Control Total:0                    
~Output: Records:5876        Control Total:0                    
~.11/08/2015   15:34:14 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:261372      Control Total:0                    
~Output: Records:255841      Control Total:0                    
~.11/08/2015   15:34:14 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:261717      Control Total:0                    
~Output: Records:261717      Control Total:0                    
~.12/08/2015   17:56:29 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF BETWEEN(c_INVOICE_DATE,CTOD(_Data_Range_From,"DD/MM/YYYY"),CTOD(_Data_Range_To,"DD/MM/YYYY"))
~Input : Records:261717      Control Total:0                    
~Output: Records:261690      Control Total:0                    
~.12/08/2015   17:56:56 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:261690      Control Total:0                    
~Output: Records:261690      Control Total:0                    
~.12/08/2015   17:56:58 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:261690      Control Total:0                    
~Output: Records:252739      Control Total:0                    
~.12/08/2015   17:57:51 AP_Invoices SORT ON Vndr_ID c_Inv_Dt D IF GST_Amt <> 0.00 AND NOT ISBLANK(TMP_Vnd.Vndr_ID) AND (Inv_Dt > TMP_Vnd.ASIC_GST_effTo OR ISBLANK(DATE(TMP_Vnd.ASIC_GST_effFrom))) TO "Tmp_Files\TMP_VM010D" OPEN
~Input : Records:252739      Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:57:51 TMP_VM010D SUMMARIZE ON Vndr_Site_ID SUBTOTAL GST_Amt Inv_Amt TO "Results\VM010D_DeReg_GST_Sum.FIL" OPEN PRESORT
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/08/2015   17:58:08 VM010D_DeReg_GST_Sum IF FILESIZE("Results\VM010D_DeReg_GST_Sum.FIL")>=0 EXTRACT FIELDS ALL TO HIST1_VM010D_DeReg_GST_Sum
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
[LASTVIEW] "Default_View"
^INDEX    ACLQSTMP2                          HIST1_VM001_Dup_Vnd_BankAcc      "" "ACLQSTMP2.INX" 
*INDEX ON AP_VENDORMASTER_ALL_FMT.C_SITE_CREATION_DATE D TO "ACLQSTMP2"
^BATCH    VM001_Dup_Vnd_BankAcc              
[PARENT_FOLDER_ID] 1340167398
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Vendor Master File Exception Tests
COMM *** VM001. Identify Duplicate Vendors by Bank Account Details
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_VMF_BK")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_VMF_BK")="U" DO AA002_Variable_Setting
IF FTYPE("%trg_VMF_BK%")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF_BK%.FIL")<=0 Errmsg=Errmsg+" VM001"
IF FTYPE("%trg_VMF_BK%")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF_BK%.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="VM001"

OPEN VMF_BnkAcc

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

DEFINE RELATION Vndr_Site_ID WITH VMF_Vnd_Master_File INDEX IDX_VndrSiteID

EXTRACT RECORD IF VMF_Vnd_Master_File.Vndr_Sts="A"  AND UPPER(ALLTRIM(VMF_Vnd_Master_File.Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(VMF_Vnd_Master_File.Vndr_Typ)) <> "GRANT"  TO "%fld_Tmps%TMP_BnkAcc" OPEN

DELETE FIELD c_Bank OK
DEFINE FIELD c_Bank COMPUTED ALLTRIM(INCLUDE(BSB,"0123456789"))+ALLTRIM(INCLUDE(Bnk_Acc_Num,"0123456789"))

DELETE FIELD Bnk_KEY OK
DEFINE FIELD Bnk_KEY COMPUTED ALLTRIM(Vndr_Site_ID)+ALLTRIM(c_Bank)

INDEX ON Bnk_KEY TO IDX_VMF_BnkAcc_Bnk_KEY

COMMENT Fine for ACL 11
SUMMARIZE ON Vndr_ID c_Bank OTHER Vndr_Site_ID Bnk_KEY IF LENGTH(ALLTRIM(c_Bank))>3 AND VALUE(c_Bank,0)<>0 TO "%fld_Tmps%TMP1.FIL" OPEN PRESORT

INDEX ON Bnk_KEY TO IDX_TMP1_Bnk_KEY
DUPLICATES ON c_Bank OTHER Vndr_Site_ID c_Bank Bnk_KEY PRESORT OPEN TO "%fld_Tmps%TMP2.FIL"

DELETE FIELD DUP_KEY OK
DEFINE FIELD DUP_KEY COMPUTED ALLTRIM(c_Bank)

DEFINE RELATION Bnk_KEY WITH TMP_BnkAcc INDEX IDX_VMF_BnkAcc_Bnk_KEY

EXTRACT FIELDS DUP_KEY Bnk_KEY Vndr_Site_ID TMP_BnkAcc.Vndr_ID TMP_BnkAcc.BSB TMP_BnkAcc.Bnk_Acc_Num TMP_BnkAcc.BSB_NAME TMP_BnkAcc.Bnk_Acc_Name IF NOT ISBLANK(TMP_BnkAcc.Bnk_KEY) TO "%fld_Tmps%TMP3" OPEN

DEFINE RELATION Vndr_Site_ID WITH VMF_Vnd_Master_File INDEX IDX_VndrSiteID

COMM will fail if Max_Inv_Dt (listed in v_flds_VMF) is not there
EXTRACT FIELDS %v_flds_VMF% TMP3.DUP_KEY TMP3.DUP_KEY TMP3.Bnk_KEY Vndr_Site_ID TMP3.Vndr_ID TMP3.BSB TMP3.Bnk_Acc_Num  TMP3.BSB_NAME  TMP3.Bnk_Acc_Name IF NOT ISBLANK(TMP3.Vndr_Site_ID) AND NOT ISBLANK(VMF_Vnd_Master_File.Vndr_Site_ID) AND VMF_Vnd_Master_File.Vndr_Sts="A" TO "%fld_Tmps%TMP4" OPEN

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+"~"+ALLTRIM(DUP_KEY),1,85)

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
v_DUP_KEY="DUP_KEY"
v_Filter=""
IF v_Exc_History =T DO AE001_Dup_History
IF v_Chk_CCM=T DO AE006_Dup_CCM
COMM *** End ***

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP1" IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT" OPEN

COMM *** Identify the same or difference of the clean Vendor Number on the same dup ***
DUPLICATES ON DUP_KEY c_Vndr_ID OTHER Vndr_Site_ID Vndr_ID PRESORT OPEN TO "%fld_Tmps%TMP5.FIL"

INDEX ON DUP_KEY TO IDX_TMP5_DUP_KEY

OPEN TMP1
DEFINE RELATION DUP_KEY WITH TMP5 INDEX IDX_TMP5_DUP_KEY

DELETE FIELD Vndr_Same_Diff OK
DEFINE FIELD Vndr_Same_Diff COMPUTED 

"Y" IF DUP_KEY=TMP5.DUP_KEY
"N"

COMM *** Put the dup with difference clean Vendor Number on the Top of the report ***
DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_Same_Diff)+"~"+ALLTRIM(DUP_KEY)+"~"+ALLTRIM(Vndr_ID),1,40) 

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Vndr_ID_Same_Diff BSB Bnk_Acc_Num Vndr_ID"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "VM001. Identify Duplicate Vendors by Bank Account"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "H"

SORT ON SORT_KEY TO "%fld_Tmps%TMP6" OPEN

comm exclude vendor type foxbounty 27/7/2015
SET FOLDER /%fld_Results%

EXTRACT FIELDS ALL TO "%fld_Results%VM001_Dup_Vnd_BankAcc" OPEN

DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum INDEX IDX_AP_Sum_VndrID

OPEN "%fld_Workings%%trg_VMF_Bk%"
DELETE FIELD cVndrSiteVndrID OK
COMM
DEFINE FIELD cVndrSiteVndrID           COMPUTED  ALLTRIM(Vndr_Site_ID)+'~'+ALLTRIM(Vndr_ID) + '~' + ALLTRIM(Bnk_Acc_Num)


DEFINE FIELD cVndrSiteVndrID           COMPUTED  SUBSTR(ALLTRIM(Vndr_Site_ID),1,20)
INDEX ON cVndrSiteVndrID TO IDX_BnkAcc

SET FOLDER /%fld_Workings%
OPEN "%fld_Results%VM001_Dup_Vnd_BankAcc" 
DELETE FIELD cVndrSiteVndrID OK
COMM
DEFINE FIELD cVndrSiteVndrID           COMPUTED  ALLTRIM(Vndr_Site_ID)+'~'+ALLTRIM(Vndr_ID) + '~' + ALLTRIM(Bnk_Acc_Num)

DEFINE FIELD cVndrSiteVndrID           COMPUTED  SUBSTR(ALLTRIM(Vndr_Site_ID),1,20)
DEFINE RELATION cVndrSiteVndrID  WITH VMF_BnkAcc INDEX IDX_BnkAcc

OPEN "%fld_Results%VM001_Dup_Vnd_BankAcc" 
DELETE FIELD c_VALID_REC OK

DEFINE FIELD c_VALID COMPUTED
c_VALID 
1 IF VMF_BnkAcc.Dt_Field2 = `19000101` AND VMF_BnkAcc.Dt_Field1 <= _RptRunDate
1 IF VMF_BnkAcc.Dt_Field2 >= _RptRunDate AND VMF_BnkAcc.Dt_Field1 <= _RptRunDate
0

SET FILTER c_VALID = 1

SET FOLDER /%fld_Results%
COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    VM002_Dup_Vnd_ABN                  
[PARENT_FOLDER_ID] 1340167398
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Vendor Master File Exception Tests
COMM *** VM002. Identify Duplicate Vendors by Vendor ABN Number
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_VMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_VMF")="U" DO AA002_Variable_Setting
IF FTYPE("%trg_VMF%")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF%.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
v_TestNo="VM002"

OPEN VMF_Vnd_Master_File

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

SET FOLDER /%fld_Tmps%
COMMENT Fine for ACL 11
SUMMARIZE ON ABN_CLN Vndr_ID OTHER %v_flds_VMF1% IF Vndr_Sts="A" AND LENGTH(ALLTRIM(ABN_CLN))>1 AND  UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT" TO "%fld_Tmps%TMP10.FIL" OPEN PRESORT

DUPLICATES ON ABN_CLN OTHER %v_flds_VMF1% PRESORT OPEN TO "%fld_Tmps%TMP1.FIL"
DELETE FIELD DUP_KEY OK
DEFINE FIELD DUP_KEY COMPUTED ALLTRIM(ABN_CLN)

COMM *** Begin Clean Dup Bank Acc exists in dup Address ***
EXTRACT FIELDS Vndr_ID FIRST 0 TO "%fld_Tmps%TMP2"

IF FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil")>=0 AND (FILESIZE("%fld_History%VM001_History.fil") >0 AND FTYPE("VM001_History")="y") OPEN VM001_History
IF FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil")>=0 AND (FILESIZE("%fld_History%VM001_History.fil") <=0 OR FTYPE("VM001_History")<>"y") OPEN VM001_Dup_Vnd_BankAcc
IF FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil")>=0 AND (FTYPE("VM001_History")="y" OR FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil")>=0) EXTRACT FIELDS Vndr_ID TO "%fld_Tmps%TMP2" APPEND

OPEN TMP2
INDEX ON Vndr_ID TO IDX_VND_DUP_A

OPEN TMP1
DEFINE RELATION Vndr_ID WITH TMP2 INDEX IDX_VND_DUP_A

SUMMARIZE ON DUP_KEY IF Vndr_ID  <> TMP2.Vndr_ID  TO "%fld_Tmps%TMP3.FIL" OPEN PRESORT

OPEN TMP3
INDEX ON DUP_KEY TO IDX_TMP3_Dup_KEY

OPEN TMP1
DEFINE RELATION DUP_KEY WITH TMP3 INDEX IDX_TMP3_Dup_KEY

EXTRACT FIELDS ALL IF NOT ISBLANK(TMP3.DUP_KEY) TO "%fld_Tmps%TMP4" OPEN
COMM *** End clean***


DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+"~"+ALLTRIM(DUP_KEY),1,85)

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
v_DUP_KEY="DUP_KEY"
v_Filter=""
IF v_Exc_History =T DO AE001_Dup_History
IF v_Chk_CCM=T DO AE006_Dup_CCM
COMM *** End ***

COMM exclude vendor type foxbounty 27/7/2015
EXTRACT FIELDS ALL TO "%fld_Tmps%TMP1" IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN

COMM *** Identify the same or difference of the clean Vendor Number on the same dup ***
DUPLICATES ON DUP_KEY c_Vndr_ID OTHER Vndr_Site_ID Vndr_ID PRESORT OPEN TO "%fld_Tmps%TMP5.FIL"

INDEX ON DUP_KEY TO IDX_TMP5_DUP_KEY

OPEN TMP1
DEFINE RELATION DUP_KEY WITH TMP5 INDEX IDX_TMP5_DUP_KEY

DELETE FIELD Vndr_Same_Diff OK
DEFINE FIELD Vndr_Same_Diff COMPUTED 

"Y" IF DUP_KEY=TMP5.DUP_KEY
"N"

COMM *** Put the dup with difference clean Vendor Number on the Top of the report ***
DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_Same_Diff)+"~"+ALLTRIM(DUP_KEY)+ALLTRIM(Vndr_ID) ,1,40)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Vndr_ID_Same_Diff ABN_CLN Vndr_ID"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "H"

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "VM002. Identify Duplicate Vendors by Vendor ABN Number"

SORT ON SORT_KEY TO "%fld_Tmps%TMP6" OPEN

SET FOLDER /%fld_Results%
EXTRACT FIELDS ALL TO "%fld_Results%VM002_Dup_Vnd_ABN" OPEN
DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum IDX_AP_Sum_VndrID

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^REPORT   Default_View                       VM001_History                    D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
Vndr_Site_ID         WIDTH 8 PICTURE ""
[LINE] 1
Co                   WIDTH 2 PICTURE ""
[LINE] 1
Vndr_ID              WIDTH 5 PICTURE ""
[LINE] 1
Vndr_Nme             WIDTH 35 PICTURE ""
[LINE] 1
ABN                  WIDTH 10 PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 6 PICTURE ""
[LINE] 1
Vndr_Typ             WIDTH 8 PICTURE ""
[LINE] 1
Vndr_Add_Typ         WIDTH 9 PICTURE ""
[LINE] 1
ADD1                 WIDTH 21 PICTURE ""
[LINE] 1
ADD2                 WIDTH 4 PICTURE ""
[LINE] 1
ADD3                 WIDTH 4 PICTURE ""
[LINE] 1
City                 WIDTH 12 PICTURE ""
[LINE] 1
State                WIDTH 4 PICTURE ""
[LINE] 1
Pcode                WIDTH 4 PICTURE ""
[LINE] 1
Cntry                WIDTH 4 PICTURE ""
[LINE] 1
TEL1                 WIDTH 8 PICTURE ""
[LINE] 1
TEL2                 WIDTH 3 PICTURE ""
[LINE] 1
TEL3                 WIDTH 3 PICTURE ""
[LINE] 1
FAX                  WIDTH 10 PICTURE ""
[LINE] 1
Email1               WIDTH 4 PICTURE ""
[LINE] 1
Email2               WIDTH 4 PICTURE ""
[LINE] 1
Pymnt_Trm            WIDTH 7 PICTURE ""
[LINE] 1
Created_Dt           WIDTH 8 PICTURE ""
[LINE] 1
Modf_Dt              WIDTH 6 PICTURE ""
[LINE] 1
Vndr_InvlDt          WIDTH 8 PICTURE ""
[LINE] 1
Cha_Field1           WIDTH 13 PICTURE ""
[LINE] 1
Cha_Field2           WIDTH 14 PICTURE ""
[LINE] 1
Cha_Field3           WIDTH 7 PICTURE ""
[LINE] 1
Cha_Field4           WIDTH 7 PICTURE ""
[LINE] 1
Cha_Field5           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field1           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field2           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field3           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field4           WIDTH 7 PICTURE ""
[LINE] 1
Num_Field5           WIDTH 7 PICTURE ""
[LINE] 1
Dt_Field1            WIDTH 6 PICTURE ""
[LINE] 1
Dt_Field2            WIDTH 8 PICTURE ""
[LINE] 1
Dt_Field3            WIDTH 6 PICTURE ""
[LINE] 1
ABN_CLN              WIDTH 9 PICTURE ""
[LINE] 1
Max_Inv_Dt           WIDTH 8 PICTURE ""
[LINE] 1
c_Vndr_ID            WIDTH 7 PICTURE ""
[LINE] 1
DUP_KEY              WIDTH 12 PICTURE ""
[LINE] 1
DUP_KEY2             WIDTH 12 PICTURE ""
[LINE] 1
Bnk_KEY              WIDTH 16 PICTURE ""
[LINE] 1
Vndr_Site_ID2        WIDTH 9 PICTURE ""
[LINE] 1
Vndr_ID2             WIDTH 6 PICTURE ""
[LINE] 1
BSB                  WIDTH 6 PICTURE ""
[LINE] 1
Bnk_Acc_Num          WIDTH 9 PICTURE ""
[LINE] 1
BSB_NAME             WIDTH 7 PICTURE ""
[LINE] 1
Bnk_Acc_Name         WIDTH 18 PICTURE ""
[LINE] 1
ID_KEY               WIDTH 17 PICTURE ""
^BATCH    VM003_Dup_Vnd_Add                  
[PARENT_FOLDER_ID] 1340167398
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Vendor Master File Exception Tests
COMM *** VM003. Identify Duplicate Vendors by Address Details
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_VMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_VMF")="U" DO AA002_Variable_Setting
IF FTYPE("%trg_VMF%")<>"y" OR FTYPE("%trg_VMF_Add%")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF_Add%.FIL")<=0 OR FILESIZE("%fld_Workings%%trg_VMF%.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%
v_TestNo="VM003"

OPEN VMF_Address

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

DEFINE RELATION Vndr_Site_ID WITH VMF_Vnd_Master_File INDEX IDX_VndrSiteID

EXTRACT FIELDS ALL IF VMF_Vnd_Master_File.Vndr_Sts="A" AND UPPER(ALLTRIM(VMF_Vnd_Master_File.Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(VMF_Vnd_Master_File.Vndr_Typ)) <> "GRANT"  TO "%fld_Tmps%TMP_Address" OPEN


DELETE FIELD Add_ID OK
DEFINE FIELD Add_ID COMPUTED ALLTRIM(STRING(RECNO(),20))

INDEX ON Add_ID TO IDX_TMP_Address_Add_ID

DELETE FIELD c_Pcode OK
DEFINE FIELD c_Pcode COMPUTED 

"" IF LENGTH(trim(Pcode))<2
ALLTRIM(INCLUDE(Pcode, "0123456789"))

DELETE FIELD c_Add1 OK
DEFINE FIELD c_Add1 COMPUTED

REPLACE(UPPER(Add1), "STREET", " ST ") IF FIND("STREET", UPPER(Add1))
REPLACE(UPPER(Add1), "ROAD", " RD ") IF FIND("ROAD", UPPER(Add1))
REPLACE(UPPER(Add1), "AVENUE", " AVE ") IF FIND("AVENUE", UPPER(Add1))
REPLACE(UPPER(Add1), "CRESCENT", " CRES ") IF FIND("CRESCENT", UPPER(Add1))
REPLACE(UPPER(Add1), "DRIVE", " DR ") IF FIND("DRIVE", UPPER(Add1))
REPLACE(UPPER(Add1), "COURT", " CRT ") IF FIND("COURT", UPPER(Add1))
REPLACE(UPPER(Add1), "CIRCUIT", " CCT ") IF FIND("CIRCUIT", UPPER(Add1))
REPLACE(UPPER(Add1), "PLACE", " PL ") IF FIND("PLACE", UPPER(Add1))
UPPER(Add1)

DELETE FIELD c_Add1F OK
DEFINE FIELD c_Add1F COMPUTED 

"PO" IF FIND(" BAG ", c_Add1) OR FIND(" BOX ", c_Add1)  
"ST" IF FIND("HIGHWAY", c_Add1) OR FIND(" WAY", c_Add1) OR FIND(" ST ", c_Add1) OR FIND(" RD ", c_Add1) OR FIND(" AVE ", c_Add1) OR FIND(" CRES ", c_Add1) OR FIND(" DR ", c_Add1) OR FIND(" CRT ", c_Add1) OR FIND(" CCT ",c_Add1) OR FIND(" PL ", c_Add1)
" "

DELETE FIELD c_Add2 OK
DEFINE FIELD c_Add2 COMPUTED

REPLACE(UPPER(Add2), "STREET", " ST ") IF FIND("STREET", UPPER(Add2))
REPLACE(UPPER(Add2), "ROAD", " RD ") IF FIND("ROAD", UPPER(Add2))
REPLACE(UPPER(Add2), "AVENUE", " AVE ") IF FIND("AVENUE", UPPER(Add2))
REPLACE(UPPER(Add2), "CRESCENT", " CRES ") IF FIND("CRESCENT", UPPER(Add2))
REPLACE(UPPER(Add2), "DRIVE", " DR ") IF FIND("DRIVE", UPPER(Add2))
REPLACE(UPPER(Add2), "COURT", " CRT ") IF FIND("COURT", UPPER(Add2))
REPLACE(UPPER(Add2), "CIRCUIT", " CCT ") IF FIND("CIRCUIT", UPPER(Add2))
REPLACE(UPPER(Add2), "PLACE", " PL ") IF FIND("PLACE", UPPER(Add2))
UPPER(Add2)

DELETE FIELD c_Add2F OK
DEFINE FIELD c_Add2F COMPUTED 

"PO" IF FIND(" BAG ", c_Add2) OR FIND(" BOX ", c_Add2)  
"ST" IF FIND("HIGHWAY", c_Add2) OR FIND(" WAY", c_Add2) OR FIND(" ST ", c_Add2) OR FIND(" RD ", c_Add2) OR FIND(" AVE ", c_Add2) OR FIND(" CRES ", c_Add2) OR FIND(" DR ", c_Add2) OR FIND(" CRT ", c_Add2) OR FIND(" CCT ",c_Add2) OR FIND(" PL ", c_Add2)
" "

DELETE FIELD c_Add3 OK
DEFINE FIELD c_Add3 COMPUTED

REPLACE(UPPER(Add3), "STREET", " ST ") IF FIND("STREET", UPPER(Add3))
REPLACE(UPPER(Add3), "ROAD", " RD ") IF FIND("ROAD", UPPER(Add3))
REPLACE(UPPER(Add3), "AVENUE", " AVE ") IF FIND("AVENUE", UPPER(Add3))
REPLACE(UPPER(Add3), "CRESCENT", " CRES ") IF FIND("CRESCENT", UPPER(Add3))
REPLACE(UPPER(Add3), "DRIVE", " DR ") IF FIND("DRIVE", UPPER(Add3))
REPLACE(UPPER(Add3), "COURT", " CRT ") IF FIND("COURT", UPPER(Add3))
REPLACE(UPPER(Add3), "CIRCUIT", " CCT ") IF FIND("CIRCUIT", UPPER(Add3))
REPLACE(UPPER(Add3), "PLACE", " PL ") IF FIND("PLACE", UPPER(Add3))
UPPER(Add3)

DELETE FIELD c_Add3F OK
DEFINE FIELD c_Add3F COMPUTED 

"PO" IF FIND(" BAG ", c_Add3) OR FIND(" BOX ", c_Add3)  
"ST" IF FIND("HIGHWAY", c_Add3) OR FIND(" WAY", c_Add3) OR FIND(" ST ", c_Add3) OR FIND(" RD ", c_Add3) OR FIND(" AVE ", c_Add3) OR FIND(" CRES ", c_Add3) OR FIND(" DR ", c_Add3) OR FIND(" CRT ", c_Add3) OR FIND(" CCT ",c_Add3) OR FIND(" PL ", c_Add3)
" "

EXTRACT FIELDS Add_ID Vndr_Site_ID Vndr_ID c_Pcode SUBSTR(INCLUDE(c_Add1, "0123456789"),1,50) AS "Address" "PO" AS "Type" IF  c_Add1F="PO" TO "%fld_Tmps%TMP1" OPEN
OPEN TMP_Address
EXTRACT FIELDS Add_ID Vndr_Site_ID Vndr_ID c_Pcode SUBSTR(INCLUDE(c_Add2, "0123456789"),1,50) AS "Address" "PO" AS "Type" IF c_Add2F="PO" TO "%fld_Tmps%TMP1" OPEN APPEND
OPEN TMP_Address
EXTRACT FIELDS Add_ID Vndr_Site_ID Vndr_ID c_Pcode SUBSTR(INCLUDE(c_Add3, "0123456789"),1,50) AS "Address" "PO" AS "Type" IF c_Add3F="PO" TO "%fld_Tmps%TMP1" OPEN APPEND

OPEN TMP_Address
EXTRACT FIELDS Add_ID Vndr_Site_ID Vndr_ID c_Pcode SUBSTR(INCLUDE(c_Add1 +c_Add2+c_Add3,"QWERTYUIOPASDFGHJKLZXCVBNM0123456789"),1,50) AS "Address" "ST" AS "Type" IF c_Add1F<>"PO" AND c_Add2F<>"PO" AND c_Add3F<>"PO" TO "%fld_Tmps%TMP1" OPEN APPEND

OPEN TMP1

DELETE FIELD Add_KEY OK
DEFINE FIELD Add_KEY COMPUTED ALLTRIM(Vndr_Site_ID)+ALLTRIM(c_Pcode) + ALLTRIM(Address)

INDEX ON Add_KEY TO IDX_TMP1_Add_KEY

COMMENT Fine for ACL 11
SUMMARIZE ON Add_KEY Vndr_ID c_Pcode Address Type OTHER Vndr_Site_ID IF LENGTH(ALLTRIM(Address))>0 TO "%fld_Tmps%SUM_Address.FIL" OPEN PRESORT

OPEN SUM_Address
DUPLICATES ON Address c_Pcode OTHER Type Vndr_Site_ID Vndr_ID Address c_Pcode PRESORT IF Type = "PO" AND ALLTRIM(Address)<>"" OPEN TO "%fld_Tmps%TMP2.FIL"
OPEN SUM_Address
DUPLICATES ON Address c_Pcode OTHER Type Vndr_Site_ID Vndr_ID Address c_Pcode PRESORT IF Type <> "PO" AND ALLTRIM(Address)<>"" APPEND OPEN TO "%fld_Tmps%TMP2.FIL"

DELETE FIELD DUP_KEY OK
DEFINE FIELD DUP_KEY COMPUTED ALLTRIM(c_Pcode)+ALLTRIM(Address) 

DELETE FIELD Add_KEY OK
DEFINE FIELD Add_KEY COMPUTED ALLTRIM(Vndr_Site_ID)+ALLTRIM(c_Pcode) + ALLTRIM(Address)

DEFINE RELATION Add_KEY WITH TMP1 INDEX IDX_TMP1_Add_KEY

EXTRACT FIELDS DUP_KEY Add_KEY Vndr_Site_ID Vndr_ID TMP1.Add_ID IF NOT ISBLANK(TMP1.Add_KEY) TO "%fld_Tmps%TMP3" OPEN
DEFINE RELATION Add_ID WITH TMP_Address INDEX IDX_TMP_Address_Add_ID

EXTRACT FIELDS DUP_KEY Add_KEY Vndr_Site_ID Vndr_ID TMP_Address.Vndr_Add_Typ TMP_Address.ADD1 TMP_Address.ADD2 TMP_Address.ADD3 TMP_Address.City TMP_Address.State TMP_Address.Pcode TMP_Address.Cntry TO "%fld_Tmps%TMP7" OPEN 

COMM *** Begin Clean Dup Bank Acc exists in dup Address ***
EXTRACT FIELDS Vndr_ID FIRST 0 TO "%fld_Tmps%TMP_Dups"

IF FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil")>=0 AND (FILESIZE("%fld_History%VM001_History.fil") >0 AND FTYPE("VM001_History")="y") OPEN VM001_History
IF FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil")>=0 AND (FILESIZE("%fld_History%VM001_History.fil") <=0 OR FTYPE("VM001_History")<>"y") OPEN VM001_Dup_Vnd_BankAcc
IF FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil")>=0 AND (FTYPE("VM001_History")="y" OR FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil")>=0) EXTRACT FIELDS Vndr_ID TO "%fld_Tmps%TMP_Dups" APPEND

IF FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil")>=0 AND (FILESIZE("%fld_History%VM002_History.fil") >0 AND FTYPE("VM002_History")="y") OPEN VM002_History
IF FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil")>=0 AND (FILESIZE("%fld_History%VM002_History.fil") <=0 OR FTYPE("VM002_History")<>"y") OPEN VM002_Dup_Vnd_ABN
IF FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil")>=0 AND (FTYPE("VM002_History")="y" OR FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil")>=0) EXTRACT FIELDS Vndr_ID TO "%fld_Tmps%TMP_Dups" APPEND

OPEN TMP_Dups
INDEX ON Vndr_ID TO IDX_VND_DUP_A

OPEN TMP7
DEFINE RELATION Vndr_ID WITH TMP_Dups INDEX IDX_VND_DUP_A

SUMMARIZE ON DUP_KEY IF Vndr_ID  <> TMP_Dups.Vndr_ID  TO "%fld_Tmps%TMP8.FIL" OPEN PRESORT

OPEN TMP8
INDEX ON DUP_KEY TO IDX_TMP8_Dup_KEY

OPEN TMP7
DEFINE RELATION DUP_KEY WITH TMP8 INDEX IDX_TMP8_Dup_KEY

EXTRACT FIELDS ALL IF NOT ISBLANK(TMP8.DUP_KEY) TO "%fld_Tmps%TMP9" OPEN
COMM *** End clean***

DEFINE RELATION Vndr_Site_ID WITH VMF_Vnd_Master_File INDEX IDX_VndrSiteID

EXTRACT FIELDS %v_flds_VMF% TMP9.DUP_KEY TMP9.Add_KEY TMP9.Vndr_Add_Typ AS 'Dup_Vndr_Add_Typ' TMP9.ADD1 AS 'Dup_ADD1' TMP9.ADD2 AS 'Dup_ADD2' TMP9.ADD3 AS 'Dup_ADD3' TMP9.City AS 'Dup_City' TMP9.State AS 'Dup_State' TMP9.Pcode AS 'Dup_Pcode' TMP9.Cntry AS 'Dup_Cntry' IF NOT ISBLANK(TMP9.Vndr_Site_ID) AND NOT ISBLANK(VMF_Vnd_Master_File.Vndr_Site_ID) TO "%fld_Tmps%TMP4" OPEN

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+"~"+ALLTRIM(DUP_KEY),1,85)

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
v_DUP_KEY="DUP_KEY"
v_Filter=""
IF v_Exc_History =T DO AE001_Dup_History
IF v_Chk_CCM=T DO AE006_Dup_CCM
COMM *** End ***

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP1" OPEN

COMM *** Identify the same or difference of the clean Vendor Number on the same dup ***
DUPLICATES ON DUP_KEY c_Vndr_ID OTHER Vndr_Site_ID Vndr_ID PRESORT OPEN TO "%fld_Tmps%TMP5.FIL"

INDEX ON DUP_KEY TO IDX_TMP5_DUP_KEY

OPEN TMP1
DEFINE RELATION DUP_KEY WITH TMP5 INDEX IDX_TMP5_DUP_KEY

DELETE FIELD Vndr_Same_Diff OK
DEFINE FIELD Vndr_Same_Diff COMPUTED 

"Y" IF DUP_KEY=TMP5.DUP_KEY
"N"

COMM *** Put the dup with difference clean Vendor Number on the Top of the report ***
DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_Same_Diff)+ALLTRIM(DUP_KEY)+ALLTRIM(Vndr_Site_ID),1,60) 

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Vndr_ID_Same_Diff PCode Address_CLN Vndr_Site_ID"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "VM003. Identify Duplicate Vendors by Address"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

SORT ON SORT_KEY TO "%fld_Tmps%TMP6" OPEN

COMM *** Finalize the results ***
SET FOLDER /%fld_Results%
COMM EXCLUDE VENDOR TYPE FOXBOUNTY 27/7/2015
EXTRACT FIELDS ALL TO "%fld_Results%VM003_Dup_Vnd_Add"  IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN
DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum INDEX IDX_AP_Sum_VndrID

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^BATCH    VM005_Dup_Vnd_Name                 
[PARENT_FOLDER_ID] 1340167398
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Vendor Master File Exception Tests
COMM *** VM005. Identify Duplicate Vendors by Name (cleaned and fuzzy)
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_VMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_VMF")="U" DO AA002_Variable_Setting
IF FTYPE("%trg_VMF%")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF%.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER  /%fld_Tmps%
v_TestNo="VM005"

OPEN VMF_Vnd_Master_File

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

DELETE FIELD c_Name1 OK
DEFINE FIELD c_Name1 COMPUTED INCLUDE(UPPER(Vndr_Nme)," ABCDEFGHIJKLMNOPQRSTUVWXYZ")
DELETE FIELD c_Name2 OK
DEFINE FIELD c_Name2 COMPUTED REPLACE(c_Name1+" "," LTD "," ")
DELETE FIELD c_Name3 OK
DEFINE FIELD c_Name3 COMPUTED REPLACE(c_Name2+ " "," CO "," ")
DELETE FIELD c_Name OK
DEFINE FIELD c_Name COMPUTED ALLTRIM(REPLACE(c_Name3+ " "," PL "," "))

COMMENT Fine for ACL 11
SUMMARIZE ON Vndr_ID c_Name OTHER %v_flds_VMF1% IF Vndr_Sts="A" AND c_Name<>" " TO "%fld_Tmps%TMP2.FIL" OPEN PRESORT

DUPLICATES ON c_Name OTHER %v_flds_VMF1% PRESORT OPEN TO "%fld_Tmps%TMP1.FIL"

DELETE FIELD DUP_KEY OK
DEFINE FIELD DUP_KEY COMPUTED ALLTRIM(c_Name)

COMM *** Begin Clean Dup Bank Acc exists in dup Address ***
EXTRACT Vndr_ID FIRST 0 TO "%fld_Tmps%TMP_Dups"

IF FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil")>=0 AND (FILESIZE("%fld_History%VM001_History.fil") >0 AND FTYPE("VM001_History")="y") OPEN VM001_History
IF FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil")>=0 AND (FILESIZE("%fld_History%VM001_History.fil") <=0 OR FTYPE("VM001_History")<>"y") OPEN VM001_Dup_Vnd_BankAcc
IF FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil")>=0 AND (FTYPE("VM001_History")="y" OR FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil")>=0) EXTRACT Vndr_ID TO "%fld_Tmps%TMP_Dups" APPEND

IF FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil")>=0 AND (FILESIZE("%fld_History%VM002_History.fil") >0 AND FTYPE("VM002_History")="y") OPEN VM002_History
IF FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil")>=0 AND (FILESIZE("%fld_History%VM002_History.fil") <=0 OR FTYPE("VM002_History")<>"y") OPEN VM002_Dup_Vnd_ABN
IF FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil")>=0 AND (FTYPE("VM002_History")="y" OR FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil")>=0) EXTRACT Vndr_ID TO "%fld_Tmps%TMP_Dups" APPEND

IF FILESIZE("%fld_Results%VM003_Dup_Vnd_Add.fil")>=0 AND (FILESIZE("%fld_History%VM003_History.fil") >0 AND FTYPE("VM003_History")="y") OPEN VM003_History
IF FILESIZE("%fld_Results%VM003_Dup_Vnd_Add.fil")>=0 AND (FILESIZE("%fld_History%VM003_History.fil") <=0 OR FTYPE("VM003_History")<>"y") OPEN VM003_Dup_Vnd_Add
IF FILESIZE("%fld_Results%VM003_Dup_Vnd_Add.fil")>=0 AND (FTYPE("VM003_History")="y" OR FILESIZE("%fld_Results%VM003_Dup_Vnd_Add.fil")>=0) EXTRACT Vndr_ID TO "%fld_Tmps%TMP_Dups" APPEND

IF FILESIZE("%fld_Results%VM004_Dup_Vnd_Tel.fil")>=0 AND (FILESIZE("%fld_History%VM004_History.fil") >0 AND FTYPE("VM004_History")="y") OPEN VM004_History
IF FILESIZE("%fld_Results%VM004_Dup_Vnd_Tel.fil")>=0 AND (FILESIZE("%fld_History%VM004_History.fil") <=0 OR FTYPE("VM004_History")<>"y") OPEN VM004_Dup_Vnd_Tel
IF FILESIZE("%fld_Results%VM004_Dup_Vnd_Tel.fil")>=0 AND (FTYPE("VM004_History")="y" OR FILESIZE("%fld_Results%VM004_Dup_Vnd_Tel.fil")>=0) EXTRACT Vndr_ID TO "%fld_Tmps%TMP_Dups" APPEND

OPEN TMP_Dups
INDEX ON Vndr_ID TO IDX_VND_DUP_A

OPEN TMP1
DEFINE RELATION Vndr_ID WITH TMP_Dups INDEX IDX_VND_DUP_A

SUMMARIZE ON DUP_KEY IF Vndr_ID  <> TMP_Dups.Vndr_ID  TO "%fld_Tmps%TMP2.FIL" OPEN PRESORT

OPEN TMP2
INDEX ON DUP_KEY TO IDX_TMP2_Dup_KEY

OPEN TMP1
DEFINE RELATION DUP_KEY WITH TMP2 INDEX IDX_TMP2_Dup_KEY

EXTRACT FIELDS ALL IF DUP_KEY=TMP2.DUP_KEY TO "%fld_Tmps%TMP4" OPEN
COMM *** End clean***

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+"~"+ALLTRIM(DUP_KEY),1,85)

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
v_DUP_KEY="DUP_KEY"
v_Filter=""
IF v_Exc_History =T DO AE001_Dup_History
IF v_Chk_CCM=T DO AE006_Dup_CCM
COMM *** End ***
EXTRACT FIELDS ALL TO "%fld_Tmps%TMP1" IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN

COMM *** Identify the same or difference of the clean Vendor Number on the same dup ***
DUPLICATES ON DUP_KEY c_Vndr_ID OTHER Vndr_Site_ID Vndr_ID PRESORT OPEN TO "%fld_Tmps%TMP5.FIL"

INDEX ON DUP_KEY TO IDX_TMP5_DUP_KEY

OPEN TMP1
DEFINE RELATION DUP_KEY WITH TMP5 INDEX IDX_TMP5_DUP_KEY

DELETE FIELD Vndr_Same_Diff OK
DEFINE FIELD Vndr_Same_Diff COMPUTED 

"Y" IF DUP_KEY=TMP5.DUP_KEY
"N"

COMM *** Put the dup with difference clean Vendor Number on the Top of the report ***
DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_Same_Diff)+"~"+ALLTRIM(DUP_KEY)+"~"+ALLTRIM(Vndr_Site_ID) ,1,60)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Vndr_ID_Same_Diff Name_CLN Vndr_Site_ID"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "VM005. Identify Duplicate Vendors by Vendor Name"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "L"

SORT ON SORT_KEY TO "%fld_Tmps%TMP6" OPEN

COMM *** Finalize the results ***
SET FOLDER /%fld_Results%
COMM EXCLUDE VENDOR TYPE FOXBOUNTY 27/7/2015
EXTRACT FIELDS ALL TO "%fld_Results%VM005_Dup_Vnd_Name" IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN
DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum IDX_AP_Sum_VndrID

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON

^FORMAT   GreyList_VM010                     GreyList_VM010                   "Working_Files" "GreyList_VM010.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1427252735
~.21/08/2015   04:32:37 TMP2 EXTRACT FIELDS SUBSTR(ALLTRIM(F1),1,20) AS 'Vndr_ID' SUBSTR(ALLTRIM(F2),1,60) AS 'Vndr_Name' IF NOT ISBLANK(F1) AND RECNO()>1 TO "Working_Files\GreyList_VM010.fil"
~Input : Records:23          Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_GreyList_VM010_Vndr_ID         GreyList_VM010                   "" "IDX_GreyList_VM010_Vndr_ID.INX" 
*INDEX ON VNDR_ID TO IDX_GREYLIST_VM010_VNDR_ID
^INDEX    IDX_VM010_History_ID_KEY           VM010_History                    "" "IDX_VM010_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_VM010_HISTORY_ID_KEY
^FORMAT   VM010_History                      VM010_History                    "History" "VM010_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.12/08/2015   18:15:54 TMP1 IF v_NewFlag = 1 EXTRACT FIELDS ALL SUBSTR("E:\Data\VendorMasterfile_20150806.txt",1,50) AS 'File_Name' TO  AP_VendorMaster_ALL
~Input : Records:64526       Control Total:0                    
~Output: Records:64526       Control Total:0                    
~.14/08/2015   11:07:10 AP_VendorMaster_ALL EXTRACT FIELDS ALL 'R11' AS 'SourceFlag' TO "AP_VendorMaster_ALL_FMT.FIL"  IF c_SITE_LAST_UPDATE_DATE>=CTOD(_Data_Range_From_VM,"DD/MM/YYYY") OR c_HEADER_LAST_UPDATE_DATE>=CTOD(_Data_Range_From_VM,"DD/MM/YYYY")
~Input : Records:64526       Control Total:0                    
~Output: Records:64526       Control Total:0                    
~.14/08/2015   11:07:24 AP_VendorMaster_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Co' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NAME),1,73))) AS 'Vndr_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ABN),1,20))) AS 'ABN' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_STATUS),1,1))) AS 'Vndr_Sts' CTOD('', 'DD/MM/YYYY') AS 'Vndr_InvlDt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_TYPE),1,11))) AS 'Vndr_Typ' BLANKS(15) AS 'Vndr_Add_Typ' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ADDRESS),1,125))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(CITY),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(STATE),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(POSTCODE),1,12))) AS 'Pcode' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(COUNTRY),1,61))) AS 'Cntry' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Tel),1,21))) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Fax),1,21))) AS 'FAX' BLANKS(60) AS 'Email1' BLANKS(60) AS 'Email2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_METHOD),1,21))) AS 'Pymnt_Trm' c_SITE_CREATION_DATE AS 'Created_Dt' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE),1,30))) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_REGISTRATION_STATUS),1,30))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(SourceFlag),1,3))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NUMBER),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' c_SITE_INACTIVE_DATE AS 'Dt_Field1' c_SITE_CREATION_DATE AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3'   TO "Working_Files\VMF_Vnd_Master_File.FIL"
~Input : Records:64526       Control Total:0                    
~Output: Records:64526       Control Total:0                    
~.14/08/2015   11:08:21 VMF_Vnd_Master_File EXTRACT FIELDS ALL ABN_ASIC.ASIC_entityStatusCode CTOD(ABN_ASIC.ASIC_entityStatusEF,"YYYY-MM-DD") AS "ASIC_entityStatusEF" CTOD(ABN_ASIC.ASIC_GST_effFrom,"YYYY-MM-DD") AS "ASIC_GST_effFrom" CTOD(ABN_ASIC.ASIC_GST_effTo,"YYYY-MM-DD") AS "ASIC_GST_effTo" ABN_ASIC.ASIC_entityDescription IF LENGTH(ALLTRIM(ABN_CLN))>1 AND Vndr_Sts="A" AND InvABN="F" AND (((ABN_ASIC.ASIC_entityStatusCode = "Active") AND ISBLANK(ABN_ASIC.ASIC_GST_effFrom)) OR ((ABN_ASIC.ASIC_entityStatusCode = "Active") AND NOT ISBLANK(ABN_ASIC.ASIC_GST_effTo))) TO "Tmp_Files\TMP1" OPEN
~Input : Records:64526       Control Total:0                    
~Output: Records:1282        Control Total:0                    
~.14/08/2015   11:08:21 TMP1 EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:1282        Control Total:0                    
~Output: Records:1282        Control Total:0                    
~.14/08/2015   11:08:21 TMP_GL EXTRACT FIELDS ALL IF Vndr_ID<> GreyList_VM010.Vndr_ID TO TMP_GL1 OPEN
~Input : Records:1282        Control Total:0                    
~Output: Records:1282        Control Total:0                    
~.14/08/2015   11:08:21 TMP_GL1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:1282        Control Total:0                    
~Output: Records:1282        Control Total:0                    
~.14/08/2015   11:08:21 TMP_Cur IF FTYPE("VM010_History")<>"y" OR FILESIZE("History\VM010_History.fil") <0 EXTRACT FIELDS ALL FIRST 0 TO "History\VM010_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.14/08/2015   11:08:21 TMP_Cur1 EXTRACT FIELDS Co Vndr_Site_ID Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_InvlDt Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 c_Vndr_ID ABN_CLN Max_Inv_Dt InvABN ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription ID_KEY TO "History\VM010_History"APPEND
~Input : Records:1282        Control Total:0                    
~Output: Records:1282        Control Total:0                    
~.17/08/2015   04:24:38 TMP_Cur1 EXTRACT FIELDS Co Vndr_Site_ID Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_InvlDt Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 c_Vndr_ID ABN_CLN Max_Inv_Dt InvABN ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription ID_KEY TO "History\VM010_History"APPEND
~Input : Records:3           Control Total:0                    
~Output: Records:3           Control Total:0                    
~.18/08/2015   04:26:53 TMP_Cur1 EXTRACT FIELDS Co Vndr_Site_ID Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_InvlDt Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 c_Vndr_ID ABN_CLN Max_Inv_Dt InvABN ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription ID_KEY TO "History\VM010_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/08/2015   04:26:38 TMP_Cur1 EXTRACT FIELDS Co Vndr_Site_ID Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_InvlDt Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 c_Vndr_ID ABN_CLN Max_Inv_Dt InvABN ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription ID_KEY TO "History\VM010_History"APPEND
~Input : Records:1           Control Total:0                    
~Output: Records:1           Control Total:0                    
~.20/08/2015   04:24:05 TMP_Cur1 EXTRACT FIELDS Co Vndr_Site_ID Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_InvlDt Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 c_Vndr_ID ABN_CLN Max_Inv_Dt InvABN ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription ID_KEY TO "History\VM010_History"APPEND
~Input : Records:1           Control Total:0                    
~Output: Records:1           Control Total:0                    
~.21/08/2015   04:32:37 TMP_Cur1 EXTRACT FIELDS Co Vndr_Site_ID Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_InvlDt Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 c_Vndr_ID ABN_CLN Max_Inv_Dt InvABN ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription ID_KEY TO "History\VM010_History"APPEND
~Input : Records:24          Control Total:0                    
~Output: Records:24          Control Total:0                    
^FORMAT   VM010D_DeReg_GST_Sum               VM010D_DeReg_GST_Sum             "Results" "VM010D_DeReg_GST_Sum.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.21/08/2015   04:02:17 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:14727       Control Total:0                    
~Output: Records:5847        Control Total:0                    
~.21/08/2015   04:02:17 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20150820.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:5847        Control Total:0                    
~Output: Records:5847        Control Total:0                    
~.21/08/2015   04:02:17 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:5847        Control Total:0                    
~Output: Records:5847        Control Total:0                    
~.21/08/2015   04:02:23 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:262544      Control Total:0                    
~Output: Records:257652      Control Total:0                    
~.21/08/2015   04:02:24 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:263499      Control Total:0                    
~Output: Records:263499      Control Total:0                    
~.21/08/2015   04:02:27 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:263499      Control Total:0                    
~Output: Records:263499      Control Total:0                    
~.21/08/2015   04:02:55 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:263499      Control Total:0                    
~Output: Records:263499      Control Total:0                    
~.21/08/2015   04:02:57 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:263499      Control Total:0                    
~Output: Records:254477      Control Total:0                    
~.21/08/2015   04:32:38 AP_Invoices SORT ON Vndr_ID c_Inv_Dt D IF GST_Amt <> 0.00 AND NOT ISBLANK(TMP_Vnd.Vndr_ID) AND (Inv_Dt > TMP_Vnd.ASIC_GST_effTo OR ISBLANK(DATE(TMP_Vnd.ASIC_GST_effFrom))) TO "Tmp_Files\TMP_VM010D" OPEN
~Input : Records:254477      Control Total:0                    
~Output: Records:0           Control Total:0                    
~.21/08/2015   04:32:38 TMP_VM010D SUMMARIZE ON Vndr_Site_ID SUBTOTAL GST_Amt Inv_Amt TO "Results\VM010D_DeReg_GST_Sum.FIL" OPEN PRESORT
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_VM010D_Sum_VndrSiteID          VM010D_DeReg_GST_Sum             "" "IDX_VM010D_Sum_VndrSiteID.INX" 
*INDEX ON VNDR_SITE_ID TO IDX_VM010D_SUM_VNDRSITEID
^INDEX    IDX_VM010_VndrSiteID               VM010_DeReg_GST                  "" "IDX_VM010_VndrSiteID.INX" 
*INDEX ON VNDR_SITE_ID TO IDX_VM010_VNDRSITEID
^FORMAT   VM010D_DeReg_GST                   VM010D_DeReg_GST                 "Results" "VM010D_DeReg_GST.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.21/08/2015   04:02:17 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:14727       Control Total:0                    
~Output: Records:5847        Control Total:0                    
~.21/08/2015   04:02:17 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20150820.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:5847        Control Total:0                    
~Output: Records:5847        Control Total:0                    
~.21/08/2015   04:02:17 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:5847        Control Total:0                    
~Output: Records:5847        Control Total:0                    
~.21/08/2015   04:02:23 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:262544      Control Total:0                    
~Output: Records:257652      Control Total:0                    
~.21/08/2015   04:02:24 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:263499      Control Total:0                    
~Output: Records:263499      Control Total:0                    
~.21/08/2015   04:02:27 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:263499      Control Total:0                    
~Output: Records:263499      Control Total:0                    
~.21/08/2015   04:02:55 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:263499      Control Total:0                    
~Output: Records:263499      Control Total:0                    
~.21/08/2015   04:02:57 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:263499      Control Total:0                    
~Output: Records:254477      Control Total:0                    
~.21/08/2015   04:32:38 AP_Invoices SORT ON Vndr_ID c_Inv_Dt D IF GST_Amt <> 0.00 AND NOT ISBLANK(TMP_Vnd.Vndr_ID) AND (Inv_Dt > TMP_Vnd.ASIC_GST_effTo OR ISBLANK(DATE(TMP_Vnd.ASIC_GST_effFrom))) TO "Tmp_Files\TMP_VM010D" OPEN
~Input : Records:254477      Control Total:0                    
~Output: Records:0           Control Total:0                    
~.21/08/2015   04:32:38 TMP_VM010D EXTRACT FIELDS VM010_DeReg_GST.ASIC_GST_effTo Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ Priority TEST_NAME RptRunDate Data_Range_Start_Date Data_Range_End_Date SORT_KEY SORT_KEY_Desc TO "Results\VM010D_DeReg_GST" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^BATCH    UU001_Export                       
[PARENT_FOLDER_ID] 1430796679
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Export Test Results into spesfic file format (e.g. Access, Excel, Text, Del and XML)
COMM *** Called by UA001_Export_Menu
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("TXT_Exp_filepath")="U" DO AA002_Variable_Setting
IF ISBLANK(TXT_Exp_filepath) TXT_Exp_filepath="Reports\"
IF LAST(ALLTRIM(TXT_Exp_filepath),1)<>"\" TXT_Exp_filepath=ALLTRIM(TXT_Exp_filepath)+"\"
IF FTYPE("TXT_AP014_Months")="U" DO AC002_Test_Var_Input

SET SAFETY OFF
SET ECHO ON

COMM For delimited files, define the separator and the qualifier on this line: IF (rad1=4) v_fileOpt       = "KEEPTITLE SEPARATOR TAB QUALIFIER ''"

IF (rad1=1) v_exporttype    = "ACCESS"
IF (rad1=1) v_fileext       = "MDB"
IF (rad1=1) v_fileOpt       = ""
IF (rad1=2) v_exporttype    = "EXCEL"
IF (rad1=2) v_fileext       = ""
IF (rad1=2) v_fileOpt       = ""
IF (rad1=3) v_exporttype    = "ASCII"
IF (rad1=3) v_fileext       = ""
IF (rad1=3) v_fileOpt       = "KEEPTITLE"
IF (rad1=4) v_exporttype    = "DELIMITED"
IF (rad1=4) v_fileext       = "DEL"
IF (rad1=4) v_fileOpt       = "KEEPTITLE SEPARATOR TAB"
IF (rad1=5) v_exporttype    = "XML"
IF (rad1=5) v_fileext       = "XML"
IF (rad1=5) v_fileOpt       = ""
IF (rad1=6) v_exporttype    = ""  
IF (rad1=6) v_fileext       = ""
IF (rad1=6) v_fileOpt       = ""
IF (rad1=6) v_EXPORT       = "EXTRACT"
IF (rad1<>6) v_EXPORT       = "EXPORT"
IF (rad1=6) v_Pre       = "RP_"
IF (rad1<>6) v_Pre       = ""
IF (rad1=6) SET FOLDER /%fld_Reports%
IF (rad1<>6) SET FOLDER /%fld_Tmps%

v_cmt="COMMENT"
v_if=""
IF rad1=5 AND v_AppCWM="" v_cmt=""
IF rad1=5 AND v_AppCWM="" v_if=" AND COUNT1>0 "

COMM *** Vendor Master File Tests Output***
v_Exp_Fields_VM001 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' BSB AS 'BSB' Bnk_Acc_Num AS 'Bnk_Acc_Num' Bnk_Acc_Name AS 'Bank Account Name' VMF_BnkAcc.Dt_Field1 VMF_BnkAcc.Dt_Field2 AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD(_Data_Range_From_VM,'DD/MM/YYYY') AS 'Data Range Start Date' CTOD(_Data_Range_To_VM,'DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"

COMM v_Exp_Fields_VM001 = " Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' BSB Bnk_Acc_Num AS 'Bank Account Number' Bnk_Acc_Name AS 'Bank Account Name' VMF_BnkAcc.Dt_Field1 AS 'Start_Date' VMF_BnkAcc.Dt_Field2 AS 'End_Date' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date' Cha_Field2 AS 'Gst Registration Status' TEL1 AS 'Phone' FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System' TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_VM002 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD(_Data_Range_From,'DD/MM/YYYY') AS 'Data Range Start Date' CTOD(_Data_Range_To_VM,'DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM002= "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN Vndr_Sts AS 'Vendor Status' Vndr_Typ AS 'Vendor Type' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date'  TEL1 AS 'Phone'  FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System' TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_VM003 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD(_Data_Range_From_VM,'DD/MM/YYYY') AS 'Data Range Start Date' CTOD(_Data_Range_To_VM,'DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM003 = "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status'  ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' TEL1 AS 'Phone'  FAX AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date' Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System'  TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_VM004 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' TEL1 AS 'Phone' FAX AS 'Fax' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD(_Data_Range_From_VM,'DD/MM/YYYY') AS 'Data Range Start Date' CTOD(_Data_Range_To_VM,'DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM004 = "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status'  TEL1 AS 'Phone'  FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode Cntry AS 'Country'  AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System' TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_VM005 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD(_Data_Range_From_VM,'DD/MM/YYYY') AS 'Data Range Start Date' CTOD(_Data_Range_To_VM,'DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM005 = "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date'  TEL1 AS 'Phone' FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System'  TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

COMM *** Missing Details ABN/Address/Tel ***
v_Exp_Fields_VM006 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN Cha_Field2 AS 'GST Status' Vndr_Typ AS 'Vendor Type' Pymnt_Trm  AS 'Payment Method' VMF_BnkAcc.BSB VMF_BnkAcc.Bnk_Acc_Num AS 'Bank Account Number' VMF_BnkAcc.Bnk_Acc_Name AS 'Bank Account Name' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD(_Data_Range_From_VM,'DD/MM/YYYY') AS 'Data Range Start Date' CTOD(_Data_Range_To_VM,'DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_VM006 = "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN AS 'ABN' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Inv_Amt AS 'Total Invoice Amount' GST_AMT AS 'Total GST Amount' COUNT AS 'Total Trans Num'  DATE(Max_Inv_Dt) AS 'Last Invoice Date' TEL1 AS 'Phone' FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode Cntry AS 'Country'  Pymnt_Trm AS 'Payment Method' Co AS 'Company' DATE(Modf_Dt) AS 'Modified Date' Priority Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System'  TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"

COMM *** Missing Details ABN/Address/Tel Invoice Details***

v_Exp_Fields_VM006D = "VM006_Mis_Details.Cha_Field1 AS 'Vendor Site'  VM006_Mis_Details.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status'  ' '+ Inv_No AS 'Invoice Number' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Doc_Typ AS 'Document Type' Descrp AS 'Description' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID'  isPaid AS 'Paid' Vchr_ID AS 'Voucher Number' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM *** Invalid ABN Format ***
v_Exp_Fields_VM007 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD(_Data_Range_From_VM,'DD/MM/YYYY') AS 'Data Range Start Date' CTOD(_Data_Range_To_VM,'DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"

COMM v_Exp_Fields_VM007 = "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN AS 'ABN' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Inv_Amt AS 'Total Invoice Amount' GST_AMT AS 'Total GST Amount' COUNT AS 'Total Trans Num'  DATE(Max_Inv_Dt) AS 'Last Invoice Date' TEL1 AS 'Phone' FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode Cntry AS 'Country'  Pymnt_Trm AS 'Payment Method' Co AS 'Company' DATE(Modf_Dt) AS 'Modified Date' Priority Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System'  TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

COMM *** Invalid ABN Format Details***
COMM
v_Exp_Fields_VM007D = "Cha_Field1 AS 'Vendor Site'  Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name'  Vndr_Sts AS 'Vendor Status'  ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount'  GST_AMT AS 'GST Amount' Inv_Net_Amt AS 'Applied Amount' Num_Field1 AS 'Pay Amount' Vchr_ID AS 'Trans Num' Btch_No AS 'Trans Ref' Cha_Field1 AS 'Pay Reference' Cha_Field2 AS 'Pay Method' Pymnt_Trms AS 'Payment Method' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_VM007D =  "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' VMF_VND_Master_File.Cha_Field4 AS 'Vendor Number' VMF_VND_Master_File.Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"

COMM *** Cancelled / Registration ABN ***
v_Exp_Fields_VM008 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN ASIC_entityStatusCode AS 'ABN Status' ASIC_entityStatusEF AS 'ABN Status Eff Date' Vndr_Typ AS 'Vendor Type' VM008Z_Can_ABN_Sum.Inv_Amt AS 'Total Invoice Amount' VM008Z_Can_ABN_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD(_Data_Range_From_VM,'DD/MM/YYYY') AS 'Data Range Start Date' CTOD(_Data_Range_To_VM,'DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"

COMM v_Exp_Fields_VM008 =  "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN AS 'ABN' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' VM008Z_Can_ABN_Sum.Inv_Amt AS 'Total Invoice Amount' GST_AMT AS 'Total GST Amount' COUNT AS 'Total Trans Num'  DATE(Max_Inv_Dt) AS 'Last Invoice Date' TEL1 AS 'Phone' FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode Cntry AS 'Country'  Pymnt_Trm AS 'Payment Method' Co AS 'Company' DATE(Modf_Dt) AS 'Modified Date' Priority Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System'  TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"


v_Exp_Fields_VM008D = "VM008_can_ABN.Cha_Field1  AS 'Vendor Site'  VM008_can_ABN.Cha_Field4 AS 'Vendor Number' VM008_can_ABN.Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"

COMM *** Invalid ABN Format against ABR***
v_Exp_Fields_VM009 = "Cha_Field1 AS 'Vendor Site' Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD(_Data_Range_From_VM,'DD/MM/YYYY') AS 'Data Range Start Date' CTOD(_Data_Range_To_VM,'DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"

COMM v_Exp_Fields_VM009 = "Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN AS 'ABN' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Inv_Amt AS 'Total Invoice Amount' GST_AMT AS 'Total GST Amount' COUNT AS 'Total Trans Num'  DATE(Max_Inv_Dt) AS 'Last Invoice Date' TEL1 AS 'Phone' FAX ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode Cntry AS 'Country'  Pymnt_Trm AS 'Payment Method' Co AS 'Company' DATE(Modf_Dt) AS 'Modified Date' Priority Vndr_Site_ID AS 'Vendor Site ID' Cha_Field3 AS 'Source System'  TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"

COMM *** Invalid ABN Format against ABR Details***
v_Exp_Fields_VM009D = "VM009_Invld_ABN_ABR.Cha_Field1 AS 'Vendor Site'  VM009_Invld_ABN_ABR.Cha_Field4 AS 'Vendor Number' VM009_Invld_ABN_ABR.Vndr_Nme AS 'Vendor Name'   Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"


v_Exp_Fields_VM010 = "Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status' ABN ASIC_entityStatusCode AS 'ABN Status' DATE(ASIC_entityStatusEF) AS 'ABN Registration Date' DATE(ASIC_GST_effFrom) AS 'GST Registration Date' DATE(ASIC_GST_effTo) AS 'GST Expiry Date' VM010D_DeReg_GST_Sum.Inv_Amt AS 'Total Invoice Amount Post GST Expiry' VM010D_DeReg_GST_Sum.GST_Amt AS 'GST Paid Post GST Expiry' VM010D_DeReg_GST_Sum.COUNT AS 'Num Transactions Post GST Expiry' DATE(Max_Inv_Dt) AS 'Last Invoice Date' ASIC_entityDescription AS 'ASIC Description' ADD1 TEL1 Email1 Pymnt_Trm AS 'Payment Terms' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_VM010D = "Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status'  ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' ASIC_GST_effTo AS 'GST Expired Date' Inv_Amt AS 'Invoice Amount'  GST_AMT AS 'GST Amount' Inv_Net_Amt AS 'Applied Amount' Num_Field1 AS 'Pay Amount' Vchr_ID AS 'Trans Num' Btch_No AS 'Trans Ref' Cha_Field1 AS 'Pay Reference' Cha_Field2 AS 'Pay Method' Pymnt_Trms AS 'Term Code Desc' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM011 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status'ABN TEL1 TEL2 TEL3 ADD1 AS 'Address1' ADD2 AS 'Address2' ADD3 AS 'Address3' City AS 'City' State AS 'State' Email1 Email2 AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM012 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Vndr_InvlDt AS 'InActive Date' ABN Inv_Amt AS 'Total Invoice Amount Post InActive' GST_AMT AS 'Total GST Amount Post InActive' COUNT AS 'Total Trans Num Post InActive' DATE(Max_Inv_Dt) AS 'Last Invoice Date' ADD1 ADD2 ADD3 City State Cntry AS 'Country' TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm AS 'Payment Terms' Co AS 'Company' DATE(Modf_Dt) AS 'Modified Date' Priority  TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM012D = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' VM012_Inac_xx_Mon.Vndr_InvlDt AS 'Vendor InActive Date' Inv_Amt AS 'Invoice Amount' GST_AMT AS 'GST Amount' Inv_Net_Amt AS 'Inv Net Amount' DATE(Pd_Dt) AS 'Payment Date' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  isPaid AS 'Paid' Vchr_ID AS 'Voucher Number' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM013 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Trans_Num AS 'Trans Number' Inv_Amt AS 'Total Invoice Amount' GST_Amt AS 'Total GST Amount' DATE(Max_Inv_Dt) AS 'Last Invoice Date' ABN TEL1 City State Cntry AS 'Country' Pymnt_Trm AS 'Payment Terms' Created_Dt AS 'Created Date' DATE(Modf_Dt) AS 'Modified Date' Co AS 'Company' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM013D = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' GST_Amt AS 'GST Amount' Inv_Net_Amt AS 'Inv Net Amount' DATE(Pd_Dt) AS 'Payment Date' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM014 = "VM_EM Vndr_Site_ID Vndr_ID Vndr_Nme Vndr_Typ ABN BSB Bnk_Acc_Num ADD1 ADD2 ADD3 City State PCode Cntry TEL1 TEL2 TEL3 FAX Email1 Inv_Amt GST_Amt COUNT ABN Vndr_Sts Hire_Dt Created_Dt Modf_Dt Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM015 = "VM_EM Vndr_Site_ID Vndr_ID Vndr_Nme Vndr_Typ ABN BSB Bnk_Acc_Num ADD1 ADD2 ADD3 City State PCode Cntry TEL1 TEL2 TEL3 FAX Email1 Inv_Amt GST_Amt COUNT ABN Vndr_Sts Hire_Dt Created_Dt Modf_Dt Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM016 = "VM_EM Vndr_Site_ID Vndr_ID Vndr_Nme Vndr_Typ ABN BSB Bnk_Acc_Num ADD1 ADD2 ADD3 City State PCode Cntry TEL1 TEL2 TEL3 FAX Email1 Inv_Amt GST_Amt COUNT ABN Vndr_Sts Hire_Dt Created_Dt Modf_Dt Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_VM017 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date' Email1 Email2 ABN TEL1 TEL2 TEL3 ADD1 AS 'Address1' ADD2 AS 'Address2' ADD3 AS 'Address3' City AS 'City' State AS 'State' Pcode Cntry AS 'Country' TEST_NAME DATE(RptRunDate) AS 'Run Date' SORT_KEY SORT_KEY_Desc"

COMM *** Accounts Payable Tests Output***

v_Exp_Fields_AP001 = "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' VMF_VND_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_AP001 = "Flag VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description'  Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc" 

v_Exp_Fields_AP002 = "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' VMF_VND_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_AP002 = "Flag VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description' Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc" 

v_Exp_Fields_AP003 = "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' VMF_VND_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_AP003 = "Flag VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description' Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc" 

v_Exp_Fields_AP004 = "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' VMF_VND_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name'  Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_AP004 = "Flag VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description'  Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc" 

COMM
v_Exp_Fields_AP005 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Inv_No AS 'Invoice Reference Seq Start' DATE(Inv_Dt) AS 'Invoice Date 1' ' '+ Inv_No2 AS 'Invoice Reference Seq End' DATE(Inv_Dt2) AS 'Invoice Date 2' Consec_Num AS 'Consecutive Num' Priority TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' REC_KEY SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP005D = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' GST_Amt AS 'GST Amount' Inv_Net_Amt AS 'Inv Net Amount' DATE(Pd_Dt) AS 'Payment Date' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' REC_KEY SORT_KEY SORT_KEY_Desc"

v_Exp_Fields_AP006 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice Reference' Inv_Dt AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice Type' Cha_Field4 AS 'Description'  Vchr_ID AS 'Invoice ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' Data_Range_Start_Date AS 'Data Range Start Date' Data_Range_End_Date AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
COMM v_Exp_Fields_AP006 = " Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description'  Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc" 

COMM
v_Exp_Fields_AP008 = "Cha_Field1 AS 'BUSINESS' Vndr_Sts AS 'Vendor Status' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' AllowLimit Inv_Amt AS 'Invoice Amount' DiffAmt AS 'Over Limit Amount' GST_Amt AS 'GST Amount' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invice Date' Vchr_ID AS 'Voucher Number' Doc_Typ AS 'Doc Type' Descrp AS 'Description' Curncy AS 'Currrency' DATE(Pd_Dt) AS 'Paid Date' PO_No isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date'  SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP009 = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status'  ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' GST_Amt AS 'GST Amount' GST_Pct Inv_Net_Amt AS 'Inv Net Amount' DATE(Pd_Dt) AS 'Payment Date' Doc_Typ AS 'Document Type' VMF_Vnd_Master_File.State AS 'State' VMF_Vnd_Master_File.Cntry AS 'Country' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP010 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Avg_Inv_Amt AS 'Average Invoice Amount' Max_Inv_Amt AS 'Largest Amount' Snd_Inv_Amt AS 'Second Largest Amount' Min_Inv_Amt AS 'Smallest Amount' c_Max_Avg_Pct AS 'Pct Largest to Average' c_Max_Snd_Pct AS 'Pct Largest to Second' Ttl_Inv_Amt_75 AS 'Total Invoice Amount 75' Count_75 AS 'Total Num 75' Ttl_Inv_Amt AS 'Total Invoice Amount' Ttl_Count AS 'Total Trans Num' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP010D = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Avg_Inv_Amt AS 'Average Invoice Amount' c_Inv_Avg_Pct AS 'Pct Invoice Amount to Average' GST_Amt AS 'GST Amount' Inv_Net_Amt AS 'Inv Net Amount' DATE(Pd_Dt) AS 'Payment Date' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM OLD AP011
COMM
v_Exp_Fields_AP011 = "VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status'  Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' VMF_VND_Master_File.TEL1 AS 'Phone' VMF_VND_Master_File.FAX AS 'FAX' VMF_VND_Master_File.ADD1 AS 'Address' VMF_VND_Master_File.City AS 'City' VMF_VND_Master_File.State AS 'State' VMF_VND_Master_File.Pcode AS 'Postcode'  VMF_VND_Master_File.Cntry AS 'Country' VMF_VND_Master_File.Pymnt_Trms AS 'Payment Method' VMF_VND_Master_File.Vndr_Site_ID AS 'Vendor Site ID' VMF_VND_Master_File.Cha_Field3 AS 'Source System'  Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM
v_Exp_Fields_AP012 = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' DATE(Pd_Dt) AS 'Payment Date'  Inv_Amt AS 'Invoice Amount' PO_NO Rec_Qty AS 'Received Quantity' Rec_Amt AS 'Received Amount' Rec_Dt AS 'Received Date' PO_Date Amount AS 'PO Amount' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' GST_Amt AS 'GST Amount' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP013 = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Inv_Net_Amt AS 'Inv Net Amount' PO_NO Pst_Dt as 'Post Date' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' GST_Amt AS 'GST Amount' DATE(Pd_Dt) AS 'Payment Date' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM


v_Exp_Fields_AP014  = "VMF_Vnd_Master_File.Cha_Field1 AS 'Vendor Site' VMF_Vnd_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status'  Vndr_Typ AS 'Vendor Type' VMF_VND_Master_File.TEL1 AS 'Phone' VMF_VND_Master_File.FAX AS 'FAX' VMF_VND_Master_File.ADD1 AS 'Address' VMF_VND_Master_File.City AS 'City' VMF_VND_Master_File.State AS 'State' VMF_VND_Master_File.Pcode AS 'Postcode'  VMF_VND_Master_File.Cntry AS 'Country' VMF_Vnd_Master_File.Pymnt_Trm AS 'Payment Method' VMF_VND_Master_File.Vndr_Site_ID AS 'Vendor Site ID' VMF_VND_Master_File.Cha_Field3 AS 'Source System'  Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM
v_Exp_Fields_AP014  = "VMF_Vnd_Master_File.Cha_Field1 AS 'Vendor Site' VMF_Vnd_Master_File.Cha_Field4 AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' ABN  Vndr_Typ AS 'Vendor Type' AP_Vnd_InvGst_Sum.Inv_Amt AS 'Total Invoice Amount' AP_Vnd_InvGst_Sum.COUNT AS 'Total Trans Num' Max_Inv_Dt AS 'Last Invoice Date' TEL1 AS 'Phone' FAX AS 'Fax' ADD1 AS 'Address' City AS 'City' State AS 'State' Pcode AS 'Postcode' Cntry AS 'Country' Pymnt_Trm  AS 'Payment Method' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' TEST_NAME AS 'Test Name' RptRunDate AS 'Test Run Date' CTOD('','DD/MM/YYYY') AS 'Data Range Start Date' CTOD('','DD/MM/YYYY') AS 'Data Range End Date' SORT_KEY AS 'Sort Key' SORT_KEY_Desc AS 'Sort Key Description'"
END

COMM v_Exp_Fields_AP014  = "VMF_Vnd_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status'  Vndr_Typ AS 'Vendor Type' VMF_VND_Master_File.TEL1 AS 'Phone' VMF_VND_Master_File.FAX AS 'FAX' VMF_VND_Master_File.ADD1 AS 'Address' VMF_VND_Master_File.City AS 'City' VMF_VND_Master_File.State AS 'State' VMF_VND_Master_File.Pcode AS 'Postcode'  VMF_VND_Master_File.Cntry AS 'Country' VMF_Vnd_Master_File.Pymnt_Trm AS 'Payment Method' VMF_VND_Master_File.Vndr_Site_ID AS 'Vendor Site ID' VMF_VND_Master_File.Cha_Field3 AS 'Source System'  Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM OLD copy of AP0014
COMM
v_Exp_Fields_AP014 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' ABN TEL1 City State Cntry AS 'Country' Pymnt_Trm AS 'Payment Terms' DATE(Max_Inv_Dt) AS 'Last Invoice Date' Created_Dt AS 'Created Date' DATE(Modf_Dt) AS 'Modified Date' Co AS 'Company' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP015 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Ttl_Inv_Amt AS 'Total Invoice Amount' Ttl_GST_Amt AS 'Total GST Amount' Count AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date' DATE(Modf_Dt) AS 'Modified Date' City State Cntry AS 'Country' TEL1 Pymnt_Trm AS 'Payment Terms' Co AS 'Company' DATE(Modf_Dt) AS 'Modified Date' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP015D = "Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' GST_Amt AS 'GST Amount' Inv_Net_Amt AS 'Inv Net Amount' DATE(Pd_Dt) AS 'Payment Date' Doc_Typ AS 'Document Type' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM *** Tech One***
COMM
v_Exp_Fields_AP015=""
v_Exp_Fields_AP015D = "isPaid AS 'Paid'  Vndr_ID Vndr_Nme Vndr_Sts Vndr_Typ Sub_Vnd_Nme Add City_PCode Inv_No Inv_Dt Inv_Amt Gst_Amt Inv_NetAmt Currency Pst_Dt Doc_Typ Trans_Typ TrType_Desc PO_NO Pay_DocNbr Pay_Date Pay_DocTyp Trans_Nbr Alloc_Trans_Nbr Period Pst_User  Vchr_ID AS 'Voucher Number' Priority TEST_NAME RptRunDate AS 'Test Date' Data_Rage_Start_Date AS 'Data_Range_Start_Date' Data_Rage_End_Date AS 'Data_Range_End_Date' Grp_KEY SORT_KEY SORT_KEY_Desc"

COMM *** SAP ***
COMM
v_Exp_Fields_AP015 = "Cha_Field4 AS 'Co' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' BSEC_NAME1 AS 'One Time Vendor Name' Inv_Amt AS 'Total Invoice Amount' Doc_Num AS 'Trans Number' BSEC_BANKL AS 'BSB' BSEC_BANKN AS 'Bank Acc Number' BSEC_STRAS AS 'Address' BSEC_PSTLZ AS 'Post Code' BSEC_ORT01 AS 'City' BSEC_REGIO AS 'State' BSEC_STCD1 AS 'TaxNbr' Curncy AS 'Currency' TEST_NAME RptRunDate AS 'Test Date' Data_Rage_Start_Date Data_Rage_End_Date SORT_KEY SORT_KEY_Desc Grp_KEY ID_KEY"
v_Exp_Fields_AP015D = "isPaid Cha_Field4 AS 'Co' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' BSEC_NAME1 AS 'One Time Vendor Name' BSEC_BANKL AS 'BSB' BSEC_BANKN AS 'Bank Acc Number'  Inv_No  AS 'Invoice Reference' DATETIME(Inv_Dt,'DD/MM/YYYY') AS 'Invoice Date' Inv_Amt AS 'Doc Invoice Amount' Curncy AS 'Currency' Inv_Amt_Loc AS 'Local Invoice Amount'  Doc_Typ AS 'Doc Type' Btch_No AS 'Doc Number' Descrp VOIDED Pst_Dt as 'Post Date' Cha_Field2 AS 'Clr_DocNbr' Pymnt_Trms Cha_Field1 AS 'Fiscal Year' Cha_Field3 AS 'Reversal Doc' Priority TEST_NAME RptRunDate AS 'Test Date' Data_Rage_Start_Date Data_Rage_End_Date SORT_KEY SORT_KEY_Desc Grp_KEY"


COMM *** Missing ABN***
COMM
v_Exp_Fields_AP016 = "Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status' Inv_Amt AS 'Total Invoice Amount' GST_AMT AS 'Total GST Amount' COUNT AS 'Total Trans Num' ABN AS 'ABN' DATE(Max_Inv_Dt) AS 'Last Invoice Date' ADD1 TEL1 Email1 Pymnt_Trm AS 'Payment Terms' Priority  TEST_NAME DATE(RptRunDate) AS 'Test Date' SORT_KEY SORT_KEY_Desc"

COMM *** Missing ABN Invoice Details***
COMM
v_Exp_Fields_AP016D = "Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status'  ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount'  GST_AMT AS 'GST Amount' Inv_Net_Amt AS 'Applied Amount' Num_Field1 AS 'Pay Amount' Vchr_ID AS 'Trans Num' Btch_No AS 'Trans Ref' Cha_Field1 AS 'Pay Reference' Cha_Field2 AS 'Pay Method' Pymnt_Trms AS 'Term Code Desc' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP017 = "Vndr_Sts AS 'Vendor Status' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Inv_Amt AS 'Total Invoice Amount' GST_Amt AS 'Total GST Amount' COUNT AS 'Total Trans Num' DATE(Max_Inv_Dt) AS 'Last Invoice Date' ABN ADD1 AS 'Address1' State AS 'State' Cntry AS 'Country' TEL1 Priority TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date'  SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP017D = "Cha_Field1 AS 'BUSINESS' isPaid Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Inv_Amt AS 'Invoice Amount' GST_Amt AS 'GST Amount' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' DATE(Pd_Dt) AS 'Payment Date' Descrp AS 'Description' Curncy AS 'Currency' Priority TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date'  SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP018 = "Cha_Field1 AS 'BUSINESS' Vndr_Sts AS 'Vendor Status' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' AllowLimit Inv_Amt AS 'Invoice Amount' DiffAmt AS 'Under/Over Limit Amount' GST_Amt AS 'GST Amount' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invice Date' Vchr_ID AS 'Voucher Number' Doc_Typ AS 'Doc Type' Descrp AS 'Description' Curncy AS 'Currrency' DATE(Pd_Dt) AS 'Paid Date' PO_No isPaid AS 'Paid' Priority TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date'  SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP019="Cha_Field1 AS 'BUSINESS' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status' Doc_Typ AS 'Document Type' DATE(Pd_Dt) AS 'Payment Date' ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' GST_Amt AS 'GST Amount' Inv_Net_Amt AS 'Inv Net Amount' Curncy AS 'Currency' Pst_Dt as 'Post Date' Descrp AS 'Description' DATE(Due_Dt) AS 'Due Date' PO_NO Cha_Field2 AS 'Payment No'  Vchr_ID AS 'Voucher Number' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP020="Vndr_Site_ID AS 'Compnay Vendor Number' %trg_VMF%.Vndr_Nme AS 'Vendor Name' %trg_VMF%.Vndr_Typ AS 'Vendor Type' %trg_VMF%.Vndr_Sts AS 'Vendor Status' %trg_VMF%.ABN YM AS 'Month of Year' Mon_Pmnt_Num AS 'Total Payments of Month' c_Btch_No AS 'Check Number' Pay_Pmnt_Num AS 'Payments Count' Pay_Amt AS 'Total Payment Amount' GST_Amt AS 'Total GST Paid Amount' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP020D="Cha_Field1 AS 'BUSINESS' Vndr_Site_ID AS 'Remit Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' DATE(Pay_Dt) AS 'CHECK_DATE' Pay_No AS 'INVOICE_PAYMENT_ID' Btch_No AS 'Check Number' Pay_Amt AS 'Payment Amount'  GST_AMT AS 'GST Amount' Curncy AS 'Currency' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status' Pymnt_Trms AS 'Status Lookup Code' Pymnt_Mth AS 'PAYMENT_METHOD_CODE' Cha_Field2 AS 'INVOICING_VENDOR_SITE_ID' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP021="GAP_START_EXCLUSIVE GAP_END_EXCLUSIVE NUMBER_ITEMS_MISSING Priority TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_AP022=""
v_Exp_Fields_AP023=""
COMM
v_Exp_Fields_AP024="Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Trans_Num AS 'Trans Number' Inv_Amt AS 'Total Invoice Amount' GST_Amt AS 'Total GST Amount' Months AS 'Low Activity Months' DATE(Max_Inv_Dt) AS 'Last Invoice Date' ABN TEL1 City State Cntry AS 'Country' Pymnt_Trm AS 'Payment Terms' Created_Dt AS 'Created Date' DATE(Modf_Dt) AS 'Modified Date' Co AS 'Company' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

COMM *** Employee Master File Tests Output***
COMM
v_Exp_Fields_EM001 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM002 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE  BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Tax_Fle_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM003 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM004 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE Dup_Add1 Dup_Add2 Dup_Add3 Dup_City Dup_State Dup_PCode Dup_Cntry Total_PayAmt Total_Pay_Num Tax_Fle_Num  TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM005 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE TEL1 TEL2 TEL3 Fax Total_PayAmt Total_Pay_Num Tax_Fle_Num Add1 Add2 Add3 City State PCode Cntry Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM006 = "Emp_ID AS 'Employee Number' Emp_Sts Co AS 'BUSINESS' COST_CENTRE Title Emp_Nme AS 'Emp Name' DATE(DOB) AS 'DOB' Sex Tax_Fle_Num DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM007 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM008 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM009 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM010 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM011 = "EMF_TMP_Emp.Emp_ID AS 'Employee Number' EMF_TMP_Emp.Emp_Nme AS 'Emp Name' EMF_TMP_Emp.Co As 'BUSINESS' EMF_TMP_Emp.COST_CENTRE BSB Bnk_Acc_Num BSB_NAME EMF_TMP_Emp.Tax_Fle_Num EMF_TMP_Emp.Add1 EMF_TMP_Emp.Add2 EMF_TMP_Emp.Add3 EMF_TMP_Emp.City EMF_TMP_Emp.State EMF_TMP_Emp.PCode EMF_TMP_Emp.Cntry EMF_TMP_Emp.TEL1 EMF_TMP_Emp.TEL2 EMF_TMP_Emp.TEL3 EMF_TMP_Emp.Fax EMF_TMP_Emp.Email_Bus EMF_TMP_Emp.Email_Privt EMF_TMP_Emp.Title DATE(EMF_TMP_Emp.DOB) AS 'DOB' EMF_TMP_Emp.Sex DATE(EMF_TMP_Emp.Hire_Dt) AS 'Hired Date' DATE(EMF_TMP_Emp.Trm_Dt) AS 'TERM_DATE' EMF_TMP_Emp.Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM012 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM013 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' Tax_Fle_Num Total_PayAmt Total_Pay_Num Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt BSB Bnk_Acc_Num Title DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM014 = "Emp_Sts Co AS 'Emp Company' COST_CENTRE Emp_ID AS 'Emp_Code' Tax_Fle_Num Tax_Scale Total_PayAmt Total_Pay_Num Title Frst_Nme AS 'Given Name' Second_Given_Name Sur_Nme AS 'SurName' DATE(DOB) AS 'DOB' Sex DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Term_Reason_Desc State AS 'State' PCode As 'Post Code' Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM015 = "'~'+Emp_ID AS 'Employee Code' Frst_Nme AS 'First Name' Sur_Nme AS 'Last Name' Emp_Sts AS 'Emp Status' Emp_Catg AS 'Emp Type Desc' '~'+COST_CENTRE AS 'Cost Centre Code' DATETIME(Hire_Dt,'DD/MM/YYYY') AS 'Start Date' DATETIME(Commencement_Dt, 'DD/MM/YYYY') AS 'Commencement Date' Lv_Hrs_Taken Lv_Days_Taken Cal_Days_Taken Lst_Lv_EndDt AS 'Lst_Lv_End_Date' Lst_LvCode AS 'Lst Lv Reason Code' Lst_LvHrs AS 'Lst_Lv_TtlHrs' '~'+Tax_Fle_Num AS  'Tax_Fle_Num' Total_PayAmt AS 'Total_12M_PayAmt' Total_Pay_Num AS 'Total_12M_TranNum' '~'+Bnk_Acc_Num AS 'Bank Account' TEL1 AS 'Home Phone' TEL2 AS 'Mobile' ALLTRIM(Add1)+' ' + ALLTRIM(Add2) AS 'Address' City PCode AS 'Post Code' State DATETIME(DOB,'DD/MM/YYYY') AS 'Birth Date' Title AS 'Position Code' '~'+Cha_Field1 AS 'Dept Code' '~'+Cha_Field2 AS 'Location Code' Cha_Field3 AS 'Work Area Code' Test_Name DATETIME(RptRunDate,'DD/MM/YYYY') AS 'Test Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM016 = "'~'+Emp_ID AS 'Employee Code' Frst_Nme AS 'First Name' Sur_Nme AS 'Last Name' Emp_Sts AS 'Emp Status' Emp_Catg AS 'Emp Type Desc' '~'+COST_CENTRE AS 'Cost Centre Code' DATETIME(Hire_Dt,'DD/MM/YYYY') AS 'Start Date' DATETIME(Commencement_Dt, 'DD/MM/YYYY') AS 'Commencement Date' Lv_Code AS 'Leave Reason Code' AnnYear1 AS 'AnnY1_Hire_Date' AnnYear1_Lv_Days_Taken AS 'AnnY1_Sum_Lv_Days_Taken' AnnYear2 AS 'AnnY2_Hire_Date' AnnYear2_Lv_Days_Taken AS 'AnnY2_Sum_Lv_Days_Taken' AnnYear1_Cal_Days_Taken AS 'Y1_Calendar_Days' AnnYear2_Cal_Days_Taken AS 'Y2_Calendar_Days' DATETIME(DOB,'DD/MM/YYYY') AS 'Birth Date' '~'+Tax_Fle_Num AS  'Tax_Fle_Num' Total_PayAmt AS 'Total_12M_PayAmt' Total_Pay_Num AS 'Total_12M_TranNum' '~'+Bnk_Acc_Num AS 'Bank Account' TEL1 AS 'Home Phone' TEL2 AS 'Mobile' ALLTRIM(Add1)+' ' + ALLTRIM(Add2) AS 'Address' City PCode AS 'Post Code' State Title AS 'Position Code' '~'+Cha_Field1 AS 'Dept Code' '~'+Cha_Field2 AS 'Location Code' Cha_Field3 AS 'Work Area Code' Test_Name DATETIME(RptRunDate,'DD/MM/YYYY') AS 'Test Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM016D = "'~'+Emp_ID AS 'Employee Code' Frst_Nme AS 'First Name' Sur_Nme AS 'Last Name' Emp_Sts AS 'Emp Status' Emp_Catg AS 'Emp Type Desc' '~'+COST_CENTRE AS 'Cost Centre Code' DATETIME(Hire_Dt,'DD/MM/YYYY') AS 'Start Date' DATETIME(Commencement_Dt, 'DD/MM/YYYY') AS 'Commencement Date' ExceptionAnnYear ReasonCode StartDate AS 'Lv Start Date' EndDate AS 'Lv End Date' UnitsRequested AS 'Lv Hours Taken' TypeOfUnits ApprovedByCode ApprovedDate AS 'Approved Date' ProcessedDate AS 'Processed Date' c_Notes AS 'Notes'  Test_Name RptRunDate AS 'Test_Date'SORT_KEY"

COMM
v_Exp_Fields_EM017="'~'+Emp_ID AS 'Employee Code' Frst_Nme AS 'First Name' Sur_Nme AS 'Last Name' Emp_Sts AS 'Emp Status' Emp_Catg AS 'Emp Type Desc' '~'+COST_CENTRE AS 'Cost Centre Code' DATETIME(Hire_Dt,'DD/MM/YYYY') AS 'Start Date' DATETIME(Commencement_Dt, 'DD/MM/YYYY') AS 'Commencement Date' 'SICK' AS 'Leave Reason Code' SLTotalUnits AS 'Balance_SLTotalHrs' TtlSLHrs_Taken EndDate AS 'Lv End Date' ApprovedByCode ApprovedDate AS 'Approved Date' Notes DATETIME(DOB,'DD/MM/YYYY') AS 'Birth Date' '~'+Tax_Fle_Num AS  'Tax_Fle_Num' '~'+Bnk_Acc_Num AS 'Bank Account' TEL1 AS 'Home Phone' TEL2 AS 'Mobile' ALLTRIM(Add1)+' ' + ALLTRIM(Add2) AS 'Address' City PCode AS 'Post Code' State Title AS 'Position Code' '~'+Cha_Field1 AS 'Dept Code' '~'+Cha_Field2 AS 'Location Code' Cha_Field3 AS 'Work Area Code' Test_Name DATETIME(RptRunDate,'DD/MM/YYYY') AS 'Test Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_EM017D = "'~'+Emp_ID AS 'Employee Code' Frst_Nme AS 'First Name' Sur_Nme AS 'Last Name' Emp_Sts AS 'Emp Status' Emp_Catg AS 'Emp Type Desc' '~'+COST_CENTRE AS 'Cost Centre Code' DATETIME(Hire_Dt,'DD/MM/YYYY') AS 'Start Date' DATETIME(Commencement_Dt, 'DD/MM/YYYY') AS 'Commencement Date' ReasonCode StartDate AS 'Lv Start Date' EndDate AS 'Lv End Date' UnitsRequested AS 'Lv Hours Taken' TypeOfUnits ApprovedByCode ApprovedDate AS 'Approved Date' ProcessedDate AS 'Processed Date' c_Notes AS 'Notes'  Test_Name RptRunDate AS 'Test_Date'SORT_KEY"


COMM *** Payroll Tests Output***
COMM
v_Exp_Fields_PR001 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR002 = "Co As 'BUSINESS' COST_CENTRE Emp_ID AS 'Employee Number' DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR003 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Trm_Dt) AS 'TERM_DATE' DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY Title  STATE PCode AS 'Post Code' DATE(Hire_Dt) AS 'Hired Date'  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR004 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY Title  DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR005 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Trm_Dt) AS 'TERM_DATE' DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY Title DATE(Hire_Dt) AS 'Hired Date'  Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR006 = ""
COMM
v_Exp_Fields_PR007 = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours AUTOPAY_HOURS_DAYS LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY Title DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR008 = "Emp_ID AS 'Employee Number' Co As 'BUSINESS' COST_CENTRE PAYCODE_AMOUNT PAYCODE_HOURS Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR008D = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY Title  DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR009="Co As 'BUSINESS' Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' DATE(Prd_Dt) AS 'Prd_Dt' PayCode_Amount PayCode_Hours Avg_PayCode_Amount Avg_PayCode_Hours Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_PR009D = "Emp_ID AS 'Employee Number' Emp_Nme AS 'Emp Name' Co As 'BUSINESS' COST_CENTRE DATE(Prd_Dt) AS 'Prd_Dt' PayCode PayCode_Amount PayCode_Hours LINE_DESC LINE_TYPE GL_Account_No YEARLY_SALARY Title  DATE(Hire_Dt) AS 'Hired Date' DATE(Trm_Dt) AS 'TERM_DATE' Priority Test_Name RptRunDate SORT_KEY SORT_KEY_Desc"

COMM *** EXPORT STATICSTIC Reports *** 
COMM
v_Exp_Fields_ST001 = "Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Ttl_Issues AS 'Total Issues Found' COUNT AS 'Number of Test Failed' Priority DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_ST001D = "Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' COUNT AS 'Total Issues Found in the Test' TEST_NAME DATE(RptRunDate) AS 'Run Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_ST002 = "Rev_Days_1 AS 'Rev_Days' Count AS 'Total Reversals Num' FIELD_PERCENTAGE ABS_InvAmt"
COMM
v_Exp_Fields_ST003 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status' Total_InvAmt AS 'Total Invoices Amount' Trns_Num AS 'Total Invoices Num' Dup_InvAmt Dup_Num  Cln_Dup_InvAmt Cln_Dup_Num PCT_Cln_Dup_Trns_Amt PCT_Cln_Dup_Trns_Num  Rev_InvAmt Rev_Num PCT_Rev_Dup_Amt PCT_Rev_Dup_Num Vndr_Typ AS 'Vednor Type' SORT_KEY SORT_KEY_Desc"
COMM
v_Exp_Fields_ST004 = "Vndr_Site_ID AS 'Vendor Site ID' Vndr_Nme AS 'Vendor Name' Inv_Amt AS 'Invoices Amount' GST_Amt AS 'GST Amount' COUNT AS 'Total Trans Num' COUNT_PERCENTAGE AS 'Trans Num Pct' FIELD_PERCENTAGE AS 'Inv Amt Pct' Priority RptRunDate SORT_KEY"
COMM
v_Exp_Fields_ST005 = "YM AS 'Month' Inv_Amt AS 'Invoices Amount' GST_Amt AS 'GST Amount' COUNT AS 'Total Trans Num' COUNT_PERCENTAGE AS 'Trans Num Pct' Priority RptRunDate SORT_KEY"
COMM
v_Exp_Fields_ST006 = ""

COMM *** Export Vendor Master File Tests***

IF (CHK_Exp_VM001=T AND FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM001)) OPEN VM001_Dup_Vnd_BankAcc
%v_cmt% IF (CHK_Exp_VM001=T AND FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM001)) COUNT
IF (CHK_Exp_VM001=T AND FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM001)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM001%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM001_Dup_Vnd_BankAcc" %v_fileOpt%

IF (CHK_Exp_VM002=T AND FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM002)) OPEN VM002_Dup_Vnd_ABN
%v_cmt% IF (CHK_Exp_VM002=T AND FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM002)) COUNT
IF (CHK_Exp_VM002=T AND FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM002)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM002%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM002_Dup_Vnd_ABN" %v_fileOpt%

IF (CHK_Exp_VM003=T AND FILESIZE("%fld_Results%VM003_Dup_Vnd_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM003)) OPEN VM003_Dup_Vnd_Add
%v_cmt% IF (CHK_Exp_VM003=T AND FILESIZE("%fld_Results%VM003_Dup_Vnd_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM003)) COUNT
IF (CHK_Exp_VM003=T AND FILESIZE("%fld_Results%VM003_Dup_Vnd_Add.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM003)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM003%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM003_Dup_Vnd_Add" %v_fileOpt%

IF (CHK_Exp_VM004=T AND FILESIZE("%fld_Results%VM004_Dup_Vnd_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM004)) OPEN VM004_Dup_Vnd_Tel
%v_cmt% IF (CHK_Exp_VM004=T AND FILESIZE("%fld_Results%VM004_Dup_Vnd_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM004)) COUNT
IF (CHK_Exp_VM004=T AND FILESIZE("%fld_Results%VM004_Dup_Vnd_Tel.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM004)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM004%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM004_Dup_Vnd_Tel" %v_fileOpt%


IF (CHK_Exp_VM005=T AND FILESIZE("%fld_Results%VM005_Dup_Vnd_Name.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM005)) OPEN VM005_Dup_Vnd_Name
%v_cmt% IF (CHK_Exp_VM005=T AND FILESIZE("%fld_Results%VM005_Dup_Vnd_Name.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM005)) COUNT
IF (CHK_Exp_VM005=T AND FILESIZE("%fld_Results%VM005_Dup_Vnd_Name.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM005)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM005%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM005_Dup_Vnd_Name" %v_fileOpt%


IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006)) OPEN VM006_Mis_Details
%v_cmt% IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006)) COUNT
IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006_Mis_Details.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM006)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM006%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM006_Mis_Details" %v_fileOpt%


IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006D_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006D)) OPEN VM006D_Mis_Details
%v_cmt% IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006D_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006D)) COUNT
IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006D_Mis_Details.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM006D)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM006D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM006D_Mis_Details" %v_fileOpt%

COMMENT
IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006D_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006D)) OPEN TMP_VM006D
%v_cmt% IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006D_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006D)) COUNT
IF (CHK_Exp_VM006=T AND FILESIZE("%fld_Results%VM006D_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM006D)) %v_if% %v_EXPORT% FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM006D_Mis_Details" %v_fileOpt%
END

IF ((CHK_Exp_VM007=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM007_Invld_Frmt_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM007)) OPEN VM007_Invld_Frmt_ABN
%v_cmt% IF ((CHK_Exp_VM007=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM007_Invld_Frmt_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM007)) COUNT
IF ((CHK_Exp_VM007=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM007_Invld_Frmt_ABN.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM007)) %v_if% %v_EXPORT% FIELDS %v_Exp_Fields_VM007%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM007_Invld_Frmt_ABN" %v_fileOpt%

IF ((CHK_Exp_VM007=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM007D_Invld_Frmt_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM007D)) OPEN VM007D_Invld_Frmt_ABN
%v_cmt% IF ((CHK_Exp_VM007=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM007D_Invld_Frmt_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM007D)) COUNT
IF ((CHK_Exp_VM007=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM007D_Invld_Frmt_ABN.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM007D)) %v_EXPORT% FIELDS %v_Exp_Fields_VM007D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM007_Invld_Frmt_ABN" %v_fileOpt%

IF ((CHK_Exp_VM008=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM008_Can_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM008)) OPEN VM008_Can_ABN
%v_cmt% IF ((CHK_Exp_VM008=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM008_Can_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM008)) COUNT
IF ((CHK_Exp_VM008=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM008_Can_ABN.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM008)) %v_EXPORT% FIELDS %v_Exp_Fields_VM008%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM008_Can_ABN" %v_fileOpt%

IF ((CHK_Exp_VM008=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM008D_Can_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM008D)) OPEN TMP_VM008D
%v_cmt% IF ((CHK_Exp_VM008=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM008D_Can_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM008D)) COUNT
IF ((CHK_Exp_VM008=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM008D_Can_ABN.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM008D)) %v_EXPORT% FIELDS FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM008D_Can_ABN" %v_fileOpt%

IF ((CHK_Exp_VM009=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM009_Invld_ABN_ABR.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM009)) OPEN VM009_Invld_ABN_ABR
%v_cmt% IF ((CHK_Exp_VM009=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM009_Invld_ABN_ABR.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM009)) COUNT
IF ((CHK_Exp_VM009=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM009_Invld_ABN_ABR.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM009)) %v_EXPORT% FIELDS %v_Exp_Fields_VM009%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM009_Invld_ABN_ABR" %v_fileOpt%

IF ((CHK_Exp_VM009=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM009D_Invld_ABN_ABR.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM009D)) OPEN VM009D_Invld_ABN_ABR
%v_cmt% IF ((CHK_Exp_VM009=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM009D_Invld_ABN_ABR.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM009D)) COUNT
IF ((CHK_Exp_VM009=T OR CHK_Exp_AP016=T) AND FILESIZE("%fld_Results%VM009D_Invld_ABN_ABR.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM009D)) %v_EXPORT% FIELDS %v_Exp_Fields_VM009D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM009D_Invld_ABN_ABR" %v_fileOpt%


COMM *** AP007 --> VM010/VM010D DeReg GST***
IF ((CHK_Exp_VM010=T OR CHK_Exp_AP007=T ) AND FILESIZE("%fld_Results%VM010_DeReg_GST.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM010)) OPEN VM010_DeReg_GST
%v_cmt% IF ((CHK_Exp_VM010=T OR CHK_Exp_AP007=T ) AND FILESIZE("%fld_Results%VM010_DeReg_GST.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM010)) COUNT
IF ((CHK_Exp_VM010=T OR CHK_Exp_AP007=T ) AND FILESIZE("%fld_Results%VM010_DeReg_GST.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM010)) %v_EXPORT% FIELDS %v_Exp_Fields_VM010%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM010_DeReg_GST" %v_fileOpt%

IF ((CHK_Exp_VM010=T OR CHK_Exp_AP007=T) AND FILESIZE("%fld_Results%VM010D_DeReg_GST.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM010)) OPEN VM010D_DeReg_GST
%v_cmt% IF ((CHK_Exp_VM010=T OR CHK_Exp_AP007=T) AND FILESIZE("%fld_Results%VM010D_DeReg_GST.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM010)) COUNT
IF ((CHK_Exp_VM010=T OR CHK_Exp_AP007=T) AND FILESIZE("%fld_Results%VM010D_DeReg_GST.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_VM010)) %v_EXPORT% FIELDS %v_Exp_Fields_VM010D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM010D_DeReg_GST" %v_fileOpt%
COMM
IF (CHK_Exp_VM011=T AND FILESIZE("%fld_Results%VM011_Upd_Mul_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM011)) OPEN VM011_Upd_Mul_xx_Mon
%v_cmt% IF (CHK_Exp_VM011=T AND FILESIZE("%fld_Results%VM011_Upd_Mul_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM011)) COUNT
IF (CHK_Exp_VM011=T AND FILESIZE("%fld_Results%VM011_Upd_Mul_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM011)) %v_EXPORT% FIELDS %v_Exp_Fields_VM011%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM011_Upd_Mul_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_VM012=T AND FILESIZE("%fld_Results%VM012_Inac_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM012)) OPEN VM012_Inac_xx_Mon
%v_cmt% IF (CHK_Exp_VM012=T AND FILESIZE("%fld_Results%VM012_Inac_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM012)) COUNT
IF (CHK_Exp_VM012=T AND FILESIZE("%fld_Results%VM012_Inac_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM012)) %v_EXPORT% FIELDS %v_Exp_Fields_VM012%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM012_Inac_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_VM012=T AND FILESIZE("%fld_Results%VM012D_Inac_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM012D)) OPEN VM012D_Inac_xx_Mon
%v_cmt% IF (CHK_Exp_VM012=T AND FILESIZE("%fld_Results%VM012D_Inac_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM012D)) COUNT
IF (CHK_Exp_VM012=T AND FILESIZE("%fld_Results%VM012D_Inac_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM012D)) %v_EXPORT% FIELDS %v_Exp_Fields_VM012D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM012D_Inac_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_VM013=T AND FILESIZE("%fld_Results%VM013_OneTim_Vnd_Spend.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM013)) OPEN VM013_OneTim_Vnd_Spend
%v_cmt% IF (CHK_Exp_VM013=T AND FILESIZE("%fld_Results%VM013_OneTim_Vnd_Spend.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM013)) COUNT
IF (CHK_Exp_VM013=T AND FILESIZE("%fld_Results%VM013_OneTim_Vnd_Spend.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM013)) %v_EXPORT% FIELDS %v_Exp_Fields_VM013%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM013_OneTim_Vnd_Spend" %v_fileOpt%
COMM
IF (CHK_Exp_VM013=T AND FILESIZE("%fld_Results%VM013D_OneTim_Vnd_Spend.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM013D)) OPEN VM013D_OneTim_Vnd_Spend
%v_cmt% IF (CHK_Exp_VM013=T AND FILESIZE("%fld_Results%VM013D_OneTim_Vnd_Spend.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM013D)) COUNT
IF (CHK_Exp_VM013=T AND FILESIZE("%fld_Results%VM013D_OneTim_Vnd_Spend.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM013D)) %v_EXPORT% FIELDS %v_Exp_Fields_VM013D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM013D_OneTim_Vnd_Spend" %v_fileOpt%
COMM
IF (CHK_Exp_VM014=T AND FILESIZE("%fld_Results%VM014_VndEmp_BankAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM014)) OPEN VM014_VndEmp_BankAcc
%v_cmt% IF (CHK_Exp_VM014=T AND FILESIZE("%fld_Results%VM014_VndEmp_BankAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM014)) COUNT
IF (CHK_Exp_VM014=T AND FILESIZE("%fld_Results%VM014_VndEmp_BankAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM014)) %v_EXPORT% FIELDS %v_Exp_Fields_VM014%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM014_VndEmp_BankAcc" %v_fileOpt%

COMM
IF (CHK_Exp_VM015=T AND FILESIZE("%fld_Results%VM015_VndEmp_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM015)) OPEN VM015_VndEmp_Add
%v_cmt% IF (CHK_Exp_VM015=T AND FILESIZE("%fld_Results%VM015_VndEmp_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM015)) COUNT
IF (CHK_Exp_VM015=T AND FILESIZE("%fld_Results%VM015_VndEmp_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM015)) %v_EXPORT% FIELDS %v_Exp_Fields_VM015%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM015_VndEmp_Add" %v_fileOpt%
COMM
IF (CHK_Exp_VM016=T AND FILESIZE("%fld_Results%VM016_VndEmp_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM016)) OPEN VM016_VndEmp_Tel
%v_cmt% IF (CHK_Exp_VM016=T AND FILESIZE("%fld_Results%VM016_VndEmp_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM016)) COUNT
IF (CHK_Exp_VM016=T AND FILESIZE("%fld_Results%VM016_VndEmp_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM016)) %v_EXPORT% FIELDS %v_Exp_Fields_VM016%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM016_VndEmp_Tel" %v_fileOpt%
COMM
IF (CHK_Exp_VM017=T AND FILESIZE("%fld_Results%VM017_Dup_Vnd_Email.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM017)) OPEN VM017_Dup_Vnd_Email
%v_cmt% IF (CHK_Exp_VM017=T AND FILESIZE("%fld_Results%VM017_Dup_Vnd_Email.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM017)) COUNT
IF (CHK_Exp_VM017=T AND FILESIZE("%fld_Results%VM017_Dup_Vnd_Email.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_VM017)) %v_EXPORT% FIELDS %v_Exp_Fields_VM017%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%VM017_Dup_Vnd_Email" %v_fileOpt%

COMM *** %v_EXPORT% Accounts Payable Tests ***
IF (CHK_Exp_AP001=T AND FILESIZE("%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP001)) OPEN AP001_Dup_Amt_Dt_Inv_Vndr
%v_cmt% IF (CHK_Exp_AP001=T AND FILESIZE("%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP001)) COUNT
IF (CHK_Exp_AP001=T AND FILESIZE("%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP001)) %v_EXPORT% FIELDS %v_Exp_Fields_AP001%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP001_Dup_Amt_Dt_Inv_Vndr" %v_fileOpt%

COMM
IF (CHK_Exp_AP001=T AND FILESIZE("%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP001)) OPEN TMP_AP001
%v_cmt% IF (CHK_Exp_AP001=T AND FILESIZE("%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP001)) COUNT
IF (CHK_Exp_AP001=T AND FILESIZE("%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP001)) %v_EXPORT% FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP001_Dup_Amt_Dt_Inv_Vndr" %v_fileOpt%
END



IF (CHK_Exp_AP002=T AND FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP002)) OPEN AP002_Dup_Amt_Inv_Vndr
%v_cmt% IF (CHK_Exp_AP002=T AND FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP002)) COUNT
IF (CHK_Exp_AP002=T AND FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP002)) %v_EXPORT% FIELDS %v_Exp_Fields_AP002%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP002_Dup_Amt_Inv_Vndr" %v_fileOpt%

COMM
IF (CHK_Exp_AP002=T AND FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP002)) OPEN TMP_AP002
%v_cmt% IF (CHK_Exp_AP002=T AND FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP002)) COUNT
IF (CHK_Exp_AP002=T AND FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP002)) %v_EXPORT% FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP002_Dup_Amt_Inv_Vndr" %v_fileOpt%
END


IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) OPEN AP003_Dup_Amt_Dt_Inv
%v_cmt% IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) COUNT
IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) %v_EXPORT% FIELDS %v_Exp_Fields_AP003%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP003_Dup_Amt_Dt_Inv" %v_fileOpt%
IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) %v_EXPORT% FIELDS %v_Exp_Fields_AP003%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP003_Dup_Amt_Dt_Inv" %v_fileOpt%

COMM
IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) OPEN TMP_AP003
%v_cmt% IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) COUNT
IF (CHK_Exp_AP003=T AND FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) %v_EXPORT% FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP003_Dup_Amt_Dt_Inv" %v_fileOpt%
END


IF (CHK_Exp_AP004=T AND FILESIZE("%fld_Results%AP004_Dup_Amt_Dt_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) OPEN AP004_Dup_Amt_Dt_Vndr
%v_cmt% IF (CHK_Exp_AP004=T AND FILESIZE("%fld_Results%AP004_Dup_Amt_Dt_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) COUNT
IF (CHK_Exp_AP004=T AND FILESIZE("%fld_Results%AP004_Dup_Amt_Dt_Vndr.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) %v_EXPORT% FIELDS %v_Exp_Fields_AP004%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP004_Dup_Amt_Dt_Vndr" %v_fileOpt%

COMM
IF (CHK_Exp_AP004=T AND FILESIZE("%fld_Results%AP004_Dup_Amt_Dt_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) OPEN TMP_AP004
%v_cmt% IF (CHK_Exp_AP004=T AND FILESIZE("%fld_Results%AP004_Dup_Amt_Dt_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) COUNT
IF (CHK_Exp_AP004=T AND FILESIZE("%fld_Results%AP004_Dup_Amt_Dt_Vndr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP003)) %v_EXPORT% FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP004_Dup_Amt_Dt_Vndr" %v_fileOpt%
END

COMM
IF (CHK_Exp_AP005=T AND FILESIZE("%fld_Results%AP005_3Cons_InvNo.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP005)) OPEN AP005_3Cons_InvNo
%v_cmt% IF (CHK_Exp_AP005=T AND FILESIZE("%fld_Results%AP005_3Cons_InvNo.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP005))  COUNT
IF (CHK_Exp_AP005=T AND FILESIZE("%fld_Results%AP005_3Cons_InvNo.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP005)) %v_EXPORT% FIELDS %v_Exp_Fields_AP005%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP005_3Cons_InvNo" %v_fileOpt%
COMM
IF (CHK_Exp_AP005=T AND FILESIZE("%fld_Results%AP005D_3Cons_InvNo_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP005D)) OPEN AP005D_3Cons_InvNo_Details
%v_cmt% IF (CHK_Exp_AP005=T AND FILESIZE("%fld_Results%AP005D_3Cons_InvNo_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP005D)) COUNT
IF (CHK_Exp_AP005=T AND FILESIZE("%fld_Results%AP005D_3Cons_InvNo_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP005D)) %v_EXPORT% FIELDS %v_Exp_Fields_AP005D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP005D_3Cons_InvNo_Details" %v_fileOpt%

IF (CHK_Exp_AP006=T AND FILESIZE("%fld_Results%AP006_Pay_Not_In_VMF.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP006)) OPEN AP006_Pay_Not_In_VMF
%v_cmt% IF (CHK_Exp_AP006=T AND FILESIZE("%fld_Results%AP006_Pay_Not_In_VMF.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP006)) COUNT
IF (CHK_Exp_AP006=T AND FILESIZE("%fld_Results%AP006_Pay_Not_In_VMF.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP006)) %v_EXPORT% FIELDS %v_Exp_Fields_AP006%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP006_Pay_Not_In_VMF" %v_fileOpt%

COMM *** AP007 --> VM010/VM010D DeReg_GST ***

COMm *** AP008 Exc_Alw_Limit ***
COMM
IF (CHK_Exp_AP008=T AND FILESIZE("%fld_Results%AP008_Exc_Alw_Limit.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP008)) OPEN AP008_Exc_Alw_Limit
%v_cmt% IF (CHK_Exp_AP008=T AND FILESIZE("%fld_Results%AP008_Exc_Alw_Limit.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP008)) COUNT
IF (CHK_Exp_AP008=T AND FILESIZE("%fld_Results%AP008_Exc_Alw_Limit.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP008)) %v_EXPORT% FIELDS %v_Exp_Fields_AP008%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP008_Exc_Alw_Limit" %v_fileOpt%
COMM
IF (CHK_Exp_AP009=T AND FILESIZE("%fld_Results%AP009_GST_Over_Char.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP009)) OPEN AP009_GST_Over_Char
%v_cmt% IF (CHK_Exp_AP009=T AND FILESIZE("%fld_Results%AP009_GST_Over_Char.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP009)) COUNT
IF (CHK_Exp_AP009=T AND FILESIZE("%fld_Results%AP009_GST_Over_Char.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP009)) %v_EXPORT% FIELDS %v_Exp_Fields_AP009%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP009_GST_Over_Char" %v_fileOpt%
COMM
IF (CHK_Exp_AP010=T AND FILESIZE("%fld_Results%AP010_Large_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP010)) OPEN AP010_Large_Inv
%v_cmt% IF (CHK_Exp_AP010=T AND FILESIZE("%fld_Results%AP010_Large_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP010)) COUNT
IF (CHK_Exp_AP010=T AND FILESIZE("%fld_Results%AP010_Large_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP010)) %v_EXPORT% FIELDS %v_Exp_Fields_AP010%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP010_Large_Inv" %v_fileOpt%
COMM
IF (CHK_Exp_AP010=T AND FILESIZE("%fld_Results%AP010D_Large_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP010D)) OPEN AP010D_Large_Inv
%v_cmt% IF (CHK_Exp_AP010=T AND FILESIZE("%fld_Results%AP010D_Large_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP010D)) COUNT
IF (CHK_Exp_AP010=T AND FILESIZE("%fld_Results%AP010D_Large_Inv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP010D)) %v_EXPORT% FIELDS %v_Exp_Fields_AP010D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP010D_Large_Inv" %v_fileOpt%
COMM
IF (CHK_Exp_AP011=T AND FILESIZE("%fld_Results%AP011_PODt_Aft_InvDt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP011)) OPEN AP011_PODt_Aft_InvDt
%v_cmt% IF (CHK_Exp_AP011=T AND FILESIZE("%fld_Results%AP011_PODt_Aft_InvDt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP011)) COUNT
IF (CHK_Exp_AP011=T AND FILESIZE("%fld_Results%AP011_PODt_Aft_InvDt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP011)) %v_EXPORT% FIELDS %v_Exp_Fields_AP011%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP011_PODt_Aft_InvDt" %v_fileOpt%
COMM
IF (CHK_Exp_AP012=T AND FILESIZE("%fld_Results%AP012_POs_No_Goods.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP012)) OPEN AP012_POs_No_Goods
%v_cmt% IF (CHK_Exp_AP012=T AND FILESIZE("%fld_Results%AP012_POs_No_Goods.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP012)) COUNT
IF (CHK_Exp_AP012=T AND FILESIZE("%fld_Results%AP012_POs_No_Goods.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP012)) %v_EXPORT% FIELDS %v_Exp_Fields_AP012%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP012_POs_No_Goods" %v_fileOpt%
COMM
IF (CHK_Exp_AP013=T AND FILESIZE("%fld_Results%AP013_PO_Mul_Diff_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP013)) OPEN AP013_PO_Mul_Diff_Vnd
%v_cmt% IF (CHK_Exp_AP013=T AND FILESIZE("%fld_Results%AP013_PO_Mul_Diff_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP013)) COUNT
IF (CHK_Exp_AP013=T AND FILESIZE("%fld_Results%AP013_PO_Mul_Diff_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP013)) %v_EXPORT% FIELDS %v_Exp_Fields_AP013%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP013_PO_Mul_Diff_Vnd" %v_fileOpt%

COMM
IF (CHK_Exp_AP014=T AND FILESIZE("%fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP014)) OPEN TMP_AP014
%v_cmt% IF (CHK_Exp_AP014=T AND FILESIZE("%fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP014)) COUNT
IF (CHK_Exp_AP014=T AND FILESIZE("%fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP014)) %v_EXPORT% FIELDS ALL  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP014_No_Trans_%TXT_AP014_Months%_Mon" %v_fileOpt%
END 

IF (CHK_Exp_AP006=T AND FILESIZE("%fld_Results%AP006_Pay_Not_In_VMF.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP006)) OPEN AP006_Pay_Not_In_VMF
%v_cmt% IF (CHK_Exp_AP006=T AND FILESIZE("%fld_Results%AP006_Pay_Not_In_VMF.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP006)) COUNT
IF (CHK_Exp_AP006=T AND FILESIZE("%fld_Results%AP006_Pay_Not_In_VMF.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP006)) %v_EXPORT% FIELDS %v_Exp_Fields_AP006%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP006_Pay_Not_In_VMF" %v_fileOpt%

IF (CHK_Exp_AP014=T AND FILESIZE("%fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP014)) OPEN AP014_No_Trans_%TXT_AP014_Months%_Mon
%v_cmt% IF (CHK_Exp_AP014=T AND FILESIZE("%fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP014)) COUNT
IF (CHK_Exp_AP014=T AND FILESIZE("%fld_Results%AP014_No_Trans_%TXT_AP014_Months%_Mon.fil") > 0 AND NOT ISBLANK(v_Exp_Fields_AP014)) %v_EXPORT% FIELDS %v_Exp_Fields_AP014%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP014_No_Trans_%TXT_AP014_Months%_Mon" %v_fileOpt%


COMM
IF (CHK_Exp_AP015=T AND FILESIZE("%fld_Results%AP015_Mul_Trans_OneTim_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP015)) OPEN AP015_Mul_Trans_OneTim_Vnd
%v_cmt% IF (CHK_Exp_AP015=T AND FILESIZE("%fld_Results%AP015_Mul_Trans_OneTim_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP015)) COUNT
IF (CHK_Exp_AP015=T AND FILESIZE("%fld_Results%AP015_Mul_Trans_OneTim_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP015)) %v_EXPORT% FIELDS %v_Exp_Fields_AP015%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP015_Mul_Trans_OneTim_Vnd" %v_fileOpt%
COMM
IF (CHK_Exp_AP015=T AND FILESIZE("%fld_Results%AP015D_Mul_Trans_OneTim_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP015D)) OPEN AP015D_Mul_Trans_OneTim_Vnd
%v_cmt% IF (CHK_Exp_AP015=T AND FILESIZE("%fld_Results%AP015D_Mul_Trans_OneTim_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP015D)) COUNT
IF (CHK_Exp_AP015=T AND FILESIZE("%fld_Results%AP015D_Mul_Trans_OneTim_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP015D)) %v_EXPORT% FIELDS %v_Exp_Fields_AP015D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP015D_Mul_Trans_OneTim_Vnd" %v_fileOpt%
COMM
IF (CHK_Exp_AP016=T AND FILESIZE("%fld_Results%AP016_Mis_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP016)) OPEN AP016_Mis_ABN
%v_cmt% IF (CHK_Exp_AP016=T AND FILESIZE("%fld_Results%AP016_Mis_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP016)) COUNT
IF (CHK_Exp_AP016=T AND FILESIZE("%fld_Results%AP016_Mis_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP016)) %v_EXPORT% FIELDS %v_Exp_Fields_AP016%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP016_Mis_ABN" %v_fileOpt%
COMM
IF (CHK_Exp_AP016=T AND FILESIZE("%fld_Results%AP016D_Mis_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP016D)) OPEN AP016D_Mis_ABN
%v_cmt% IF (CHK_Exp_AP016=T AND FILESIZE("%fld_Results%AP016D_Mis_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP016D)) COUNT
IF (CHK_Exp_AP016=T AND FILESIZE("%fld_Results%AP016D_Mis_ABN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP016D)) %v_EXPORT% FIELDS %v_Exp_Fields_AP016D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP016D_Mis_ABN" %v_fileOpt%

COMM *** AP016 -> AP016, VM007, VM008, VM009 ***
COMM
IF (CHK_Exp_AP017=T AND FILESIZE("%fld_Results%AP017_Top_xx_Vnd_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP017)) OPEN AP017_Top_xx_Vnd_xx_Mon
%v_cmt% IF (CHK_Exp_AP017=T AND FILESIZE("%fld_Results%AP017_Top_xx_Vnd_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP017)) COUNT
IF (CHK_Exp_AP017=T AND FILESIZE("%fld_Results%AP017_Top_xx_Vnd_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP017)) %v_EXPORT% FIELDS %v_Exp_Fields_AP017%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP017_Top_xx_Vnd_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_AP017=T AND FILESIZE("%fld_Results%AP017D_Top_xx_Vnd_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP017D)) OPEN AP017D_Top_xx_Vnd_xx_Mon
%v_cmt% IF (CHK_Exp_AP017=T AND FILESIZE("%fld_Results%AP017D_Top_xx_Vnd_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP017D)) COUNT
IF (CHK_Exp_AP017=T AND FILESIZE("%fld_Results%AP017D_Top_xx_Vnd_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP017D)) %v_EXPORT% FIELDS %v_Exp_Fields_AP017D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP017D_Top_xx_Vnd_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_AP018=T AND FILESIZE("%fld_Results%AP018_Near_Alw_Limit.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP018)) OPEN AP018_Near_Alw_Limit
%v_cmt% IF (CHK_Exp_AP018=T AND FILESIZE("%fld_Results%AP018_Near_Alw_Limit.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP018)) COUNT
IF (CHK_Exp_AP018=T AND FILESIZE("%fld_Results%AP018_Near_Alw_Limit.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP018)) %v_EXPORT% FIELDS %v_Exp_Fields_AP018%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP018_Near_Alw_Limit" %v_fileOpt%
COMM
IF (CHK_Exp_AP019=T AND FILESIZE("%fld_Results%AP019_CreditNt_Paid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP019)) OPEN AP019_CreditNt_Paid
%v_cmt% IF (CHK_Exp_AP019=T AND FILESIZE("%fld_Results%AP019_CreditNt_Paid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP019)) COUNT
IF (CHK_Exp_AP019=T AND FILESIZE("%fld_Results%AP019_CreditNt_Paid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP019)) %v_EXPORT% FIELDS %v_Exp_Fields_AP019%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP019_CreditNt_Paid" %v_fileOpt%
COMM
IF (CHK_Exp_AP020=T AND FILESIZE("%fld_Results%AP020_Mul_Paid_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP020)) OPEN AP020_Mul_Paid_Mon
%v_cmt% IF (CHK_Exp_AP020=T AND FILESIZE("%fld_Results%AP020_Mul_Paid_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP020)) COUNT
IF (CHK_Exp_AP020=T AND FILESIZE("%fld_Results%AP020_Mul_Paid_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP020)) %v_EXPORT% FIELDS %v_Exp_Fields_AP020%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP020_Mul_Paid_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_AP020=T AND FILESIZE("%fld_Results%AP020D_Mul_Paid_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP020D)) OPEN AP020D_Mul_Paid_Mon
%v_cmt% IF (CHK_Exp_AP020=T AND FILESIZE("%fld_Results%AP020D_Mul_Paid_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP020D)) COUNT
IF (CHK_Exp_AP020=T AND FILESIZE("%fld_Results%AP020D_Mul_Paid_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP020D)) %v_EXPORT% FIELDS %v_Exp_Fields_AP020D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP020D_Mul_Paid_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_AP021=T AND FILESIZE("%fld_Results%AP021_Chq_Out_Seq.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP021)) OPEN AP021_Chq_Out_Seq
%v_cmt% IF (CHK_Exp_AP021=T AND FILESIZE("%fld_Results%AP021_Chq_Out_Seq.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP021)) COUNT
IF (CHK_Exp_AP021=T AND FILESIZE("%fld_Results%AP021_Chq_Out_Seq.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP021)) %v_EXPORT% FIELDS %v_Exp_Fields_AP021%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP021_Chq_Out_Seq" %v_fileOpt%
COMM
IF (CHK_Exp_AP022=T AND FILESIZE("%fld_Results%AP022_Disc_Mis.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP022)) OPEN AP022_Disc_Mis
%v_cmt% IF (CHK_Exp_AP022=T AND FILESIZE("%fld_Results%AP022_Disc_Mis.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP022)) COUNT
IF (CHK_Exp_AP022=T AND FILESIZE("%fld_Results%AP022_Disc_Mis.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP022)) %v_EXPORT% FIELDS %v_Exp_Fields_AP022%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP022_Disc_Mis" %v_fileOpt%
COMM
IF (CHK_Exp_AP023=T AND FILESIZE("%fld_Results%AP023_Disc_Not_Awd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP023)) OPEN AP023_Disc_Not_Awd
%v_cmt% IF (CHK_Exp_AP023=T AND FILESIZE("%fld_Results%AP023_Disc_Not_Awd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP023)) COUNT
IF (CHK_Exp_AP023=T AND FILESIZE("%fld_Results%AP023_Disc_Not_Awd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP023)) %v_EXPORT% FIELDS %v_Exp_Fields_AP023%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP023_Disc_Not_Awd" %v_fileOpt%
COMM
IF (CHK_Exp_AP024=T AND FILESIZE("%fld_Results%AP024_Low_Act_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP024)) OPEN AP024_Low_Act_Vnd
%v_cmt% IF (CHK_Exp_AP024=T AND FILESIZE("%fld_Results%AP024_Low_Act_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP024)) COUNT
IF (CHK_Exp_AP024=T AND FILESIZE("%fld_Results%AP024_Low_Act_Vnd.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_AP024)) %v_EXPORT% FIELDS %v_Exp_Fields_AP024%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%AP024_Low_Act_Vnd" %v_fileOpt%

COMM *** %v_EXPORT% Employee Master File Tests***
COMM
IF (CHK_Exp_EM001=T AND FILESIZE("%fld_Results%EM001_Dup_TFN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM001)) OPEN EM001_Dup_TFN
%v_cmt% IF (CHK_Exp_EM001=T AND FILESIZE("%fld_Results%EM001_Dup_TFN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM001)) COUNT
IF (CHK_Exp_EM001=T AND FILESIZE("%fld_Results%EM001_Dup_TFN.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM001)) %v_EXPORT% FIELDS %v_Exp_Fields_EM001%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM001_Dup_TFN" %v_fileOpt%
COMM
IF (CHK_Exp_EM002=T AND FILESIZE("%fld_Results%EM002_Dup_BnkAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM002)) OPEN EM002_Dup_BnkAcc
%v_cmt% IF (CHK_Exp_EM002=T AND FILESIZE("%fld_Results%EM002_Dup_BnkAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM002)) COUNT
IF (CHK_Exp_EM002=T AND FILESIZE("%fld_Results%EM002_Dup_BnkAcc.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM002)) %v_EXPORT% FIELDS %v_Exp_Fields_EM002%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM002_Dup_BnkAcc" %v_fileOpt%
COMM
IF (CHK_Exp_EM003=T AND FILESIZE("%fld_Results%EM003_Dup_Name.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM003)) OPEN EM003_Dup_Name
%v_cmt% IF (CHK_Exp_EM003=T AND FILESIZE("%fld_Results%EM003_Dup_Name.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM003)) COUNT
IF (CHK_Exp_EM003=T AND FILESIZE("%fld_Results%EM003_Dup_Name.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM003)) %v_EXPORT% FIELDS %v_Exp_Fields_EM003%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM003_Dup_Name" %v_fileOpt%
COMM
IF (CHK_Exp_EM004=T AND FILESIZE("%fld_Results%EM004_Dup_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM004)) OPEN EM004_Dup_Add
%v_cmt% IF (CHK_Exp_EM004=T AND FILESIZE("%fld_Results%EM004_Dup_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM004)) COUNT
IF (CHK_Exp_EM004=T AND FILESIZE("%fld_Results%EM004_Dup_Add.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM004)) %v_EXPORT% FIELDS %v_Exp_Fields_EM004%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM004_Dup_Add" %v_fileOpt%
COMM
IF (CHK_Exp_EM005=T AND FILESIZE("%fld_Results%EM005_Dup_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM005)) OPEN EM005_Dup_Tel
%v_cmt% IF (CHK_Exp_EM005=T AND FILESIZE("%fld_Results%EM005_Dup_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM005)) COUNT
IF (CHK_Exp_EM005=T AND FILESIZE("%fld_Results%EM005_Dup_Tel.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM005)) %v_EXPORT% FIELDS %v_Exp_Fields_EM005%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM005_Dup_Tel" %v_fileOpt%
COMM
IF (CHK_Exp_EM006=T AND FILESIZE("%fld_Results%EM006_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM006)) OPEN EM006_Mis_Details
%v_cmt% IF (CHK_Exp_EM006=T AND FILESIZE("%fld_Results%EM006_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM006)) COUNT
IF (CHK_Exp_EM006=T AND FILESIZE("%fld_Results%EM006_Mis_Details.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM006)) %v_EXPORT% FIELDS %v_Exp_Fields_EM006%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM006_Mis_Details" %v_fileOpt%
COMM
IF (CHK_Exp_EM007=T AND FILESIZE("%fld_Results%EM007_StartDt_Bf_DOB.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM007)) OPEN EM007_StartDt_Bf_DOB
%v_cmt% IF (CHK_Exp_EM007=T AND FILESIZE("%fld_Results%EM007_StartDt_Bf_DOB.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM007)) COUNT
IF (CHK_Exp_EM007=T AND FILESIZE("%fld_Results%EM007_StartDt_Bf_DOB.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM007)) %v_EXPORT% FIELDS %v_Exp_Fields_EM001%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM007_StartDt_Bf_DOB" %v_fileOpt%
COMM
IF (CHK_Exp_EM008=T AND FILESIZE("%fld_Results%EM008_unKnown_CstCtr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM008)) OPEN EM008_unKnown_CstCtr
%v_cmt% IF (CHK_Exp_EM008=T AND FILESIZE("%fld_Results%EM008_unKnown_CstCtr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM008)) COUNT
IF (CHK_Exp_EM008=T AND FILESIZE("%fld_Results%EM008_unKnown_CstCtr.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM008)) %v_EXPORT% FIELDS %v_Exp_Fields_EM008%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM008_unKnown_CstCtr" %v_fileOpt%
COMM
IF (CHK_Exp_EM009=T AND FILESIZE("%fld_Results%EM009_TFN_Invld_Frmt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM009)) OPEN EM009_TFN_Invld_Frmt
%v_cmt% IF (CHK_Exp_EM009=T AND FILESIZE("%fld_Results%EM009_TFN_Invld_Frmt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM009)) COUNT
IF (CHK_Exp_EM009=T AND FILESIZE("%fld_Results%EM009_TFN_Invld_Frmt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM009)) %v_EXPORT% FIELDS %v_Exp_Fields_EM009%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM009_TFN_Invld_Frmt" %v_fileOpt%
COMM
IF (CHK_Exp_EM010=T AND FILESIZE("%fld_Results%EM010_TFN_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM010)) OPEN EM010_TFN_Valid
%v_cmt% IF (CHK_Exp_EM010=T AND FILESIZE("%fld_Results%EM010_TFN_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM010)) COUNT
IF (CHK_Exp_EM010=T AND FILESIZE("%fld_Results%EM010_TFN_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM010)) %v_EXPORT% FIELDS %v_Exp_Fields_EM010%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM010_TFN_Valid" %v_fileOpt%
COMM
IF (CHK_Exp_EM011=T AND FILESIZE("%fld_Results%EM011_BnkAcc_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM011)) OPEN EM011_BnkAcc_Valid
%v_cmt% IF (CHK_Exp_EM011=T AND FILESIZE("%fld_Results%EM011_BnkAcc_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM011)) COUNT
IF (CHK_Exp_EM011=T AND FILESIZE("%fld_Results%EM011_BnkAcc_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM011)) %v_EXPORT% FIELDS %v_Exp_Fields_EM011%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM011_BnkAcc_Valid" %v_fileOpt%
COMM
IF (CHK_Exp_EM012=T AND FILESIZE("%fld_Results%EM012_DOB_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM012)) OPEN EM012_DOB_Valid
%v_cmt% IF (CHK_Exp_EM012=T AND FILESIZE("%fld_Results%EM012_DOB_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM012)) COUNT
IF (CHK_Exp_EM012=T AND FILESIZE("%fld_Results%EM012_DOB_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM012)) %v_EXPORT% FIELDS %v_Exp_Fields_EM012%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM012_DOB_Valid" %v_fileOpt%
COMM
IF (CHK_Exp_EM013=T AND FILESIZE("%fld_Results%EM013_StartDt_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM013)) OPEN EM013_StartDt_Valid
%v_cmt% IF (CHK_Exp_EM013=T AND FILESIZE("%fld_Results%EM013_StartDt_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM013)) COUNT
IF (CHK_Exp_EM013=T AND FILESIZE("%fld_Results%EM013_StartDt_Valid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM013)) %v_EXPORT% FIELDS %v_Exp_Fields_EM013%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM013_StartDt_Valid" %v_fileOpt%
COMM
IF (CHK_Exp_EM014=T AND FILESIZE("%fld_Results%EM014_Tmp_No_EndDt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM014)) OPEN EM014_Tmp_No_EndDt
%v_cmt% IF (CHK_Exp_EM014=T AND FILESIZE("%fld_Results%EM014_Tmp_No_EndDt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM014)) COUNT
IF (CHK_Exp_EM014=T AND FILESIZE("%fld_Results%EM014_Tmp_No_EndDt.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM014)) %v_EXPORT% FIELDS %v_Exp_Fields_EM014%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM014_Tmp_No_EndDt" %v_fileOpt%
COMM
IF (CHK_Exp_EM014=T AND FILESIZE("%fld_Results%EM015_Not_Taken_Leave.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM014)) OPEN EM015_Not_Taken_Leave
%v_cmt% IF (CHK_Exp_EM014=T AND FILESIZE("%fld_Results%EM015_Not_Taken_Leave.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM014)) COUNT
IF (CHK_Exp_EM014=T AND FILESIZE("%fld_Results%EM015_Not_Taken_Leave.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM014)) %v_EXPORT% FIELDS %v_Exp_Fields_EM014%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM015_Not_Taken_Leave" %v_fileOpt%
COMM
IF (CHK_Exp_EM015=T AND FILESIZE("%fld_Results%EM015_Not_Taken_AL.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM015)) OPEN EM015_Not_Taken_AL
IF (CHK_Exp_EM015=T AND FILESIZE("%fld_Results%EM015_Not_Taken_AL.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM015)) %v_EXPORT% FIELDS %v_Exp_Fields_EM015%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM015_Not_Taken_AL%suffix%" %v_fileOpt%
COMM
IF (CHK_Exp_EM016=T AND FILESIZE("%fld_Results%EM016_TooMuch_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM016)) OPEN EM016_TooMuch_SickLv
IF (CHK_Exp_EM016=T AND FILESIZE("%fld_Results%EM016_TooMuch_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM016)) %v_EXPORT% FIELDS %v_Exp_Fields_EM016%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM016_TooMuch_SickLv%suffix%" %v_fileOpt%
COMM
IF (CHK_Exp_EM016=T AND FILESIZE("%fld_Results%EM016D_TooMuch_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM016D)) OPEN EM016D_TooMuch_SickLv
IF (CHK_Exp_EM016=T AND FILESIZE("%fld_Results%EM016D_TooMuch_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM016D)) %v_EXPORT% FIELDS %v_Exp_Fields_EM016D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM016D_TooMuch_SickLv%suffix%" %v_fileOpt%
COMM
IF (CHK_Exp_EM017=T AND FILESIZE("%fld_Results%EM017_Neg_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM017)) OPEN EM017_Neg_SickLv
IF (CHK_Exp_EM017=T AND FILESIZE("%fld_Results%EM017_Neg_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM017)) %v_EXPORT% FIELDS %v_Exp_Fields_EM016%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM016_Neg_SickLv%suffix%" %v_fileOpt%
COMM
IF (CHK_Exp_EM017=T AND FILESIZE("%fld_Results%EM017D_Neg_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM017D)) OPEN EM017D_Neg_SickLv
IF (CHK_Exp_EM017=T AND FILESIZE("%fld_Results%EM017D_Neg_SickLv.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_EM017D)) %v_EXPORT% FIELDS %v_Exp_Fields_EM016D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%EM016D_Neg_SickLv%suffix%" %v_fileOpt%



COMM *** %v_EXPORT% Payroll Tests ***
COMM
IF (CHK_Exp_PR001=T AND FILESIZE("%fld_Results%PR001_Mul_Paid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR001)) OPEN PR001_Mul_Paid
%v_cmt% IF (CHK_Exp_PR001=T AND FILESIZE("%fld_Results%PR001_Mul_Paid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR001)) COUNT
IF (CHK_Exp_PR001=T AND FILESIZE("%fld_Results%PR001_Mul_Paid.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR001)) %v_EXPORT% FIELDS %v_Exp_Fields_PR001%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR001_Mul_Paid" %v_fileOpt%
COMM
IF (CHK_Exp_PR002=T AND FILESIZE("%fld_Results%PR002_Not_in_Emf.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR002)) OPEN PR002_Not_in_Emf
%v_cmt% IF (CHK_Exp_PR002=T AND FILESIZE("%fld_Results%PR002_Not_in_Emf.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR002)) COUNT
IF (CHK_Exp_PR002=T AND FILESIZE("%fld_Results%PR002_Not_in_Emf.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR002)) %v_EXPORT% FIELDS %v_Exp_Fields_PR002%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR002_Not_in_Emf" %v_fileOpt%
COMM
IF (CHK_Exp_PR003=T AND FILESIZE("%fld_Results%PR003_Pay_30D_Af_Trm.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR003)) OPEN PR003_Pay_30D_Af_Trm
%v_cmt% IF (CHK_Exp_PR003=T AND FILESIZE("%fld_Results%PR003_Pay_30D_Af_Trm.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR003)) COUNT
IF (CHK_Exp_PR003=T AND FILESIZE("%fld_Results%PR003_Pay_30D_Af_Trm.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR003)) %v_EXPORT% FIELDS %v_Exp_Fields_PR003%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR003_Pay_30D_Af_Trm" %v_fileOpt%
COMM
IF (CHK_Exp_PR004=T AND FILESIZE("%fld_Results%PR004_Spec_Leave_3Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR004)) OPEN PR004_Spec_Leave_3Mon
%v_cmt% IF (CHK_Exp_PR004=T AND FILESIZE("%fld_Results%PR004_Spec_Leave_3Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR004)) COUNT
IF (CHK_Exp_PR004=T AND FILESIZE("%fld_Results%PR004_Spec_Leave_3Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR004)) %v_EXPORT% FIELDS %v_Exp_Fields_PR004%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR004_Spec_Leave_3Mon" %v_fileOpt%
COMM
IF (CHK_Exp_PR005=T AND FILESIZE("%fld_Results%PR005_Pay_TrmAmt_Sleeper.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR005)) OPEN PR005_Pay_TrmAmt_Sleeper
%v_cmt% IF (CHK_Exp_PR005=T AND FILESIZE("%fld_Results%PR005_Pay_TrmAmt_Sleeper.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR005)) COUNT
IF (CHK_Exp_PR005=T AND FILESIZE("%fld_Results%PR005_Pay_TrmAmt_Sleeper.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR005)) %v_EXPORT% FIELDS %v_Exp_Fields_PR005%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR005_Pay_TrmAmt_Sleeper" %v_fileOpt%
COMM
IF (CHK_Exp_PR006=T AND FILESIZE("%fld_Results%PR006_Unusual_Super.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR006)) OPEN PR006_Unusual_Super
%v_cmt% IF (CHK_Exp_PR006=T AND FILESIZE("%fld_Results%PR006_Unusual_Super.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR006)) COUNT
IF (CHK_Exp_PR006=T AND FILESIZE("%fld_Results%PR006_Unusual_Super.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR006)) %v_EXPORT% FIELDS %v_Exp_Fields_PR006%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR006_Unusual_Super" %v_fileOpt%
COMM
IF (CHK_Exp_PR007=T AND FILESIZE("%fld_Results%PR007_Hourly_Emp.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR007)) OPEN PR007_Hourly_Emp
%v_cmt% IF (CHK_Exp_PR007=T AND FILESIZE("%fld_Results%PR007_Hourly_Emp.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR007)) COUNT
IF (CHK_Exp_PR007=T AND FILESIZE("%fld_Results%PR007_Hourly_Emp.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR007)) %v_EXPORT% FIELDS %v_Exp_Fields_PR007%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR007_Hourly_Emp" %v_fileOpt%
COMM
IF (CHK_Exp_PR008=T AND FILESIZE("%fld_Results%PR008_Top_xx_Over_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR008)) OPEN PR008_Top_xx_Over_xx_Mon
%v_cmt% IF (CHK_Exp_PR008=T AND FILESIZE("%fld_Results%PR008_Top_xx_Over_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR008)) COUNT
IF (CHK_Exp_PR008=T AND FILESIZE("%fld_Results%PR008_Top_xx_Over_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR008)) %v_EXPORT% FIELDS %v_Exp_Fields_PR008%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR008_Top_xx_Over_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_PR008=T AND FILESIZE("%fld_Results%PR008D_Top_xx_Over_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR008D)) OPEN PR008D_Top_xx_Over_xx_Mon
%v_cmt% IF (CHK_Exp_PR008=T AND FILESIZE("%fld_Results%PR008D_Top_xx_Over_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR008D)) COUNT
IF (CHK_Exp_PR008=T AND FILESIZE("%fld_Results%PR008D_Top_xx_Over_xx_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR008D)) %v_EXPORT% FIELDS %v_Exp_Fields_PR008D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR008D_Top_xx_Over_xx_Mon" %v_fileOpt%
COMM
IF (CHK_Exp_PR009=T AND FILESIZE("%fld_Results%PR009_Pay_x_Times_Avg.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR009)) OPEN PR009_Pay_x_Times_Avg
%v_cmt% IF (CHK_Exp_PR009=T AND FILESIZE("%fld_Results%PR009_Pay_x_Times_Avg.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR009)) COUNT
IF (CHK_Exp_PR009=T AND FILESIZE("%fld_Results%PR009_Pay_x_Times_Avg.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR009)) %v_EXPORT% FIELDS %v_Exp_Fields_PR009%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR009_Pay_x_Times_Avg" %v_fileOpt%
COMM
IF (CHK_Exp_PR009=T AND FILESIZE("%fld_Results%PR009D_Pay_x_Times_Avg.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR009D)) OPEN PR009D_Pay_x_Times_Avg
%v_cmt% IF (CHK_Exp_PR009=T AND FILESIZE("%fld_Results%PR009D_Pay_x_Times_Avg.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR009D)) COUNT
IF (CHK_Exp_PR009=T AND FILESIZE("%fld_Results%PR009D_Pay_x_Times_Avg.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_PR009D)) %v_EXPORT% FIELDS %v_Exp_Fields_PR009D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%PR009D_Pay_x_Times_Avg" %v_fileOpt%
COMM
COMM *** %v_EXPORT% Statistics Summary Reports ***
IF (CHK_Exp_ST001=T AND FILESIZE("%fld_Results%ST001_Vnd_Tst_Sum.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST001)) OPEN ST001_Vnd_Tst_Sum
%v_cmt% IF (CHK_Exp_ST001=T AND FILESIZE("%fld_Results%ST001_Vnd_Tst_Sum.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST001)) COUNT
IF (CHK_Exp_ST001=T AND FILESIZE("%fld_Results%ST001_Vnd_Tst_Sum.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST001)) %v_EXPORT% FIELDS %v_Exp_Fields_ST001%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%ST001_Vnd_Tst_Sum" %v_fileOpt%
COMM
IF (CHK_Exp_ST001=T AND FILESIZE("%fld_Results%ST001D_Vnd_Tst_Sum.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST001D)) OPEN ST001D_Vnd_Tst_Sum
%v_cmt% IF (CHK_Exp_ST001=T AND FILESIZE("%fld_Results%ST001D_Vnd_Tst_Sum.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST001D)) COUNT
IF (CHK_Exp_ST001=T AND FILESIZE("%fld_Results%ST001D_Vnd_Tst_Sum.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST001D)) %v_EXPORT% FIELDS %v_Exp_Fields_ST001D%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%ST001D_Vnd_Tst_Sum" %v_fileOpt%
COMM
IF (CHK_Exp_ST002=T AND FILESIZE("%fld_Results%ST002_Rev_Sum_RevDays.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST002)) OPEN ST002_Rev_Sum_RevDays
%v_cmt% IF (CHK_Exp_ST002=T AND FILESIZE("%fld_Results%ST002_Rev_Sum_RevDays.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST002)) COUNT
IF (CHK_Exp_ST002=T AND FILESIZE("%fld_Results%ST002_Rev_Sum_RevDays.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST002)) %v_EXPORT% FIELDS %v_Exp_Fields_ST002%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%ST002_Rev_Sum_RevDays" %v_fileOpt%
COMM
IF (CHK_Exp_ST003=T AND FILESIZE("%fld_Results%ST003_Rev_Vnd_Dup.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST003)) OPEN ST003_Rev_Vnd_Dup
%v_cmt% IF (CHK_Exp_ST003=T AND FILESIZE("%fld_Results%ST003_Rev_Vnd_Dup.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST003)) COUNT
IF (CHK_Exp_ST003=T AND FILESIZE("%fld_Results%ST003_Rev_Vnd_Dup.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST003)) %v_EXPORT% FIELDS %v_Exp_Fields_ST003%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%ST003_Rev_Vnd_Dup" %v_fileOpt%
COMM
IF (CHK_Exp_ST004=T AND FILESIZE("%fld_Results%ST004_Vnd_Ranking.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST004)) OPEN ST004_Vnd_Ranking
%v_cmt% IF (CHK_Exp_ST004=T AND FILESIZE("%fld_Results%ST004_Vnd_Ranking.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST004)) COUNT
IF (CHK_Exp_ST004=T AND FILESIZE("%fld_Results%ST004_Vnd_Ranking.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST004)) %v_EXPORT% FIELDS %v_Exp_Fields_ST004%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%ST004_Vnd_Ranking" %v_fileOpt%
COMM
IF (CHK_Exp_ST005=T AND FILESIZE("%fld_Results%ST005_Distr_Inv_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST005)) OPEN ST005_Distr_Inv_Mon
%v_cmt% IF (CHK_Exp_ST005=T AND FILESIZE("%fld_Results%ST005_Distr_Inv_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST005)) COUNT
IF (CHK_Exp_ST005=T AND FILESIZE("%fld_Results%ST005_Distr_Inv_Mon.fil") >= 0 AND NOT ISBLANK(v_Exp_Fields_ST005)) %v_EXPORT% FIELDS %v_Exp_Fields_ST005%  %v_exporttype% TO "%TXT_Exp_filepath%%v_Pre%ST005_Distr_Inv_Mon" %v_fileOpt%


SET SAFETY ON

^BATCH    VM008_Can_ABN                      
[PARENT_FOLDER_ID] 1340167398
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Vendor Master File Exception Tests
COMM *** VM008. Identify Vendors with invalid or inactive ABN Number (cancelled)
COMM *** AP015. Identify invoices with Inv_Dt >=Cancelled Effective Date
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_VMF")="U" OR FTYPE("trg_AP_Inv")="U" OR  FTYPE("trg_VMF")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%
DELETE FORMAT ABN_ASIC OK
 
v_TestNo="VM008"

COMM *** Importing data For ABN tests ***
DO VMZ02_Import_ABR

IF FTYPE("ABN_ASIC")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF%.FIL")<=0 Errmsg=Errmsg+" VM008"
IF FTYPE("ABN_ASIC")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF%.FIL")<=0 ESCAPE

COMM *** IF ABR website connection failed, then escape, don't process this test ***
OPEN ABN_ASIC
SET FILTER TO ASIC_entityStatusCode="Connection erro"
COUNT
IF COUNT1>0 Errmsg=Errmsg+" VM008"
IF COUNT1>0 ESCAPE
SET FILTER 

COMM ***Start run test ***
OPEN VMF_Vnd_Master_File
DEFINE RELATION ABN_CLN WITH ABN_ASIC INDEX INXABN

EXTRACT FIELDS %v_flds_VMF% ABN_ASIC.ASIC_entityStatusCode CTOD(ABN_ASIC.ASIC_entityStatusEF,"YYYY-MM-DD") AS "ASIC_entityStatusEF" CTOD(ABN_ASIC.ASIC_GST_effFrom,"YYYY-MM-DD") AS "ASIC_GST_effFrom" CTOD(ABN_ASIC.ASIC_GST_effTo,"YYYY-MM-DD") AS "ASIC_GST_effTo" ABN_ASIC.ASIC_entityDescription AP_Vnd_InvGst_Sum.Inv_Amt AP_Vnd_InvGst_Sum.GST_Amt AP_Vnd_InvGst_Sum.COUNT IF Vndr_Sts="A" AND (MATCH(ABN_ASIC.ASIC_entityStatusCode,"Cancelled")) AND UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  TO "%fld_Tmps%TMP1" OPEN

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_Site_ID)+"~"+ALLTRIM(ABN_CLN),1,85)

COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***
EXTRACT FIELDS ALL TO "%fld_Tmps%TMP_Vnd" OPEN
INDEX ON Vndr_Site_ID TO IDX_TMP_VndrSiteID

COMM *** VM008D/AP016. Identify invoices with Inv_Dt >Cancelled Effective Date ***

OPEN AP_Invoices
DEFINE RELATION Vndr_Site_ID WITH TMP_Vnd INDEX IDX_TMP_VndrSiteID
SORT ON Vndr_ID c_Inv_Dt D IF Vndr_ID=TMP_Vnd.Vndr_ID AND Inv_Dt > TMP_Vnd.ASIC_entityStatusEF TO "%fld_Tmps%TMP_VM008" OPEN

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ALLTRIM(Vndr_ID)+"~"+ALLTRIM(c_Inv_Dt)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Vndr_ID c_Inv_Date D"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "H"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "VM008D. Identify Transactions with Inv_Dt >Cancelled ABN Effective Date"

SET FOLDER /%fld_Results%
SUMMARIZE ON Vndr_Site_ID Vndr_ID SUBTOTAL GST_Amt Inv_Amt TO "%fld_Results%VM008Z_Can_ABN_Sum.FIL" OPEN PRESORT
INDEX ON Vndr_Site_ID TO IDX_VM008Z_VndrSiteID

OPEN TMP_Vnd
DEFINE RELATION Vndr_Site_ID WITH VM008Z_Can_ABN_Sum INDEX IDX_VM008Z_VndrSiteID

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ZONED(VM008Z_Can_ABN_Sum.Inv_Amt,15)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Total_InvAmt_Post_Cancelled_Date"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate  

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "H"

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED "VM008. Identify Deregistered/Cancelled ABN"

SORT ON SORT_KEY D TO "%fld_Results%VM008_Can_ABN" OPEN
INDEX ON Vndr_Site_ID TO IDX_VM008_VndrSiteID
DEFINE RELATION Vndr_Site_ID WITH VM008Z_Can_ABN_Sum INDEX IDX_VM008Z_VndrSiteID

OPEN TMP_VM008
DEFINE RELATION Vndr_Site_ID WITH VM008_can_ABN INDEX IDX_VM008_VndrSiteID

EXTRACT FIELDS ALL TMP_Vnd.ASIC_entityStatusEF IF NOT ISBLANK(VM008_can_ABN.Vndr_ID) AND  UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"   TO "%fld_Results%VM008D_Can_ABN"  OPEN
DEFINE RELATION Vndr_Site_ID WITH VM008_can_ABN INDEX IDX_VM008_VndrSiteID

SET FOLDER /%fld_Tmps%
v_Exp_Fields_VM008D = "VM008_can_ABN.Cha_Field1 AS 'Vendor Site'  Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status'  ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID'  Vchr_ID AS 'Trans Num'  Cha_Field2 AS 'Pay Method' Pymnt_Trms AS 'Payment Method' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"
 OPEN VM008D_Can_ABN
 EXTRACT %v_Exp_Fields_VM008D% TO  TMP_VM008D


SET FOLDER /%fld_Results%
OPEN AP_Invoices

DELETE RELATION TMP_Vnd OK
OPEN TMP_Vnd
DELETE RELATION VM008Z_Can_ABN_Sum  OK
OPEN TMP_VM008
DELETE RELATION VM008_can_ABN OK

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON


^FORMAT   GreyList_AP014                     GreyList_AP014                   "Working_Files" "GreyList_AP014.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1427252735
~.27/08/2015   04:02:27 TMP2 EXTRACT FIELDS SUBSTR(ALLTRIM(F1),1,20) AS 'Vndr_Site_ID' SUBSTR(ALLTRIM(F2),1,60) AS 'Vndr_Name' IF NOT ISBLANK(F1) AND RECNO()>1 TO "Working_Files\GreyList_AP014.fil"
~Input : Records:1           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_GreyList_AP014_Vndr_Site_ID    GreyList_AP014                   "" "IDX_GreyList_AP014_Vndr_Site_ID.INX" 
*INDEX ON VNDR_SITE_ID TO IDX_GREYLIST_AP014_VNDR_SITE_ID
^INDEX    IDX_AP014_History_ID_KEY           AP014_History                    "" "IDX_AP014_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_AP014_HISTORY_ID_KEY
^FORMAT   AP014_History                      AP014_History                    "History" "AP014_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~**** SOME HISTORY DELETED ****
~.11/08/2015   18:55:02 AP_VendorMaster_ALL EXTRACT FIELDS ALL 'R11' AS 'SourceFlag' TO "AP_VendorMaster_ALL_FMT.FIL"  IF c_SITE_LAST_UPDATE_DATE>=CTOD(_Data_Range_From_VM,"DD/MM/YYYY") OR c_HEADER_LAST_UPDATE_DATE>=CTOD(_Data_Range_From_VM,"DD/MM/YYYY")
~Input : Records:64526       Control Total:0                    
~Output: Records:64526       Control Total:0                    
~.11/08/2015   18:55:15 AP_VendorMaster_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Co' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NAME),1,73))) AS 'Vndr_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ABN),1,20))) AS 'ABN' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_STATUS),1,1))) AS 'Vndr_Sts' CTOD('', 'DD/MM/YYYY') AS 'Vndr_InvlDt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_TYPE),1,11))) AS 'Vndr_Typ' BLANKS(15) AS 'Vndr_Add_Typ' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ADDRESS),1,125))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(CITY),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(STATE),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(POSTCODE),1,12))) AS 'Pcode' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(COUNTRY),1,61))) AS 'Cntry' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Tel),1,21))) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Fax),1,21))) AS 'FAX' BLANKS(60) AS 'Email1' BLANKS(60) AS 'Email2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_METHOD),1,21))) AS 'Pymnt_Trm' c_SITE_CREATION_DATE AS 'Created_Dt' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE),1,30))) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_REGISTRATION_STATUS),1,30))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(SourceFlag),1,3))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NUMBER),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' c_SITE_INACTIVE_DATE AS 'Dt_Field1' c_SITE_CREATION_DATE AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3'   TO "Working_Files\VMF_Vnd_Master_File.FIL"
~Input : Records:64526       Control Total:0                    
~Output: Records:64526       Control Total:0                    
~.11/08/2015   18:56:31 VMF_Vnd_Master_File EXTRACT FIELDS VMF_Vnd_Master_File.Vndr_Site_ID VMF_Vnd_Master_File.Co VMF_Vnd_Master_File.Vndr_ID VMF_Vnd_Master_File.Vndr_Nme VMF_Vnd_Master_File.ABN VMF_Vnd_Master_File.Vndr_Sts VMF_Vnd_Master_File.Vndr_Typ VMF_Vnd_Master_File.Vndr_Add_Typ VMF_Vnd_Master_File.ADD1 VMF_Vnd_Master_File.ADD2 VMF_Vnd_Master_File.ADD3 VMF_Vnd_Master_File.City VMF_Vnd_Master_File.State VMF_Vnd_Master_File.Pcode VMF_Vnd_Master_File.Cntry VMF_Vnd_Master_File.TEL1 VMF_Vnd_Master_File.TEL2 VMF_Vnd_Master_File.TEL3 VMF_Vnd_Master_File.FAX VMF_Vnd_Master_File.Email1 VMF_Vnd_Master_File.Email2 VMF_Vnd_Master_File.Pymnt_Trm CTOD(DATE(VMF_Vnd_Master_File.Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(VMF_Vnd_Master_File.Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(VMF_Vnd_Master_File.Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' VMF_Vnd_Master_File.Cha_Field1 VMF_Vnd_Master_File.Cha_Field2 VMF_Vnd_Master_File.Cha_Field3 VMF_Vnd_Master_File.Cha_Field4 VMF_Vnd_Master_File.Cha_Field5 VMF_Vnd_Master_File.Num_Field1 VMF_Vnd_Master_File.Num_Field2 VMF_Vnd_Master_File.Num_Field3 VMF_Vnd_Master_File.Num_Field4 VMF_Vnd_Master_File.Num_Field5 CTOD(DATE(VMF_Vnd_Master_File.Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' VMF_Vnd_Master_File.ABN_CLN VMF_Vnd_Master_File.Max_Inv_Dt VMF_Vnd_Master_File.c_Vndr_ID IF Dt_Field2<=CTOD(DATE(_RptRunDate-540),"DD/MM/YYYY") AND (TMP1.COUNT=0 OR TMP1.Inv_Amt=0.00) AND  VMF_Vnd_Master_File.Vndr_Sts="A" TO "Tmp_Files\TMP2" OPEN
~Input : Records:64526       Control Total:0                    
~Output: Records:3837        Control Total:0                    
~.11/08/2015   18:56:31 TMP2 EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:3837        Control Total:0                    
~Output: Records:3837        Control Total:0                    
~.11/08/2015   18:56:31 TMP_GL EXTRACT FIELDS ALL IF Vndr_Site_ID<> GreyList_AP014.Vndr_Site_ID TO TMP_GL1 OPEN
~Input : Records:3837        Control Total:0                    
~Output: Records:3837        Control Total:0                    
~.11/08/2015   18:56:31 TMP_GL1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:3837        Control Total:0                    
~Output: Records:3837        Control Total:0                    
~.11/08/2015   18:56:31 TMP_Cur IF FTYPE("AP014_History")<>"y" OR FILESIZE("History\AP014_History.fil") <0 EXTRACT FIELDS ALL FIRST 0 TO "History\AP014_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.11/08/2015   18:56:31 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ID_KEY TO "History\AP014_History"APPEND
~Input : Records:3837        Control Total:0                    
~Output: Records:3837        Control Total:0                    
~.13/08/2015   04:27:50 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ID_KEY TO "History\AP014_History"APPEND
~Input : Records:50          Control Total:0                    
~Output: Records:50          Control Total:0                    
~.14/08/2015   04:26:17 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ID_KEY TO "History\AP014_History"APPEND
~Input : Records:17          Control Total:0                    
~Output: Records:17          Control Total:0                    
~.14/08/2015   11:09:25 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ID_KEY TO "History\AP014_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.17/08/2015   04:25:48 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ID_KEY TO "History\AP014_History"APPEND
~Input : Records:37          Control Total:0                    
~Output: Records:37          Control Total:0                    
~.18/08/2015   04:27:53 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ID_KEY TO "History\AP014_History"APPEND
~Input : Records:8           Control Total:0                    
~Output: Records:8           Control Total:0                    
~.19/08/2015   04:27:39 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ID_KEY TO "History\AP014_History"APPEND
~Input : Records:19          Control Total:0                    
~Output: Records:19          Control Total:0                    
~.20/08/2015   04:25:10 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ID_KEY TO "History\AP014_History"APPEND
~Input : Records:24          Control Total:0                    
~Output: Records:24          Control Total:0                    
~.21/08/2015   04:33:39 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ID_KEY TO "History\AP014_History"APPEND
~Input : Records:45          Control Total:0                    
~Output: Records:45          Control Total:0                    
~.24/08/2015   04:02:21 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ID_KEY TO "History\AP014_History"APPEND
~Input : Records:57          Control Total:0                    
~Output: Records:57          Control Total:0                    
~.24/08/2015   08:34:07 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ID_KEY TO "History\AP014_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.25/08/2015   04:02:08 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ID_KEY TO "History\AP014_History"APPEND
~Input : Records:21          Control Total:0                    
~Output: Records:21          Control Total:0                    
~.26/08/2015   04:02:03 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ID_KEY TO "History\AP014_History"APPEND
~Input : Records:27          Control Total:0                    
~Output: Records:27          Control Total:0                    
~.27/08/2015   04:02:28 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ID_KEY TO "History\AP014_History"APPEND
~Input : Records:32          Control Total:0                    
~Output: Records:32          Control Total:0                    
^BATCH    CB002_Pre_AP_VM                    
[PARENT_FOLDER_ID] 1341537122
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** User can customize data after importing source data
COMM *** Prepare the data for the mapping/conversion  -- AP Invoices, PO Items and Vendor Master File
COMM *** CREATED BY SOO RUGDEE 28082015
COMM***************************************************************************


IF FTYPE("fld_Sources")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET FOLDER /%fld_Tmps%
SET DATE "DD/MM/YYYY"



SET FOLDER /%fld_Sources%

COMM Prepare Invoices
OPEN AP_INVOICES_ALL
DELETE FIELD c_MONTH OK
DEFINE FIELD c_MONTH COMPUTED 

"01" IF SUBSTR(INVOICE_DATE,4,3) = 'JAN' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"02" IF SUBSTR(INVOICE_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"03" IF SUBSTR(INVOICE_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"04" IF SUBSTR(INVOICE_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"05" IF SUBSTR(INVOICE_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"06" IF SUBSTR(INVOICE_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"07" IF SUBSTR(INVOICE_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"08" IF SUBSTR(INVOICE_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"09" IF SUBSTR(INVOICE_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"10" IF SUBSTR(INVOICE_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"11" IF SUBSTR(INVOICE_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"12" IF SUBSTR(INVOICE_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"00"


DELETE FIELD c_DAY OK
DEFINE FIELD c_DAY COMPUTED SUBSTR(INVOICE_DATE,1,2) 

DELETE FIELD c_YEAR OK
DEFINE FIELD c_YEAR COMPUTED 

"20"+ SUBSTR(INVOICE_DATE,8,2) IF  LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
SUBSTR(INVOICE_DATE,6,4)

DELETE FIELD c_INVOICE_DATE_CLN OK
DEFINE FIELD c_INVOICE_DATE_CLN COMPUTED c_DAY + '/' + c_MONTH + '/' + c_YEAR

DELETE FIELD c_INVOICE_DATE OK
DEFINE FIELD  c_INVOICE_DATE COMPUTED 

CTOD(c_INVOICE_DATE_CLN ,'DD/MM/YYYY' ) IF LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
CTOD(INVOICE_DATE ,'DD/MM/YYYY' )

DELETE FIELD c_INVOICE_AMOUNT OK
DEFINE FIELD c_INVOICE_AMOUNT COMPUTED VALUE(INVOICE_AMOUNT,2)


DELETE FIELD c_MONTH1 OK
DEFINE FIELD c_MONTH1 COMPUTED 

"01" IF SUBSTR(CANCELLED_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"02" IF SUBSTR(CANCELLED_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"03" IF SUBSTR(CANCELLED_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"04" IF SUBSTR(CANCELLED_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"05" IF SUBSTR(CANCELLED_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"06" IF SUBSTR(CANCELLED_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"07" IF SUBSTR(CANCELLED_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"08" IF SUBSTR(CANCELLED_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"09" IF SUBSTR(CANCELLED_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"10" IF SUBSTR(CANCELLED_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"11" IF SUBSTR(CANCELLED_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"12" IF SUBSTR(CANCELLED_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"00"

DELETE FIELD c_DAY1 OK
DEFINE FIELD c_DAY1 COMPUTED SUBSTR(CANCELLED_DATE,1,2)

DELETE FIELD c_YEAR1 OK
DEFINE FIELD c_YEAR1 COMPUTED 

"20"+ SUBSTR(CANCELLED_DATE,8,2) IF LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(INVOICE_DATE,8,2),0) <= 30
"19"+ SUBSTR(CANCELLED_DATE,8,2) IF LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(INVOICE_DATE,8,2),0) > 30
SUBSTR(CANCELLED_DATE,6,4)

DELETE FIELD c_CANCELLED_DATE_CLN OK
DEFINE FIELD c_CANCELLED_DATE_CLN COMPUTED c_DAY1 + '/' + c_MONTH1 + '/' + c_YEAR1

DELETE FIELD c_CANCELLED_DATE OK
DEFINE FIELD c_CANCELLED_DATE COMPUTED 

CTOD(c_CANCELLED_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(INVOICE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
CTOD(CANCELLED_DATE ,'DD/MM/YYYY' )


EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")

v_invoice_count = 0
OPEN AP_INVOICES_ALL_FMT
COUNT
v_invoice_count = COUNT1

COMM Prepare Vendor Master
OPEN AP_VendorMaster_ALL

DELETE FIELD c_VENDOR_ID OK
DEFINE FIELD c_VENDOR_ID COMPUTED REPLACE(ALLTRIM(VENDOR_ID_),'~','') 

COMM Transform character based Date to DD/MM/YYYY for Header_Inactive_Date

DELETE FIELD c_MONTH2 OK
DEFINE FIELD c_MONTH2 COMPUTED 

"01" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"02" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"03" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"04" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"05" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"06" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"07" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"08" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"09" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"10" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"11" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"12" IF SUBSTR(HEADER_INACTIVE_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"00"

DELETE FIELD c_DAY2 OK
DEFINE FIELD c_DAY2 COMPUTED SUBSTR(HEADER_INACTIVE_DATE,1,2)

DELETE FIELD c_YEAR2 OK
DEFINE FIELD c_YEAR2 COMPUTED 

"20"+ SUBSTR(HEADER_INACTIVE_DATE,8,2) IF LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(HEADER_INACTIVE_DATE,8,2),0) <= 30
"19"+ SUBSTR(HEADER_INACTIVE_DATE,8,2) IF LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(HEADER_INACTIVE_DATE,8,2),0) > 30
SUBSTR(HEADER_INACTIVE_DATE,6,4)

DELETE FIELD c_HEADER_INACTIVE_DATE_CLN OK
DEFINE FIELD c_HEADER_INACTIVE_DATE_CLN COMPUTED c_DAY2 + '/' + c_MONTH2 + '/' + c_YEAR2

DELETE FIELD c_HEADER_INACTIVE_DATE OK
DEFINE FIELD c_HEADER_INACTIVE_DATE COMPUTED 

CTOD(c_HEADER_INACTIVE_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(HEADER_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 
CTOD(c_HEADER_INACTIVE_DATE_CLN ,'DD/MM/YYYY' )

COMM Header Inactive Date Transform --

COMM Transform character based Date to DD/MM/YYYY for SITE_INACTIVE_DATE

DELETE FIELD c_MONTH3 OK
DEFINE FIELD c_MONTH3 COMPUTED 

"01" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"02" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"03" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"04" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"05" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"06" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"07" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"08" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"09" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"10" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"11" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"12" IF SUBSTR(SITE_INACTIVE_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"00"

DELETE FIELD c_DAY3 OK
DEFINE FIELD c_DAY3 COMPUTED SUBSTR(SITE_INACTIVE_DATE,1,2)

DELETE FIELD c_YEAR3 OK
DEFINE FIELD c_YEAR3 COMPUTED 

"20"+ SUBSTR(SITE_INACTIVE_DATE,8,2) IF LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(SITE_INACTIVE_DATE,8,2),0) <= 30
"19"+ SUBSTR(SITE_INACTIVE_DATE,8,2) IF LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(SITE_INACTIVE_DATE,8,2),0) > 30
SUBSTR(SITE_INACTIVE_DATE,6,4)


DELETE FIELD c_SITE_INACTIVE_DATE_CLN OK
DEFINE FIELD c_SITE_INACTIVE_DATE_CLN COMPUTED c_DAY3 + '/' + c_MONTH3 + '/' + c_YEAR3

DELETE FIELD c_SITE_INACTIVE_DATE OK
DEFINE FIELD c_SITE_INACTIVE_DATE COMPUTED 

CTOD(c_SITE_INACTIVE_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(SITE_INACTIVE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
CTOD(c_SITE_INACTIVE_DATE_CLN ,'DD/MM/YYYY' )

COMM SITE_INACTIVE_DATE Transform --


COMM Transform character based Date to DD/MM/YYYY for HEADER_CREATION_DATE

DELETE FIELD c_MONTH4 OK
DEFINE FIELD c_MONTH4 COMPUTED 

"01" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"02" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"03" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"04" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"05" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"06" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"07" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"08" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"09" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"10" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"11" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"12" IF SUBSTR(HEADER_CREATION_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"00"

DELETE FIELD c_DAY4 OK
DEFINE FIELD c_DAY4 COMPUTED SUBSTR(HEADER_CREATION_DATE,1,2)

DELETE FIELD c_YEAR4 OK
DEFINE FIELD c_YEAR4 COMPUTED 

"20"+ SUBSTR(HEADER_CREATION_DATE,8,2) IF LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(HEADER_CREATION_DATE,8,2),0) <= 30
"19"+ SUBSTR(HEADER_CREATION_DATE,8,2) IF LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(HEADER_CREATION_DATE,8,2),0) > 30
SUBSTR(HEADER_CREATION_DATE,6,4)

DELETE FIELD c_HEADER_CREATION_DATE_CLN OK
DEFINE FIELD c_HEADER_CREATION_DATE_CLN COMPUTED c_DAY4 + '/' + c_MONTH4 + '/' + c_YEAR4

DELETE FIELD c_HEADER_CREATION_DATE OK
DEFINE FIELD c_HEADER_CREATION_DATE COMPUTED 

CTOD(c_HEADER_CREATION_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(HEADER_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
CTOD(c_HEADER_CREATION_DATE_CLN ,'DD/MM/YYYY' )

COMM HEADER_CREATION_DATE Transform --

COMM Transform character based Date to DD/MM/YYYY for SITE_CREATION_DATE

DELETE FIELD c_MONTH5 OK
DEFINE FIELD c_MONTH5 COMPUTED 

"01" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"02" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"03" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"04" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"05" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"06" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"07" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"08" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"09" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"10" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"11" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"12" IF SUBSTR(SITE_CREATION_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"00"

DELETE FIELD c_DAY5 OK
DEFINE FIELD c_DAY5 COMPUTED SUBSTR(SITE_CREATION_DATE,1,2)

DELETE FIELD c_YEAR5 OK
DEFINE FIELD c_YEAR5 COMPUTED 

"20"+ SUBSTR(SITE_CREATION_DATE,8,2) IF LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(SITE_CREATION_DATE,8,2),0) <= 30
"19"+ SUBSTR(SITE_CREATION_DATE,8,2) IF LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(SITE_CREATION_DATE,8,2),0) > 30
SUBSTR(SITE_CREATION_DATE,6,4)

DELETE FIELD c_SITE_CREATION_DATE_CLN OK
DEFINE FIELD c_SITE_CREATION_DATE_CLN COMPUTED c_DAY5 + '/' + c_MONTH5 + '/' + c_YEAR5

DELETE FIELD c_SITE_CREATION_DATE OK
DEFINE FIELD c_SITE_CREATION_DATE COMPUTED 

CTOD(c_SITE_CREATION_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(SITE_CREATION_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
CTOD(c_SITE_CREATION_DATE_CLN ,'DD/MM/YYYY' )

COMM SITE_CREATION_DATE Transform --

COMM HEADER_LAST_UPDATE_DATE Transform --

COMM Transform character based Date to DD/MM/YYYY for HEADER_LAST_UPDATE_DATE

DELETE FIELD c_MONTH8 OK
DEFINE FIELD c_MONTH8 COMPUTED 

"01" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"02" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"03" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"04" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"05" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"06" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"07" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"08" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"09" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"10" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"11" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"12" IF SUBSTR(HEADER_LAST_UPDATE_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"00"

DELETE FIELD c_DAY8 OK
DEFINE FIELD c_DAY8 COMPUTED SUBSTR(HEADER_LAST_UPDATE_DATE,1,2)

DELETE FIELD c_YEAR8 OK
DEFINE FIELD c_YEAR8 COMPUTED 

"20"+ SUBSTR(HEADER_LAST_UPDATE_DATE,8,2) IF LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(HEADER_LAST_UPDATE_DATE,8,2),0) <= 30
"19"+ SUBSTR(HEADER_LAST_UPDATE_DATE,8,2) IF LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(HEADER_LAST_UPDATE_DATE,8,2),0) > 30
SUBSTR(HEADER_LAST_UPDATE_DATE,6,4)

DELETE FIELD c_HEADER_LAST_UPDATE_DATE_CLN OK
DEFINE FIELD c_HEADER_LAST_UPDATE_DATE_CLN COMPUTED c_DAY8 + '/' + c_MONTH8 + '/' + c_YEAR8

DELETE FIELD c_HEADER_LAST_UPDATE_DATE OK
DEFINE FIELD c_HEADER_LAST_UPDATE_DATE COMPUTED 

CTOD(c_HEADER_LAST_UPDATE_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(HEADER_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
CTOD(c_HEADER_LAST_UPDATE_DATE_CLN ,'DD/MM/YYYY' )

COMM HEADER_LAST_UPDATE_DATE Transform --

COMM SITE_LAST_UPDATE_DATE Transform --

COMM Transform character based Date to DD/MM/YYYY for SITE_LAST_UPDATE_DATE

DELETE FIELD c_MONTH9 OK
DEFINE FIELD c_MONTH9 COMPUTED 

"01" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"02" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"03" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"04" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"05" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"06" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"07" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"08" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"09" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"10" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"11" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"12" IF SUBSTR(SITE_LAST_UPDATE_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"00"

DELETE FIELD c_DAY9 OK
DEFINE FIELD c_DAY9 COMPUTED SUBSTR(SITE_LAST_UPDATE_DATE,1,2)

DELETE FIELD c_YEAR9 OK
DEFINE FIELD c_YEAR9 COMPUTED 

"20"+ SUBSTR(SITE_LAST_UPDATE_DATE,8,2) IF LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(SITE_LAST_UPDATE_DATE,8,2),0) <= 30
"19"+ SUBSTR(SITE_LAST_UPDATE_DATE,8,2) IF LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(SITE_LAST_UPDATE_DATE,8,2),0) > 30
SUBSTR(SITE_LAST_UPDATE_DATE,6,4)

DELETE FIELD c_SITE_LAST_UPDATE_DATE_CLN OK
DEFINE FIELD c_SITE_LAST_UPDATE_DATE_CLN COMPUTED c_DAY9 + '/' + c_MONTH9 + '/' + c_YEAR9

DELETE FIELD c_SITE_LAST_UPDATE_DATE OK
DEFINE FIELD c_SITE_LAST_UPDATE_DATE COMPUTED 

CTOD(c_SITE_LAST_UPDATE_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(SITE_LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
CTOD(c_SITE_LAST_UPDATE_DATE_CLN ,'DD/MM/YYYY' )

COMM SITE_LAST_UPDATE_DATE Transform --


DELETE FIELD c_VENDOR_STATUS OK
DEFINE FIELD c_VENDOR_STATUS COMPUTED
c_VENDOR_STATUS
"A" IF c_HEADER_INACTIVE_DATE = `19000101` AND c_SITE_INACTIVE_DATE = `19000101`
"A" IF (c_HEADER_INACTIVE_DATE > TODAY()) OR (c_SITE_INACTIVE_DATE > TODAY())
"I"

DELETE FIELD c_Tel OK
DEFINE FIELD c_Tel COMPUTED INCLUDE(AREA_CODE,'0123456789') + INCLUDE(PHONE,'0123456789')

DELETE FIELD c_Fax OK
DEFINE FIELD c_Fax COMPUTED INCLUDE(AREA_CODE,'0123456789') + INCLUDE(FAX,'0123456789')


COMMENT
EXTRACT BELOW FOR ONGOING VM EXCEPTIONS

EXTRACT FIELDS ALL 'R11' AS 'SourceFlag' TO "AP_VendorMaster_ALL_FMT.FIL"  IF c_SITE_LAST_UPDATE_DATE>=CTOD(_Data_Range_From_VM,"DD/MM/YYYY") OR c_HEADER_LAST_UPDATE_DATE>=CTOD(_Data_Range_From_VM,"DD/MM/YYYY")

v_vm_count = 0
OPEN AP_VendorMaster_ALL_FMT
COUNT
v_vm_count = COUNT1


COMM *** Vendors ***
SET FOLDER /%fld_Sources%


COMM Prepare Vendor Bank Accounts

OPEN AP_VendorMasterBnkAcc_ALL
DELETE FIELD c_VENDOR_ID OK
DEFINE FIELD c_VENDOR_ID COMPUTED REPLACE(ALLTRIM(VENDOR_ID__),'~','')


COMM Transform character based Date to DD/MM/YYYY for ACCT_START_DATE

DELETE FIELD c_MONTH6 OK
DEFINE FIELD c_MONTH6 COMPUTED 

"01" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'JAN' AND  LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"02" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'FEB' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"03" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'MAR' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"04" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'APR' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"05" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'MAY' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"06" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'JUN' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"07" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'JUL' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"08" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'AUG' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"09" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'SEP' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"10" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'OCT' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"11" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'NOV' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"12" IF SUBSTR(_ACCT_START_DATE_,4,3) = 'DEC' AND LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"00"

DELETE FIELD c_DAY6 OK
DEFINE FIELD c_DAY6 COMPUTED SUBSTR(_ACCT_START_DATE_,1,2)

DELETE FIELD c_YEAR6 OK
DEFINE FIELD c_YEAR6 COMPUTED 

"20"+ SUBSTR(_ACCT_START_DATE_,8,2) IF LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(_ACCT_START_DATE_,8,2),0) <= 30
"19"+ SUBSTR(_ACCT_START_DATE_,8,2) IF LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(_ACCT_START_DATE_,8,2),0) > 30
SUBSTR(_ACCT_START_DATE_,6,4)

DELETE FIELD c_ACCT_START_DATE_CLN OK
DEFINE FIELD c_ACCT_START_DATE_CLN COMPUTED c_DAY6 + '/' + c_MONTH6 + '/' + c_YEAR6

DELETE FIELD c_ACCT_START_DATE OK
DEFINE FIELD c_ACCT_START_DATE COMPUTED 

CTOD(c_ACCT_START_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(_ACCT_START_DATE_,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
CTOD(c_ACCT_START_DATE_CLN ,'DD/MM/YYYY' )

COMM ACCT_START_DATE Transform --

COMM Transform character based Date to DD/MM/YYYY for ACCT_END_DATE

DELETE FIELD c_MONTH7 OK
DEFINE FIELD c_MONTH7 COMPUTED 

"01" IF SUBSTR(_ACCT_END_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"02" IF SUBSTR(_ACCT_END_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"03" IF SUBSTR(_ACCT_END_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"04" IF SUBSTR(_ACCT_END_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"05" IF SUBSTR(_ACCT_END_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"06" IF SUBSTR(_ACCT_END_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"07" IF SUBSTR(_ACCT_END_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"08" IF SUBSTR(_ACCT_END_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"09" IF SUBSTR(_ACCT_END_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"10" IF SUBSTR(_ACCT_END_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"11" IF SUBSTR(_ACCT_END_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"12" IF SUBSTR(_ACCT_END_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"00"

DELETE FIELD c_DAY7 OK
DEFINE FIELD c_DAY7 COMPUTED SUBSTR(_ACCT_END_DATE,1,2)

DELETE FIELD c_YEAR7 OK
DEFINE FIELD c_YEAR7 COMPUTED 

"20"+ SUBSTR(_ACCT_END_DATE,8,2) IF LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(_ACCT_END_DATE,8,2),0) <= 30
"19"+ SUBSTR(_ACCT_END_DATE,8,2) IF LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(_ACCT_END_DATE,8,2),0) > 30
SUBSTR(_ACCT_END_DATE,6,4)

DELETE FIELD c_ACCT_END_DATE_CLN OK
DEFINE FIELD c_ACCT_END_DATE_CLN COMPUTED c_DAY7 + '/' + c_MONTH7 + '/' + c_YEAR7

DELETE FIELD c_ACCT_END_DATE OK
DEFINE FIELD c_ACCT_END_DATE COMPUTED 

CTOD(c_ACCT_END_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(_ACCT_END_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
CTOD(c_ACCT_END_DATE_CLN ,'DD/MM/YYYY' )

COMM LAST_UPDATE_DATE Transform --

COMM Transform character based Date to DD/MM/YYYY for LAST_UPDATE_DATE

DELETE FIELD c_MONTH10 OK
DEFINE FIELD c_MONTH10 COMPUTED 

"01" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'JAN' AND  LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"02" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'FEB' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"03" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'MAR' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"04" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'APR' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"05" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'MAY' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"06" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'JUN' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"07" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'JUL' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"08" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'AUG' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"09" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'SEP' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"10" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'OCT' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"11" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'NOV' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"12" IF SUBSTR(LAST_UPDATE_DATE,4,3) = 'DEC' AND LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
"00"

DELETE FIELD c_DAY10 OK
DEFINE FIELD c_DAY10 COMPUTED SUBSTR(LAST_UPDATE_DATE,1,2)

DELETE FIELD c_YEAR10 OK
DEFINE FIELD c_YEAR10 COMPUTED 

"20"+ SUBSTR(LAST_UPDATE_DATE,8,2) IF LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(LAST_UPDATE_DATE,8,2),0) <= 30
"19"+ SUBSTR(LAST_UPDATE_DATE,8,2) IF LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0 AND VALUE(SUBSTR(LAST_UPDATE_DATE,8,2),0) > 30
SUBSTR(LAST_UPDATE_DATE,6,4)

DELETE FIELD c_LAST_UPDATE_DATE_CLN OK
DEFINE FIELD c_LAST_UPDATE_DATE_CLN COMPUTED c_DAY10 + '/' + c_MONTH10 + '/' + c_YEAR10

DELETE FIELD c_LAST_UPDATE_DATE OK
DEFINE FIELD c_LAST_UPDATE_DATE COMPUTED 

CTOD(c_LAST_UPDATE_DATE_CLN,'DD/MM/YYYY') IF  LENGTH(INCLUDE(LAST_UPDATE_DATE,"ABCDEFGHIJKLMNOPQRSTUVWXYZ")) >0
CTOD(c_LAST_UPDATE_DATE_CLN ,'DD/MM/YYYY' )


COMM
EXTRACT BELOW FOR ONGOING EXCEPTIONS

EXTRACT FIELDS SUBSTR(c_VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTR(_VENDOR_SITE_ID_,1,20) AS 'VENDOR_SITE_ID' SUBSTR(_VENDOR_BANK_ACCT_NAME_,1,60) AS 'VENDOR_BANK_ACCT_NAME' SUBSTR(_VENDOR_BSB_,1,20) AS 'VENDOR_BSB'   SUBSTR(_VENDOR_BANK_ACCOUNT_NUMBER_,1,30) AS 'VENDOR_BANK_ACCOUNT_NUMBER' c_ACCT_START_DATE AS 'ACCT_START_DATE'  c_ACCT_END_DATE AS 'ACCT_END_DATE' c_LAST_UPDATE_DATE AS 'LAST_UPDATE_DATE'  'R11' AS 'SourceFlag' File_Name TO "AP_VendorMasterBnkAcc_ALL_FMT.FIL" IF (c_LAST_UPDATE_DATE >= CTOD(_Data_Range_From_VM,"DD/MM/YYYY") OR c_ACCT_START_DATE >= CTOD(_Data_Range_From_VM,"DD/MM/YYYY")) AND c_ACCT_END_DATE = `19000101`


v_vm_bnk_count = 0
OPEN AP_VendorMasterBnkAcc_ALL_FMT
COUNT
v_vm_bnk_count = COUNT1



COMM *** Delete temporary tables ***

DO AE003_Del_Tmp

SET SAFETY ON

^BATCH    VM006_Mis_Details                  
[PARENT_FOLDER_ID] 1340167398
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Vendor Master File Exception Tests
COMM *** VM006. Identify Vendors with missing or incomplete: Address, Telephone, ABN OR BANK ACCOUNT
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_VMF")="U" OR FTYPE("trg_AP_Inv")="U" OR  FTYPE("trg_VMF")="U" DO AA002_Variable_Setting
IF FTYPE("%trg_VMF%")<>"y" OR FILESIZE("%fld_Workings%%trg_VMF%.FIL")<0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%
v_TestNo="VM006"

OPEN VMF_Vnd_Master_FIle

DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum INDEX IDX_AP_Sum_VndrID

SET FILTER TO Vndr_Sts="A"
COUNT
v_Cnt=COUNT1
COMM *** Missing ABN ***
SET FILTER TO Vndr_Sts="A" AND InvABN="M"
COUNT
EXTRACT FIELDS 100 AS "TstCd" %v_flds_VMF% AP_Vnd_InvGst_Sum.Inv_Amt AP_Vnd_InvGst_Sum.GST_Amt AP_Vnd_InvGst_Sum.COUNT IF COUNT1<>v_Cnt TO "%fld_Tmps%TMP_VM006" 

COMM *** Missing Address ***
SET FILTER
SET FILTER TO Vndr_Sts="A" AND LENGTH(ALLTRIM(INCLUDE(UPPER(ADD1+ADD2+ADD3),"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789")))<6 
COUNT
EXTRACT FIELDS 10 AS "TstCd" %v_flds_VMF% AP_Vnd_InvGst_Sum.Inv_Amt AP_Vnd_InvGst_Sum.GST_Amt AP_Vnd_InvGst_Sum.COUNT IF COUNT1<>v_Cnt TO "%fld_Tmps%TMP_VM006" APPEND

COMM *** Missing Tel No. ***
COMM Client To OMIT Blank Telephone AND/OR FAX - 21/5/2015
COMM
SET FILTER
SET FILTER TO Vndr_Sts="A" AND LENGTH(ALLTRIM(INCLUDE(TEL1,"0123456789")))<4 AND LENGTH(ALLTRIM(INCLUDE(TEL2,"0123456789")))<4 AND LENGTH(ALLTRIM(INCLUDE(TEL3,"0123456789")))<4 AND LENGTH(ALLTRIM(INCLUDE(FAX,"0123456789")))<4
COUNT
EXTRACT FIELDS 1 AS "TstCd" %v_flds_VMF% AP_Vnd_InvGst_Sum.Inv_Amt AP_Vnd_InvGst_Sum.GST_Amt AP_Vnd_InvGst_Sum.COUNT IF COUNT1<>v_Cnt TO "%fld_Tmps%TMP_VM006" APPEND
END

COMM *** Missing Bank Account ***
v_BnkAcc="COMMENT"
IF FILESIZE("%fld_Workings%VMF_BnkAcc.fil")>0 v_BnkAcc=""
%v_BnkAcc% OPEN VMF_BnkAcc
%v_BnkAcc% INDEX ON Vndr_Site_ID TO IDX_BK_VndrSiteID
%v_BnkAcc% OPEN VMF_Vnd_Master_FIle
%v_BnkAcc% DEFINE RELATION Vndr_Site_ID WITH VMF_BnkAcc INDEX IDX_BK_VndrSiteID
%v_BnkAcc% SET FILTER
%v_BnkAcc% SET FILTER TO Vndr_Sts="A" AND LENGTH(ALLTRIM(INCLUDE(VMF_BnkAcc.BSB+VMF_BnkAcc.Bnk_Acc_Num,"1234567890")))<=3 AND VALUE(INCLUDE(VMF_BnkAcc.BSB+VMF_BnkAcc.Bnk_Acc_Num,"1234567890"),0)=0 
%v_BnkAcc% COUNT
%v_BnkAcc% EXTRACT FIELDS 1000 AS "TstCd" %v_flds_VMF% AP_Vnd_InvGst_Sum.Inv_Amt AP_Vnd_InvGst_Sum.GST_Amt AP_Vnd_InvGst_Sum.COUNT IF COUNT1<>v_Cnt TO "%fld_Tmps%TMP_VM006" APPEND

OPEN VMF_BnkAcc
INDEX ON SUBSTR(ALLTRIM(Vndr_Site_ID),1,20)  TO IDX_BK_VndrSiteID1


OPEN TMP_VM006
COMMENT Fine for ACL 11
SUMMARIZE ON Vndr_Site_ID Vndr_ID SUBTOTAL TstCd OTHER ALL TO "%fld_Tmps%TMP_TstCd.FIL" OPEN PRESORT
DELETE FIELD c_TstCd OK
DEFINE FIELD c_TstCd COMPUTED ZONED(TstCd,4)

COMM *** Formulize the test name ***
DO VZ006_Test_Name
COMM *** END ***

OPEN TMP_TstCd 
DEFINE RELATION c_TstCd WITH TMP_TEST INDEX IDX_TMP_TEST

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED SUBSTR("VM006. Identify Vendors with missing: " +TMP_TEST.NEW_TstCd,1,120)

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED ALLTRIM(c_TstCd)+ALLTRIM(ZONED(Inv_Amt,15))+ALLTRIM(Vndr_ID)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Test_Cd Total_Inv_Amt Vndr_ID"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate  

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "L"

DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_Site_ID)+"~"+ALLTRIM(c_TstCd),1,85)


COMM *** Start GreyList ***
v_ID_KEY_GL="Vndr_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

SORT ON SORT_KEY D TO "%fld_Tmps%TMP2"


OPEN "%fld_Tmps%TMP2" 
DEFINE RELATION SUBST(ALLTRIM(Vndr_Site_ID),1,20) WITH VMF_BnkAcc INDEX IDX_BK_VndrSiteID1

COMMENT Update to include changes to client requirements
COMMENT 24-9-2015 
COMMENT Change request to exclude Vendors with no ABN if they are not registered for GST
COMMENT Exclude Vendors wtih no banking information if the payment method is CHECK
COMMENT Exclude Vendors with no email addresses if the payment method is CHECK
COMMENT Exclude Vendors if no postal address if payment method is EFT

DELETE FIELD c_VALID OK
DEFINE FIELD c_VALID COMPUTED

0 IF ALLTRIM(UPPER(ABN)) = "EXEMPT" 
0 IF TEST_NAME="VM006. Identify Vendors with missing: Address" AND NOT ISBLANK(ALLTRIM(ADD1))
0 IF TEST_NAME="VM006. Identify Vendors with missing: ABN / Address" AND NOT ISBLANK(ALLTRIM(ADD1))
0 IF Cha_Field2="Not Registered for GST" AND ISBLANK(ABN)
0 IF ISBLANK(Email1) AND ISBLANK(Email2) AND Pymnt_Trm="CHECK"
0 IF ISBLANK(VMF_BnkAcc.Bnk_Acc_Num) AND ISBLANK(VMF_BnkAcc.Bnk_Acc_Type) AND ISBLANK(VMF_BnkAcc.BSB) AND ISBLANK(VMF_BnkAcc.BSB_NAME) AND ISBLANK(VMF_BnkAcc.Bnk_Acc_Name) AND Pymnt_Trm="CHECK"
0 IF LENGTH(INCLUDE(ADD1,"0123456789"))=0 AND LENGTH(INCLUDE(ADD2,"0123456789"))=0 AND LENGTH(INCLUDE(ADD3,"0123456789"))=0 AND LENGTH(INCLUDE(Pcode,"0123456789"))=0 AND Pymnt_Trm="EFT"
1
COMM
0 IF ALLTRIM(UPPER(ABN)) = "EXEMPT" OR ALLTRIM(Cha_Field2) = "Not Registered for GST" 

SET FOLDER /%fld_Results%
EXTRACT FIELDS ALL  TO "%fld_Results%VM006_Mis_Details"  IF c_VALID = 1 AND Vndr_Typ<>"EMPLOYEE" AND UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT" 

OPEN VM006_Mis_Details
INDEX ON Vndr_Site_ID TO IDX_VM006_VndrSiteID

OPEN VM006_Mis_Details
DEFINE RELATION SUBST(ALLTRIM(Vndr_Site_ID),1,20) WITH VMF_BnkAcc INDEX IDX_BK_VndrSiteID1

DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum IDX_AP_Sum_VndrID

COMM *** Invoice Details ***
SET FOLDER /%fld_Tmps%
COMMENT OPEN AP_Invoices
OPEN AP_Invoices
DEFINE RELATION Vndr_Site_ID WITH VM006_Mis_Details INDEX IDX_VM006_VndrSiteID

EXTRACT FIELDS ALL VM006_Mis_Details.c_TstCd IF Vndr_ID=VM006_Mis_Details.Vndr_ID TO "TMP_1" OPEN

DEFINE RELATION c_TstCd WITH TMP_TEST INDEX IDX_TMP_TEST

DELETE FIELD TEST_NAME OK
DEFINE FIELD TEST_NAME COMPUTED SUBSTR("VM006D. Identify transactions against vendors with missing: "+ALLTRIM(TMP_TEST.NEW_TstCd),1,120)

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(Vndr_ID)+ALLTRIM(c_Inv_Dt),1,30)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "Vndr_ID Inv_Date"

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED  
AS "Report Run Date"
_RptRunDate 

DELETE FIELD Data_Range_Start_Date OK
DEFINE FIELD Data_Range_Start_Date COMPUTED  
AS "Data Range Start Date"
_Data_Range_Start_Date

DELETE FIELD Data_Range_End_Date OK
DEFINE FIELD Data_Range_End_Date COMPUTED  
AS "Date Range End Date"
_Data_Range_End_Date

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "L"

SORT ON SORT_KEY D TO "%fld_Tmps%TMP3" OPEN

SET FOLDER /%fld_Results%

EXTRACT FIELDS ALL TO "%fld_Results%VM006D_Mis_Details" 
OPEN VM006_Mis_Details
OPEN VM006D_Mis_Details
DEFINE RELATION Vndr_Site_ID WITH VM006_Mis_Details INDEX IDX_VM006_VndrSiteID


SET FOLDER /%fld_Tmps%
v_Exp_Fields_VM006D = "VM006_Mis_Details.Cha_Field1 AS 'Vendor Site'  Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status'  ' '+ Inv_No AS 'Invoice Number' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Doc_Typ AS 'Document Type' Descrp AS 'Description'   isPaid AS 'Paid' Vchr_ID AS 'Voucher Number' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc"

 OPEN VM006D_Mis_Details
 EXTRACT %v_Exp_Fields_VM006D% TO  TMP_VM006D


SET FOLDER /%fld_Results%

OPEN AP_Invoices
DELETE RELATION VM006_Mis_Details OK

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^REPORT   Default_View                       AP014_No_Trans_18_Mon            D.T,
[SKIP] 0
[TLINES] 0
[RLINES] 1
[LINE] 1
Vndr_Site_ID         PICTURE ""
[LINE] 1
Co                   PICTURE ""
[LINE] 1
Vndr_ID              PICTURE ""
[LINE] 1
Vndr_Nme             PICTURE ""
[LINE] 1
ABN                  PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 8 PICTURE ""
[LINE] 1
Vndr_Typ             PICTURE ""
[LINE] 1
Vndr_Add_Typ         PICTURE ""
[LINE] 1
ADD1                 PICTURE ""
[LINE] 1
ADD2                 PICTURE ""
[LINE] 1
ADD3                 PICTURE ""
[LINE] 1
City                 PICTURE ""
[LINE] 1
State                PICTURE ""
[LINE] 1
Pcode                PICTURE ""
[LINE] 1
Cntry                PICTURE ""
[LINE] 1
TEL1                 PICTURE ""
[LINE] 1
TEL2                 PICTURE ""
[LINE] 1
TEL3                 PICTURE ""
[LINE] 1
FAX                  PICTURE ""
[LINE] 1
Email1               PICTURE ""
[LINE] 1
Email2               PICTURE ""
[LINE] 1
Pymnt_Trm            PICTURE ""
[LINE] 1
Created_Dt           PICTURE ""
[LINE] 1
Modf_Dt              PICTURE ""
[LINE] 1
Vndr_InvlDt          PICTURE ""
[LINE] 1
Cha_Field1           PICTURE ""
[LINE] 1
Cha_Field2           PICTURE ""
[LINE] 1
Cha_Field3           WIDTH 10 PICTURE ""
[LINE] 1
Cha_Field4           PICTURE ""
[LINE] 1
Cha_Field5           PICTURE ""
[LINE] 1
Num_Field1           PICTURE ""
[LINE] 1
Num_Field2           PICTURE ""
[LINE] 1
Num_Field3           PICTURE ""
[LINE] 1
Num_Field4           PICTURE ""
[LINE] 1
Num_Field5           PICTURE ""
[LINE] 1
Dt_Field1            PICTURE ""
[LINE] 1
Dt_Field2            PICTURE ""
[LINE] 1
Dt_Field3            PICTURE ""
[LINE] 1
ABN_CLN              PICTURE ""
[LINE] 1
Max_Inv_Dt           PICTURE ""
[LINE] 1
c_Vndr_ID            PICTURE ""
[LINE] 1
ID_KEY               PICTURE ""
[LINE] 1
SORT_KEY             PICTURE ""
[LINE] 1
SORT_KEY_Desc        WIDTH 13 PICTURE ""
[LINE] 1
Priority             WIDTH 8 PICTURE ""
[LINE] 1
RptRunDate           PICTURE ""
[LINE] 1
Data_Range_Start_Date PICTURE ""
[LINE] 1
Data_Range_End_Date  PICTURE ""
[LINE] 1
TEST_NAME            PICTURE ""
^FORMAT   AP014_No_Trans_18_Mon              AP014_No_Trans_18_Mon            "Results" "AP014_No_Trans_18_Mon.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.27/08/2015   04:00:09 TMP1 IF v_NewFlag = 1 EXTRACT FIELDS ALL SUBSTR("E:\Data\VendorMasterfile_20150826.txt",1,50) AS 'File_Name' TO  AP_VendorMaster_ALL
~Input : Records:64770       Control Total:0                    
~Output: Records:64770       Control Total:0                    
~.27/08/2015   04:00:51 AP_VendorMaster_ALL EXTRACT FIELDS ALL 'R11' AS 'SourceFlag' TO "AP_VendorMaster_ALL_FMT.FIL"  IF c_SITE_LAST_UPDATE_DATE>=CTOD(_Data_Range_From_VM,"DD/MM/YYYY") OR c_HEADER_LAST_UPDATE_DATE>=CTOD(_Data_Range_From_VM,"DD/MM/YYYY")
~Input : Records:64770       Control Total:0                    
~Output: Records:64770       Control Total:0                    
~.27/08/2015   04:01:04 AP_VendorMaster_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Co' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NAME),1,73))) AS 'Vndr_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ABN),1,20))) AS 'ABN' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_STATUS),1,1))) AS 'Vndr_Sts' CTOD('', 'DD/MM/YYYY') AS 'Vndr_InvlDt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_TYPE),1,11))) AS 'Vndr_Typ' BLANKS(15) AS 'Vndr_Add_Typ' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ADDRESS),1,125))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(CITY),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(STATE),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(POSTCODE),1,12))) AS 'Pcode' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(COUNTRY),1,61))) AS 'Cntry' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Tel),1,21))) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Fax),1,21))) AS 'FAX' BLANKS(60) AS 'Email1' BLANKS(60) AS 'Email2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_METHOD),1,21))) AS 'Pymnt_Trm' c_SITE_CREATION_DATE AS 'Created_Dt' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE),1,30))) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_REGISTRATION_STATUS),1,30))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(SourceFlag),1,3))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NUMBER),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' c_SITE_INACTIVE_DATE AS 'Dt_Field1' c_SITE_CREATION_DATE AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3'   TO "Working_Files\VMF_Vnd_Master_File.FIL"
~Input : Records:64770       Control Total:0                    
~Output: Records:64770       Control Total:0                    
~.27/08/2015   04:02:27 VMF_Vnd_Master_File EXTRACT FIELDS VMF_Vnd_Master_File.Vndr_Site_ID VMF_Vnd_Master_File.Co VMF_Vnd_Master_File.Vndr_ID VMF_Vnd_Master_File.Vndr_Nme VMF_Vnd_Master_File.ABN VMF_Vnd_Master_File.Vndr_Sts VMF_Vnd_Master_File.Vndr_Typ VMF_Vnd_Master_File.Vndr_Add_Typ VMF_Vnd_Master_File.ADD1 VMF_Vnd_Master_File.ADD2 VMF_Vnd_Master_File.ADD3 VMF_Vnd_Master_File.City VMF_Vnd_Master_File.State VMF_Vnd_Master_File.Pcode VMF_Vnd_Master_File.Cntry VMF_Vnd_Master_File.TEL1 VMF_Vnd_Master_File.TEL2 VMF_Vnd_Master_File.TEL3 VMF_Vnd_Master_File.FAX VMF_Vnd_Master_File.Email1 VMF_Vnd_Master_File.Email2 VMF_Vnd_Master_File.Pymnt_Trm CTOD(DATE(VMF_Vnd_Master_File.Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(VMF_Vnd_Master_File.Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(VMF_Vnd_Master_File.Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' VMF_Vnd_Master_File.Cha_Field1 VMF_Vnd_Master_File.Cha_Field2 VMF_Vnd_Master_File.Cha_Field3 VMF_Vnd_Master_File.Cha_Field4 VMF_Vnd_Master_File.Cha_Field5 VMF_Vnd_Master_File.Num_Field1 VMF_Vnd_Master_File.Num_Field2 VMF_Vnd_Master_File.Num_Field3 VMF_Vnd_Master_File.Num_Field4 VMF_Vnd_Master_File.Num_Field5 CTOD(DATE(VMF_Vnd_Master_File.Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' VMF_Vnd_Master_File.ABN_CLN VMF_Vnd_Master_File.Max_Inv_Dt VMF_Vnd_Master_File.c_Vndr_ID IF Dt_Field2<=CTOD(DATE(_RptRunDate-540),"DD/MM/YYYY") AND (TMP1.COUNT=0 OR TMP1.Inv_Amt=0.00) AND  VMF_Vnd_Master_File.Vndr_Sts="A" TO "Tmp_Files\TMP2" OPEN
~Input : Records:64770       Control Total:0                    
~Output: Records:4108        Control Total:0                    
~.27/08/2015   04:02:27 TMP2 EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:4108        Control Total:0                    
~Output: Records:4108        Control Total:0                    
~.27/08/2015   04:02:27 TMP_GL EXTRACT FIELDS ALL IF Vndr_Site_ID<> GreyList_AP014.Vndr_Site_ID TO TMP_GL1 OPEN
~Input : Records:4108        Control Total:0                    
~Output: Records:4108        Control Total:0                    
~.27/08/2015   04:02:27 TMP_GL1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:4108        Control Total:0                    
~Output: Records:4108        Control Total:0                    
~.27/08/2015   04:02:28 TMP_Cur EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ID_KEY IF ID_KEY<> AP014_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:4108        Control Total:0                    
~Output: Records:32          Control Total:0                    
~.27/08/2015   04:02:28 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" IF Vndr_Typ<> "EMPLOYEE" AND UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"
~Input : Records:32          Control Total:0                    
~Output: Records:21          Control Total:0                    
~.27/08/2015   04:02:28 TMP10 SORT ON SORT_KEY TO Results\AP014_No_Trans_18_Mon
~Input : Records:21          Control Total:0                    
~Output: Records:21          Control Total:0                    
[LASTVIEW] "Default_View"
^REPORT   Default_View                       VM010_DeReg_GST                  D.T,
[SKIP] 0
[TLINES] 0
[RLINES] 1
[LINE] 1
ASIC_entityStatusCode PICTURE ""
[LINE] 1
ASIC_entityStatusEF  WIDTH 19 PICTURE ""
[LINE] 1
ASIC_GST_effFrom     WIDTH 16 PICTURE ""
[LINE] 1
ASIC_GST_effTo       WIDTH 14 PICTURE ""
[LINE] 1
ASIC_entityDescription PICTURE ""
[LINE] 1
Inv_Amt              PICTURE ""
[LINE] 1
GST_Amt              PICTURE ""
[LINE] 1
COUNT                PICTURE ""
[LINE] 1
Vndr_Site_ID         PICTURE ""
[LINE] 1
Co                   PICTURE ""
[LINE] 1
Vndr_ID              PICTURE ""
[LINE] 1
Vndr_Nme             PICTURE ""
[LINE] 1
ABN                  PICTURE ""
[LINE] 1
Vndr_Sts             WIDTH 8 PICTURE ""
[LINE] 1
Vndr_Typ             PICTURE ""
[LINE] 1
Vndr_Add_Typ         PICTURE ""
[LINE] 1
ADD1                 PICTURE ""
[LINE] 1
ADD2                 PICTURE ""
[LINE] 1
ADD3                 PICTURE ""
[LINE] 1
City                 PICTURE ""
[LINE] 1
State                PICTURE ""
[LINE] 1
Pcode                PICTURE ""
[LINE] 1
Cntry                PICTURE ""
[LINE] 1
TEL1                 PICTURE ""
[LINE] 1
TEL2                 PICTURE ""
[LINE] 1
TEL3                 PICTURE ""
[LINE] 1
FAX                  PICTURE ""
[LINE] 1
Email1               PICTURE ""
[LINE] 1
Email2               PICTURE ""
[LINE] 1
Pymnt_Trm            PICTURE ""
[LINE] 1
Created_Dt           PICTURE ""
[LINE] 1
Modf_Dt              PICTURE ""
[LINE] 1
Vndr_InvlDt          PICTURE ""
[LINE] 1
Cha_Field1           PICTURE ""
[LINE] 1
Cha_Field2           PICTURE ""
[LINE] 1
Cha_Field3           WIDTH 10 PICTURE ""
[LINE] 1
Cha_Field4           PICTURE ""
[LINE] 1
Cha_Field5           PICTURE ""
[LINE] 1
Num_Field1           PICTURE ""
[LINE] 1
Num_Field2           PICTURE ""
[LINE] 1
Num_Field3           PICTURE ""
[LINE] 1
Num_Field4           PICTURE ""
[LINE] 1
Num_Field5           PICTURE ""
[LINE] 1
Dt_Field1            PICTURE ""
[LINE] 1
Dt_Field2            PICTURE ""
[LINE] 1
Dt_Field3            PICTURE ""
[LINE] 1
ABN_CLN              PICTURE ""
[LINE] 1
Max_Inv_Dt           PICTURE ""
[LINE] 1
c_Vndr_ID            PICTURE ""
[LINE] 1
Priority             WIDTH 8 PICTURE ""
[LINE] 1
TEST_NAME            PICTURE ""
[LINE] 1
RptRunDate           PICTURE ""
[LINE] 1
SORT_KEY             PICTURE ""
[LINE] 1
SORT_KEY_Desc        PICTURE ""
^FORMAT   VM010_DeReg_GST                    VM010_DeReg_GST                  "Results" "VM010_DeReg_GST.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.21/08/2015   04:00:36 TMP1 IF v_NewFlag = 1 EXTRACT FIELDS ALL SUBSTR("E:\Data\VendorMasterfile_20150820.txt",1,50) AS 'File_Name' TO  AP_VendorMaster_ALL
~Input : Records:64676       Control Total:0                    
~Output: Records:64676       Control Total:0                    
~.21/08/2015   04:02:31 AP_VendorMaster_ALL EXTRACT FIELDS ALL 'R11' AS 'SourceFlag' TO "AP_VendorMaster_ALL_FMT.FIL"  IF c_SITE_LAST_UPDATE_DATE>=CTOD(_Data_Range_From_VM,"DD/MM/YYYY") OR c_HEADER_LAST_UPDATE_DATE>=CTOD(_Data_Range_From_VM,"DD/MM/YYYY")
~Input : Records:64676       Control Total:0                    
~Output: Records:64676       Control Total:0                    
~.21/08/2015   04:02:44 AP_VendorMaster_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Co' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NAME),1,73))) AS 'Vndr_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ABN),1,20))) AS 'ABN' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_STATUS),1,1))) AS 'Vndr_Sts' CTOD('', 'DD/MM/YYYY') AS 'Vndr_InvlDt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_TYPE),1,11))) AS 'Vndr_Typ' BLANKS(15) AS 'Vndr_Add_Typ' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ADDRESS),1,125))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(CITY),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(STATE),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(POSTCODE),1,12))) AS 'Pcode' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(COUNTRY),1,61))) AS 'Cntry' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Tel),1,21))) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Fax),1,21))) AS 'FAX' BLANKS(60) AS 'Email1' BLANKS(60) AS 'Email2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_METHOD),1,21))) AS 'Pymnt_Trm' c_SITE_CREATION_DATE AS 'Created_Dt' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE),1,30))) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_REGISTRATION_STATUS),1,30))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(SourceFlag),1,3))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NUMBER),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' c_SITE_INACTIVE_DATE AS 'Dt_Field1' c_SITE_CREATION_DATE AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3'   TO "Working_Files\VMF_Vnd_Master_File.FIL"
~Input : Records:64676       Control Total:0                    
~Output: Records:64676       Control Total:0                    
~.21/08/2015   04:32:37 VMF_Vnd_Master_File EXTRACT FIELDS ALL ABN_ASIC.ASIC_entityStatusCode CTOD(ABN_ASIC.ASIC_entityStatusEF,"YYYY-MM-DD") AS "ASIC_entityStatusEF" CTOD(ABN_ASIC.ASIC_GST_effFrom,"YYYY-MM-DD") AS "ASIC_GST_effFrom" CTOD(ABN_ASIC.ASIC_GST_effTo,"YYYY-MM-DD") AS "ASIC_GST_effTo" ABN_ASIC.ASIC_entityDescription IF LENGTH(ALLTRIM(ABN_CLN))>1 AND Vndr_Sts="A" AND InvABN="F" AND (((ABN_ASIC.ASIC_entityStatusCode = "Active") AND ISBLANK(ABN_ASIC.ASIC_GST_effFrom)) OR ((ABN_ASIC.ASIC_entityStatusCode = "Active") AND NOT ISBLANK(ABN_ASIC.ASIC_GST_effTo))) TO "Tmp_Files\TMP1" OPEN
~Input : Records:64676       Control Total:0                    
~Output: Records:1307        Control Total:0                    
~.21/08/2015   04:32:37 TMP1 EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:1307        Control Total:0                    
~Output: Records:1307        Control Total:0                    
~.21/08/2015   04:32:37 TMP_GL EXTRACT FIELDS ALL IF Vndr_ID<> GreyList_VM010.Vndr_ID TO TMP_GL1 OPEN
~Input : Records:1307        Control Total:0                    
~Output: Records:1307        Control Total:0                    
~.21/08/2015   04:32:37 TMP_GL1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:1307        Control Total:0                    
~Output: Records:1307        Control Total:0                    
~.21/08/2015   04:32:37 TMP_Cur EXTRACT FIELDS Co Vndr_Site_ID Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_InvlDt Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 c_Vndr_ID ABN_CLN Max_Inv_Dt InvABN ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription ID_KEY IF ID_KEY<> VM010_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:1307        Control Total:0                    
~Output: Records:24          Control Total:0                    
~.21/08/2015   04:32:37 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP_Vnd"  OPEN
~Input : Records:24          Control Total:0                    
~Output: Records:24          Control Total:0                    
~.21/08/2015   04:32:38 TMP_Vnd EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:24          Control Total:0                    
~Output: Records:24          Control Total:0                    
~.21/08/2015   04:32:38 TMP10 SORT ON SORT_KEY D TO "Tmp_Files\TMP_VM010" OPEN
~Input : Records:24          Control Total:0                    
~Output: Records:24          Control Total:0                    
~.21/08/2015   04:32:38 TMP_VM010 EXTRACT FIELDS ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription VM010D_DeReg_GST_Sum.Inv_Amt VM010D_DeReg_GST_Sum.GST_Amt VM010D_DeReg_GST_Sum.COUNT VMF_Vnd_Master_File.Vndr_Site_ID VMF_Vnd_Master_File.Co VMF_Vnd_Master_File.Vndr_ID VMF_Vnd_Master_File.Vndr_Nme VMF_Vnd_Master_File.ABN VMF_Vnd_Master_File.Vndr_Sts VMF_Vnd_Master_File.Vndr_Typ VMF_Vnd_Master_File.Vndr_Add_Typ VMF_Vnd_Master_File.ADD1 VMF_Vnd_Master_File.ADD2 VMF_Vnd_Master_File.ADD3 VMF_Vnd_Master_File.City VMF_Vnd_Master_File.State VMF_Vnd_Master_File.Pcode VMF_Vnd_Master_File.Cntry VMF_Vnd_Master_File.TEL1 VMF_Vnd_Master_File.TEL2 VMF_Vnd_Master_File.TEL3 VMF_Vnd_Master_File.FAX VMF_Vnd_Master_File.Email1 VMF_Vnd_Master_File.Email2 VMF_Vnd_Master_File.Pymnt_Trm CTOD(DATE(VMF_Vnd_Master_File.Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(VMF_Vnd_Master_File.Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(VMF_Vnd_Master_File.Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' VMF_Vnd_Master_File.Cha_Field1 VMF_Vnd_Master_File.Cha_Field2 VMF_Vnd_Master_File.Cha_Field3 VMF_Vnd_Master_File.Cha_Field4 VMF_Vnd_Master_File.Cha_Field5 VMF_Vnd_Master_File.Num_Field1 VMF_Vnd_Master_File.Num_Field2 VMF_Vnd_Master_File.Num_Field3 VMF_Vnd_Master_File.Num_Field4 VMF_Vnd_Master_File.Num_Field5 CTOD(DATE(VMF_Vnd_Master_File.Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' VMF_Vnd_Master_File.ABN_CLN VMF_Vnd_Master_File.Max_Inv_Dt VMF_Vnd_Master_File.c_Vndr_ID Priority TEST_NAME RptRunDate SORT_KEY SORT_KEY_Desc TO "Results\VM010_DeReg_GST" OPEN
~Input : Records:24          Control Total:0                    
~Output: Records:24          Control Total:0                    
[LASTVIEW] "Default_View"
^FORMAT   TMP_2                              TMP_2                            "" "TMP_2.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1430899205
~.18/02/2016   04:00:19 TMP1 SORT ON _VENDOR_SITE_ID_ VENDOR_ID__ _VENDOR_BSB_ _VENDOR_BANK_ACCOUNT_NUMBER_ _ACCT_START_DATE_  D  TO "TMP_2" OPEN
~Input : Records:33          Control Total:0                    
~Output: Records:33          Control Total:0                    
^FORMAT   TMP_3                              TMP_3                            "" "TMP_3.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1430899205
~.18/02/2016   04:00:19 TMP1 SORT ON _VENDOR_SITE_ID_ VENDOR_ID__ _VENDOR_BSB_ _VENDOR_BANK_ACCOUNT_NUMBER_ _ACCT_START_DATE_  D  TO "TMP_2" OPEN
~Input : Records:33          Control Total:0                    
~Output: Records:33          Control Total:0                    
~.18/02/2016   04:00:19 TMP_2 SUMMARIZE ON _VENDOR_SITE_ID_ VENDOR_ID__ _VENDOR_BSB_ _VENDOR_BANK_ACCOUNT_NUMBER_ OTHER _VENDOR_SITE_ID_ VENDOR_ID__ _VENDOR_BSB_ _VENDOR_BANK_ACCOUNT_NUMBER_ _VENDOR_BANK_ACCT_NAME_ _ACCT_START_DATE_ _ACCT_END_DATE LAST_UPDATE_DATE TO "TMP_3.FIL" OPEN PRESORT
~Input : Records:33          Control Total:0                    
~Output: Records:33          Control Total:0                    
^INDEX    IDX_NewVMBnk_Key                   AP_VendorMasterBnkAcc_ALL_New    "" "IDX_NewVMBnk_Key.INX" 
*INDEX ON C_KEY TO IDX_NEWVMBNK_KEY
^FORMAT   _DIR                               _DIR                             "" "_DIR.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1430899205
~.18/02/2016   04:00:20   DIR *.AC TO _DIR
^FORMAT   Invoice_fixed                      Invoice_fixed                    "" "Invoice_fixed.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1430899205
~.18/02/2016   04:00:20   DIR *.AC TO _DIR
~.18/02/2016   04:00:20 _DIR EXTRACT BLANKS(5000) AS "ALLREC" TO "FIXED_5000.FIL" FIRST 0
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:00:21 FIXED_5000 EXTRACT REGEXREPLACE(ALLREC,"[(\x00-\x09)(\x0B-\x0C)(\x0E-\x1F)]",' ') TO "Invoice_fixed.fil"
~Input : Records:333         Control Total:0                    
~Output: Records:333         Control Total:0                    
^FORMAT   FIXED_5000                         FIXED_5000                       "E:\Data" "Invoices_20160217.txt" 0 ASCII 
[PARENT_FOLDER_ID] 1430899205
~.18/02/2016   04:00:20   DIR *.AC TO _DIR
~.18/02/2016   04:00:20 _DIR EXTRACT BLANKS(5000) AS "ALLREC" TO "FIXED_5000.FIL" FIRST 0
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   GENERIC                            GENERIC                          "" "Invoice_fixed.fil" 0 ASCII CRLF
[PARENT_FOLDER_ID] 1430899205
~.18/02/2016   04:00:20   DIR *.AC TO _DIR
~.18/02/2016   04:00:20 _DIR EXTRACT BLANKS(5000) AS "ALLREC" TO "GENERIC.FIL" FIRST 0
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_NewInv_Key                     AP_INVOICES_ALL_New              "" "IDX_NewInv_Key.INX" 
*INDEX ON C_KEY TO IDX_NEWINV_KEY
^FORMAT   AP_Dups_Amt_Inv                    AP_Dups_Amt_Inv                  "Tmp_Files" "AP_Dups_Amt_Inv.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1430899205
~.18/02/2016   04:00:23 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:10948       Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20160217.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:00:38 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:42 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:45 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   04:02:47 AP_Invoices SET FILTER ABS_INVAMT<>0.00
~.18/02/2016   04:02:47 AP_Invoices DUPLICATES ON c_Inv_No ABS_INVAMT OTHER Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ PRESORT OPEN TO "Tmp_Files\AP_Dups_Amt_Inv.FIL"
~Input : Records:235098      Control Total:0                    
~Output: Records:235007      Control Total:0                    
^FORMAT   GreyList_AP001                     GreyList_AP001                   "Working_Files" "GreyList_AP001.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1427252735
~.18/02/2016   04:02:51 TMP2 EXTRACT FIELDS SUBSTR(ALLTRIM(F1),1,20) AS 'Vndr_Site_ID' SUBSTR(ALLTRIM(F2),1,60) AS 'Vndr_Name' IF NOT ISBLANK(F1) AND RECNO()>1 TO "Working_Files\GreyList_AP001.fil"
~Input : Records:1           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_GreyList_AP001_Vndr_Site_ID    GreyList_AP001                   "" "IDX_GreyList_AP001_Vndr_Site_ID.INX" 
*INDEX ON VNDR_SITE_ID TO IDX_GREYLIST_AP001_VNDR_SITE_ID
^FORMAT   AP001_TMP                          AP001_TMP                        "Tmp_Files" "AP001_TMP.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1430899205
~.18/02/2016   04:00:23 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:10948       Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20160217.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:00:38 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:42 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:45 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   04:02:47 AP_Invoices SET FILTER ABS_INVAMT<>0.00
~.18/02/2016   04:02:47 AP_Invoices DUPLICATES ON c_Inv_No ABS_INVAMT OTHER Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ PRESORT OPEN TO "Tmp_Files\AP_Dups_Amt_Inv.FIL"
~Input : Records:235098      Control Total:0                    
~Output: Records:235007      Control Total:0                    
~.18/02/2016   04:02:47 AP_Dups_Amt_Inv EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:2520        Control Total:0                    
~Output: Records:2520        Control Total:0                    
~.18/02/2016   04:02:51 TMP_GL EXTRACT FIELDS ALL IF Vndr_Site_ID<> GreyList_AP001.Vndr_Site_ID TO TMP_GL1 OPEN
~Input : Records:2520        Control Total:0                    
~Output: Records:2520        Control Total:0                    
~.18/02/2016   04:02:51 TMP_GL1 SET FILTER ABS_INVAMT_CENT <>0.00
~.18/02/2016   04:02:51 TMP_GL1 DUPLICATES ON c_Inv_No ABS_INVAMT_CENT  Inv_Dt Vndr_ID OTHER Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ PRESORT OPEN TO "Tmp_Files\TMP_AP_DUPS.FIL"
~Input : Records:2520        Control Total:0                    
~Output: Records:2520        Control Total:0                    
~.18/02/2016   04:02:51 TMP_AP_DUPS EXTRACT FIELDS "O" AS "Flag" REV_KEY DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ TO "Tmp_Files\TMP_AP_DUPS_1"
~Input : Records:1151        Control Total:0                    
~Output: Records:1151        Control Total:0                    
~.18/02/2016   04:02:52 TMP_AP_CREDIT EXTRACT FIELDS "D" AS "Flag" REV_KEY TMP_AP_DUPS.DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF REV_KEY = TMP_AP_DUPS.REV_KEY TO "Tmp_Files\TMP_AP_DUPS_1" OPEN APPEND
~Input : Records:1127        Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:02:52 TMP_AP_DUPS_1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF NOT ISBLANK(Dup_Keys.DUP_KEY) TO "Tmp_Files\TMP_AP_DUPS_2" OPEN
~Input : Records:1151        Control Total:0                    
~Output: Records:224         Control Total:0                    
~.18/02/2016   04:02:52 TMP_AP_DUPS_5 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ TO "Tmp_Files\TMP_AP_DUPS_2" APPEND
~Input : Records:5           Control Total:0                    
~Output: Records:5           Control Total:0                    
~.18/02/2016   04:02:52 TMP_AP_DUPS_2 SORT ON SORT_KEY D TO "Tmp_Files\AP001_TMP" IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN
~Input : Records:229         Control Total:0                    
~Output: Records:223         Control Total:0                    
^FORMAT   GreyList_AP002                     GreyList_AP002                   "Working_Files" "GreyList_AP002.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1427252735
~.18/02/2016   04:02:53 TMP2 EXTRACT FIELDS SUBSTR(ALLTRIM(F1),1,20) AS 'Vndr_Site_ID' SUBSTR(ALLTRIM(F2),1,60) AS 'Vndr_Name' IF NOT ISBLANK(F1) AND RECNO()>1 TO "Working_Files\GreyList_AP002.fil"
~Input : Records:1           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_GreyList_AP002_Vndr_Site_ID    GreyList_AP002                   "" "IDX_GreyList_AP002_Vndr_Site_ID.INX" 
*INDEX ON VNDR_SITE_ID TO IDX_GREYLIST_AP002_VNDR_SITE_ID
^INDEX    IDX_AP002_History_ID_KEY           AP002_History                    "" "IDX_AP002_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_AP002_HISTORY_ID_KEY
^FORMAT   AP002_History                      AP002_History                    "History" "AP002_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~**** SOME HISTORY DELETED ****
~.19/01/2016   04:01:30 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.20/01/2016   04:01:53 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.21/01/2016   04:01:39 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.22/01/2016   04:02:32 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.25/01/2016   04:02:02 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP002_History" APPEND
~Input : Records:64          Control Total:0                    
~Output: Records:64          Control Total:0                    
~.26/01/2016   04:02:09 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.27/01/2016   04:01:37 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.28/01/2016   04:01:47 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP002_History" APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.29/01/2016   04:01:46 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.03/02/2016   10:49:38 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.04/02/2016   04:03:37 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.05/02/2016   04:03:48 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.08/02/2016   04:04:35 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.09/02/2016   04:03:27 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.10/02/2016   04:03:01 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.11/02/2016   04:03:13 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/02/2016   04:04:04 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.15/02/2016   04:03:28 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.16/02/2016   04:03:36 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.17/02/2016   04:02:07 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:02:56 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   AP002_Dup_Amt_Inv_Vndr             AP002_Dup_Amt_Inv_Vndr           "Results" "AP002_Dup_Amt_Inv_Vndr.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~**** SOME HISTORY DELETED ****
~.18/02/2016   04:00:23 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:00:38 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:42 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:45 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   04:02:47 AP_Invoices SET FILTER ABS_INVAMT<>0.00
~.18/02/2016   04:02:47 AP_Invoices DUPLICATES ON c_Inv_No ABS_INVAMT OTHER Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ PRESORT OPEN TO "Tmp_Files\AP_Dups_Amt_Inv.FIL"
~Input : Records:235098      Control Total:0                    
~Output: Records:235007      Control Total:0                    
~.18/02/2016   04:02:53 AP_Dups_Amt_Inv EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:2520        Control Total:0                    
~Output: Records:2520        Control Total:0                    
~.18/02/2016   04:02:53 TMP_GL EXTRACT FIELDS ALL IF Vndr_Site_ID<> GreyList_AP002.Vndr_Site_ID TO TMP_GL1 OPEN
~Input : Records:2520        Control Total:0                    
~Output: Records:2520        Control Total:0                    
~.18/02/2016   04:02:53 TMP_GL1 DUPLICATES ON c_Inv_No ABS_INVAMT_CENT  Vndr_ID OTHER Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF ABS_INVAMT_CENT <>0.00 PRESORT OPEN TO "Tmp_Files\AP_TMP.FIL"
~Input : Records:2520        Control Total:0                    
~Output: Records:2520        Control Total:0                    
~.18/02/2016   04:02:54 AP_TMP EXTRACT FIELDS Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ DUP_KEY IF DUP_KEY= AP_TMP2.DUP_KEY TO "Tmp_Files\TMP_AP_DUPS" OPEN
~Input : Records:1468        Control Total:0                    
~Output: Records:335         Control Total:0                    
~.18/02/2016   04:02:54 TMP_AP_DUPS EXTRACT FIELDS "O" AS "Flag" REV_KEY DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ TO "Tmp_Files\TMP_AP_DUPS_1"
~Input : Records:335         Control Total:0                    
~Output: Records:335         Control Total:0                    
~.18/02/2016   04:02:54 TMP_AP_CREDIT EXTRACT FIELDS "D" AS "Flag" REV_KEY TMP_AP_DUPS.DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF REV_KEY = TMP_AP_DUPS.REV_KEY TO "Tmp_Files\TMP_AP_DUPS_1" OPEN APPEND
~Input : Records:1471        Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:02:55 TMP_AP_DUPS_1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF NOT ISBLANK(Dup_Keys.DUP_KEY) TO "Tmp_Files\TMP_AP_DUPS_2" OPEN
~Input : Records:335         Control Total:0                    
~Output: Records:232         Control Total:0                    
~.18/02/2016   04:02:55 TMP_AP_DUPS_5 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ TO "Tmp_Files\TMP_AP_DUPS_2" APPEND
~Input : Records:8           Control Total:0                    
~Output: Records:8           Control Total:0                    
~.18/02/2016   04:02:55 TMP_AP_DUPS_2 EXTRACT RECORD IF DUP_KEY= TMP_AP_Dup2.DUP_KEY TO "Tmp_Files\TMP_AP_02" OPEN
~Input : Records:240         Control Total:0                    
~Output: Records:240         Control Total:0                    
~.18/02/2016   04:02:55 TMP_AP_02 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:240         Control Total:0                    
~Output: Records:240         Control Total:0                    
~.18/02/2016   04:02:56 TMP_Cur EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY IF DUP_KEY= TMP_His.DUP_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:240         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:02:56 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:02:56 TMP10 SORT ON SORT_KEY D TO "Results\AP002_Dup_Amt_Inv_Vndr" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   TMP_AP002                          TMP_AP002                        "" "TMP_AP002.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1430899205
~**** SOME HISTORY DELETED ****
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:00:38 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:42 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:45 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   04:02:47 AP_Invoices SET FILTER ABS_INVAMT<>0.00
~.18/02/2016   04:02:47 AP_Invoices DUPLICATES ON c_Inv_No ABS_INVAMT OTHER Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ PRESORT OPEN TO "Tmp_Files\AP_Dups_Amt_Inv.FIL"
~Input : Records:235098      Control Total:0                    
~Output: Records:235007      Control Total:0                    
~.18/02/2016   04:02:53 AP_Dups_Amt_Inv EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:2520        Control Total:0                    
~Output: Records:2520        Control Total:0                    
~.18/02/2016   04:02:53 TMP_GL EXTRACT FIELDS ALL IF Vndr_Site_ID<> GreyList_AP002.Vndr_Site_ID TO TMP_GL1 OPEN
~Input : Records:2520        Control Total:0                    
~Output: Records:2520        Control Total:0                    
~.18/02/2016   04:02:53 TMP_GL1 DUPLICATES ON c_Inv_No ABS_INVAMT_CENT  Vndr_ID OTHER Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF ABS_INVAMT_CENT <>0.00 PRESORT OPEN TO "Tmp_Files\AP_TMP.FIL"
~Input : Records:2520        Control Total:0                    
~Output: Records:2520        Control Total:0                    
~.18/02/2016   04:02:54 AP_TMP EXTRACT FIELDS Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ DUP_KEY IF DUP_KEY= AP_TMP2.DUP_KEY TO "Tmp_Files\TMP_AP_DUPS" OPEN
~Input : Records:1468        Control Total:0                    
~Output: Records:335         Control Total:0                    
~.18/02/2016   04:02:54 TMP_AP_DUPS EXTRACT FIELDS "O" AS "Flag" REV_KEY DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ TO "Tmp_Files\TMP_AP_DUPS_1"
~Input : Records:335         Control Total:0                    
~Output: Records:335         Control Total:0                    
~.18/02/2016   04:02:54 TMP_AP_CREDIT EXTRACT FIELDS "D" AS "Flag" REV_KEY TMP_AP_DUPS.DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF REV_KEY = TMP_AP_DUPS.REV_KEY TO "Tmp_Files\TMP_AP_DUPS_1" OPEN APPEND
~Input : Records:1471        Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:02:55 TMP_AP_DUPS_1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF NOT ISBLANK(Dup_Keys.DUP_KEY) TO "Tmp_Files\TMP_AP_DUPS_2" OPEN
~Input : Records:335         Control Total:0                    
~Output: Records:232         Control Total:0                    
~.18/02/2016   04:02:55 TMP_AP_DUPS_5 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ TO "Tmp_Files\TMP_AP_DUPS_2" APPEND
~Input : Records:8           Control Total:0                    
~Output: Records:8           Control Total:0                    
~.18/02/2016   04:02:55 TMP_AP_DUPS_2 EXTRACT RECORD IF DUP_KEY= TMP_AP_Dup2.DUP_KEY TO "Tmp_Files\TMP_AP_02" OPEN
~Input : Records:240         Control Total:0                    
~Output: Records:240         Control Total:0                    
~.18/02/2016   04:02:55 TMP_AP_02 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:240         Control Total:0                    
~Output: Records:240         Control Total:0                    
~.18/02/2016   04:02:56 TMP_Cur EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY IF DUP_KEY= TMP_His.DUP_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:240         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:02:56 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:02:56 TMP10 SORT ON SORT_KEY D TO "Results\AP002_Dup_Amt_Inv_Vndr" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:02:56 AP002_Dup_Amt_Inv_Vndr EXTRACT Flag VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description' Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc TO  TMP_AP002 IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   GreyList_AP003                     GreyList_AP003                   "Working_Files" "GreyList_AP003.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1427252735
~.18/02/2016   04:02:57 TMP2 EXTRACT FIELDS SUBSTR(ALLTRIM(F1),1,20) AS 'Vndr_Site_ID' SUBSTR(ALLTRIM(F2),1,60) AS 'Vndr_Name' IF NOT ISBLANK(F1) AND RECNO()>1 TO "Working_Files\GreyList_AP003.fil"
~Input : Records:1           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_GreyList_AP003_Vndr_Site_ID    GreyList_AP003                   "" "IDX_GreyList_AP003_Vndr_Site_ID.INX" 
*INDEX ON VNDR_SITE_ID TO IDX_GREYLIST_AP003_VNDR_SITE_ID
^INDEX    IDX_AP003_History_ID_KEY           AP003_History                    "" "IDX_AP003_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_AP003_HISTORY_ID_KEY
^FORMAT   AP003_History                      AP003_History                    "History" "AP003_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~**** SOME HISTORY DELETED ****
~.19/01/2016   04:01:32 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP003_History" APPEND
~Input : Records:4           Control Total:0                    
~Output: Records:4           Control Total:0                    
~.20/01/2016   04:01:54 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.21/01/2016   04:01:40 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.22/01/2016   04:02:34 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.25/01/2016   04:02:04 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP003_History" APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.26/01/2016   04:02:13 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.27/01/2016   04:01:39 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.28/01/2016   04:01:48 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP003_History" APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.29/01/2016   04:01:48 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP003_History" APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.03/02/2016   10:49:42 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.04/02/2016   04:03:41 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP003_History" APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.05/02/2016   04:03:52 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP003_History" APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.08/02/2016   04:04:40 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.09/02/2016   04:03:31 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.10/02/2016   04:03:04 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP003_History" APPEND
~Input : Records:13          Control Total:0                    
~Output: Records:13          Control Total:0                    
~.11/02/2016   04:03:18 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/02/2016   04:04:10 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.15/02/2016   04:03:32 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.16/02/2016   04:03:41 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.17/02/2016   04:02:13 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:03:00 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   AP003_Dup_Amt_Dt_Inv               AP003_Dup_Amt_Dt_Inv             "Results" "AP003_Dup_Amt_Dt_Inv.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~**** SOME HISTORY DELETED ****
~.18/02/2016   04:00:23 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:00:38 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:42 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:45 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   04:02:47 AP_Invoices SET FILTER ABS_INVAMT<>0.00
~.18/02/2016   04:02:47 AP_Invoices DUPLICATES ON c_Inv_No ABS_INVAMT OTHER Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ PRESORT OPEN TO "Tmp_Files\AP_Dups_Amt_Inv.FIL"
~Input : Records:235098      Control Total:0                    
~Output: Records:235007      Control Total:0                    
~.18/02/2016   04:02:57 AP_Dups_Amt_Inv EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:2520        Control Total:0                    
~Output: Records:2520        Control Total:0                    
~.18/02/2016   04:02:57 TMP_GL EXTRACT FIELDS ALL IF Vndr_Site_ID<> GreyList_AP003.Vndr_Site_ID TO TMP_GL1 OPEN
~Input : Records:2520        Control Total:0                    
~Output: Records:2520        Control Total:0                    
~.18/02/2016   04:02:57 TMP_GL1 DUPLICATES ON c_Inv_No ABS_INVAMT_CENT  Inv_Dt OTHER Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ PRESORT OPEN TO "Tmp_Files\AP_TMP.FIL"
~Input : Records:2520        Control Total:0                    
~Output: Records:2520        Control Total:0                    
~.18/02/2016   04:02:58 AP_TMP EXTRACT FIELDS Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ DUP_KEY IF DUP_KEY= AP_TMP2.DUP_KEY TO "Tmp_Files\TMP_AP_DUPS" OPEN
~Input : Records:1424        Control Total:0                    
~Output: Records:317         Control Total:0                    
~.18/02/2016   04:02:58 TMP_AP_DUPS EXTRACT FIELDS "O" AS "Flag" REV_KEY DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ TO "Tmp_Files\TMP_AP_DUPS_1"
~Input : Records:317         Control Total:0                    
~Output: Records:317         Control Total:0                    
~.18/02/2016   04:02:58 TMP_AP_CREDIT EXTRACT FIELDS "D" AS "Flag" REV_KEY TMP_AP_DUPS.DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF REV_KEY = TMP_AP_DUPS.REV_KEY TO "Tmp_Files\TMP_AP_DUPS_1" OPEN APPEND
~Input : Records:1533        Control Total:0                    
~Output: Records:1           Control Total:0                    
~.18/02/2016   04:02:59 TMP_AP_DUPS_1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF NOT ISBLANK(Dup_Keys.DUP_KEY) TO "Tmp_Files\TMP_AP_DUPS_2" OPEN
~Input : Records:318         Control Total:0                    
~Output: Records:301         Control Total:0                    
~.18/02/2016   04:02:59 TMP_AP_DUPS_5 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ TO "Tmp_Files\TMP_AP_DUPS_2" APPEND
~Input : Records:1           Control Total:0                    
~Output: Records:1           Control Total:0                    
~.18/02/2016   04:02:59 TMP_AP_DUPS_2 EXTRACT RECORD IF DUP_KEY= TMP_AP_Dup2.DUP_KEY TO "Tmp_Files\TMP_AP_02" OPEN
~Input : Records:302         Control Total:0                    
~Output: Records:302         Control Total:0                    
~.18/02/2016   04:02:59 TMP_AP_02 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:302         Control Total:0                    
~Output: Records:302         Control Total:0                    
~.18/02/2016   04:03:00 TMP_Cur EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY IF DUP_KEY= TMP_His.DUP_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:302         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:03:00 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:03:00 TMP10 SORT ON SORT_KEY D TO "Results\AP003_Dup_Amt_Dt_Inv"  OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   TMP_AP003                          TMP_AP003                        "" "TMP_AP003.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1430899205
~**** SOME HISTORY DELETED ****
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:00:38 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:42 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:45 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   04:02:47 AP_Invoices SET FILTER ABS_INVAMT<>0.00
~.18/02/2016   04:02:47 AP_Invoices DUPLICATES ON c_Inv_No ABS_INVAMT OTHER Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ PRESORT OPEN TO "Tmp_Files\AP_Dups_Amt_Inv.FIL"
~Input : Records:235098      Control Total:0                    
~Output: Records:235007      Control Total:0                    
~.18/02/2016   04:02:57 AP_Dups_Amt_Inv EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:2520        Control Total:0                    
~Output: Records:2520        Control Total:0                    
~.18/02/2016   04:02:57 TMP_GL EXTRACT FIELDS ALL IF Vndr_Site_ID<> GreyList_AP003.Vndr_Site_ID TO TMP_GL1 OPEN
~Input : Records:2520        Control Total:0                    
~Output: Records:2520        Control Total:0                    
~.18/02/2016   04:02:57 TMP_GL1 DUPLICATES ON c_Inv_No ABS_INVAMT_CENT  Inv_Dt OTHER Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ PRESORT OPEN TO "Tmp_Files\AP_TMP.FIL"
~Input : Records:2520        Control Total:0                    
~Output: Records:2520        Control Total:0                    
~.18/02/2016   04:02:58 AP_TMP EXTRACT FIELDS Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ DUP_KEY IF DUP_KEY= AP_TMP2.DUP_KEY TO "Tmp_Files\TMP_AP_DUPS" OPEN
~Input : Records:1424        Control Total:0                    
~Output: Records:317         Control Total:0                    
~.18/02/2016   04:02:58 TMP_AP_DUPS EXTRACT FIELDS "O" AS "Flag" REV_KEY DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ TO "Tmp_Files\TMP_AP_DUPS_1"
~Input : Records:317         Control Total:0                    
~Output: Records:317         Control Total:0                    
~.18/02/2016   04:02:58 TMP_AP_CREDIT EXTRACT FIELDS "D" AS "Flag" REV_KEY TMP_AP_DUPS.DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF REV_KEY = TMP_AP_DUPS.REV_KEY TO "Tmp_Files\TMP_AP_DUPS_1" OPEN APPEND
~Input : Records:1533        Control Total:0                    
~Output: Records:1           Control Total:0                    
~.18/02/2016   04:02:59 TMP_AP_DUPS_1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF NOT ISBLANK(Dup_Keys.DUP_KEY) TO "Tmp_Files\TMP_AP_DUPS_2" OPEN
~Input : Records:318         Control Total:0                    
~Output: Records:301         Control Total:0                    
~.18/02/2016   04:02:59 TMP_AP_DUPS_5 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ TO "Tmp_Files\TMP_AP_DUPS_2" APPEND
~Input : Records:1           Control Total:0                    
~Output: Records:1           Control Total:0                    
~.18/02/2016   04:02:59 TMP_AP_DUPS_2 EXTRACT RECORD IF DUP_KEY= TMP_AP_Dup2.DUP_KEY TO "Tmp_Files\TMP_AP_02" OPEN
~Input : Records:302         Control Total:0                    
~Output: Records:302         Control Total:0                    
~.18/02/2016   04:02:59 TMP_AP_02 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:302         Control Total:0                    
~Output: Records:302         Control Total:0                    
~.18/02/2016   04:03:00 TMP_Cur EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY IF DUP_KEY= TMP_His.DUP_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:302         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:03:00 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:03:00 TMP10 SORT ON SORT_KEY D TO "Results\AP003_Dup_Amt_Dt_Inv"  OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:03:00 AP003_Dup_Amt_Dt_Inv EXTRACT Flag VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description' Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc TO  TMP_AP003 IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_AP001_History_ID_KEY           AP001_History                    "" "IDX_AP001_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_AP001_HISTORY_ID_KEY
^FORMAT   AP001_History                      AP001_History                    "History" "AP001_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~**** SOME HISTORY DELETED ****
~.19/01/2016   04:01:34 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT SORT_KEY RANK ID_KEY TO "History\AP001_History" APPEND
~Input : Records:20          Control Total:0                    
~Output: Records:20          Control Total:0                    
~.20/01/2016   04:01:56 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT SORT_KEY RANK ID_KEY TO "History\AP001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.21/01/2016   04:01:41 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT SORT_KEY RANK ID_KEY TO "History\AP001_History" APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.22/01/2016   04:02:35 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT SORT_KEY RANK ID_KEY TO "History\AP001_History" APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.25/01/2016   04:02:04 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT SORT_KEY RANK ID_KEY TO "History\AP001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.26/01/2016   04:02:13 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT SORT_KEY RANK ID_KEY TO "History\AP001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.27/01/2016   04:01:40 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT SORT_KEY RANK ID_KEY TO "History\AP001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.28/01/2016   04:01:50 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT SORT_KEY RANK ID_KEY TO "History\AP001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.29/01/2016   04:01:49 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT SORT_KEY RANK ID_KEY TO "History\AP001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.03/02/2016   10:49:44 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT SORT_KEY RANK ID_KEY TO "History\AP001_History" APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.04/02/2016   04:03:43 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT SORT_KEY RANK ID_KEY TO "History\AP001_History" APPEND
~Input : Records:6           Control Total:0                    
~Output: Records:6           Control Total:0                    
~.05/02/2016   04:03:54 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT SORT_KEY RANK ID_KEY TO "History\AP001_History" APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.08/02/2016   04:04:41 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT SORT_KEY RANK ID_KEY TO "History\AP001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.09/02/2016   04:03:33 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT SORT_KEY RANK ID_KEY TO "History\AP001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.10/02/2016   04:03:07 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT SORT_KEY RANK ID_KEY TO "History\AP001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.11/02/2016   04:03:18 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT SORT_KEY RANK ID_KEY TO "History\AP001_History" APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.12/02/2016   04:04:12 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT SORT_KEY RANK ID_KEY TO "History\AP001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.15/02/2016   04:03:34 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT SORT_KEY RANK ID_KEY TO "History\AP001_History" APPEND
~Input : Records:6           Control Total:0                    
~Output: Records:6           Control Total:0                    
~.16/02/2016   04:03:42 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT SORT_KEY RANK ID_KEY TO "History\AP001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.17/02/2016   04:02:15 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT SORT_KEY RANK ID_KEY TO "History\AP001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:03:01 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT SORT_KEY RANK ID_KEY TO "History\AP001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   AP001_Dup_Amt_Dt_Inv_Vndr          AP001_Dup_Amt_Dt_Inv_Vndr        "Results" "AP001_Dup_Amt_Dt_Inv_Vndr.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~**** SOME HISTORY DELETED ****
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:00:38 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:42 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:45 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   04:02:47 AP_Invoices SET FILTER ABS_INVAMT<>0.00
~.18/02/2016   04:02:47 AP_Invoices DUPLICATES ON c_Inv_No ABS_INVAMT OTHER Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ PRESORT OPEN TO "Tmp_Files\AP_Dups_Amt_Inv.FIL"
~Input : Records:235098      Control Total:0                    
~Output: Records:235007      Control Total:0                    
~.18/02/2016   04:02:47 AP_Dups_Amt_Inv EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:2520        Control Total:0                    
~Output: Records:2520        Control Total:0                    
~.18/02/2016   04:02:51 TMP_GL EXTRACT FIELDS ALL IF Vndr_Site_ID<> GreyList_AP001.Vndr_Site_ID TO TMP_GL1 OPEN
~Input : Records:2520        Control Total:0                    
~Output: Records:2520        Control Total:0                    
~.18/02/2016   04:02:51 TMP_GL1 SET FILTER ABS_INVAMT_CENT <>0.00
~.18/02/2016   04:02:51 TMP_GL1 DUPLICATES ON c_Inv_No ABS_INVAMT_CENT  Inv_Dt Vndr_ID OTHER Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ PRESORT OPEN TO "Tmp_Files\TMP_AP_DUPS.FIL"
~Input : Records:2520        Control Total:0                    
~Output: Records:2520        Control Total:0                    
~.18/02/2016   04:02:51 TMP_AP_DUPS EXTRACT FIELDS "O" AS "Flag" REV_KEY DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ TO "Tmp_Files\TMP_AP_DUPS_1"
~Input : Records:1151        Control Total:0                    
~Output: Records:1151        Control Total:0                    
~.18/02/2016   04:02:52 TMP_AP_CREDIT EXTRACT FIELDS "D" AS "Flag" REV_KEY TMP_AP_DUPS.DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF REV_KEY = TMP_AP_DUPS.REV_KEY TO "Tmp_Files\TMP_AP_DUPS_1" OPEN APPEND
~Input : Records:1127        Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:02:52 TMP_AP_DUPS_1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF NOT ISBLANK(Dup_Keys.DUP_KEY) TO "Tmp_Files\TMP_AP_DUPS_2" OPEN
~Input : Records:1151        Control Total:0                    
~Output: Records:224         Control Total:0                    
~.18/02/2016   04:02:52 TMP_AP_DUPS_5 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ TO "Tmp_Files\TMP_AP_DUPS_2" APPEND
~Input : Records:5           Control Total:0                    
~Output: Records:5           Control Total:0                    
~.18/02/2016   04:02:52 TMP_AP_DUPS_2 SORT ON SORT_KEY D TO "Tmp_Files\AP001_TMP" IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN
~Input : Records:229         Control Total:0                    
~Output: Records:223         Control Total:0                    
~.18/02/2016   04:03:01 AP001_TMP EXTRACT RECORD IF DUP_KEY= TMP_AP_Dups_1.DUP_KEY TO "Tmp_Files\TMP_AP_Dups_2" OPEN
~Input : Records:223         Control Total:0                    
~Output: Records:215         Control Total:0                    
~.18/02/2016   04:03:01 TMP_AP_Dups_2 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:215         Control Total:0                    
~Output: Records:215         Control Total:0                    
~.18/02/2016   04:03:01 TMP_Cur EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT SORT_KEY RANK ID_KEY IF DUP_KEY= TMP_His.DUP_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:215         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:03:01 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:03:01 TMP10 SORT ON SORT_KEY D TO "Results\AP001_Dup_Amt_Dt_Inv_Vndr" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   TMP_AP001                          TMP_AP001                        "" "TMP_AP001.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1430899205
~**** SOME HISTORY DELETED ****
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:00:38 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:42 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:45 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   04:02:47 AP_Invoices SET FILTER ABS_INVAMT<>0.00
~.18/02/2016   04:02:47 AP_Invoices DUPLICATES ON c_Inv_No ABS_INVAMT OTHER Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ PRESORT OPEN TO "Tmp_Files\AP_Dups_Amt_Inv.FIL"
~Input : Records:235098      Control Total:0                    
~Output: Records:235007      Control Total:0                    
~.18/02/2016   04:02:47 AP_Dups_Amt_Inv EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:2520        Control Total:0                    
~Output: Records:2520        Control Total:0                    
~.18/02/2016   04:02:51 TMP_GL EXTRACT FIELDS ALL IF Vndr_Site_ID<> GreyList_AP001.Vndr_Site_ID TO TMP_GL1 OPEN
~Input : Records:2520        Control Total:0                    
~Output: Records:2520        Control Total:0                    
~.18/02/2016   04:02:51 TMP_GL1 SET FILTER ABS_INVAMT_CENT <>0.00
~.18/02/2016   04:02:51 TMP_GL1 DUPLICATES ON c_Inv_No ABS_INVAMT_CENT  Inv_Dt Vndr_ID OTHER Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ PRESORT OPEN TO "Tmp_Files\TMP_AP_DUPS.FIL"
~Input : Records:2520        Control Total:0                    
~Output: Records:2520        Control Total:0                    
~.18/02/2016   04:02:51 TMP_AP_DUPS EXTRACT FIELDS "O" AS "Flag" REV_KEY DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ TO "Tmp_Files\TMP_AP_DUPS_1"
~Input : Records:1151        Control Total:0                    
~Output: Records:1151        Control Total:0                    
~.18/02/2016   04:02:52 TMP_AP_CREDIT EXTRACT FIELDS "D" AS "Flag" REV_KEY TMP_AP_DUPS.DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF REV_KEY = TMP_AP_DUPS.REV_KEY TO "Tmp_Files\TMP_AP_DUPS_1" OPEN APPEND
~Input : Records:1127        Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:02:52 TMP_AP_DUPS_1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF NOT ISBLANK(Dup_Keys.DUP_KEY) TO "Tmp_Files\TMP_AP_DUPS_2" OPEN
~Input : Records:1151        Control Total:0                    
~Output: Records:224         Control Total:0                    
~.18/02/2016   04:02:52 TMP_AP_DUPS_5 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ TO "Tmp_Files\TMP_AP_DUPS_2" APPEND
~Input : Records:5           Control Total:0                    
~Output: Records:5           Control Total:0                    
~.18/02/2016   04:02:52 TMP_AP_DUPS_2 SORT ON SORT_KEY D TO "Tmp_Files\AP001_TMP" IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN
~Input : Records:229         Control Total:0                    
~Output: Records:223         Control Total:0                    
~.18/02/2016   04:03:01 AP001_TMP EXTRACT RECORD IF DUP_KEY= TMP_AP_Dups_1.DUP_KEY TO "Tmp_Files\TMP_AP_Dups_2" OPEN
~Input : Records:223         Control Total:0                    
~Output: Records:215         Control Total:0                    
~.18/02/2016   04:03:01 TMP_AP_Dups_2 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:215         Control Total:0                    
~Output: Records:215         Control Total:0                    
~.18/02/2016   04:03:01 TMP_Cur EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT SORT_KEY RANK ID_KEY IF DUP_KEY= TMP_His.DUP_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:215         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:03:01 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:03:01 TMP10 SORT ON SORT_KEY D TO "Results\AP001_Dup_Amt_Dt_Inv_Vndr" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:03:01 AP001_Dup_Amt_Dt_Inv_Vndr  EXTRACT Flag VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description'  Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc TO  TMP_AP001
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   GreyList_AP004                     GreyList_AP004                   "Working_Files" "GreyList_AP004.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1427252735
~.18/02/2016   04:03:28 TMP2 EXTRACT FIELDS SUBSTR(ALLTRIM(F1),1,20) AS 'Vndr_Site_ID' SUBSTR(ALLTRIM(F2),1,60) AS 'Vndr_Name' IF NOT ISBLANK(F1) AND RECNO()>1 TO "Working_Files\GreyList_AP004.fil"
~Input : Records:1           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_GreyList_AP004_Vndr_Site_ID    GreyList_AP004                   "" "IDX_GreyList_AP004_Vndr_Site_ID.INX" 
*INDEX ON VNDR_SITE_ID TO IDX_GREYLIST_AP004_VNDR_SITE_ID
^INDEX    IDX_AP_Dups_Rev_Vchr_ID            AP_Dups_Rev                      "" "IDX_AP_Dups_Rev_Vchr_ID.INX" 
*INDEX ON VCHR_ID TO IDX_AP_DUPS_REV_VCHR_ID
^FORMAT   AP_Dups_Rev                        AP_Dups_Rev                      "Tmp_Files" "AP_Dups_Rev.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1430899205
~.18/02/2016   04:00:23 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:10948       Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20160217.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:00:38 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:42 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:45 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   04:02:47 AP_Invoices SET FILTER ABS_INVAMT<>0.00
~.18/02/2016   04:02:47 AP_Invoices DUPLICATES ON c_Inv_No ABS_INVAMT OTHER Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ PRESORT OPEN TO "Tmp_Files\AP_Dups_Amt_Inv.FIL"
~Input : Records:235098      Control Total:0                    
~Output: Records:235007      Control Total:0                    
~.18/02/2016   04:02:47 AP_Dups_Amt_Inv EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:2520        Control Total:0                    
~Output: Records:2520        Control Total:0                    
~.18/02/2016   04:02:51 TMP_GL EXTRACT FIELDS ALL IF Vndr_Site_ID<> GreyList_AP001.Vndr_Site_ID TO TMP_GL1 OPEN
~Input : Records:2520        Control Total:0                    
~Output: Records:2520        Control Total:0                    
~.18/02/2016   04:02:51 TMP_GL1 SET FILTER ABS_INVAMT_CENT <>0.00
~.18/02/2016   04:02:51 TMP_GL1 DUPLICATES ON c_Inv_No ABS_INVAMT_CENT  Inv_Dt Vndr_ID OTHER Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ PRESORT OPEN TO "Tmp_Files\TMP_AP_DUPS.FIL"
~Input : Records:2520        Control Total:0                    
~Output: Records:2520        Control Total:0                    
~.18/02/2016   04:02:51 TMP_AP_DUPS EXTRACT FIELDS "O" AS "Flag" REV_KEY DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ TO "Tmp_Files\TMP_AP_DUPS_1"
~Input : Records:1151        Control Total:0                    
~Output: Records:1151        Control Total:0                    
~.18/02/2016   04:02:52 TMP_AP_CREDIT EXTRACT FIELDS "D" AS "Flag" REV_KEY TMP_AP_DUPS.DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF REV_KEY = TMP_AP_DUPS.REV_KEY TO "Tmp_Files\TMP_AP_DUPS_1" OPEN APPEND
~Input : Records:1127        Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:02:52 TMP_AP_DUPS_1 IF v_TestNo="AP001" EXTRACT FIELDS v_TestNo AS "Dup_No" DUP_KEY Flag Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ _RptRunDate AS "RptRunDate" IF ISBLANK(Dup_Keys.DUP_KEY) TO "Tmp_Files\AP_Dups_Rev"
~Input : Records:1151        Control Total:0                    
~Output: Records:927         Control Total:0                    
~.18/02/2016   04:02:55 AP_TMP1 IF v_TestNo<>"AP001" EXTRACT FIELDS Dup_No DUP_KEY Flag Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ _RptRunDate TO "Tmp_Files\AP_Dups_Rev" APPEND
~Input : Records:87          Control Total:0                    
~Output: Records:87          Control Total:0                    
~.18/02/2016   04:02:59 AP_TMP1 IF v_TestNo<>"AP001" EXTRACT FIELDS Dup_No DUP_KEY Flag Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ _RptRunDate TO "Tmp_Files\AP_Dups_Rev" APPEND
~Input : Records:7           Control Total:0                    
~Output: Records:7           Control Total:0                    
~.18/02/2016   04:03:51 AP_TMP1 IF v_TestNo<>"AP001" EXTRACT FIELDS Dup_No DUP_KEY Flag Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ _RptRunDate TO "Tmp_Files\AP_Dups_Rev" APPEND
~Input : Records:183         Control Total:0                    
~Output: Records:183         Control Total:0                    
^FORMAT   TMP_DUP_SUM                        TMP_DUP_SUM                      "Tmp_Files" "TMP_DUP_SUM.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1430899205
~.18/02/2016   04:00:23 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:10948       Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20160217.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:00:38 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:42 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:45 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   04:03:28 AP_Invoices EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:235098      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   04:03:41 TMP_GL EXTRACT FIELDS ALL IF Vndr_Site_ID<> GreyList_AP004.Vndr_Site_ID TO TMP_GL1 OPEN
~Input : Records:235098      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   04:03:44 TMP_GL1 DUPLICATES ON ABS_INVAMT_CENT Inv_Dt Vndr_ID OTHER Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF ABS_INVAMT_CENT <>0.00 PRESORT OPEN TO "Tmp_Files\AP_TMP.FIL"
~Input : Records:235098      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   04:03:48 AP_TMP EXTRACT FIELDS DUP_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF DUP_KEY= AP_TMP2.DUP_KEY TO "Tmp_Files\TMP_AP_DUPS" OPEN
~Input : Records:17299       Control Total:0                    
~Output: Records:16346       Control Total:0                    
~.18/02/2016   04:03:49 TMP_AP_DUPS EXTRACT FIELDS "O" AS "Flag" REV_KEY DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ TO "Tmp_Files\TMP_AP_DUPS_1"
~Input : Records:16346       Control Total:0                    
~Output: Records:16346       Control Total:0                    
~.18/02/2016   04:03:50 TMP_AP_CREDIT EXTRACT FIELDS "D" AS "Flag" REV_KEY TMP_AP_DUPS.DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF REV_KEY = TMP_AP_DUPS.REV_KEY TO "Tmp_Files\TMP_AP_DUPS_1" OPEN APPEND
~Input : Records:1340        Control Total:0                    
~Output: Records:6           Control Total:0                    
~.18/02/2016   04:03:52 TMP_AP_DUPS_1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF NOT ISBLANK(Dup_Keys.DUP_KEY) TO "Tmp_Files\TMP_AP_DUPS_2" OPEN
~Input : Records:16352       Control Total:0                    
~Output: Records:16075       Control Total:0                    
~.18/02/2016   04:03:52 TMP_AP_DUPS_5 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ TO "Tmp_Files\TMP_AP_DUPS_2" APPEND
~Input : Records:57          Control Total:0                    
~Output: Records:57          Control Total:0                    
~.18/02/2016   04:03:53 TMP_AP_DUPS_2 EXTRACT RECORD IF DUP_KEY= TMP_AP_Dup2.DUP_KEY TO "Tmp_Files\TMP_AP_02" OPEN
~Input : Records:16132       Control Total:0                    
~Output: Records:16128       Control Total:0                    
~.18/02/2016   04:03:53 TMP_AP_02 SUMMARIZE ON DUP_KEY SUBTOTAL Inv_Amt TO "Tmp_Files\TMP_DUP_SUM.FIL" OPEN PRESORT
~Input : Records:16128       Control Total:0                    
~Output: Records:5707        Control Total:0                    
^INDEX    IDX_TMP_DUP_SUM_DUP_KEY            TMP_DUP_SUM                      "" "IDX_TMP_DUP_SUM_DUP_KEY.INX" 
*INDEX ON DUP_KEY TO IDX_TMP_DUP_SUM_DUP_KEY
^INDEX    IDX_AP004_History_ID_KEY           AP004_History                    "" "IDX_AP004_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_AP004_HISTORY_ID_KEY
^FORMAT   AP004_History                      AP004_History                    "History" "AP004_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~**** SOME HISTORY DELETED ****
~.19/01/2016   04:01:58 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP004_History" APPEND
~Input : Records:66          Control Total:0                    
~Output: Records:66          Control Total:0                    
~.20/01/2016   04:02:34 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP004_History" APPEND
~Input : Records:23          Control Total:0                    
~Output: Records:23          Control Total:0                    
~.21/01/2016   04:02:05 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP004_History" APPEND
~Input : Records:18          Control Total:0                    
~Output: Records:18          Control Total:0                    
~.22/01/2016   04:03:09 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP004_History" APPEND
~Input : Records:39          Control Total:0                    
~Output: Records:39          Control Total:0                    
~.25/01/2016   04:02:29 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP004_History" APPEND
~Input : Records:118         Control Total:0                    
~Output: Records:118         Control Total:0                    
~.26/01/2016   04:02:47 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP004_History" APPEND
~Input : Records:6           Control Total:0                    
~Output: Records:6           Control Total:0                    
~.27/01/2016   04:02:08 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP004_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.28/01/2016   04:02:26 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP004_History" APPEND
~Input : Records:43          Control Total:0                    
~Output: Records:43          Control Total:0                    
~.29/01/2016   04:02:21 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP004_History" APPEND
~Input : Records:20          Control Total:0                    
~Output: Records:20          Control Total:0                    
~.03/02/2016   10:50:51 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP004_History" APPEND
~Input : Records:207         Control Total:0                    
~Output: Records:207         Control Total:0                    
~.04/02/2016   04:04:53 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP004_History" APPEND
~Input : Records:26          Control Total:0                    
~Output: Records:26          Control Total:0                    
~.05/02/2016   04:05:04 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP004_History" APPEND
~Input : Records:128         Control Total:0                    
~Output: Records:128         Control Total:0                    
~.08/02/2016   04:05:54 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP004_History" APPEND
~Input : Records:91          Control Total:0                    
~Output: Records:91          Control Total:0                    
~.09/02/2016   04:04:38 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP004_History" APPEND
~Input : Records:17          Control Total:0                    
~Output: Records:17          Control Total:0                    
~.10/02/2016   04:04:43 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP004_History" APPEND
~Input : Records:12          Control Total:0                    
~Output: Records:12          Control Total:0                    
~.11/02/2016   04:04:29 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP004_History" APPEND
~Input : Records:17          Control Total:0                    
~Output: Records:17          Control Total:0                    
~.12/02/2016   04:05:37 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP004_History" APPEND
~Input : Records:114         Control Total:0                    
~Output: Records:114         Control Total:0                    
~.15/02/2016   04:04:31 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP004_History" APPEND
~Input : Records:46          Control Total:0                    
~Output: Records:46          Control Total:0                    
~.16/02/2016   04:04:46 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP004_History" APPEND
~Input : Records:89          Control Total:0                    
~Output: Records:89          Control Total:0                    
~.17/02/2016   04:02:53 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP004_History" APPEND
~Input : Records:54          Control Total:0                    
~Output: Records:54          Control Total:0                    
~.18/02/2016   04:03:56 TMP_Cur1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY TO "History\AP004_History" APPEND
~Input : Records:36          Control Total:0                    
~Output: Records:36          Control Total:0                    
^FORMAT   AP004_Dup_Amt_Dt_Vndr              AP004_Dup_Amt_Dt_Vndr            "Results" "AP004_Dup_Amt_Dt_Vndr.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.18/02/2016   04:00:23 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:10948       Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20160217.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:00:38 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:42 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:45 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   04:03:28 AP_Invoices EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:235098      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   04:03:41 TMP_GL EXTRACT FIELDS ALL IF Vndr_Site_ID<> GreyList_AP004.Vndr_Site_ID TO TMP_GL1 OPEN
~Input : Records:235098      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   04:03:44 TMP_GL1 DUPLICATES ON ABS_INVAMT_CENT Inv_Dt Vndr_ID OTHER Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF ABS_INVAMT_CENT <>0.00 PRESORT OPEN TO "Tmp_Files\AP_TMP.FIL"
~Input : Records:235098      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   04:03:48 AP_TMP EXTRACT FIELDS DUP_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF DUP_KEY= AP_TMP2.DUP_KEY TO "Tmp_Files\TMP_AP_DUPS" OPEN
~Input : Records:17299       Control Total:0                    
~Output: Records:16346       Control Total:0                    
~.18/02/2016   04:03:49 TMP_AP_DUPS EXTRACT FIELDS "O" AS "Flag" REV_KEY DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ TO "Tmp_Files\TMP_AP_DUPS_1"
~Input : Records:16346       Control Total:0                    
~Output: Records:16346       Control Total:0                    
~.18/02/2016   04:03:50 TMP_AP_CREDIT EXTRACT FIELDS "D" AS "Flag" REV_KEY TMP_AP_DUPS.DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF REV_KEY = TMP_AP_DUPS.REV_KEY TO "Tmp_Files\TMP_AP_DUPS_1" OPEN APPEND
~Input : Records:1340        Control Total:0                    
~Output: Records:6           Control Total:0                    
~.18/02/2016   04:03:52 TMP_AP_DUPS_1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF NOT ISBLANK(Dup_Keys.DUP_KEY) TO "Tmp_Files\TMP_AP_DUPS_2" OPEN
~Input : Records:16352       Control Total:0                    
~Output: Records:16075       Control Total:0                    
~.18/02/2016   04:03:52 TMP_AP_DUPS_5 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ TO "Tmp_Files\TMP_AP_DUPS_2" APPEND
~Input : Records:57          Control Total:0                    
~Output: Records:57          Control Total:0                    
~.18/02/2016   04:03:53 TMP_AP_DUPS_2 EXTRACT RECORD IF DUP_KEY= TMP_AP_Dup2.DUP_KEY TO "Tmp_Files\TMP_AP_02" OPEN
~Input : Records:16132       Control Total:0                    
~Output: Records:16128       Control Total:0                    
~.18/02/2016   04:03:53 TMP_AP_02 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:16128       Control Total:0                    
~Output: Records:16128       Control Total:0                    
~.18/02/2016   04:03:56 TMP_Cur EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY IF DUP_KEY= TMP_His.DUP_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:16128       Control Total:0                    
~Output: Records:36          Control Total:0                    
~.18/02/2016   04:03:56 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:36          Control Total:0                    
~Output: Records:36          Control Total:0                    
~.18/02/2016   04:03:56 TMP10 SORT ON SORT_KEY D TO "Results\AP004_Dup_Amt_Dt_Vndr"  OPEN
~Input : Records:36          Control Total:0                    
~Output: Records:36          Control Total:0                    
^FORMAT   TMP_AP004                          TMP_AP004                        "" "TMP_AP004.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1430899205
~**** SOME HISTORY DELETED ****
~.18/02/2016   04:00:23 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20160217.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:00:38 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:42 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:45 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   04:03:28 AP_Invoices EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:235098      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   04:03:41 TMP_GL EXTRACT FIELDS ALL IF Vndr_Site_ID<> GreyList_AP004.Vndr_Site_ID TO TMP_GL1 OPEN
~Input : Records:235098      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   04:03:44 TMP_GL1 DUPLICATES ON ABS_INVAMT_CENT Inv_Dt Vndr_ID OTHER Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF ABS_INVAMT_CENT <>0.00 PRESORT OPEN TO "Tmp_Files\AP_TMP.FIL"
~Input : Records:235098      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   04:03:48 AP_TMP EXTRACT FIELDS DUP_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF DUP_KEY= AP_TMP2.DUP_KEY TO "Tmp_Files\TMP_AP_DUPS" OPEN
~Input : Records:17299       Control Total:0                    
~Output: Records:16346       Control Total:0                    
~.18/02/2016   04:03:49 TMP_AP_DUPS EXTRACT FIELDS "O" AS "Flag" REV_KEY DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ TO "Tmp_Files\TMP_AP_DUPS_1"
~Input : Records:16346       Control Total:0                    
~Output: Records:16346       Control Total:0                    
~.18/02/2016   04:03:50 TMP_AP_CREDIT EXTRACT FIELDS "D" AS "Flag" REV_KEY TMP_AP_DUPS.DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF REV_KEY = TMP_AP_DUPS.REV_KEY TO "Tmp_Files\TMP_AP_DUPS_1" OPEN APPEND
~Input : Records:1340        Control Total:0                    
~Output: Records:6           Control Total:0                    
~.18/02/2016   04:03:52 TMP_AP_DUPS_1 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ IF NOT ISBLANK(Dup_Keys.DUP_KEY) TO "Tmp_Files\TMP_AP_DUPS_2" OPEN
~Input : Records:16352       Control Total:0                    
~Output: Records:16075       Control Total:0                    
~.18/02/2016   04:03:52 TMP_AP_DUPS_5 EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ TO "Tmp_Files\TMP_AP_DUPS_2" APPEND
~Input : Records:57          Control Total:0                    
~Output: Records:57          Control Total:0                    
~.18/02/2016   04:03:53 TMP_AP_DUPS_2 EXTRACT RECORD IF DUP_KEY= TMP_AP_Dup2.DUP_KEY TO "Tmp_Files\TMP_AP_02" OPEN
~Input : Records:16132       Control Total:0                    
~Output: Records:16128       Control Total:0                    
~.18/02/2016   04:03:53 TMP_AP_02 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:16128       Control Total:0                    
~Output: Records:16128       Control Total:0                    
~.18/02/2016   04:03:56 TMP_Cur EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ RANK SORT_KEY SORT_KEY_Desc Priority RptRunDate Data_Range_Start_Date Data_Range_End_Date ID_KEY IF DUP_KEY= TMP_His.DUP_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:16128       Control Total:0                    
~Output: Records:36          Control Total:0                    
~.18/02/2016   04:03:56 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:36          Control Total:0                    
~Output: Records:36          Control Total:0                    
~.18/02/2016   04:03:56 TMP10 SORT ON SORT_KEY D TO "Results\AP004_Dup_Amt_Dt_Vndr"  OPEN
~Input : Records:36          Control Total:0                    
~Output: Records:36          Control Total:0                    
~.18/02/2016   04:03:56 AP004_Dup_Amt_Dt_Vndr EXTRACT Flag VMF_VND_Master_File.Cha_Field1 AS 'Vendor Site' Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name in VMF' Vndr_Sts AS 'Vendor Status' ' '+ c_QUOTED_INV_ID AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Cha_Field3 AS 'Payment Status Flag' Doc_Typ AS 'Invoice_Type' Cha_Field4 AS 'Description'  Vchr_ID AS 'Trans Number'  Cha_Field2 AS 'GST Status' Priority Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID' Inv_No AS 'Invoice ID'  'R11' AS 'SourceFlag' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc TO  TMP_AP004 IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"
~Input : Records:36          Control Total:0                    
~Output: Records:36          Control Total:0                    
^FORMAT   GreyList_AP006                     GreyList_AP006                   "Working_Files" "GreyList_AP006.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1427252735
~.18/02/2016   04:04:02 TMP2 EXTRACT FIELDS SUBSTR(ALLTRIM(F1),1,20) AS 'Vndr_Site_ID' SUBSTR(ALLTRIM(F2),1,60) AS 'Vndr_Name' IF NOT ISBLANK(F1) AND RECNO()>1 TO "Working_Files\GreyList_AP006.fil"
~Input : Records:1           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_GreyList_AP006_Vndr_Site_ID    GreyList_AP006                   "" "IDX_GreyList_AP006_Vndr_Site_ID.INX" 
*INDEX ON VNDR_SITE_ID TO IDX_GREYLIST_AP006_VNDR_SITE_ID
^INDEX    IDX_AP006_History_ID_KEY           AP006_History                    "" "IDX_AP006_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_AP006_HISTORY_ID_KEY
^FORMAT   AP006_History                      AP006_History                    "History" "AP006_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~**** SOME HISTORY DELETED ****
~.19/01/2016   04:02:01 TMP_Cur1 EXTRACT FIELDS Vchr_ID Vndr_Site_ID Vndr_ID Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Ex_Rate Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_Dt Modf_By Pst_Dt VOIDED Void_Dt isPaid Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No2 c_Inv_No ABS_INVAMT ABS_INVAMT_CENT c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ID_KEY TO "History\AP006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.20/01/2016   04:02:37 TMP_Cur1 EXTRACT FIELDS Vchr_ID Vndr_Site_ID Vndr_ID Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Ex_Rate Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_Dt Modf_By Pst_Dt VOIDED Void_Dt isPaid Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No2 c_Inv_No ABS_INVAMT ABS_INVAMT_CENT c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ID_KEY TO "History\AP006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.21/01/2016   04:02:08 TMP_Cur1 EXTRACT FIELDS Vchr_ID Vndr_Site_ID Vndr_ID Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Ex_Rate Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_Dt Modf_By Pst_Dt VOIDED Void_Dt isPaid Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No2 c_Inv_No ABS_INVAMT ABS_INVAMT_CENT c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ID_KEY TO "History\AP006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.22/01/2016   04:03:15 TMP_Cur1 EXTRACT FIELDS Vchr_ID Vndr_Site_ID Vndr_ID Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Ex_Rate Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_Dt Modf_By Pst_Dt VOIDED Void_Dt isPaid Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No2 c_Inv_No ABS_INVAMT ABS_INVAMT_CENT c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ID_KEY TO "History\AP006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.25/01/2016   04:02:34 TMP_Cur1 EXTRACT FIELDS Vchr_ID Vndr_Site_ID Vndr_ID Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Ex_Rate Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_Dt Modf_By Pst_Dt VOIDED Void_Dt isPaid Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No2 c_Inv_No ABS_INVAMT ABS_INVAMT_CENT c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ID_KEY TO "History\AP006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.26/01/2016   04:02:51 TMP_Cur1 EXTRACT FIELDS Vchr_ID Vndr_Site_ID Vndr_ID Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Ex_Rate Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_Dt Modf_By Pst_Dt VOIDED Void_Dt isPaid Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No2 c_Inv_No ABS_INVAMT ABS_INVAMT_CENT c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ID_KEY TO "History\AP006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.27/01/2016   04:02:11 TMP_Cur1 EXTRACT FIELDS Vchr_ID Vndr_Site_ID Vndr_ID Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Ex_Rate Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_Dt Modf_By Pst_Dt VOIDED Void_Dt isPaid Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No2 c_Inv_No ABS_INVAMT ABS_INVAMT_CENT c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ID_KEY TO "History\AP006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.28/01/2016   04:02:31 TMP_Cur1 EXTRACT FIELDS Vchr_ID Vndr_Site_ID Vndr_ID Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Ex_Rate Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_Dt Modf_By Pst_Dt VOIDED Void_Dt isPaid Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No2 c_Inv_No ABS_INVAMT ABS_INVAMT_CENT c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ID_KEY TO "History\AP006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.29/01/2016   04:02:24 TMP_Cur1 EXTRACT FIELDS Vchr_ID Vndr_Site_ID Vndr_ID Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Ex_Rate Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_Dt Modf_By Pst_Dt VOIDED Void_Dt isPaid Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No2 c_Inv_No ABS_INVAMT ABS_INVAMT_CENT c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ID_KEY TO "History\AP006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.03/02/2016   10:51:00 TMP_Cur1 EXTRACT FIELDS Vchr_ID Vndr_Site_ID Vndr_ID Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Ex_Rate Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_Dt Modf_By Pst_Dt VOIDED Void_Dt isPaid Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No2 c_Inv_No ABS_INVAMT ABS_INVAMT_CENT c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ID_KEY TO "History\AP006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.04/02/2016   04:05:02 TMP_Cur1 EXTRACT FIELDS Vchr_ID Vndr_Site_ID Vndr_ID Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Ex_Rate Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_Dt Modf_By Pst_Dt VOIDED Void_Dt isPaid Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No2 c_Inv_No ABS_INVAMT ABS_INVAMT_CENT c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ID_KEY TO "History\AP006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.05/02/2016   04:05:11 TMP_Cur1 EXTRACT FIELDS Vchr_ID Vndr_Site_ID Vndr_ID Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Ex_Rate Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_Dt Modf_By Pst_Dt VOIDED Void_Dt isPaid Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No2 c_Inv_No ABS_INVAMT ABS_INVAMT_CENT c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ID_KEY TO "History\AP006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.08/02/2016   04:06:02 TMP_Cur1 EXTRACT FIELDS Vchr_ID Vndr_Site_ID Vndr_ID Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Ex_Rate Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_Dt Modf_By Pst_Dt VOIDED Void_Dt isPaid Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No2 c_Inv_No ABS_INVAMT ABS_INVAMT_CENT c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ID_KEY TO "History\AP006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.09/02/2016   04:04:46 TMP_Cur1 EXTRACT FIELDS Vchr_ID Vndr_Site_ID Vndr_ID Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Ex_Rate Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_Dt Modf_By Pst_Dt VOIDED Void_Dt isPaid Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No2 c_Inv_No ABS_INVAMT ABS_INVAMT_CENT c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ID_KEY TO "History\AP006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.10/02/2016   04:04:49 TMP_Cur1 EXTRACT FIELDS Vchr_ID Vndr_Site_ID Vndr_ID Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Ex_Rate Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_Dt Modf_By Pst_Dt VOIDED Void_Dt isPaid Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No2 c_Inv_No ABS_INVAMT ABS_INVAMT_CENT c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ID_KEY TO "History\AP006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.11/02/2016   04:04:37 TMP_Cur1 EXTRACT FIELDS Vchr_ID Vndr_Site_ID Vndr_ID Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Ex_Rate Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_Dt Modf_By Pst_Dt VOIDED Void_Dt isPaid Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No2 c_Inv_No ABS_INVAMT ABS_INVAMT_CENT c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ID_KEY TO "History\AP006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/02/2016   04:05:48 TMP_Cur1 EXTRACT FIELDS Vchr_ID Vndr_Site_ID Vndr_ID Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Ex_Rate Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_Dt Modf_By Pst_Dt VOIDED Void_Dt isPaid Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No2 c_Inv_No ABS_INVAMT ABS_INVAMT_CENT c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ID_KEY TO "History\AP006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.15/02/2016   04:04:39 TMP_Cur1 EXTRACT FIELDS Vchr_ID Vndr_Site_ID Vndr_ID Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Ex_Rate Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_Dt Modf_By Pst_Dt VOIDED Void_Dt isPaid Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No2 c_Inv_No ABS_INVAMT ABS_INVAMT_CENT c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ID_KEY TO "History\AP006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.16/02/2016   04:04:53 TMP_Cur1 EXTRACT FIELDS Vchr_ID Vndr_Site_ID Vndr_ID Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Ex_Rate Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_Dt Modf_By Pst_Dt VOIDED Void_Dt isPaid Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No2 c_Inv_No ABS_INVAMT ABS_INVAMT_CENT c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ID_KEY TO "History\AP006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.17/02/2016   04:02:57 TMP_Cur1 EXTRACT FIELDS Vchr_ID Vndr_Site_ID Vndr_ID Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Ex_Rate Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_Dt Modf_By Pst_Dt VOIDED Void_Dt isPaid Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No2 c_Inv_No ABS_INVAMT ABS_INVAMT_CENT c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ID_KEY TO "History\AP006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:04:03 TMP_Cur1 EXTRACT FIELDS Vchr_ID Vndr_Site_ID Vndr_ID Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Ex_Rate Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_Dt Modf_By Pst_Dt VOIDED Void_Dt isPaid Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No2 c_Inv_No ABS_INVAMT ABS_INVAMT_CENT c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ID_KEY TO "History\AP006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   AP006_Pay_Not_In_VMF               AP006_Pay_Not_In_VMF             "Results" "AP006_Pay_Not_In_VMF.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.18/02/2016   04:00:23 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:10948       Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20160217.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:00:38 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:42 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   04:01:45 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   04:04:02 AP_Invoices EXTRACT FIELDS ALL IF ISBLANK(Vndr_Mstr_ID) TO "Tmp_Files\AP_TMP" OPEN
~Input : Records:235098      Control Total:0                    
~Output: Records:15          Control Total:0                    
~.18/02/2016   04:04:02 AP_TMP EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:15          Control Total:0                    
~Output: Records:15          Control Total:0                    
~.18/02/2016   04:04:02 TMP_GL EXTRACT FIELDS ALL IF Vndr_Site_ID<> GreyList_AP006.Vndr_Site_ID TO TMP_GL1 OPEN
~Input : Records:15          Control Total:0                    
~Output: Records:15          Control Total:0                    
~.18/02/2016   04:04:03 TMP_GL1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:15          Control Total:0                    
~Output: Records:15          Control Total:0                    
~.18/02/2016   04:04:03 TMP_Cur EXTRACT FIELDS Vchr_ID Vndr_Site_ID Vndr_ID Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Ex_Rate Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_Dt Modf_By Pst_Dt VOIDED Void_Dt isPaid Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No2 c_Inv_No ABS_INVAMT ABS_INVAMT_CENT c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ID_KEY IF ID_KEY<> AP006_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:15          Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:04:03 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   04:04:03 TMP10 SORT ON SORT_KEY D TO "Results\AP006_Pay_Not_In_VMF"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   Data_VMF_Lst                       Data_VMF_Lst                     "Tmp_Files" "Data_VMF_Lst.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1430899205
~.18/02/2016   05:30:04   DIR "E:\Data\VendorMasterfile_*" TO "Tmp_Files\TMP4"
~.18/02/2016   05:30:04 TMP4 SORT ON FILE_CREATE_DATE  FILE_CREATE_TIME  TO "Tmp_Files\Data_VMF_Lst"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   Data_VMBnk_Lst                     Data_VMBnk_Lst                   "Tmp_Files" "Data_VMBnk_Lst.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1430899205
~.18/02/2016   05:30:04   DIR "E:\Data\VendorBankAccount_*" TO "Tmp_Files\TMP4"
~.18/02/2016   05:30:04 TMP4 SORT ON FILE_CREATE_DATE  FILE_CREATE_TIME  TO "Tmp_Files\Data_VMBnk_Lst"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   Data_Inv_Lst                       Data_Inv_Lst                     "Tmp_Files" "Data_Inv_Lst.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1430899205
~.18/02/2016   05:30:04   DIR "E:\Data\Invoices_*" TO "Tmp_Files\TMP4"
~.18/02/2016   05:30:04 TMP4 SORT ON FILE_CREATE_DATE  FILE_CREATE_TIME  TO "Tmp_Files\Data_Inv_Lst"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   Lst_Fld                            Lst_Fld                          "Tmp_Files" "Lst_Fld.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1430899205
~.18/02/2016   05:30:04   DIR "E:\Data\Invoices_*" TO "Tmp_Files\TMP4"
~.18/02/2016   05:30:04 TMP4 SET FILTER MAP(c_Folder,"99999999")
~.18/02/2016   05:30:04 TMP4 SORT ON c_Folder TO "Tmp_Files\Lst_Fld" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   Tmp_Chg                            Tmp_Chg                          "Working_Files" "Tmp_Chg.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1430899205
~**** SOME HISTORY DELETED ****
~.15/02/2016   04:02:01 Tmp_Chg EXTRACT FIELDS ALL TO "Working_Files\VMF_BnkAcc_Chg_History" OPEN
~Input : Records:34049       Control Total:0                    
~Output: Records:34049       Control Total:0                    
~.15/02/2016   05:31:00 VMF_BnkAcc_Chg_History EXTRACT FIELDS ALL TO "Tmp_Files\Tmp_Chg"
~Input : Records:34049       Control Total:0                    
~Output: Records:34049       Control Total:0                    
~.15/02/2016   05:31:03 TMP6 EXTRACT FIELDS Vndr_Site_ID Vndr_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type Chg_Dt _RptRunDateTime AS 'RptRunDateTime' IF Vndr_Site_ID=TMP4.Vndr_Site_ID TO "Working_Files\Tmp_Chg" APPEND
~Input : Records:30010       Control Total:0                    
~Output: Records:0           Control Total:0                    
~.15/02/2016   05:31:04 Tmp_Chg EXTRACT FIELDS ALL TO "Working_Files\VMF_BnkAcc_Chg_History" OPEN
~Input : Records:34049       Control Total:0                    
~Output: Records:34049       Control Total:0                    
~.16/02/2016   04:01:48 VMF_BnkAcc_Chg_History EXTRACT FIELDS ALL TO "Tmp_Files\Tmp_Chg"
~Input : Records:34049       Control Total:0                    
~Output: Records:34049       Control Total:0                    
~.16/02/2016   04:01:53 TMP6 EXTRACT FIELDS Vndr_Site_ID Vndr_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type Chg_Dt _RptRunDateTime AS 'RptRunDateTime' IF Vndr_Site_ID=TMP4.Vndr_Site_ID TO "Working_Files\Tmp_Chg" APPEND
~Input : Records:30022       Control Total:0                    
~Output: Records:13          Control Total:0                    
~.16/02/2016   04:01:53 Tmp_Chg EXTRACT FIELDS ALL TO "Working_Files\VMF_BnkAcc_Chg_History" OPEN
~Input : Records:34062       Control Total:0                    
~Output: Records:34062       Control Total:0                    
~.16/02/2016   05:30:58 VMF_BnkAcc_Chg_History EXTRACT FIELDS ALL TO "Tmp_Files\Tmp_Chg"
~Input : Records:34062       Control Total:0                    
~Output: Records:34062       Control Total:0                    
~.16/02/2016   05:31:01 TMP6 EXTRACT FIELDS Vndr_Site_ID Vndr_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type Chg_Dt _RptRunDateTime AS 'RptRunDateTime' IF Vndr_Site_ID=TMP4.Vndr_Site_ID TO "Working_Files\Tmp_Chg" APPEND
~Input : Records:30022       Control Total:0                    
~Output: Records:0           Control Total:0                    
~.16/02/2016   05:31:01 Tmp_Chg EXTRACT FIELDS ALL TO "Working_Files\VMF_BnkAcc_Chg_History" OPEN
~Input : Records:34062       Control Total:0                    
~Output: Records:34062       Control Total:0                    
~.17/02/2016   04:01:08 VMF_BnkAcc_Chg_History EXTRACT FIELDS ALL TO "Tmp_Files\Tmp_Chg"
~Input : Records:34062       Control Total:0                    
~Output: Records:34062       Control Total:0                    
~.17/02/2016   04:01:09 TMP6 EXTRACT FIELDS Vndr_Site_ID Vndr_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type Chg_Dt _RptRunDateTime AS 'RptRunDateTime' IF Vndr_Site_ID=TMP4.Vndr_Site_ID TO "Working_Files\Tmp_Chg" APPEND
~Input : Records:30033       Control Total:0                    
~Output: Records:13          Control Total:0                    
~.17/02/2016   04:01:10 Tmp_Chg EXTRACT FIELDS ALL TO "Working_Files\VMF_BnkAcc_Chg_History" OPEN
~Input : Records:34075       Control Total:0                    
~Output: Records:34075       Control Total:0                    
~.17/02/2016   05:31:05 VMF_BnkAcc_Chg_History EXTRACT FIELDS ALL TO "Tmp_Files\Tmp_Chg"
~Input : Records:34075       Control Total:0                    
~Output: Records:34075       Control Total:0                    
~.17/02/2016   05:31:08 TMP6 EXTRACT FIELDS Vndr_Site_ID Vndr_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type Chg_Dt _RptRunDateTime AS 'RptRunDateTime' IF Vndr_Site_ID=TMP4.Vndr_Site_ID TO "Working_Files\Tmp_Chg" APPEND
~Input : Records:30033       Control Total:0                    
~Output: Records:0           Control Total:0                    
~.17/02/2016   05:31:08 Tmp_Chg EXTRACT FIELDS ALL TO "Working_Files\VMF_BnkAcc_Chg_History" OPEN
~Input : Records:34075       Control Total:0                    
~Output: Records:34075       Control Total:0                    
~.18/02/2016   04:01:29 VMF_BnkAcc_Chg_History EXTRACT FIELDS ALL TO "Tmp_Files\Tmp_Chg"
~Input : Records:34075       Control Total:0                    
~Output: Records:34075       Control Total:0                    
~.18/02/2016   04:01:33 TMP6 EXTRACT FIELDS Vndr_Site_ID Vndr_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type Chg_Dt _RptRunDateTime AS 'RptRunDateTime' IF Vndr_Site_ID=TMP4.Vndr_Site_ID TO "Working_Files\Tmp_Chg" APPEND
~Input : Records:30043       Control Total:0                    
~Output: Records:10          Control Total:0                    
~.18/02/2016   04:01:34 Tmp_Chg EXTRACT FIELDS ALL TO "Working_Files\VMF_BnkAcc_Chg_History" OPEN
~Input : Records:34085       Control Total:0                    
~Output: Records:34085       Control Total:0                    
~.18/02/2016   05:30:59 VMF_BnkAcc_Chg_History EXTRACT FIELDS ALL TO "Tmp_Files\Tmp_Chg"
~Input : Records:34085       Control Total:0                    
~Output: Records:34085       Control Total:0                    
~.18/02/2016   05:31:03 TMP6 EXTRACT FIELDS Vndr_Site_ID Vndr_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type Chg_Dt _RptRunDateTime AS 'RptRunDateTime' IF Vndr_Site_ID=TMP4.Vndr_Site_ID TO "Working_Files\Tmp_Chg" APPEND
~Input : Records:30043       Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   VMF_BnkAcc_Chg_History             VMF_BnkAcc_Chg_History           "Working_Files" "VMF_BnkAcc_Chg_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~**** SOME HISTORY DELETED ****
~.15/02/2016   05:31:00 VMF_BnkAcc_Chg_History EXTRACT FIELDS ALL TO "Tmp_Files\Tmp_Chg"
~Input : Records:34049       Control Total:0                    
~Output: Records:34049       Control Total:0                    
~.15/02/2016   05:31:03 TMP6 EXTRACT FIELDS Vndr_Site_ID Vndr_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type Chg_Dt _RptRunDateTime AS 'RptRunDateTime' IF Vndr_Site_ID=TMP4.Vndr_Site_ID TO "Working_Files\Tmp_Chg" APPEND
~Input : Records:30010       Control Total:0                    
~Output: Records:0           Control Total:0                    
~.15/02/2016   05:31:04 Tmp_Chg EXTRACT FIELDS ALL TO "Working_Files\VMF_BnkAcc_Chg_History" OPEN
~Input : Records:34049       Control Total:0                    
~Output: Records:34049       Control Total:0                    
~.16/02/2016   04:01:48 VMF_BnkAcc_Chg_History EXTRACT FIELDS ALL TO "Tmp_Files\Tmp_Chg"
~Input : Records:34049       Control Total:0                    
~Output: Records:34049       Control Total:0                    
~.16/02/2016   04:01:53 TMP6 EXTRACT FIELDS Vndr_Site_ID Vndr_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type Chg_Dt _RptRunDateTime AS 'RptRunDateTime' IF Vndr_Site_ID=TMP4.Vndr_Site_ID TO "Working_Files\Tmp_Chg" APPEND
~Input : Records:30022       Control Total:0                    
~Output: Records:13          Control Total:0                    
~.16/02/2016   04:01:53 Tmp_Chg EXTRACT FIELDS ALL TO "Working_Files\VMF_BnkAcc_Chg_History" OPEN
~Input : Records:34062       Control Total:0                    
~Output: Records:34062       Control Total:0                    
~.16/02/2016   05:30:58 VMF_BnkAcc_Chg_History EXTRACT FIELDS ALL TO "Tmp_Files\Tmp_Chg"
~Input : Records:34062       Control Total:0                    
~Output: Records:34062       Control Total:0                    
~.16/02/2016   05:31:01 TMP6 EXTRACT FIELDS Vndr_Site_ID Vndr_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type Chg_Dt _RptRunDateTime AS 'RptRunDateTime' IF Vndr_Site_ID=TMP4.Vndr_Site_ID TO "Working_Files\Tmp_Chg" APPEND
~Input : Records:30022       Control Total:0                    
~Output: Records:0           Control Total:0                    
~.16/02/2016   05:31:01 Tmp_Chg EXTRACT FIELDS ALL TO "Working_Files\VMF_BnkAcc_Chg_History" OPEN
~Input : Records:34062       Control Total:0                    
~Output: Records:34062       Control Total:0                    
~.17/02/2016   04:01:08 VMF_BnkAcc_Chg_History EXTRACT FIELDS ALL TO "Tmp_Files\Tmp_Chg"
~Input : Records:34062       Control Total:0                    
~Output: Records:34062       Control Total:0                    
~.17/02/2016   04:01:09 TMP6 EXTRACT FIELDS Vndr_Site_ID Vndr_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type Chg_Dt _RptRunDateTime AS 'RptRunDateTime' IF Vndr_Site_ID=TMP4.Vndr_Site_ID TO "Working_Files\Tmp_Chg" APPEND
~Input : Records:30033       Control Total:0                    
~Output: Records:13          Control Total:0                    
~.17/02/2016   04:01:10 Tmp_Chg EXTRACT FIELDS ALL TO "Working_Files\VMF_BnkAcc_Chg_History" OPEN
~Input : Records:34075       Control Total:0                    
~Output: Records:34075       Control Total:0                    
~.17/02/2016   05:31:05 VMF_BnkAcc_Chg_History EXTRACT FIELDS ALL TO "Tmp_Files\Tmp_Chg"
~Input : Records:34075       Control Total:0                    
~Output: Records:34075       Control Total:0                    
~.17/02/2016   05:31:08 TMP6 EXTRACT FIELDS Vndr_Site_ID Vndr_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type Chg_Dt _RptRunDateTime AS 'RptRunDateTime' IF Vndr_Site_ID=TMP4.Vndr_Site_ID TO "Working_Files\Tmp_Chg" APPEND
~Input : Records:30033       Control Total:0                    
~Output: Records:0           Control Total:0                    
~.17/02/2016   05:31:08 Tmp_Chg EXTRACT FIELDS ALL TO "Working_Files\VMF_BnkAcc_Chg_History" OPEN
~Input : Records:34075       Control Total:0                    
~Output: Records:34075       Control Total:0                    
~.18/02/2016   04:01:29 VMF_BnkAcc_Chg_History EXTRACT FIELDS ALL TO "Tmp_Files\Tmp_Chg"
~Input : Records:34075       Control Total:0                    
~Output: Records:34075       Control Total:0                    
~.18/02/2016   04:01:33 TMP6 EXTRACT FIELDS Vndr_Site_ID Vndr_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type Chg_Dt _RptRunDateTime AS 'RptRunDateTime' IF Vndr_Site_ID=TMP4.Vndr_Site_ID TO "Working_Files\Tmp_Chg" APPEND
~Input : Records:30043       Control Total:0                    
~Output: Records:10          Control Total:0                    
~.18/02/2016   04:01:34 Tmp_Chg EXTRACT FIELDS ALL TO "Working_Files\VMF_BnkAcc_Chg_History" OPEN
~Input : Records:34085       Control Total:0                    
~Output: Records:34085       Control Total:0                    
~.18/02/2016   05:30:59 VMF_BnkAcc_Chg_History EXTRACT FIELDS ALL TO "Tmp_Files\Tmp_Chg"
~Input : Records:34085       Control Total:0                    
~Output: Records:34085       Control Total:0                    
~.18/02/2016   05:31:03 TMP6 EXTRACT FIELDS Vndr_Site_ID Vndr_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type Chg_Dt _RptRunDateTime AS 'RptRunDateTime' IF Vndr_Site_ID=TMP4.Vndr_Site_ID TO "Working_Files\Tmp_Chg" APPEND
~Input : Records:30043       Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   05:31:03 Tmp_Chg EXTRACT FIELDS ALL TO "Working_Files\VMF_BnkAcc_Chg_History" OPEN
~Input : Records:34085       Control Total:0                    
~Output: Records:34085       Control Total:0                    
^FORMAT   AP_Invoices                        AP_Invoices                      "Working_Files" "AP_Invoices.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~.18/02/2016   04:00:23 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:10948       Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20160217.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:30:12 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:31:10 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:31:11 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
^FORMAT   AP_Payments                        AP_Payments                      "Working_Files" "AP_Payments.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~.18/02/2016   05:31:12 DM_AP_Payments IF v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Vchr_ID' BLANKS(20) AS 'Vndr_Site_ID' BLANKS(20) AS 'Vndr_ID' BLANKS(2) AS 'Doc_Typ' CTOD('', 'DD/MM/YYYY') AS 'Pay_Dt' BLANKS(20) AS 'Pay_No' 0.00 AS 'Pay_Amt' 0.00 AS 'Pay_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Pay_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(20) AS 'Chq_No' BLANKS(20) AS 'Pymnt_Mth' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'  FIRST 0 TO "Working_Files\AP_Payments.FIL"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   AP_PO_Lines                        AP_PO_Lines                      "Working_Files" "AP_PO_Lines.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~.18/02/2016   05:31:12 DM_AP_PO_Lines IF v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Vndr_Site_ID' BLANKS(20) AS 'Vndr_ID' BLANKS(21) AS 'PO_NO' CTOD('', 'DD/MM/YYYY') AS 'PO_Date' 0.00 AS 'Amount' 0.00 AS 'Net_Price' 0.00 AS 'PO_Qty' 0.00 AS 'Rec_Qty' 0.00 AS 'Rec_Amt' CTOD('', 'DD/MM/YYYY') AS 'Rec_Dt' 0.00 AS 'GST_AMT' BLANKS(21) AS 'PO_Line_No' BLANKS(20) AS 'Item_Cd' BLANKS(60) AS 'Item_Desc' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'  FIRST 0 TO "Working_Files\AP_PO_Lines.FIL"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   AP_InvPO                           AP_InvPO                         "Working_Files" "AP_InvPO.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~.18/02/2016   05:31:12 DM_AP_InvPO IF v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Vchr_ID' BLANKS(20) AS 'PO_NO'  FIRST 0 TO "Working_Files\AP_InvPO.FIL"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   AP_Invoice_Credits                 AP_Invoice_Credits               "Working_Files" "AP_Invoice_Credits.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~.18/02/2016   04:00:23 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:10948       Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20160217.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:30:12 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:31:10 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:31:11 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   05:31:13 AP_Invoices EXTRACT FIELDS ALL IF Inv_Amt<0.00 TO "Working_Files\AP_Invoice_Credits"
~Input : Records:235098      Control Total:0                    
~Output: Records:1560        Control Total:0                    
^FORMAT   AP_VndSite_InvGst_Sum              AP_VndSite_InvGst_Sum            "Working_Files" "AP_VndSite_InvGst_Sum.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~.18/02/2016   04:00:23 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:10948       Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20160217.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:30:12 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:31:10 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:31:11 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   05:31:17 AP_Invoices SORT ON Vndr_Site_ID Vndr_ID c_Inv_Dt D TO "Working_Files\TMP1" OPEN
~Input : Records:235098      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   05:31:20 TMP1 SUMMARIZE ON Vndr_Site_ID Vndr_ID SUBTOTAL Inv_Amt GST_Amt InvAmt_Pos GSTAmt_Pos Cnt_Pos InvAmt_24M GSTAmt_24M Cnt_24M InvAmt_12M GSTAmt_12M Cnt_12M OTHER Inv_Dt c_Inv_Dt TO "Working_Files\AP_VndSite_InvGst_Sum.FIL" OPEN
~Input : Records:235098      Control Total:0                    
~Output: Records:20047       Control Total:0                    
^FORMAT   AP_Vnd_InvGst_Sum                  AP_Vnd_InvGst_Sum                "Working_Files" "AP_Vnd_InvGst_Sum.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~.18/02/2016   04:00:23 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:10948       Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20160217.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:30:12 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:31:10 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:31:11 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   05:31:17 AP_Invoices SORT ON Vndr_Site_ID Vndr_ID c_Inv_Dt D TO "Working_Files\TMP1" OPEN
~Input : Records:235098      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   05:31:20 TMP1 SUMMARIZE ON Vndr_Site_ID Vndr_ID SUBTOTAL Inv_Amt GST_Amt InvAmt_Pos GSTAmt_Pos Cnt_Pos InvAmt_24M GSTAmt_24M Cnt_24M InvAmt_12M GSTAmt_12M Cnt_12M OTHER Inv_Dt c_Inv_Dt TO "Working_Files\AP_VndSite_InvGst_Sum.FIL" OPEN
~Input : Records:235098      Control Total:0                    
~Output: Records:20047       Control Total:0                    
~.18/02/2016   05:31:20 AP_VndSite_InvGst_Sum SORT ON Vndr_ID c_Inv_Dt D TO "Working_Files\TMP2" OPEN
~Input : Records:20047       Control Total:0                    
~Output: Records:20047       Control Total:0                    
~.18/02/2016   05:31:20 TMP2 SUMMARIZE ON Vndr_ID SUBTOTAL Inv_Amt GST_Amt COUNT AS 'COUNT' InvAmt_Pos GSTAmt_Pos Cnt_Pos InvAmt_24M GSTAmt_24M Cnt_24M InvAmt_12M GSTAmt_12M Cnt_12M OTHER Inv_Dt c_Inv_Dt TO "Working_Files\AP_Vnd_InvGst_Sum.FIL"
~Input : Records:20047       Control Total:0                    
~Output: Records:19173       Control Total:0                    
^INDEX    IDX_AP_Sum_VndrID                  AP_Vnd_InvGst_Sum                "" "IDX_AP_Sum_VndrID.INX" 
*INDEX ON VNDR_ID TO IDX_AP_SUM_VNDRID
^INDEX    IDX_AP_Sum_VndrSiteID              AP_VndSite_InvGst_Sum            "" "IDX_AP_Sum_VndrSiteID.INX" 
*INDEX ON VNDR_ID TO IDX_AP_SUM_VNDRSITEID
^FORMAT   AP_PO_Vnd_Sum                      AP_PO_Vnd_Sum                    "Working_Files" "AP_PO_Vnd_Sum.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~.18/02/2016   05:31:12 DM_AP_PO_Lines IF v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Vndr_Site_ID' BLANKS(20) AS 'Vndr_ID' BLANKS(21) AS 'PO_NO' CTOD('', 'DD/MM/YYYY') AS 'PO_Date' 0.00 AS 'Amount' 0.00 AS 'Net_Price' 0.00 AS 'PO_Qty' 0.00 AS 'Rec_Qty' 0.00 AS 'Rec_Amt' CTOD('', 'DD/MM/YYYY') AS 'Rec_Dt' 0.00 AS 'GST_AMT' BLANKS(21) AS 'PO_Line_No' BLANKS(20) AS 'Item_Cd' BLANKS(60) AS 'Item_Desc' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'  FIRST 0 TO "Working_Files\AP_PO_Lines.FIL"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   05:31:20 AP_PO_Lines IF FILESIZE("Working_Files\AP_PO_Lines.fil") >= 0 SUMMARIZE ON Vndr_Site_ID Vndr_ID PO_NO SUBTOTAL Amount Rec_Amt PO_Qty Rec_Qty OTHER PO_Date Rec_Dt TO "Working_Files\AP_PO_Vnd_Sum.FIL" OPEN PRESORT
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_AP_INV_Vchr_ID                 AP_Invoices                      "" "IDX_AP_INV_Vchr_ID.INX" 
*IF FTYPE("AP_INVOICES")="Y" AND FILESIZE("WORKING_FILES\AP_INVOICES.FIL") >= 0 INDEX ON VCHR_ID TO "IDX_AP_INV_VCHR_ID"
^INDEX    IDX_AP_Pay_Vchr_ID                 AP_Payments                      "" "IDX_AP_Pay_Vchr_ID.INX" 
*IF FTYPE("AP_PAYMENTS")="Y" AND FILESIZE("WORKING_FILES\AP_PAYMENTS.FIL") >= 0 INDEX ON VCHR_ID TO "IDX_AP_PAY_VCHR_ID"
^INDEX    IDX_AP_PO_NO                       AP_PO_Lines                      "" "IDX_AP_PO_NO.INX" 
*IF FTYPE("AP_PO_LINES")="Y" AND FILESIZE("WORKING_FILES\AP_PO_LINES.FIL") >= 0 INDEX ON PO_NO TO "IDX_AP_PO_NO"
^FORMAT   GreyList_VM001                     GreyList_VM001                   "Working_Files" "GreyList_VM001.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1427252735
~.18/02/2016   05:58:59 TMP2 EXTRACT FIELDS SUBSTR(ALLTRIM(F1),1,20) AS 'Vndr_ID' SUBSTR(ALLTRIM(F2),1,60) AS 'Vndr_Name' IF NOT ISBLANK(F1) AND RECNO()>1 TO "Working_Files\GreyList_VM001.fil"
~Input : Records:1           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_GreyList_VM001_Vndr_ID         GreyList_VM001                   "" "IDX_GreyList_VM001_Vndr_ID.INX" 
*INDEX ON VNDR_ID TO IDX_GREYLIST_VM001_VNDR_ID
^INDEX    IDX_VM001_History_ID_KEY           VM001_History                    "" "IDX_VM001_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_VM001_HISTORY_ID_KEY
^FORMAT   VM001_History                      VM001_History                    "History" "VM001_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~**** SOME HISTORY DELETED ****
~.19/01/2016   05:51:25 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY DUP_KEY2 Bnk_KEY Vndr_Site_ID2 Vndr_ID2 BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name ID_KEY TO "History\VM001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.20/01/2016   05:57:55 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY DUP_KEY2 Bnk_KEY Vndr_Site_ID2 Vndr_ID2 BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name ID_KEY TO "History\VM001_History" APPEND
~Input : Records:8           Control Total:0                    
~Output: Records:8           Control Total:0                    
~.21/01/2016   05:51:22 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY DUP_KEY2 Bnk_KEY Vndr_Site_ID2 Vndr_ID2 BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name ID_KEY TO "History\VM001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.22/01/2016   05:51:16 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY DUP_KEY2 Bnk_KEY Vndr_Site_ID2 Vndr_ID2 BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name ID_KEY TO "History\VM001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.25/01/2016   05:56:58 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY DUP_KEY2 Bnk_KEY Vndr_Site_ID2 Vndr_ID2 BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name ID_KEY TO "History\VM001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.26/01/2016   05:50:39 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY DUP_KEY2 Bnk_KEY Vndr_Site_ID2 Vndr_ID2 BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name ID_KEY TO "History\VM001_History" APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.27/01/2016   05:51:15 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY DUP_KEY2 Bnk_KEY Vndr_Site_ID2 Vndr_ID2 BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name ID_KEY TO "History\VM001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.28/01/2016   05:51:27 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY DUP_KEY2 Bnk_KEY Vndr_Site_ID2 Vndr_ID2 BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name ID_KEY TO "History\VM001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.29/01/2016   05:50:31 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY DUP_KEY2 Bnk_KEY Vndr_Site_ID2 Vndr_ID2 BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name ID_KEY TO "History\VM001_History" APPEND
~Input : Records:4           Control Total:0                    
~Output: Records:4           Control Total:0                    
~.03/02/2016   11:25:53 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY DUP_KEY2 Bnk_KEY Vndr_Site_ID2 Vndr_ID2 BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name ID_KEY TO "History\VM001_History" APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.04/02/2016   05:59:54 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY DUP_KEY2 Bnk_KEY Vndr_Site_ID2 Vndr_ID2 BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name ID_KEY TO "History\VM001_History" APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.05/02/2016   05:59:09 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY DUP_KEY2 Bnk_KEY Vndr_Site_ID2 Vndr_ID2 BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name ID_KEY TO "History\VM001_History" APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.08/02/2016   05:52:36 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY DUP_KEY2 Bnk_KEY Vndr_Site_ID2 Vndr_ID2 BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name ID_KEY TO "History\VM001_History" APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.09/02/2016   05:53:14 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY DUP_KEY2 Bnk_KEY Vndr_Site_ID2 Vndr_ID2 BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name ID_KEY TO "History\VM001_History" APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.10/02/2016   05:53:07 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY DUP_KEY2 Bnk_KEY Vndr_Site_ID2 Vndr_ID2 BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name ID_KEY TO "History\VM001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.11/02/2016   05:52:34 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY DUP_KEY2 Bnk_KEY Vndr_Site_ID2 Vndr_ID2 BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name ID_KEY TO "History\VM001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/02/2016   05:53:38 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY DUP_KEY2 Bnk_KEY Vndr_Site_ID2 Vndr_ID2 BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name ID_KEY TO "History\VM001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.15/02/2016   05:52:03 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY DUP_KEY2 Bnk_KEY Vndr_Site_ID2 Vndr_ID2 BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name ID_KEY TO "History\VM001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.16/02/2016   05:53:03 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY DUP_KEY2 Bnk_KEY Vndr_Site_ID2 Vndr_ID2 BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name ID_KEY TO "History\VM001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.17/02/2016   05:58:49 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY DUP_KEY2 Bnk_KEY Vndr_Site_ID2 Vndr_ID2 BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name ID_KEY TO "History\VM001_History" APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.18/02/2016   05:59:01 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY DUP_KEY2 Bnk_KEY Vndr_Site_ID2 Vndr_ID2 BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name ID_KEY TO "History\VM001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   VM001_Dup_Vnd_BankAcc              VM001_Dup_Vnd_BankAcc            "e:\casewareapps\casewarepackage\5d6d9eb0-a8d1-4ecb-a0e2-70f6daa3546f\WorkingDirectory\Results" "VM001_Dup_Vnd_BankAcc.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~**** SOME HISTORY DELETED ****
~.18/02/2016   04:00:19 TMP_3 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\VendorBankAccount_20160217.txt",1,50) AS 'File_Name' TO  AP_VendorMasterBnkAcc_ALL_New
~Input : Records:33          Control Total:0                    
~Output: Records:33          Control Total:0                    
~.18/02/2016   04:00:19 AP_VendorMasterBnkAcc_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:33          Control Total:0                    
~Output: Records:33          Control Total:0                    
~.18/02/2016   04:00:20 AP_VendorMasterBnkAcc_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_VendorMasterBnkAcc_ALL_New.C_KEY AP_VendorMasterBnkAcc_ALL_Old.C_KEY)  APPEND OPEN
~Input : Records:33997       Control Total:0                    
~Output: Records:33974       Control Total:0                    
~.18/02/2016   04:00:20 TMP3 EXTRACT RECORD TO AP_VendorMasterBnkAcc_ALL
~Input : Records:34007       Control Total:0                    
~Output: Records:34007       Control Total:0                    
~.18/02/2016   05:30:22 AP_VendorMasterBnkAcc_ALL EXTRACT FIELDS SUBSTR(c_VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTR(_VENDOR_SITE_ID_,1,20) AS 'VENDOR_SITE_ID' SUBSTR(_VENDOR_BANK_ACCT_NAME_,1,60) AS 'VENDOR_BANK_ACCT_NAME' SUBSTR(_VENDOR_BSB_,1,20) AS 'VENDOR_BSB'   SUBSTR(_VENDOR_BANK_ACCOUNT_NUMBER_,1,30) AS 'VENDOR_BANK_ACCOUNT_NUMBER' c_ACCT_START_DATE AS 'ACCT_START_DATE'  c_ACCT_END_DATE AS 'ACCT_END_DATE' c_LAST_UPDATE_DATE AS 'LAST_UPDATE_DATE'  'R11' AS 'SourceFlag' File_Name TO "AP_VendorMasterBnkAcc_ALL_FMT.FIL" IF (c_LAST_UPDATE_DATE >= CTOD(_Data_Range_From_VM,"DD/MM/YYYY") OR c_ACCT_START_DATE >= CTOD(_Data_Range_From_VM,"DD/MM/YYYY")) AND c_ACCT_END_DATE = `19000101`
~Input : Records:34007       Control Total:0                    
~Output: Records:30247       Control Total:0                    
~.18/02/2016   05:30:52 AP_VendorMasterBnkAcc_ALL_FMT IF v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,16))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,11))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_BSB),1,12))) AS 'BSB' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_BANK_ACCOUNT_NUMBER),1,28))) AS 'Bnk_Acc_Num' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_BSB),1,12))) AS 'BSB_NAME' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_BANK_ACCT_NAME),1,48))) AS 'Bnk_Acc_Name' BLANKS(20) AS 'Bnk_Acc_Type' CTOD('', 'DD/MM/YYYY') AS 'Chg_Dt' ACCT_START_DATE AS 'Dt_Field1' ACCT_END_DATE AS 'Dt_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(SourceFlag),1,3))) AS 'Cha_Field1'  FIRST 0 TO "Working_Files\VMF_BnkAcc_Tmp.FIL"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   05:30:52 AP_VendorMasterBnkAcc_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,16))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,11))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_BSB),1,12))) AS 'BSB' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_BANK_ACCOUNT_NUMBER),1,28))) AS 'Bnk_Acc_Num' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_BSB),1,12))) AS 'BSB_NAME' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_BANK_ACCT_NAME),1,48))) AS 'Bnk_Acc_Name' BLANKS(20) AS 'Bnk_Acc_Type' CTOD('', 'DD/MM/YYYY') AS 'Chg_Dt' ACCT_START_DATE AS 'Dt_Field1' ACCT_END_DATE AS 'Dt_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(SourceFlag),1,3))) AS 'Cha_Field1'   TO "Working_Files\VMF_BnkAcc_Tmp.FIL" OPEN APPEND
~Input : Records:30247       Control Total:0                    
~Output: Records:30247       Control Total:0                    
~.18/02/2016   05:30:53 VMF_BnkAcc_Tmp SUMMARIZE ON Vndr_Site_ID Vndr_ID BSB  Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Bnk_Acc_Type Chg_Dt CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' Cha_Field1  IF NOT ISBLANK(INCLUDE(ALLTRIM(BSB)+ALLTRIM(Bnk_Acc_Num),"0123456789")) TO "Working_Files\VMF_BnkAcc.FIL"
~Input : Records:30247       Control Total:0                    
~Output: Records:30043       Control Total:0                    
~.18/02/2016   05:58:59 VMF_BnkAcc EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:30043       Control Total:0                    
~Output: Records:30043       Control Total:0                    
~.18/02/2016   05:59:00 TMP_GL EXTRACT FIELDS ALL IF Vndr_ID<> GreyList_VM001.Vndr_ID TO TMP_GL1 OPEN
~Input : Records:30043       Control Total:0                    
~Output: Records:30043       Control Total:0                    
~.18/02/2016   05:59:01 TMP_GL1 EXTRACT RECORD IF VMF_Vnd_Master_File.Vndr_Sts="A"  AND UPPER(ALLTRIM(VMF_Vnd_Master_File.Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(VMF_Vnd_Master_File.Vndr_Typ)) <> "GRANT"  TO "Tmp_Files\TMP_BnkAcc" OPEN
~Input : Records:30043       Control Total:0                    
~Output: Records:13929       Control Total:0                    
~.18/02/2016   05:59:01 TMP_BnkAcc SUMMARIZE ON Vndr_ID c_Bank OTHER Vndr_Site_ID Bnk_KEY IF LENGTH(ALLTRIM(c_Bank))>3 AND VALUE(c_Bank,0)<>0 TO "Tmp_Files\TMP1.FIL" OPEN PRESORT
~Input : Records:13929       Control Total:0                    
~Output: Records:13465       Control Total:0                    
~.18/02/2016   05:59:01 TMP1 DUPLICATES ON c_Bank OTHER Vndr_Site_ID c_Bank Bnk_KEY PRESORT OPEN TO "Tmp_Files\TMP2.FIL"
~Input : Records:13465       Control Total:0                    
~Output: Records:13465       Control Total:0                    
~.18/02/2016   05:59:01 TMP2 EXTRACT FIELDS DUP_KEY Bnk_KEY Vndr_Site_ID TMP_BnkAcc.Vndr_ID TMP_BnkAcc.BSB TMP_BnkAcc.Bnk_Acc_Num TMP_BnkAcc.BSB_NAME TMP_BnkAcc.Bnk_Acc_Name IF NOT ISBLANK(TMP_BnkAcc.Bnk_KEY) TO "Tmp_Files\TMP3" OPEN
~Input : Records:362         Control Total:0                    
~Output: Records:362         Control Total:0                    
~.18/02/2016   05:59:01 TMP3 EXTRACT FIELDS VMF_Vnd_Master_File.Vndr_Site_ID VMF_Vnd_Master_File.Co VMF_Vnd_Master_File.Vndr_ID VMF_Vnd_Master_File.Vndr_Nme VMF_Vnd_Master_File.ABN VMF_Vnd_Master_File.Vndr_Sts VMF_Vnd_Master_File.Vndr_Typ VMF_Vnd_Master_File.Vndr_Add_Typ VMF_Vnd_Master_File.ADD1 VMF_Vnd_Master_File.ADD2 VMF_Vnd_Master_File.ADD3 VMF_Vnd_Master_File.City VMF_Vnd_Master_File.State VMF_Vnd_Master_File.Pcode VMF_Vnd_Master_File.Cntry VMF_Vnd_Master_File.TEL1 VMF_Vnd_Master_File.TEL2 VMF_Vnd_Master_File.TEL3 VMF_Vnd_Master_File.FAX VMF_Vnd_Master_File.Email1 VMF_Vnd_Master_File.Email2 VMF_Vnd_Master_File.Pymnt_Trm CTOD(DATE(VMF_Vnd_Master_File.Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(VMF_Vnd_Master_File.Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(VMF_Vnd_Master_File.Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' VMF_Vnd_Master_File.Cha_Field1 VMF_Vnd_Master_File.Cha_Field2 VMF_Vnd_Master_File.Cha_Field3 VMF_Vnd_Master_File.Cha_Field4 VMF_Vnd_Master_File.Cha_Field5 VMF_Vnd_Master_File.Num_Field1 VMF_Vnd_Master_File.Num_Field2 VMF_Vnd_Master_File.Num_Field3 VMF_Vnd_Master_File.Num_Field4 VMF_Vnd_Master_File.Num_Field5 CTOD(DATE(VMF_Vnd_Master_File.Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' VMF_Vnd_Master_File.ABN_CLN VMF_Vnd_Master_File.Max_Inv_Dt VMF_Vnd_Master_File.c_Vndr_ID TMP3.DUP_KEY TMP3.DUP_KEY TMP3.Bnk_KEY Vndr_Site_ID TMP3.Vndr_ID TMP3.BSB TMP3.Bnk_Acc_Num  TMP3.BSB_NAME  TMP3.Bnk_Acc_Name IF NOT ISBLANK(TMP3.Vndr_Site_ID) AND NOT ISBLANK(VMF_Vnd_Master_File.Vndr_Site_ID) AND VMF_Vnd_Master_File.Vndr_Sts="A" TO "Tmp_Files\TMP4" OPEN
~Input : Records:362         Control Total:0                    
~Output: Records:362         Control Total:0                    
~.18/02/2016   05:59:01 TMP4 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:362         Control Total:0                    
~Output: Records:362         Control Total:0                    
~.18/02/2016   05:59:01 TMP_Cur EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY DUP_KEY2 Bnk_KEY Vndr_Site_ID2 Vndr_ID2 BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name ID_KEY IF DUP_KEY= TMP_His.DUP_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:362         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   05:59:01 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP1" IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   05:59:01 TMP1 SORT ON SORT_KEY TO "Tmp_Files\TMP6" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   05:59:01 TMP6 EXTRACT FIELDS ALL TO "Results\VM001_Dup_Vnd_BankAcc" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   GreyList_VM002                     GreyList_VM002                   "Working_Files" "GreyList_VM002.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1427252735
~.18/02/2016   05:59:04 TMP2 EXTRACT FIELDS SUBSTR(ALLTRIM(F1),1,20) AS 'Vndr_ID' SUBSTR(ALLTRIM(F2),1,60) AS 'Vndr_Name' IF NOT ISBLANK(F1) AND RECNO()>1 TO "Working_Files\GreyList_VM002.fil"
~Input : Records:1           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_GreyList_VM002_Vndr_ID         GreyList_VM002                   "" "IDX_GreyList_VM002_Vndr_ID.INX" 
*INDEX ON VNDR_ID TO IDX_GREYLIST_VM002_VNDR_ID
^INDEX    IDX_VM002_History_ID_KEY           VM002_History                    "" "IDX_VM002_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_VM002_HISTORY_ID_KEY
^FORMAT   VM002_History                      VM002_History                    "History" "VM002_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~**** SOME HISTORY DELETED ****
~.19/01/2016   05:51:30 TMP_Cur1 EXTRACT FIELDS ABN_CLN Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.20/01/2016   05:57:59 TMP_Cur1 EXTRACT FIELDS ABN_CLN Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM002_History" APPEND
~Input : Records:3           Control Total:0                    
~Output: Records:3           Control Total:0                    
~.21/01/2016   05:51:26 TMP_Cur1 EXTRACT FIELDS ABN_CLN Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.22/01/2016   05:51:20 TMP_Cur1 EXTRACT FIELDS ABN_CLN Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM002_History" APPEND
~Input : Records:10          Control Total:0                    
~Output: Records:10          Control Total:0                    
~.25/01/2016   05:57:02 TMP_Cur1 EXTRACT FIELDS ABN_CLN Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.26/01/2016   05:50:44 TMP_Cur1 EXTRACT FIELDS ABN_CLN Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.27/01/2016   05:51:20 TMP_Cur1 EXTRACT FIELDS ABN_CLN Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.28/01/2016   05:51:33 TMP_Cur1 EXTRACT FIELDS ABN_CLN Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.29/01/2016   05:50:37 TMP_Cur1 EXTRACT FIELDS ABN_CLN Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.03/02/2016   11:26:04 TMP_Cur1 EXTRACT FIELDS ABN_CLN Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.04/02/2016   06:00:06 TMP_Cur1 EXTRACT FIELDS ABN_CLN Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.05/02/2016   05:59:20 TMP_Cur1 EXTRACT FIELDS ABN_CLN Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.08/02/2016   05:52:48 TMP_Cur1 EXTRACT FIELDS ABN_CLN Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.09/02/2016   05:53:22 TMP_Cur1 EXTRACT FIELDS ABN_CLN Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.10/02/2016   05:53:15 TMP_Cur1 EXTRACT FIELDS ABN_CLN Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.11/02/2016   05:52:41 TMP_Cur1 EXTRACT FIELDS ABN_CLN Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/02/2016   05:53:44 TMP_Cur1 EXTRACT FIELDS ABN_CLN Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.15/02/2016   05:52:13 TMP_Cur1 EXTRACT FIELDS ABN_CLN Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM002_History" APPEND
~Input : Records:4           Control Total:0                    
~Output: Records:4           Control Total:0                    
~.16/02/2016   05:53:15 TMP_Cur1 EXTRACT FIELDS ABN_CLN Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.17/02/2016   05:59:01 TMP_Cur1 EXTRACT FIELDS ABN_CLN Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   05:59:09 TMP_Cur1 EXTRACT FIELDS ABN_CLN Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   VM002_Dup_Vnd_ABN                  VM002_Dup_Vnd_ABN                "Results" "VM002_Dup_Vnd_ABN.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.18/02/2016   04:00:18 TMP1 IF v_NewFlag = 1 EXTRACT FIELDS ALL SUBSTR("E:\Data\VendorMasterfile_20160217.txt",1,50) AS 'File_Name' TO  AP_VendorMaster_ALL
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   05:30:20 AP_VendorMaster_ALL EXTRACT FIELDS ALL 'R11' AS 'SourceFlag' TO "AP_VendorMaster_ALL_FMT.FIL"  IF c_SITE_LAST_UPDATE_DATE>=CTOD(_Data_Range_From_VM,"DD/MM/YYYY") OR c_HEADER_LAST_UPDATE_DATE>=CTOD(_Data_Range_From_VM,"DD/MM/YYYY")
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   05:30:51 AP_VendorMaster_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Co' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NAME),1,73))) AS 'Vndr_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ABN),1,20))) AS 'ABN' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_STATUS),1,1))) AS 'Vndr_Sts' CTOD('', 'DD/MM/YYYY') AS 'Vndr_InvlDt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_TYPE),1,11))) AS 'Vndr_Typ' BLANKS(15) AS 'Vndr_Add_Typ' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ADDRESS),1,125))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(CITY),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(STATE),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(POSTCODE),1,12))) AS 'Pcode' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(COUNTRY),1,61))) AS 'Cntry' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Tel),1,21))) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Fax),1,21))) AS 'FAX' BLANKS(60) AS 'Email1' BLANKS(60) AS 'Email2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_METHOD),1,21))) AS 'Pymnt_Trm' c_SITE_CREATION_DATE AS 'Created_Dt' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE),1,30))) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_REGISTRATION_STATUS),1,30))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(SourceFlag),1,3))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NUMBER),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' c_SITE_INACTIVE_DATE AS 'Dt_Field1' c_SITE_CREATION_DATE AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3'   TO "Working_Files\VMF_Vnd_Master_File.FIL"
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   05:59:04 VMF_Vnd_Master_File EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   05:59:06 TMP_GL EXTRACT FIELDS ALL IF Vndr_ID<> GreyList_VM002.Vndr_ID TO TMP_GL1 OPEN
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   05:59:08 TMP_GL1 SUMMARIZE ON ABN_CLN Vndr_ID OTHER Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm CTOD(DATE(Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' ABN_CLN Max_Inv_Dt c_Vndr_ID IF Vndr_Sts="A" AND LENGTH(ALLTRIM(ABN_CLN))>1 AND  UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT" TO "Tmp_Files\TMP10.FIL" OPEN PRESORT
~Input : Records:66074       Control Total:0                    
~Output: Records:11211       Control Total:0                    
~.18/02/2016   05:59:08 TMP10 DUPLICATES ON ABN_CLN OTHER Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm CTOD(DATE(Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' ABN_CLN Max_Inv_Dt c_Vndr_ID PRESORT OPEN TO "Tmp_Files\TMP1.FIL"
~Input : Records:11211       Control Total:0                    
~Output: Records:11211       Control Total:0                    
~.18/02/2016   05:59:08 TMP1 EXTRACT FIELDS ALL IF NOT ISBLANK(TMP3.DUP_KEY) TO "Tmp_Files\TMP4" OPEN
~Input : Records:310         Control Total:0                    
~Output: Records:225         Control Total:0                    
~.18/02/2016   05:59:08 TMP4 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:225         Control Total:0                    
~Output: Records:225         Control Total:0                    
~.18/02/2016   05:59:09 TMP_Cur EXTRACT FIELDS ABN_CLN Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY IF DUP_KEY= TMP_His.DUP_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:225         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   05:59:09 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP1" IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   05:59:09 TMP1 SORT ON SORT_KEY TO "Tmp_Files\TMP6" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   05:59:09 TMP6 EXTRACT FIELDS ALL TO "Results\VM002_Dup_Vnd_ABN" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   GreyList_VM003                     GreyList_VM003                   "Working_Files" "GreyList_VM003.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1427252735
~.18/02/2016   05:59:10 TMP2 EXTRACT FIELDS SUBSTR(ALLTRIM(F1),1,20) AS 'Vndr_ID' SUBSTR(ALLTRIM(F2),1,60) AS 'Vndr_Name' IF NOT ISBLANK(F1) AND RECNO()>1 TO "Working_Files\GreyList_VM003.fil"
~Input : Records:1           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_GreyList_VM003_Vndr_ID         GreyList_VM003                   "" "IDX_GreyList_VM003_Vndr_ID.INX" 
*INDEX ON VNDR_ID TO IDX_GREYLIST_VM003_VNDR_ID
^INDEX    IDX_VM003_History_ID_KEY           VM003_History                    "" "IDX_VM003_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_VM003_HISTORY_ID_KEY
^FORMAT   VM003_History                      VM003_History                    "History" "VM003_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~**** SOME HISTORY DELETED ****
~.19/01/2016   05:51:38 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY Add_KEY Dup_Vndr_Add_Typ Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry ID_KEY TO "History\VM003_History" APPEND
~Input : Records:4           Control Total:0                    
~Output: Records:4           Control Total:0                    
~.20/01/2016   05:58:07 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY Add_KEY Dup_Vndr_Add_Typ Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry ID_KEY TO "History\VM003_History" APPEND
~Input : Records:6           Control Total:0                    
~Output: Records:6           Control Total:0                    
~.21/01/2016   05:51:35 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY Add_KEY Dup_Vndr_Add_Typ Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry ID_KEY TO "History\VM003_History" APPEND
~Input : Records:4           Control Total:0                    
~Output: Records:4           Control Total:0                    
~.22/01/2016   05:51:29 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY Add_KEY Dup_Vndr_Add_Typ Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry ID_KEY TO "History\VM003_History" APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.25/01/2016   05:57:11 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY Add_KEY Dup_Vndr_Add_Typ Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry ID_KEY TO "History\VM003_History" APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.26/01/2016   05:50:53 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY Add_KEY Dup_Vndr_Add_Typ Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry ID_KEY TO "History\VM003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.27/01/2016   05:51:29 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY Add_KEY Dup_Vndr_Add_Typ Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry ID_KEY TO "History\VM003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.28/01/2016   05:51:42 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY Add_KEY Dup_Vndr_Add_Typ Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry ID_KEY TO "History\VM003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.29/01/2016   05:50:46 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY Add_KEY Dup_Vndr_Add_Typ Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry ID_KEY TO "History\VM003_History" APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.03/02/2016   11:26:23 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY Add_KEY Dup_Vndr_Add_Typ Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry ID_KEY TO "History\VM003_History" APPEND
~Input : Records:13          Control Total:0                    
~Output: Records:13          Control Total:0                    
~.04/02/2016   06:00:23 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY Add_KEY Dup_Vndr_Add_Typ Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry ID_KEY TO "History\VM003_History" APPEND
~Input : Records:10          Control Total:0                    
~Output: Records:10          Control Total:0                    
~.05/02/2016   05:59:39 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY Add_KEY Dup_Vndr_Add_Typ Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry ID_KEY TO "History\VM003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.08/02/2016   05:53:09 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY Add_KEY Dup_Vndr_Add_Typ Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry ID_KEY TO "History\VM003_History" APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.09/02/2016   05:53:35 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY Add_KEY Dup_Vndr_Add_Typ Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry ID_KEY TO "History\VM003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.10/02/2016   05:53:29 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY Add_KEY Dup_Vndr_Add_Typ Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry ID_KEY TO "History\VM003_History" APPEND
~Input : Records:8           Control Total:0                    
~Output: Records:8           Control Total:0                    
~.11/02/2016   05:52:54 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY Add_KEY Dup_Vndr_Add_Typ Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry ID_KEY TO "History\VM003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/02/2016   05:53:59 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY Add_KEY Dup_Vndr_Add_Typ Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry ID_KEY TO "History\VM003_History" APPEND
~Input : Records:4           Control Total:0                    
~Output: Records:4           Control Total:0                    
~.15/02/2016   05:52:32 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY Add_KEY Dup_Vndr_Add_Typ Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry ID_KEY TO "History\VM003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.16/02/2016   05:53:34 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY Add_KEY Dup_Vndr_Add_Typ Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry ID_KEY TO "History\VM003_History" APPEND
~Input : Records:3           Control Total:0                    
~Output: Records:3           Control Total:0                    
~.17/02/2016   05:59:22 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY Add_KEY Dup_Vndr_Add_Typ Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry ID_KEY TO "History\VM003_History" APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.18/02/2016   05:59:28 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY Add_KEY Dup_Vndr_Add_Typ Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry ID_KEY TO "History\VM003_History" APPEND
~Input : Records:10          Control Total:0                    
~Output: Records:10          Control Total:0                    
^FORMAT   VM003_Dup_Vnd_Add                  VM003_Dup_Vnd_Add                "Results" "VM003_Dup_Vnd_Add.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~**** SOME HISTORY DELETED ****
~.18/02/2016   05:30:51 AP_VendorMaster_ALL_FMT IF v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_ID),1,20))) AS 'Vndr_ID' BLANKS(15) AS 'Vndr_Add_Typ' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ADDRESS),1,125))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(CITY),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(STATE),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(POSTCODE),1,12))) AS 'Pcode' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(COUNTRY),1,61))) AS 'Cntry'  FIRST 0 TO "Working_Files\VMF_Address.FIL"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   05:30:52 AP_VendorMaster_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_ID),1,20))) AS 'Vndr_ID' BLANKS(15) AS 'Vndr_Add_Typ' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ADDRESS),1,125))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(CITY),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(STATE),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(POSTCODE),1,12))) AS 'Pcode' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(COUNTRY),1,61))) AS 'Cntry'   TO "Working_Files\VMF_Address.FIL" APPEND
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   05:59:10 VMF_Address EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   05:59:11 TMP_GL EXTRACT FIELDS ALL IF Vndr_ID<> GreyList_VM003.Vndr_ID TO TMP_GL1 OPEN
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   05:59:13 TMP_GL1 EXTRACT FIELDS ALL IF VMF_Vnd_Master_File.Vndr_Sts="A" AND UPPER(ALLTRIM(VMF_Vnd_Master_File.Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(VMF_Vnd_Master_File.Vndr_Typ)) <> "GRANT"  TO "Tmp_Files\TMP_Address" OPEN
~Input : Records:66074       Control Total:0                    
~Output: Records:18085       Control Total:0                    
~.18/02/2016   05:59:16 TMP_Address EXTRACT FIELDS Add_ID Vndr_Site_ID Vndr_ID c_Pcode SUBSTR(INCLUDE(c_Add1, "0123456789"),1,50) AS "Address" "PO" AS "Type" IF  c_Add1F="PO" TO "Tmp_Files\TMP1" OPEN
~Input : Records:18085       Control Total:0                    
~Output: Records:5069        Control Total:0                    
~.18/02/2016   05:59:18 TMP_Address EXTRACT FIELDS Add_ID Vndr_Site_ID Vndr_ID c_Pcode SUBSTR(INCLUDE(c_Add2, "0123456789"),1,50) AS "Address" "PO" AS "Type" IF c_Add2F="PO" TO "Tmp_Files\TMP1" OPEN APPEND
~Input : Records:18085       Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   05:59:20 TMP_Address EXTRACT FIELDS Add_ID Vndr_Site_ID Vndr_ID c_Pcode SUBSTR(INCLUDE(c_Add3, "0123456789"),1,50) AS "Address" "PO" AS "Type" IF c_Add3F="PO" TO "Tmp_Files\TMP1" OPEN APPEND
~Input : Records:18085       Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   05:59:26 TMP_Address EXTRACT FIELDS Add_ID Vndr_Site_ID Vndr_ID c_Pcode SUBSTR(INCLUDE(c_Add1 +c_Add2+c_Add3,"QWERTYUIOPASDFGHJKLZXCVBNM0123456789"),1,50) AS "Address" "ST" AS "Type" IF c_Add1F<>"PO" AND c_Add2F<>"PO" AND c_Add3F<>"PO" TO "Tmp_Files\TMP1" OPEN APPEND
~Input : Records:18085       Control Total:0                    
~Output: Records:13016       Control Total:0                    
~.18/02/2016   05:59:26 TMP1 SUMMARIZE ON Add_KEY Vndr_ID c_Pcode Address Type OTHER Vndr_Site_ID IF LENGTH(ALLTRIM(Address))>0 TO "Tmp_Files\SUM_Address.FIL" OPEN PRESORT
~Input : Records:18085       Control Total:0                    
~Output: Records:18078       Control Total:0                    
~.18/02/2016   05:59:26 SUM_Address DUPLICATES ON Address c_Pcode OTHER Type Vndr_Site_ID Vndr_ID Address c_Pcode PRESORT IF Type = "PO" AND ALLTRIM(Address)<>"" OPEN TO "Tmp_Files\TMP2.FIL"
~Input : Records:18078       Control Total:0                    
~Output: Records:5066        Control Total:0                    
~.18/02/2016   05:59:26 SUM_Address DUPLICATES ON Address c_Pcode OTHER Type Vndr_Site_ID Vndr_ID Address c_Pcode PRESORT IF Type <> "PO" AND ALLTRIM(Address)<>"" APPEND OPEN TO "Tmp_Files\TMP2.FIL"
~Input : Records:18078       Control Total:0                    
~Output: Records:13012       Control Total:0                    
~.18/02/2016   05:59:27 TMP2 EXTRACT FIELDS DUP_KEY Add_KEY Vndr_Site_ID Vndr_ID TMP1.Add_ID IF NOT ISBLANK(TMP1.Add_KEY) TO "Tmp_Files\TMP3" OPEN
~Input : Records:2217        Control Total:0                    
~Output: Records:2217        Control Total:0                    
~.18/02/2016   05:59:27 TMP3 EXTRACT FIELDS DUP_KEY Add_KEY Vndr_Site_ID Vndr_ID TMP_Address.Vndr_Add_Typ TMP_Address.ADD1 TMP_Address.ADD2 TMP_Address.ADD3 TMP_Address.City TMP_Address.State TMP_Address.Pcode TMP_Address.Cntry TO "Tmp_Files\TMP7" OPEN
~Input : Records:2217        Control Total:0                    
~Output: Records:2217        Control Total:0                    
~.18/02/2016   05:59:27 TMP7 EXTRACT FIELDS ALL IF NOT ISBLANK(TMP8.DUP_KEY) TO "Tmp_Files\TMP9" OPEN
~Input : Records:2217        Control Total:0                    
~Output: Records:1906        Control Total:0                    
~.18/02/2016   05:59:27 TMP9 EXTRACT FIELDS VMF_Vnd_Master_File.Vndr_Site_ID VMF_Vnd_Master_File.Co VMF_Vnd_Master_File.Vndr_ID VMF_Vnd_Master_File.Vndr_Nme VMF_Vnd_Master_File.ABN VMF_Vnd_Master_File.Vndr_Sts VMF_Vnd_Master_File.Vndr_Typ VMF_Vnd_Master_File.Vndr_Add_Typ VMF_Vnd_Master_File.ADD1 VMF_Vnd_Master_File.ADD2 VMF_Vnd_Master_File.ADD3 VMF_Vnd_Master_File.City VMF_Vnd_Master_File.State VMF_Vnd_Master_File.Pcode VMF_Vnd_Master_File.Cntry VMF_Vnd_Master_File.TEL1 VMF_Vnd_Master_File.TEL2 VMF_Vnd_Master_File.TEL3 VMF_Vnd_Master_File.FAX VMF_Vnd_Master_File.Email1 VMF_Vnd_Master_File.Email2 VMF_Vnd_Master_File.Pymnt_Trm CTOD(DATE(VMF_Vnd_Master_File.Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(VMF_Vnd_Master_File.Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(VMF_Vnd_Master_File.Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' VMF_Vnd_Master_File.Cha_Field1 VMF_Vnd_Master_File.Cha_Field2 VMF_Vnd_Master_File.Cha_Field3 VMF_Vnd_Master_File.Cha_Field4 VMF_Vnd_Master_File.Cha_Field5 VMF_Vnd_Master_File.Num_Field1 VMF_Vnd_Master_File.Num_Field2 VMF_Vnd_Master_File.Num_Field3 VMF_Vnd_Master_File.Num_Field4 VMF_Vnd_Master_File.Num_Field5 CTOD(DATE(VMF_Vnd_Master_File.Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' VMF_Vnd_Master_File.ABN_CLN VMF_Vnd_Master_File.Max_Inv_Dt VMF_Vnd_Master_File.c_Vndr_ID TMP9.DUP_KEY TMP9.Add_KEY TMP9.Vndr_Add_Typ AS 'Dup_Vndr_Add_Typ' TMP9.ADD1 AS 'Dup_ADD1' TMP9.ADD2 AS 'Dup_ADD2' TMP9.ADD3 AS 'Dup_ADD3' TMP9.City AS 'Dup_City' TMP9.State AS 'Dup_State' TMP9.Pcode AS 'Dup_Pcode' TMP9.Cntry AS 'Dup_Cntry' IF NOT ISBLANK(TMP9.Vndr_Site_ID) AND NOT ISBLANK(VMF_Vnd_Master_File.Vndr_Site_ID) TO "Tmp_Files\TMP4" OPEN
~Input : Records:1906        Control Total:0                    
~Output: Records:1906        Control Total:0                    
~.18/02/2016   05:59:27 TMP4 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:1906        Control Total:0                    
~Output: Records:1906        Control Total:0                    
~.18/02/2016   05:59:28 TMP_Cur EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY Add_KEY Dup_Vndr_Add_Typ Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry ID_KEY IF DUP_KEY= TMP_His.DUP_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:1906        Control Total:0                    
~Output: Records:10          Control Total:0                    
~.18/02/2016   05:59:29 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP1" OPEN
~Input : Records:10          Control Total:0                    
~Output: Records:10          Control Total:0                    
~.18/02/2016   05:59:29 TMP1 SORT ON SORT_KEY TO "Tmp_Files\TMP6" OPEN
~Input : Records:10          Control Total:0                    
~Output: Records:10          Control Total:0                    
~.18/02/2016   05:59:29 TMP6 EXTRACT FIELDS ALL TO "Results\VM003_Dup_Vnd_Add"  IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN
~Input : Records:10          Control Total:0                    
~Output: Records:10          Control Total:0                    
^FORMAT   GreyList_VM005                     GreyList_VM005                   "Working_Files" "GreyList_VM005.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1427252735
~.18/02/2016   05:59:37 TMP2 EXTRACT FIELDS SUBSTR(ALLTRIM(F1),1,20) AS 'Vndr_ID' SUBSTR(ALLTRIM(F2),1,60) AS 'Vndr_Name' IF NOT ISBLANK(F1) AND RECNO()>1 TO "Working_Files\GreyList_VM005.fil"
~Input : Records:1           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_GreyList_VM005_Vndr_ID         GreyList_VM005                   "" "IDX_GreyList_VM005_Vndr_ID.INX" 
*INDEX ON VNDR_ID TO IDX_GREYLIST_VM005_VNDR_ID
^INDEX    IDX_VM005_History_ID_KEY           VM005_History                    "" "IDX_VM005_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_VM005_HISTORY_ID_KEY
^FORMAT   VM005_History                      VM005_History                    "History" "VM005_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~**** SOME HISTORY DELETED ****
~.19/01/2016   05:51:43 TMP_Cur1 EXTRACT FIELDS c_Name Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.20/01/2016   05:58:12 TMP_Cur1 EXTRACT FIELDS c_Name Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.21/01/2016   05:51:39 TMP_Cur1 EXTRACT FIELDS c_Name Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.22/01/2016   05:51:34 TMP_Cur1 EXTRACT FIELDS c_Name Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.25/01/2016   05:57:15 TMP_Cur1 EXTRACT FIELDS c_Name Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.26/01/2016   05:50:59 TMP_Cur1 EXTRACT FIELDS c_Name Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.27/01/2016   05:51:35 TMP_Cur1 EXTRACT FIELDS c_Name Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.28/01/2016   05:51:48 TMP_Cur1 EXTRACT FIELDS c_Name Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.29/01/2016   05:50:52 TMP_Cur1 EXTRACT FIELDS c_Name Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.03/02/2016   11:26:37 TMP_Cur1 EXTRACT FIELDS c_Name Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.04/02/2016   06:00:39 TMP_Cur1 EXTRACT FIELDS c_Name Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.05/02/2016   05:59:50 TMP_Cur1 EXTRACT FIELDS c_Name Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.08/02/2016   05:53:25 TMP_Cur1 EXTRACT FIELDS c_Name Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.09/02/2016   05:53:46 TMP_Cur1 EXTRACT FIELDS c_Name Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.10/02/2016   05:53:38 TMP_Cur1 EXTRACT FIELDS c_Name Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.11/02/2016   05:53:05 TMP_Cur1 EXTRACT FIELDS c_Name Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/02/2016   05:54:14 TMP_Cur1 EXTRACT FIELDS c_Name Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.15/02/2016   05:52:44 TMP_Cur1 EXTRACT FIELDS c_Name Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.16/02/2016   05:53:49 TMP_Cur1 EXTRACT FIELDS c_Name Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.17/02/2016   05:59:35 TMP_Cur1 EXTRACT FIELDS c_Name Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   05:59:46 TMP_Cur1 EXTRACT FIELDS c_Name Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY TO "History\VM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   VM005_Dup_Vnd_Name                 VM005_Dup_Vnd_Name               "Results" "VM005_Dup_Vnd_Name.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.18/02/2016   04:00:18 TMP1 IF v_NewFlag = 1 EXTRACT FIELDS ALL SUBSTR("E:\Data\VendorMasterfile_20160217.txt",1,50) AS 'File_Name' TO  AP_VendorMaster_ALL
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   05:30:20 AP_VendorMaster_ALL EXTRACT FIELDS ALL 'R11' AS 'SourceFlag' TO "AP_VendorMaster_ALL_FMT.FIL"  IF c_SITE_LAST_UPDATE_DATE>=CTOD(_Data_Range_From_VM,"DD/MM/YYYY") OR c_HEADER_LAST_UPDATE_DATE>=CTOD(_Data_Range_From_VM,"DD/MM/YYYY")
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   05:30:51 AP_VendorMaster_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Co' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NAME),1,73))) AS 'Vndr_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ABN),1,20))) AS 'ABN' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_STATUS),1,1))) AS 'Vndr_Sts' CTOD('', 'DD/MM/YYYY') AS 'Vndr_InvlDt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_TYPE),1,11))) AS 'Vndr_Typ' BLANKS(15) AS 'Vndr_Add_Typ' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ADDRESS),1,125))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(CITY),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(STATE),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(POSTCODE),1,12))) AS 'Pcode' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(COUNTRY),1,61))) AS 'Cntry' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Tel),1,21))) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Fax),1,21))) AS 'FAX' BLANKS(60) AS 'Email1' BLANKS(60) AS 'Email2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_METHOD),1,21))) AS 'Pymnt_Trm' c_SITE_CREATION_DATE AS 'Created_Dt' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE),1,30))) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_REGISTRATION_STATUS),1,30))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(SourceFlag),1,3))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NUMBER),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' c_SITE_INACTIVE_DATE AS 'Dt_Field1' c_SITE_CREATION_DATE AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3'   TO "Working_Files\VMF_Vnd_Master_File.FIL"
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   05:59:36 VMF_Vnd_Master_File EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   05:59:41 TMP_GL EXTRACT FIELDS ALL IF Vndr_ID<> GreyList_VM005.Vndr_ID TO TMP_GL1 OPEN
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   05:59:44 TMP_GL1 SUMMARIZE ON Vndr_ID c_Name OTHER Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm CTOD(DATE(Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' ABN_CLN Max_Inv_Dt c_Vndr_ID IF Vndr_Sts="A" AND c_Name<>" " TO "Tmp_Files\TMP2.FIL" OPEN PRESORT
~Input : Records:66074       Control Total:0                    
~Output: Records:20288       Control Total:0                    
~.18/02/2016   05:59:44 TMP2 DUPLICATES ON c_Name OTHER Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm CTOD(DATE(Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' ABN_CLN Max_Inv_Dt c_Vndr_ID PRESORT OPEN TO "Tmp_Files\TMP1.FIL"
~Input : Records:20288       Control Total:0                    
~Output: Records:20288       Control Total:0                    
~.18/02/2016   05:59:46 TMP1 EXTRACT FIELDS ALL IF DUP_KEY=TMP2.DUP_KEY TO "Tmp_Files\TMP4" OPEN
~Input : Records:100         Control Total:0                    
~Output: Records:34          Control Total:0                    
~.18/02/2016   05:59:46 TMP4 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:34          Control Total:0                    
~Output: Records:34          Control Total:0                    
~.18/02/2016   05:59:46 TMP_Cur EXTRACT FIELDS c_Name Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID DUP_KEY ID_KEY IF DUP_KEY= TMP_His.DUP_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:34          Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   05:59:46 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP1" IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   05:59:47 TMP1 SORT ON SORT_KEY TO "Tmp_Files\TMP6" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   05:59:47 TMP6 EXTRACT FIELDS ALL TO "Results\VM005_Dup_Vnd_Name" IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   GreyList_VM006                     GreyList_VM006                   "Working_Files" "GreyList_VM006.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1427252735
~.18/02/2016   05:59:54 TMP2 EXTRACT FIELDS SUBSTR(ALLTRIM(F1),1,20) AS 'Vndr_ID' SUBSTR(ALLTRIM(F2),1,60) AS 'Vndr_Name' IF NOT ISBLANK(F1) AND RECNO()>1 TO "Working_Files\GreyList_VM006.fil"
~Input : Records:1           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_GreyList_VM006_Vndr_ID         GreyList_VM006                   "" "IDX_GreyList_VM006_Vndr_ID.INX" 
*INDEX ON VNDR_ID TO IDX_GREYLIST_VM006_VNDR_ID
^INDEX    IDX_VM006_History_ID_KEY           VM006_History                    "" "IDX_VM006_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_VM006_HISTORY_ID_KEY
^FORMAT   VM006_History                      VM006_History                    "History" "VM006_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~**** SOME HISTORY DELETED ****
~.19/01/2016   05:51:47 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Vndr_ID TstCd COUNT2 Co Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT c_TstCd NEW_TstCd_1 NEW_TstCd_2 NEW_TstCd_3 NEW_TstCd_4 NEW_TstCd1 NEW_TstCd2 NEW_TstCd TEST_NAME SORT_KEY SORT_KEY_Desc RptRunDate Priority ID_KEY TO "History\VM006_History"APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.20/01/2016   05:58:16 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Vndr_ID TstCd COUNT2 Co Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT c_TstCd NEW_TstCd_1 NEW_TstCd_2 NEW_TstCd_3 NEW_TstCd_4 NEW_TstCd1 NEW_TstCd2 NEW_TstCd TEST_NAME SORT_KEY SORT_KEY_Desc RptRunDate Priority ID_KEY TO "History\VM006_History"APPEND
~Input : Records:7           Control Total:0                    
~Output: Records:7           Control Total:0                    
~.21/01/2016   05:51:43 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Vndr_ID TstCd COUNT2 Co Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT c_TstCd NEW_TstCd_1 NEW_TstCd_2 NEW_TstCd_3 NEW_TstCd_4 NEW_TstCd1 NEW_TstCd2 NEW_TstCd TEST_NAME SORT_KEY SORT_KEY_Desc RptRunDate Priority ID_KEY TO "History\VM006_History"APPEND
~Input : Records:1           Control Total:0                    
~Output: Records:1           Control Total:0                    
~.22/01/2016   05:51:38 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Vndr_ID TstCd COUNT2 Co Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT c_TstCd NEW_TstCd_1 NEW_TstCd_2 NEW_TstCd_3 NEW_TstCd_4 NEW_TstCd1 NEW_TstCd2 NEW_TstCd TEST_NAME SORT_KEY SORT_KEY_Desc RptRunDate Priority ID_KEY TO "History\VM006_History"APPEND
~Input : Records:3           Control Total:0                    
~Output: Records:3           Control Total:0                    
~.25/01/2016   05:57:19 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Vndr_ID TstCd COUNT2 Co Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT c_TstCd NEW_TstCd_1 NEW_TstCd_2 NEW_TstCd_3 NEW_TstCd_4 NEW_TstCd1 NEW_TstCd2 NEW_TstCd TEST_NAME SORT_KEY SORT_KEY_Desc RptRunDate Priority ID_KEY TO "History\VM006_History"APPEND
~Input : Records:3           Control Total:0                    
~Output: Records:3           Control Total:0                    
~.26/01/2016   05:51:04 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Vndr_ID TstCd COUNT2 Co Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT c_TstCd NEW_TstCd_1 NEW_TstCd_2 NEW_TstCd_3 NEW_TstCd_4 NEW_TstCd1 NEW_TstCd2 NEW_TstCd TEST_NAME SORT_KEY SORT_KEY_Desc RptRunDate Priority ID_KEY TO "History\VM006_History"APPEND
~Input : Records:7           Control Total:0                    
~Output: Records:7           Control Total:0                    
~.27/01/2016   05:51:40 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Vndr_ID TstCd COUNT2 Co Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT c_TstCd NEW_TstCd_1 NEW_TstCd_2 NEW_TstCd_3 NEW_TstCd_4 NEW_TstCd1 NEW_TstCd2 NEW_TstCd TEST_NAME SORT_KEY SORT_KEY_Desc RptRunDate Priority ID_KEY TO "History\VM006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.28/01/2016   05:51:52 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Vndr_ID TstCd COUNT2 Co Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT c_TstCd NEW_TstCd_1 NEW_TstCd_2 NEW_TstCd_3 NEW_TstCd_4 NEW_TstCd1 NEW_TstCd2 NEW_TstCd TEST_NAME SORT_KEY SORT_KEY_Desc RptRunDate Priority ID_KEY TO "History\VM006_History"APPEND
~Input : Records:9           Control Total:0                    
~Output: Records:9           Control Total:0                    
~.29/01/2016   05:50:57 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Vndr_ID TstCd COUNT2 Co Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT c_TstCd NEW_TstCd_1 NEW_TstCd_2 NEW_TstCd_3 NEW_TstCd_4 NEW_TstCd1 NEW_TstCd2 NEW_TstCd TEST_NAME SORT_KEY SORT_KEY_Desc RptRunDate Priority ID_KEY TO "History\VM006_History"APPEND
~Input : Records:4           Control Total:0                    
~Output: Records:4           Control Total:0                    
~.03/02/2016   11:26:46 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Vndr_ID TstCd COUNT2 Co Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT c_TstCd NEW_TstCd_1 NEW_TstCd_2 NEW_TstCd_3 NEW_TstCd_4 NEW_TstCd1 NEW_TstCd2 NEW_TstCd TEST_NAME SORT_KEY SORT_KEY_Desc RptRunDate Priority ID_KEY TO "History\VM006_History"APPEND
~Input : Records:10          Control Total:0                    
~Output: Records:10          Control Total:0                    
~.04/02/2016   06:00:50 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Vndr_ID TstCd COUNT2 Co Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT c_TstCd NEW_TstCd_1 NEW_TstCd_2 NEW_TstCd_3 NEW_TstCd_4 NEW_TstCd1 NEW_TstCd2 NEW_TstCd TEST_NAME SORT_KEY SORT_KEY_Desc RptRunDate Priority ID_KEY TO "History\VM006_History"APPEND
~Input : Records:7           Control Total:0                    
~Output: Records:7           Control Total:0                    
~.05/02/2016   06:00:01 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Vndr_ID TstCd COUNT2 Co Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT c_TstCd NEW_TstCd_1 NEW_TstCd_2 NEW_TstCd_3 NEW_TstCd_4 NEW_TstCd1 NEW_TstCd2 NEW_TstCd TEST_NAME SORT_KEY SORT_KEY_Desc RptRunDate Priority ID_KEY TO "History\VM006_History"APPEND
~Input : Records:3           Control Total:0                    
~Output: Records:3           Control Total:0                    
~.08/02/2016   05:53:35 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Vndr_ID TstCd COUNT2 Co Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT c_TstCd NEW_TstCd_1 NEW_TstCd_2 NEW_TstCd_3 NEW_TstCd_4 NEW_TstCd1 NEW_TstCd2 NEW_TstCd TEST_NAME SORT_KEY SORT_KEY_Desc RptRunDate Priority ID_KEY TO "History\VM006_History"APPEND
~Input : Records:4           Control Total:0                    
~Output: Records:4           Control Total:0                    
~.09/02/2016   05:53:52 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Vndr_ID TstCd COUNT2 Co Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT c_TstCd NEW_TstCd_1 NEW_TstCd_2 NEW_TstCd_3 NEW_TstCd_4 NEW_TstCd1 NEW_TstCd2 NEW_TstCd TEST_NAME SORT_KEY SORT_KEY_Desc RptRunDate Priority ID_KEY TO "History\VM006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.10/02/2016   05:53:45 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Vndr_ID TstCd COUNT2 Co Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT c_TstCd NEW_TstCd_1 NEW_TstCd_2 NEW_TstCd_3 NEW_TstCd_4 NEW_TstCd1 NEW_TstCd2 NEW_TstCd TEST_NAME SORT_KEY SORT_KEY_Desc RptRunDate Priority ID_KEY TO "History\VM006_History"APPEND
~Input : Records:3           Control Total:0                    
~Output: Records:3           Control Total:0                    
~.11/02/2016   05:53:12 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Vndr_ID TstCd COUNT2 Co Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT c_TstCd NEW_TstCd_1 NEW_TstCd_2 NEW_TstCd_3 NEW_TstCd_4 NEW_TstCd1 NEW_TstCd2 NEW_TstCd TEST_NAME SORT_KEY SORT_KEY_Desc RptRunDate Priority ID_KEY TO "History\VM006_History"APPEND
~Input : Records:1           Control Total:0                    
~Output: Records:1           Control Total:0                    
~.12/02/2016   05:54:21 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Vndr_ID TstCd COUNT2 Co Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT c_TstCd NEW_TstCd_1 NEW_TstCd_2 NEW_TstCd_3 NEW_TstCd_4 NEW_TstCd1 NEW_TstCd2 NEW_TstCd TEST_NAME SORT_KEY SORT_KEY_Desc RptRunDate Priority ID_KEY TO "History\VM006_History"APPEND
~Input : Records:3           Control Total:0                    
~Output: Records:3           Control Total:0                    
~.15/02/2016   05:52:54 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Vndr_ID TstCd COUNT2 Co Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT c_TstCd NEW_TstCd_1 NEW_TstCd_2 NEW_TstCd_3 NEW_TstCd_4 NEW_TstCd1 NEW_TstCd2 NEW_TstCd TEST_NAME SORT_KEY SORT_KEY_Desc RptRunDate Priority ID_KEY TO "History\VM006_History"APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.16/02/2016   05:53:59 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Vndr_ID TstCd COUNT2 Co Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT c_TstCd NEW_TstCd_1 NEW_TstCd_2 NEW_TstCd_3 NEW_TstCd_4 NEW_TstCd1 NEW_TstCd2 NEW_TstCd TEST_NAME SORT_KEY SORT_KEY_Desc RptRunDate Priority ID_KEY TO "History\VM006_History"APPEND
~Input : Records:4           Control Total:0                    
~Output: Records:4           Control Total:0                    
~.17/02/2016   05:59:47 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Vndr_ID TstCd COUNT2 Co Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT c_TstCd NEW_TstCd_1 NEW_TstCd_2 NEW_TstCd_3 NEW_TstCd_4 NEW_TstCd1 NEW_TstCd2 NEW_TstCd TEST_NAME SORT_KEY SORT_KEY_Desc RptRunDate Priority ID_KEY TO "History\VM006_History"APPEND
~Input : Records:4           Control Total:0                    
~Output: Records:4           Control Total:0                    
~.18/02/2016   05:59:55 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Vndr_ID TstCd COUNT2 Co Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT c_TstCd NEW_TstCd_1 NEW_TstCd_2 NEW_TstCd_3 NEW_TstCd_4 NEW_TstCd1 NEW_TstCd2 NEW_TstCd TEST_NAME SORT_KEY SORT_KEY_Desc RptRunDate Priority ID_KEY TO "History\VM006_History"APPEND
~Input : Records:6           Control Total:0                    
~Output: Records:6           Control Total:0                    
^FORMAT   VM006_Mis_Details                  VM006_Mis_Details                "Results" "VM006_Mis_Details.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.18/02/2016   04:00:18 TMP1 IF v_NewFlag = 1 EXTRACT FIELDS ALL SUBSTR("E:\Data\VendorMasterfile_20160217.txt",1,50) AS 'File_Name' TO  AP_VendorMaster_ALL
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   05:30:20 AP_VendorMaster_ALL EXTRACT FIELDS ALL 'R11' AS 'SourceFlag' TO "AP_VendorMaster_ALL_FMT.FIL"  IF c_SITE_LAST_UPDATE_DATE>=CTOD(_Data_Range_From_VM,"DD/MM/YYYY") OR c_HEADER_LAST_UPDATE_DATE>=CTOD(_Data_Range_From_VM,"DD/MM/YYYY")
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   05:30:51 AP_VendorMaster_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Co' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NAME),1,73))) AS 'Vndr_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ABN),1,20))) AS 'ABN' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_STATUS),1,1))) AS 'Vndr_Sts' CTOD('', 'DD/MM/YYYY') AS 'Vndr_InvlDt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_TYPE),1,11))) AS 'Vndr_Typ' BLANKS(15) AS 'Vndr_Add_Typ' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ADDRESS),1,125))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(CITY),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(STATE),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(POSTCODE),1,12))) AS 'Pcode' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(COUNTRY),1,61))) AS 'Cntry' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Tel),1,21))) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Fax),1,21))) AS 'FAX' BLANKS(60) AS 'Email1' BLANKS(60) AS 'Email2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_METHOD),1,21))) AS 'Pymnt_Trm' c_SITE_CREATION_DATE AS 'Created_Dt' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE),1,30))) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_REGISTRATION_STATUS),1,30))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(SourceFlag),1,3))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NUMBER),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' c_SITE_INACTIVE_DATE AS 'Dt_Field1' c_SITE_CREATION_DATE AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3'   TO "Working_Files\VMF_Vnd_Master_File.FIL"
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   05:59:49 VMF_Vnd_Master_File SET FILTER Vndr_Sts="A" AND InvABN="M"
~.18/02/2016   05:59:49 VMF_Vnd_Master_File EXTRACT FIELDS 100 AS "TstCd" VMF_Vnd_Master_File.Vndr_Site_ID VMF_Vnd_Master_File.Co VMF_Vnd_Master_File.Vndr_ID VMF_Vnd_Master_File.Vndr_Nme VMF_Vnd_Master_File.ABN VMF_Vnd_Master_File.Vndr_Sts VMF_Vnd_Master_File.Vndr_Typ VMF_Vnd_Master_File.Vndr_Add_Typ VMF_Vnd_Master_File.ADD1 VMF_Vnd_Master_File.ADD2 VMF_Vnd_Master_File.ADD3 VMF_Vnd_Master_File.City VMF_Vnd_Master_File.State VMF_Vnd_Master_File.Pcode VMF_Vnd_Master_File.Cntry VMF_Vnd_Master_File.TEL1 VMF_Vnd_Master_File.TEL2 VMF_Vnd_Master_File.TEL3 VMF_Vnd_Master_File.FAX VMF_Vnd_Master_File.Email1 VMF_Vnd_Master_File.Email2 VMF_Vnd_Master_File.Pymnt_Trm CTOD(DATE(VMF_Vnd_Master_File.Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(VMF_Vnd_Master_File.Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(VMF_Vnd_Master_File.Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' VMF_Vnd_Master_File.Cha_Field1 VMF_Vnd_Master_File.Cha_Field2 VMF_Vnd_Master_File.Cha_Field3 VMF_Vnd_Master_File.Cha_Field4 VMF_Vnd_Master_File.Cha_Field5 VMF_Vnd_Master_File.Num_Field1 VMF_Vnd_Master_File.Num_Field2 VMF_Vnd_Master_File.Num_Field3 VMF_Vnd_Master_File.Num_Field4 VMF_Vnd_Master_File.Num_Field5 CTOD(DATE(VMF_Vnd_Master_File.Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' VMF_Vnd_Master_File.ABN_CLN VMF_Vnd_Master_File.Max_Inv_Dt VMF_Vnd_Master_File.c_Vndr_ID AP_Vnd_InvGst_Sum.Inv_Amt AP_Vnd_InvGst_Sum.GST_Amt AP_Vnd_InvGst_Sum.COUNT IF COUNT1<>v_Cnt TO "Tmp_Files\TMP_VM006"
~Input : Records:66074       Control Total:0                    
~Output: Records:8122        Control Total:0                    
~.18/02/2016   05:59:50 VMF_Vnd_Master_File SET FILTER Vndr_Sts="A" AND LENGTH(ALLTRIM(INCLUDE(UPPER(ADD1+ADD2+ADD3),"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789")))<6
~.18/02/2016   05:59:50 VMF_Vnd_Master_File EXTRACT FIELDS 10 AS "TstCd" VMF_Vnd_Master_File.Vndr_Site_ID VMF_Vnd_Master_File.Co VMF_Vnd_Master_File.Vndr_ID VMF_Vnd_Master_File.Vndr_Nme VMF_Vnd_Master_File.ABN VMF_Vnd_Master_File.Vndr_Sts VMF_Vnd_Master_File.Vndr_Typ VMF_Vnd_Master_File.Vndr_Add_Typ VMF_Vnd_Master_File.ADD1 VMF_Vnd_Master_File.ADD2 VMF_Vnd_Master_File.ADD3 VMF_Vnd_Master_File.City VMF_Vnd_Master_File.State VMF_Vnd_Master_File.Pcode VMF_Vnd_Master_File.Cntry VMF_Vnd_Master_File.TEL1 VMF_Vnd_Master_File.TEL2 VMF_Vnd_Master_File.TEL3 VMF_Vnd_Master_File.FAX VMF_Vnd_Master_File.Email1 VMF_Vnd_Master_File.Email2 VMF_Vnd_Master_File.Pymnt_Trm CTOD(DATE(VMF_Vnd_Master_File.Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(VMF_Vnd_Master_File.Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(VMF_Vnd_Master_File.Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' VMF_Vnd_Master_File.Cha_Field1 VMF_Vnd_Master_File.Cha_Field2 VMF_Vnd_Master_File.Cha_Field3 VMF_Vnd_Master_File.Cha_Field4 VMF_Vnd_Master_File.Cha_Field5 VMF_Vnd_Master_File.Num_Field1 VMF_Vnd_Master_File.Num_Field2 VMF_Vnd_Master_File.Num_Field3 VMF_Vnd_Master_File.Num_Field4 VMF_Vnd_Master_File.Num_Field5 CTOD(DATE(VMF_Vnd_Master_File.Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' VMF_Vnd_Master_File.ABN_CLN VMF_Vnd_Master_File.Max_Inv_Dt VMF_Vnd_Master_File.c_Vndr_ID AP_Vnd_InvGst_Sum.Inv_Amt AP_Vnd_InvGst_Sum.GST_Amt AP_Vnd_InvGst_Sum.COUNT IF COUNT1<>v_Cnt TO "Tmp_Files\TMP_VM006" APPEND
~Input : Records:66074       Control Total:0                    
~Output: Records:33          Control Total:0                    
~.18/02/2016   05:59:53 VMF_Vnd_Master_File SET FILTER Vndr_Sts="A" AND LENGTH(ALLTRIM(INCLUDE(VMF_BnkAcc.BSB+VMF_BnkAcc.Bnk_Acc_Num,"1234567890")))<=3 AND VALUE(INCLUDE(VMF_BnkAcc.BSB+VMF_BnkAcc.Bnk_Acc_Num,"1234567890"),0)=0
~.18/02/2016   05:59:53 VMF_Vnd_Master_File  EXTRACT FIELDS 1000 AS "TstCd" VMF_Vnd_Master_File.Vndr_Site_ID VMF_Vnd_Master_File.Co VMF_Vnd_Master_File.Vndr_ID VMF_Vnd_Master_File.Vndr_Nme VMF_Vnd_Master_File.ABN VMF_Vnd_Master_File.Vndr_Sts VMF_Vnd_Master_File.Vndr_Typ VMF_Vnd_Master_File.Vndr_Add_Typ VMF_Vnd_Master_File.ADD1 VMF_Vnd_Master_File.ADD2 VMF_Vnd_Master_File.ADD3 VMF_Vnd_Master_File.City VMF_Vnd_Master_File.State VMF_Vnd_Master_File.Pcode VMF_Vnd_Master_File.Cntry VMF_Vnd_Master_File.TEL1 VMF_Vnd_Master_File.TEL2 VMF_Vnd_Master_File.TEL3 VMF_Vnd_Master_File.FAX VMF_Vnd_Master_File.Email1 VMF_Vnd_Master_File.Email2 VMF_Vnd_Master_File.Pymnt_Trm CTOD(DATE(VMF_Vnd_Master_File.Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(VMF_Vnd_Master_File.Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(VMF_Vnd_Master_File.Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' VMF_Vnd_Master_File.Cha_Field1 VMF_Vnd_Master_File.Cha_Field2 VMF_Vnd_Master_File.Cha_Field3 VMF_Vnd_Master_File.Cha_Field4 VMF_Vnd_Master_File.Cha_Field5 VMF_Vnd_Master_File.Num_Field1 VMF_Vnd_Master_File.Num_Field2 VMF_Vnd_Master_File.Num_Field3 VMF_Vnd_Master_File.Num_Field4 VMF_Vnd_Master_File.Num_Field5 CTOD(DATE(VMF_Vnd_Master_File.Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' VMF_Vnd_Master_File.ABN_CLN VMF_Vnd_Master_File.Max_Inv_Dt VMF_Vnd_Master_File.c_Vndr_ID AP_Vnd_InvGst_Sum.Inv_Amt AP_Vnd_InvGst_Sum.GST_Amt AP_Vnd_InvGst_Sum.COUNT IF COUNT1<>v_Cnt TO "Tmp_Files\TMP_VM006" APPEND
~Input : Records:66074       Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   05:59:53 TMP_VM006 SUMMARIZE ON Vndr_Site_ID Vndr_ID SUBTOTAL TstCd OTHER ALL TO "Tmp_Files\TMP_TstCd.FIL" OPEN PRESORT
~Input : Records:8155        Control Total:0                    
~Output: Records:8136        Control Total:0                    
~.18/02/2016   05:59:54 TMP_TstCd EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:8136        Control Total:0                    
~Output: Records:8136        Control Total:0                    
~.18/02/2016   05:59:54 TMP_GL EXTRACT FIELDS ALL IF Vndr_ID<> GreyList_VM006.Vndr_ID TO TMP_GL1 OPEN
~Input : Records:8136        Control Total:0                    
~Output: Records:8136        Control Total:0                    
~.18/02/2016   05:59:55 TMP_GL1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:8136        Control Total:0                    
~Output: Records:8136        Control Total:0                    
~.18/02/2016   05:59:55 TMP_Cur EXTRACT FIELDS Vndr_Site_ID Vndr_ID TstCd COUNT2 Co Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT c_TstCd NEW_TstCd_1 NEW_TstCd_2 NEW_TstCd_3 NEW_TstCd_4 NEW_TstCd1 NEW_TstCd2 NEW_TstCd TEST_NAME SORT_KEY SORT_KEY_Desc RptRunDate Priority ID_KEY IF ID_KEY<> VM006_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:8136        Control Total:0                    
~Output: Records:6           Control Total:0                    
~.18/02/2016   05:59:56 TMP_Cur1 SORT ON SORT_KEY D TO "Tmp_Files\TMP2"
~Input : Records:6           Control Total:0                    
~Output: Records:6           Control Total:0                    
~.18/02/2016   05:59:56 TMP2 EXTRACT FIELDS ALL  TO "Results\VM006_Mis_Details"  IF c_VALID = 1 AND Vndr_Typ<>"EMPLOYEE" AND UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"
~Input : Records:6           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_VM006_VndrSiteID               VM006_Mis_Details                "" "IDX_VM006_VndrSiteID.INX" 
*INDEX ON VNDR_SITE_ID TO IDX_VM006_VNDRSITEID
^FORMAT   VM006D_Mis_Details                 VM006D_Mis_Details               "Results" "VM006D_Mis_Details.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.18/02/2016   04:00:23 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:10948       Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20160217.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:30:12 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:31:10 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:31:11 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   05:59:59 AP_Invoices EXTRACT FIELDS ALL VM006_Mis_Details.c_TstCd IF Vndr_ID=VM006_Mis_Details.Vndr_ID TO "TMP_1" OPEN
~Input : Records:235098      Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   05:59:59 TMP_1 SORT ON SORT_KEY D TO "Tmp_Files\TMP3" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   05:59:59 TMP3 EXTRACT FIELDS ALL TO "Results\VM006D_Mis_Details"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   TMP_VM006D                         TMP_VM006D                       "" "TMP_VM006D.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1430899205
~.18/02/2016   04:00:23 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:10948       Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20160217.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:30:12 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:31:10 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:31:11 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   05:59:59 AP_Invoices EXTRACT FIELDS ALL VM006_Mis_Details.c_TstCd IF Vndr_ID=VM006_Mis_Details.Vndr_ID TO "TMP_1" OPEN
~Input : Records:235098      Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   05:59:59 TMP_1 SORT ON SORT_KEY D TO "Tmp_Files\TMP3" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   05:59:59 TMP3 EXTRACT FIELDS ALL TO "Results\VM006D_Mis_Details"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   05:59:59 VM006D_Mis_Details  EXTRACT VM006_Mis_Details.Cha_Field1 AS 'Vendor Site'  Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Typ AS 'Vendor Type' Vndr_Sts AS 'Vendor Status'  ' '+ Inv_No AS 'Invoice Number' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount' Doc_Typ AS 'Document Type' Descrp AS 'Description'   isPaid AS 'Paid' Vchr_ID AS 'Voucher Number' Priority TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc TO  TMP_VM006D
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   GreyList_VM007                     GreyList_VM007                   "Working_Files" "GreyList_VM007.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1427252735
~.18/02/2016   06:00:00 TMP2 EXTRACT FIELDS SUBSTR(ALLTRIM(F1),1,20) AS 'Vndr_ID' SUBSTR(ALLTRIM(F2),1,60) AS 'Vndr_Name' IF NOT ISBLANK(F1) AND RECNO()>1 TO "Working_Files\GreyList_VM007.fil"
~Input : Records:1           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_GreyList_VM007_Vndr_ID         GreyList_VM007                   "" "IDX_GreyList_VM007_Vndr_ID.INX" 
*INDEX ON VNDR_ID TO IDX_GREYLIST_VM007_VNDR_ID
^INDEX    IDX_VM007_History_ID_KEY           VM007_History                    "" "IDX_VM007_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_VM007_HISTORY_ID_KEY
^FORMAT   VM007_History                      VM007_History                    "History" "VM007_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~**** SOME HISTORY DELETED ****
~.19/01/2016   05:51:48 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.20/01/2016   05:58:18 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.21/01/2016   05:51:45 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.22/01/2016   05:51:40 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.25/01/2016   05:57:21 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.26/01/2016   05:51:06 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.27/01/2016   05:51:42 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.28/01/2016   05:51:55 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.29/01/2016   05:51:00 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.03/02/2016   11:26:49 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.04/02/2016   06:00:55 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.05/02/2016   06:00:06 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.08/02/2016   05:53:40 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.09/02/2016   05:53:55 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.10/02/2016   05:53:48 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.11/02/2016   05:53:15 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/02/2016   05:54:23 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.15/02/2016   05:52:58 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.16/02/2016   05:54:03 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.17/02/2016   05:59:50 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:00 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   VM007_Invld_Frmt_ABN               VM007_Invld_Frmt_ABN             "Results" "VM007_Invld_Frmt_ABN.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.18/02/2016   04:00:18 TMP1 IF v_NewFlag = 1 EXTRACT FIELDS ALL SUBSTR("E:\Data\VendorMasterfile_20160217.txt",1,50) AS 'File_Name' TO  AP_VendorMaster_ALL
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   05:30:20 AP_VendorMaster_ALL EXTRACT FIELDS ALL 'R11' AS 'SourceFlag' TO "AP_VendorMaster_ALL_FMT.FIL"  IF c_SITE_LAST_UPDATE_DATE>=CTOD(_Data_Range_From_VM,"DD/MM/YYYY") OR c_HEADER_LAST_UPDATE_DATE>=CTOD(_Data_Range_From_VM,"DD/MM/YYYY")
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   05:30:51 AP_VendorMaster_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Co' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NAME),1,73))) AS 'Vndr_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ABN),1,20))) AS 'ABN' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_STATUS),1,1))) AS 'Vndr_Sts' CTOD('', 'DD/MM/YYYY') AS 'Vndr_InvlDt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_TYPE),1,11))) AS 'Vndr_Typ' BLANKS(15) AS 'Vndr_Add_Typ' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ADDRESS),1,125))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(CITY),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(STATE),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(POSTCODE),1,12))) AS 'Pcode' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(COUNTRY),1,61))) AS 'Cntry' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Tel),1,21))) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Fax),1,21))) AS 'FAX' BLANKS(60) AS 'Email1' BLANKS(60) AS 'Email2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_METHOD),1,21))) AS 'Pymnt_Trm' c_SITE_CREATION_DATE AS 'Created_Dt' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE),1,30))) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_REGISTRATION_STATUS),1,30))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(SourceFlag),1,3))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NUMBER),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' c_SITE_INACTIVE_DATE AS 'Dt_Field1' c_SITE_CREATION_DATE AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3'   TO "Working_Files\VMF_Vnd_Master_File.FIL"
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   06:00:00 VMF_Vnd_Master_File EXTRACT FIELDS VMF_Vnd_Master_File.Vndr_Site_ID VMF_Vnd_Master_File.Co VMF_Vnd_Master_File.Vndr_ID VMF_Vnd_Master_File.Vndr_Nme VMF_Vnd_Master_File.ABN VMF_Vnd_Master_File.Vndr_Sts VMF_Vnd_Master_File.Vndr_Typ VMF_Vnd_Master_File.Vndr_Add_Typ VMF_Vnd_Master_File.ADD1 VMF_Vnd_Master_File.ADD2 VMF_Vnd_Master_File.ADD3 VMF_Vnd_Master_File.City VMF_Vnd_Master_File.State VMF_Vnd_Master_File.Pcode VMF_Vnd_Master_File.Cntry VMF_Vnd_Master_File.TEL1 VMF_Vnd_Master_File.TEL2 VMF_Vnd_Master_File.TEL3 VMF_Vnd_Master_File.FAX VMF_Vnd_Master_File.Email1 VMF_Vnd_Master_File.Email2 VMF_Vnd_Master_File.Pymnt_Trm CTOD(DATE(VMF_Vnd_Master_File.Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(VMF_Vnd_Master_File.Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(VMF_Vnd_Master_File.Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' VMF_Vnd_Master_File.Cha_Field1 VMF_Vnd_Master_File.Cha_Field2 VMF_Vnd_Master_File.Cha_Field3 VMF_Vnd_Master_File.Cha_Field4 VMF_Vnd_Master_File.Cha_Field5 VMF_Vnd_Master_File.Num_Field1 VMF_Vnd_Master_File.Num_Field2 VMF_Vnd_Master_File.Num_Field3 VMF_Vnd_Master_File.Num_Field4 VMF_Vnd_Master_File.Num_Field5 CTOD(DATE(VMF_Vnd_Master_File.Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' VMF_Vnd_Master_File.ABN_CLN VMF_Vnd_Master_File.Max_Inv_Dt VMF_Vnd_Master_File.c_Vndr_ID AP_Vnd_InvGst_Sum.Inv_Amt AP_Vnd_InvGst_Sum.GST_Amt AP_Vnd_InvGst_Sum.COUNT IF Vndr_Sts="A" AND InvABN="T" TO "Tmp_Files\\TMP_Vnd" OPEN
~Input : Records:66074       Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:00 TMP_Vnd EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:00 TMP_GL EXTRACT FIELDS ALL IF Vndr_ID<> GreyList_VM007.Vndr_ID TO TMP_GL1 OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:00 TMP_GL1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:00 TMP_Cur EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID Inv_Amt GST_Amt COUNT ID_KEY IF ID_KEY<> VM007_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:00 TMP_Cur1 SORT ON SORT_KEY D TO "Results\VM007_Invld_Frmt_ABN" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_VM007_VndrSiteID               VM007_Invld_Frmt_ABN             "" "IDX_VM007_VndrSiteID.INX" 
*INDEX ON VNDR_SITE_ID TO IDX_VM007_VNDRSITEID
^FORMAT   VM007D_Invld_Frmt_ABN              VM007D_Invld_Frmt_ABN            "Results" "VM007D_Invld_Frmt_ABN.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.18/02/2016   04:00:23 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:10948       Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20160217.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:30:12 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:31:10 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:31:11 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   06:00:03 AP_Invoices EXTRACT FIELDS ALL IF NOT ISBLANK(VM007_Invld_Frmt_ABN.Vndr_ID) TO "TMP_1" OPEN
~Input : Records:235098      Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:03 TMP_1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:04 TMP10 SORT ON SORT_KEY D TO "Results\VM007D_Invld_Frmt_ABN" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   GreyList_VM008                     GreyList_VM008                   "Working_Files" "GreyList_VM008.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1427252735
~.18/02/2016   06:00:10 TMP2 EXTRACT FIELDS SUBSTR(ALLTRIM(F1),1,20) AS 'Vndr_ID' SUBSTR(ALLTRIM(F2),1,60) AS 'Vndr_Name' IF NOT ISBLANK(F1) AND RECNO()>1 TO "Working_Files\GreyList_VM008.fil"
~Input : Records:1           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_GreyList_VM008_Vndr_ID         GreyList_VM008                   "" "IDX_GreyList_VM008_Vndr_ID.INX" 
*INDEX ON VNDR_ID TO IDX_GREYLIST_VM008_VNDR_ID
^INDEX    IDX_VM008_History_ID_KEY           VM008_History                    "" "IDX_VM008_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_VM008_HISTORY_ID_KEY
^FORMAT   VM008_History                      VM008_History                    "History" "VM008_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~**** SOME HISTORY DELETED ****
~.19/01/2016   05:51:52 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM008_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.20/01/2016   05:58:21 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM008_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.21/01/2016   05:51:49 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM008_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.22/01/2016   05:51:44 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM008_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.25/01/2016   05:57:25 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM008_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.26/01/2016   05:51:10 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM008_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.27/01/2016   05:51:46 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM008_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.28/01/2016   05:51:59 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM008_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.29/01/2016   05:51:04 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM008_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.03/02/2016   11:26:58 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM008_History"APPEND
~Input : Records:1           Control Total:0                    
~Output: Records:1           Control Total:0                    
~.04/02/2016   06:01:05 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM008_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.05/02/2016   06:00:14 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM008_History"APPEND
~Input : Records:1           Control Total:0                    
~Output: Records:1           Control Total:0                    
~.08/02/2016   05:53:49 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM008_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.09/02/2016   05:54:01 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM008_History"APPEND
~Input : Records:1           Control Total:0                    
~Output: Records:1           Control Total:0                    
~.10/02/2016   05:53:54 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM008_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.11/02/2016   05:53:21 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM008_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/02/2016   05:54:29 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM008_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.15/02/2016   05:53:07 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM008_History"APPEND
~Input : Records:2           Control Total:0                    
~Output: Records:2           Control Total:0                    
~.16/02/2016   05:54:12 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM008_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.17/02/2016   05:59:58 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM008_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:10 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM008_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   VM008Z_Can_ABN_Sum                 VM008Z_Can_ABN_Sum               "Results" "VM008Z_Can_ABN_Sum.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.18/02/2016   04:00:23 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:10948       Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20160217.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:30:12 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:31:10 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:31:11 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   06:00:13 AP_Invoices SORT ON Vndr_ID c_Inv_Dt D IF Vndr_ID=TMP_Vnd.Vndr_ID AND Inv_Dt > TMP_Vnd.ASIC_entityStatusEF TO "Tmp_Files\TMP_VM008" OPEN
~Input : Records:235098      Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:13 TMP_VM008 SUMMARIZE ON Vndr_Site_ID Vndr_ID SUBTOTAL GST_Amt Inv_Amt TO "Results\VM008Z_Can_ABN_Sum.FIL" OPEN PRESORT
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_VM008Z_VndrSiteID              VM008Z_Can_ABN_Sum               "" "IDX_VM008Z_VndrSiteID.INX" 
*INDEX ON VNDR_SITE_ID TO IDX_VM008Z_VNDRSITEID
^FORMAT   VM008_Can_ABN                      VM008_Can_ABN                    "Results" "VM008_Can_ABN.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.18/02/2016   04:00:18 TMP1 IF v_NewFlag = 1 EXTRACT FIELDS ALL SUBSTR("E:\Data\VendorMasterfile_20160217.txt",1,50) AS 'File_Name' TO  AP_VendorMaster_ALL
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   05:30:20 AP_VendorMaster_ALL EXTRACT FIELDS ALL 'R11' AS 'SourceFlag' TO "AP_VendorMaster_ALL_FMT.FIL"  IF c_SITE_LAST_UPDATE_DATE>=CTOD(_Data_Range_From_VM,"DD/MM/YYYY") OR c_HEADER_LAST_UPDATE_DATE>=CTOD(_Data_Range_From_VM,"DD/MM/YYYY")
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   05:30:51 AP_VendorMaster_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Co' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NAME),1,73))) AS 'Vndr_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ABN),1,20))) AS 'ABN' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_STATUS),1,1))) AS 'Vndr_Sts' CTOD('', 'DD/MM/YYYY') AS 'Vndr_InvlDt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_TYPE),1,11))) AS 'Vndr_Typ' BLANKS(15) AS 'Vndr_Add_Typ' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ADDRESS),1,125))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(CITY),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(STATE),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(POSTCODE),1,12))) AS 'Pcode' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(COUNTRY),1,61))) AS 'Cntry' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Tel),1,21))) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Fax),1,21))) AS 'FAX' BLANKS(60) AS 'Email1' BLANKS(60) AS 'Email2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_METHOD),1,21))) AS 'Pymnt_Trm' c_SITE_CREATION_DATE AS 'Created_Dt' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE),1,30))) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_REGISTRATION_STATUS),1,30))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(SourceFlag),1,3))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NUMBER),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' c_SITE_INACTIVE_DATE AS 'Dt_Field1' c_SITE_CREATION_DATE AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3'   TO "Working_Files\VMF_Vnd_Master_File.FIL"
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   06:00:10 VMF_Vnd_Master_File EXTRACT FIELDS VMF_Vnd_Master_File.Vndr_Site_ID VMF_Vnd_Master_File.Co VMF_Vnd_Master_File.Vndr_ID VMF_Vnd_Master_File.Vndr_Nme VMF_Vnd_Master_File.ABN VMF_Vnd_Master_File.Vndr_Sts VMF_Vnd_Master_File.Vndr_Typ VMF_Vnd_Master_File.Vndr_Add_Typ VMF_Vnd_Master_File.ADD1 VMF_Vnd_Master_File.ADD2 VMF_Vnd_Master_File.ADD3 VMF_Vnd_Master_File.City VMF_Vnd_Master_File.State VMF_Vnd_Master_File.Pcode VMF_Vnd_Master_File.Cntry VMF_Vnd_Master_File.TEL1 VMF_Vnd_Master_File.TEL2 VMF_Vnd_Master_File.TEL3 VMF_Vnd_Master_File.FAX VMF_Vnd_Master_File.Email1 VMF_Vnd_Master_File.Email2 VMF_Vnd_Master_File.Pymnt_Trm CTOD(DATE(VMF_Vnd_Master_File.Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(VMF_Vnd_Master_File.Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(VMF_Vnd_Master_File.Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' VMF_Vnd_Master_File.Cha_Field1 VMF_Vnd_Master_File.Cha_Field2 VMF_Vnd_Master_File.Cha_Field3 VMF_Vnd_Master_File.Cha_Field4 VMF_Vnd_Master_File.Cha_Field5 VMF_Vnd_Master_File.Num_Field1 VMF_Vnd_Master_File.Num_Field2 VMF_Vnd_Master_File.Num_Field3 VMF_Vnd_Master_File.Num_Field4 VMF_Vnd_Master_File.Num_Field5 CTOD(DATE(VMF_Vnd_Master_File.Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' VMF_Vnd_Master_File.ABN_CLN VMF_Vnd_Master_File.Max_Inv_Dt VMF_Vnd_Master_File.c_Vndr_ID ABN_ASIC.ASIC_entityStatusCode CTOD(ABN_ASIC.ASIC_entityStatusEF,"YYYY-MM-DD") AS "ASIC_entityStatusEF" CTOD(ABN_ASIC.ASIC_GST_effFrom,"YYYY-MM-DD") AS "ASIC_GST_effFrom" CTOD(ABN_ASIC.ASIC_GST_effTo,"YYYY-MM-DD") AS "ASIC_GST_effTo" ABN_ASIC.ASIC_entityDescription AP_Vnd_InvGst_Sum.Inv_Amt AP_Vnd_InvGst_Sum.GST_Amt AP_Vnd_InvGst_Sum.COUNT IF Vndr_Sts="A" AND (MATCH(ABN_ASIC.ASIC_entityStatusCode,"Cancelled")) AND UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  TO "Tmp_Files\TMP1" OPEN
~Input : Records:66074       Control Total:0                    
~Output: Records:17          Control Total:0                    
~.18/02/2016   06:00:10 TMP1 EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:17          Control Total:0                    
~Output: Records:17          Control Total:0                    
~.18/02/2016   06:00:10 TMP_GL EXTRACT FIELDS ALL IF Vndr_ID<> GreyList_VM008.Vndr_ID TO TMP_GL1 OPEN
~Input : Records:17          Control Total:0                    
~Output: Records:17          Control Total:0                    
~.18/02/2016   06:00:10 TMP_GL1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:17          Control Total:0                    
~Output: Records:17          Control Total:0                    
~.18/02/2016   06:00:10 TMP_Cur EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY IF ID_KEY<> VM008_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:17          Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:10 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP_Vnd" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:13 TMP_Vnd SORT ON SORT_KEY D TO "Results\VM008_Can_ABN" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_VM008_VndrSiteID               VM008_Can_ABN                    "" "IDX_VM008_VndrSiteID.INX" 
*INDEX ON VNDR_SITE_ID TO IDX_VM008_VNDRSITEID
^FORMAT   VM008D_Can_ABN                     VM008D_Can_ABN                   "Results" "VM008D_Can_ABN.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.18/02/2016   04:00:23 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:10948       Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20160217.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:30:12 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:31:10 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:31:11 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   06:00:13 AP_Invoices SORT ON Vndr_ID c_Inv_Dt D IF Vndr_ID=TMP_Vnd.Vndr_ID AND Inv_Dt > TMP_Vnd.ASIC_entityStatusEF TO "Tmp_Files\TMP_VM008" OPEN
~Input : Records:235098      Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:14 TMP_VM008 EXTRACT FIELDS ALL TMP_Vnd.ASIC_entityStatusEF IF NOT ISBLANK(VM008_can_ABN.Vndr_ID) AND  UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"   TO "Results\VM008D_Can_ABN"  OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   TMP_VM008D                         TMP_VM008D                       "" "TMP_VM008D.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1430899205
~.18/02/2016   04:00:23 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:10948       Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20160217.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:30:12 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:31:10 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:31:11 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   06:00:13 AP_Invoices SORT ON Vndr_ID c_Inv_Dt D IF Vndr_ID=TMP_Vnd.Vndr_ID AND Inv_Dt > TMP_Vnd.ASIC_entityStatusEF TO "Tmp_Files\TMP_VM008" OPEN
~Input : Records:235098      Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:14 TMP_VM008 EXTRACT FIELDS ALL TMP_Vnd.ASIC_entityStatusEF IF NOT ISBLANK(VM008_can_ABN.Vndr_ID) AND  UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"   TO "Results\VM008D_Can_ABN"  OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:14 VM008D_Can_ABN  EXTRACT VM008_can_ABN.Cha_Field1 AS 'Vendor Site'  Vndr_ID AS 'Vendor Number' Vndr_Nme AS 'Vendor Name' Vndr_Sts AS 'Vendor Status'  ' '+ Inv_No AS 'Invoice Reference' DATE(Inv_Dt) AS 'Invoice Date' Inv_Amt AS 'Invoice Amount'  Vndr_Site_ID AS 'Vendor Site ID' Vndr_ID AS 'Vendor ID'  Vchr_ID AS 'Trans Num'  Cha_Field2 AS 'Pay Method' Pymnt_Trms AS 'Payment Method' TEST_NAME DATE(RptRunDate) AS 'Test Date' DATE(Data_Range_Start_Date) AS 'Data_Range_Start_Date' DATE(Data_Range_End_Date) AS 'Data_Range_End_Date' SORT_KEY SORT_KEY_Desc TO  TMP_VM008D
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   ABN_ASIC                           ABN_ASIC                         "e:\casewareapps\casewarepackage\5d6d9eb0-a8d1-4ecb-a0e2-70f6daa3546f\WorkingDirectory\Working_Files" "ABN_ASIC.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
[RETRIEVE] 0
[REFRESH] DELIMITED "Working_Files\ABN_ASIC.fil" FROM "ABN\ABN_ASIC.TXT" 0 SEPARATOR "|" QUALIFIER NONE CONSECUTIVE STARTLINE 1 FIELD "ABN_CLN" C AT 1 DEC 0 WID 20 PIC "" AS "" FIELD "ASIC_entityStatusCode" C AT 21 DEC 0 WID 21 PIC "" AS "" FIELD "ASIC_entityStatusEF" C AT 42 DEC 0 WID 19 PIC "" AS "" FIELD "ASIC_entityStatusET" C AT 61 DEC 0 WID 19 PIC "" AS "" FIELD "RecordLastUpdatedDate" C AT 80 DEC 0 WID 21 PIC "" AS "" FIELD "ASIC_identifierValue" C AT 101 DEC 0 WID 20 PIC "" AS "" FIELD "ASIC_CurrentIndicator" C AT 121 DEC 0 WID 21 PIC "" AS "" FIELD "ASIC_Number" C AT 142 DEC 0 WID 20 PIC "" AS "" FIELD "ASIC_entityTypeCode" C AT 162 DEC 0 WID 19 PIC "" AS "" FIELD "ASIC_entityDescription" C AT 181 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_GST_effFrom" C AT 231 DEC 0 WID 16 PIC "" AS "" FIELD "ASIC_GST_effTo" C AT 247 DEC 0 WID 14 PIC "" AS "" FIELD "ASIC_orgName" C AT 261 DEC 0 WID 100 PIC "" AS "" FIELD "ASIC_effFrom" C AT 361 DEC 0 WID 12 PIC "" AS "" FIELD "ASIC_mainbus_statec" C AT 373 DEC 0 WID 19 PIC "" AS "" FIELD "ASIC_mainbus_postc" C AT 392 DEC 0 WID 18 PIC "" AS "" FIELD "ASIC_mainbus_effFr" C AT 410 DEC 0 WID 18 PIC "" AS "" FIELD "ASIC_mainbus_effTo" C AT 428 DEC 0 WID 18 PIC "" AS "" FIELD "ASIC_TrdNameCnt" C AT 446 DEC 0 WID 15 PIC "" AS "" FIELD "ASIC_TrdName01" C AT 461 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName02" C AT 511 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName03" C AT 561 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName04" C AT 611 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName05" C AT 661 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName06" C AT 711 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName07" C AT 761 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName08" C AT 811 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName09" C AT 861 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName10" C AT 911 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName11" C AT 961 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName12" C AT 1011 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName13" C AT 1061 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName14" C AT 1111 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName15" C AT 1161 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName16" C AT 1211 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName17" C AT 1261 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName18" C AT 1311 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName19" C AT 1361 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName20" C AT 1411 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName21" C AT 1461 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName22" C AT 1511 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName23" C AT 1561 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName24" C AT 1611 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName25" C AT 1661 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName26" C AT 1711 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName27" C AT 1761 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName28" C AT 1811 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName29" C AT 1861 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName30" C AT 1911 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName31" C AT 1961 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName32" C AT 2011 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName33" C AT 2061 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName34" C AT 2111 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName35" C AT 2161 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName36" C AT 2211 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName37" C AT 2261 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName38" C AT 2311 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName39" C AT 2361 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName40" C AT 2411 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName41" C AT 2461 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName42" C AT 2511 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName43" C AT 2561 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName44" C AT 2611 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName45" C AT 2661 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName46" C AT 2711 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName47" C AT 2761 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName48" C AT 2811 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName49" C AT 2861 DEC 0 WID 50 PIC "" AS "" FIELD "ASIC_TrdName50" C AT 2911 DEC 0 WID 50 PIC "" AS "" 
^INDEX    INXABN                             ABN_ASIC                         "" "INXABN.INX" 
*INDEX ON ABN_CLN TO INXABN
^FORMAT   GreyList_VM009                     GreyList_VM009                   "Working_Files" "GreyList_VM009.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1427252735
~.18/02/2016   06:00:25 TMP2 EXTRACT FIELDS SUBSTR(ALLTRIM(F1),1,20) AS 'Vndr_ID' SUBSTR(ALLTRIM(F2),1,60) AS 'Vndr_Name' IF NOT ISBLANK(F1) AND RECNO()>1 TO "Working_Files\GreyList_VM009.fil"
~Input : Records:1           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_GreyList_VM009_Vndr_ID         GreyList_VM009                   "" "IDX_GreyList_VM009_Vndr_ID.INX" 
*INDEX ON VNDR_ID TO IDX_GREYLIST_VM009_VNDR_ID
^INDEX    IDX_VM009_History_ID_KEY           VM009_History                    "" "IDX_VM009_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_VM009_HISTORY_ID_KEY
^FORMAT   VM009_History                      VM009_History                    "History" "VM009_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~**** SOME HISTORY DELETED ****
~.19/01/2016   05:51:55 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.20/01/2016   05:58:25 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.21/01/2016   05:51:52 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.22/01/2016   05:51:48 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.25/01/2016   05:57:28 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.26/01/2016   05:51:14 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.27/01/2016   05:51:51 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.28/01/2016   05:52:04 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.29/01/2016   05:51:08 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.03/02/2016   11:27:08 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.04/02/2016   06:01:15 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.05/02/2016   06:00:24 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.08/02/2016   05:53:59 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.09/02/2016   05:54:08 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.10/02/2016   05:54:00 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.11/02/2016   05:53:28 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.12/02/2016   05:54:36 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.15/02/2016   05:53:16 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.16/02/2016   05:54:21 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.17/02/2016   06:00:10 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:25 TMP_Cur1 EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY TO "History\VM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   VM009Z_Invld_ABN_ABR_Sum           VM009Z_Invld_ABN_ABR_Sum         "Results" "VM009Z_Invld_ABN_ABR_Sum.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.18/02/2016   04:00:23 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:10948       Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20160217.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:30:12 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:31:10 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:31:11 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   06:00:28 AP_Invoices SORT ON Vndr_ID c_Inv_Dt D IF Vndr_ID=TMP_Vnd.Vndr_ID TO "Tmp_Files\TMP_VM009" OPEN
~Input : Records:235098      Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:28 TMP_VM009 SUMMARIZE ON Vndr_Site_ID Vndr_ID SUBTOTAL GST_Amt Inv_Amt TO "Results\VM009Z_Invld_ABN_ABR_Sum.FIL" OPEN PRESORT
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_VM009Z_VndrSiteID              VM009Z_Invld_ABN_ABR_Sum         "" "IDX_VM009Z_VndrSiteID.INX" 
*INDEX ON VNDR_SITE_ID TO IDX_VM009Z_VNDRSITEID
^FORMAT   VM009_Invld_ABN_ABR                VM009_Invld_ABN_ABR              "Results" "VM009_Invld_ABN_ABR.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.18/02/2016   04:00:18 TMP1 IF v_NewFlag = 1 EXTRACT FIELDS ALL SUBSTR("E:\Data\VendorMasterfile_20160217.txt",1,50) AS 'File_Name' TO  AP_VendorMaster_ALL
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   05:30:20 AP_VendorMaster_ALL EXTRACT FIELDS ALL 'R11' AS 'SourceFlag' TO "AP_VendorMaster_ALL_FMT.FIL"  IF c_SITE_LAST_UPDATE_DATE>=CTOD(_Data_Range_From_VM,"DD/MM/YYYY") OR c_HEADER_LAST_UPDATE_DATE>=CTOD(_Data_Range_From_VM,"DD/MM/YYYY")
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   05:30:51 AP_VendorMaster_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Co' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NAME),1,73))) AS 'Vndr_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ABN),1,20))) AS 'ABN' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_VENDOR_STATUS),1,1))) AS 'Vndr_Sts' CTOD('', 'DD/MM/YYYY') AS 'Vndr_InvlDt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_TYPE),1,11))) AS 'Vndr_Typ' BLANKS(15) AS 'Vndr_Add_Typ' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ADDRESS),1,125))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(CITY),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(STATE),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(POSTCODE),1,12))) AS 'Pcode' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(COUNTRY),1,61))) AS 'Cntry' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Tel),1,21))) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(c_Fax),1,21))) AS 'FAX' BLANKS(60) AS 'Email1' BLANKS(60) AS 'Email2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_METHOD),1,21))) AS 'Pymnt_Trm' c_SITE_CREATION_DATE AS 'Created_Dt' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE),1,30))) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_REGISTRATION_STATUS),1,30))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(SourceFlag),1,3))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_NUMBER),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' c_SITE_INACTIVE_DATE AS 'Dt_Field1' c_SITE_CREATION_DATE AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3'   TO "Working_Files\VMF_Vnd_Master_File.FIL"
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   06:00:23 VMF_Vnd_Master_File EXTRACT FIELDS VMF_Vnd_Master_File.Vndr_Site_ID VMF_Vnd_Master_File.Co VMF_Vnd_Master_File.Vndr_ID VMF_Vnd_Master_File.Vndr_Nme VMF_Vnd_Master_File.ABN VMF_Vnd_Master_File.Vndr_Sts VMF_Vnd_Master_File.Vndr_Typ VMF_Vnd_Master_File.Vndr_Add_Typ VMF_Vnd_Master_File.ADD1 VMF_Vnd_Master_File.ADD2 VMF_Vnd_Master_File.ADD3 VMF_Vnd_Master_File.City VMF_Vnd_Master_File.State VMF_Vnd_Master_File.Pcode VMF_Vnd_Master_File.Cntry VMF_Vnd_Master_File.TEL1 VMF_Vnd_Master_File.TEL2 VMF_Vnd_Master_File.TEL3 VMF_Vnd_Master_File.FAX VMF_Vnd_Master_File.Email1 VMF_Vnd_Master_File.Email2 VMF_Vnd_Master_File.Pymnt_Trm CTOD(DATE(VMF_Vnd_Master_File.Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(VMF_Vnd_Master_File.Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(VMF_Vnd_Master_File.Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' VMF_Vnd_Master_File.Cha_Field1 VMF_Vnd_Master_File.Cha_Field2 VMF_Vnd_Master_File.Cha_Field3 VMF_Vnd_Master_File.Cha_Field4 VMF_Vnd_Master_File.Cha_Field5 VMF_Vnd_Master_File.Num_Field1 VMF_Vnd_Master_File.Num_Field2 VMF_Vnd_Master_File.Num_Field3 VMF_Vnd_Master_File.Num_Field4 VMF_Vnd_Master_File.Num_Field5 CTOD(DATE(VMF_Vnd_Master_File.Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(VMF_Vnd_Master_File.Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' VMF_Vnd_Master_File.ABN_CLN VMF_Vnd_Master_File.Max_Inv_Dt VMF_Vnd_Master_File.c_Vndr_ID ABN_ASIC.ASIC_entityStatusCode CTOD(ABN_ASIC.ASIC_entityStatusEF,"YYYY-MM-DD") AS "ASIC_entityStatusEF" CTOD(ABN_ASIC.ASIC_GST_effFrom,"YYYY-MM-DD") AS "ASIC_GST_effFrom" CTOD(ABN_ASIC.ASIC_GST_effTo,"YYYY-MM-DD") AS "ASIC_GST_effTo" ABN_ASIC.ASIC_entityDescription AP_Vnd_InvGst_Sum.Inv_Amt AP_Vnd_InvGst_Sum.GST_Amt AP_Vnd_InvGst_Sum.COUNT IF LENGTH(ALLTRIM(ABN_CLN))>1 AND Vndr_Sts="A" AND InvABN="F" AND (MATCH(ABN_ASIC.ASIC_entityStatusCode,"Not Found")) TO "Tmp_Files\TMP1" OPEN
~Input : Records:66074       Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:25 TMP1 EXTRACT FIELDS ALL TO TMP_GL OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:25 TMP_GL EXTRACT FIELDS ALL IF Vndr_ID<> GreyList_VM009.Vndr_ID TO TMP_GL1 OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:25 TMP_GL1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:25 TMP_Cur EXTRACT FIELDS Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm Created_Dt Modf_Dt Vndr_InvlDt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 ABN_CLN Max_Inv_Dt c_Vndr_ID ASIC_entityStatusCode ASIC_entityStatusEF ASIC_GST_effFrom ASIC_GST_effTo ASIC_entityDescription Inv_Amt GST_Amt COUNT ID_KEY IF ID_KEY<> VM009_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:25 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP_Vnd" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:28 TMP_Vnd EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" IF UPPER(ALLTRIM(Vndr_Typ)) <> "FOXBOUNTY" AND UPPER(ALLTRIM(Vndr_Typ)) <> "GRANT"  OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:28 TMP10 SORT ON SORT_KEY TO "Results\VM009_Invld_ABN_ABR" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_VM009_VndrSiteID               VM009_Invld_ABN_ABR              "" "IDX_VM009_VndrSiteID.INX" 
*INDEX ON VNDR_SITE_ID TO IDX_VM009_VNDRSITEID
^FORMAT   VM009D_Invld_ABN_ABR               VM009D_Invld_ABN_ABR             "Results" "VM009D_Invld_ABN_ABR.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.18/02/2016   04:00:23 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:10948       Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20160217.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:30:12 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:31:10 AP_INVOICES_ALL_FMT IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_ID),1,10))) AS 'Vchr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_SITE_ID),1,20))) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(VENDOR_ID),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_TYPE),1,10))) AS 'Doc_Typ' INVOICE_DATE AS 'Inv_Dt' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(INVOICE_NUM),1,50))) AS 'Inv_No' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt' DEC(INVOICE_AMOUNT,2) AS 'Inv_Amt_Doc' BLANKS(15) AS 'Curncy' 0.00 AS 'Ex_Rate' 0.00 AS 'Inv_Net_Amt' 0.00 AS 'GST_Amt' BLANKS(15) AS 'Btch_No' CTOD('', 'DD/MM/YYYY') AS 'Due_Dt' BLANKS(21) AS 'PO_No' 0.00 AS 'PO_Net_Amt' BLANKS(31) AS 'Descrp' CTOD('', 'DD/MM/YYYY') AS 'Pd_Dt' BLANKS(21) AS 'Pymnt_Trms' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(15) AS 'Modf_By' CTOD('', 'DD/MM/YYYY') AS 'Pst_Dt' BLANKS(1) AS 'VOIDED' CTOD('', 'DD/MM/YYYY') AS 'Void_Dt' BLANKS(1) AS 'isPaid' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(GST_STATUS),1,20))) AS 'Cha_Field2' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PAYMENT_STATUS_FLAG),1,20))) AS 'Cha_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(Description),1,20))) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\TMP_Inv.FIL" OPEN
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:31:11 TMP_Inv EXTRACT FIELDS ALL IF Inv_Amt<>0.00 TO  "Working_Files\AP_Invoices.FIL"
~Input : Records:243508      Control Total:0                    
~Output: Records:235098      Control Total:0                    
~.18/02/2016   06:00:28 AP_Invoices SORT ON Vndr_ID c_Inv_Dt D IF Vndr_ID=TMP_Vnd.Vndr_ID TO "Tmp_Files\TMP_VM009" OPEN
~Input : Records:235098      Control Total:0                    
~Output: Records:0           Control Total:0                    
~.18/02/2016   06:00:29 TMP_VM009 EXTRACT FIELDS ALL TMP_Vnd.ASIC_entityStatusEF IF NOT ISBLANK(VM009_Invld_ABN_ABR.Vndr_ID) TO "Results\VM009D_Invld_ABN_ABR" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FOLDER   __                                  1455773842
[PARENT_FOLDER_ID] 1426733080
^BATCH    CCM01_DailyTestAP                  
[PARENT_FOLDER_ID] 1455773842

COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION FOR CCM (Caseware, task scheduler)
COMM *** DELWP - Run all in a single process - from import until report generation
COMM *** Created by Alvin Anwar (02) 9667 3866
COMM***************************************************************************

SET SAFETY OFF

v_CCMJob = "COMMENT "
DO CA001_ImpPreData_AP

COMM
DO CA003_RunABNChecker

COMM *** Prepare variables ***
v_Exc_GreyList=T

COMM *** Execute tests ***
v_Exc_History=T

TXT_AP014_Months="18"

COMM
DO VM001_Dup_Vnd_BankAcc
DO VM002_Dup_Vnd_ABN
DO VM003_Dup_Vnd_Add
DO VM005_Dup_Vnd_Name
DO VM006_Mis_Details
DO VM007_Invld_Frmt_ABN
DO VM008_Can_ABN
DO VM009_Invld_ABN_ABR
DO VM010_DeReg_GST

DO AP000_Dup_All_123
DO AP004_Dup_Amt_Dt_Vndr
DO AP006_Pay_Not_In_VMF
COMM
COMM -- 27/8/2015 Mick Mongan request for this test to be removed
COMM
DO AP014_No_Trans_xx_Mon

TXT_Exp_filepath="Reports\"


COMM *** Export the file into xml format without suffix ***
rad1=5
suffix=""
v_CW=""

DO UZ006_CHK_Exp_F

CHK_Exp_VM001=F
CHK_Exp_VM002=F
CHK_Exp_VM003=F
CHK_Exp_VM005=F
CHK_Exp_VM006=F
CHK_Exp_VM007=F
CHK_Exp_VM008=F
CHK_Exp_VM009=F
CHK_Exp_VM010=F

CHK_Exp_AP000=T
CHK_Exp_AP001=T
CHK_Exp_AP002=T
CHK_Exp_AP003=T
CHK_Exp_AP004=T
CHK_Exp_AP006=T
CHK_Exp_AP014=F

DO UU001_Export

COMM *** delete tmp files and relations ***
DO AE003_Del_Tmp


QUIT
^BATCH    CA001_ImpPreData_AP                
[PARENT_FOLDER_ID] 1455773842

COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION FOR CCM (Caseware, task scheduler)
COMM *** Prepare the data for the mapping/conversion 
COMM *** Created by Nancy Li (0431 057 135) on 20/03/2015
COMM***************************************************************************

SET SAFETY OFF
DO AA002_Variable_Setting

COMM *** remove the dialog or pause when runing the jobs in automation mode***
v_CCMJob="COMMENT"

SET DATE "YYYYMMDD"

F_Append=T

COMM *** FILTER AP (18 Months )And VM Data ***
_Data_Range_From=ALLTRIM(DATE(_RptRunDate - 700 )) 
_Data_Range_To=ALLTRIM(DATE(_RptRunDate))

COMM *** Keep 2 years VM Data 2015 ***
_Data_Range_To_VM=ALLTRIM(DATE(_RptRunDate  )) 
_Data_Range_From_VM=ALLTRIM(DATE(_RptRunDate - 7300))

DO CB001_Extract_APVM

COMM ***via ODBC: Import related fields for the feed of the ACL Tests ***
DO CB001_Imp_AP_VM 

COMM *** Prepare the data and do the convertion ***
DO CB002_Pre_AP_VM

COMM *** get excel mapping table ***
Errmsg=""
DM_Flag=F
DO LE003_Imp_Mapping 

COMM *** Convert Source data into ACL application ***
DO MP001_Convert_VMF IF v_vm_count > 0

DO MP002_Convert_AP IF v_invoice_count > 0

COMM
DO MZ003_Com_VndEmp

COMM *** delete all temperary tables ***
DO AE003_Del_Tmp

CLOSE PRIMARY SECONDARY

COMM QUIT
^FOLDER   z_old                               1455775977
[PARENT_FOLDER_ID] 1340159548
^FORMAT   AP_VendorMaster_ALL                AP_VendorMaster_ALL              "" "AP_VendorMaster_ALL.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1455775977
~.18/02/2016   04:00:18 TMP1 IF v_NewFlag = 1 EXTRACT FIELDS ALL SUBSTR("E:\Data\VendorMasterfile_20160217.txt",1,50) AS 'File_Name' TO  AP_VendorMaster_ALL
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
^FORMAT   AP_VendorMaster_ALL_FMT            AP_VendorMaster_ALL_FMT          "" "AP_VendorMaster_ALL_FMT.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1455775977
~.18/02/2016   04:00:18 TMP1 IF v_NewFlag = 1 EXTRACT FIELDS ALL SUBSTR("E:\Data\VendorMasterfile_20160217.txt",1,50) AS 'File_Name' TO  AP_VendorMaster_ALL
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
~.18/02/2016   05:30:20 AP_VendorMaster_ALL EXTRACT FIELDS ALL 'R11' AS 'SourceFlag' TO "AP_VendorMaster_ALL_FMT.FIL"  IF c_SITE_LAST_UPDATE_DATE>=CTOD(_Data_Range_From_VM,"DD/MM/YYYY") OR c_HEADER_LAST_UPDATE_DATE>=CTOD(_Data_Range_From_VM,"DD/MM/YYYY")
~Input : Records:66074       Control Total:0                    
~Output: Records:66074       Control Total:0                    
^FORMAT   AP_INVOICES_ALL_Old                AP_INVOICES_ALL_Old              "" "AP_INVOICES_ALL_Old.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1455775977
~.17/02/2016   04:00:12 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:6403        Control Total:0                    
~Output: Records:3088        Control Total:0                    
~.17/02/2016   04:00:12 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20160216.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:3088        Control Total:0                    
~Output: Records:3088        Control Total:0                    
~.17/02/2016   04:00:12 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:3088        Control Total:0                    
~Output: Records:3088        Control Total:0                    
~.17/02/2016   04:00:22 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243359      Control Total:0                    
~Output: Records:240670      Control Total:0                    
~.17/02/2016   04:00:23 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243758      Control Total:0                    
~Output: Records:243758      Control Total:0                    
~.18/02/2016   04:00:27 AP_INVOICES_ALL EXTRACT RECORD TO AP_INVOICES_ALL_Old OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:243758      Control Total:0                    
^FORMAT   AP_VendorMasterBnkAcc_ALL_FMT      AP_VendorMasterBnkAcc_ALL_FMT    "" "AP_VendorMasterBnkAcc_ALL_FMT.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1455775977
~.18/02/2016   04:00:19 TMP1 SORT ON _VENDOR_SITE_ID_ VENDOR_ID__ _VENDOR_BSB_ _VENDOR_BANK_ACCOUNT_NUMBER_ _ACCT_START_DATE_  D  TO "TMP_2" OPEN
~Input : Records:33          Control Total:0                    
~Output: Records:33          Control Total:0                    
~.18/02/2016   04:00:19 TMP_2 SUMMARIZE ON _VENDOR_SITE_ID_ VENDOR_ID__ _VENDOR_BSB_ _VENDOR_BANK_ACCOUNT_NUMBER_ OTHER _VENDOR_SITE_ID_ VENDOR_ID__ _VENDOR_BSB_ _VENDOR_BANK_ACCOUNT_NUMBER_ _VENDOR_BANK_ACCT_NAME_ _ACCT_START_DATE_ _ACCT_END_DATE LAST_UPDATE_DATE TO "TMP_3.FIL" OPEN PRESORT
~Input : Records:33          Control Total:0                    
~Output: Records:33          Control Total:0                    
~.18/02/2016   04:00:19 TMP_3 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\VendorBankAccount_20160217.txt",1,50) AS 'File_Name' TO  AP_VendorMasterBnkAcc_ALL_New
~Input : Records:33          Control Total:0                    
~Output: Records:33          Control Total:0                    
~.18/02/2016   04:00:19 AP_VendorMasterBnkAcc_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:33          Control Total:0                    
~Output: Records:33          Control Total:0                    
~.18/02/2016   04:00:20 AP_VendorMasterBnkAcc_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_VendorMasterBnkAcc_ALL_New.C_KEY AP_VendorMasterBnkAcc_ALL_Old.C_KEY)  APPEND OPEN
~Input : Records:33997       Control Total:0                    
~Output: Records:33974       Control Total:0                    
~.18/02/2016   04:00:20 TMP3 EXTRACT RECORD TO AP_VendorMasterBnkAcc_ALL
~Input : Records:34007       Control Total:0                    
~Output: Records:34007       Control Total:0                    
~.18/02/2016   05:30:22 AP_VendorMasterBnkAcc_ALL EXTRACT FIELDS SUBSTR(c_VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTR(_VENDOR_SITE_ID_,1,20) AS 'VENDOR_SITE_ID' SUBSTR(_VENDOR_BANK_ACCT_NAME_,1,60) AS 'VENDOR_BANK_ACCT_NAME' SUBSTR(_VENDOR_BSB_,1,20) AS 'VENDOR_BSB'   SUBSTR(_VENDOR_BANK_ACCOUNT_NUMBER_,1,30) AS 'VENDOR_BANK_ACCOUNT_NUMBER' c_ACCT_START_DATE AS 'ACCT_START_DATE'  c_ACCT_END_DATE AS 'ACCT_END_DATE' c_LAST_UPDATE_DATE AS 'LAST_UPDATE_DATE'  'R11' AS 'SourceFlag' File_Name TO "AP_VendorMasterBnkAcc_ALL_FMT.FIL" IF (c_LAST_UPDATE_DATE >= CTOD(_Data_Range_From_VM,"DD/MM/YYYY") OR c_ACCT_START_DATE >= CTOD(_Data_Range_From_VM,"DD/MM/YYYY")) AND c_ACCT_END_DATE = `19000101`
~Input : Records:34007       Control Total:0                    
~Output: Records:30247       Control Total:0                    
^FORMAT   AP_INVOICES_ALL_FMT                AP_INVOICES_ALL_FMT              "" "AP_INVOICES_ALL_FMT.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1455775977
~.18/02/2016   04:00:23 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:10948       Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20160217.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
~.18/02/2016   05:30:12 AP_INVOICES_ALL EXTRACT FIELDS SUBSTRING(VENDOR_ID,1,20) AS 'VENDOR_ID' SUBSTRING(VENDOR_SITE_ID,1,20) AS 'VENDOR_SITE_ID' SUBSTRING(INVOICE_ID,1,10) AS 'INVOICE_ID' c_INVOICE_DATE AS 'INVOICE_DATE',  SUBSTRING(INVOICE_NUM,1,50) AS 'INVOICE_NUM' c_INVOICE_AMOUNT AS 'INVOICE_AMOUNT' SUBSTRING(DESCRIPTION,1,500) AS 'DESCRIPTION' INVOICE_TYPE SUBSTRING(CHARGECODE,1,40) AS 'CHARGECODE' PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS SourceFlag File_Name TO AP_INVOICES_ALL_FMT IF c_INVOICE_DATE>=CTOD(_Data_Range_From,"DD/MM/YYYY")
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
^FORMAT   AP_VendorMasterBnkAcc_ALL_New      AP_VendorMasterBnkAcc_ALL_New    "" "AP_VendorMasterBnkAcc_ALL_New.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1455775977
~.18/02/2016   04:00:19 TMP1 SORT ON _VENDOR_SITE_ID_ VENDOR_ID__ _VENDOR_BSB_ _VENDOR_BANK_ACCOUNT_NUMBER_ _ACCT_START_DATE_  D  TO "TMP_2" OPEN
~Input : Records:33          Control Total:0                    
~Output: Records:33          Control Total:0                    
~.18/02/2016   04:00:19 TMP_2 SUMMARIZE ON _VENDOR_SITE_ID_ VENDOR_ID__ _VENDOR_BSB_ _VENDOR_BANK_ACCOUNT_NUMBER_ OTHER _VENDOR_SITE_ID_ VENDOR_ID__ _VENDOR_BSB_ _VENDOR_BANK_ACCOUNT_NUMBER_ _VENDOR_BANK_ACCT_NAME_ _ACCT_START_DATE_ _ACCT_END_DATE LAST_UPDATE_DATE TO "TMP_3.FIL" OPEN PRESORT
~Input : Records:33          Control Total:0                    
~Output: Records:33          Control Total:0                    
~.18/02/2016   04:00:19 TMP_3 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\VendorBankAccount_20160217.txt",1,50) AS 'File_Name' TO  AP_VendorMasterBnkAcc_ALL_New
~Input : Records:33          Control Total:0                    
~Output: Records:33          Control Total:0                    
^FORMAT   AP_INVOICES_ALL_New                AP_INVOICES_ALL_New              "" "AP_INVOICES_ALL_New.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1455775977
~.18/02/2016   04:00:23 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:10948       Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20160217.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
^FORMAT   AP_VendorMasterBnkAcc_ALL_Old      AP_VendorMasterBnkAcc_ALL_Old    "" "AP_VendorMasterBnkAcc_ALL_Old.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1455775977
~.17/02/2016   04:00:10 TMP1 SORT ON _VENDOR_SITE_ID_ VENDOR_ID__ _VENDOR_BSB_ _VENDOR_BANK_ACCOUNT_NUMBER_ _ACCT_START_DATE_  D  TO "TMP_2" OPEN
~Input : Records:23          Control Total:0                    
~Output: Records:23          Control Total:0                    
~.17/02/2016   04:00:10 TMP_2 SUMMARIZE ON _VENDOR_SITE_ID_ VENDOR_ID__ _VENDOR_BSB_ _VENDOR_BANK_ACCOUNT_NUMBER_ OTHER _VENDOR_SITE_ID_ VENDOR_ID__ _VENDOR_BSB_ _VENDOR_BANK_ACCOUNT_NUMBER_ _VENDOR_BANK_ACCT_NAME_ _ACCT_START_DATE_ _ACCT_END_DATE LAST_UPDATE_DATE TO "TMP_3.FIL" OPEN PRESORT
~Input : Records:23          Control Total:0                    
~Output: Records:23          Control Total:0                    
~.17/02/2016   04:00:10 TMP_3 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\VendorBankAccount_20160216.txt",1,50) AS 'File_Name' TO  AP_VendorMasterBnkAcc_ALL_New
~Input : Records:23          Control Total:0                    
~Output: Records:23          Control Total:0                    
~.17/02/2016   04:00:10 AP_VendorMasterBnkAcc_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:23          Control Total:0                    
~Output: Records:23          Control Total:0                    
~.17/02/2016   04:00:11 AP_VendorMasterBnkAcc_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_VendorMasterBnkAcc_ALL_New.C_KEY AP_VendorMasterBnkAcc_ALL_Old.C_KEY)  APPEND OPEN
~Input : Records:33986       Control Total:0                    
~Output: Records:33974       Control Total:0                    
~.17/02/2016   04:00:11 TMP3 EXTRACT RECORD TO AP_VendorMasterBnkAcc_ALL
~Input : Records:33997       Control Total:0                    
~Output: Records:33997       Control Total:0                    
~.18/02/2016   04:00:20 AP_VendorMasterBnkAcc_ALL EXTRACT RECORD TO AP_VendorMasterBnkAcc_ALL_Old OPEN
~Input : Records:33997       Control Total:0                    
~Output: Records:33997       Control Total:0                    
^FORMAT   AP_INVOICES_ALL                    AP_INVOICES_ALL                  "" "AP_INVOICES_ALL.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1455775977
~.18/02/2016   04:00:23 TMP1 SUMMARIZE ON INVOICE_ID OTHER VENDOR_ID VENDOR_SITE_ID INVOICE_ID INVOICE_NUM INVOICE_TYPE INVOICE_DATE INVOICE_AMOUNT DESCRIPTION CHARGECODE PAYMENT_STATUS_FLAG CANCELLED_DATE GST_STATUS APPROVAL_STATUS 'R11' AS 'SourceFlag' TO TMP2 OPEN
~Input : Records:10948       Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 TMP2 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\Invoices_20160217.txt",1,50) AS 'File_Name' TO  AP_INVOICES_ALL_New
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:23 AP_INVOICES_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:4654        Control Total:0                    
~Output: Records:4654        Control Total:0                    
~.18/02/2016   04:00:32 AP_INVOICES_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_INVOICES_ALL_New.C_KEY AP_INVOICES_ALL_Old.C_KEY)  AND (c_INVOICE_DATE >= _Last2YearTranDt ) APPEND OPEN
~Input : Records:243758      Control Total:0                    
~Output: Records:238854      Control Total:0                    
~.18/02/2016   04:00:34 TMP3 EXTRACT RECORD TO AP_INVOICES_ALL
~Input : Records:243508      Control Total:0                    
~Output: Records:243508      Control Total:0                    
^FORMAT   AP_VendorMasterBnkAcc_ALL          AP_VendorMasterBnkAcc_ALL        "" "AP_VendorMasterBnkAcc_ALL.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1455775977
~.18/02/2016   04:00:19 TMP1 SORT ON _VENDOR_SITE_ID_ VENDOR_ID__ _VENDOR_BSB_ _VENDOR_BANK_ACCOUNT_NUMBER_ _ACCT_START_DATE_  D  TO "TMP_2" OPEN
~Input : Records:33          Control Total:0                    
~Output: Records:33          Control Total:0                    
~.18/02/2016   04:00:19 TMP_2 SUMMARIZE ON _VENDOR_SITE_ID_ VENDOR_ID__ _VENDOR_BSB_ _VENDOR_BANK_ACCOUNT_NUMBER_ OTHER _VENDOR_SITE_ID_ VENDOR_ID__ _VENDOR_BSB_ _VENDOR_BANK_ACCOUNT_NUMBER_ _VENDOR_BANK_ACCT_NAME_ _ACCT_START_DATE_ _ACCT_END_DATE LAST_UPDATE_DATE TO "TMP_3.FIL" OPEN PRESORT
~Input : Records:33          Control Total:0                    
~Output: Records:33          Control Total:0                    
~.18/02/2016   04:00:19 TMP_3 IF v_NewFlag = 0 EXTRACT FIELDS ALL SUBSTR("E:\Data\VendorBankAccount_20160217.txt",1,50) AS 'File_Name' TO  AP_VendorMasterBnkAcc_ALL_New
~Input : Records:33          Control Total:0                    
~Output: Records:33          Control Total:0                    
~.18/02/2016   04:00:19 AP_VendorMasterBnkAcc_ALL_New EXTRACT RECORD TO "Tmp_Files\TMP3.FIL"
~Input : Records:33          Control Total:0                    
~Output: Records:33          Control Total:0                    
~.18/02/2016   04:00:20 AP_VendorMasterBnkAcc_ALL_Old EXTRACT RECORD TO "Tmp_Files\TMP3.FIL" IF NOT MATCH(AP_VendorMasterBnkAcc_ALL_New.C_KEY AP_VendorMasterBnkAcc_ALL_Old.C_KEY)  APPEND OPEN
~Input : Records:33997       Control Total:0                    
~Output: Records:33974       Control Total:0                    
~.18/02/2016   04:00:20 TMP3 EXTRACT RECORD TO AP_VendorMasterBnkAcc_ALL
~Input : Records:34007       Control Total:0                    
~Output: Records:34007       Control Total:0                    
^FOLDER   PR                                  1455775988
[PARENT_FOLDER_ID] 1340159548
^FORMAT   Sales_orders                       Sales_orders                     "" "Sales_orders.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1455775988
~.08/24/2015   11:13:57 Sales_orders EXTRACT FIELDS so_number sales_order_amount items_ordered so_date customer_number created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 TO Sales_orders_New
~Input : Records:4083        Control Total:0                    
~Output: Records:4083        Control Total:0                    
[LASTVIEW] "Default_View"
^FORMAT   Sales_orders_items                 Sales_orders_items               "" "Sales_orders_items.FIL" 0 
[PARENT_FOLDER_ID] 1455775988
[LASTVIEW] "Default_View"
^FOLDER   zz_old                              1455776720
[PARENT_FOLDER_ID] 1426733080
^BATCH    CB002_RunAP_Weekly                 
[PARENT_FOLDER_ID] 1455776720
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION FOR CCM (Caseware, task scheduler)
COMM *** Execute Accounts Payable tests - Quarterly
COMM *** Created by Nancy Li (0431 057 135) on 12/01/2015
COMM***************************************************************************

SET SAFETY OFF
SET SESSION CA004_Run_Weekly

DO AA002_Variable_Setting

COMM *** Prepare variables ***
v_Exc_GreyList=T

COMM *** Execute tests ***
v_Exc_History=T
DO AP015_Mul_Trans_OneTim_Vnd
DO AP022_Disc_Mis
DO AP023_Disc_Not_Awd


COMM *** created the sub archive folder to archive the old PMT file***
TXT_Exp_filepath="Reports\APQ_"+ALLTRIM(DATETIME(_RptRunDate,'YYYYMMDD'))+"\"
OPEN DM_VMF_Vnd_Master_File
LOCATE RECORD 1
CLASSIFY ON Type TO GRAPH
SAVE GRAPH to "%TXT_Exp_filepath%tmp.bmp"
DELETE "%TXT_Exp_filepath%tmp.bmp" OK

COMM *** Export the file into delimited or access files 1: Access; 4: delimited; 2: Excel***
rad1=4

v_CW=""
DO UZ006_CHK_Exp_F

CHK_Exp_AP015=T
CHK_Exp_AP022=T
CHK_Exp_AP023=T

DO UU001_Export

COMM *** delete tmp files and relations ***
DO AE003_Del_Tmp
CLOSE

SET SESSION

%v_AppCWM% QUIT
^BATCH    CB004_RunAP_Quarterly              
[PARENT_FOLDER_ID] 1455776720
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION FOR CCM (Caseware, task scheduler)
COMM *** Execute Accounts Payable tests - Quarterly
COMM *** Created by Nancy Li (0431 057 135) on 12/01/2015
COMM***************************************************************************

SET SAFETY OFF
SET SESSION CA004_Run_Weekly

DO AA002_Variable_Setting

COMM *** Prepare variables ***
v_Exc_GreyList=T

COMM *** Execute tests ***
v_Exc_History=T
DO AP015_Mul_Trans_OneTim_Vnd
DO AP022_Disc_Mis
DO AP023_Disc_Not_Awd


COMM *** created the sub archive folder to archive the old PMT file***
TXT_Exp_filepath="Reports\APQ_"+ALLTRIM(DATETIME(_RptRunDate,'YYYYMMDD'))+"\"
OPEN DM_VMF_Vnd_Master_File
LOCATE RECORD 1
CLASSIFY ON Type TO GRAPH
SAVE GRAPH to "%TXT_Exp_filepath%tmp.bmp"
DELETE "%TXT_Exp_filepath%tmp.bmp" OK

COMM *** Export the file into delimited or access files 1: Access; 4: delimited; 2: Excel***
rad1=4

v_CW=""
DO UZ006_CHK_Exp_F

CHK_Exp_AP015=T
CHK_Exp_AP022=T
CHK_Exp_AP023=T

DO UU001_Export

COMM *** delete tmp files and relations ***
DO AE003_Del_Tmp
CLOSE

SET SESSION

%v_AppCWM% QUIT
^BATCH    CB003_RunAP_Monthly                
[PARENT_FOLDER_ID] 1455776720
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION FOR CCM (Caseware, task scheduler)
COMM *** Execute Accounts Payable tests - Quarterly
COMM *** Created by Nancy Li (0431 057 135) on 12/01/2015
COMM***************************************************************************

SET SAFETY OFF
SET SESSION CA004_Run_Weekly

DO AA002_Variable_Setting

COMM *** Prepare variables ***
v_Exc_GreyList=T

COMM *** Execute tests ***
v_Exc_History=T
DO AP015_Mul_Trans_OneTim_Vnd
DO AP022_Disc_Mis
DO AP023_Disc_Not_Awd


COMM *** created the sub archive folder to archive the old PMT file***
TXT_Exp_filepath="Reports\APQ_"+ALLTRIM(DATETIME(_RptRunDate,'YYYYMMDD'))+"\"
OPEN DM_VMF_Vnd_Master_File
LOCATE RECORD 1
CLASSIFY ON Type TO GRAPH
SAVE GRAPH to "%TXT_Exp_filepath%tmp.bmp"
DELETE "%TXT_Exp_filepath%tmp.bmp" OK

COMM *** Export the file into delimited or access files 1: Access; 4: delimited; 2: Excel***
rad1=4

v_CW=""
DO UZ006_CHK_Exp_F

CHK_Exp_AP015=T
CHK_Exp_AP022=T
CHK_Exp_AP023=T

DO UU001_Export

COMM *** delete tmp files and relations ***
DO AE003_Del_Tmp
CLOSE

SET SESSION

%v_AppCWM% QUIT
^BATCH    CX001_Export_HIST1_VM              
[PARENT_FOLDER_ID] 1455776720
COMM Now Produce Results for AP Tests

DO AA002_Variable_Setting

COMM *** Prepare variables ***
v_Exc_GreyList=T

TXT_Exp_filepath="Reports\"

COMM *** Export the file into xml format without suffix ***

rad1=5
suffix=""

v_CW=""
DO UZ006_CHK_Exp_F
CHK_Exp_VM001=T
CHK_Exp_VM002=T
CHK_Exp_VM003=T
CHK_Exp_VM005=T
CHK_Exp_VM006=T
CHK_Exp_VM007=T
CHK_Exp_VM008=T
CHK_Exp_VM009=T
CHK_Exp_VM010=T

COMM
CHK_Exp_AP000=T
CHK_Exp_AP001=T
CHK_Exp_AP002=T
CHK_Exp_AP003=T
CHK_Exp_AP004=T
CHK_Exp_AP006=F
CHK_Exp_AP014=F

DO UU001_Exp_VM_HIST1

COMM *** delete tmp files and relations ***
DO AE003_Del_Tmp
CLOSE

SET SESSION
COMM
QUIT
^BATCH    CA001_ImpPreData_AP_HIST1          
[PARENT_FOLDER_ID] 1455776720
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION FOR CCM (Caseware, task scheduler)
COMM *** Historical Data for AP 
COMM *** 1st bucket (only AP001  AP004): contains all historical result between 
COMM *** March 2015 and 18 months prior to March 2015
COMM***************************************************************************

SET SAFETY OFF
DO AA002_Variable_Setting

COMM *** remove the dialog or pause when runing the jobs in automation mode***
v_CCMJob="COMMENT"

SET DATE "YYYYMMDD"

F_Append=T


COMM *** From Jan 01 2014 to Mar 01 2015 18 Months
_Data_Range_To=ALLTRIM(DATE(`20150331`,"DD/MM/YYYY" )) 
_Data_Range_From=ALLTRIM(DATE(`20131001`,"DD/MM/YYYY"))

DO CB001_Extract_APVM

COMM ***via ODBC: Import related fields for the feed of the ACL Tests ***
DO CB001_Imp_AP_VM

COMM *** Prepare the data and do the convertion ***
DO CB002_Pre_AP_VM

COMM *** get excel mapping table ***
Errmsg=""
DM_Flag=F
DO LE003_Imp_Mapping

COMM *** Convert Source data into ACL application ***
DO MP001_Convert_VMF

DO MP002_Convert_AP

DO MZ003_Com_VndEmp

COMM *** delete all temperary tables ***
DO AE003_Del_Tmp

CLOSE PRIMARY SECONDARY

QUIT
^BATCH    CB001_RunAP_Daily                  
[PARENT_FOLDER_ID] 1455776720
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION FOR CCM (Caseware, task scheduler)
COMM *** Execute Accounts Payable tests -weekly
COMM *** Created by Nancy Li (0431 057 135) on 12/01/2015
COMM***************************************************************************

SET SAFETY OFF
SET SESSION CB001_RunAP_Daily

DO AA002_Variable_Setting

COMM *** Prepare variables ***
v_Exc_GreyList=T

COMM *** Execute tests ***
v_Exc_History=T

comm
DO VM001_Dup_Vnd_BankAcc
DO VM002_Dup_Vnd_ABN
v_Exc_History=F
DO VM003_Dup_Vnd_Add
DO VM005_Dup_Vnd_Name
DO VM006_Mis_Details
DO VM007_Invld_Frmt_ABN
DO VM008_Can_ABN
DO VM009_Invld_ABN_ABR
DO VM010_DeReg_GST

v_Exc_History=T
COMM Assign TXT_AP014_Months = 18
TXT_AP014_Months="18"
DO AP000_Dup_All_123
DO AP004_Dup_Amt_Dt_Vndr
DO AP006_Pay_Not_In_VMF
DO AP014_No_Trans_xx_Mon


COMM *** created the sub archive folder to archive the old PMT file***
COMM
TXT_Exp_filepath="Reports\APW_"+ALLTRIM(DATETIME(_RptRunDate,'YYYYMMDD'))+"\"

TXT_Exp_filepath="Reports\"


COMM *** Export the file into xml format without suffix ***
rad1=5
suffix=""

v_CW=""
DO UZ006_CHK_Exp_F
CHK_Exp_VM001=F
CHK_Exp_VM002=F
CHK_Exp_VM003=F
CHK_Exp_VM005=F
CHK_Exp_VM006=F
CHK_Exp_VM007=F
CHK_Exp_VM008=F
CHK_Exp_VM009=F
CHK_Exp_VM010=F

CHK_Exp_AP000=T
CHK_Exp_AP001=T
CHK_Exp_AP002=T
CHK_Exp_AP003=T
CHK_Exp_AP004=T
CHK_Exp_AP006=T
CHK_Exp_AP014=T

DO UU001_Export

COMM *** delete tmp files and relations ***
DO AE003_Del_Tmp
CLOSE

SET SESSION

QUIT
^BATCH    CX001_Export_HIST1_AP              
[PARENT_FOLDER_ID] 1455776720
 COMM Now Produce Results for AP Tests

DO AA002_Variable_Setting

COMM *** Prepare variables ***
v_Exc_GreyList=T

COMM *** Execute tests ***
v_Exc_History=T

COMM Assign TXT_AP014_Months = 18
TXT_AP014_Months="18"

COMM
DO AP000_Dup_All_123
DO AP004_Dup_Amt_Dt_Vndr



COMM *** Export the file into xml format without suffix ***
rad1=5
suffix=""
COMM *** created the sub archive folder to archive the old PMT file***
COMM
TXT_Exp_filepath="Reports\APW_"+ALLTRIM(DATETIME(_RptRunDate,'YYYYMMDD'))+"\"

TXT_Exp_filepath="Reports\"


COMM *** Export the file into xml format without suffix ***
rad1=5
suffix=""

v_CW=""
DO UZ006_CHK_Exp_F
CHK_Exp_VM001=F
CHK_Exp_VM002=F
CHK_Exp_VM003=F
CHK_Exp_VM005=F
CHK_Exp_VM006=F
CHK_Exp_VM007=F
CHK_Exp_VM008=F
CHK_Exp_VM009=F
CHK_Exp_VM010=F

CHK_Exp_AP001=T
CHK_Exp_AP002=T
CHK_Exp_AP003=T
CHK_Exp_AP004=T
CHK_Exp_AP006=F
CHK_Exp_AP014=F

DO UU001_Exp_AP_HIST

COMM
CLOSE
QUIT
^BATCH    CB001_RunVM_Weekly                 
[PARENT_FOLDER_ID] 1455776720
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION FOR CCM (Caseware, task scheduler)
COMM *** Execute Accounts Payable tests -weekly
COMM *** Created by Nancy Li (0431 057 135) on 12/01/2015
COMM***************************************************************************

SET SAFETY OFF
SET SESSION CA004_Run_Weekly

DO AA002_Variable_Setting

COMM *** Prepare variables ***
v_Exc_GreyList=T

COMM *** Execute tests ***
v_Exc_History=T

DO VM001_Dup_Vnd_BankAcc
DO VM002_Dup_Vnd_ABN

comm v_Exc_History=F
DO VM003_Dup_Vnd_Add
DO VM005_Dup_Vnd_Name
DO VM006_Mis_Details
DO VM007_Invld_Frmt_ABN
DO VM008_Can_ABN
DO VM009_Invld_ABN_ABR
DO VM010_DeReg_GST

comm
v_Exc_History=T
COMM Assign TXT_AP014_Months = 18
TXT_AP014_Months="18"
DO AP000_Dup_All_123
DO AP004_Dup_Amt_Dt_Vndr
DO AP006_Pay_Not_In_VMF
DO AP014_No_Trans_xx_Mon


COMM *** created the sub archive folder to archive the old PMT file***
COMM
TXT_Exp_filepath="Reports\APW_"+ALLTRIM(DATETIME(_RptRunDate,'YYYYMMDD'))+"\"

TXT_Exp_filepath="Reports\"


COMM *** Export the file into xml format without suffix ***
rad1=5
suffix=""

v_CW=""
DO UZ006_CHK_Exp_F
CHK_Exp_VM001=T
CHK_Exp_VM002=T
CHK_Exp_VM003=T
CHK_Exp_VM005=T
CHK_Exp_VM006=T
CHK_Exp_VM007=T
CHK_Exp_VM008=T
CHK_Exp_VM009=T
CHK_Exp_VM010=T

CHK_Exp_AP000=F
CHK_Exp_AP001=F
CHK_Exp_AP002=F
CHK_Exp_AP003=F
CHK_Exp_AP004=F
CHK_Exp_AP006=F
CHK_Exp_AP014=F

DO UU001_Export

COMM *** delete tmp files and relations ***
DO AE003_Del_Tmp
CLOSE

SET SESSION

QUIT
^BATCH    Script_VM_Indexing                 
[PARENT_FOLDER_ID] 1455776720
COMM Create Relations for HIST1_VM001 
OPEN HIST1_VM001_Dup_Vnd_BankAcc
DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum INDEX IDX_AP_Sum_VndrID

OPEN HIST1_VM001_Dup_Vnd_BankAcc 
DELETE FIELD cVndrSiteVndrID OK

DEFINE FIELD cVndrSiteVndrID           COMPUTED  SUBSTR(ALLTRIM(Vndr_Site_ID),1,20)
DEFINE RELATION cVndrSiteVndrID  WITH VMF_BnkAcc INDEX IDX_BnkAcc

COMM Create Relations for HIST1_VM002
OPEN HIST1_VM002_Dup_Vnd_ABN
DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum IDX_AP_Sum_VndrID

COMM Create Relations for HIST1_VM003
OPEN HIST1_VM003_Dup_Vnd_Add
DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum INDEX IDX_AP_Sum_VndrID

COMM Create Relations for HIST1_VM005
OPEN HIST1_VM005_Dup_Vnd_Name
DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum IDX_AP_Sum_VndrID

COMM Create Relations for HIST1_VM006 
 
OPEN VMF_BnkAcc
INDEX ON SUBSTR(ALLTRIM(Vndr_Site_ID),1,20)  TO IDX_BK_VndrSiteID1
OPEN HIST1_VM006_Mis_Details
INDEX ON Vndr_Site_ID TO IDX_HVM006_VndrSiteID
OPEN HIST1_VM006_Mis_Details
DEFINE RELATION SUBST(ALLTRIM(Vndr_Site_ID),1,20) WITH VMF_BnkAcc INDEX IDX_BK_VndrSiteID1
DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum IDX_AP_Sum_VndrID
OPEN HIST1_VM006_Mis_Details
OPEN HIST1_VM006D_Mis_Details
DEFINE RELATION Vndr_Site_ID WITH HIST1_VM006_Mis_Details INDEX IDX_HVM006_VndrSiteID

COMM Create Relations forHIST1_VM008

OPEN HIST1_VM008Z_Can_ABN_Sum
INDEX ON Vndr_Site_ID TO IDX_HVM008Z_VndrSiteID
OPEN HIST1_VM008_Can_ABN
INDEX ON Vndr_Site_ID TO IDX_HVM008_VndrSiteID
DEFINE RELATION Vndr_Site_ID WITH HIST1_VM008Z_Can_ABN_Sum INDEX IDX_HVM008Z_VndrSiteID

COMM Create Relations for HIST1_VM010

OPEN HIST1_VM010D_DeReg_GST_Sum
INDEX ON Vndr_Site_ID TO IDX_HVM010D_Sum_VndrSiteID
OPEN HIST1_VM010_DeReg_GST
INDEX ON Vndr_Site_ID TO IDX_HVM010_VndrSiteID
DEFINE RELATION Vndr_Site_ID WITH HIST1_VM010D_DeReg_GST_Sum INDEX IDX_HVM010D_Sum_VndrSiteID
OPEN HIST1_VM010D_DeReg_GST
DEFINE RELATION Vndr_Site_ID WITH HIST1_VM010_DeReg_GST INDEX IDX_HVM010_VndrSiteID

DEFINE RELATION Vndr_Site_ID WITH HIST1_VM010D_DeReg_GST_Sum INDEX IDX_HVM010D_Sum_VndrSiteID
    

^BATCH    CB001_RunAP_HIST1                  
[PARENT_FOLDER_ID] 1455776720
QUIT
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION FOR CCM (Caseware, task scheduler)
COMM *** AP History Bucket1 01102013 - 01032015
COMM *** 
COMM***************************************************************************

SET SAFETY OFF
SET SESSION CA004_Run_Weekly

DO AA002_Variable_Setting

COMM *** Prepare variables ***
v_Exc_GreyList=T

COMM *** Execute tests ***
v_Exc_History=T

comm
DO VM001_Dup_Vnd_BankAcc
DO VM002_Dup_Vnd_ABN
v_Exc_History=F
DO VM003_Dup_Vnd_Add
DO VM005_Dup_Vnd_Name
DO VM006_Mis_Details
DO VM007_Invld_Frmt_ABN
DO VM008_Can_ABN
DO VM009_Invld_ABN_ABR
DO VM010_DeReg_GST

v_Exc_History=T
COMM Assign TXT_AP014_Months = 18
TXT_AP014_Months="18"
DO AP000_Dup_All_123
DO AP004_Dup_Amt_Dt_Vndr



COMM *** created the sub archive folder to archive the old PMT file***
COMM
TXT_Exp_filepath="Reports\APW_"+ALLTRIM(DATETIME(_RptRunDate,'YYYYMMDD'))+"\"

TXT_Exp_filepath="Reports\"


COMM *** Export the file into xml format without suffix ***
rad1=5
suffix=""

v_CW=""
DO UZ006_CHK_Exp_F
CHK_Exp_VM001=F
CHK_Exp_VM002=F
CHK_Exp_VM003=F
CHK_Exp_VM005=F
CHK_Exp_VM006=F
CHK_Exp_VM007=F
CHK_Exp_VM008=F
CHK_Exp_VM009=F
CHK_Exp_VM010=F

CHK_Exp_AP000=T
CHK_Exp_AP001=T
CHK_Exp_AP002=T
CHK_Exp_AP003=T
CHK_Exp_AP004=T
CHK_Exp_AP006=F
CHK_Exp_AP014=F

DO UU001_Export

COMM *** delete tmp files and relations ***
DO AE003_Del_Tmp
CLOSE

SET SESSION

^BATCH    Script_AP001_HIST                  
[PARENT_FOLDER_ID] 1455776720


COMM
EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT RANK ID_KEY SORT_KEY   TO TEST 

OPEN zHIST1_AP001_Dup_Amt_Dt_Inv_Vnd
DEFINE FIELD c_SORT_KEY COMPUTED SUBSTR(ZONED(ABS_INVAMT_CENT ,21) +"~"+ ALLTRIM(Flag) +"~"+ ALLTRIM(Vndr_ID) +"~"+ ALLTRIM(c_Inv_Dt),1,64)


EXTRACT FIELDS Flag DUP_KEY CREDIT_KEY Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ Inv_Dt Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No Due_Dt PO_No PO_Net_Amt Descrp Pd_Dt Pymnt_Trms Modf_By Modf_Dt Pst_Dt Ex_Rate VOIDED Void_Dt Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABS_INVAMT_CENT RANK ID_KEY c_SORT_KEY  TO "%fld_History%AP001_History.FIL" APPEND 

open AP001_History



COMM
OPEN TEST

^BATCH    CB001_RunVM_HIST2                  
[PARENT_FOLDER_ID] 1455776720
QUIT
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION FOR CCM (Caseware, task scheduler)
COMM *** AP History Bucket1 01104015 - 20072015
COMM *** 
COMM***************************************************************************

SET SAFETY OFF
SET SESSION CA004_Run_Weekly

DO AA002_Variable_Setting

COMM *** Prepare variables ***
v_Exc_GreyList=T

COMM *** Execute tests ***
v_Exc_History=T

COMM
TXT_AP014_Months="18"
DO AP000_Dup_All_123
DO AP004_Dup_Amt_Dt_Vndr
DO VM001_Dup_Vnd_BankAcc
DO VM002_Dup_Vnd_ABN
DO VM003_Dup_Vnd_Add
DO VM005_Dup_Vnd_Name
DO VM006_Mis_Details
DO VM007_Invld_Frmt_ABN
DO VM008_Can_ABN
DO VM009_Invld_ABN_ABR
DO VM010_DeReg_GST

COMM Assign TXT_AP014_Months = 18
COMM
TXT_AP014_Months="18"
DO AP000_Dup_All_123
DO AP004_Dup_Amt_Dt_Vndr



COMM *** created the sub archive folder to archive the old PMT file***
COMM
TXT_Exp_filepath="Reports\APW_"+ALLTRIM(DATETIME(_RptRunDate,'YYYYMMDD'))+"\"

TXT_Exp_filepath="Reports\"


COMM *** Export the file into xml format without suffix ***
rad1=5
suffix=""

v_CW=""
DO UZ006_CHK_Exp_F
CHK_Exp_VM001=T
CHK_Exp_VM002=F
CHK_Exp_VM003=F
CHK_Exp_VM005=F
CHK_Exp_VM006=F
CHK_Exp_VM007=F
CHK_Exp_VM008=F
CHK_Exp_VM009=F
CHK_Exp_VM010=F

COMM
CHK_Exp_AP000=T
CHK_Exp_AP001=T
CHK_Exp_AP002=T
CHK_Exp_AP003=T
CHK_Exp_AP004=T
CHK_Exp_AP006=F
CHK_Exp_AP014=F

DO UU001_Export

COMM *** delete tmp files and relations ***
DO AE003_Del_Tmp
CLOSE

SET SESSION

QUIT
^BATCH    CA002_ImpPreData_PR                
[PARENT_FOLDER_ID] 1455776720
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION FOR CCM (Caseware, task scheduler)
COMM *** Prepare the data for the mapping/conversion 
COMM *** Created by Nancy Li (0431 057 135) on 12/01/2015
COMM***************************************************************************

SET SAFETY OFF
SET DATE "DD/MM/YYYY"

DO AA002_Variable_Setting

F_Append=T

COMM ***via ODBC: Import related fields for the feed of the ACL Tests ***
CA003_Imp_PR_EM_Main

COMM *** get excel mapping table ***
Errmsg=""
DM_Flag=F
DO LE003_Imp_Mapping

COMM *** Convert Source data into ACL application ***
DO MP003_Convert_EMF

DO MP004_Convert_Payroll

DO MZ003_Com_VndEmp

COMM *** delete all temperary tables ***
DO AE003_Del_Tmp

CLOSE

%v_AppCWM% QUIT
^BATCH    CZ001_ACLExtractor                 
[PARENT_FOLDER_ID] 1455776720
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Load ACL Report Extractor to combine all results into excel spreadsheet
COMM *** Created by Nancy Li (0431 057 135) ON 10/12/2013 
COMM***************************************************************************

IF FTYPE("fld_ABN")="U" OR FTYPE("v_App_Path")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Workings%

EXECUTE '%v_App_Path%Reports\ACL_Report_Extractor\ACL_Extractor_V5_2007.xlsm' ASYNC



^BATCH    CA001_AP_Historical1               
[PARENT_FOLDER_ID] 1455776720
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION FOR CCM (Caseware, task scheduler)
COMM *** Historical Data for AP 
COMM *** Single bucket (only AP001  AP004): contains all historical result  
COMM *** Prior to Aug 2015 - Import and Historicals for AP - Single import and Historical AP001-AP004 Tests
COMM***************************************************************************

SET SAFETY OFF
SET SESSION CA001_AP_Historical1

DO AA002_Variable_Setting

COMM *** remove the dialog or pause when runing the jobs in automation mode***
v_CCMJob="COMMENT"

SET DATE "YYYYMMDD"

F_Append=T


COMM *** AP historical bucket1
_Data_Range_To=ALLTRIM(DATE(`20150630`,"DD/MM/YYYY" )) 
_Data_Range_From=ALLTRIM(DATE(`20001001`,"DD/MM/YYYY"))

DO CB001_Extract_APVM

COMM ***via flat files : Import related fields for the feed of the ACL Tests ***
DO CB001_Imp_AP_VM

COMM *** Prepare the data and do the convertion ***
DO CB002_Pre_APVM_Hist

COMM *** get excel mapping table ***
Errmsg=""
DM_Flag=F
DO LE003_Imp_Mapping

COMM *** Convert Source data into ACL application ***
DO MP001_Convert_VMF

DO MP002_Convert_AP

DO MZ003_Com_VndEmp

COMM *** delete all temperary tables ***
DO AE003_Del_Tmp

CLOSE PRIMARY SECONDARY

COMM Now Produce Results for AP Tests

DO AA002_Variable_Setting

COMM *** Prepare variables ***
v_Exc_GreyList=T

COMM *** Execute tests ***
v_Exc_History=T

COMM Assign TXT_AP014_Months = 18
TXT_AP014_Months="18"

DO AP000_Dup_All_123
DO AP004_Dup_Amt_Dt_Vndr



COMM *** created the sub archive folder to archive the old PMT file***
COMM
TXT_Exp_filepath="Reports\APW_"+ALLTRIM(DATETIME(_RptRunDate,'YYYYMMDD'))+"\"

TXT_Exp_filepath="Reports\"


COMM *** Export the file into xml format without suffix ***
rad1=5
suffix=""

v_CW=""
DO UZ006_CHK_Exp_F
CHK_Exp_VM001=F
CHK_Exp_VM002=F
CHK_Exp_VM003=F
CHK_Exp_VM005=F
CHK_Exp_VM006=F
CHK_Exp_VM007=F
CHK_Exp_VM008=F
CHK_Exp_VM009=F
CHK_Exp_VM010=F

CHK_Exp_AP000=T
CHK_Exp_AP001=T
CHK_Exp_AP002=T
CHK_Exp_AP003=T
CHK_Exp_AP004=T
CHK_Exp_AP006=F
CHK_Exp_AP014=F

COMM
DO UU001_Exp_AP_HIST

COMM *** delete tmp files and relations ***
DO AE003_Del_Tmp

COMM *** migrate all AP00x results into Hist1_AP00x RESULTSIZE
SET FOLDER /%fld_Tmps%

IF FILESIZE("%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr.fil")>0 OPEN AP001_Dup_Amt_Dt_Inv_Vndr
IF FILESIZE("%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr.fil")>0 EXTRACT FIELDS ALL TO TMP_AP001_Amt_Dt_Inv_Vndr

IF FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil")>0 OPEN AP002_Dup_Amt_Inv_Vndr
IF FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil")>0 EXTRACT FIELDS ALL TO TMP_AP002_Dup_Amt_Inv_Vndr

IF FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil")>0 OPEN AP003_Dup_Amt_Dt_Inv
IF FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil")>0 EXTRACT FIELDS ALL TO TMP_AP003_Dup_Amt_Dt_Inv

IF FILESIZE("%fld_Results%AP004_Dup_Amt_Dt_Vndr.fil")>0 OPEN AP004_Dup_Amt_Dt_Vndr
IF FILESIZE("%fld_Results%AP004_Dup_Amt_Dt_Vndr.fil")>0 EXTRACT FIELDS ALL TO TMP_AP004_Dup_Amt_Dt_Vndr

CLOSE

SET SESSION



^BATCH    CA001_VM_Historical1               
[PARENT_FOLDER_ID] 1455776720
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION FOR CCM (Caseware, task scheduler)
COMM *** Historical Data for VM 
COMM *** Single bucket contains all historical results for Vendor Master
COMM *** Prior to 30 June 2015 - Import Datafiles and perform the following Tests for Vendor Master Historicals
COMM *** VM001_Dup_Vnd_BankAcc
COMM *** VM002_Dup_Vnd_ABN
COMM *** VM003_Dup_Vnd_Add
COMM *** VM005_Dup_Vnd_Name
COMM *** VM006_Mis_Details
COMM *** VM007_Invld_Frmt_ABN
COMM *** VM008_Can_ABN
COMM *** VM009_Invld_ABN_ABR
COMM *** VM010_DeReg_GST
COMM***************************************************************************


SET SAFETY OFF
DO AA002_Variable_Setting
SET SESSION CA001_VM_Historical1

COMM *** remove the dialog or pause when runing the jobs in automation mode***
v_CCMJob="COMMENT"

SET DATE "YYYYMMDD"

F_Append=T
COMM
DO CA003_RunABNChecker

COMM *** AP Historical  ***

_Data_Range_To=ALLTRIM(DATE(`20150811`,"DD/MM/YYYY" )) 
_Data_Range_From=ALLTRIM(DATE(`20000101`,"DD/MM/YYYY"))

COMM *** VM Historical before 12 Aug 2015 ***

_Data_Range_To_VM=ALLTRIM(DATE(`20150630`,"DD/MM/YYYY" )) 
_Data_Range_From_VM=ALLTRIM(DATE(`20000101`,"DD/MM/YYYY"))

COMM
DO CB001_Extract_APVM

COMM ***via ODBC: Import related fields for the feed of the ACL Tests ***
COMM
DO CB001_Imp_AP_VM

COMM *** Prepare the data and do the conversion ***

DO CB002_Pre_APVM_Hist

COMM *** get excel mapping table ***

Errmsg=""
DM_Flag=F
DO LE003_Imp_Mapping

COMM *** Convert Source data into ACL application ***

DO MP001_Convert_VMF
DO MP002_Convert_AP
DO MZ003_Com_VndEmp

COMM *** delete all temperary tables ***

DO AE003_Del_Tmp
CLOSE PRIMARY SECONDARY

COMM Now Produce Results for AP Tests

DO AA002_Variable_Setting

COMM *** Prepare variables ***
v_Exc_GreyList=T

COMM *** Execute tests ***

v_Exc_History=T
DO VM001_Dup_Vnd_BankAcc
DO VM002_Dup_Vnd_ABN
DO VM003_Dup_Vnd_Add
DO VM005_Dup_Vnd_Name
DO VM006_Mis_Details
DO VM007_Invld_Frmt_ABN
DO VM008_Can_ABN
DO VM009_Invld_ABN_ABR
DO VM010_DeReg_GST

COMM *** migrate all VM00x results into Hist1_VM00x RESULTS
SET FOLDER /%fld_Results%

IF FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil")>0 OPEN VM001_Dup_Vnd_BankAcc
IF FILESIZE("%fld_Results%VM001_Dup_Vnd_BankAcc.fil")>0 EXTRACT FIELDS ALL TO HIST1_VM001_Dup_Vnd_BankAcc
IF FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil")>0 OPEN VM002_Dup_Vnd_ABN
IF FILESIZE("%fld_Results%VM002_Dup_Vnd_ABN.fil")>0 EXTRACT FIELDS ALL TO HIST1_VM002_Dup_Vnd_ABN
IF FILESIZE("%fld_Results%VM003_Dup_Vnd_Add.fil")>0 OPEN VM003_Dup_Vnd_Add
IF FILESIZE("%fld_Results%VM003_Dup_Vnd_Add.fil")>0 EXTRACT FIELDS ALL TO HIST1_VM003_Dup_Vnd_Add
IF FILESIZE("%fld_Results%VM005_Dup_Vnd_Name.fil")>0 OPEN VM005_Dup_Vnd_Name
IF FILESIZE("%fld_Results%VM005_Dup_Vnd_Name.fil")>0 EXTRACT FIELDS ALL TO HIST1_VM005_Dup_Vnd_Name
IF FILESIZE("%fld_Results%VM005_Dup_Vnd_Name.fil")>0 OPEN VM005_Dup_Vnd_Name
IF FILESIZE("%fld_Results%VM005_Dup_Vnd_Name.fil")>0 EXTRACT FIELDS ALL TO HIST1_VM005_Dup_Vnd_Name
IF FILESIZE("%fld_Results%VM006_Mis_Details.fil")>=0 OPEN VM006_Mis_Details
IF FILESIZE("%fld_Results%VM006_Mis_Details.fil")>=0 EXTRACT FIELDS ALL TO HIST1_VM006_Mis_Details
IF FILESIZE("%fld_Results%VM006D_Mis_Details.fil")>=0 OPEN VM006D_Mis_Details
IF FILESIZE("%fld_Results%VM006D_Mis_Details.fil")>=0 EXTRACT FIELDS ALL TO HIST1_VM006D_Mis_Details
IF FILESIZE("%fld_Results%VM007_Invld_Frmt_ABN.fil")>=0 OPEN VM007_Invld_Frmt_ABN
IF FILESIZE("%fld_Results%VM007_Invld_Frmt_ABN.fil")>=0 EXTRACT FIELDS ALL TO HIST1_VM007_Invld_Frmt_ABN
IF FILESIZE("%fld_Results%VM007D_Invld_Frmt_ABN.fil")>=0 OPEN VM007D_Invld_Frmt_ABN
IF FILESIZE("%fld_Results%VM007D_Invld_Frmt_ABN.fil")>=0 EXTRACT FIELDS ALL TO HIST1_VM007D_Invld_Frmt_ABN
IF FILESIZE("%fld_Results%VM008_Can_ABN.fil")>=0 OPEN VM008_Can_ABN
IF FILESIZE("%fld_Results%VM008_Can_ABN.fil")>=0 EXTRACT FIELDS ALL TO HIST1_VM008_Can_ABN
IF FILESIZE("%fld_Results%VM008D_Can_ABN.fil")>=0 OPEN VM008D_Can_ABN
IF FILESIZE("%fld_Results%VM008D_Can_ABN.fil")>=0 EXTRACT FIELDS ALL TO HIST1_VM008D_Can_ABN
IF FILESIZE("%fld_Results%VM008Z_Can_ABN_Sum.fil")>=0 OPEN VM008Z_Can_ABN_Sum
IF FILESIZE("%fld_Results%VM008Z_Can_ABN_Sum.fil")>=0 EXTRACT FIELDS ALL TO HIST1_VM008Z_Can_ABN_Sum
IF FILESIZE("%fld_Results%VM009_Invld_ABN_ABR.fil")>=0 OPEN VM009_Invld_ABN_ABR
IF FILESIZE("%fld_Results%VM009_Invld_ABN_ABR.fil")>=0 EXTRACT FIELDS ALL TO HIST1_VM009_Invld_ABN_ABR
IF FILESIZE("%fld_Results%VM009D_Invld_ABN_ABR.fil")>=0 OPEN VM009D_Invld_ABN_ABR
IF FILESIZE("%fld_Results%VM009D_Invld_ABN_ABR.fil")>=0 EXTRACT FIELDS ALL TO HIST1_VM009D_Invld_ABN_ABR
IF FILESIZE("%fld_Results%VM010_DeReg_GST.fil")>=0 OPEN VM010_DeReg_GST
IF FILESIZE("%fld_Results%VM010_DeReg_GST.fil")>=0 EXTRACT FIELDS ALL TO HIST1_VM010_DeReg_GST
IF FILESIZE("%fld_Results%VM010D_DeReg_GST.fil")>=0 OPEN VM010D_DeReg_GST
IF FILESIZE("%fld_Results%VM010D_DeReg_GST.fil")>=0 EXTRACT FIELDS ALL TO HIST1_VM010D_DeReg_GST
IF FILESIZE("%fld_Results%VM010D_DeReg_GST_Sum.FIL")>=0 OPEN VM010D_DeReg_GST_Sum
IF FILESIZE("%fld_Results%VM010D_DeReg_GST_Sum.FIL")>=0 EXTRACT FIELDS ALL TO HIST1_VM010D_DeReg_GST_Sum

COMM Create Relations for HIST1_VM001 
OPEN HIST1_VM001_Dup_Vnd_BankAcc
DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum INDEX IDX_AP_Sum_VndrID

OPEN HIST1_VM001_Dup_Vnd_BankAcc 
DELETE FIELD cVndrSiteVndrID OK

DEFINE FIELD cVndrSiteVndrID           COMPUTED  SUBSTR(ALLTRIM(Vndr_Site_ID),1,20)
DEFINE RELATION cVndrSiteVndrID  WITH VMF_BnkAcc INDEX IDX_BnkAcc

COMM Create Relations for HIST1_VM002
OPEN HIST1_VM002_Dup_Vnd_ABN
DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum IDX_AP_Sum_VndrID

COMM Create Relations for HIST1_VM003
OPEN HIST1_VM003_Dup_Vnd_Add
DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum INDEX IDX_AP_Sum_VndrID

COMM Create Relations for HIST1_VM005
OPEN HIST1_VM005_Dup_Vnd_Name
DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum IDX_AP_Sum_VndrID

COMM Create Relations for HIST1_VM006 
 
OPEN VMF_BnkAcc
INDEX ON SUBSTR(ALLTRIM(Vndr_Site_ID),1,20)  TO IDX_BK_VndrSiteID1
OPEN HIST1_VM006_Mis_Details
INDEX ON Vndr_Site_ID TO IDX_HVM006_VndrSiteID
OPEN HIST1_VM006_Mis_Details
DEFINE RELATION SUBST(ALLTRIM(Vndr_Site_ID),1,20) WITH VMF_BnkAcc INDEX IDX_BK_VndrSiteID1
DEFINE RELATION Vndr_ID WITH AP_Vnd_InvGst_Sum IDX_AP_Sum_VndrID
OPEN HIST1_VM006_Mis_Details
OPEN HIST1_VM006D_Mis_Details
DEFINE RELATION Vndr_Site_ID WITH HIST1_VM006_Mis_Details INDEX IDX_HVM006_VndrSiteID

COMM Create Relations forHIST1_VM008

OPEN HIST1_VM008Z_Can_ABN_Sum
INDEX ON Vndr_Site_ID TO IDX_HVM008Z_VndrSiteID
OPEN HIST1_VM008_Can_ABN
INDEX ON Vndr_Site_ID TO IDX_HVM008_VndrSiteID
DEFINE RELATION Vndr_Site_ID WITH HIST1_VM008Z_Can_ABN_Sum INDEX IDX_HVM008Z_VndrSiteID

COMM Create Relations for HIST1_VM010

OPEN HIST1_VM010D_DeReg_GST_Sum
INDEX ON Vndr_Site_ID TO IDX_HVM010D_Sum_VndrSiteID
OPEN HIST1_VM010_DeReg_GST
INDEX ON Vndr_Site_ID TO IDX_HVM010_VndrSiteID
DEFINE RELATION Vndr_Site_ID WITH HIST1_VM010D_DeReg_GST_Sum INDEX IDX_HVM010D_Sum_VndrSiteID
OPEN HIST1_VM010D_DeReg_GST
DEFINE RELATION Vndr_Site_ID WITH HIST1_VM010_DeReg_GST INDEX IDX_HVM010_VndrSiteID

DEFINE RELATION Vndr_Site_ID WITH HIST1_VM010D_DeReg_GST_Sum INDEX IDX_HVM010D_Sum_VndrSiteID
    


COMM *** Invoice Details ***
COMM
TXT_Exp_filepath="Reports\"

COMM *** Export the file into xml format without suffix ***
COMM
rad1=5
suffix=""

COMM
v_CW=""
DO UZ006_CHK_Exp_F
CHK_Exp_VM001=T
CHK_Exp_VM002=T
CHK_Exp_VM003=T
CHK_Exp_VM005=T
CHK_Exp_VM006=T
CHK_Exp_VM007=T
CHK_Exp_VM008=T
CHK_Exp_VM009=T
CHK_Exp_VM010=T

COMM
CHK_Exp_AP000=T
CHK_Exp_AP001=T
CHK_Exp_AP002=T
CHK_Exp_AP003=T
CHK_Exp_AP004=T
CHK_Exp_AP006=F
CHK_Exp_AP014=F
COMM
DO UU001_Export

COMM *** delete tmp files and relations ***
DO AE003_Del_Tmp
CLOSE

SET SESSION
COMM
QUIT

^BATCH    CC002_RunPR_Fornightly             
[PARENT_FOLDER_ID] 1455776720
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION FOR CCM (Caseware, task scheduler)
COMM *** Execute EMP & PR tests -Fortnightly
COMM *** Created by Nancy Li (0431 057 135) on 12/01/2015
COMM***************************************************************************

SET SAFETY OFF
SET SESSION CA007_RunPR_Fortnightly

DO AA002_Variable_Setting

COMM *** Prepare variables ***
v_Exc_GreyList=T

COMM *** Execute tests ***
v_Exc_History=T
DO PR001_Mul_Paid
DO PR002_Not_in_Emf
DO PR003_Pay_30D_Af_Trm
DO PR009_Pay_x_Times_Avg


COMM *** created the sub archive folder to archive the old PMT file***
TXT_Exp_filepath="Reports\PRF_"+ALLTRIM(DATETIME(_RptRunDate,'YYYYMMDD'))+"\"
OPEN EMF_Emp_Master_File
LOCATE RECORD 1
CLASSIFY ON EMP_Sts TO GRAPH
SAVE GRAPH to "%TXT_Exp_filepath%tmp.bmp"
DELETE "%TXT_Exp_filepath%tmp.bmp" OK

COMM *** Export the file into delimited or access files 1: Access; 4: delimited; 2: Excel***
rad1=4

v_CW=""
DO UZ006_CHK_Exp_F
CHK_Exp_PR001=T
CHK_Exp_PR002=T
CHK_Exp_PR003=T
CHK_Exp_PR009=T

DO UU001_Export

COMM *** delete tmp files and relations ***
DO AE003_Del_Tmp
CLOSE

SET SESSION

%v_AppCWM% QUIT
^BATCH    CCM01_WeeklyTestVM                 
[PARENT_FOLDER_ID] 1455776720

COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION FOR CCM (Caseware, task scheduler)
COMM *** DELWP - Run all in a single process - from import until report generation
COMM *** Created by Alvin Anwar (02) 9667 3866
COMM***************************************************************************

SET SAFETY OFF

v_CCMJob = "COMMENT "
DO CA001_ImpPreData_AP

DO CA003_RunABNChecker

COMM *** Prepare variables ***
v_Exc_GreyList=T

COMM *** Execute tests ***
v_Exc_History=T

TXT_AP014_Months="18"


DO VM001_Dup_Vnd_BankAcc
DO VM002_Dup_Vnd_ABN
DO VM003_Dup_Vnd_Add
DO VM005_Dup_Vnd_Name
DO VM006_Mis_Details
DO VM007_Invld_Frmt_ABN
DO VM008_Can_ABN
DO VM009_Invld_ABN_ABR

COMM
DO VM010_DeReg_GST
DO AP000_Dup_All_123
DO AP004_Dup_Amt_Dt_Vndr
DO AP006_Pay_Not_In_VMF
DO AP014_No_Trans_xx_Mon

TXT_Exp_filepath="Reports\"


COMM *** Export the file into xml format without suffix ***
rad1=5
suffix=""
v_CW=""

DO UZ006_CHK_Exp_F

CHK_Exp_VM001=T
CHK_Exp_VM002=T
CHK_Exp_VM003=T
CHK_Exp_VM005=T
CHK_Exp_VM006=T
CHK_Exp_VM007=T
CHK_Exp_VM008=T
CHK_Exp_VM009=T
CHK_Exp_VM010=F

CHK_Exp_AP000=F
CHK_Exp_AP001=F
CHK_Exp_AP002=F
CHK_Exp_AP003=F
CHK_Exp_AP004=F
CHK_Exp_AP006=F
CHK_Exp_AP014=F

DO UU001_Export

COMM *** delete tmp files and relations ***
DO AE003_Del_Tmp


QUIT
^BATCH    CA001_ImpPreData_APVM_HIST2        
[PARENT_FOLDER_ID] 1455776720

COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION FOR CCM (Caseware, task scheduler)
COMM *** Prepare the data for the mapping/conversion 
COMM *** Created by Nancy Li (0431 057 135) on 20/03/2015
COMM***************************************************************************

SET SAFETY OFF
DO AA002_Variable_Setting

COMM *** remove the dialog or pause when runing the jobs in automation mode***
v_CCMJob="COMMENT"

SET DATE "YYYYMMDD"

F_Append=T

COMM *** AP Historical Bucket 2 from 1 April 2015 to 20 July 2015 ***
_Data_Range_To=ALLTRIM(DATE(`20150720`,"DD/MM/YYYY" )) 
_Data_Range_From=ALLTRIM(DATE(`20150401`,"DD/MM/YYYY"))

COMM *** VM Historical Bucket 1 before 1 July 2015 ***
_Data_Range_To_VM=ALLTRIM(DATE(`20150630`,"DD/MM/YYYY" )) 
_Data_Range_From_VM=ALLTRIM(DATE(`19000101`,"DD/MM/YYYY"))

COMM
DO CB001_Extract_APVM

COMM ***via ODBC: Import related fields for the feed of the ACL Tests ***
COMM
DO CB001_Imp_AP_VM

COMM *** Prepare the data and do the convertion ***
DO CB002_Pre_AP_VM

COMM *** get excel mapping table ***
Errmsg=""
DM_Flag=F
DO LE003_Imp_Mapping

COMM *** Convert Source data into ACL application ***
DO MP001_Convert_VMF

DO MP002_Convert_AP

DO MZ003_Com_VndEmp

COMM *** delete all temperary tables ***
DO AE003_Del_Tmp

CLOSE PRIMARY SECONDARY

QUIT
^BATCH    Script_AP002_HIST                  
[PARENT_FOLDER_ID] 1455776720

COMM
open AP002_History
EXTRACT ALL TO "%fld_History%TEST_AP002_History.FIL" OPEN

COMM
EXTRACT FIELDS Flag	DUP_KEY	CREDIT_KEY	Vndr_Site_ID	Vndr_ID	Vchr_ID	ABS_INVAMT	isPaid	Doc_Typ	Inv_Dt	Inv_No	Inv_Amt	Inv_Amt_Doc	Curncy	Inv_Net_Amt	GST_Amt	Btch_No	Due_Dt	PO_No	PO_Net_Amt	Descrp	Pd_Dt	Pymnt_Trms	Modf_By	Modf_Dt	Pst_Dt	Ex_Rate	VOIDED	Void_Dt	Num_Field1	Num_Field2	Num_Field3	Num_Field4	Num_Field5	Dt_Field1	Dt_Field2	Dt_Field3	Cha_Field1	Cha_Field2	Cha_Field3	Cha_Field4	Cha_Field5	c_Inv_No	c_Inv_Dt	Vndr_Mstr_ID	Vndr_Nme	Vndr_Sts	Vndr_Typ	ABS_INVAMT	RANK	ID_KEY	SORT_KEY SORT_KEY_DESC Priority	RptRunDate Data_Range_Start_Date	Data_Range_End_Date TO "%fld_History%TEST_AP002_History.FIL"



OPEN zHIST1_AP002_Dup_Amt_Inv_Vndr
DEFINE FIELD c_SORT_KEY COMPUTED SUBSTR(ZONED(ABS_INVAMT ,21) +"~"+ ALLTRIM(Flag) +"~"+ ALLTRIM(Vndr_ID) +"~"+ ALLTRIM(c_Inv_Dt),1,80)


EXTRACT FIELDS Flag	DUP_KEY	CREDIT_KEY	Vndr_Site_ID	Vndr_ID	Vchr_ID	ABS_INVAMT	isPaid	Doc_Typ	Inv_Dt	Inv_No	Inv_Amt	Inv_Amt_Doc	Curncy	Inv_Net_Amt	GST_Amt	Btch_No	Due_Dt	PO_No	PO_Net_Amt	Descrp	Pd_Dt	Pymnt_Trms	Modf_By	Modf_Dt	Pst_Dt	Ex_Rate	VOIDED	Void_Dt	Num_Field1	Num_Field2	Num_Field3	Num_Field4	Num_Field5	Dt_Field1	Dt_Field2	Dt_Field3	Cha_Field1	Cha_Field2	Cha_Field3	Cha_Field4	Cha_Field5	c_Inv_No	c_Inv_Dt	Vndr_Mstr_ID	Vndr_Nme	Vndr_Sts	Vndr_Typ	RANK	ID_KEY 	c_SORT_KEY SORT_KEY_DESC Priority	RptRunDate	Data_Range_Start_Date	Data_Range_End_Date  TO "%fld_History%AP002_History.FIL" APPEND 


open AP002_History 
COMM
open AP001_History
"%fld_History%AP001_History.FIL"

COMM
OPEN TEST

^BATCH    Script_AP003_HIST                  
[PARENT_FOLDER_ID] 1455776720

COMM
open AP003_History
EXTRACT ALL TO "%fld_History%TEST_AP003_History.FIL" OPEN

COMM
EXTRACT FIELDS Flag	DUP_KEY	CREDIT_KEY	Vndr_Site_ID	Vndr_ID	Vchr_ID	ABS_INVAMT	isPaid	Doc_Typ	Inv_Dt	Inv_No	Inv_Amt	Inv_Amt_Doc	Curncy	Inv_Net_Amt	GST_Amt	Btch_No	Due_Dt	PO_No	PO_Net_Amt	Descrp	Pd_Dt	Pymnt_Trms	Modf_By	Modf_Dt	Pst_Dt	Ex_Rate	VOIDED	Void_Dt	Num_Field1	Num_Field2	Num_Field3	Num_Field4	Num_Field5	Dt_Field1	Dt_Field2	Dt_Field3	Cha_Field1	Cha_Field2	Cha_Field3	Cha_Field4	Cha_Field5	c_Inv_No	c_Inv_Dt	Vndr_Mstr_ID	Vndr_Nme	Vndr_Sts	Vndr_Typ	ABS_INVAMT	RANK	ID_KEY	SORT_KEY SORT_KEY_DESC Priority	RptRunDate Data_Range_Start_Date	Data_Range_End_Date TO "%fld_History%TEST_AP003_History.FIL"



OPEN zHIST1_AP003_Dup_Amt_Dt_Inv
DEFINE FIELD c_SORT_KEY COMPUTED SUBSTR(ZONED(ABS_INVAMT ,21) +"~"+ ALLTRIM(Flag) +"~"+ ALLTRIM(Vndr_ID) +"~"+ ALLTRIM(c_Inv_Dt),1,80)


EXTRACT FIELDS Flag	DUP_KEY	CREDIT_KEY	Vndr_Site_ID	Vndr_ID	Vchr_ID	ABS_INVAMT	isPaid	Doc_Typ	Inv_Dt	Inv_No	Inv_Amt	Inv_Amt_Doc	Curncy	Inv_Net_Amt	GST_Amt	Btch_No	Due_Dt	PO_No	PO_Net_Amt	Descrp	Pd_Dt	Pymnt_Trms	Modf_By	Modf_Dt	Pst_Dt	Ex_Rate	VOIDED	Void_Dt	Num_Field1	Num_Field2	Num_Field3	Num_Field4	Num_Field5	Dt_Field1	Dt_Field2	Dt_Field3	Cha_Field1	Cha_Field2	Cha_Field3	Cha_Field4	Cha_Field5	c_Inv_No	c_Inv_Dt	Vndr_Mstr_ID	Vndr_Nme	Vndr_Sts	Vndr_Typ	RANK	ID_KEY 	c_SORT_KEY SORT_KEY_DESC Priority	RptRunDate	Data_Range_Start_Date	Data_Range_End_Date  TO "%fld_History%AP003_History.FIL" APPEND 


open AP003_History 
COMM
open AP001_History
"%fld_History%AP001_History.FIL"

COMM
OPEN TEST

^BATCH    CA001_AP_Historical2               
[PARENT_FOLDER_ID] 1455776720
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION FOR CCM (Caseware, task scheduler)
COMM *** Historical Data for AP 
COMM *** Single bucket (only AP001  AP004): contains all historical result  
COMM *** Prior to Aug 2015 - Import and Historicals for AP - Single import and Historical AP001-AP004 Tests
COMM***************************************************************************

SET SAFETY OFF
SET SESSION CA001_AP_Historical2

DO AA002_Variable_Setting

COMM *** remove the dialog or pause when runing the jobs in automation mode***
v_CCMJob="COMMENT"

SET DATE "YYYYMMDD"

F_Append=T



COMM *** AP historical bucket2
_Data_Range_To=ALLTRIM(DATE(`20150720`,"DD/MM/YYYY" )) 
_Data_Range_From=ALLTRIM(DATE(`20001001`,"DD/MM/YYYY"))


DO CB001_Extract_APVM

COMM ***via flat files : Import related fields for the feed of the ACL Tests ***

DO CB001_Imp_AP_VM

COMM *** Prepare the data and do the convertion ***
DO CB002_Pre_APVM_Hist

COMM *** get excel mapping table ***
Errmsg=""
DM_Flag=F
DO LE003_Imp_Mapping

COMM *** Convert Source data into ACL application ***
DO MP001_Convert_VMF

DO MP002_Convert_AP

DO MZ003_Com_VndEmp

COMM *** delete all temperary tables ***
DO AE003_Del_Tmp

CLOSE PRIMARY SECONDARY

COMM Now Produce Results for AP Tests

DO AA002_Variable_Setting

COMM *** Prepare variables ***
v_Exc_GreyList=T

COMM *** Execute tests ***
v_Exc_History=T

COMM Assign TXT_AP014_Months = 18
TXT_AP014_Months="18"

DO AP000_Dup_All_123
DO AP004_Dup_Amt_Dt_Vndr



COMM *** created the sub archive folder to archive the old PMT file***
COMM
TXT_Exp_filepath="Reports\APW_"+ALLTRIM(DATETIME(_RptRunDate,'YYYYMMDD'))+"\"

TXT_Exp_filepath="Reports\"


COMM *** Export the file into xml format without suffix ***
rad1=5
suffix=""

v_CW=""
DO UZ006_CHK_Exp_F
CHK_Exp_VM001=F
CHK_Exp_VM002=F
CHK_Exp_VM003=F
CHK_Exp_VM005=F
CHK_Exp_VM006=F
CHK_Exp_VM007=F
CHK_Exp_VM008=F
CHK_Exp_VM009=F
CHK_Exp_VM010=F

CHK_Exp_AP000=T
CHK_Exp_AP001=T
CHK_Exp_AP002=T
CHK_Exp_AP003=T
CHK_Exp_AP004=T
CHK_Exp_AP006=F
CHK_Exp_AP014=F

DO UU001_Exp_AP_HIST2

COMM *** delete tmp files and relations ***
DO AE003_Del_Tmp

COMM *** migrate all AP00x results into Hist1_AP00x RESULTSIZE
SET FOLDER /%fld_Results%

IF FILESIZE("%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr.fil")>0 OPEN AP001_Dup_Amt_Dt_Inv_Vndr
IF FILESIZE("%fld_Results%AP001_Dup_Amt_Dt_Inv_Vndr.fil")>0 EXTRACT FIELDS ALL TO TMP_AP001_Amt_Dt_Inv_Vndr

IF FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil")>0 OPEN AP002_Dup_Amt_Inv_Vndr
IF FILESIZE("%fld_Results%AP002_Dup_Amt_Inv_Vndr.fil")>0 EXTRACT FIELDS ALL TO TMP_AP002_Dup_Amt_Inv_Vndr

IF FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil")>0 OPEN AP003_Dup_Amt_Dt_Inv
IF FILESIZE("%fld_Results%AP003_Dup_Amt_Dt_Inv.fil")>0 EXTRACT FIELDS ALL TO TMP_AP003_Dup_Amt_Dt_Inv

IF FILESIZE("%fld_Results%AP004_Dup_Amt_Dt_Vndr.fil")>0 OPEN AP004_Dup_Amt_Dt_Vndr
IF FILESIZE("%fld_Results%AP004_Dup_Amt_Dt_Vndr.fil")>0 EXTRACT FIELDS ALL TO TMP_AP004_Dup_Amt_Dt_Vndr

COMM *** EXCLUDE FROM HIST2 all results that exist in HIST1

OPEN TMP_AP001_Amt_Dt_Inv_Vndr
OPEN zHIST1_AP001_Dup_Amt_Dt_Inv_Vndr SECONDARY
JOIN PKEY DUP_KEY FIELDS ALL SKEY DUP_KEY UNMATCHED TO "HIST2_AP001_Amt_Dt_Inv_Vndr" OPEN PRESORT SECSORT
OPEN TMP_AP002_Dup_Amt_Inv_Vndr
OPEN zHIST1_AP002_Dup_Amt_Inv_Vndr SECONDARY
JOIN PKEY DUP_KEY FIELDS ALL SKEY DUP_KEY UNMATCHED TO "HIST2_AP002_Dup_Amt_Inv_Vndr" OPEN PRESORT SECSORT
OPEN TMP_AP003_Dup_Amt_Dt_Inv
OPEN zHIST1_AP003_Dup_Amt_Dt_Inv SECONDARY
JOIN PKEY DUP_KEY FIELDS ALL SKEY DUP_KEY UNMATCHED TO "HIST2_AP003_Dup_Amt_Dt_Inv" OPEN PRESORT SECSORT
OPEN TMP_AP004_Dup_Amt_Dt_Vndr
OPEN zHIST1_AP004_Dup_Amt_Dt_Vndr SECONDARY
JOIN PKEY DUP_KEY FIELDS ALL SKEY DUP_KEY UNMATCHED TO "HIST2_AP004_Dup_Amt_Dt_Vndr" OPEN PRESORT SECSORT


COMM run CX_Export_HIST1_AP

COMM then run CX_Export_HIST2_AP


CLOSE

SET SESSION



^BATCH    CC004_RunPR_Quarterly              
[PARENT_FOLDER_ID] 1455776720
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION FOR CCM (Caseware, task scheduler)
COMM *** Execute EMP & PR tests -monthly
COMM *** Created by Nancy Li (0431 057 135) on 12/01/2015
COMM***************************************************************************

SET SAFETY OFF
SET SESSION CA008_RunPR_Monthly

DO AA002_Variable_Setting

COMM *** Prepare variables ***
v_Exc_GreyList=T

COMM *** Execute tests ***
v_Exc_History=T
DO EM012_DOB_Valid

v_Exc_History=F
DO EM015_Not_Taken_Leave
DO EM016_Neg_SickLv

v_Exc_History=F
DO VM014_VndEmp_BankAcct
DO VM015_VndEmp_Add
DO VM016_VndEmp_Tel

COMM *** created the sub archive folder to archive the old PMT file***
TXT_Exp_filepath="Reports\PRM_"+ALLTRIM(DATETIME(_RptRunDate,'YYYYMMDD'))+"\"
OPEN EMF_Emp_Master_File
LOCATE RECORD 1
CLASSIFY ON EMP_Sts TO GRAPH
SAVE GRAPH to "%TXT_Exp_filepath%tmp.bmp"
DELETE "%TXT_Exp_filepath%tmp.bmp" OK

COMM *** Export the file into delimited or access files 1: Access; 4: delimited; 2: Excel***
rad1=4

v_CW=""
DO UZ006_CHK_Exp_F
CHK_Exp_EM012=T
CHK_Exp_EM015=T
CHK_Exp_EM016=T
CHK_Exp_VM014=T
CHK_Exp_VM015=T
CHK_Exp_VM016=T

DO UU001_Export

COMM *** delete tmp files and relations ***
DO AE003_Del_Tmp
CLOSE

SET SESSION

%v_AppCWM% QUIT
^BATCH    CA003_RunABNChecker                
[PARENT_FOLDER_ID] 1455776720
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION FOR CCM (Caseware, task scheduler)
COMM *** Run ABN Checker to update the ABN status from ABR websit 
COMM *** Created by Nancy Li (0431 057 135) on 12/01/2015
COMM***************************************************************************

IF FTYPE("fld_ABN")="U" OR FTYPE("v_App_Path")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Workings%

COMM *** check the filesize of ABN_ASIC.TXT, to make sure the user have run ABN Checker first***
%v_CCMJob% IF FILESIZE("%fld_ABN%ABN.TXT")<=0 PAUSE "Please make sure you have imported the data and converted the source data into Fraud Module."
IF FILESIZE("%fld_ABN%ABN.TXT")<=0 ESCAPE

COMM
%v_CCMJob% PAUSE "It will take a while (e.g. 2-4hours). Please wait until the ABN Lookup finished, and then run next step to execute the tests"

COMM EXECUTE '%v_ABNChecker_Path%App\ABNLookup.exe' 
EXECUTE '%v_ABNChecker_Path%ABNLookupService' 

COMM QUIT
^BATCH    CC003_RunPR_Monthly                
[PARENT_FOLDER_ID] 1455776720
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION FOR CCM (Caseware, task scheduler)
COMM *** Execute EMP & PR tests -monthly
COMM *** Created by Nancy Li (0431 057 135) on 12/01/2015
COMM***************************************************************************

SET SAFETY OFF
SET SESSION CA008_RunPR_Monthly

DO AA002_Variable_Setting

COMM *** Prepare variables ***
v_Exc_GreyList=T

COMM *** Execute tests ***
v_Exc_History=T
DO EM012_DOB_Valid

v_Exc_History=F
DO EM015_Not_Taken_Leave
DO EM016_Neg_SickLv

v_Exc_History=F
DO VM014_VndEmp_BankAcct
DO VM015_VndEmp_Add
DO VM016_VndEmp_Tel

COMM *** created the sub archive folder to archive the old PMT file***
TXT_Exp_filepath="Reports\PRM_"+ALLTRIM(DATETIME(_RptRunDate,'YYYYMMDD'))+"\"
OPEN EMF_Emp_Master_File
LOCATE RECORD 1
CLASSIFY ON EMP_Sts TO GRAPH
SAVE GRAPH to "%TXT_Exp_filepath%tmp.bmp"
DELETE "%TXT_Exp_filepath%tmp.bmp" OK

COMM *** Export the file into delimited or access files 1: Access; 4: delimited; 2: Excel***
rad1=4

v_CW=""
DO UZ006_CHK_Exp_F
CHK_Exp_EM012=T
CHK_Exp_EM015=T
CHK_Exp_EM016=T
CHK_Exp_VM014=T
CHK_Exp_VM015=T
CHK_Exp_VM016=T

DO UU001_Export

COMM *** delete tmp files and relations ***
DO AE003_Del_Tmp
CLOSE

SET SESSION

%v_AppCWM% QUIT
^BATCH    CL001_Load_VMF_Hist                
[PARENT_FOLDER_ID] 1455776720
COMMENT load just the Vendor Master table that have the site and last updated DATE

^BATCH    CZ002_Histogram_CtlCheck           
[PARENT_FOLDER_ID] 1455776720
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Create and send histogram of the tables created by the previous scripts on the data importing and preparation
COMM *** Find out the date gaps on transactional tables
COMM *** will run this after the souces have been converted into ACL standard tables
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 20/03/2015
COMM***************************************************************************

SET SESSION AA001_Main_Menu
SET SAFETY OFF
IF FTYPE("_Version")="v" OR FTYPE("_Version")="U" OR FTYPE("fld_Sources")="U" OR FTYPE("fld_DataMapping")="U" DO AA002_Variable_Setting

v_Server_eMail="mailrelay.newcrest.com.au"
v_Sender_eMail="AX-Prd@newcrest.com.au"
v_recipient_email = "satorialerts@satorigroup.com.au"
v_check_Today = ALL(DATE(TODAY(),"YYYYMMDD"))
v_check_File      = '"Histogram_CtlCheck_%v_check_Today%.txt"'
v_check_File_copy = '"%fld_Logs%Histogram_CtlCheck_%v_check_Today%.txt"'

CLOSE
COMM *** create dummy file for the open ***
DIR "*.ACL" TO "TMP1"
OPEN TMP1 

COMM run histogram and check date gaps on Invoices
v_cmtAP=""
IF FTYPE("AP_Invoices")="U" OR FILESIZE("%fld_Workings%AP_Invoices.fil")<=0 v_cmtAP="COMMENT"

%v_cmtAP% OPEN AP_Invoices
%v_cmtAP% LIST UNF "AP_Invoices %v_check_today%" TO %v_check_File% APPEND FIRST 1
%v_cmtAP% HISTOGRAM ON ALLTRIM(VMF_Vnd_Master_File.Co) +' :Y ' + ALLTRIM(DATE(Pst_Dt,'YYYY')) + ' :C '+ALLTRIM(DATE(Pst_Dt,'YYYYMM')) TO %v_check_File% APPEND
%v_cmtAP% STATISTICS ON Pst_Dt TO %v_check_File% APPEND
%v_cmtAP% GAPS ON Pst_Dt PRESORT OPEN TO "%fld_Tmps%TMP2.FIL"
%v_cmtAP% OPEN TMP2
%v_cmtAP% DELETE field StartWDate OK
%v_cmtAP% DEFINE FIELD StartWDate COMPUTED  CDOW(GAP_START_EXCLUSIVE,3 )
%v_cmtAP% DELETE field EndWDate OK
%v_cmtAP% DEFINE FIELD EndWDate COMPUTED  CDOW( GAP_END_EXCLUSIVE,3 )
%v_cmtAP% EXPORT FIELDS '*** Gap deteted between ' AS 'GAPDESC' GAP_START_EXCLUSIVE AS 'GAP_START_DATE' ' to ' GAP_END_EXCLUSIVE AS 'GAP_END_DATE' ' (' StartWDate AS 'GAP_END_WDATE' ' to ' EndWDate AS 'GAP_END_WDATE' ') ' NUMBER_ITEMS_MISSING AS 'DAYS_MISSING' TO %v_check_File% APPEND 
%v_cmtAP% LIST UNF "" TO %v_check_File% APPEND FIRST 1
%v_cmtAP% CLOSE PRIMARY

IF v_cmtAP<>"" LIST UNF "AP_Invoices %v_check_today% no record found." TO %v_check_File% APPEND FIRST 1

COMM run histogram and check date gaps on PO Lines
v_cmtPO=""
IF FTYPE("AP_PO_Lines")="U" OR FILESIZE("%fld_Workings%AP_PO_Lines.fil")<=0 v_cmtPO="COMMENT"

%v_cmtPO% OPEN AP_PO_Lines
%v_cmtPO% LIST UNF "AP_PO_Lines %v_check_today%" TO %v_check_File% APPEND FIRST 1
%v_cmtPO% HISTOGRAM ON ALLTRIM(VMF_Vnd_Master_File.Co) +' :Y ' + ALLTRIM(DATE(PO_Date,'YYYY')) + ' :C '+ALLTRIM(DATE(PO_Date,'YYYYMM')) TO %v_check_File% APPEND
%v_cmtPO% STATISTICS ON PO_Date TO %v_check_File% APPEND
%v_cmtPO% GAPS ON PO_Date PRESORT OPEN TO "%fld_Tmps%TMP2.FIL"
%v_cmtPO% OPEN TMP2
%v_cmtPO% DELETE field StartWDate OK
%v_cmtPO% DEFINE FIELD StartWDate COMPUTED  CDOW(GAP_START_EXCLUSIVE,3 )
%v_cmtPO% DELETE field EndWDate OK
%v_cmtPO% DEFINE FIELD EndWDate COMPUTED  CDOW( GAP_END_EXCLUSIVE,3 )
%v_cmtPO% EXPORT FIELDS '*** Gap deteted between ' AS 'GAPDESC' GAP_START_EXCLUSIVE AS 'GAP_START_DATE' ' to ' GAP_END_EXCLUSIVE AS 'GAP_END_DATE' ' (' StartWDate AS 'GAP_END_WDATE' ' to ' EndWDate AS 'GAP_END_WDATE' ') ' NUMBER_ITEMS_MISSING AS 'DAYS_MISSING' TO %v_check_File% APPEND 
%v_cmtPO% LIST UNF "" TO %v_check_File% APPEND FIRST 1
%v_cmtPO% CLOSE PRIMARY

IF v_cmtPO<>"" LIST UNF "AP_PO_Lines %v_check_today% no record found." TO %v_check_File% APPEND FIRST 1

COMM run histogram and check date gaps on Payroll Payments
v_cmtPR=""
IF FTYPE("Payroll_Payments")="U" OR FILESIZE("%fld_Workings%Payroll_Payments.fil")<=0 v_cmtPR="COMMENT"

%v_cmtPR% OPEN Payroll_Payments
%v_cmtPR% LIST UNF "Payroll_Payments %v_check_today%" TO %v_check_File% APPEND FIRST 1
%v_cmtPR% HISTOGRAM ON ALLTRIM(Co) +' :Y ' + ALLTRIM(DATE(Prd_Dt,'YYYY')) + ' :C '+ALLTRIM(DATE(Prd_Dt,'YYYYMM')) TO %v_check_File% APPEND
%v_cmtPR% STATISTICS ON Prd_Dt TO %v_check_File% APPEND
%v_cmtPR% GAPS ON Prd_Dt PRESORT OPEN TO "%fld_Tmps%TMP2.FIL"
%v_cmtPR% OPEN TMP2
%v_cmtPR% DELETE field StartWDate OK
%v_cmtPR% DEFINE FIELD StartWDate COMPUTED  CDOW(GAP_START_EXCLUSIVE,3 )
%v_cmtPR% DELETE field EndWDate OK
%v_cmtPR% DEFINE FIELD EndWDate COMPUTED  CDOW( GAP_END_EXCLUSIVE,3 )
%v_cmtPR% EXPORT FIELDS '*** Gap deteted between ' AS 'GAPDESC' GAP_START_EXCLUSIVE AS 'GAP_START_DATE' ' to ' GAP_END_EXCLUSIVE AS 'GAP_END_DATE' ' (' StartWDate AS 'GAP_END_WDATE' ' to ' EndWDate AS 'GAP_END_WDATE' ') ' NUMBER_ITEMS_MISSING AS 'DAYS_MISSING' TO %v_check_File% APPEND 
%v_cmtPR% LIST UNF "" TO %v_check_File% APPEND FIRST 1
%v_cmtPR% CLOSE PRIMARY

IF v_cmtPR<>"" LIST UNF "Payroll_Payments %v_check_today% no record found." TO %v_check_File% APPEND FIRST 1

COMMENT Copy the file to another folder for safekeeping. Note: the LIST command to have a table open (any table).
OPEN TMP1 
LIST UNF 'copy %v_check_File% %v_check_File_copy%' TO "%fld_Logs%copy.bat" APPEND FIRST 1
EXECUTE "%fld_Logs%copy.bat"

COMM *** send email to NOTIFY***
v_Cmt=""
IF FTYPE("v_Server_eMail")="U" OR FTYPE("v_Sender_eMail")="U" OR FTYPE("v_recipient_email")="U" v_Cmt="COMMENT"
IF ISBLANK(v_Server_eMail) OR ISBLANK(v_Sender_eMail) OR ISBLANK(v_recipient_email) v_Cmt="COMMENT"

%v_Cmt% NOTIFY USER "%v_Sender_Email%" MAILBOX "%v_Server_eMail%"  ADDRESS "%v_recipient_email%" SUBJECT "%_Version% CZ002_Histogram_CtlCheck"  MESSAGE "%_Version% CZ002 Histogram Control Checks on source data" ATTACHMENT  %v_check_File_copy%

CLOSE

DELETE FORMAT TMP1 OK
DELETE "%fld_Tmps%TMP1.FIL" OK
DELETE FORMAT TMP2 OK
DELETE "%fld_Tmps%TMP2.FIL" OK


SET SESSION

%v_AppCWM% QUIT
^BATCH    CD001_RunEAV_All                   
[PARENT_FOLDER_ID] 1455776720
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** EVA Main Menu - run all components in a click/batch
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 20/03/2015
COMM***************************************************************************

SET SAFETY OFF
DO AA002_Variable_Setting

COMM *** import and prepare data ***
DO IA001_Menu

DO LE001_Link_Menu
DO MP001_Convert_VMF
DO MP003_Convert_EMF
DO MP004_Convert_Payroll
DO MP002_Convert_AP
DO MZ003_Com_VndEmp

COMM *** data health control check based on the transactional data ***
DO CZ002_Histogram_CtlCheck

COMM *** ABN Checker***
DO CMF01_ABNChecker

SET SAFETY OFF
COMM *** Execute tests ***

DO VM001_Dup_Vnd_BankAcc
DO VM002_Dup_Vnd_ABN
DO VM007_Invld_Frmt_ABN
DO VM008_Can_ABN
DO VM009_Invld_ABN_ABR
DO VM010_DeReg_GST


DO AP000_Dup_All_123
DO AP004_Dup_Amt_Dt_Vndr
DO AP006_Pay_Not_In_VMF
DO AP007_Not_Reg_GST

DO AP015_Mul_Trans_OneTim_Vnd
DO AP016_Mis_Invld_ABN
DO AP022_Disc_Mis
DO AP023_Disc_Not_Awd

DO EM001_Dup_TFN
DO EM002_Dup_BnkAcc
DO EM006_Mis_Details
DO EM009_TFN_Invld_Frmt
DO EM012_DOB_Valid

DO EM015_Not_Taken_Leave
DO EM016_Neg_SickLv
DO VM014_VndEmp_BankAcct
DO VM015_VndEmp_Add
DO VM016_VndEmp_Tel

DO PR001_Mul_Paid
DO PR002_Not_in_Emf
DO PR003_Pay_30D_Af_Trm
DO PR009_Pay_x_Times_Avg

SET SAFETY OFF
rad1=4
DO UZ001_CHK_Exp_VM_All_T
DO UZ002_CHK_Exp_AP_All_T
DO UZ003_CHK_Exp_EM_All_T
DO UZ004_CHK_Exp_PR_All_T
DO UZ005_CHK_Exp_ST_All_T

DO UU001_Export

DO CMF02_ACLExtractor


%v_AppCWM% QUIT

^BATCH    CX001_Export_HIST2_AP              
[PARENT_FOLDER_ID] 1455776720
 COMM Now Produce Results for AP Tests

DO AA002_Variable_Setting

COMM *** Prepare variables ***
v_Exc_GreyList=T

COMM *** Execute tests ***
v_Exc_History=T

COMM Assign TXT_AP014_Months = 18
TXT_AP014_Months="18"

COMM
DO AP000_Dup_All_123
DO AP004_Dup_Amt_Dt_Vndr



COMM *** Export the file into xml format without suffix ***
rad1=5
suffix=""
COMM *** created the sub archive folder to archive the old PMT file***
COMM
TXT_Exp_filepath="Reports\APW_"+ALLTRIM(DATETIME(_RptRunDate,'YYYYMMDD'))+"\"

TXT_Exp_filepath="Reports\"


COMM *** Export the file into xml format without suffix ***
rad1=5
suffix=""

v_CW=""
DO UZ006_CHK_Exp_F
CHK_Exp_VM001=F
CHK_Exp_VM002=F
CHK_Exp_VM003=F
CHK_Exp_VM005=F
CHK_Exp_VM006=F
CHK_Exp_VM007=F
CHK_Exp_VM008=F
CHK_Exp_VM009=F
CHK_Exp_VM010=F

CHK_Exp_AP001=T
CHK_Exp_AP002=T
CHK_Exp_AP003=T
CHK_Exp_AP004=T
CHK_Exp_AP006=F
CHK_Exp_AP014=F

DO UU001_Exp_AP_HIST2

COMM
CLOSE
QUIT
^LOGFILE  SATORI_EVA_DEV_TEST                 "" "SATORI_EVA_DEV_TEST.LOG"
[PARENT_FOLDER_ID] 0
^FOLDER   __SR                                1455780570
[PARENT_FOLDER_ID] 1340167351
^FOLDER   Z_TMP_DATA                          1455780635
[PARENT_FOLDER_ID] 1455780570
^REPORT   Default_View                       Authorizations                   D.T,
[SKIP] 0
[TLINES] 2
[RLINES] 1
[LINE] 1
employee_number      WIDTH 16 PICTURE ""
[LINE] 1
system               WIDTH 9 PICTURE ""
[LINE] 1
process              WIDTH 9 PICTURE ""
[LINE] 1
view                 PICTURE ""
[LINE] 1
create               WIDTH 8 PICTURE ""
[LINE] 1
approve              WIDTH 10 PICTURE ""
[LINE] 1
modify               WIDTH 9 PICTURE ""
[LINE] 1
delete               WIDTH 8 PICTURE ""
[LINE] 1
limit                PICTURE "(9,999,999)"
[LINE] 1
created_by           WIDTH 11 PICTURE ""
[LINE] 1
created_on           WIDTH 11 PICTURE ""
[LINE] 1
approved_by          WIDTH 12 PICTURE ""
[LINE] 1
approved_on          WIDTH 12 PICTURE ""
^BATCH    _START_RELINK_SRC_DATA             
[PARENT_FOLDER_ID] 1455780570
SET SAFETY OFF

SET FOLDER /SCRIPTS/__SR/Z_TMP_DATA

CLOSE PRI SECOND


DIR "C:\ACL_Data\SATORI_EVA_v4.0\Sources\*.FIL" TO FIL_TMP


OPEN FIL_TMP

DELETE RECNUM OK
 DEFINE FIELD RECNUM COMPUTED RECNO()


COUNT
COUNT_END = COUNT1
COUNT_ST = 1

DO OPEN_TAB WHILE COUNT_ST <= COUNT_END


^BATCH    OPEN_TAB                           
[PARENT_FOLDER_ID] 1455780570


CLOSE
OPEN FIL_TMP
 EXTRACT RECORD IF RECNUM = COUNT_ST TO TEMP_1234 OPEN
V_FRMT = ALLTR(SPLIT(ALLT(REV(SPLIT(ALLT(REV(ALLTR(FILE_NAME))) , "\"  ,1))) , "." , 1))
V_FRMT_LOC = ALLTR(FILE_NAME)
  OPEN "%V_FRMT_LOC%" FORMAT %V_FRMT%


COUNT_ST = COUNT_ST + 1

^FORMAT   Sales_cashiers                     Sales_cashiers                   "C:\ACL_Data\SATORI_EVA_v4.0\Sources" "Sales_cashiers.FIL" 0  
[PARENT_FOLDER_ID] 1455775988
~.08/24/2015   11:13:29 Sales_cashiers EXTRACT FIELDS transaction_number transaction_amount items_purchased purchase_date customer_number created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                TO Sales_cashiers_New
~Input : Records:83352       Control Total:0                    
~Output: Records:83352       Control Total:0                    
[LASTVIEW] "Default_View"
^FORMAT   Sales_cashiers_items               Sales_cashiers_items             "C:\ACL_Data\SATORI_EVA_v4.0\Sources" "Sales_cashiers_items.FIL" 0  
[PARENT_FOLDER_ID] 1455775988
[LASTVIEW] "Default_View"
^REPORT   Default_View                       Payroll                          D.T,
[SKIP] 0
[TLINES] 2
[RLINES] 1
[LINE] 1
pay_period           WIDTH 11 PICTURE ""
[LINE] 1
payroll_date         WIDTH 12 PICTURE ""
[LINE] 1
gross_pay            WIDTH 10 PICTURE "(9,999,999.99)"
[LINE] 1
deducations          WIDTH 11 PICTURE "(9,999,999.99)"
[LINE] 1
net_pay              WIDTH 10 PICTURE "(9,999,999.99)"
[LINE] 1
created_by           WIDTH 11 PICTURE ""
[LINE] 1
created_on           WIDTH 11 PICTURE ""
[LINE] 1
approved_by          WIDTH 12 PICTURE ""
[LINE] 1
approved_on          WIDTH 12 PICTURE ""
^FORMAT   FIL_TMP                            FIL_TMP                          "" "FIL_TMP.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1455780635
~.20160218     18:39:14   DIR "C:\ACL_Data\SATORI_EVA_v4.0\Sources\*.FIL" TO FIL_TMP
^FORMAT   Authorizations                     Authorizations                   "C:\ACL_Data\SATORI_EVA_v4.0\Sources" "Authorizations.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1455775988
~.08/24/2015   11:14:32 Authorizations EXTRACT FIELDS employee_number system process view create approve modify delete limit created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             TO Authorizations_New
~Input : Records:6176        Control Total:0                    
~Output: Records:6176        Control Total:0                    
[LASTVIEW] "Default_View"
^FORMAT   Customers                          Customers                        "C:\ACL_Data\SATORI_EVA_v4.0\Sources" "Customers.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1455775988
~.08/24/2015   11:14:53 Customers EXTRACT FIELDS customer_number customer_name type credit_limit start_date created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         TO Customers_New
~Input : Records:29909       Control Total:0                    
~Output: Records:29909       Control Total:0                    
[LASTVIEW] "Default_View"
^FORMAT   Inventory                          Inventory                        "C:\ACL_Data\SATORI_EVA_v4.0\Sources" "Inventory.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1455775988
~.08/24/2015   11:11:51 Inventory EXTRACT FIELDS inventory_number sic description location standard_cost max_discount minimum_level maximum_level created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   TO Inventory_New
~Input : Records:4315        Control Total:0                    
~Output: Records:4315        Control Total:0                    
[LASTVIEW] "Default_View"
^FORMAT   Invoices                           Invoices                         "C:\ACL_Data\SATORI_EVA_v4.0\Sources" "Invoices.FIL" 0  
[PARENT_FOLDER_ID] 1455775988
~.08/24/2015   11:13:06 Invoices EXTRACT FIELDS invoice_number so_number customer_number invoice_date invoice_amount payment_status payment_date payment_amount created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    TO Invoices_New
~Input : Records:4082        Control Total:0                    
~Output: Records:4082        Control Total:0                    
[LASTVIEW] "Default_View"
^FORMAT   Payments                           Payments                         "C:\ACL_Data\SATORI_EVA_v4.0\Sources" "Payments.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1455775988
~.08/24/2015   11:09:51 Payments EXTRACT FIELDS payment_number payment_date payment_amount vendor_number check_number voucher_number created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Payments_New
~Input : Records:5241        Control Total:0                    
~Output: Records:5241        Control Total:0                    
~.08/24/2015   12:15:56 Payments EXTRACT FIELDS payment_number payment_date payment_amount vendor_number check_number voucher_number created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Payments_New
~Input : Records:5241        Control Total:0                    
~Output: Records:5241        Control Total:0                    
[LASTVIEW] "Default_View"
^FORMAT   Payroll                            Payroll                          "C:\ACL_Data\SATORI_EVA_v4.0\Sources" "Payroll.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1455775988
~.08/24/2015   11:12:38 Payroll EXTRACT FIELDS pay_period payroll_date gross_pay deducations net_pay created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              TO Payroll_New
~Input : Records:26          Control Total:0                    
~Output: Records:26          Control Total:0                    
[LASTVIEW] "Default_View"
^FORMAT   Payroll_details                    Payroll_details                  "C:\ACL_Data\SATORI_EVA_v4.0\Sources" "Payroll_details.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1455775988
[LASTVIEW] "Default_View"
^FORMAT   Purchase_orders                    Purchase_orders                  "C:\ACL_Data\SATORI_EVA_v4.0\Sources" "Purchase_orders.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1455775988
~.08/24/2015   11:10:31 Purchase_orders EXTRACT FIELDS po_number po_date vendor_number po_amount requisition_number created_on created_by approved_on approved_by                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       TO Purchase_orders_New
~Input : Records:5298        Control Total:0                    
~Output: Records:5298        Control Total:0                    
~.08/24/2015   12:16:38 Purchase_orders EXTRACT FIELDS po_number po_date vendor_number po_amount requisition_number created_on created_by approved_on approved_by                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       TO Purchase_orders_New
~Input : Records:5298        Control Total:0                    
~Output: Records:5298        Control Total:0                    
~.08/24/2015   12:17:30 Purchase_orders EXTRACT FIELDS po_number po_date vendor_number po_amount requisition_number created_on created_by approved_on approved_by                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       TO Purchase_orders_New
~Input : Records:5298        Control Total:0                    
~Output: Records:5298        Control Total:0                    
[LASTVIEW] "Default_View"
^FORMAT   Purchase_orders_items              Purchase_orders_items            "C:\ACL_Data\SATORI_EVA_v4.0\Sources" "Purchase_orders_items.FIL" 0  
[PARENT_FOLDER_ID] 1455775988
[LASTVIEW] "Default_View"
^FORMAT   Shipments                          Shipments                        "C:\ACL_Data\SATORI_EVA_v4.0\Sources" "Shipments.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1455775988
~.08/24/2015   11:14:12 Shipments EXTRACT FIELDS shipping_number so_number ship_date items_shipped customer_number created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  TO Shipments_New
~Input : Records:4082        Control Total:0                    
~Output: Records:4082        Control Total:0                    
[LASTVIEW] "Default_View"
^FORMAT   Shipments_items                    Shipments_items                  "C:\ACL_Data\SATORI_EVA_v4.0\Sources" "Shipments_items.FIL" 0  
[PARENT_FOLDER_ID] 1455775988
[LASTVIEW] "Default_View"
^FORMAT   Vendors                            Vendors                          "C:\ACL_Data\SATORI_EVA_v4.0\Sources" "Vendors.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1455775988
~.08/24/2015   11:11:07 Vendors EXTRACT FIELDS vendor_number vendor_name address city sic created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         TO Vendors_New
~Input : Records:36321       Control Total:0                    
~Output: Records:36321       Control Total:0                    
~.08/24/2015   12:16:46 Vendors EXTRACT FIELDS vendor_number vendor_name address city sic created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         TO Vendors_New
~Input : Records:36321       Control Total:0                    
~Output: Records:36321       Control Total:0                    
~.08/24/2015   12:17:11 Vendors EXTRACT FIELDS vendor_number vendor_name address city sic created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         TO Vendors_New
~Input : Records:36321       Control Total:0                    
~Output: Records:36321       Control Total:0                    
[LASTVIEW] "Default_View"
^FORMAT   Vouchers                           Vouchers                         "C:\ACL_Data\SATORI_EVA_v4.0\Sources" "Vouchers.FIL" 0  
[PARENT_FOLDER_ID] 1455775988
~.08/24/2015   11:11:27 Vouchers EXTRACT FIELDS voucher_number voucher_date vendor_number po_number reference_number items_listed voucher_amount created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   TO Vouchers_New
~Input : Records:5298        Control Total:0                    
~Output: Records:5298        Control Total:0                    
[LASTVIEW] "Default_View"
^FORMAT   Vouchers_items                     Vouchers_items                   "C:\ACL_Data\SATORI_EVA_v4.0\Sources" "Vouchers_items.FIL" 0  
[PARENT_FOLDER_ID] 1455775988
[LASTVIEW] "Default_View"
^FORMAT   TEMP_1234                          TEMP_1234                        "" "TEMP_1234.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1455780635
~.20160218     18:39:14   DIR "C:\ACL_Data\SATORI_EVA_v4.0\Sources\*.FIL" TO FIL_TMP
~.20160218     18:39:15 FIL_TMP  EXTRACT RECORD IF RECNUM = COUNT_ST TO TEMP_1234 OPEN
~Input : Records:16          Control Total:0                    
~Output: Records:1           Control Total:0                    
^REPORT   Default_View                       Vendors                          D.T,
[SKIP] 0
[TLINES] 2
[RLINES] 1
[LINE] 1
vendor_number        WIDTH 14 PICTURE ""
[LINE] 1
vendor_name          WIDTH 21 PICTURE ""
[LINE] 1
address              WIDTH 14 PICTURE ""
[LINE] 1
city                 WIDTH 12 PICTURE ""
[LINE] 1
sic                  WIDTH 6 PICTURE ""
[LINE] 1
created_by           WIDTH 26 PICTURE ""
[LINE] 1
created_on           WIDTH 21 PICTURE ""
[LINE] 1
approved_by          WIDTH 12 PICTURE ""
[LINE] 1
approved_on          WIDTH 12 PICTURE ""
^BATCH    MZ004_Vnd_Chg_His                  
[PARENT_FOLDER_ID] 1430796753
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Save all historical changes of vendor master file into VMF_Chg_History
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 8/11/2012
COMM***************************************************************************

IF FTYPE("v_AppAX")="U" DO AA002_Variable_Setting

OPEN %trg_VMF%

EXTRACT FIELDS Vndr_Site_ID Vndr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABN ABN_CLN ADD1 ADD2 ADD3 City State TEL1 TEL2 TEL3 FAX Email1 Email2 _RptRunDateTime AS 'RptRunDateTime' TO %fld_Tmps%TMP6 OPEN

COMM*** If the record length is changed, then clean up the history file, and capture the change history again ***
v_RecLen1=RECLEN()
v_RecLen2=0

IF FTYPE("VMF_Chg_History")="Y" OPEN VMF_Chg_History
%v_AppAX% IF FTYPE("VMF_Chg_History")="y" EXTRACT FIELDS ALL TO "%fld_Tmps%AXTmp1"
%v_AppAX% IF FTYPE("VMF_Chg_History")="y" EXTRACT FIELDS ALL TO "%fld_Workings%VMF_Chg_History" OPEN
IF FTYPE("VMF_Chg_History")="y" AND FILESIZE("%fld_Workings%VMF_Chg_History.fil") >=0 v_RecLen2=RECLEN()

IF v_RecLen1<>v_RecLen2 DELETE FORMAT VMF_Chg_History OK
IF v_RecLen1<>v_RecLen2 DELETE "%fld_Workings%VMF_Chg_History.fil" OK

OPEN TMP6
IF FTYPE("VMF_Chg_History")<>"y" OR FILESIZE("%fld_Workings%VMF_Chg_History.fil") <=0 EXTRACT FIELDS ALL TO "%fld_Workings%VMF_Chg_History" OPEN
IF FTYPE("VMF_Chg_History")="y" AND FILESIZE("%fld_Workings%VMF_Chg_History.fil") >0 OPEN VMF_Chg_History

COMM *** If it is the firt time to capture the vendor master change history file, then don't need to do the following logic ***
IF v_RecLen1<>v_RecLen2 ESCAPE

SET FOLDER/%fld_Tmps%
SORT ON Vndr_Site_ID ALLTRIM(SUBSTR(RptRunDateTime,7,4)+ "-"+SUBSTR(RptRunDateTime,4,2)+"-"+ SUBSTR(RptRunDateTime,1,2)+SUBSTR(RptRunDateTime,11,9)) D TO %fld_Tmps%TMP4 OPEN
INDEX ON Vndr_Site_ID TO IDX_VMF_Chg_History

OPEN TMP6
DEFINE RELATION Vndr_Site_ID WITH TMP4 INDEX IDX_VMF_Chg_History

DELETE FIELD CHANGED_FIELD OK
DEFINE FIELD CHANGED_FIELD COMPUTED

"Y" IF ISBLANK(TMP4.Vndr_ID)
"Y" IF Vndr_ID<>TMP4.Vndr_ID 
"Y" IF Vndr_Nme<>TMP4.Vndr_Nme
"Y" IF Vndr_Sts<>TMP4.Vndr_Sts
"Y" IF Vndr_Typ<>TMP4.Vndr_Typ
"Y" IF ABN_CLN<>TMP4.ABN_CLN
"Y" IF CLEAN(ADD1+ADD2+ADD3+City+State)<>CLEAN(TMP4.ADD1+TMP4.ADD2+TMP4.ADD3+TMP4.City+TMP4.State)
"Y" IF INCLUDE(TEL1+TEL2+TEL3+FAX,"1234567890")<>INCLUDE(TMP4.TEL1+TMP4.TEL2+TMP4.TEL3+TMP4.FAX,"1234567890")
"Y" IF CLEAN(Email1+Email2)<>CLEAN(TMP4.Email1+TMP4.Email2)
"N"

EXTRACT FIELDS Vndr_Site_ID Vndr_ID Vndr_Nme Vndr_Sts Vndr_Typ ABN ABN_CLN ADD1 ADD2 ADD3 City State TEL1 TEL2 TEL3 FAX Email1 Email2 _RptRunDateTime AS 'RptRunDateTime' IF CHANGED_FIELD="Y" TO %fld_Tmps%TMP5 OPEN
DELETE FIELD CHANGED_FIELD OK

SET FOLDER/%fld_Workings%
OPEN TMP5
EXTRACT FIELDS ALL TO "%fld_Workings%VMF_Chg_History" APPEND


^REPORT   Default_View                       Customers                        D.T,
[SKIP] 0
[TLINES] 2
[RLINES] 1
[LINE] 1
customer_number      WIDTH 16 PICTURE ""
[LINE] 1
customer_name        WIDTH 14 PICTURE ""
[LINE] 1
type                 WIDTH 7 PICTURE ""
[LINE] 1
credit_limit         WIDTH 11 PICTURE "(9,999,999)"
[LINE] 1
start_date           WIDTH 12 PICTURE ""
[LINE] 1
created_by           WIDTH 11 PICTURE ""
[LINE] 1
created_on           WIDTH 11 PICTURE ""
[LINE] 1
approved_by          WIDTH 12 PICTURE ""
[LINE] 1
approved_on          WIDTH 12 PICTURE ""
^REPORT   Default_View                       Invoices                         D.T,
[SKIP] 0
[TLINES] 2
[RLINES] 1
[LINE] 1
invoice_number       WIDTH 14 PICTURE ""
[LINE] 1
so_number            WIDTH 17 PICTURE ""
[LINE] 1
customer_number      WIDTH 16 PICTURE ""
[LINE] 1
invoice_date         WIDTH 12 PICTURE ""
[LINE] 1
invoice_amount       WIDTH 16 PICTURE "(9,999,999.99)"
[LINE] 1
payment_status       WIDTH 23 PICTURE ""
[LINE] 1
payment_date         WIDTH 13 PICTURE ""
[LINE] 1
payment_amount       WIDTH 15 PICTURE "(9,999,999.99)"
[LINE] 1
created_by           WIDTH 11 PICTURE ""
[LINE] 1
created_on           WIDTH 19 PICTURE ""
[LINE] 1
approved_by          WIDTH 12 PICTURE ""
[LINE] 1
approved_on          WIDTH 12 PICTURE ""
^REPORT   Default_View                       Shipments                        D.T,
[SKIP] 0
[TLINES] 2
[RLINES] 1
[LINE] 1
shipping_number      WIDTH 15 PICTURE ""
[LINE] 1
so_number            WIDTH 17 PICTURE ""
[LINE] 1
ship_date            WIDTH 10 PICTURE ""
[LINE] 1
items_shipped        WIDTH 13 PICTURE "(9,999,999)"
[LINE] 1
customer_number      WIDTH 16 PICTURE ""
[LINE] 1
created_by           WIDTH 11 PICTURE ""
[LINE] 1
created_on           WIDTH 11 PICTURE ""
[LINE] 1
approved_by          WIDTH 12 PICTURE ""
[LINE] 1
approved_on          WIDTH 12 PICTURE ""
^REPORT   Default_View                       Shipments_items                  D.T,
[SKIP] 0
[TLINES] 2
[RLINES] 1
[LINE] 1
shipping_number      WIDTH 15 PICTURE ""
[LINE] 1
item_number          WIDTH 12 PICTURE ""
[LINE] 1
inventory_number     PICTURE ""
[LINE] 1
ship_quantity        WIDTH 12 PICTURE "(9,999,999)"
^REPORT   Default_View                       Inventory                        D.T,
[SKIP] 0
[TLINES] 2
[RLINES] 1
[LINE] 1
inventory_number     WIDTH 16 PICTURE ""
[LINE] 1
sic                  WIDTH 7 PICTURE ""
[LINE] 1
description          WIDTH 11 PICTURE ""
[LINE] 1
location             PICTURE ""
[LINE] 1
standard_cost        WIDTH 13 PICTURE "(9,999.99)"
[LINE] 1
max_discount         WIDTH 16 PICTURE "(9,999.99)"
[LINE] 1
minimum_level        WIDTH 14 PICTURE "(9,999,999)"
[LINE] 1
maximum_level        WIDTH 16 PICTURE "(9,999,999)"
[LINE] 1
created_by           WIDTH 23 PICTURE ""
[LINE] 1
created_on           WIDTH 11 PICTURE ""
[LINE] 1
approved_by          WIDTH 12 PICTURE ""
[LINE] 1
approved_on          WIDTH 12 PICTURE ""
^BATCH    EMP_BNK_DET_CRTE                   
[PARENT_FOLDER_ID] 1455780570
SET SAFETY OFF


OPEN Employees
 DELETE BANK_BSB OK
  DEFINE FIELD BANK_BSB COMPUTED ALLTR(STRING(RAND(1234) , 50))

 DELETE BANK_ACC OK
  DEFINE FIELD BANK_ACC COMPUTED ALLTR(STRING(RAND(4321) , 50))





^REPORT   Default_View                       Employees                        D.T,
[SKIP] 0
[TLINES] 2
[RLINES] 1
[LINE] 1
BANK_ACC             PICTURE ""
[LINE] 1
BANK_BSB             PICTURE ""
[LINE] 1
employee_number      WIDTH 16 PICTURE ""
[LINE] 1
first_name           WIDTH 11 PICTURE ""
[LINE] 1
last_name            WIDTH 11 PICTURE ""
[LINE] 1
ssn                  WIDTH 10 PICTURE ""
[LINE] 1
department           WIDTH 16 PICTURE ""
[LINE] 1
position             WIDTH 23 PICTURE ""
[LINE] 1
employee_type        WIDTH 13 PICTURE ""
[LINE] 1
hire_date            WIDTH 11 PICTURE ""
[LINE] 1
home_phone           PICTURE ""
[LINE] 1
home_address1        WIDTH 19 PICTURE ""
[LINE] 1
home_city            WIDTH 11 PICTURE ""
[LINE] 1
home_state           WIDTH 11 PICTURE ""
[LINE] 1
home_zip             WIDTH 10 PICTURE ""
[LINE] 1
hourly_rate          WIDTH 11 PICTURE "(9,999,999.99)"
[LINE] 1
salary               WIDTH 8 PICTURE "(9,999,999)"
[LINE] 1
created_by           WIDTH 11 PICTURE ""
[LINE] 1
created_on           WIDTH 11 PICTURE ""
[LINE] 1
updated_by           WIDTH 11 PICTURE ""
[LINE] 1
updated_on           WIDTH 11 PICTURE ""
[LINE] 1
approved_by          WIDTH 12 PICTURE ""
[LINE] 1
approved_on          WIDTH 12 PICTURE ""
^FORMAT   Employees                          Employees                        "C:\ACL_Data\SATORI_EVA_v4.0\Sources" "Employees.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1455775988
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
[LASTVIEW] "Default_View"
[FILTER] BANK_ACC <> 3390
^FOLDER   _Development                        1431654050
[PARENT_FOLDER_ID] 1426733072
^BATCH    CC001_RunPR_Weekly                 
[PARENT_FOLDER_ID] 1455773842
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION FOR CCM (Caseware, task scheduler)
COMM *** Execute EMP & PR tests -weekly
COMM *** Created by Nancy Li (0431 057 135) on 12/01/2015
COMM***************************************************************************

SET SAFETY OFF
SET DATE "YYYYMMDD"

SET SESSION CA006_RunPR_Weekly

EXECUTE 'CMD /C "TASKKILL /IM EXCEL.EXE /F"'


DO AA002_Variable_Setting

COMM *** remove the dialog or pause when runing the jobs in automation mode***
v_CCMJob="COMMENT"


SET DATE "YYYYMMDD"

F_Append=T

COMM *** Prepare variables ***
v_Exc_GreyList=F

COMM *** Execute tests ***
v_Exc_History=T



COMM *** created the sub archive folder to archive the old PMT file***
TXT_Exp_filepath="Reports\PRW_"+ALLTRIM(DATETIME(_RptRunDate,'YYYYMMDD'))+"\"


COMM
SR ERR:
VARIABLE ERRORS
END

COMM
LOCATION: SCRIPTS/DATA/CONVERT
SCRIPT: MP004_Convert_Payroll
LINE: 40 
ERROR: 
Produced with ACL by: Satori Group (US) Command:   DEFINE FIELD Year COMPUTED LAST(ALLTRIM(DATE(Prd_Dt)),4)  
12:47:16 - 19/02/2016  
'Prd_Dt' is undefined
Command Failed
END



COMM *** get excel mapping table ***
COMM BASICALLY IMPORTS THE WORKBOOKS FROM THE EXCEL MAPPING FILE

Errmsg=""
DM_Flag=F
DO LE003_Imp_Mapping 



COMM *** Convert Source data into ACL application ***

COMM THIS IS FOR VENDORS

DO MP001_Convert_VMF 

COMM THIS IS FOR EMPLOYEES HR DATA

DO MP003_Convert_EMF

COMM THIS IS FOR EMPLOYESS PAYROLL DATA

DO MP004_Convert_Payroll





COMM 
SR_ERR:
COUNT NOT FIND v_vm_count VARIBLE
REMOVED IT FROM LINE 54:
IF v_vm_count > 0
SAME APPLIES TO LINE 62!
END





COMM
DO MZ003_Com_VndEmp

COMM
SR ERR:
THIS DOES THE HR ANALYTICS
END

DO EM001_Dup_TFN
DO EM002_Dup_BnkAcc
DO EM003_Dup_Nme
DO EM004_Dup_Add
DO EM005_Dup_Tel
DO EM006_Mis_Details
DO EM007_StartDt_Bf_DOB
DO EM008_unKnown_CstCtr
DO EM009_TFN_Invld_Frmt
DO EM010_TFN_Valid
DO EM011_BnkAcc_Valid
DO EM012_DOB_Valid
DO EM013_StartDt_Valid
DO EM014_Tmp_No_EndDt
DO EM015_Not_Taken_Leave
DO EM016_TooMuch_SickLv
DO EM017_Neg_SickLv

COMM
SR ERR:
THIS DOES THE PR ANALYTICS
END

DO PR001_Mul_Paid
DO PR002_Not_in_Emf
DO PR003_Pay_30D_Af_Trm
DO PR004_Spec_Leave_3Mon
DO PR005_Pay_TrmAmt_Sleeper
DO PR006_Unusual_Super
DO PR007_Hourly_Emp
DO PR008_Top_xx_Over_xx_Mon
DO PR009_Pay_x_Times_Avg

v_Exc_History=F
DO EM009_TFN_Invld_Frmt



COMM *** delete all temperary tables ***
DO AE003_Del_Tmp

CLOSE PRIMARY SECONDARY

COMM *** Export the file into delimited or access files 1: Access; 4: delimited; 2: Excel***
rad1=2

v_CW=""
DO UZ006_CHK_Exp_F
CHK_Exp_EM001=T
CHK_Exp_EM002=T
CHK_Exp_EM006=T
CHK_Exp_EM009=T

DO UU001_Export

COMM *** delete tmp files and relations ***
DO AE003_Del_Tmp
CLOSE

SET SESSION

%v_AppCWM% QUIT
^BATCH    MP004_Convert_Payroll              
[PARENT_FOLDER_ID] 1430796753
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Convert Source Data To Target Working File Tables: Payroll
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("fld_Workings")="U" OR FTYPE("trg_PR_Pay")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER/%fld_Workings%

COMM *** convert Payroll Payments***

COMM *** Capture the linkage relationships for the data mapping, convert the source data into target standard table ***
OPEN DM_%trg_PR_Pay%

COMM *** Extract the mapping information from the mapping file (e.g. DM_Payroll_Payments)***
DO MZ001_Convert

COMM *** IF relationship between source table and target table has not been build, need to build the relationship first, goto the menu "Link fields/Mapping" ***
IF src_File_Name="" OR v_COUNT=0 OR v_Flds_Extract="" PAUSE "There is no data mapping information - Payroll, please link/map the source fields to the standard fields first."
IF src_File_Name="" OR v_COUNT=0 OR v_Flds_Extract="" DO LE001_Link_Menu

COMM *** IF relationship between source table and target table has been build, convert data directely. ***

IF src_File_Name<>"" AND v_Flds_Extract<>""  OPEN %src_File_Name%


comm 
SR ERR:
IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' 0.00 AS 'PayCode_Hours' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' 0.00 AS 'Standard_WeeklyHours' DEC(V_PAY_CDE_DESC,2) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5' TO "Working_Files\Payroll_Payments.FIL" 
13:29:25 - 19/02/2016  
Numeric expression is required
Command Failed
DEC(V_PAY_CDE_DESC,2) AS 'PayCode_Desc' 
CHANGE TO
(V_PAY_CDE_DESC) AS 'PayCode_Desc'
END

 IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS %v_Flds_Extract%  TO "%fld_Workings%%trg_PR_Pay%.FIL"

comm IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' 0.00 AS 'PayCode_Hours' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' 0.00 AS 'Standard_WeeklyHours' (V_PAY_CDE_DESC) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5' TO "Working_Files\Payroll_Payments.FIL" 


IF FTYPE("%trg_PR_Pay%")<>"y" OR FILESIZE("%fld_Workings%%trg_PR_Pay%.fil")<=0 PAUSE "Payroll Payments Table has not been convert properly. Please check the fields mapping and convert it again."
IF FTYPE("%trg_PR_Pay%")<>"y" OR FILESIZE("%fld_Workings%%trg_PR_Pay%.fil")<=0 ESCAPE

COMM *** prepare Payroll relevant tables for the Tests ***

OPEN %trg_PR_Pay%


DELETE FIELD Year OK
DEFINE FIELD Year COMPUTED LAST(ALLTRIM(DATE(Prd_Dt)),4)

DELETE FIELD YM OK
DEFINE FIELD YM COMPUTED SUBSTR(ALLTRIM(DATE(Prd_Dt)),4,2)+"/"+LAST(ALLTRIM(DATE(Prd_Dt)),4)

DELETE FIELD c_Prd_Dt OK 
DEFINE FIELD c_Prd_Dt COMPUTED ALLTRIM(SUBSTR(DATE(Prd_Dt),7,4))+ALLTRIM(SUBSTR(DATE(Prd_Dt),4,2))+ALLTRIM(SUBSTR(DATE(Prd_Dt),1,2))

DELETE FIELD ABS_PayCode_Amount
DEFINE FIELD ABS_PayCode_Amount COMPUTED 

VALUE(SPLIT(ALLTRIM(STRING(ABS(PayCode_Amount),21)),".",1),0) IF OCCURS(ALLTRIM(STRING(ABS(PayCode_Amount),21)),".")>=0
VALUE(ALLTRIM(STRING(ABS(PayCode_Amount),21 )),0)

DELETE FIELD PrdSalaryAmt OK
DEFINE FIELD PrdSalaryAmt COMPUTED 

PayCode_Amount IF %v_SalaryHours%
0.00

DELETE FIELD ActPaidAmt OK
DEFINE FIELD ActPaidAmt COMPUTED 

PayCode_Amount IF %v_PaidAmount%
0.00

DELETE FIELD PrdGrsAmt OK
DEFINE FIELD PrdGrsAmt COMPUTED 

PayCode_Amount IF %v_PeriodGrossAmount%
0.00

COMM ***summarize the total paid amount and super earning amount based on Employee Number, ForPeriod and payment date ***
OPEN %trg_PR_Pay%
DELETE FIELD RUNID_ForPrd OK
DEFINE FIELD RUNID_ForPrd COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ ALLTRIM(ForPrd),1,40)

SUMMARIZE ON RUNID_ForPrd SUBTOTAL PrdSalaryAmt ActPaidAmt PrdGrsAmt Pay_Hrs AS 'Prd_PayHrs' OTHER ALL TO "%fld_Sources%PayRoll_ForPrd_Sum" OPEN PRESORT
INDEX ON Co_Emp_ID TO IDX_PayRoll_ForPrd_Sum

OPEN %trg_PR_Pay%
DELETE FIELD RUNID_InPrd OK
DEFINE FIELD RUNID_InPrd COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ ALLTRIM(InPrd),1,40)

SUMMARIZE ON RUNID_InPrd SUBTOTAL PrdSalaryAmt ActPaidAmt PrdGrsAmt Pay_Hrs AS 'Prd_PayHrs' OTHER ALL TO "%fld_Sources%PayRoll_InPrd_Sum" OPEN PRESORT
INDEX ON Co_Emp_ID TO IDX_PayRoll_InPrd_Sum

COMM *** find out the Early InPeriod and Latest InPeriod for each employee ***
OPEN PayRoll_InPrd_Sum
SORT ON Co_Emp_ID InPrd TO %fld_Tmps%TMP7 OPEN
INDEX ON Co_Emp_ID TO IDX_TMP7

OPEN PayRoll_InPrd_Sum
SORT ON Co_Emp_ID D InPrd D TO %fld_Tmps%TMP8 OPEN
INDEX ON Co_Emp_ID TO IDX_TMP8

COMM ***summarize the total paid amount and super earning amount based on Employee Number ***
OPEN PayRoll_InPrd_Sum
SUMMARIZE ON Co_Emp_ID SUBTOTAL PrdSalaryAmt ActPaidAmt PrdGrsAmt Prd_PayHrs IF AGE(Prd_Dt,_RptRunDate)<=365 TO "%fld_Tmps%TMP9.FIL" OPEN PRESORT

DEFINE RELATION Co_Emp_ID WITH TMP7 INDEX IDX_TMP7
DEFINE RELATION Co_Emp_ID WITH TMP8 INDEX IDX_TMP8

EXTRACT FIELDS ALL TMP7.InPrd AS 'Early_InPrd' TMP8.InPrd AS 'Lst_InPrd' TO "%fld_Workings%Payroll_Sum_12m" OPEN 

INDEX ON Co_Emp_ID TO IDX_Payroll_Sum_ID


COMM *** Create relations between tables ***

IF FTYPE("%trg_PR_Pay%")="y" AND FILESIZE("%fld_Workings%%trg_PR_Pay%.fil") >= 0 OPEN %trg_PR_Pay%
IF FTYPE("%trg_PR_Pay%")="y" AND FILESIZE("%fld_Workings%%trg_PR_Pay%.fil") >= 0 INDEX ON Co_Emp_ID TO "IDX_PR_Pay_Co_Emp_ID"

IF FTYPE("%trg_EMF%")="y" AND FILESIZE("%fld_Workings%%trg_EMF%.fil") >= 0 OPEN %trg_EMF%
IF FTYPE("%trg_EMF%")="y" AND FILESIZE("%fld_Workings%%trg_EMF%.fil") >= 0 DEFINE RELATION Co_Emp_ID WITH Payroll_Sum_12m INDEX IDX_Payroll_Sum_ID

IF FTYPE("EMF_TMP_Emp")="y" AND FILESIZE("%fld_Workings%EMF_TMP_Emp.fil") >= 0 OPEN EMF_TMP_Emp
IF FTYPE("EMF_TMP_Emp")="y" AND FILESIZE("%fld_Workings%EMF_TMP_Emp.fil") >= 0 DEFINE RELATION Co_Emp_ID WITH Payroll_Sum_12m INDEX IDX_Payroll_Sum_ID

IF FTYPE("%trg_PR_Pay%")="y" AND FILESIZE("%fld_Workings%%trg_PR_Pay%.fil") >= 0 OPEN %trg_PR_Pay%
IF FTYPE("%trg_PR_Pay%")="y" AND FILESIZE("%fld_Workings%%trg_PR_Pay%.fil") >= 0 DEFINE RELATION Co_Emp_ID WITH %trg_EMF% INDEX IDX_Co_Emp_ID

IF FTYPE("EMF_TMP_Emp")="y" AND FILESIZE("%fld_Workings%EMF_TMP_Emp.fil") >= 0 OPEN EMF_TMP_Emp
IF FTYPE("EMF_TMP_Emp")="y" AND FILESIZE("%fld_Workings%EMF_TMP_Emp.fil") >= 0 DELETE FIELD Total_PayAmt OK
IF FTYPE("EMF_TMP_Emp")="y" AND FILESIZE("%fld_Workings%EMF_TMP_Emp.fil") >= 0 DEFINE FIELD Total_PayAmt COMPUTED Payroll_Sum_12m.ActPaidAmt
IF FTYPE("EMF_TMP_Emp")="y" AND FILESIZE("%fld_Workings%EMF_TMP_Emp.fil") >= 0 DELETE FIELD Total_Pay_Num OK
IF FTYPE("EMF_TMP_Emp")="y" AND FILESIZE("%fld_Workings%EMF_TMP_Emp.fil") >= 0 DEFINE FIELD Total_Pay_Num COMPUTED Payroll_Sum_12m.COUNT

 

COMM *** get the Payroll data range ***
v_Comment="COMMENT"
DELETE LOW1 OK
DELETE HIGH1 OK
IF FTYPE("%trg_PR_Pay%")="y" AND FILESIZE("%fld_Workings%%trg_PR_Pay%.fil") >= 0 v_Comment=""
%v_Comment% OPEN %trg_PR_Pay%
%v_Comment% STATISTICS ON Prd_Dt TO SCREEN NUMBER 1
%v_Comment% _PR_Data_Start_Date=CTOD(DATETIME(LOW1,"DD/MM/YYYY"),"DD/MM/YYYY") 
%v_Comment% _PR_Data_End_Date=CTOD(DATETIME(HIGH1,"DD/MM/YYYY"),"DD/MM/YYYY")

COMM *** Combine Vendor and Employee master file into Vnd_Emp_Master ***
DO MZ003_Com_VndEmp


SET SAFETY ON
^REPORT   Default_View                       Payroll_details                  D.T,
[SKIP] 0
[TLINES] 2
[RLINES] 1
[LINE] 1
pay_period           WIDTH 11 PICTURE ""
[LINE] 1
Payroll.pay_period   WIDTH 11 PICTURE ""
[LINE] 1
Payroll.payroll_date WIDTH 12 PICTURE ""
[LINE] 1
Payroll.approved_by  WIDTH 12 PICTURE ""
[LINE] 1
Payroll.approved_on  WIDTH 12 PICTURE ""
[LINE] 1
Payroll.created_by   WIDTH 11 PICTURE ""
[LINE] 1
Payroll.created_on   WIDTH 11 PICTURE ""
[LINE] 1
employee_number      WIDTH 16 PICTURE ""
[LINE] 1
gross_pay            WIDTH 10 PICTURE "(9,999,999.99)"
[LINE] 1
deducations          WIDTH 11 PICTURE "(9,999,999.99)"
[LINE] 1
net_pay              WIDTH 9 PICTURE "(9,999,999.99)"
^BATCH    EM006_Mis_Details                  
[PARENT_FOLDER_ID] 1340167410
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Employee Master File Exception Tests
COMM *** EM006. Identify Employees with missing: Employee No.; Address; Telephone No.; Tax File No.; Hire Date; Bank Account; Basic Pay Details; Cost Centre/Department
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("v_flds_EMF")="U" OR FTYPE("fld_Results")="U" OR  FTYPE("trg_EMF")="U" DO AA002_Variable_Setting
IF FTYPE("EMF_TMP_Emp")<>"y" OR FILESIZE("%fld_Workings%EMF_TMP_Emp.FIL")<=0 ESCAPE

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER /%fld_Tmps%

v_TestNo="EM006"
COMM *** missing Employee No.

OPEN EMF_TMP_Emp
 EXTRACT 100000 AS "EM006" %v_flds_EMF% BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN IF Emp_Sts="A" AND  LENGTH(ALLTRIM(c_Tel1))<6 AND LENGTH(ALLTRIM(c_Tel2))<6 AND LENGTH(ALLTRIM(c_Tel3))<6 AND LENGTH(ALLTRIM(c_Fax))<6 TO %fld_Tmps%TMP1 FIRST 0

COMM OPEN Emp_HR_Data
OPEN EMF_TMP_Emp
SET FILTER TO Emp_Sts="A" AND NOT ISBLANK(Emp_ID)
COUNT
IF COUNT1>0 SET FILTER 
IF COUNT1>0 EXTRACT 10000000 AS "EM006" %v_flds_EMF% BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN IF Emp_Sts="A" AND ISBLANK(Emp_ID) TO %fld_Tmps%TMP1 OPEN APPEND

COMM *** missing Address ***

OPEN EMF_TMP_Emp
DELETE FIELD c_ADD OK
DEFINE FIELD c_ADD COMPUTED ALLTRIM(INCLUDE(UPPER(CLEAN(ADD1+ADD2+ADD3)),"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"))

SET FILTER TO Emp_Sts="A" AND LENGTH(ALLTRIM(c_ADD))>=6
COUNT
IF COUNT1>0 SET FILTER 
IF COUNT1>0 EXTRACT 1000000 AS "EM006" %v_flds_EMF% BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN IF  Emp_Sts="A" AND  LENGTH(ALLTRIM(c_ADD))<6 TO %fld_Tmps%TMP1 OPEN APPEND

COMM *** missing Telephone No. ***

OPEN EMF_TMP_Emp
DELETE FIELD c_Tel1 OK
DEFINE FIELD c_Tel1 COMPUTED ALLTRIM(STRING(VALUE(INCLUDE(TEL1, "0123456789"),0),20))
DELETE FIELD c_Tel2 OK
DEFINE FIELD c_Tel2 COMPUTED ALLTRIM(STRING(VALUE(INCLUDE(TEL2, "0123456789"),0),20))
DELETE FIELD c_Tel3 OK
DEFINE FIELD c_Tel3 COMPUTED ALLTRIM(STRING(VALUE(INCLUDE(TEL3, "0123456789"),0),20))
DELETE FIELD c_Fax OK
DEFINE FIELD c_Fax COMPUTED ALLTRIM(STRING(VALUE(INCLUDE(FAX, "0123456789"),0),20))

SET FILTER TO Emp_Sts="A" AND (LENGTH(ALLTRIM(c_Tel1))>=6 OR LENGTH(ALLTRIM(c_Tel2))>=6 OR LENGTH(ALLTRIM(c_Tel3))>=6 OR LENGTH(ALLTRIM(c_Fax))>=6)
COUNT
IF COUNT1>0 SET FILTER 
IF COUNT1>0 EXTRACT 100000 AS "EM006" %v_flds_EMF% BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN IF Emp_Sts="A" AND  LENGTH(ALLTRIM(c_Tel1))<6 AND LENGTH(ALLTRIM(c_Tel2))<6 AND LENGTH(ALLTRIM(c_Tel3))<6 AND LENGTH(ALLTRIM(c_Fax))<6 TO %fld_Tmps%TMP1 OPEN APPEND

COMM *** missing Tax File No. ***

OPEN EMF_TMP_Emp
DELETE FIELD c_Tax_Fle_Num OK
DEFINE FIELD c_Tax_Fle_Num COMPUTED ALLTRIM(STRING(VALUE(INCLUDE(Tax_Fle_Num,"0123456789"),0),20))

SET FILTER TO Emp_Sts="A" AND LENGTH(ALLTRIM(c_Tax_Fle_Num))>1 AND VALUE(c_Tax_Fle_Num,0)<>0
COUNT
IF COUNT1>0 SET FILTER 
IF COUNT1>0 EXTRACT 10000 AS "EM006" %v_flds_EMF% BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN IF Emp_Sts="A" AND LENGTH(ALLTRIM(c_Tax_Fle_Num))<=1 AND VALUE(c_Tax_Fle_Num,0)=0 TO %fld_Tmps%TMP1 OPEN APPEND

COMM *** missing Hire Date ***

OPEN EMF_TMP_Emp
SET FILTER TO Emp_Sts="A" AND NOT ISBLANK(DATE(Hire_Dt))
COUNT
IF COUNT1>0 SET FILTER 
IF COUNT1>0 EXTRACT 1000 AS "EM006" %v_flds_EMF% BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN IF Emp_Sts="A" AND  ISBLANK(DATE(Hire_Dt)) TO %fld_Tmps%TMP1 OPEN APPEND

COMM *** missing Bank Account ***

OPEN EMF_TMP_Emp


DELETE FIELD c_BSB OK
DEFINE FIELD c_BSB COMPUTED ALLTRIM(STRING(VALUE(INCLUDE(BSB,"0123456789"),0),10))
DELETE FIELD c_Bnk_Acc_Num OK
DEFINE FIELD c_Bnk_Acc_Num COMPUTED ALLTRIM(STRING(VALUE(INCLUDE(Bnk_Acc_Num,"0123456789"),0),20))

SET FILTER TO Emp_Sts="A" AND ( LENGTH(ALLTRIM(c_BSB))>=4 AND LENGTH(ALLTRIM(c_Bnk_Acc_Num))>=2)
COUNT
IF COUNT1>0 SET FILTER 
IF COUNT1>0 EXTRACT 100 AS "EM006" %v_flds_EMF% BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN IF Emp_Sts="A" AND ( LENGTH(ALLTRIM(c_BSB))<4 OR LENGTH(ALLTRIM(c_Bnk_Acc_Num))<2) TO %fld_Tmps%TMP1 OPEN APPEND

COMM *** Basic Pay details?? ***


COMM ***missing Cost Centre / Department ***

OPEN EMF_TMP_Emp
SET FILTER TO Emp_Sts="A" AND NOT ISBLANK(COST_CENTRE)
COUNT
IF COUNT1>0 SET FILTER 
IF COUNT1>0 EXTRACT 1 AS "EM006" %v_flds_EMF% BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num  Invalid_TFN IF Emp_Sts="A" AND ISBLANK(COST_CENTRE) TO %fld_Tmps%TMP1 OPEN APPEND

OPEN TMP1
COMMENT If using ACL 11, need to investigate if the PRESORT breaks the result
SUMMARIZE ON Co_Emp_ID Emp_ID SUBTOTAL EM006 OTHER %v_flds_EMF% BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN TO "%fld_Tmps%TMP2.FIL" OPEN PRESORT

DELETE FIELD c_EM006 OK
DEFINE FIELD c_EM006 COMPUTED ZONED(EM006,8)

COMM *** Formulize the test name ***
DO EZ006_Test_Name
COMM *** END ***

DELETE FIELD Test_Name OK
DEFINE FIELD Test_Name COMPUTED SUBSTR("EM006. Identify Employees with missing: " +TMP_TEST.NEW_EM006,1,170)

DELETE FIELD RptRunDate OK
DEFINE FIELD RptRunDate  COMPUTED   _RptRunDate 

EXTRACT FIELDS c_EM006 AS "EM006" %v_flds_EMF% BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Test_Name RptRunDate Invalid_TFN TO "%fld_Tmps%TMP3" OPEN 

COMM *** Start GreyList ***
v_ID_KEY_GL="Co_Emp_ID"
v_TEST_NO_GL="%v_TestNo%"
IF v_Exc_GreyList =T DO AE004_GreyList
COMM *** End ***

COMM *** Start remove historical dups ***
DELETE FIELD ID_KEY OK
DEFINE FIELD ID_KEY COMPUTED SUBSTR(ALLTRIM(Co_Emp_ID)+"~"+ALLTRIM(EM006),1,85)
v_ID_KEY="ID_KEY"
v_TEST_NO="%v_TestNo%"
IF v_Exc_History =T DO AE002_Nor_History
IF v_Chk_CCM=T DO AE007_Nor_CCM
COMM *** End ***

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP4" OPEN

DELETE FIELD SORT_KEY OK
DEFINE FIELD SORT_KEY COMPUTED SUBSTR(ALLTRIM(EM006)+ALLTRIM(Co_Emp_ID)+ALLTRIM(COST_CENTRE)+ALLTRIM(Emp_ID),1,64)

DELETE FIELD SORT_KEY_Desc OK
DEFINE FIELD SORT_KEY_Desc COMPUTED "TestNameCode Emp_ID Co_Emp_ID Cost_Center Emp_ID"

DELETE FIELD Priority OK
DEFINE FIELD Priority COMPUTED "M"

EXTRACT FIELDS ALL TO "%fld_Tmps%TMP10" OPEN

comm *** finalize the result  ***
SET FOLDER /%fld_Results%
SORT ON SORT_KEY D TO "%fld_Results%EM006_Mis_Details" OPEN

COMM *** Delete temporary tables ***
DO AE003_Del_Tmp

SET SAFETY ON
^FORMAT   _OLD_EM001_History                 _OLD_EM001_History               "History" "EM001_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:17:06 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:17:07 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:17:11 EMF_TMP_Emp DUPLICATES ON c_Tax_Fle_Num OTHER ALL BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN PRESORT IF Emp_Sts<>"I" AND LENGTH(ALLTRIM(c_Tax_Fle_Num))>1  OPEN TO "Tmp_Files\TMP_Dups.FIL" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:17:11 TMP_Dups EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:17:11 TMP_Cur IF FTYPE("EM001_History")<>"y" OR FILESIZE("History\EM001_History.fil") <0 EXTRACT FIELDS ALL IF 1<>1 TO "History\EM001_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:17:11 TMP_Cur1 EXTRACT FIELDS c_Tax_Fle_Num Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Invalid_TFN Total_PayAmt Total_Pay_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 DUP_KEY ID_KEY TO "History\EM001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:21:47 TMP_Cur1 EXTRACT FIELDS c_Tax_Fle_Num Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Invalid_TFN Total_PayAmt Total_Pay_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 DUP_KEY ID_KEY TO "History\EM001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   _OLD_EM002_History                 _OLD_EM002_History               "History" "EM002_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:17:06 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:17:07 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:17:12 EMF_TMP_Emp EXTRACT FIELDS ALL TMP3.DUP_KEY TMP3.Bnk_KEY Co_Emp_ID TMP3.BSB TMP3.Bnk_Acc_Num TMP3.BSB_NAME TMP3.Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN IF NOT ISBLANK(TMP3.Co_Emp_ID) TO "Tmp_Files\TMP1" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:17:12 TMP1 EXTRACT FIELDS ALL IF NOT ISBLANK(TMP2.DUP_KEY) TO "Tmp_Files\TMP4" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:17:12 TMP4 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:17:12 TMP_Cur IF FTYPE("EM002_History")<>"y" OR FILESIZE("History\EM002_History.fil") <0 EXTRACT FIELDS ALL IF 1<>1 TO "History\EM002_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:17:12 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN DUP_KEY Bnk_KEY Co_Emp_ID2 BSB2 Bnk_Acc_Num2 BSB_NAME2 Bnk_Acc_Name2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:21:49 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN DUP_KEY Bnk_KEY Co_Emp_ID2 BSB2 Bnk_Acc_Num2 BSB_NAME2 Bnk_Acc_Name2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   _OLD_EM003_History                 _OLD_EM003_History               "History" "EM003_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:17:06 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:17:07 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:17:13 EMF_TMP_Emp DUPLICATES ON c_Emp_Nme OTHER ALL BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN PRESORT IF Emp_Sts<>"I" AND c_Emp_Nme<>" " OPEN TO "Tmp_Files\TMP1.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:17:13 TMP1 EXTRACT FIELDS ALL IF NOT ISBLANK(TMP2.DUP_KEY) TO "Tmp_Files\TMP4" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:17:13 TMP4 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:17:13 TMP_Cur IF FTYPE("EM003_History")<>"y" OR FILESIZE("History\EM003_History.fil") <0 EXTRACT FIELDS ALL IF 1<>1 TO "History\EM003_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:17:14 TMP_Cur1 EXTRACT FIELDS c_Emp_Nme Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 DUP_KEY ID_KEY TO "History\EM003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:21:50 TMP_Cur1 EXTRACT FIELDS c_Emp_Nme Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 DUP_KEY ID_KEY TO "History\EM003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   _OLD_EM004_History                 _OLD_EM004_History               "History" "EM004_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:17:06 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:17:07 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:17:15 EMF_TMP_Emp EXTRACT FIELDS ALL TMP9.DUP_KEY TMP9.Add_KEY TMP9.ADD1 AS 'Dup_ADD1' TMP9.ADD2 AS 'Dup_ADD2' TMP9.ADD3 AS 'Dup_ADD3' TMP9.City AS 'Dup_City' TMP9.State AS 'Dup_State' TMP9.Pcode AS 'Dup_Pcode' TMP9.Cntry AS 'Dup_Cntry' BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN IF NOT ISBLANK(TMP9.Co_Emp_ID) AND NOT ISBLANK(EMF_TMP_Emp.Co_Emp_ID) TO "Tmp_Files\TMP4" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:17:15 TMP4 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:17:15 TMP_Cur IF FTYPE("EM004_History")<>"y" OR FILESIZE("History\EM004_History.fil") <0 EXTRACT FIELDS ALL IF 1<>1 TO "History\EM004_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:17:15 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN c_Emp_Nme DUP_KEY Add_KEY Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM004_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:21:52 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN c_Emp_Nme DUP_KEY Add_KEY Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM004_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   _OLD_EM005_History                 _OLD_EM005_History               "History" "EM005_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:17:06 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:17:07 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:17:16 EMF_TMP_Emp EXTRACT FIELDS ALL TMP1.DUP_KEY TMP1.c_Tel BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN IF NOT ISBLANK(TMP1.Co_Emp_ID)  TO "Tmp_Files\TMP4" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:17:17 TMP4 EXTRACT FIELDS ALL IF NOT ISBLANK(TMP2.DUP_KEY) TO "Tmp_Files\TMP3" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:17:17 TMP3 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:17:17 TMP_Cur IF FTYPE("EM005_History")<>"y" OR FILESIZE("History\EM005_History.fil") <0 EXTRACT FIELDS ALL IF 1<>1 TO "History\EM005_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:17:17 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN c_Emp_Nme c_Tel1 c_Tel2 c_Tel3 c_Fax DUP_KEY c_Tel BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:21:53 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN c_Emp_Nme c_Tel1 c_Tel2 c_Tel3 c_Fax DUP_KEY c_Tel BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   _OLD_EM006_History                 _OLD_EM006_History               "C:\ACL_Data\SATORI_EVA_v4.0\History" "EM006_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:17:06 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:17:07 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:21:13 EMF_TMP_Emp  EXTRACT 100000 AS "EM006" ALL BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN IF Emp_Sts="A" AND  LENGTH(ALLTRIM(c_Tel1))<6 AND LENGTH(ALLTRIM(c_Tel2))<6 AND LENGTH(ALLTRIM(c_Tel3))<6 AND LENGTH(ALLTRIM(c_Fax))<6 TO Tmp_Files\TMP1 FIRST 0
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:21:13 TMP1 SUMMARIZE ON Co_Emp_ID Emp_ID SUBTOTAL EM006 OTHER ALL BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN TO "Tmp_Files\TMP2.FIL" OPEN PRESORT
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:21:13 TMP2 EXTRACT FIELDS c_EM006 AS "EM006" ALL BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Test_Name RptRunDate Invalid_TFN TO "Tmp_Files\TMP3" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:21:14 TMP3 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:21:14 TMP_Cur IF FTYPE("EM006_History")<>"y" OR FILESIZE("History\EM006_History.fil") <0 EXTRACT FIELDS ALL FIRST 0 TO "History\EM006_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:21:14 TMP_Cur1 EXTRACT FIELDS EM006 Co_Emp_ID Emp_ID EM0062 COUNT Co COST_CENTRE EMP_Sts Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 BSB3 Bnk_Acc_Num3 Total_PayAmt3 Total_Pay_Num3 Invalid_TFN3 c_EM006 Test_Name RptRunDate BSB4 Bnk_Acc_Num4 Total_PayAmt4 Total_Pay_Num4 Test_Name2 RptRunDate2 Invalid_TFN4 ID_KEY TO "History\EM006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^BATCH    AA002_Variable_Setting             
[PARENT_FOLDER_ID] 1340167442
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Initialising Variables for the application
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATC: 22/06/2012
COM *** EVA 4.0 upgrade, fixed the bugs and enhancements, make it suitable for ACL desktop, ACL CCM, Caseware CCM, AX CCM
COMM***************************************************************************


SET DATE "DD/MM/YYYY"

IF FTYPE("_Version")="U" DELETE ALL OK

_Version = "SATORI EVA V4.0"
v_App_Path="C:\SATORI_EVA_v4.0\SATORI_EVA_v4.0\"
COMM v_ABNChecker_Path="C:\ABNChecker\"
v_ABNChecker_Path="C:\ABN_Checker\"
fld_ABN="ABN\"
Errmsg=" "
COMM FilePath Settings for Invoice VMF and VendorBankAccount 

IF FTYPE("fld_VM_AP_Inv_Fld")="U" fld_VM_AP_Inv_Fld="C:\Data\Invoices_"
IF FTYPE("fld_VM_AP_Inv_Ext")="U" fld_VM_AP_Inv_Ext=".txt"
IF FTYPE("fld_VM_AP_VMF_Fld")="U" fld_VM_AP_VMF_Fld="C:\Data\VendorMasterfile_"
IF FTYPE("fld_VM_AP_VMF_Ext")="U" fld_VM_AP_VMF_Ext=".txt"
IF FTYPE("fld_VM_AP_VMBnk_Fld")="U" fld_VM_AP_VMBnk_Fld="C:\Data\VendorBankAccount_"
IF FTYPE("fld_VM_AP_VMBnk_Ext")="U" fld_VM_AP_VMBnk_Ext=".txt"
IF FTYPE("fld_Data_Path")="U" fld_Data_Path = "C:\Data\"
IF FTYPE("fld_Archive_Path")="U" fld_Archive_Path="C:\Data_Archive\"

COMM 7Zip settings
IF FTYPE("fld_7Z_Path")="U" fld_7Z_Path = "C:\Program Files\7-Zip\"
IF FTYPE("v_7Z_Pwd")="U" v_7Z_Pwd = "Satori"
_Last2YearTranDt = TODAY() - 730

COMM *** set up the switch to run the EVA scripts for ACL desktop, or AX, or CasewarC: ="ACL", ="AX",="CWM" ***
IF FTYPE("v_ACL_AX_CWM")="U" v_ACL_AX_CWM="ACL"

v_AppACL="COMMENT"
v_AppAX="COMMENT"
v_AppCWM="COMMENT"
v_CCMJob="COMMENT"

IF v_ACL_AX_CWM="ACL" v_AppACL=""
IF v_ACL_AX_CWM="AX" v_AppAX=""
IF v_ACL_AX_CWM="CWM" v_AppCWM=""
IF v_ACL_AX_CWM="ACL" v_CCMJob=""

COMM *** set up the switch to choose run EVA with (ON)/without(OFF) AP Invoice, by default is v_APInvoice_ON=T***
v_APInvoice_ON=T

COMM *** set a switch variable to turn the scripts onto ABN checker v3 or v3.1 ***
IF FTYPE("v_ABNChecker_Version")="U" v_ABNChecker_Version="3.1"
IF v_ABNChecker_Version="3.1" v_ABNChecker3="COMMENT"
IF v_ABNChecker_Version="3.1" v_ABNChecker31=""
IF v_ABNChecker_Version<>"3.1" v_ABNChecker3=""
IF v_ABNChecker_Version<>"3.1" v_ABNChecker31="COMMENT"

DM_Flag=T

COMM *** folder for source data files ***
fld_Data = "Data\"

fld_Sources = "Sources\"
fld_Reports = "Reports\"
fld_Results = "Results\"
fld_Workings = "Working_Files\"
fld_Tmps = "Tmp_Files\"
fld_History = "History\"
fld_DataMapping = "DataMapping\"
TXT_Exp_filepath="Reports\"
fld_GL="GreyList\"
fld_GL_Path="GreyList\"
fld_Logs="Logs\"


trg_VMF="VMF_Vnd_Master_File"
trg_VMF_Bk="VMF_BnkAcc"
trg_VMF_Add="VMF_Address"
trg_VMF_GL="AP_GrayList"
trg_VMF_OTV="VMF_Vnd_OneTime"
trg_VMF_InterCo="VMF_InterCompany"
trg_AP_Inv="AP_Invoices"
trg_AP_Pay="AP_Payments"
trg_AP_PO="AP_PO_Lines"
trg_AP_InvPO="AP_InvPO"
trg_EMF="EMF_Emp_Master_File"
trg_EMF_Bk="EMF_BnkAcc"
trg_PR_Pay="Payroll_Payments"
trg_EMF_Lv="EMF_Leaves"

COMM *** History switch ***
v_ID_KEY=""
v_TEST_NO=""
v_ID_KEY=""
IF FTYPE("v_Exc_History")="U" v_Exc_History=F
IF FTYPE("v_Chk_CCM")="U" v_Chk_CCM=F

COMM *** GreyList switch ***
IF FTYPE("v_Exc_GreyList")="U" v_Exc_GreyList=T

COMM *** Generate the fields for the tests ***

v_flds_VMF="%trg_VMF%.Vndr_Site_ID %trg_VMF%.Co %trg_VMF%.Vndr_ID %trg_VMF%.Vndr_Nme %trg_VMF%.ABN %trg_VMF%.Vndr_Sts %trg_VMF%.Vndr_Typ %trg_VMF%.Vndr_Add_Typ %trg_VMF%.ADD1 %trg_VMF%.ADD2 %trg_VMF%.ADD3 %trg_VMF%.City %trg_VMF%.State %trg_VMF%.Pcode %trg_VMF%.Cntry %trg_VMF%.TEL1 %trg_VMF%.TEL2 %trg_VMF%.TEL3 %trg_VMF%.FAX %trg_VMF%.Email1 %trg_VMF%.Email2 %trg_VMF%.Pymnt_Trm CTOD(DATE(%trg_VMF%.Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(%trg_VMF%.Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(%trg_VMF%.Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' %trg_VMF%.Cha_Field1 %trg_VMF%.Cha_Field2 %trg_VMF%.Cha_Field3 %trg_VMF%.Cha_Field4 %trg_VMF%.Cha_Field5 %trg_VMF%.Num_Field1 %trg_VMF%.Num_Field2 %trg_VMF%.Num_Field3 %trg_VMF%.Num_Field4 %trg_VMF%.Num_Field5 CTOD(DATE(%trg_VMF%.Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(%trg_VMF%.Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(%trg_VMF%.Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' %trg_VMF%.ABN_CLN %trg_VMF%.Max_Inv_Dt %trg_VMF%.c_Vndr_ID"

v_flds_VMF1="Vndr_Site_ID Co Vndr_ID Vndr_Nme ABN Vndr_Sts Vndr_Typ Vndr_Add_Typ ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 FAX Email1 Email2 Pymnt_Trm CTOD(DATE(Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Vndr_InvlDt),'DD/MM/YYYY') AS 'Vndr_InvlDt' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' ABN_CLN Max_Inv_Dt c_Vndr_ID"

v_flds_VndEmp="Vnd_Emp_Master.Vndr_Site_ID Vnd_Emp_Master.Vndr_ID Vnd_Emp_Master.Vndr_Nme Vnd_Emp_Master.ABN Vnd_Emp_Master.Vndr_Sts Vnd_Emp_Master.Vndr_Typ Vnd_Emp_Master.ABN Vnd_Emp_Master.BSB Vnd_Emp_Master.Bnk_Acc_Num Vnd_Emp_Master.ADD1 Vnd_Emp_Master.ADD2 Vnd_Emp_Master.ADD3 Vnd_Emp_Master.City Vnd_Emp_Master.State Vnd_Emp_Master.Pcode Vnd_Emp_Master.Cntry Vnd_Emp_Master.TEL1 Vnd_Emp_Master.TEL2 Vnd_Emp_Master.TEL3 Vnd_Emp_Master.FAX Vnd_Emp_Master.Email1 Vnd_Emp_Master.Email2 Vnd_Emp_Master.Inv_Amt Vnd_Emp_Master.GST_AMT Vnd_Emp_Master.COUNT Vnd_Emp_Master.Hire_Dt Vnd_Emp_Master.Trm_Dt Vnd_Emp_Master.Created_Dt Vnd_Emp_Master.Modf_Dt"

v_flds_VMF_BK="Vndr_Site_ID Vndr_ID BSB  Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Bnk_Acc_Type Chg_Dt CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' Cha_Field1"

v_flds_AP_Inv="Vndr_Site_ID Vndr_ID Vchr_ID ABS_INVAMT isPaid Doc_Typ CTOD(DATE(Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' Inv_No Inv_Amt Inv_Amt_Doc Curncy Inv_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5  c_Inv_No c_Inv_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ"

v_flds_AP_Inv1="%trg_AP_Inv%.Vndr_Site_ID %trg_AP_Inv%.Vndr_ID %trg_AP_Inv%.Vchr_ID %trg_AP_Inv%.ABS_INVAMT %trg_AP_Inv%.isPaid %trg_AP_Inv%.Doc_Typ CTOD(DATE(%trg_AP_Inv%.Inv_Dt),'DD/MM/YYYY') AS 'Inv_Dt' %trg_AP_Inv%.Inv_No %trg_AP_Inv%.Inv_Amt %trg_AP_Inv%.Inv_Amt_Doc %trg_AP_Inv%.Curncy %trg_AP_Inv%.Inv_Net_Amt %trg_AP_Inv%.GST_Amt %trg_AP_Inv%.Btch_No CTOD(DATE(%trg_AP_Inv%.Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' %trg_AP_Inv%.Descrp CTOD(DATE(%trg_AP_Inv%.Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' %trg_AP_Inv%.Pymnt_Trms %trg_AP_Inv%.Modf_By CTOD(DATE(%trg_AP_Inv%.Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(%trg_AP_Inv%.Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' %trg_AP_Inv%.Ex_Rate %trg_AP_Inv%.VOIDED CTOD(DATE(%trg_AP_Inv%.Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' %trg_AP_Inv%.Num_Field1 %trg_AP_Inv%.Num_Field2 %trg_AP_Inv%.Num_Field3 %trg_AP_Inv%.Num_Field4 %trg_AP_Inv%.Num_Field5 CTOD(DATE(%trg_AP_Inv%.Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(%trg_AP_Inv%.Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(%trg_AP_Inv%.Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' %trg_AP_Inv%.Cha_Field1 %trg_AP_Inv%.Cha_Field2 %trg_AP_Inv%.Cha_Field3 %trg_AP_Inv%.Cha_Field4 %trg_AP_Inv%.Cha_Field5 %trg_AP_Inv%.c_Inv_No %trg_AP_Inv%.c_Inv_Dt %trg_AP_Inv%.Vndr_Mstr_ID %trg_AP_Inv%.Vndr_Nme %trg_AP_Inv%.Vndr_Sts %trg_AP_Inv%.Vndr_Typ"


v_flds_AP_Pay="Vndr_Site_ID Vchr_ID Vndr_ID Doc_Typ CTOD(DATE(Pay_Dt),'DD/MM/YYYY') AS 'Pay_Dt' Pay_No Pay_Amt Pay_Amt_Doc Curncy Pay_Net_Amt GST_Amt Btch_No CTOD(DATE(Due_Dt),'DD/MM/YYYY') AS 'Due_Dt' PO_No PO_Net_Amt Descrp CTOD(DATE(Pd_Dt),'DD/MM/YYYY') AS 'Pd_Dt' Pymnt_Trms Modf_By CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' CTOD(DATE(Pst_Dt),'DD/MM/YYYY') AS 'Pst_Dt' Ex_Rate VOIDED CTOD(DATE(Void_Dt),'DD/MM/YYYY') AS 'Void_Dt' Chq_No Pymnt_Mth Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 c_Pay_No c_Pay_Dt Vndr_Mstr_ID Vndr_Nme Vndr_Sts Vndr_Typ"

v_flds_PO_Ln="Vndr_Site_ID Vndr_ID PO_NO CTOD(DATE(PO_Date),'DD/MM/YYYY') AS 'PO_Date' Amount Net_Price PO_Qty Rec_Qty Rec_Amt CTOD(DATE(Rec_Dt),'DD/MM/YYYY') AS 'Rec_Dt' GST_AMT PO_Line_No Item_Cd Item_Desc Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' CTOD(DATE(Dt_Field3),'DD/MM/YYYY') AS 'Dt_Field3' Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 "

v_flds_PO="Vndr_Site_ID Vndr_ID PO_NO Amount Rec_Amt PO_Qty Rec_Qty CTOD(DATE(PO_Date),'DD/MM/YYYY') AS 'PO_Date' CTOD(DATE(Rec_Dt),'DD/MM/YYYY') AS 'Rec_Dt' COUNT"

COMM v_flds_EMF="Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme Add1 Add2 Add3 City State PCode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt CTOD(DATE(DOB),'DD/MM/YYYY') AS 'DOB' Sex CTOD(DATE(Hire_Dt),'DD/MM/YYYY') AS 'Hire_Dt' CTOD(DATE(Trm_Dt),'DD/MM/YYYY') AS 'Trm_Dt' Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY Standard_WeeklyHours Emp_Catg CTOD(DATE(Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' SLTotalUnits ALTotalUnits LSLTotalUnits Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Cha_Field6 Cha_Field7 Cha_Field8 Cha_Field9 Cha_Field10 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num"


v_flds_EMF="ALL"


COMM v_flds_EMF1="EMF_TMP_Emp.Co_Emp_ID EMF_TMP_Emp.Co EMF_TMP_Emp.COST_CENTRE EMF_TMP_Emp.EMP_Sts EMF_TMP_Emp.Emp_ID EMF_TMP_Emp.Tax_Fle_Num EMF_TMP_Emp.Tax_Scale EMF_TMP_Emp.Title EMF_TMP_Emp.Frst_Nme EMF_TMP_Emp.Second_Given_Name EMF_TMP_Emp.Sur_Nme EMF_TMP_Emp.Add1 EMF_TMP_Emp.Add2 EMF_TMP_Emp.Add3 EMF_TMP_Emp.City EMF_TMP_Emp.State EMF_TMP_Emp.PCode EMF_TMP_Emp.Cntry EMF_TMP_Emp.TEL1 EMF_TMP_Emp.TEL2 EMF_TMP_Emp.TEL3 EMF_TMP_Emp.Fax EMF_TMP_Emp.Email_Bus EMF_TMP_Emp.Email_Privt CTOD(DATE(EMF_TMP_Emp.DOB),'DD/MM/YYYY') AS 'DOB' EMF_TMP_Emp.Sex CTOD(DATE(EMF_TMP_Emp.Hire_Dt),'DD/MM/YYYY') AS 'Hire_Dt' CTOD(DATE(EMF_TMP_Emp.Trm_Dt),'DD/MM/YYYY') AS 'Trm_Dt' EMF_TMP_Emp.Term_Reason_Desc EMF_TMP_Emp.Mrtl_Sts EMF_TMP_Emp.Pref_Nme EMF_TMP_Emp.Prev_Sur_Nme EMF_TMP_Emp.PAY_CLASS_CODE EMF_TMP_Emp.PAY_RATE EMF_TMP_Emp.AVG_TRANS_RATE EMF_TMP_Emp.YEARLY_SALARY EMF_TMP_Emp.Standard_WeeklyHours EMF_TMP_Emp.Emp_Catg CTOD(DATE(EMF_TMP_Emp.Created_Dt),'DD/MM/YYYY') AS 'Created_Dt' CTOD(DATE(EMF_TMP_Emp.Modf_Dt),'DD/MM/YYYY') AS 'Modf_Dt' EMF_TMP_Emp.SLTotalUnits EMF_TMP_Emp.ALTotalUnits EMF_TMP_Emp.LSLTotalUnits EMF_TMP_Emp.Cha_Field1 EMF_TMP_Emp.Cha_Field2 EMF_TMP_Emp.Cha_Field3 EMF_TMP_Emp.Cha_Field4 EMF_TMP_Emp.Cha_Field5 EMF_TMP_Emp.Cha_Field6 EMF_TMP_Emp.Cha_Field7 EMF_TMP_Emp.Cha_Field8 EMF_TMP_Emp.Cha_Field9 EMF_TMP_Emp.Cha_Field10 EMF_TMP_Emp.Emp_Nme EMF_TMP_Emp.c_Hire_Dt EMF_TMP_Emp.BSB EMF_TMP_Emp.Bnk_Acc_Num"

v_flds_EMF1="ALL"

v_flds_EMF_BK="Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type Chg_Dt"

v_flds_EMF_Leaves="Co_Emp_ID Emp_ID LeaveType LeaveTypeDesc CTOD(DATE(StartDate),'DD/MM/YYYY') AS 'StartDate' CTOD(DATE(EndDate),'DD/MM/YYYY') AS 'EndDate' Units Amount Notes ApprovalStatus ApprovedByCode CTOD(DATE(ApprovedDate),'DD/MM/YYYY') AS 'ApprovedDate' CTOD(DATE(CreatedDate),'DD/MM/YYYY') AS 'CreatedDate' CreatedBy Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5"

COMM v_flds_PR="Line_No Co_Emp_ID Co Cost_Centre Emp_ID PayCode PayCode_Desc PayCode_Amount Currency Pay_Hrs Pay_Rate CTOD(DATE(Prd_Dt),'DD/MM/YYYY') AS 'Prd_Dt' ForPrd InPrd CTOD(DATE(PeriodStart_Dt),'DD/MM/YYYY') AS 'PeriodStart_Dt' CTOD(DATE(PeriodEnd_Dt),'DD/MM/YYYY') AS 'PeriodEnd_Dt' PayGroup GL_Account_No PayRunDesc Num_Field1 Num_Field2 Num_Field3 Num_Field4 Num_Field5 Dt_Field1 Dt_Field2 Dt_Field3 Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Cha_Field6 Cha_Field7 Cha_Field8 Cha_Field9 Cha_Field10 Year YM c_Prd_Dt ABS_PayCode_Amount"


v_flds_PR="ALL"


_RptRunDate=CTOD(DATE(),"DD/MM/YYYY")
_RptRunDateTime=SUBSTR(ALLTRIM(DATE()) + " "+ ALLTRIM(TIME()),1,19)

_Last2YearTranCha = DATE(_RptRunDate- 365*2)
_Last2YearTranDt=CTOD(_Last2YearTranCha,"DD/MM/YYYY")

_LastYearTranCha = DATE(_RptRunDate- 365)
_LastYearTranDt=CTOD(_LastYearTranCha,"DD/MM/YYYY")

_Last_Month = DATE(_RptRunDate- 30)
_Last_6Month = DATE(_RptRunDate- 180)
_Last_Week=DATE(_RptRunDate- 7)

_Year = LAST(ALLTRIM(DATE()),4)

COMM *** Inisiate the data range ***
IF FTYPE("_Data_Range_Start_Date")="v" OR FTYPE("_Data_Range_Start_Date")="U" _Data_Range_Start_Date= _Last2YearTranDt
IF FTYPE("_Data_Range_End_Date")="v" OR FTYPE("_Data_Range_End_Date")="U"  _Data_Range_End_Date =_RptRunDate

IF FTYPE("_PR_Data_Start_Date")="v" OR FTYPE("_PR_Data_Start_Date")="U" _PR_Data_Start_Date= _LastYearTranDt
IF FTYPE("_PR_Data_End_Date")="v" OR FTYPE("_PR_Data_End_Date")="U"  _PR_Data_End_Date =_RptRunDate

_CurrentDate = CTOD("01/"+SUBSTR(ALLTRIM(DATE(_RptRunDate)),4,2)+"/"+LAST(ALLTRIM(DATE(_RptRunDate)),4),"DD/MM/YYYY")
_FiscalYear= LAST(ALLTRIM(DATE(_CurrentDate-28)),4)
_FiscalYM=SUBSTR(ALLTRIM(DATE(_CurrentDate-28)),4,2)+"/"+LAST(ALLTRIM(DATE(_CurrentDate-28)),4)


COMM *** Re-Link the .fil source files to their format *** 
IF FTYPE("DM_AP_Invoices") = "y" AND FILESIZE("%fld_DataMapping%DM_AP_Invoices.fil")>=0 OPEN "%fld_DataMapping%DM_AP_Invoices.fil" FORMAT DM_AP_Invoices
IF FTYPE("DM_AP_Payments ") = "y" AND FILESIZE("%fld_DataMapping%DM_AP_Payments .fil")>=0 OPEN "%fld_DataMapping%DM_AP_Payments .fil" FORMAT DM_AP_Payments 
IF FTYPE("DM_AP_PO_Lines") = "y" AND FILESIZE("%fld_DataMapping%DM_AP_PO_Lines.fil")>=0 OPEN "%fld_DataMapping%DM_AP_PO_Lines.fil" FORMAT DM_AP_PO_Lines

IF FTYPE("DM_VMF_Vnd_Master_File") = "y" AND FILESIZE("%fld_DataMapping%DM_VMF_Vnd_Master_File.fil")>=0 OPEN "%fld_DataMapping%DM_VMF_Vnd_Master_File.fil" FORMAT DM_VMF_Vnd_Master_File
IF FTYPE("DM_VMF_Address") = "y" AND FILESIZE("%fld_DataMapping%DM_VMF_Address.fil")>=0 OPEN "%fld_DataMapping%DM_VMF_Address.fil" FORMAT DM_VMF_Address
IF FTYPE("DM_VMF_BnkAcc") = "y" AND FILESIZE("%fld_DataMapping%DM_VMF_BnkAcc.fil")>=0 OPEN "%fld_DataMapping%DM_VMF_BnkAcc.fil" FORMAT DM_VMF_BnkAcc
IF FTYPE("DM_VMF_InterCompany") = "y" AND FILESIZE("%fld_DataMapping%DM_VMF_InterCompany.fil")>=0 OPEN "%fld_DataMapping%DM_VMF_InterCompany.fil" FORMAT DM_VMF_InterCompany
IF FTYPE("DM_VMF_Vnd_OneTime") = "y" AND FILESIZE("%fld_DataMapping%DM_VMF_Vnd_OneTime.fil")>=0 OPEN "%fld_DataMapping%DM_VMF_Vnd_OneTime.fil" FORMAT DM_VMF_Vnd_OneTime
IF FTYPE("DM_AP_GrayList") = "y" AND FILESIZE("%fld_DataMapping%DM_AP_GrayList.fil")>=0 OPEN "%fld_DataMapping%DM_AP_GrayList.fil" FORMAT DM_AP_GrayList

IF FTYPE("DM_Payroll_Payments") = "y" AND FILESIZE("%fld_DataMapping%DM_Payroll_Payments.fil")>=0 OPEN "%fld_DataMapping%DM_Payroll_Payments.fil" FORMAT DM_Payroll_Payments
IF FTYPE("DM_EMF_Emp_Master_File") = "y" AND FILESIZE("%fld_DataMapping%DM_EMF_Emp_Master_File.fil")>=0 OPEN "%fld_DataMapping%DM_EMF_Emp_Master_File.fil" FORMAT DM_EMF_Emp_Master_File
IF FTYPE("DM_EMF_BnkAcc") = "y" AND FILESIZE("%fld_DataMapping%DM_EMF_BnkAcc.fil")>=0 OPEN "%fld_DataMapping%DM_EMF_BnkAcc.fil" FORMAT DM_EMF_BnkAcc

COMM *** Payroll Code Type query variables ***
v_PeriodGrossAmount="NOT FIND('Payroll Tax',PayCode_Desc) AND NOT FIND('Superannuation',PayCode_Desc) AND NOT FIND('Loading',PayCode_Desc) "
v_PaidAmount="NOT FIND('Payroll Tax',PayCode_Desc) AND NOT FIND('Superannuation',PayCode_Desc) AND NOT FIND('Loading',PayCode_Desc) "
v_SalaryHours="PayCode='SAL' "
v_WorkedHours="Pay_Hrs<>0.00"
v_TerminationAmount="FIND('Termination',PayCode_Desc)"
v_Overtime="FIND('OT  ',PayCode_Desc) OR FIND('Overtime ',PayCode_Desc)"
v_Allowance="FIND('Allowance',PayCode_Desc)"
v_LongServiceLeave="FIND('LSL ',PayCode_Desc) OR FIND('LONG SERVICE LEAVE',PayCode_Desc)"
v_SpecialLeave="MATCH(PayCode_Desc,'Do Not Pay','Inactive Status','Income Protection','Long Term Unpaid Leave','Parental Leave','Paternity Leave','Workers Compensation')"
COMM *** e.g. TXT_PR006_SuperPayCodes="MATCH(PayCode,'Super Company Contrib')" just for example, need to confirm with client ***
v_SuperPayCodes="FIND('Superannuation Voluntary',PayCode_Desc)"
v_IsSuperablePayCodes="NOT MATCH(PayCode_Desc,'Payroll Tax; PAYROLL TAX SOUTH AUST','Superannuation Voluntary;','Annual Leave; LEAVE LOADING')"


COMM *** create working folders if they are not existing***
DO ZA001_CreateFlds
^INDEX    pay_period                         Payroll                          "" "pay_period.INX" 
* INDEX ON PAY_PERIOD TO "PAY_PERIOD.INX"
^REPORT   Default_View                       PAYROLL_DATA                     D.T,
[SKIP] 0
[TLINES] 2
[RLINES] 1
[LINE] 1
WEEKLY_HOURS         WIDTH 14 PICTURE ""
[LINE] 1
Pay_Hrs              WIDTH 9 PICTURE ""
[LINE] 1
PER_YM               WIDTH 9 PICTURE ""
[LINE] 1
V_PAY_CDE_DESC       WIDTH 15 PICTURE ""
[LINE] 1
V_PAY_CDE            WIDTH 11 PICTURE ""
[LINE] 1
pay_period           WIDTH 11 PICTURE ""
[LINE] 1
approved_by          WIDTH 12 PICTURE ""
[LINE] 1
approved_on          WIDTH 12 PICTURE ""
[LINE] 1
created_by           WIDTH 11 PICTURE ""
[LINE] 1
created_on           WIDTH 11 PICTURE ""
[LINE] 1
employee_number      WIDTH 16 PICTURE ""
[LINE] 1
gross_pay            WIDTH 10 PICTURE "(9,999,999.99)"
[LINE] 1
deducations          WIDTH 11 PICTURE "(9,999,999.99)"
[LINE] 1
net_pay              WIDTH 9 PICTURE "(9,999,999.99)"
[LINE] 1
payroll_date         WIDTH 12 PICTURE ""
^FORMAT   PAYROLL_DATA                       PAYROLL_DATA                     "" "PAYROLL_DATA.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1455775988
~.20160219     14:30:29 Payroll_details EXTRACT FIELDS WEEKLY_HOURS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
[LASTVIEW] "Default_View"
^BATCH    PR_ADD_REQ_FLDS                    
[PARENT_FOLDER_ID] 1455780570



SET SAFETY OFF
CLOSE PRI SECOND
SET DATE "YYYYMMDD"

SET FOLDER /SOURCES/PR

OPEN Payroll
 INDEX ON pay_period TO "pay_period.INX"

OPEN Payroll_details
 DEFINE RELATION pay_period WITH Payroll INDEX pay_period


DELETE V_PAY_CDE OK
 DEFINE FIELD V_PAY_CDE COMPUTED "001"

DELETE WEEKLY_HOURS OK
 DEFINE FIELD WEEKLY_HOURS COMPUTED 40



comm NOT FIND('Payroll Tax',PayCode_Desc) AND NOT FIND('Superannuation',PayCode_Desc) AND NOT FIND('Loading',PayCode_Desc)

DELETE V_PAY_CDE_DESC OK
 DEFINE FIELD V_PAY_CDE_DESC COMPUTED "MONTHLY PAY"


DELETE PER_YM OK
 DEFINE FIELD PER_YM COMPUTED SUBSTR(DATE(Payroll.payroll_date) , 1 , 6)


DELETE Pay_Hrs OK
 DEFINE FIELD Pay_Hrs COMPUTED RAND(5678)



EXTRACT FIELDS ALL WEEKLY_HOURS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN


^BATCH    MP003_Convert_EMF                  
[PARENT_FOLDER_ID] 1430796753
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Convert Source Data To Target Working File Tables: Employee Master File
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


IF FTYPE("fld_Workings")="U" OR FTYPE("trg_EMF")="U" DO AA002_Variable_Setting

SET SAFETY OFF
SET DATE "DD/MM/YYYY"
SET FOLDER/%fld_Workings%

COMM *** convert Employee master file ***

COMM *** Capture the linkage relationships for the data mapping, convert the source data into target standard table ***
OPEN DM_%trg_EMF%

COMM *** Extract the mapping information from the mapping file (e.g. DM_VMF_Vnd_Master_File)***
DO MZ001_Convert

COMM *** IF relationship between source table and target table has not been build, need to build the relationship first, goto the menu "Link fields/Mapping" ***
%v_CCMJob% IF src_File_Name="" OR v_COUNT=0 OR v_Flds_Extract="" PAUSE "There is no data mapping information - Employee Master File, please link/map the source fields to the standard fields first."
IF src_File_Name="" OR v_COUNT=0 OR v_Flds_Extract="" DO LE001_Link_Menu

COMM *** IF relationship between source table and target table has been build, convert data directely. ***

IF src_File_Name<>"" AND v_Flds_Extract<>""  OPEN %src_File_Name%
IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS %v_Flds_Extract%  TO "%fld_Workings%%trg_EMF%.FIL"

%v_CCMJob% IF FILESIZE("%fld_Workings%%trg_EMF%.fil")<=0 PAUSE "Employee Master File Table has not been convert properly. Please check the fields mapping and convert it again."
IF FILESIZE("%fld_Workings%%trg_EMF%.fil")<=0 ESCAPE

COMM *** convert Employee Bank Accounts***
OPEN DM_%trg_EMF_BK%
DO MZ001_Convert
IF src_File_Name<>"" AND v_Flds_Extract<>""  OPEN %src_File_Name%
IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS %v_Flds_Extract% TO "%fld_Workings%%trg_EMF_BK%_Tmp.FIL" OPEN

EXTRACT FIELDS ALL IF INCLUDE(Bnk_Acc_Num,"0123456789") <>"" TO "%fld_Workings%%trg_EMF_BK%.FIL" 

COMM *** convert Employee Leaves***
v_cmtLv=""
%v_cmtLv% IF FTYPE("DM_%trg_EMF_Lv%")="U" v_cmtLv="COMMENT"
%v_cmtLv% OPEN DM_%trg_EMF_Lv%
%v_cmtLv% DO MZ001_Convert
%v_cmtLv% IF src_File_Name<>"" AND v_Flds_Extract<>""  OPEN %src_File_Name%
%v_cmtLv% IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS %v_Flds_Extract% TO "%fld_Workings%%trg_EMF_Lv%.FIL" OPEN

COMM *** prepare Employee master file ***

OPEN %trg_EMF%
INDEX ON Co_Emp_ID TO IDX_Co_Emp_ID

DELETE FIELD Emp_Nme OK
DEFINE FIELD Emp_Nme COMPUTED SUBSTR(ALLTRIM(Sur_Nme)+" " + ALLTRIM(Second_Given_Name) +" "+ALLTRIM(Frst_Nme),1,65) 
 
DELETE FIELD c_Hire_Dt OK 
DEFINE FIELD c_Hire_Dt COMPUTED ALLTRIM(SUBSTR(DATE(Hire_Dt),7,4))+ALLTRIM(SUBSTR(DATE(Hire_Dt),4,2))+ALLTRIM(SUBSTR(DATE(Hire_Dt),1,2))

COMM *** Create relations between tables ***
IF FTYPE("%trg_EMF_BK%")="y" AND FILESIZE("%fld_Workings%%trg_EMF_BK%.fil") >= 0 OPEN %trg_EMF_BK%
IF FTYPE("%trg_EMF_BK%")="y" AND FILESIZE("%fld_Workings%%trg_EMF_BK%.fil") >= 0 DEFINE RELATION Co_Emp_ID WITH %trg_EMF% INDEX IDX_Co_Emp_ID
IF FTYPE("%trg_EMF_BK%")="y" AND FILESIZE("%fld_Workings%%trg_EMF_BK%.fil") >= 0 INDEX ON Co_Emp_ID TO IDX_Emp_BK_Co_Emp_ID

%v_cmtLv% OPEN %trg_EMF_Lv%
%v_cmtLv% DEFINE RELATION Co_Emp_ID WITH %trg_EMF% INDEX IDX_Co_Emp_ID

OPEN %trg_EMF%
IF FTYPE("%trg_EMF_BK%")="y" AND FILESIZE("%fld_Workings%%trg_EMF_BK%.fil") >= 0 DEFINE RELATION Co_Emp_ID WITH %trg_EMF_BK% INDEX IDX_Emp_BK_Co_Emp_ID
IF FTYPE("%trg_EMF_BK%")="y" AND FILESIZE("%fld_Workings%%trg_EMF_BK%.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "%fld_Workings%EMF_TMP_Emp" OPEN
 

INDEX ON Co_Emp_ID TO IDX_EMF_Co_Emp_ID

DELETE FIELD c_Tax_Fle_Num OK
DEFINE FIELD c_Tax_Fle_Num COMPUTED ALLTRIM(INCLUDE(Tax_Fle_Num, "0123456789"))

DELETE FIELD Invalid_TFN OK
DEFINE FIELD Invalid_TFN COMPUTED

"F" IF MOD( (((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 1 , 1 ),0)*1)) + ((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 2 , 1 ),0)*4)) + ((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 3 , 1 ),0)*3)) + ((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 4 , 1 ),0)*7)) + ((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 5 , 1 ),0)*5)) + ((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 6 , 1 ),0)*8)) + ((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 7 , 1 ),0)*6)) + ((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 8 , 1 ),0)*9)) + ((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 9 , 1 ),0)*10))) , 11 ) = 0
"F" IF c_Tax_Fle_Num = "111111111"
"T"

IF FTYPE("Payroll_Sum_12m")="y" AND FILESIZE("%fld_Workings%Payroll_Sum_12m.fil") >= 0 OPEN EMF_TMP_Emp
IF FTYPE("Payroll_Sum_12m")="y" AND FILESIZE("%fld_Workings%Payroll_Sum_12m.fil") >= 0 DEFINE RELATION Co_Emp_ID WITH Payroll_Sum_12m INDEX IDX_Payroll_Sum_ID

IF FTYPE("Payroll_Sum_12m")="y" AND FILESIZE("%fld_Workings%Payroll_Sum_12m.fil") >= 0 OPEN EMF_TMP_Emp
IF FTYPE("Payroll_Sum_12m")="y" AND FILESIZE("%fld_Workings%Payroll_Sum_12m.fil") >= 0 DELETE FIELD Total_PayAmt OK
IF FTYPE("Payroll_Sum_12m")="y" AND FILESIZE("%fld_Workings%Payroll_Sum_12m.fil") >= 0 DEFINE FIELD Total_PayAmt COMPUTED Payroll_Sum_12m.ActPaidAmt
IF FTYPE("Payroll_Sum_12m")="y" AND FILESIZE("%fld_Workings%Payroll_Sum_12m.fil") >= 0 DELETE FIELD Total_Pay_Num OK
IF FTYPE("Payroll_Sum_12m")="y" AND FILESIZE("%fld_Workings%Payroll_Sum_12m.fil") >= 0 DEFINE FIELD Total_Pay_Num COMPUTED Payroll_Sum_12m.COUNT


COMMENT
SR ERR:
CREATED THIS FIELD
END


DELETE Standard_WeeklyHours OK
 DEFINE FIELD Standard_WeeklyHours COMPUTED 40






COMMENT
SR ADDED ERROR TRAP IF 12 MONTHS PAY DOES NOT EXISTS, TO CREATE THE FIELDS AND ZERO IT...
END

COMM
IF FTYPE("Payroll_Sum_12m")="U"  OPEN EMF_TMP_Emp
IF FTYPE("Payroll_Sum_12m")="U"  DELETE FIELD Total_PayAmt OK
IF FTYPE("Payroll_Sum_12m")="U"  DEFINE FIELD Total_PayAmt COMPUTED 0
IF FTYPE("Payroll_Sum_12m")="U"  DELETE FIELD Total_Pay_Num OK
IF FTYPE("Payroll_Sum_12m")="U"  DEFINE FIELD Total_Pay_Num COMPUTED 0
END
 
COMM *** BEGIN Save all EMF Bank Account changes into EMF_BnkAcc_Chg_History ***
IF FTYPE("%trg_EMF_BK%")="y" AND FTYPE("%trg_EMF_BK%_Tmp")="y" DO MZ005_EmpBk_Chg_His

COMM *** END Save all historical changes into VMF_Chg_History ***

IF FTYPE("%trg_EMF_BK%_Tmp")="y" DELETE FORMAT %trg_EMF_BK%_Tmp OK
IF FTYPE("%trg_EMF_BK%_Tmp")="y" DELETE "%fld_Workings%%trg_EMF_BK%_Tmp.FIL" OK

SET SAFETY ON
^FORMAT   DM_AP_Invoices                     DM_AP_Invoices                   "C:\ACL_Data\SATORI_EVA_v4.0\DataMapping" "DM_AP_Invoices.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1427250162
[RETRIEVE] 0
[REFRESH] EXCEL "DataMapping\DM_AP_Invoices.fil" FROM "DataMapping\DataMapping.xlsx" TABLE "AP_Invoices$" KEEPTITLE
^FORMAT   DM_AP_Payments                     DM_AP_Payments                   "C:\ACL_Data\SATORI_EVA_v4.0\DataMapping" "DM_AP_Payments.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1427250162
[RETRIEVE] 0
[REFRESH] EXCEL "DataMapping\DM_AP_Payments.fil" FROM "DataMapping\DataMapping.xlsx" TABLE "AP_Payments$" KEEPTITLE
^FORMAT   DM_AP_PO_Lines                     DM_AP_PO_Lines                   "C:\ACL_Data\SATORI_EVA_v4.0\DataMapping" "DM_AP_PO_Lines.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1427250162
[RETRIEVE] 0
[REFRESH] EXCEL "DataMapping\DM_AP_PO_Lines.fil" FROM "DataMapping\DataMapping.xlsx" TABLE "PO_Lines$" KEEPTITLE
^FORMAT   DM_AP_InvPO                        DM_AP_InvPO                      "C:\ACL_Data\SATORI_EVA_v4.0\DataMapping" "DM_AP_InvPO.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1427250162
[RETRIEVE] 0
[REFRESH] EXCEL "DataMapping\DM_AP_InvPO.fil" FROM "DataMapping\DataMapping.xlsx" TABLE "AP_InvPO$" KEEPTITLE
^FORMAT   DM_VMF_Vnd_Master_File             DM_VMF_Vnd_Master_File           "C:\ACL_Data\SATORI_EVA_v4.0\DataMapping" "DM_VMF_Vnd_Master_File.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1427250162
[RETRIEVE] 0
[REFRESH] EXCEL "DataMapping\DM_VMF_Vnd_Master_File.fil" FROM "DataMapping\DataMapping.xlsx" TABLE "VMF_Vnd_Master_File$" KEEPTITLE
^FORMAT   DM_VMF_Address                     DM_VMF_Address                   "C:\ACL_Data\SATORI_EVA_v4.0\DataMapping" "DM_VMF_Address.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1427250162
[RETRIEVE] 0
[REFRESH] EXCEL "DataMapping\DM_VMF_Address.fil" FROM "DataMapping\DataMapping.xlsx" TABLE "VMF_Address$" KEEPTITLE
^FORMAT   DM_VMF_BnkAcc                      DM_VMF_BnkAcc                    "C:\ACL_Data\SATORI_EVA_v4.0\DataMapping" "DM_VMF_BnkAcc.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1427250162
[RETRIEVE] 0
[REFRESH] EXCEL "DataMapping\DM_VMF_BnkAcc.fil" FROM "DataMapping\DataMapping.xlsx" TABLE "VMF_BnkAcc$" KEEPTITLE
^FORMAT   DM_VMF_InterCompany                DM_VMF_InterCompany              "C:\ACL_Data\SATORI_EVA_v4.0\DataMapping" "DM_VMF_InterCompany.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1427250162
[RETRIEVE] 0
[REFRESH] EXCEL "DataMapping\DM_VMF_InterCompany.fil" FROM "DataMapping\DataMapping.xlsx" TABLE "VMF_InterCompany$" KEEPTITLE
^FORMAT   DM_VMF_Vnd_OneTime                 DM_VMF_Vnd_OneTime               "C:\ACL_Data\SATORI_EVA_v4.0\DataMapping" "DM_VMF_Vnd_OneTime.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1427250162
[RETRIEVE] 0
[REFRESH] EXCEL "DataMapping\DM_VMF_Vnd_OneTime.fil" FROM "DataMapping\DataMapping.xlsx" TABLE "VMF_Vnd_One_Time$" KEEPTITLE
^FORMAT   VMF_Vnd_Master_File                VMF_Vnd_Master_File              "Working_Files" "VMF_Vnd_Master_File.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~.08/24/2015   11:11:07 Vendors EXTRACT FIELDS vendor_number vendor_name address city sic created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         TO Vendors_New
~Input : Records:36321       Control Total:0                    
~Output: Records:36321       Control Total:0                    
~.08/24/2015   12:16:46 Vendors EXTRACT FIELDS vendor_number vendor_name address city sic created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         TO Vendors_New
~Input : Records:36321       Control Total:0                    
~Output: Records:36321       Control Total:0                    
~.08/24/2015   12:17:11 Vendors EXTRACT FIELDS vendor_number vendor_name address city sic created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         TO Vendors_New
~Input : Records:36321       Control Total:0                    
~Output: Records:36321       Control Total:0                    
~.19/02/2016   14:35:43 Vendors IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Co' BLANKS(20) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(vendor_number),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(vendor_name),1,73))) AS 'Vndr_Nme' BLANKS(20) AS 'ABN' BLANKS(1) AS 'Vndr_Sts' CTOD('', 'DD/MM/YYYY') AS 'Vndr_InvlDt' BLANKS(11) AS 'Vndr_Typ' BLANKS(15) AS 'Vndr_Add_Typ' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(address),1,125))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(sic),1,29))) AS 'State' BLANKS(12) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'FAX' BLANKS(60) AS 'Email1' BLANKS(60) AS 'Email2' BLANKS(21) AS 'Pymnt_Trm' created_on AS 'Created_Dt' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(30) AS 'Cha_Field1' BLANKS(30) AS 'Cha_Field2' BLANKS(3) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3'   TO "Working_Files\VMF_Vnd_Master_File.FIL"
~Input : Records:36321       Control Total:0                    
~Output: Records:36321       Control Total:0                    
^FORMAT   VMF_Address                        VMF_Address                      "Working_Files" "VMF_Address.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~.19/02/2016   14:35:44 DM_VMF_Address IF v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Vndr_Site_ID' BLANKS(20) AS 'Vndr_ID' BLANKS(15) AS 'Vndr_Add_Typ' BLANKS(25) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' BLANKS(35) AS 'City' BLANKS(29) AS 'State' BLANKS(12) AS 'Pcode' BLANKS(61) AS 'Cntry'  FIRST 0 TO "Working_Files\VMF_Address.FIL"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   VMF_BnkAcc                         VMF_BnkAcc                       "Working_Files" "VMF_BnkAcc.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~.19/02/2016   14:35:44 DM_VMF_BnkAcc IF v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(16) AS 'Vndr_Site_ID' BLANKS(11) AS 'Vndr_ID' BLANKS(12) AS 'BSB' BLANKS(28) AS 'Bnk_Acc_Num' BLANKS(12) AS 'BSB_NAME' BLANKS(48) AS 'Bnk_Acc_Name' BLANKS(20) AS 'Bnk_Acc_Type' CTOD('', 'DD/MM/YYYY') AS 'Chg_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' BLANKS(3) AS 'Cha_Field1'  FIRST 0 TO "Working_Files\VMF_BnkAcc_Tmp.FIL"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:35:44 VMF_BnkAcc_Tmp SUMMARIZE ON Vndr_Site_ID Vndr_ID BSB  Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Bnk_Acc_Type Chg_Dt CTOD(DATE(Dt_Field1),'DD/MM/YYYY') AS 'Dt_Field1' CTOD(DATE(Dt_Field2),'DD/MM/YYYY') AS 'Dt_Field2' Cha_Field1  IF NOT ISBLANK(INCLUDE(ALLTRIM(BSB)+ALLTRIM(Bnk_Acc_Num),"0123456789")) TO "Working_Files\VMF_BnkAcc.FIL"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   VMF_InterCompany                   VMF_InterCompany                 "Working_Files" "VMF_InterCompany.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~.19/02/2016   14:35:44 DM_VMF_InterCompany IF v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Vndr_Site_ID' BLANKS(20) AS 'Vndr_ID' BLANKS(65) AS 'Vndr_Nme'  FIRST 0 TO "Working_Files\VMF_InterCompany.FIL"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   VMF_Vnd_OneTime                    VMF_Vnd_OneTime                  "Working_Files" "VMF_Vnd_OneTime.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~.19/02/2016   14:35:44 DM_VMF_Vnd_OneTime IF v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Vndr_Site_ID' BLANKS(20) AS 'Vndr_ID' BLANKS(65) AS 'Vndr_Nme'  FIRST 0 TO "Working_Files\VMF_Vnd_OneTime.FIL"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_VndrSiteID                     VMF_Vnd_Master_File              "" "IDX_VndrSiteID.INX" 
*INDEX ON VNDR_SITE_ID TO IDX_VNDRSITEID
^INDEX    IDX_Vndr_ID                        VMF_Vnd_Master_File              "" "IDX_Vndr_ID.INX" 
*INDEX ON VNDR_ID TO IDX_VNDR_ID
^FORMAT   VMF_Chg_History                    VMF_Chg_History                  "Working_Files" "VMF_Chg_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~**** SOME HISTORY DELETED ****
~.19/02/2016   13:15:38 TMP5 EXTRACT FIELDS ALL TO "Working_Files\VMF_Chg_History" APPEND
~Input : Records:36320       Control Total:0                    
~Output: Records:36320       Control Total:0                    
~.19/02/2016   13:24:51 TMP5 EXTRACT FIELDS ALL TO "Working_Files\VMF_Chg_History" APPEND
~Input : Records:36320       Control Total:0                    
~Output: Records:36320       Control Total:0                    
~.19/02/2016   13:29:23 TMP5 EXTRACT FIELDS ALL TO "Working_Files\VMF_Chg_History" APPEND
~Input : Records:36320       Control Total:0                    
~Output: Records:36320       Control Total:0                    
~.19/02/2016   13:56:03 TMP5 EXTRACT FIELDS ALL TO "Working_Files\VMF_Chg_History" APPEND
~Input : Records:36320       Control Total:0                    
~Output: Records:36320       Control Total:0                    
~.19/02/2016   13:57:00 TMP5 EXTRACT FIELDS ALL TO "Working_Files\VMF_Chg_History" APPEND
~Input : Records:36320       Control Total:0                    
~Output: Records:36320       Control Total:0                    
~.19/02/2016   13:58:04 TMP5 EXTRACT FIELDS ALL TO "Working_Files\VMF_Chg_History" APPEND
~Input : Records:36320       Control Total:0                    
~Output: Records:36320       Control Total:0                    
~.19/02/2016   13:59:29 TMP5 EXTRACT FIELDS ALL TO "Working_Files\VMF_Chg_History" APPEND
~Input : Records:36320       Control Total:0                    
~Output: Records:36320       Control Total:0                    
~.19/02/2016   14:03:46 TMP5 EXTRACT FIELDS ALL TO "Working_Files\VMF_Chg_History" APPEND
~Input : Records:36320       Control Total:0                    
~Output: Records:36320       Control Total:0                    
~.19/02/2016   14:05:35 TMP5 EXTRACT FIELDS ALL TO "Working_Files\VMF_Chg_History" APPEND
~Input : Records:36320       Control Total:0                    
~Output: Records:36320       Control Total:0                    
~.19/02/2016   14:10:12 TMP5 EXTRACT FIELDS ALL TO "Working_Files\VMF_Chg_History" APPEND
~Input : Records:36320       Control Total:0                    
~Output: Records:36320       Control Total:0                    
~.19/02/2016   14:12:24 TMP5 EXTRACT FIELDS ALL TO "Working_Files\VMF_Chg_History" APPEND
~Input : Records:36320       Control Total:0                    
~Output: Records:36320       Control Total:0                    
~.19/02/2016   14:13:55 TMP5 EXTRACT FIELDS ALL TO "Working_Files\VMF_Chg_History" APPEND
~Input : Records:36320       Control Total:0                    
~Output: Records:36320       Control Total:0                    
~.19/02/2016   14:14:40 TMP5 EXTRACT FIELDS ALL TO "Working_Files\VMF_Chg_History" APPEND
~Input : Records:36320       Control Total:0                    
~Output: Records:36320       Control Total:0                    
~.19/02/2016   14:17:05 TMP5 EXTRACT FIELDS ALL TO "Working_Files\VMF_Chg_History" APPEND
~Input : Records:36320       Control Total:0                    
~Output: Records:36320       Control Total:0                    
~.19/02/2016   14:21:41 TMP5 EXTRACT FIELDS ALL TO "Working_Files\VMF_Chg_History" APPEND
~Input : Records:36320       Control Total:0                    
~Output: Records:36320       Control Total:0                    
~.19/02/2016   14:24:10 TMP5 EXTRACT FIELDS ALL TO "Working_Files\VMF_Chg_History" APPEND
~Input : Records:36320       Control Total:0                    
~Output: Records:36320       Control Total:0                    
~.19/02/2016   14:25:46 TMP5 EXTRACT FIELDS ALL TO "Working_Files\VMF_Chg_History" APPEND
~Input : Records:36320       Control Total:0                    
~Output: Records:36320       Control Total:0                    
~.19/02/2016   14:27:39 TMP5 EXTRACT FIELDS ALL TO "Working_Files\VMF_Chg_History" APPEND
~Input : Records:36320       Control Total:0                    
~Output: Records:36320       Control Total:0                    
~.19/02/2016   14:29:45 TMP5 EXTRACT FIELDS ALL TO "Working_Files\VMF_Chg_History" APPEND
~Input : Records:36320       Control Total:0                    
~Output: Records:36320       Control Total:0                    
~.19/02/2016   14:30:53 TMP5 EXTRACT FIELDS ALL TO "Working_Files\VMF_Chg_History" APPEND
~Input : Records:36320       Control Total:0                    
~Output: Records:36320       Control Total:0                    
~.19/02/2016   14:35:52 TMP5 EXTRACT FIELDS ALL TO "Working_Files\VMF_Chg_History" APPEND
~Input : Records:36320       Control Total:0                    
~Output: Records:36320       Control Total:0                    
^INDEX    IDX_VMF_OTV_VndrSiteID             VMF_Vnd_OneTime                  "" "IDX_VMF_OTV_VndrSiteID.INX" 
*IF FTYPE("VMF_VND_ONETIME")="Y" AND FILESIZE("WORKING_FILES\VMF_VND_ONETIME.FIL") >= 0 INDEX ON VNDR_SITE_ID TO IDX_VMF_OTV_VNDRSITEID
^INDEX    IDX_VMF_InterCo_VndrSiteID         VMF_InterCompany                 "" "IDX_VMF_InterCo_VndrSiteID.INX" 
*IF FTYPE("VMF_INTERCOMPANY")="Y" AND FILESIZE("WORKING_FILES\VMF_INTERCOMPANY.FIL") >= 0 INDEX ON VNDR_SITE_ID TO IDX_VMF_INTERCO_VNDRSITEID
^FORMAT   ABN_Temp                           ABN_Temp                         "Working_Files" "ABN_Temp.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1430899205
~.08/24/2015   11:11:07 Vendors EXTRACT FIELDS vendor_number vendor_name address city sic created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         TO Vendors_New
~Input : Records:36321       Control Total:0                    
~Output: Records:36321       Control Total:0                    
~.08/24/2015   12:16:46 Vendors EXTRACT FIELDS vendor_number vendor_name address city sic created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         TO Vendors_New
~Input : Records:36321       Control Total:0                    
~Output: Records:36321       Control Total:0                    
~.08/24/2015   12:17:11 Vendors EXTRACT FIELDS vendor_number vendor_name address city sic created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         TO Vendors_New
~Input : Records:36321       Control Total:0                    
~Output: Records:36321       Control Total:0                    
~.19/02/2016   14:35:43 Vendors IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Co' BLANKS(20) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(vendor_number),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(vendor_name),1,73))) AS 'Vndr_Nme' BLANKS(20) AS 'ABN' BLANKS(1) AS 'Vndr_Sts' CTOD('', 'DD/MM/YYYY') AS 'Vndr_InvlDt' BLANKS(11) AS 'Vndr_Typ' BLANKS(15) AS 'Vndr_Add_Typ' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(address),1,125))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(sic),1,29))) AS 'State' BLANKS(12) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'FAX' BLANKS(60) AS 'Email1' BLANKS(60) AS 'Email2' BLANKS(21) AS 'Pymnt_Trm' created_on AS 'Created_Dt' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(30) AS 'Cha_Field1' BLANKS(30) AS 'Cha_Field2' BLANKS(3) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3'   TO "Working_Files\VMF_Vnd_Master_File.FIL"
~Input : Records:36321       Control Total:0                    
~Output: Records:36321       Control Total:0                    
~.19/02/2016   14:35:53 VMF_Vnd_Master_File SUMMARIZE ON ABN_CLN IF NOT ISBLANK(ABN_CLN) TO "Working_Files\ABN_Temp.FIL" OPEN PRESORT
~Input : Records:36321       Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   ABN                                ABN                              "" "ABN.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1430899205
~.08/24/2015   11:11:07 Vendors EXTRACT FIELDS vendor_number vendor_name address city sic created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         TO Vendors_New
~Input : Records:36321       Control Total:0                    
~Output: Records:36321       Control Total:0                    
~.08/24/2015   12:16:46 Vendors EXTRACT FIELDS vendor_number vendor_name address city sic created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         TO Vendors_New
~Input : Records:36321       Control Total:0                    
~Output: Records:36321       Control Total:0                    
~.08/24/2015   12:17:11 Vendors EXTRACT FIELDS vendor_number vendor_name address city sic created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         TO Vendors_New
~Input : Records:36321       Control Total:0                    
~Output: Records:36321       Control Total:0                    
~.19/02/2016   14:35:43 Vendors IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Co' BLANKS(20) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(vendor_number),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(vendor_name),1,73))) AS 'Vndr_Nme' BLANKS(20) AS 'ABN' BLANKS(1) AS 'Vndr_Sts' CTOD('', 'DD/MM/YYYY') AS 'Vndr_InvlDt' BLANKS(11) AS 'Vndr_Typ' BLANKS(15) AS 'Vndr_Add_Typ' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(address),1,125))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(sic),1,29))) AS 'State' BLANKS(12) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'FAX' BLANKS(60) AS 'Email1' BLANKS(60) AS 'Email2' BLANKS(21) AS 'Pymnt_Trm' created_on AS 'Created_Dt' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(30) AS 'Cha_Field1' BLANKS(30) AS 'Cha_Field2' BLANKS(3) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3'   TO "Working_Files\VMF_Vnd_Master_File.FIL"
~Input : Records:36321       Control Total:0                    
~Output: Records:36321       Control Total:0                    
~.19/02/2016   14:35:53 VMF_Vnd_Master_File SUMMARIZE ON ABN_CLN IF NOT ISBLANK(ABN_CLN) TO "Working_Files\ABN_Temp.FIL" OPEN PRESORT
~Input : Records:36321       Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:35:53 ABN_Temp EXTRACT FIELDS ABN_CLN  IF LENGTH(ALLTRIM(ABN_CLN))>1  TO "ABN" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   EMF_Emp_Master_File                EMF_Emp_Master_File              "Working_Files" "EMF_Emp_Master_File.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:53 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
^FORMAT   EMF_BnkAcc                         EMF_BnkAcc                       "Working_Files" "EMF_BnkAcc.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:54 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(BANK_BSB),1,20))) AS 'BSB' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(BANK_ACC),1,20))) AS 'Bnk_Acc_Num' BLANKS(60) AS 'BSB_NAME' BLANKS(60) AS 'Bnk_Acc_Name' BLANKS(20) AS 'Bnk_Acc_Type' CTOD('', 'DD/MM/YYYY') AS 'Chg_Dt'  TO "Working_Files\EMF_BnkAcc_Tmp.FIL" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:54 EMF_BnkAcc_Tmp EXTRACT FIELDS ALL IF INCLUDE(Bnk_Acc_Num,"0123456789") <>"" TO "Working_Files\EMF_BnkAcc.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
^INDEX    IDX_Co_Emp_ID                      EMF_Emp_Master_File              "" "IDX_Co_Emp_ID.INX" 
*INDEX ON CO_EMP_ID TO IDX_CO_EMP_ID
^INDEX    IDX_Emp_BK_Co_Emp_ID               EMF_BnkAcc                       "" "IDX_Emp_BK_Co_Emp_ID.INX" 
*IF FTYPE("EMF_BNKACC")="Y" AND FILESIZE("WORKING_FILES\EMF_BNKACC.FIL") >= 0 INDEX ON CO_EMP_ID TO IDX_EMP_BK_CO_EMP_ID
^FORMAT   EMF_TMP_Emp                        EMF_TMP_Emp                      "Working_Files" "EMF_TMP_Emp.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:53 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:54 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
^INDEX    IDX_EMF_Co_Emp_ID                  EMF_TMP_Emp                      "" "IDX_EMF_Co_Emp_ID.INX" 
*INDEX ON CO_EMP_ID TO IDX_EMF_CO_EMP_ID
^FORMAT   EMF_BnkAcc_Chg_History             EMF_BnkAcc_Chg_History           "Working_Files" "EMF_BnkAcc_Chg_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~**** SOME HISTORY DELETED ****
~.19/02/2016   13:15:40 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   13:24:53 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   13:29:24 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   13:56:05 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   13:57:02 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   13:58:06 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   13:59:31 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:03:47 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:05:37 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:10:14 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:12:26 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:13:57 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:14:42 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:17:07 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:21:43 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:12 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:25:48 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:27:41 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:29:48 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:30:55 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:55 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
^FORMAT   Payroll_Payments                   Payroll_Payments                 "Working_Files" "Payroll_Payments.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~.20160219     14:30:29 Payroll_details EXTRACT FIELDS WEEKLY_HOURS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:35:55 PAYROLL_DATA  IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' DEC(Pay_Hrs,2) AS 'Pay_Hrs' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' DEC(WEEKLY_HOURS,2) AS 'Standard_WeeklyHours' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE_DESC),1,15))) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' payroll_date AS 'Prd_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'ForPrd' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'InPrd' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\Payroll_Payments.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
^FORMAT   PayRoll_ForPrd_Sum                 PayRoll_ForPrd_Sum               "Sources" "PayRoll_ForPrd_Sum.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~.20160219     14:30:29 Payroll_details EXTRACT FIELDS WEEKLY_HOURS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:35:55 PAYROLL_DATA  IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' DEC(Pay_Hrs,2) AS 'Pay_Hrs' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' DEC(WEEKLY_HOURS,2) AS 'Standard_WeeklyHours' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE_DESC),1,15))) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' payroll_date AS 'Prd_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'ForPrd' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'InPrd' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\Payroll_Payments.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:35:55 Payroll_Payments SUMMARIZE ON RUNID_ForPrd SUBTOTAL PrdSalaryAmt ActPaidAmt PrdGrsAmt Pay_Hrs AS 'Prd_PayHrs' OTHER ALL TO "Sources\PayRoll_ForPrd_Sum" OPEN PRESORT
~Input : Records:5801        Control Total:0                    
~Output: Records:2682        Control Total:0                    
^INDEX    IDX_PayRoll_ForPrd_Sum             PayRoll_ForPrd_Sum               "" "IDX_PayRoll_ForPrd_Sum.INX" 
*INDEX ON CO_EMP_ID TO IDX_PAYROLL_FORPRD_SUM
^FORMAT   PayRoll_InPrd_Sum                  PayRoll_InPrd_Sum                "Sources" "PayRoll_InPrd_Sum.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~.20160219     14:30:29 Payroll_details EXTRACT FIELDS WEEKLY_HOURS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:35:55 PAYROLL_DATA  IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' DEC(Pay_Hrs,2) AS 'Pay_Hrs' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' DEC(WEEKLY_HOURS,2) AS 'Standard_WeeklyHours' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE_DESC),1,15))) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' payroll_date AS 'Prd_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'ForPrd' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'InPrd' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\Payroll_Payments.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:35:56 Payroll_Payments SUMMARIZE ON RUNID_InPrd SUBTOTAL PrdSalaryAmt ActPaidAmt PrdGrsAmt Pay_Hrs AS 'Prd_PayHrs' OTHER ALL TO "Sources\PayRoll_InPrd_Sum" OPEN PRESORT
~Input : Records:5801        Control Total:0                    
~Output: Records:2682        Control Total:0                    
^INDEX    IDX_PayRoll_InPrd_Sum              PayRoll_InPrd_Sum                "" "IDX_PayRoll_InPrd_Sum.INX" 
*INDEX ON CO_EMP_ID TO IDX_PAYROLL_INPRD_SUM
^FORMAT   Payroll_Sum_12m                    Payroll_Sum_12m                  "Working_Files" "Payroll_Sum_12m.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~.20160219     14:30:29 Payroll_details EXTRACT FIELDS WEEKLY_HOURS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:35:55 PAYROLL_DATA  IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' DEC(Pay_Hrs,2) AS 'Pay_Hrs' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' DEC(WEEKLY_HOURS,2) AS 'Standard_WeeklyHours' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE_DESC),1,15))) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' payroll_date AS 'Prd_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'ForPrd' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'InPrd' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\Payroll_Payments.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:35:56 Payroll_Payments SUMMARIZE ON RUNID_InPrd SUBTOTAL PrdSalaryAmt ActPaidAmt PrdGrsAmt Pay_Hrs AS 'Prd_PayHrs' OTHER ALL TO "Sources\PayRoll_InPrd_Sum" OPEN PRESORT
~Input : Records:5801        Control Total:0                    
~Output: Records:2682        Control Total:0                    
~.19/02/2016   14:35:56 PayRoll_InPrd_Sum SUMMARIZE ON Co_Emp_ID SUBTOTAL PrdSalaryAmt ActPaidAmt PrdGrsAmt Prd_PayHrs IF AGE(Prd_Dt,_RptRunDate)<=365 TO "Tmp_Files\TMP9.FIL" OPEN PRESORT
~Input : Records:2682        Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:35:56 TMP9 EXTRACT FIELDS ALL TMP7.InPrd AS 'Early_InPrd' TMP8.InPrd AS 'Lst_InPrd' TO "Working_Files\Payroll_Sum_12m" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_Payroll_Sum_ID                 Payroll_Sum_12m                  "" "IDX_Payroll_Sum_ID.INX" 
*INDEX ON CO_EMP_ID TO IDX_PAYROLL_SUM_ID
^INDEX    IDX_PR_Pay_Co_Emp_ID               Payroll_Payments                 "" "IDX_PR_Pay_Co_Emp_ID.INX" 
*IF FTYPE("PAYROLL_PAYMENTS")="Y" AND FILESIZE("WORKING_FILES\PAYROLL_PAYMENTS.FIL") >= 0 INDEX ON CO_EMP_ID TO "IDX_PR_PAY_CO_EMP_ID"
^INDEX    IDX_VMFBK_VndrSiteID               VMF_BnkAcc                       "" "IDX_VMFBK_VndrSiteID.INX" 
* IF FTYPE("VMF_BNKACC")="Y" AND FILESIZE("WORKING_FILES\VMF_BNKACC.FIL") >= 0 INDEX ON VNDR_SITE_ID TO IDX_VMFBK_VNDRSITEID
^FORMAT   Vnd_Emp_Master                     Vnd_Emp_Master                   "Working_Files" "Vnd_Emp_Master.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~.08/24/2015   11:11:07 Vendors EXTRACT FIELDS vendor_number vendor_name address city sic created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         TO Vendors_New
~Input : Records:36321       Control Total:0                    
~Output: Records:36321       Control Total:0                    
~.08/24/2015   12:16:46 Vendors EXTRACT FIELDS vendor_number vendor_name address city sic created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         TO Vendors_New
~Input : Records:36321       Control Total:0                    
~Output: Records:36321       Control Total:0                    
~.08/24/2015   12:17:11 Vendors EXTRACT FIELDS vendor_number vendor_name address city sic created_by created_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         TO Vendors_New
~Input : Records:36321       Control Total:0                    
~Output: Records:36321       Control Total:0                    
~.19/02/2016   14:35:43 Vendors IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS BLANKS(20) AS 'Co' BLANKS(20) AS 'Vndr_Site_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(vendor_number),1,20))) AS 'Vndr_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(vendor_name),1,73))) AS 'Vndr_Nme' BLANKS(20) AS 'ABN' BLANKS(1) AS 'Vndr_Sts' CTOD('', 'DD/MM/YYYY') AS 'Vndr_InvlDt' BLANKS(11) AS 'Vndr_Typ' BLANKS(15) AS 'Vndr_Add_Typ' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(address),1,125))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(sic),1,29))) AS 'State' BLANKS(12) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'FAX' BLANKS(60) AS 'Email1' BLANKS(60) AS 'Email2' BLANKS(21) AS 'Pymnt_Trm' created_on AS 'Created_Dt' CTOD('', 'DD/MM/YYYY') AS 'Modf_Dt' BLANKS(30) AS 'Cha_Field1' BLANKS(30) AS 'Cha_Field2' BLANKS(3) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5' 0.00 AS 'Num_Field1' 0.00 AS 'Num_Field2' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field1' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3'   TO "Working_Files\VMF_Vnd_Master_File.FIL"
~Input : Records:36321       Control Total:0                    
~Output: Records:36321       Control Total:0                    
~.19/02/2016   14:35:58 VMF_Vnd_Master_File EXTRACT FIELDS SUBSTR("VM",1,2) AS "VM_EM" SUBSTR(Vndr_Site_ID,1,20) AS "Vndr_Site_ID" SUBSTR(Vndr_Sts,1,2) AS "Vndr_Sts" SUBSTR(Vndr_ID,1,20) AS "Vndr_ID" SUBSTR(Vndr_Nme,1,65) AS "Vndr_Nme" SUBSTR(Vndr_Typ,1,20) AS "Vndr_Typ"  SUBSTR(ADD1,1,61) AS "ADD1" SUBSTR(ADD2,1,61) AS "ADD2" SUBSTR(ADD3,1,61) AS "ADD3" SUBSTR(City,1,35) AS "City" SUBSTR(State,1,29) AS "State" SUBSTR(Pcode,1,11) AS "PCode" SUBSTR(Cntry,1,61) AS "Cntry" SUBSTR(TEL1,1,21) AS "TEL1" SUBSTR(TEL2,1,21) AS "TEL2" SUBSTR(TEL3,1,21) AS "TEL3" SUBSTR(FAX,1,21) AS "FAX" SUBSTR(ABN,1,20) AS "ABN" SUBSTR(BSB,1,20) AS "BSB" SUBSTR(Bnk_Acc_Num,1,20) AS "Bnk_Acc_Num" SUBSTR(Email1,1,60) AS "Email1" SUBSTR(Email2,1,60) AS "Email2" VALUE(STRING(Inv_Amt,15),2) AS "Inv_Amt" VALUE(STRING(GST_Amt ,15),2) AS "GST_Amt" VALUE(STRING(COUNT,9),0) AS "COUNT" SUBSTR(" ",1,10) AS "Hire_Dt" SUBSTR(" ",1,10) AS "Trm_Dt" SUBSTR(ALLTRIM(DATE(Created_Dt)),1,10) AS "Created_Dt" SUBSTR(ALLTRIM(DATE(Modf_Dt)),1,10) AS "Modf_Dt" TO "Working_Files\Vnd_Emp_Master" OPEN
~Input : Records:36321       Control Total:0                    
~Output: Records:36321       Control Total:0                    
~.19/02/2016   14:35:58 EMF_TMP_Emp EXTRACT FIELDS SUBSTR("EM",1,2) AS "VM_EM" SUBSTR(Co_Emp_ID,1,20) AS "Co_Emp_ID" SUBSTR(Emp_Sts, 1,2) AS "Emp_Sts" SUBSTR(ALLTRIM(EMP_ID),1,20) AS "EMP_ID" SUBSTR(ALLTRIM(Emp_Nme),1,65) AS "Emp_Nme" SUBSTR(ALLTRIM("HR-EMP"),1,20) as "Vndr_Typ" SUBSTR(ALLTRIM(Add1),1,61) AS "Add1" SUBSTR(ALLTRIM(Add2),1,61) AS "Add2" SUBSTR(ALLTRIM(Add3),1,61) AS "Add3" SUBSTR(ALLTRIM(City),1,35) AS "City" SUBSTR(ALLTRIM(State),1,29) AS "State" SUBSTR(ALLTRIM(PCode),1,11) as "Pcode" SUBSTR(ALLTRIM(Cntry),1,61) AS "Cntry" SUBSTR(ALLTRIM(TEL1),1,21) as "Tel1" SUBSTR(ALLTRIM(TEL2),1,21) as "Tel2" SUBSTR(ALLTRIM(TEL3),1,21) AS "Tel2" SUBSTR(ALLTRIM(FAX),1,21) AS "Fax" SUBSTR(ALLTRIM(Tax_Fle_Num),1,20) AS "ABN" SUBSTR(BSB,1,20) AS "BSB" SUBSTR(Bnk_Acc_Num,1,20) AS "Bnk_Acc_Num" SUBSTR(Email_Privt,1,60) AS "Email1" SUBSTR(Email_Bus,1,60) AS "Email2" VALUE(STRING(Total_PayAmt,15),2) AS "TtlInvAmt" VALUE(STRING(0.00,15),2) AS "TtlGstAmt" VALUE(STRING(0,9),0) as "Count" SUBSTR(ALLTRIM(DATE(Hire_Dt)),1,10) AS "Hire_Dt" SUBSTR(ALLTRIM(DATE(Trm_Dt)),1,10) AS "Trm_Dt" SUBSTR(ALLTRIM(DATE(Created_Dt)),1,10) AS "Created_Dt" SUBSTR(ALLTRIM(DATE(Modf_Dt)),1,10) AS "Modf_Dt" TO "Working_Files\Vnd_Emp_Master" OPEN APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
^INDEX    IDX_VndEmp_KEY                     Vnd_Emp_Master                   "" "IDX_VndEmp_KEY.INX" 
*INDEX ON KEY TO IDX_VNDEMP_KEY
^INDEX    IDX_VndEmp_KEY1                    Vnd_Emp_Master                   "" "IDX_VndEmp_KEY1.INX" 
*INDEX ON KEY1 TO IDX_VNDEMP_KEY1
^INDEX    IDX_EM001_History_ID_KEY           EM001_History                    "" "IDX_EM001_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_EM001_HISTORY_ID_KEY
^FORMAT   EM001_History                      EM001_History                    "History" "EM001_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:15 EMF_TMP_Emp DUPLICATES ON c_Tax_Fle_Num OTHER ALL BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN PRESORT IF Emp_Sts<>"I" AND LENGTH(ALLTRIM(c_Tax_Fle_Num))>1  OPEN TO "Tmp_Files\TMP_Dups.FIL" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:15 TMP_Dups EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:15 TMP_Cur IF FTYPE("EM001_History")<>"y" OR FILESIZE("History\EM001_History.fil") <0 EXTRACT FIELDS ALL IF 1<>1 TO "History\EM001_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:16 TMP_Cur1 EXTRACT FIELDS c_Tax_Fle_Num Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Invalid_TFN Total_PayAmt Total_Pay_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 DUP_KEY ID_KEY TO "History\EM001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:25:51 TMP_Cur1 EXTRACT FIELDS c_Tax_Fle_Num Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Invalid_TFN Total_PayAmt Total_Pay_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 DUP_KEY ID_KEY TO "History\EM001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:27:45 TMP_Cur1 EXTRACT FIELDS c_Tax_Fle_Num Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Invalid_TFN Total_PayAmt Total_Pay_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 DUP_KEY ID_KEY TO "History\EM001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:30:59 TMP_Cur1 EXTRACT FIELDS c_Tax_Fle_Num Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Invalid_TFN Total_PayAmt Total_Pay_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 DUP_KEY ID_KEY TO "History\EM001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:35:58 TMP_Cur1 EXTRACT FIELDS c_Tax_Fle_Num Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Invalid_TFN Total_PayAmt Total_Pay_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 DUP_KEY ID_KEY TO "History\EM001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   EM001_Dup_TFN                      EM001_Dup_TFN                    "Results" "EM001_Dup_TFN.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:53 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:54 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:58 EMF_TMP_Emp DUPLICATES ON c_Tax_Fle_Num OTHER ALL BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN PRESORT IF Emp_Sts<>"I" AND LENGTH(ALLTRIM(c_Tax_Fle_Num))>1  OPEN TO "Tmp_Files\TMP_Dups.FIL" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:35:58 TMP_Dups EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:35:58 TMP_Cur EXTRACT FIELDS c_Tax_Fle_Num Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Invalid_TFN Total_PayAmt Total_Pay_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 DUP_KEY ID_KEY IF DUP_KEY= TMP_His.DUP_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:35:59 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP1" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:35:59 TMP1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:35:59 TMP10 SORT ON SORT_KEY D TO "Results\EM001_Dup_TFN"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_EM002_History_ID_KEY           EM002_History                    "" "IDX_EM002_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_EM002_HISTORY_ID_KEY
^FORMAT   EM002_History                      EM002_History                    "History" "EM002_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:17 EMF_TMP_Emp EXTRACT FIELDS ALL TMP3.DUP_KEY TMP3.Bnk_KEY Co_Emp_ID TMP3.BSB TMP3.Bnk_Acc_Num TMP3.BSB_NAME TMP3.Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN IF NOT ISBLANK(TMP3.Co_Emp_ID) TO "Tmp_Files\TMP1" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:17 TMP1 EXTRACT FIELDS ALL IF NOT ISBLANK(TMP2.DUP_KEY) TO "Tmp_Files\TMP4" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:17 TMP4 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:17 TMP_Cur IF FTYPE("EM002_History")<>"y" OR FILESIZE("History\EM002_History.fil") <0 EXTRACT FIELDS ALL IF 1<>1 TO "History\EM002_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:17 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN DUP_KEY Bnk_KEY Co_Emp_ID2 BSB2 Bnk_Acc_Num2 BSB_NAME2 Bnk_Acc_Name2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:25:53 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN DUP_KEY Bnk_KEY Co_Emp_ID2 BSB2 Bnk_Acc_Num2 BSB_NAME2 Bnk_Acc_Name2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:27:47 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN DUP_KEY Bnk_KEY Co_Emp_ID2 BSB2 Bnk_Acc_Num2 BSB_NAME2 Bnk_Acc_Name2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:31:01 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN DUP_KEY Bnk_KEY Co_Emp_ID2 BSB2 Bnk_Acc_Num2 BSB_NAME2 Bnk_Acc_Name2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:00 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN DUP_KEY Bnk_KEY Co_Emp_ID2 BSB2 Bnk_Acc_Num2 BSB_NAME2 Bnk_Acc_Name2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM002_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   EM002_Dup_BnkAcc                   EM002_Dup_BnkAcc                 "Results" "EM002_Dup_BnkAcc.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:53 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:54 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:59 EMF_TMP_Emp EXTRACT FIELDS ALL TMP3.DUP_KEY TMP3.Bnk_KEY Co_Emp_ID TMP3.BSB TMP3.Bnk_Acc_Num TMP3.BSB_NAME TMP3.Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN IF NOT ISBLANK(TMP3.Co_Emp_ID) TO "Tmp_Files\TMP1" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:00 TMP1 EXTRACT FIELDS ALL IF NOT ISBLANK(TMP2.DUP_KEY) TO "Tmp_Files\TMP4" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:00 TMP4 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:00 TMP_Cur EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN DUP_KEY Bnk_KEY Co_Emp_ID2 BSB2 Bnk_Acc_Num2 BSB_NAME2 Bnk_Acc_Name2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY IF DUP_KEY= TMP_His.DUP_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:00 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP1" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:00 TMP1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:00 TMP10 SORT ON SORT_KEY D TO "Results\EM002_Dup_BnkAcc"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_EM003_History_ID_KEY           EM003_History                    "" "IDX_EM003_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_EM003_HISTORY_ID_KEY
^FORMAT   EM003_History                      EM003_History                    "History" "EM003_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:18 EMF_TMP_Emp DUPLICATES ON c_Emp_Nme OTHER ALL BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN PRESORT IF Emp_Sts<>"I" AND c_Emp_Nme<>" " OPEN TO "Tmp_Files\TMP1.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:18 TMP1 EXTRACT FIELDS ALL IF NOT ISBLANK(TMP2.DUP_KEY) TO "Tmp_Files\TMP4" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:18 TMP4 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:18 TMP_Cur IF FTYPE("EM003_History")<>"y" OR FILESIZE("History\EM003_History.fil") <0 EXTRACT FIELDS ALL IF 1<>1 TO "History\EM003_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:18 TMP_Cur1 EXTRACT FIELDS c_Emp_Nme Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 DUP_KEY ID_KEY TO "History\EM003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:25:54 TMP_Cur1 EXTRACT FIELDS c_Emp_Nme Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 DUP_KEY ID_KEY TO "History\EM003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:27:48 TMP_Cur1 EXTRACT FIELDS c_Emp_Nme Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 DUP_KEY ID_KEY TO "History\EM003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:31:03 TMP_Cur1 EXTRACT FIELDS c_Emp_Nme Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 DUP_KEY ID_KEY TO "History\EM003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:02 TMP_Cur1 EXTRACT FIELDS c_Emp_Nme Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 DUP_KEY ID_KEY TO "History\EM003_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   EM003_Dup_Nme                      EM003_Dup_Nme                    "Results" "EM003_Dup_Nme.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:53 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:54 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:36:01 EMF_TMP_Emp DUPLICATES ON c_Emp_Nme OTHER ALL BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN PRESORT IF Emp_Sts<>"I" AND c_Emp_Nme<>" " OPEN TO "Tmp_Files\TMP1.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:01 TMP1 EXTRACT FIELDS ALL IF NOT ISBLANK(TMP2.DUP_KEY) TO "Tmp_Files\TMP4" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:01 TMP4 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:02 TMP_Cur EXTRACT FIELDS c_Emp_Nme Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 DUP_KEY ID_KEY IF DUP_KEY= TMP_His.DUP_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:02 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP1" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:02 TMP1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:02 TMP10 SORT ON SORT_KEY D TO "Results\EM003_Dup_Nme"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   EMF_Address                        EMF_Address                      "Working_Files" "EMF_Address.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1249276814
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:53 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:54 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:36:02 EMF_TMP_Emp EXTRACT FIELDS Co_Emp_ID Emp_ID ADD1 ADD2 ADD3 Pcode State City Cntry IF LENGTH(ALLTRIM(CLEAN(ADD1+ADD2+ADD3)))>5 TO Working_Files\EMF_Address OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
^INDEX    IDX_EM004_History_ID_KEY           EM004_History                    "" "IDX_EM004_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_EM004_HISTORY_ID_KEY
^FORMAT   EM004_History                      EM004_History                    "History" "EM004_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:20 EMF_TMP_Emp EXTRACT FIELDS ALL TMP9.DUP_KEY TMP9.Add_KEY TMP9.ADD1 AS 'Dup_ADD1' TMP9.ADD2 AS 'Dup_ADD2' TMP9.ADD3 AS 'Dup_ADD3' TMP9.City AS 'Dup_City' TMP9.State AS 'Dup_State' TMP9.Pcode AS 'Dup_Pcode' TMP9.Cntry AS 'Dup_Cntry' BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN IF NOT ISBLANK(TMP9.Co_Emp_ID) AND NOT ISBLANK(EMF_TMP_Emp.Co_Emp_ID) TO "Tmp_Files\TMP4" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:20 TMP4 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:20 TMP_Cur IF FTYPE("EM004_History")<>"y" OR FILESIZE("History\EM004_History.fil") <0 EXTRACT FIELDS ALL IF 1<>1 TO "History\EM004_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:20 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN c_Emp_Nme DUP_KEY Add_KEY Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM004_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:25:56 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN c_Emp_Nme DUP_KEY Add_KEY Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM004_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:27:50 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN c_Emp_Nme DUP_KEY Add_KEY Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM004_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:31:04 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN c_Emp_Nme DUP_KEY Add_KEY Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM004_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:04 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN c_Emp_Nme DUP_KEY Add_KEY Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM004_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   EM004_Dup_Add                      EM004_Dup_Add                    "Results" "EM004_Dup_Add.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:53 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:54 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:36:03 EMF_TMP_Emp EXTRACT FIELDS ALL TMP9.DUP_KEY TMP9.Add_KEY TMP9.ADD1 AS 'Dup_ADD1' TMP9.ADD2 AS 'Dup_ADD2' TMP9.ADD3 AS 'Dup_ADD3' TMP9.City AS 'Dup_City' TMP9.State AS 'Dup_State' TMP9.Pcode AS 'Dup_Pcode' TMP9.Cntry AS 'Dup_Cntry' BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN IF NOT ISBLANK(TMP9.Co_Emp_ID) AND NOT ISBLANK(EMF_TMP_Emp.Co_Emp_ID) TO "Tmp_Files\TMP4" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:03 TMP4 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:03 TMP_Cur EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN c_Emp_Nme DUP_KEY Add_KEY Dup_ADD1 Dup_ADD2 Dup_ADD3 Dup_City Dup_State Dup_Pcode Dup_Cntry BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY IF DUP_KEY= TMP_His.DUP_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:04 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP1" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:04 TMP1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:04 TMP10 SORT ON SORT_KEY D TO "Results\EM004_Dup_Add"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_EM005_History_ID_KEY           EM005_History                    "" "IDX_EM005_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_EM005_HISTORY_ID_KEY
^FORMAT   EM005_History                      EM005_History                    "History" "EM005_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:21 EMF_TMP_Emp EXTRACT FIELDS ALL TMP1.DUP_KEY TMP1.c_Tel BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN IF NOT ISBLANK(TMP1.Co_Emp_ID)  TO "Tmp_Files\TMP4" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:21 TMP4 EXTRACT FIELDS ALL IF NOT ISBLANK(TMP2.DUP_KEY) TO "Tmp_Files\TMP3" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:21 TMP3 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:21 TMP_Cur IF FTYPE("EM005_History")<>"y" OR FILESIZE("History\EM005_History.fil") <0 EXTRACT FIELDS ALL IF 1<>1 TO "History\EM005_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:22 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN c_Emp_Nme c_Tel1 c_Tel2 c_Tel3 c_Fax DUP_KEY c_Tel BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:25:58 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN c_Emp_Nme c_Tel1 c_Tel2 c_Tel3 c_Fax DUP_KEY c_Tel BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:27:52 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN c_Emp_Nme c_Tel1 c_Tel2 c_Tel3 c_Fax DUP_KEY c_Tel BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:31:06 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN c_Emp_Nme c_Tel1 c_Tel2 c_Tel3 c_Fax DUP_KEY c_Tel BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:05 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN c_Emp_Nme c_Tel1 c_Tel2 c_Tel3 c_Fax DUP_KEY c_Tel BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM005_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   EM005_Dup_Tel                      EM005_Dup_Tel                    "Results" "EM005_Dup_Tel.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:53 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:54 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:36:05 EMF_TMP_Emp EXTRACT FIELDS ALL TMP1.DUP_KEY TMP1.c_Tel BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN IF NOT ISBLANK(TMP1.Co_Emp_ID)  TO "Tmp_Files\TMP4" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:05 TMP4 EXTRACT FIELDS ALL IF NOT ISBLANK(TMP2.DUP_KEY) TO "Tmp_Files\TMP3" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:05 TMP3 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:05 TMP_Cur EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN c_Emp_Nme c_Tel1 c_Tel2 c_Tel3 c_Fax DUP_KEY c_Tel BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY IF DUP_KEY= TMP_His.DUP_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:05 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP1" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:06 TMP1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:06 TMP10 SORT ON SORT_KEY D TO "Results\EM005_Dup_Tel"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_EM006_History_ID_KEY           EM006_History                    "" "IDX_EM006_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_EM006_HISTORY_ID_KEY
^FORMAT   EM006_History                      EM006_History                    "History" "EM006_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:22 EMF_TMP_Emp  EXTRACT 100000 AS "EM006" ALL BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN IF Emp_Sts="A" AND  LENGTH(ALLTRIM(c_Tel1))<6 AND LENGTH(ALLTRIM(c_Tel2))<6 AND LENGTH(ALLTRIM(c_Tel3))<6 AND LENGTH(ALLTRIM(c_Fax))<6 TO Tmp_Files\TMP1 FIRST 0
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:22 TMP1 SUMMARIZE ON Co_Emp_ID Emp_ID SUBTOTAL EM006 OTHER ALL BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN TO "Tmp_Files\TMP2.FIL" OPEN PRESORT
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:22 TMP2 EXTRACT FIELDS c_EM006 AS "EM006" ALL BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Test_Name RptRunDate Invalid_TFN TO "Tmp_Files\TMP3" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:23 TMP3 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:23 TMP_Cur IF FTYPE("EM006_History")<>"y" OR FILESIZE("History\EM006_History.fil") <0 EXTRACT FIELDS ALL FIRST 0 TO "History\EM006_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:23 TMP_Cur1 EXTRACT FIELDS EM006 Co_Emp_ID Emp_ID EM0062 COUNT Co COST_CENTRE EMP_Sts Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN c_Emp_Nme c_Tel1 c_Tel2 c_Tel3 c_Fax BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 BSB3 Bnk_Acc_Num3 Total_PayAmt3 Total_Pay_Num3 Invalid_TFN3 c_EM006 Test_Name RptRunDate BSB4 Bnk_Acc_Num4 Total_PayAmt4 Total_Pay_Num4 Test_Name2 RptRunDate2 Invalid_TFN4 ID_KEY TO "History\EM006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:25:59 TMP_Cur1 EXTRACT FIELDS EM006 Co_Emp_ID Emp_ID EM0062 COUNT Co COST_CENTRE EMP_Sts Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN c_Emp_Nme c_Tel1 c_Tel2 c_Tel3 c_Fax BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 BSB3 Bnk_Acc_Num3 Total_PayAmt3 Total_Pay_Num3 Invalid_TFN3 c_EM006 Test_Name RptRunDate BSB4 Bnk_Acc_Num4 Total_PayAmt4 Total_Pay_Num4 Test_Name2 RptRunDate2 Invalid_TFN4 ID_KEY TO "History\EM006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:27:53 TMP_Cur1 EXTRACT FIELDS EM006 Co_Emp_ID Emp_ID EM0062 COUNT Co COST_CENTRE EMP_Sts Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN c_Emp_Nme c_Tel1 c_Tel2 c_Tel3 c_Fax BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 BSB3 Bnk_Acc_Num3 Total_PayAmt3 Total_Pay_Num3 Invalid_TFN3 c_EM006 Test_Name RptRunDate BSB4 Bnk_Acc_Num4 Total_PayAmt4 Total_Pay_Num4 Test_Name2 RptRunDate2 Invalid_TFN4 ID_KEY TO "History\EM006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:31:08 TMP_Cur1 EXTRACT FIELDS EM006 Co_Emp_ID Emp_ID EM0062 COUNT Co COST_CENTRE EMP_Sts Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN c_Emp_Nme c_Tel1 c_Tel2 c_Tel3 c_Fax BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 BSB3 Bnk_Acc_Num3 Total_PayAmt3 Total_Pay_Num3 Invalid_TFN3 c_EM006 Test_Name RptRunDate BSB4 Bnk_Acc_Num4 Total_PayAmt4 Total_Pay_Num4 Test_Name2 RptRunDate2 Invalid_TFN4 ID_KEY TO "History\EM006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:07 TMP_Cur1 EXTRACT FIELDS EM006 Co_Emp_ID Emp_ID EM0062 COUNT Co COST_CENTRE EMP_Sts Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN c_Emp_Nme c_Tel1 c_Tel2 c_Tel3 c_Fax BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 BSB3 Bnk_Acc_Num3 Total_PayAmt3 Total_Pay_Num3 Invalid_TFN3 c_EM006 Test_Name RptRunDate BSB4 Bnk_Acc_Num4 Total_PayAmt4 Total_Pay_Num4 Test_Name2 RptRunDate2 Invalid_TFN4 ID_KEY TO "History\EM006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_EM007_History_ID_KEY           EM007_History                    "" "IDX_EM007_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_EM007_HISTORY_ID_KEY
^FORMAT   EM007_History                      EM007_History                    "History" "EM007_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:23 EMF_TMP_Emp SET FILTER NOT ISBLANK(c_Hire_Dt)
~.19/02/2016   14:24:23 EMF_TMP_Emp EXTRACT FIELDS ALL BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN IF Hire_Dt<=DOB TO Tmp_Files\TMP1 OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:23 TMP1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:23 TMP_Cur IF FTYPE("EM007_History")<>"y" OR FILESIZE("History\EM007_History.fil") <0 EXTRACT FIELDS ALL FIRST 0 TO "History\EM007_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:23 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:26:00 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:27:54 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:31:08 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:08 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM007_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   EM007_StartDt_Bf_DOB               EM007_StartDt_Bf_DOB             "Results" "EM007_StartDt_Bf_DOB.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:53 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:54 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:36:07 EMF_TMP_Emp SET FILTER NOT ISBLANK(c_Hire_Dt)
~.19/02/2016   14:36:07 EMF_TMP_Emp EXTRACT FIELDS ALL BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN IF Hire_Dt<=DOB TO Tmp_Files\TMP1 OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:07 TMP1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:08 TMP_Cur EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY IF ID_KEY<> EM007_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:08 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP4" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:08 TMP4 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:08 TMP10 SORT ON SORT_KEY D TO "Results\EM007_StartDt_Bf_DOB" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_EM008_History_ID_KEY           EM008_History                    "" "IDX_EM008_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_EM008_HISTORY_ID_KEY
^FORMAT   EM008_History                      EM008_History                    "History" "EM008_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:24 EMF_TMP_Emp EXTRACT ALL Total_PayAmt Total_Pay_Num Invalid_TFN IF Emp_Sts<>"I" AND ISBLANK(COST_CENTRE)  TO "Tmp_Files\TMP1" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:386         Control Total:0                    
~.19/02/2016   14:24:24 TMP1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:386         Control Total:0                    
~Output: Records:386         Control Total:0                    
~.19/02/2016   14:24:24 TMP_Cur IF FTYPE("EM008_History")<>"y" OR FILESIZE("History\EM008_History.fil") <0 EXTRACT FIELDS ALL FIRST 0 TO "History\EM008_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:24 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM008_History"APPEND
~Input : Records:386         Control Total:0                    
~Output: Records:386         Control Total:0                    
~.19/02/2016   14:26:01 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM008_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:27:55 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM008_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:31:09 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM008_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:08 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY TO "History\EM008_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   EM008_unKnown_CstCtr               EM008_unKnown_CstCtr             "Results" "EM008_unKnown_CstCtr.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:53 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:54 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:36:08 EMF_TMP_Emp EXTRACT ALL Total_PayAmt Total_Pay_Num Invalid_TFN IF Emp_Sts<>"I" AND ISBLANK(COST_CENTRE)  TO "Tmp_Files\TMP1" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:386         Control Total:0                    
~.19/02/2016   14:36:08 TMP1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:386         Control Total:0                    
~Output: Records:386         Control Total:0                    
~.19/02/2016   14:36:08 TMP_Cur EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 ID_KEY IF ID_KEY<> EM008_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:386         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:08 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:08 TMP10 SORT ON SORT_KEY TO "Results\EM008_unKnown_CstCtr" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_EM009_History_ID_KEY           EM009_History                    "" "IDX_EM009_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_EM009_HISTORY_ID_KEY
^FORMAT   EM009_History                      EM009_History                    "History" "EM009_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:25 EMF_TMP_Emp EXTRACT ALL BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN c_Tax_Fle_Num IF Emp_Sts<>"I" AND LENGTH(ALLTRIM(c_Tax_Fle_Num))>1 AND (LENGTH(ALLTRIM(c_Tax_Fle_Num))<>9 OR Invalid_TFN="T" ) TO "Tmp_Files\TMP1" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:352         Control Total:0                    
~.19/02/2016   14:24:25 TMP1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:352         Control Total:0                    
~Output: Records:352         Control Total:0                    
~.19/02/2016   14:24:25 TMP_Cur IF FTYPE("EM009_History")<>"y" OR FILESIZE("History\EM009_History.fil") <0 EXTRACT FIELDS ALL FIRST 0 TO "History\EM009_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:25 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 c_Tax_Fle_Num2 ID_KEY TO "History\EM009_History"APPEND
~Input : Records:352         Control Total:0                    
~Output: Records:352         Control Total:0                    
~.19/02/2016   14:26:01 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 c_Tax_Fle_Num2 ID_KEY TO "History\EM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:27:55 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 c_Tax_Fle_Num2 ID_KEY TO "History\EM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:31:10 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 c_Tax_Fle_Num2 ID_KEY TO "History\EM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:09 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 c_Tax_Fle_Num2 ID_KEY TO "History\EM009_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_EM010_History_ID_KEY           EM010_History                    "" "IDX_EM010_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_EM010_HISTORY_ID_KEY
^FORMAT   EM010_History                      EM010_History                    "History" "EM010_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:25 EMF_TMP_Emp EXTRACT ALL BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN c_Tax_Fle_Num SUBSTR("EM010. Tax File No. validation: Blank TFN",1,100) AS 'TEST_NAME' IF Emp_Sts<>"I" AND LENGTH(ALLTRIM(c_Tax_Fle_Num))<=1  TO "Tmp_Files\TMP1"
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:25 EMF_TMP_Emp EXTRACT ALL BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN c_Tax_Fle_Num SUBSTR("EM010. Tax File No. validation: 11111111 the started date is >28 days",1,100) AS 'TEST_NAME' IF c_Tax_Fle_Num = "111111111" AND AGE(Hire_Dt,_RptRunDate)>28 TO "Tmp_Files\TMP1" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:25 TMP1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:25 TMP_Cur IF FTYPE("EM010_History")<>"y" OR FILESIZE("History\EM010_History.fil") <0 EXTRACT FIELDS ALL FIRST 0 TO "History\EM010_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:26 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 c_Tax_Fle_Num2 TEST_NAME ID_KEY TO "History\EM010_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:26:02 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 c_Tax_Fle_Num2 TEST_NAME ID_KEY TO "History\EM010_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:27:56 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 c_Tax_Fle_Num2 TEST_NAME ID_KEY TO "History\EM010_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:31:11 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 c_Tax_Fle_Num2 TEST_NAME ID_KEY TO "History\EM010_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:10 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 c_Tax_Fle_Num2 TEST_NAME ID_KEY TO "History\EM010_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   EM010_TFN_Valid                    EM010_TFN_Valid                  "Results" "EM010_TFN_Valid.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:53 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:54 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:36:10 EMF_TMP_Emp EXTRACT ALL BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN c_Tax_Fle_Num SUBSTR("EM010. Tax File No. validation: Blank TFN",1,100) AS 'TEST_NAME' IF Emp_Sts<>"I" AND LENGTH(ALLTRIM(c_Tax_Fle_Num))<=1  TO "Tmp_Files\TMP1"
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:10 EMF_TMP_Emp EXTRACT ALL BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN c_Tax_Fle_Num SUBSTR("EM010. Tax File No. validation: 11111111 the started date is >28 days",1,100) AS 'TEST_NAME' IF c_Tax_Fle_Num = "111111111" AND AGE(Hire_Dt,_RptRunDate)>28 TO "Tmp_Files\TMP1" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:10 TMP1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:10 TMP_Cur EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 c_Tax_Fle_Num2 TEST_NAME ID_KEY IF ID_KEY<> EM010_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:10 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:10 TMP10 SORT ON SORT_KEY D TO "Results\EM010_TFN_Valid" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_EM011_History_ID_KEY           EM011_History                    "" "IDX_EM011_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_EM011_HISTORY_ID_KEY
^FORMAT   EM011_History                      EM011_History                    "History" "EM011_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~**** SOME HISTORY DELETED ****
~.19/02/2016   13:56:05 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   13:57:02 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   13:58:06 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   13:59:31 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:03:47 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:05:37 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:10:14 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:12:26 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:13:57 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:14:42 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:17:07 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:21:43 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:12 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:26 EMF_BnkAcc_Chg_History EXTRACT FIELDS ALL  TMP1.COUNT IF TMP1.COUNT>VALUE(ALLTRIM(TXT_EM011_Chg_Times),0) TO Tmp_Files\TMP2 OPEN
~Input : Records:14340       Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:26 TMP2 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:26 TMP_Cur IF FTYPE("EM011_History")<>"y" OR FILESIZE("History\EM011_History.fil") <0 EXTRACT FIELDS ALL FIRST 0 TO "History\EM011_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:26 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Bnk_Acc_Type Chg_Dt RptRunDateTime COUNT ID_KEY TO "History\EM011_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:26:03 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Bnk_Acc_Type Chg_Dt RptRunDateTime COUNT ID_KEY TO "History\EM011_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:27:57 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Bnk_Acc_Type Chg_Dt RptRunDateTime COUNT ID_KEY TO "History\EM011_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:31:11 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Bnk_Acc_Type Chg_Dt RptRunDateTime COUNT ID_KEY TO "History\EM011_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:11 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Bnk_Acc_Type Chg_Dt RptRunDateTime COUNT ID_KEY TO "History\EM011_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   EM011_BnkAcc_Valid                 EM011_BnkAcc_Valid               "Results" "EM011_BnkAcc_Valid.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~**** SOME HISTORY DELETED ****
~.19/02/2016   13:58:06 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   13:59:31 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:03:47 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:05:37 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:10:14 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:12:26 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:13:57 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:14:42 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:17:07 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:21:43 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:12 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:25:48 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:27:41 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:29:48 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:30:55 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:55 TMP6 EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_Name Bnk_Acc_Name Bnk_Acc_Type _RptRunDateTime AS 'RptRunDateTime' IF Co_Emp_ID=TMP4.Co_Emp_ID TO "Working_Files\EMF_BnkAcc_Chg_History" APPEND
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:36:10 EMF_BnkAcc_Chg_History EXTRACT FIELDS ALL  TMP1.COUNT IF TMP1.COUNT>VALUE(ALLTRIM(TXT_EM011_Chg_Times),0) TO Tmp_Files\TMP2 OPEN
~Input : Records:17204       Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:11 TMP2 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:11 TMP_Cur EXTRACT FIELDS Co_Emp_ID Emp_ID BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Bnk_Acc_Type Chg_Dt RptRunDateTime COUNT ID_KEY IF ID_KEY<> EM011_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:11 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:11 TMP10 SORT ON SORT_KEY D TO "Results\EM011_BnkAcc_Valid" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_EM012_History_ID_KEY           EM012_History                    "" "IDX_EM012_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_EM012_HISTORY_ID_KEY
^FORMAT   EM012_History                      EM012_History                    "History" "EM012_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:27 EMF_TMP_Emp EXTRACT FIELDS ALL IF Emp_Sts="A" AND (Ages > VALUE(TRIM(TXT_EM012_MaxAge),0) OR Ages < VALUE(TRIM(TXT_EM012_MinAge),0) OR ISBLANK(DATE(DOB))) TO "Tmp_Files\TMP1" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:27 TMP1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:27 TMP_Cur IF FTYPE("EM012_History")<>"y" OR FILESIZE("History\EM012_History.fil") <0 EXTRACT FIELDS ALL FIRST 0 TO "History\EM012_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:27 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num Ages ID_KEY TO "History\EM012_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:26:04 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num Ages ID_KEY TO "History\EM012_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:27:57 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num Ages ID_KEY TO "History\EM012_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:31:12 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num Ages ID_KEY TO "History\EM012_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:11 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num Ages ID_KEY TO "History\EM012_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   EM012_DOB_Valid                    EM012_DOB_Valid                  "Results" "EM012_DOB_Valid.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:53 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:54 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:36:11 EMF_TMP_Emp EXTRACT FIELDS ALL IF Emp_Sts="A" AND (Ages > VALUE(TRIM(TXT_EM012_MaxAge),0) OR Ages < VALUE(TRIM(TXT_EM012_MinAge),0) OR ISBLANK(DATE(DOB))) TO "Tmp_Files\TMP1" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:11 TMP1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:11 TMP_Cur EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num Invalid_TFN c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num Ages ID_KEY IF ID_KEY<> EM012_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:11 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:12 TMP10 SORT ON SORT_KEY D TO "Results\EM012_DOB_Valid" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_EM013_History_ID_KEY           EM013_History                    "" "IDX_EM013_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_EM013_HISTORY_ID_KEY
^FORMAT   EM013_History                      EM013_History                    "History" "EM013_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:27 EMF_TMP_Emp EXTRACT FIELDS ALL IF Emp_Sts="A" AND (Hire_Dt<=DOB OR ISBLANK(DATE(Hire_Dt)) OR EmployAge/365 > VALUE(TRIM(TXT_EM013_MaxYear),0) OR EmployAge2 < VALUE(TRIM(TXT_EM013_EmpMinDays),0) OR EmployAge2 > VALUE(TRIM(TXT_EM013_EmpMaxDays),0)) TO "Tmp_Files\TMP1" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:27 TMP1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:27 TMP_Cur IF FTYPE("EM013_History")<>"y" OR FILESIZE("History\EM013_History.fil") <0 EXTRACT FIELDS ALL FIRST 0 TO "History\EM013_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:28 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num Ages Invalid_TFN EmployAge EmployAge2 ID_KEY TO "History\EM013_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:26:04 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num Ages Invalid_TFN EmployAge EmployAge2 ID_KEY TO "History\EM013_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:27:58 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num Ages Invalid_TFN EmployAge EmployAge2 ID_KEY TO "History\EM013_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:31:13 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num Ages Invalid_TFN EmployAge EmployAge2 ID_KEY TO "History\EM013_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:12 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num Ages Invalid_TFN EmployAge EmployAge2 ID_KEY TO "History\EM013_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   EM013_StarDt_Valid                 EM013_StarDt_Valid               "Results" "EM013_StarDt_Valid.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:53 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:54 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:36:12 EMF_TMP_Emp EXTRACT FIELDS ALL IF Emp_Sts="A" AND (Hire_Dt<=DOB OR ISBLANK(DATE(Hire_Dt)) OR EmployAge/365 > VALUE(TRIM(TXT_EM013_MaxYear),0) OR EmployAge2 < VALUE(TRIM(TXT_EM013_EmpMinDays),0) OR EmployAge2 > VALUE(TRIM(TXT_EM013_EmpMaxDays),0)) TO "Tmp_Files\TMP1" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:12 TMP1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:12 TMP_Cur EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num Ages Invalid_TFN EmployAge EmployAge2 ID_KEY IF ID_KEY<> EM013_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:12 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:12 TMP10 SORT ON SORT_KEY TO "Results\EM013_StarDt_Valid" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_EM014_History_ID_KEY           EM014_History                    "" "IDX_EM014_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_EM014_HISTORY_ID_KEY
^FORMAT   EM014_History                      EM014_History                    "History" "EM014_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:11 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:24:28 EMF_TMP_Emp SET FILTER Emp_Sts="A" AND NOT FIND("full time", Emp_Catg) AND NOT FIND("ONGOING",Emp_Catg) AND NOT FIND("PERM",Emp_Catg)
~.19/02/2016   14:24:28 EMF_TMP_Emp EXTRACT FIELDS ALL IF ISBLANK(DATE(Trm_Dt)) TO "Tmp_Files\TMP1" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:28 TMP1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:28 TMP_Cur IF FTYPE("EM014_History")<>"y" OR FILESIZE("History\EM014_History.fil") <0 EXTRACT FIELDS ALL FIRST 0 TO "History\EM014_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:24:28 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num Ages Invalid_TFN EmployAge EmployAge2 ID_KEY TO "History\EM014_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:26:05 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num Ages Invalid_TFN EmployAge EmployAge2 ID_KEY TO "History\EM014_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:27:59 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num Ages Invalid_TFN EmployAge EmployAge2 ID_KEY TO "History\EM014_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:31:14 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num Ages Invalid_TFN EmployAge EmployAge2 ID_KEY TO "History\EM014_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:13 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num Ages Invalid_TFN EmployAge EmployAge2 ID_KEY TO "History\EM014_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   EM014_Tmp_No_EndDt                 EM014_Tmp_No_EndDt               "Results" "EM014_Tmp_No_EndDt.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:53 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:54 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:36:13 EMF_TMP_Emp SET FILTER Emp_Sts="A" AND NOT FIND("full time", Emp_Catg) AND NOT FIND("ONGOING",Emp_Catg) AND NOT FIND("PERM",Emp_Catg)
~.19/02/2016   14:36:13 EMF_TMP_Emp EXTRACT FIELDS ALL IF ISBLANK(DATE(Trm_Dt)) TO "Tmp_Files\TMP1" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:13 TMP1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:13 TMP_Cur EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE EMP_Sts Emp_ID Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Emp_Nme c_ADD c_Tel1 c_Tel2 c_Tel3 c_Fax c_Tax_Fle_Num c_BSB c_Bnk_Acc_Num Ages Invalid_TFN EmployAge EmployAge2 ID_KEY IF ID_KEY<> EM014_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:13 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:13 TMP10 SORT ON SORT_KEY TO "Results\EM014_Tmp_No_EndDt" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_PR001_History_ID_KEY           PR001_History                    "" "IDX_PR001_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_PR001_HISTORY_ID_KEY
^FORMAT   PR001_History                      PR001_History                    "History" "PR001_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.20160219     14:14:18 Payroll_details EXTRACT FIELDS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:27:42 PAYROLL_DATA  IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' DEC(Pay_Hrs,2) AS 'Pay_Hrs' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' 0.00 AS 'Standard_WeeklyHours' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE_DESC),1,15))) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' payroll_date AS 'Prd_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'ForPrd' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'InPrd' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\Payroll_Payments.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:27:59 Payroll_Payments SET FILTER NOT FIND('Payroll Tax',PayCode_Desc) AND NOT FIND('Superannuation',PayCode_Desc) AND NOT FIND('Loading',PayCode_Desc) 
~.19/02/2016   14:27:59 Payroll_Payments DUPLICATES ON Co_Emp_ID c_Prd_Dt ABS_PayCode_Amount OTHER ALL ALL PRESORT IF ABS_PayCode_Amount<>0 OPEN TO "Tmp_Files\TMP1.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:24          Control Total:0                    
~.19/02/2016   14:28:00 TMP1 EXTRACT FIELDS ALL IF PayCode_Amount>0.01 TO Tmp_Files\TMP3 OPEN
~Input : Records:24          Control Total:0                    
~Output: Records:24          Control Total:0                    
~.19/02/2016   14:28:00 TMP3 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:24          Control Total:0                    
~Output: Records:24          Control Total:0                    
~.19/02/2016   14:28:00 TMP_Cur IF FTYPE("PR001_History")<>"y" OR FILESIZE("History\PR001_History.fil") <0 EXTRACT FIELDS ALL IF 1<>1 TO "History\PR001_History" OPEN
~Input : Records:24          Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:28:00 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID c_Prd_Dt ABS_PayCode_Amount Co COST_CENTRE Emp_ID Period_Date PayCode PayCode_Amount Pay_Hrs LINE_NO LINE_DESC LINE_TYPE PAY_GROUP GL_Account_No PERIOD Standard_WeeklyHours PayCode_Desc Num_Field3 Num_Field4 Num_Field5 Prd_Dt Dt_Field2 Dt_Field3 ForPrd InPrd Cha_Field3 Cha_Field4 Cha_Field5 Year YM PrdSalaryAmt ActPaidAmt PrdGrsAmt RUNID_ForPrd RUNID_InPrd Co2 COST_CENTRE2 Emp_ID2 Period_Date2 PayCode2 PayCode_Amount2 Pay_Hrs2 LINE_NO2 LINE_DESC2 LINE_TYPE2 PAY_GROUP2 GL_Account_No2 PERIOD2 Standard_WeeklyHours2 PayCode_Desc2 Num_Field32 Num_Field42 Num_Field52 Prd_Dt2 Dt_Field22 Dt_Field32 ForPrd2 InPrd2 Cha_Field32 Cha_Field42 Cha_Field52 Year2 YM2 PrdSalaryAmt2 ActPaidAmt2 PrdGrsAmt2 RUNID_ForPrd2 RUNID_InPrd2 DUP_KEY ID_KEY TO "History\PR001_History" APPEND
~Input : Records:24          Control Total:0                    
~Output: Records:24          Control Total:0                    
~.19/02/2016   14:31:15 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID c_Prd_Dt ABS_PayCode_Amount Co COST_CENTRE Emp_ID Period_Date PayCode PayCode_Amount Pay_Hrs LINE_NO LINE_DESC LINE_TYPE PAY_GROUP GL_Account_No PERIOD Standard_WeeklyHours PayCode_Desc Num_Field3 Num_Field4 Num_Field5 Prd_Dt Dt_Field2 Dt_Field3 ForPrd InPrd Cha_Field3 Cha_Field4 Cha_Field5 Year YM PrdSalaryAmt ActPaidAmt PrdGrsAmt RUNID_ForPrd RUNID_InPrd Co2 COST_CENTRE2 Emp_ID2 Period_Date2 PayCode2 PayCode_Amount2 Pay_Hrs2 LINE_NO2 LINE_DESC2 LINE_TYPE2 PAY_GROUP2 GL_Account_No2 PERIOD2 Standard_WeeklyHours2 PayCode_Desc2 Num_Field32 Num_Field42 Num_Field52 Prd_Dt2 Dt_Field22 Dt_Field32 ForPrd2 InPrd2 Cha_Field32 Cha_Field42 Cha_Field52 Year2 YM2 PrdSalaryAmt2 ActPaidAmt2 PrdGrsAmt2 RUNID_ForPrd2 RUNID_InPrd2 DUP_KEY ID_KEY TO "History\PR001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:14 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID c_Prd_Dt ABS_PayCode_Amount Co COST_CENTRE Emp_ID Period_Date PayCode PayCode_Amount Pay_Hrs LINE_NO LINE_DESC LINE_TYPE PAY_GROUP GL_Account_No PERIOD Standard_WeeklyHours PayCode_Desc Num_Field3 Num_Field4 Num_Field5 Prd_Dt Dt_Field2 Dt_Field3 ForPrd InPrd Cha_Field3 Cha_Field4 Cha_Field5 Year YM PrdSalaryAmt ActPaidAmt PrdGrsAmt RUNID_ForPrd RUNID_InPrd Co2 COST_CENTRE2 Emp_ID2 Period_Date2 PayCode2 PayCode_Amount2 Pay_Hrs2 LINE_NO2 LINE_DESC2 LINE_TYPE2 PAY_GROUP2 GL_Account_No2 PERIOD2 Standard_WeeklyHours2 PayCode_Desc2 Num_Field32 Num_Field42 Num_Field52 Prd_Dt2 Dt_Field22 Dt_Field32 ForPrd2 InPrd2 Cha_Field32 Cha_Field42 Cha_Field52 Year2 YM2 PrdSalaryAmt2 ActPaidAmt2 PrdGrsAmt2 RUNID_ForPrd2 RUNID_InPrd2 DUP_KEY ID_KEY TO "History\PR001_History" APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   PR001_Mul_Paid                     PR001_Mul_Paid                   "Results" "PR001_Mul_Paid.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.20160219     14:30:29 Payroll_details EXTRACT FIELDS WEEKLY_HOURS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:35:55 PAYROLL_DATA  IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' DEC(Pay_Hrs,2) AS 'Pay_Hrs' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' DEC(WEEKLY_HOURS,2) AS 'Standard_WeeklyHours' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE_DESC),1,15))) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' payroll_date AS 'Prd_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'ForPrd' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'InPrd' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\Payroll_Payments.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:36:13 Payroll_Payments SET FILTER NOT FIND('Payroll Tax',PayCode_Desc) AND NOT FIND('Superannuation',PayCode_Desc) AND NOT FIND('Loading',PayCode_Desc) 
~.19/02/2016   14:36:13 Payroll_Payments DUPLICATES ON Co_Emp_ID c_Prd_Dt ABS_PayCode_Amount OTHER ALL ALL PRESORT IF ABS_PayCode_Amount<>0 OPEN TO "Tmp_Files\TMP1.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:24          Control Total:0                    
~.19/02/2016   14:36:14 TMP1 EXTRACT FIELDS ALL IF PayCode_Amount>0.01 TO Tmp_Files\TMP3 OPEN
~Input : Records:24          Control Total:0                    
~Output: Records:24          Control Total:0                    
~.19/02/2016   14:36:14 TMP3 EXTRACT RECORD TO Tmp_Files\TMP_Cur OPEN
~Input : Records:24          Control Total:0                    
~Output: Records:24          Control Total:0                    
~.19/02/2016   14:36:14 TMP_Cur EXTRACT FIELDS Co_Emp_ID c_Prd_Dt ABS_PayCode_Amount Co COST_CENTRE Emp_ID Period_Date PayCode PayCode_Amount Pay_Hrs LINE_NO LINE_DESC LINE_TYPE PAY_GROUP GL_Account_No PERIOD Standard_WeeklyHours PayCode_Desc Num_Field3 Num_Field4 Num_Field5 Prd_Dt Dt_Field2 Dt_Field3 ForPrd InPrd Cha_Field3 Cha_Field4 Cha_Field5 Year YM PrdSalaryAmt ActPaidAmt PrdGrsAmt RUNID_ForPrd RUNID_InPrd Co2 COST_CENTRE2 Emp_ID2 Period_Date2 PayCode2 PayCode_Amount2 Pay_Hrs2 LINE_NO2 LINE_DESC2 LINE_TYPE2 PAY_GROUP2 GL_Account_No2 PERIOD2 Standard_WeeklyHours2 PayCode_Desc2 Num_Field32 Num_Field42 Num_Field52 Prd_Dt2 Dt_Field22 Dt_Field32 ForPrd2 InPrd2 Cha_Field32 Cha_Field42 Cha_Field52 Year2 YM2 PrdSalaryAmt2 ActPaidAmt2 PrdGrsAmt2 RUNID_ForPrd2 RUNID_InPrd2 DUP_KEY ID_KEY IF DUP_KEY= TMP_His.DUP_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:24          Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:14 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:14 TMP10 SORT ON SORT_KEY D TO "Results\PR001_Mul_Paid"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_PR002_History_ID_KEY           PR002_History                    "" "IDX_PR002_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_PR002_HISTORY_ID_KEY
^FORMAT   PR002_History                      PR002_History                    "History" "PR002_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.20160219     14:14:18 Payroll_details EXTRACT FIELDS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:27:42 PAYROLL_DATA  IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' DEC(Pay_Hrs,2) AS 'Pay_Hrs' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' 0.00 AS 'Standard_WeeklyHours' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE_DESC),1,15))) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' payroll_date AS 'Prd_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'ForPrd' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'InPrd' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\Payroll_Payments.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:28:00 Payroll_Payments EXTRACT FIELDS ALL IF ISBLANK(EMF_TMP_Emp.Co_Emp_ID) TO "Tmp_Files\TMP1" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:28:00 TMP1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:28:01 TMP_Cur IF FTYPE("PR002_History")<>"y" OR FILESIZE("History\PR002_History.fil") <0 EXTRACT FIELDS ALL FIRST 0 TO "History\PR002_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:28:01 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE Emp_ID Period_Date PayCode PayCode_Amount Pay_Hrs LINE_NO LINE_DESC LINE_TYPE PAY_GROUP GL_Account_No PERIOD Standard_WeeklyHours PayCode_Desc Num_Field3 Num_Field4 Num_Field5 Prd_Dt Dt_Field2 Dt_Field3 ForPrd InPrd Cha_Field3 Cha_Field4 Cha_Field5 Year YM c_Prd_Dt ABS_PayCode_Amount PrdSalaryAmt ActPaidAmt PrdGrsAmt RUNID_ForPrd RUNID_InPrd ID_KEY TO "History\PR002_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:31:16 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE Emp_ID Period_Date PayCode PayCode_Amount Pay_Hrs LINE_NO LINE_DESC LINE_TYPE PAY_GROUP GL_Account_No PERIOD Standard_WeeklyHours PayCode_Desc Num_Field3 Num_Field4 Num_Field5 Prd_Dt Dt_Field2 Dt_Field3 ForPrd InPrd Cha_Field3 Cha_Field4 Cha_Field5 Year YM c_Prd_Dt ABS_PayCode_Amount PrdSalaryAmt ActPaidAmt PrdGrsAmt RUNID_ForPrd RUNID_InPrd ID_KEY TO "History\PR002_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:15 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE Emp_ID Period_Date PayCode PayCode_Amount Pay_Hrs LINE_NO LINE_DESC LINE_TYPE PAY_GROUP GL_Account_No PERIOD Standard_WeeklyHours PayCode_Desc Num_Field3 Num_Field4 Num_Field5 Prd_Dt Dt_Field2 Dt_Field3 ForPrd InPrd Cha_Field3 Cha_Field4 Cha_Field5 Year YM c_Prd_Dt ABS_PayCode_Amount PrdSalaryAmt ActPaidAmt PrdGrsAmt RUNID_ForPrd RUNID_InPrd ID_KEY TO "History\PR002_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   PR002_Not_in_Emf                   PR002_Not_in_Emf                 "Results" "PR002_Not_in_Emf.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.20160219     14:30:29 Payroll_details EXTRACT FIELDS WEEKLY_HOURS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:35:55 PAYROLL_DATA  IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' DEC(Pay_Hrs,2) AS 'Pay_Hrs' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' DEC(WEEKLY_HOURS,2) AS 'Standard_WeeklyHours' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE_DESC),1,15))) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' payroll_date AS 'Prd_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'ForPrd' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'InPrd' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\Payroll_Payments.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:36:15 Payroll_Payments EXTRACT FIELDS ALL IF ISBLANK(EMF_TMP_Emp.Co_Emp_ID) TO "Tmp_Files\TMP1" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:15 TMP1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:15 TMP_Cur EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE Emp_ID Period_Date PayCode PayCode_Amount Pay_Hrs LINE_NO LINE_DESC LINE_TYPE PAY_GROUP GL_Account_No PERIOD Standard_WeeklyHours PayCode_Desc Num_Field3 Num_Field4 Num_Field5 Prd_Dt Dt_Field2 Dt_Field3 ForPrd InPrd Cha_Field3 Cha_Field4 Cha_Field5 Year YM c_Prd_Dt ABS_PayCode_Amount PrdSalaryAmt ActPaidAmt PrdGrsAmt RUNID_ForPrd RUNID_InPrd ID_KEY IF ID_KEY<> PR002_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:15 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:15 TMP10 SORT ON SORT_KEY D TO "Results\PR002_Not_in_Emf"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_PR003_History_ID_KEY           PR003_History                    "" "IDX_PR003_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_PR003_HISTORY_ID_KEY
^FORMAT   PR003_History                      PR003_History                    "History" "PR003_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.20160219     14:14:18 Payroll_details EXTRACT FIELDS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:27:42 PAYROLL_DATA  IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' DEC(Pay_Hrs,2) AS 'Pay_Hrs' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' 0.00 AS 'Standard_WeeklyHours' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE_DESC),1,15))) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' payroll_date AS 'Prd_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'ForPrd' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'InPrd' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\Payroll_Payments.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:28:01 Payroll_Payments SET FILTER NOT FIND('Payroll Tax',PayCode_Desc) AND NOT FIND('Superannuation',PayCode_Desc) AND NOT FIND('Loading',PayCode_Desc) 
~.19/02/2016   14:28:01 Payroll_Payments EXTRACT FIELDS Trm_Prd_Days ALL ALL IF EMF_TMP_Emp.Emp_Sts = "I" AND Trm_Prd_Days > VALUE(ALLTRIM(TXT_PR003_Days),0) AND ABS_PAYCODE_AMOUNT<>0 TO "Tmp_Files\TMP1" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:1           Control Total:0                    
~.19/02/2016   14:28:01 TMP1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:1           Control Total:0                    
~Output: Records:1           Control Total:0                    
~.19/02/2016   14:28:01 TMP_Cur IF FTYPE("PR003_History")<>"y" OR FILESIZE("History\PR003_History.fil") <0 EXTRACT FIELDS ALL FIRST 0 TO "History\PR003_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:28:01 TMP_Cur1 EXTRACT FIELDS Trm_Prd_Days Co_Emp_ID Co COST_CENTRE Emp_ID Period_Date PayCode PayCode_Amount Pay_Hrs LINE_NO LINE_DESC LINE_TYPE PAY_GROUP GL_Account_No PERIOD Standard_WeeklyHours PayCode_Desc Num_Field3 Num_Field4 Num_Field5 Prd_Dt Dt_Field2 Dt_Field3 ForPrd InPrd Cha_Field3 Cha_Field4 Cha_Field5 Year YM c_Prd_Dt ABS_PayCode_Amount PrdSalaryAmt ActPaidAmt PrdGrsAmt RUNID_ForPrd RUNID_InPrd Trm_Prd_Days2 Co_Emp_ID2 Co2 COST_CENTRE2 Emp_ID2 Period_Date2 PayCode2 PayCode_Amount2 Pay_Hrs2 LINE_NO2 LINE_DESC2 LINE_TYPE2 PAY_GROUP2 GL_Account_No2 PERIOD2 Standard_WeeklyHours2 PayCode_Desc2 Num_Field32 Num_Field42 Num_Field52 Prd_Dt2 Dt_Field22 Dt_Field32 ForPrd2 InPrd2 Cha_Field32 Cha_Field42 Cha_Field52 Year2 YM2 c_Prd_Dt2 ABS_PayCode_Amount2 PrdSalaryAmt2 ActPaidAmt2 PrdGrsAmt2 RUNID_ForPrd2 RUNID_InPrd2 Trm_Prd_Days3 ID_KEY TO "History\PR003_History"APPEND
~Input : Records:1           Control Total:0                    
~Output: Records:1           Control Total:0                    
~.19/02/2016   14:31:16 TMP_Cur1 EXTRACT FIELDS Trm_Prd_Days Co_Emp_ID Co COST_CENTRE Emp_ID Period_Date PayCode PayCode_Amount Pay_Hrs LINE_NO LINE_DESC LINE_TYPE PAY_GROUP GL_Account_No PERIOD Standard_WeeklyHours PayCode_Desc Num_Field3 Num_Field4 Num_Field5 Prd_Dt Dt_Field2 Dt_Field3 ForPrd InPrd Cha_Field3 Cha_Field4 Cha_Field5 Year YM c_Prd_Dt ABS_PayCode_Amount PrdSalaryAmt ActPaidAmt PrdGrsAmt RUNID_ForPrd RUNID_InPrd Trm_Prd_Days2 Co_Emp_ID2 Co2 COST_CENTRE2 Emp_ID2 Period_Date2 PayCode2 PayCode_Amount2 Pay_Hrs2 LINE_NO2 LINE_DESC2 LINE_TYPE2 PAY_GROUP2 GL_Account_No2 PERIOD2 Standard_WeeklyHours2 PayCode_Desc2 Num_Field32 Num_Field42 Num_Field52 Prd_Dt2 Dt_Field22 Dt_Field32 ForPrd2 InPrd2 Cha_Field32 Cha_Field42 Cha_Field52 Year2 YM2 c_Prd_Dt2 ABS_PayCode_Amount2 PrdSalaryAmt2 ActPaidAmt2 PrdGrsAmt2 RUNID_ForPrd2 RUNID_InPrd2 Trm_Prd_Days3 ID_KEY TO "History\PR003_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:16 TMP_Cur1 EXTRACT FIELDS Trm_Prd_Days Co_Emp_ID Co COST_CENTRE Emp_ID Period_Date PayCode PayCode_Amount Pay_Hrs LINE_NO LINE_DESC LINE_TYPE PAY_GROUP GL_Account_No PERIOD Standard_WeeklyHours PayCode_Desc Num_Field3 Num_Field4 Num_Field5 Prd_Dt Dt_Field2 Dt_Field3 ForPrd InPrd Cha_Field3 Cha_Field4 Cha_Field5 Year YM c_Prd_Dt ABS_PayCode_Amount PrdSalaryAmt ActPaidAmt PrdGrsAmt RUNID_ForPrd RUNID_InPrd Trm_Prd_Days2 Co_Emp_ID2 Co2 COST_CENTRE2 Emp_ID2 Period_Date2 PayCode2 PayCode_Amount2 Pay_Hrs2 LINE_NO2 LINE_DESC2 LINE_TYPE2 PAY_GROUP2 GL_Account_No2 PERIOD2 Standard_WeeklyHours2 PayCode_Desc2 Num_Field32 Num_Field42 Num_Field52 Prd_Dt2 Dt_Field22 Dt_Field32 ForPrd2 InPrd2 Cha_Field32 Cha_Field42 Cha_Field52 Year2 YM2 c_Prd_Dt2 ABS_PayCode_Amount2 PrdSalaryAmt2 ActPaidAmt2 PrdGrsAmt2 RUNID_ForPrd2 RUNID_InPrd2 Trm_Prd_Days3 ID_KEY TO "History\PR003_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   PR003_Pay_30D_Aft_Trm              PR003_Pay_30D_Aft_Trm            "Results" "PR003_Pay_30D_Aft_Trm.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.20160219     14:30:29 Payroll_details EXTRACT FIELDS WEEKLY_HOURS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:35:55 PAYROLL_DATA  IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' DEC(Pay_Hrs,2) AS 'Pay_Hrs' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' DEC(WEEKLY_HOURS,2) AS 'Standard_WeeklyHours' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE_DESC),1,15))) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' payroll_date AS 'Prd_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'ForPrd' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'InPrd' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\Payroll_Payments.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:36:15 Payroll_Payments SET FILTER NOT FIND('Payroll Tax',PayCode_Desc) AND NOT FIND('Superannuation',PayCode_Desc) AND NOT FIND('Loading',PayCode_Desc) 
~.19/02/2016   14:36:15 Payroll_Payments EXTRACT FIELDS Trm_Prd_Days ALL ALL IF EMF_TMP_Emp.Emp_Sts = "I" AND Trm_Prd_Days > VALUE(ALLTRIM(TXT_PR003_Days),0) AND ABS_PAYCODE_AMOUNT<>0 TO "Tmp_Files\TMP1" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:1           Control Total:0                    
~.19/02/2016   14:36:15 TMP1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:1           Control Total:0                    
~Output: Records:1           Control Total:0                    
~.19/02/2016   14:36:16 TMP_Cur EXTRACT FIELDS Trm_Prd_Days Co_Emp_ID Co COST_CENTRE Emp_ID Period_Date PayCode PayCode_Amount Pay_Hrs LINE_NO LINE_DESC LINE_TYPE PAY_GROUP GL_Account_No PERIOD Standard_WeeklyHours PayCode_Desc Num_Field3 Num_Field4 Num_Field5 Prd_Dt Dt_Field2 Dt_Field3 ForPrd InPrd Cha_Field3 Cha_Field4 Cha_Field5 Year YM c_Prd_Dt ABS_PayCode_Amount PrdSalaryAmt ActPaidAmt PrdGrsAmt RUNID_ForPrd RUNID_InPrd Trm_Prd_Days2 Co_Emp_ID2 Co2 COST_CENTRE2 Emp_ID2 Period_Date2 PayCode2 PayCode_Amount2 Pay_Hrs2 LINE_NO2 LINE_DESC2 LINE_TYPE2 PAY_GROUP2 GL_Account_No2 PERIOD2 Standard_WeeklyHours2 PayCode_Desc2 Num_Field32 Num_Field42 Num_Field52 Prd_Dt2 Dt_Field22 Dt_Field32 ForPrd2 InPrd2 Cha_Field32 Cha_Field42 Cha_Field52 Year2 YM2 c_Prd_Dt2 ABS_PayCode_Amount2 PrdSalaryAmt2 ActPaidAmt2 PrdGrsAmt2 RUNID_ForPrd2 RUNID_InPrd2 Trm_Prd_Days3 ID_KEY IF ID_KEY<> PR003_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:1           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:16 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:16 TMP10 SORT ON SORT_KEY TO "Results\PR003_Pay_30D_Aft_Trm"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_PR004_History_ID_KEY           PR004_History                    "" "IDX_PR004_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_PR004_HISTORY_ID_KEY
^FORMAT   PR004_History                      PR004_History                    "History" "PR004_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.20160219     14:14:18 Payroll_details EXTRACT FIELDS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:27:42 PAYROLL_DATA  IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' DEC(Pay_Hrs,2) AS 'Pay_Hrs' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' 0.00 AS 'Standard_WeeklyHours' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE_DESC),1,15))) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' payroll_date AS 'Prd_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'ForPrd' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'InPrd' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\Payroll_Payments.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:28:02 Payroll_Payments SET FILTER MATCH(PayCode_Desc,'Do Not Pay','Inactive Status','Income Protection','Long Term Unpaid Leave','Parental Leave','Paternity Leave','Workers Compensation')
~.19/02/2016   14:28:02 Payroll_Payments SUMMARIZE ON Co_Emp_ID c_Prd_Dt OTHER Prd_Dt SUBTOTAL Pay_Hrs PAYCODE_AMOUNT IF PAYCODE_AMOUNT<>0  TO "Tmp_Files\TMP1.FIL" OPEN PRESORT
~Input : Records:5801        Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:28:02 TMP1 SORT ON Co_Emp_ID c_Prd_Dt IF PAYCODE_AMOUNT>0 TO "Tmp_Files\TMP2" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:28:02 TMP2 EXTRACT FIELDS ALL IF NOT ISBLANK(TMP5.Co_Emp_ID) TO Tmp_Files\TMP1 OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:28:02 TMP1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:28:02 TMP_Cur IF FTYPE("PR004_History")<>"y" OR FILESIZE("History\PR004_History.fil") <0 EXTRACT FIELDS ALL FIRST 0 TO "History\PR004_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:28:02 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID c_Prd_Dt Pay_Hrs PayCode_Amount COUNT Prd_Dt ID Consec1 Consec2 KEY ID_KEY TO "History\PR004_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:31:17 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID c_Prd_Dt Pay_Hrs PayCode_Amount COUNT Prd_Dt ID Consec1 Consec2 KEY ID_KEY TO "History\PR004_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:17 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID c_Prd_Dt Pay_Hrs PayCode_Amount COUNT Prd_Dt ID Consec1 Consec2 KEY ID_KEY TO "History\PR004_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   PR004_Spec_Leave_3Mon              PR004_Spec_Leave_3Mon            "Results" "PR004_Spec_Leave_3Mon.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.20160219     14:30:29 Payroll_details EXTRACT FIELDS WEEKLY_HOURS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:35:55 PAYROLL_DATA  IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' DEC(Pay_Hrs,2) AS 'Pay_Hrs' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' DEC(WEEKLY_HOURS,2) AS 'Standard_WeeklyHours' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE_DESC),1,15))) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' payroll_date AS 'Prd_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'ForPrd' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'InPrd' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\Payroll_Payments.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:36:17 Payroll_Payments EXTRACT FIELDS ALL ALL IF NOT ISBLANK(TMP2.Co_Emp_ID) TO Tmp_Files\TMP3 OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:17 TMP3 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:17 TMP10 SORT ON SORT_KEY D TO "Results\PR004_Spec_Leave_3Mon"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_PR005_History_ID_KEY           PR005_History                    "" "IDX_PR005_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_PR005_HISTORY_ID_KEY
^FORMAT   PR005_History                      PR005_History                    "History" "PR005_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.20160219     14:14:18 Payroll_details EXTRACT FIELDS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:27:42 PAYROLL_DATA  IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' DEC(Pay_Hrs,2) AS 'Pay_Hrs' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' 0.00 AS 'Standard_WeeklyHours' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE_DESC),1,15))) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' payroll_date AS 'Prd_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'ForPrd' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'InPrd' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\Payroll_Payments.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:28:03 Payroll_Payments SET FILTER FIND('Termination',PayCode_Desc)
~.19/02/2016   14:28:03 Payroll_Payments EXTRACT FIELDS ALL ALL  IF (EMF_TMP_Emp.Emp_Sts = "A")  TO "Tmp_Files\TMP1" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:28:03 TMP1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:28:03 TMP_Cur IF FTYPE("PR005_History")<>"y" OR FILESIZE("History\PR005_History.fil") <0 EXTRACT FIELDS ALL FIRST 0 TO "History\PR005_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:28:03 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE Emp_ID Period_Date PayCode PayCode_Amount Pay_Hrs LINE_NO LINE_DESC LINE_TYPE PAY_GROUP GL_Account_No PERIOD Standard_WeeklyHours PayCode_Desc Num_Field3 Num_Field4 Num_Field5 Prd_Dt Dt_Field2 Dt_Field3 ForPrd InPrd Cha_Field3 Cha_Field4 Cha_Field5 Year YM c_Prd_Dt ABS_PayCode_Amount PrdSalaryAmt ActPaidAmt PrdGrsAmt RUNID_ForPrd RUNID_InPrd Trm_Prd_Days KEY Co_Emp_ID2 Co2 COST_CENTRE2 Emp_ID2 Period_Date2 PayCode2 PayCode_Amount2 Pay_Hrs2 LINE_NO2 LINE_DESC2 LINE_TYPE2 PAY_GROUP2 GL_Account_No2 PERIOD2 Standard_WeeklyHours2 PayCode_Desc2 Num_Field32 Num_Field42 Num_Field52 Prd_Dt2 Dt_Field22 Dt_Field32 ForPrd2 InPrd2 Cha_Field32 Cha_Field42 Cha_Field52 Year2 YM2 c_Prd_Dt2 ABS_PayCode_Amount2 PrdSalaryAmt2 ActPaidAmt2 PrdGrsAmt2 RUNID_ForPrd2 RUNID_InPrd2 Trm_Prd_Days2 KEY2 ID_KEY TO "History\PR005_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:31:18 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE Emp_ID Period_Date PayCode PayCode_Amount Pay_Hrs LINE_NO LINE_DESC LINE_TYPE PAY_GROUP GL_Account_No PERIOD Standard_WeeklyHours PayCode_Desc Num_Field3 Num_Field4 Num_Field5 Prd_Dt Dt_Field2 Dt_Field3 ForPrd InPrd Cha_Field3 Cha_Field4 Cha_Field5 Year YM c_Prd_Dt ABS_PayCode_Amount PrdSalaryAmt ActPaidAmt PrdGrsAmt RUNID_ForPrd RUNID_InPrd Trm_Prd_Days KEY Co_Emp_ID2 Co2 COST_CENTRE2 Emp_ID2 Period_Date2 PayCode2 PayCode_Amount2 Pay_Hrs2 LINE_NO2 LINE_DESC2 LINE_TYPE2 PAY_GROUP2 GL_Account_No2 PERIOD2 Standard_WeeklyHours2 PayCode_Desc2 Num_Field32 Num_Field42 Num_Field52 Prd_Dt2 Dt_Field22 Dt_Field32 ForPrd2 InPrd2 Cha_Field32 Cha_Field42 Cha_Field52 Year2 YM2 c_Prd_Dt2 ABS_PayCode_Amount2 PrdSalaryAmt2 ActPaidAmt2 PrdGrsAmt2 RUNID_ForPrd2 RUNID_InPrd2 Trm_Prd_Days2 KEY2 ID_KEY TO "History\PR005_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:18 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE Emp_ID Period_Date PayCode PayCode_Amount Pay_Hrs LINE_NO LINE_DESC LINE_TYPE PAY_GROUP GL_Account_No PERIOD Standard_WeeklyHours PayCode_Desc Num_Field3 Num_Field4 Num_Field5 Prd_Dt Dt_Field2 Dt_Field3 ForPrd InPrd Cha_Field3 Cha_Field4 Cha_Field5 Year YM c_Prd_Dt ABS_PayCode_Amount PrdSalaryAmt ActPaidAmt PrdGrsAmt RUNID_ForPrd RUNID_InPrd Trm_Prd_Days KEY Co_Emp_ID2 Co2 COST_CENTRE2 Emp_ID2 Period_Date2 PayCode2 PayCode_Amount2 Pay_Hrs2 LINE_NO2 LINE_DESC2 LINE_TYPE2 PAY_GROUP2 GL_Account_No2 PERIOD2 Standard_WeeklyHours2 PayCode_Desc2 Num_Field32 Num_Field42 Num_Field52 Prd_Dt2 Dt_Field22 Dt_Field32 ForPrd2 InPrd2 Cha_Field32 Cha_Field42 Cha_Field52 Year2 YM2 c_Prd_Dt2 ABS_PayCode_Amount2 PrdSalaryAmt2 ActPaidAmt2 PrdGrsAmt2 RUNID_ForPrd2 RUNID_InPrd2 Trm_Prd_Days2 KEY2 ID_KEY TO "History\PR005_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   PR005_Pay_TrmAmt_Sleeper           PR005_Pay_TrmAmt_Sleeper         "Results" "PR005_Pay_TrmAmt_Sleeper.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.20160219     14:30:29 Payroll_details EXTRACT FIELDS WEEKLY_HOURS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:35:55 PAYROLL_DATA  IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' DEC(Pay_Hrs,2) AS 'Pay_Hrs' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' DEC(WEEKLY_HOURS,2) AS 'Standard_WeeklyHours' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE_DESC),1,15))) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' payroll_date AS 'Prd_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'ForPrd' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'InPrd' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\Payroll_Payments.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:36:17 Payroll_Payments SET FILTER FIND('Termination',PayCode_Desc)
~.19/02/2016   14:36:17 Payroll_Payments EXTRACT FIELDS ALL ALL  IF (EMF_TMP_Emp.Emp_Sts = "A")  TO "Tmp_Files\TMP1" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:17 TMP1 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:18 TMP_Cur EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE Emp_ID Period_Date PayCode PayCode_Amount Pay_Hrs LINE_NO LINE_DESC LINE_TYPE PAY_GROUP GL_Account_No PERIOD Standard_WeeklyHours PayCode_Desc Num_Field3 Num_Field4 Num_Field5 Prd_Dt Dt_Field2 Dt_Field3 ForPrd InPrd Cha_Field3 Cha_Field4 Cha_Field5 Year YM c_Prd_Dt ABS_PayCode_Amount PrdSalaryAmt ActPaidAmt PrdGrsAmt RUNID_ForPrd RUNID_InPrd Trm_Prd_Days KEY Co_Emp_ID2 Co2 COST_CENTRE2 Emp_ID2 Period_Date2 PayCode2 PayCode_Amount2 Pay_Hrs2 LINE_NO2 LINE_DESC2 LINE_TYPE2 PAY_GROUP2 GL_Account_No2 PERIOD2 Standard_WeeklyHours2 PayCode_Desc2 Num_Field32 Num_Field42 Num_Field52 Prd_Dt2 Dt_Field22 Dt_Field32 ForPrd2 InPrd2 Cha_Field32 Cha_Field42 Cha_Field52 Year2 YM2 c_Prd_Dt2 ABS_PayCode_Amount2 PrdSalaryAmt2 ActPaidAmt2 PrdGrsAmt2 RUNID_ForPrd2 RUNID_InPrd2 Trm_Prd_Days2 KEY2 ID_KEY IF ID_KEY<> PR005_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:18 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:18 TMP10 SORT ON SORT_KEY D TO "Results\PR005_Pay_TrmAmt_Sleeper"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_PR006_History_ID_KEY           PR006_History                    "" "IDX_PR006_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_PR006_HISTORY_ID_KEY
^FORMAT   PR006_History                      PR006_History                    "History" "PR006_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.20160219     14:14:18 Payroll_details EXTRACT FIELDS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:27:42 PAYROLL_DATA  IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' DEC(Pay_Hrs,2) AS 'Pay_Hrs' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' 0.00 AS 'Standard_WeeklyHours' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE_DESC),1,15))) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' payroll_date AS 'Prd_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'ForPrd' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'InPrd' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\Payroll_Payments.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:28:04 Payroll_Payments SET FILTER NOT MATCH(PayCode_Desc,'Payroll Tax; PAYROLL TAX SOUTH AUST','Superannuation Voluntary;','Annual Leave; LEAVE LOADING')
~.19/02/2016   14:28:04 Payroll_Payments SUMMARIZE ON RUNID_InPrd SUBTOTAL PayCode_Amount AS 'Ttl_SuperAmt' OTHER ALL ALL IF EMF_TMP_Emp.EMP_Sts <> "I" AND ABS(PayCode_Amount) > 0.00 TO "Tmp_Files\TMP1.FIL" OPEN  PRESORT
~Input : Records:5801        Control Total:0                    
~Output: Records:2681        Control Total:0                    
~.19/02/2016   14:28:04 TMP1 SET FILTER ABS(Ttl_SuperAmt)>0.00 AND ABS(Ttl_SuperPaidAmt) <= VALUE(TXT_PR006_SpRt,2)
~.19/02/2016   14:28:04 TMP1 EXTRACT FIELDS TMP2.Ttl_PayAmt TMP2.PayCode ALL TO "Tmp_Files\TMP3" OPEN
~Input : Records:2681        Control Total:0                    
~Output: Records:2681        Control Total:0                    
~.19/02/2016   14:28:10 TMP3 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:2681        Control Total:0                    
~Output: Records:2681        Control Total:0                    
~.19/02/2016   14:28:10 TMP_Cur IF FTYPE("PR006_History")<>"y" OR FILESIZE("History\PR006_History.fil") <0 EXTRACT FIELDS ALL FIRST 0 TO "History\PR006_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:28:10 TMP_Cur1 EXTRACT FIELDS Ttl_PayAmt PayCode RUNID_InPrd Ttl_SuperAmt COUNT Co_Emp_ID Co COST_CENTRE Emp_ID Period_Date PayCode_Amount Pay_Hrs LINE_NO LINE_DESC LINE_TYPE PAY_GROUP GL_Account_No PERIOD Standard_WeeklyHours PayCode_Desc Num_Field3 Num_Field4 Num_Field5 Prd_Dt Dt_Field2 Dt_Field3 ForPrd InPrd Cha_Field3 Cha_Field4 Cha_Field5 Year YM c_Prd_Dt ABS_PayCode_Amount PrdSalaryAmt ActPaidAmt PrdGrsAmt RUNID_ForPrd Trm_Prd_Days KEY Co_Emp_ID2 Co2 COST_CENTRE2 Emp_ID2 Period_Date2 PayCode2 PayCode_Amount2 Pay_Hrs2 LINE_NO2 LINE_DESC2 LINE_TYPE2 PAY_GROUP2 GL_Account_No2 PERIOD2 Standard_WeeklyHours2 PayCode_Desc2 Num_Field32 Num_Field42 Num_Field52 Prd_Dt2 Dt_Field22 Dt_Field32 ForPrd2 InPrd2 Cha_Field32 Cha_Field42 Cha_Field52 Year2 YM2 c_Prd_Dt2 ABS_PayCode_Amount2 PrdSalaryAmt2 ActPaidAmt2 PrdGrsAmt2 RUNID_ForPrd2 Trm_Prd_Days2 KEY2 Ttl_SuperPaidAmt SGC_Pct ID_KEY RptRunDate SORT_KEY SORT_KEY_Desc Priority Data_Range_Start_Date Data_Range_End_Date TEST_NAME TO "History\PR006_History"APPEND
~Input : Records:2681        Control Total:0                    
~Output: Records:2681        Control Total:0                    
~.19/02/2016   14:31:41 TMP_Cur1 EXTRACT FIELDS Ttl_PayAmt PayCode RUNID_InPrd Ttl_SuperAmt COUNT Co_Emp_ID Co COST_CENTRE Emp_ID Period_Date PayCode_Amount Pay_Hrs LINE_NO LINE_DESC LINE_TYPE PAY_GROUP GL_Account_No PERIOD Standard_WeeklyHours PayCode_Desc Num_Field3 Num_Field4 Num_Field5 Prd_Dt Dt_Field2 Dt_Field3 ForPrd InPrd Cha_Field3 Cha_Field4 Cha_Field5 Year YM c_Prd_Dt ABS_PayCode_Amount PrdSalaryAmt ActPaidAmt PrdGrsAmt RUNID_ForPrd Trm_Prd_Days KEY Co_Emp_ID2 Co2 COST_CENTRE2 Emp_ID2 Period_Date2 PayCode2 PayCode_Amount2 Pay_Hrs2 LINE_NO2 LINE_DESC2 LINE_TYPE2 PAY_GROUP2 GL_Account_No2 PERIOD2 Standard_WeeklyHours2 PayCode_Desc2 Num_Field32 Num_Field42 Num_Field52 Prd_Dt2 Dt_Field22 Dt_Field32 ForPrd2 InPrd2 Cha_Field32 Cha_Field42 Cha_Field52 Year2 YM2 c_Prd_Dt2 ABS_PayCode_Amount2 PrdSalaryAmt2 ActPaidAmt2 PrdGrsAmt2 RUNID_ForPrd2 Trm_Prd_Days2 KEY2 Ttl_SuperPaidAmt SGC_Pct ID_KEY RptRunDate SORT_KEY SORT_KEY_Desc Priority Data_Range_Start_Date Data_Range_End_Date TEST_NAME TO "History\PR006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:37:22 TMP_Cur1 EXTRACT FIELDS Ttl_PayAmt PayCode RUNID_InPrd Ttl_SuperAmt COUNT Co_Emp_ID Co COST_CENTRE Emp_ID Period_Date PayCode_Amount Pay_Hrs LINE_NO LINE_DESC LINE_TYPE PAY_GROUP GL_Account_No PERIOD Standard_WeeklyHours PayCode_Desc Num_Field3 Num_Field4 Num_Field5 Prd_Dt Dt_Field2 Dt_Field3 ForPrd InPrd Cha_Field3 Cha_Field4 Cha_Field5 Year YM c_Prd_Dt ABS_PayCode_Amount PrdSalaryAmt ActPaidAmt PrdGrsAmt RUNID_ForPrd Trm_Prd_Days KEY Co_Emp_ID2 Co2 COST_CENTRE2 Emp_ID2 Period_Date2 PayCode2 PayCode_Amount2 Pay_Hrs2 LINE_NO2 LINE_DESC2 LINE_TYPE2 PAY_GROUP2 GL_Account_No2 PERIOD2 Standard_WeeklyHours2 PayCode_Desc2 Num_Field32 Num_Field42 Num_Field52 Prd_Dt2 Dt_Field22 Dt_Field32 ForPrd2 InPrd2 Cha_Field32 Cha_Field42 Cha_Field52 Year2 YM2 c_Prd_Dt2 ABS_PayCode_Amount2 PrdSalaryAmt2 ActPaidAmt2 PrdGrsAmt2 RUNID_ForPrd2 Trm_Prd_Days2 KEY2 Ttl_SuperPaidAmt SGC_Pct ID_KEY RptRunDate SORT_KEY SORT_KEY_Desc Priority Data_Range_Start_Date Data_Range_End_Date TEST_NAME TO "History\PR006_History"APPEND
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   PR006_Unusual_Super                PR006_Unusual_Super              "Results" "PR006_Unusual_Super.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.20160219     14:30:29 Payroll_details EXTRACT FIELDS WEEKLY_HOURS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:35:55 PAYROLL_DATA  IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' DEC(Pay_Hrs,2) AS 'Pay_Hrs' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' DEC(WEEKLY_HOURS,2) AS 'Standard_WeeklyHours' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE_DESC),1,15))) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' payroll_date AS 'Prd_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'ForPrd' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'InPrd' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\Payroll_Payments.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:36:18 Payroll_Payments SET FILTER NOT MATCH(PayCode_Desc,'Payroll Tax; PAYROLL TAX SOUTH AUST','Superannuation Voluntary;','Annual Leave; LEAVE LOADING')
~.19/02/2016   14:36:18 Payroll_Payments SUMMARIZE ON RUNID_InPrd SUBTOTAL PayCode_Amount AS 'Ttl_SuperAmt' OTHER ALL ALL IF EMF_TMP_Emp.EMP_Sts <> "I" AND ABS(PayCode_Amount) > 0.00 TO "Tmp_Files\TMP1.FIL" OPEN  PRESORT
~Input : Records:5801        Control Total:0                    
~Output: Records:2681        Control Total:0                    
~.19/02/2016   14:36:19 TMP1 SET FILTER ABS(Ttl_SuperAmt)>0.00 AND ABS(Ttl_SuperPaidAmt) <= VALUE(TXT_PR006_SpRt,2)
~.19/02/2016   14:36:19 TMP1 EXTRACT FIELDS TMP2.Ttl_PayAmt TMP2.PayCode ALL TO "Tmp_Files\TMP3" OPEN
~Input : Records:2681        Control Total:0                    
~Output: Records:2681        Control Total:0                    
~.19/02/2016   14:37:21 TMP3 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:2681        Control Total:0                    
~Output: Records:2681        Control Total:0                    
~.19/02/2016   14:37:22 TMP_Cur EXTRACT FIELDS Ttl_PayAmt PayCode RUNID_InPrd Ttl_SuperAmt COUNT Co_Emp_ID Co COST_CENTRE Emp_ID Period_Date PayCode_Amount Pay_Hrs LINE_NO LINE_DESC LINE_TYPE PAY_GROUP GL_Account_No PERIOD Standard_WeeklyHours PayCode_Desc Num_Field3 Num_Field4 Num_Field5 Prd_Dt Dt_Field2 Dt_Field3 ForPrd InPrd Cha_Field3 Cha_Field4 Cha_Field5 Year YM c_Prd_Dt ABS_PayCode_Amount PrdSalaryAmt ActPaidAmt PrdGrsAmt RUNID_ForPrd Trm_Prd_Days KEY Co_Emp_ID2 Co2 COST_CENTRE2 Emp_ID2 Period_Date2 PayCode2 PayCode_Amount2 Pay_Hrs2 LINE_NO2 LINE_DESC2 LINE_TYPE2 PAY_GROUP2 GL_Account_No2 PERIOD2 Standard_WeeklyHours2 PayCode_Desc2 Num_Field32 Num_Field42 Num_Field52 Prd_Dt2 Dt_Field22 Dt_Field32 ForPrd2 InPrd2 Cha_Field32 Cha_Field42 Cha_Field52 Year2 YM2 c_Prd_Dt2 ABS_PayCode_Amount2 PrdSalaryAmt2 ActPaidAmt2 PrdGrsAmt2 RUNID_ForPrd2 Trm_Prd_Days2 KEY2 Ttl_SuperPaidAmt SGC_Pct ID_KEY RptRunDate SORT_KEY SORT_KEY_Desc Priority Data_Range_Start_Date Data_Range_End_Date TEST_NAME IF ID_KEY<> PR006_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:2681        Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:37:22 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:37:22 TMP10 SORT ON SORT_KEY TO "Results\PR006_Unusual_Super"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^FORMAT   PR006D_Unusual_Super               PR006D_Unusual_Super             "Results" "PR006D_Unusual_Super.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.20160219     14:30:29 Payroll_details EXTRACT FIELDS WEEKLY_HOURS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:35:55 PAYROLL_DATA  IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' DEC(Pay_Hrs,2) AS 'Pay_Hrs' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' DEC(WEEKLY_HOURS,2) AS 'Standard_WeeklyHours' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE_DESC),1,15))) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' payroll_date AS 'Prd_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'ForPrd' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'InPrd' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\Payroll_Payments.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:37:22 Payroll_Payments SET FILTER FIND('Superannuation Voluntary',PayCode_Desc) OR NOT MATCH(PayCode_Desc,'Payroll Tax; PAYROLL TAX SOUTH AUST','Superannuation Voluntary;','Annual Leave; LEAVE LOADING')
~.19/02/2016   14:37:22 Payroll_Payments EXTRACT FIELDS ALL ALL TMP10.RptRunDate TMP10.Data_Range_Start_Date TMP10.Data_Range_End_Date  IF NOT ISBLANK(TMP10.RUNID_InPrd) AND ABS(PayCode_Amount) > 0.00 TO "Tmp_Files\TMP8" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:37:22 TMP8 SORT ON SORT_KEY D  TO "Results\PR006D_Unusual_Super"
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
^INDEX    IDX_PR007_History_ID_KEY           PR007_History                    "" "IDX_PR007_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_PR007_HISTORY_ID_KEY
^FORMAT   PR007_History                      PR007_History                    "History" "PR007_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.20160219     14:30:29 Payroll_details EXTRACT FIELDS WEEKLY_HOURS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:35:55 PAYROLL_DATA  IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' DEC(Pay_Hrs,2) AS 'Pay_Hrs' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' DEC(WEEKLY_HOURS,2) AS 'Standard_WeeklyHours' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE_DESC),1,15))) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' payroll_date AS 'Prd_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'ForPrd' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'InPrd' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\Payroll_Payments.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:37:23 Payroll_Payments EXTRACT FIELDS ALL ALL  IF NOT ISBLANK(TMP4.KEY) TO Tmp_Files\\TMP5 OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5714        Control Total:0                    
~.19/02/2016   14:37:23 TMP5 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:5714        Control Total:0                    
~Output: Records:5714        Control Total:0                    
~.19/02/2016   14:37:23 TMP_Cur IF FTYPE("PR007_History")<>"y" OR FILESIZE("History\PR007_History.fil") <0 EXTRACT FIELDS ALL FIRST 0 TO "History\PR007_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:37:24 TMP_Cur1 EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE Emp_ID Period_Date PayCode PayCode_Amount Pay_Hrs LINE_NO LINE_DESC LINE_TYPE PAY_GROUP GL_Account_No PERIOD Standard_WeeklyHours PayCode_Desc Num_Field3 Num_Field4 Num_Field5 Prd_Dt Dt_Field2 Dt_Field3 ForPrd InPrd Cha_Field3 Cha_Field4 Cha_Field5 Year YM c_Prd_Dt ABS_PayCode_Amount PrdSalaryAmt ActPaidAmt PrdGrsAmt RUNID_ForPrd RUNID_InPrd Trm_Prd_Days KEY Co_Emp_ID2 Co2 COST_CENTRE2 Emp_ID2 Period_Date2 PayCode2 PayCode_Amount2 Pay_Hrs2 LINE_NO2 LINE_DESC2 LINE_TYPE2 PAY_GROUP2 GL_Account_No2 PERIOD2 Standard_WeeklyHours2 PayCode_Desc2 Num_Field32 Num_Field42 Num_Field52 Prd_Dt2 Dt_Field22 Dt_Field32 ForPrd2 InPrd2 Cha_Field32 Cha_Field42 Cha_Field52 Year2 YM2 c_Prd_Dt2 ABS_PayCode_Amount2 PrdSalaryAmt2 ActPaidAmt2 PrdGrsAmt2 RUNID_ForPrd2 RUNID_InPrd2 Trm_Prd_Days2 KEY2 ID_KEY TO "History\PR007_History"APPEND
~Input : Records:5714        Control Total:0                    
~Output: Records:5714        Control Total:0                    
^FORMAT   PR007_Hourly_Emp                   PR007_Hourly_Emp                 "Results" "PR007_Hourly_Emp.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.20160219     14:30:29 Payroll_details EXTRACT FIELDS WEEKLY_HOURS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:35:55 PAYROLL_DATA  IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' DEC(Pay_Hrs,2) AS 'Pay_Hrs' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' DEC(WEEKLY_HOURS,2) AS 'Standard_WeeklyHours' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE_DESC),1,15))) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' payroll_date AS 'Prd_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'ForPrd' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'InPrd' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\Payroll_Payments.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:37:23 Payroll_Payments EXTRACT FIELDS ALL ALL  IF NOT ISBLANK(TMP4.KEY) TO Tmp_Files\\TMP5 OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5714        Control Total:0                    
~.19/02/2016   14:37:23 TMP5 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:5714        Control Total:0                    
~Output: Records:5714        Control Total:0                    
~.19/02/2016   14:37:24 TMP_Cur EXTRACT FIELDS Co_Emp_ID Co COST_CENTRE Emp_ID Period_Date PayCode PayCode_Amount Pay_Hrs LINE_NO LINE_DESC LINE_TYPE PAY_GROUP GL_Account_No PERIOD Standard_WeeklyHours PayCode_Desc Num_Field3 Num_Field4 Num_Field5 Prd_Dt Dt_Field2 Dt_Field3 ForPrd InPrd Cha_Field3 Cha_Field4 Cha_Field5 Year YM c_Prd_Dt ABS_PayCode_Amount PrdSalaryAmt ActPaidAmt PrdGrsAmt RUNID_ForPrd RUNID_InPrd Trm_Prd_Days KEY Co_Emp_ID2 Co2 COST_CENTRE2 Emp_ID2 Period_Date2 PayCode2 PayCode_Amount2 Pay_Hrs2 LINE_NO2 LINE_DESC2 LINE_TYPE2 PAY_GROUP2 GL_Account_No2 PERIOD2 Standard_WeeklyHours2 PayCode_Desc2 Num_Field32 Num_Field42 Num_Field52 Prd_Dt2 Dt_Field22 Dt_Field32 ForPrd2 InPrd2 Cha_Field32 Cha_Field42 Cha_Field52 Year2 YM2 c_Prd_Dt2 ABS_PayCode_Amount2 PrdSalaryAmt2 ActPaidAmt2 PrdGrsAmt2 RUNID_ForPrd2 RUNID_InPrd2 Trm_Prd_Days2 KEY2 ID_KEY IF ID_KEY<> PR007_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:5714        Control Total:0                    
~Output: Records:5714        Control Total:0                    
~.19/02/2016   14:37:24 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:5714        Control Total:0                    
~Output: Records:5714        Control Total:0                    
~.19/02/2016   14:37:24 TMP10 SORT ON SORT_KEY D TO "Results\PR007_Hourly_Emp"
~Input : Records:5714        Control Total:0                    
~Output: Records:5714        Control Total:0                    
^FORMAT   PR008_Top_50_Over_3_Mon            PR008_Top_50_Over_3_Mon          "Results" "PR008_Top_50_Over_3_Mon.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.20160219     14:30:29 Payroll_details EXTRACT FIELDS WEEKLY_HOURS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:35:55 PAYROLL_DATA  IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' DEC(Pay_Hrs,2) AS 'Pay_Hrs' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' DEC(WEEKLY_HOURS,2) AS 'Standard_WeeklyHours' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE_DESC),1,15))) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' payroll_date AS 'Prd_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'ForPrd' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'InPrd' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\Payroll_Payments.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:37:25 Payroll_Payments SET FILTER NOT FIND('Payroll Tax',PayCode_Desc) AND NOT FIND('Superannuation',PayCode_Desc) AND NOT FIND('Loading',PayCode_Desc)  AND NOT FIND('Payroll Tax',PayCode_Desc)
~.19/02/2016   14:37:25 Payroll_Payments EXTRACT FIELDS ALL ALL IF PayCode_Amount<>0 AND Prd_Dt >=CTOD(DATE(_PR_Data_Start_Date- VALUE(ALLTRIM(TXT_PR008_Months),0)*30,"DD/MM/YYYY")) TO "Tmp_Files\TMP1" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:37:25 TMP1 SUMMARIZE ON Co_Emp_ID COST_CENTRE SUBTOTAL PayCode_Amount Pay_Hrs TO "Tmp_Files\TMP2.FIL" OPEN PRESORT
~Input : Records:5801        Control Total:0                    
~Output: Records:227         Control Total:0                    
~.19/02/2016   14:37:25 TMP2 EXTRACT FIELDS ALL ALL IF PayCode_Amount>=HIGH1 TO "Tmp_Files\TMP3" OPEN
~Input : Records:227         Control Total:0                    
~Output: Records:50          Control Total:0                    
~.19/02/2016   14:37:25 TMP3 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:50          Control Total:0                    
~Output: Records:50          Control Total:0                    
~.19/02/2016   14:37:25 TMP10 SORT ON SORT_KEY D TO Results\PR008_Top_50_Over_3_Mon
~Input : Records:50          Control Total:0                    
~Output: Records:50          Control Total:0                    
^FORMAT   PR008D_Top_50_Over_3_Mon           PR008D_Top_50_Over_3_Mon         "Results" "PR008D_Top_50_Over_3_Mon.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.20160219     14:30:29 Payroll_details EXTRACT FIELDS WEEKLY_HOURS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:35:55 PAYROLL_DATA  IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' DEC(Pay_Hrs,2) AS 'Pay_Hrs' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' DEC(WEEKLY_HOURS,2) AS 'Standard_WeeklyHours' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE_DESC),1,15))) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' payroll_date AS 'Prd_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'ForPrd' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'InPrd' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\Payroll_Payments.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:37:25 Payroll_Payments SET FILTER NOT FIND('Payroll Tax',PayCode_Desc) AND NOT FIND('Superannuation',PayCode_Desc) AND NOT FIND('Loading',PayCode_Desc)  AND NOT FIND('Payroll Tax',PayCode_Desc)
~.19/02/2016   14:37:25 Payroll_Payments EXTRACT FIELDS ALL ALL IF PayCode_Amount<>0 AND Prd_Dt >=CTOD(DATE(_PR_Data_Start_Date- VALUE(ALLTRIM(TXT_PR008_Months),0)*30,"DD/MM/YYYY")) TO "Tmp_Files\TMP1" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:37:25 TMP1 EXTRACT FIELDS ALL  IF Co_Emp_ID=TMP3.Co_Emp_ID TO Tmp_Files\TMP4 OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:1301        Control Total:0                    
~.19/02/2016   14:37:25 TMP4 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:1301        Control Total:0                    
~Output: Records:1301        Control Total:0                    
~.19/02/2016   14:37:25 TMP10 SORT ON SORT_KEY D TO Results\PR008D_Top_50_Over_3_Mon OPEN
~Input : Records:1301        Control Total:0                    
~Output: Records:1301        Control Total:0                    
^INDEX    IDX_PR009_History_ID_KEY           PR009_History                    "" "IDX_PR009_History_ID_KEY.INX" 
*INDEX ON ID_KEY TO IDX_PR009_HISTORY_ID_KEY
^FORMAT   PR009_History                      PR009_History                    "History" "PR009_History.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1439254479
~.20160219     14:30:29 Payroll_details EXTRACT FIELDS WEEKLY_HOURS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:35:55 PAYROLL_DATA  IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' DEC(Pay_Hrs,2) AS 'Pay_Hrs' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' DEC(WEEKLY_HOURS,2) AS 'Standard_WeeklyHours' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE_DESC),1,15))) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' payroll_date AS 'Prd_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'ForPrd' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'InPrd' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\Payroll_Payments.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:37:26 Payroll_Payments SET FILTER NOT FIND('Payroll Tax',PayCode_Desc) AND NOT FIND('Superannuation',PayCode_Desc) AND NOT FIND('Loading',PayCode_Desc)   AND NOT MATCH(EMF_TMP_Emp.Emp_Catg,'full time','ONGOING','PERM') AND PayCode <> '71861' AND NOT FIND('Payroll Tax',PayCode_Desc)
~.19/02/2016   14:37:26 Payroll_Payments EXTRACT FIELDS ALL ALL IF PayCode_Amount<>0 TO "Tmp_Files\TMP1" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:37:26 TMP1 SUMMARIZE ON CO Co_Emp_ID Emp_ID c_Prd_Dt OTHER Prd_Dt SUBTOTAL PayCode_Amount Pay_Hrs TO "Tmp_Files\TMP2.FIL" OPEN PRESORT
~Input : Records:5801        Control Total:0                    
~Output: Records:5786        Control Total:0                    
~.19/02/2016   14:37:26 TMP2 SET FILTER TMP3.Avg_PayCode_Amount<>0
~.19/02/2016   14:37:26 TMP2 EXTRACT FIELDS ALL TMP3.Avg_PayCode_Amount TMP3.Avg_PayCode_Hours DEC(PayCode_Amount/TMP3.Avg_PayCode_Amount,0) AS 'TIMES' IF DEC(PayCode_Amount/TMP3.Avg_PayCode_Amount,0) >=VALUE(ALLTRIM(TXT_PR009_Times),0) TO Tmp_Files\TMP4 OPEN
~Input : Records:5786        Control Total:0                    
~Output: Records:27          Control Total:0                    
~.19/02/2016   14:37:26 TMP4 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:27          Control Total:0                    
~Output: Records:27          Control Total:0                    
~.19/02/2016   14:37:26 TMP_Cur IF FTYPE("PR009_History")<>"y" OR FILESIZE("History\PR009_History.fil") <0 EXTRACT FIELDS ALL FIRST 0 TO "History\PR009_History" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:37:26 TMP_Cur1 EXTRACT FIELDS Co Co_Emp_ID Emp_ID c_Prd_Dt PayCode_Amount Pay_Hrs COUNT Prd_Dt Avg_PayCode_Amount Avg_PayCode_Hours TIMES KEY ID_KEY TO "History\PR009_History"APPEND
~Input : Records:27          Control Total:0                    
~Output: Records:27          Control Total:0                    
^FORMAT   PR009D_Pay_2_Times_Avg             PR009D_Pay_2_Times_Avg           "Results" "PR009D_Pay_2_Times_Avg.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.20160219     14:30:29 Payroll_details EXTRACT FIELDS WEEKLY_HOURS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:35:55 PAYROLL_DATA  IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' DEC(Pay_Hrs,2) AS 'Pay_Hrs' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' DEC(WEEKLY_HOURS,2) AS 'Standard_WeeklyHours' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE_DESC),1,15))) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' payroll_date AS 'Prd_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'ForPrd' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'InPrd' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\Payroll_Payments.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:37:26 Payroll_Payments SET FILTER NOT FIND('Payroll Tax',PayCode_Desc) AND NOT FIND('Superannuation',PayCode_Desc) AND NOT FIND('Loading',PayCode_Desc)   AND NOT MATCH(EMF_TMP_Emp.Emp_Catg,'full time','ONGOING','PERM') AND PayCode <> '71861' AND NOT FIND('Payroll Tax',PayCode_Desc)
~.19/02/2016   14:37:26 Payroll_Payments EXTRACT FIELDS ALL ALL IF PayCode_Amount<>0 TO "Tmp_Files\TMP1" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:37:27 TMP1 EXTRACT FIELDS ALL   IF KEY=TMP5.KEY TO Tmp_Files\TMP6 OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:42          Control Total:0                    
~.19/02/2016   14:37:27 TMP6 SORT ON SORT_KEY D TO "Results\PR009D_Pay_2_Times_Avg"
~Input : Records:42          Control Total:0                    
~Output: Records:42          Control Total:0                    
^FORMAT   PR009_Pay_2_Times_Avg              PR009_Pay_2_Times_Avg            "Results" "PR009_Pay_2_Times_Avg.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.20160219     14:30:29 Payroll_details EXTRACT FIELDS WEEKLY_HOURS Pay_Hrs PER_YM V_PAY_CDE_DESC V_PAY_CDE pay_period Payroll.approved_by Payroll.approved_on Payroll.created_by Payroll.created_on employee_number gross_pay deducations net_pay Payroll.payroll_date TO "PAYROLL_DATA" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:35:55 PAYROLL_DATA  IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' payroll_date AS 'Period_Date' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE),1,7))) AS 'PayCode' DEC(gross_pay,2) AS 'PayCode_Amount' DEC(Pay_Hrs,2) AS 'Pay_Hrs' BLANKS(20) AS 'LINE_NO' BLANKS(60) AS 'LINE_DESC' BLANKS(20) AS 'LINE_TYPE' BLANKS(20) AS 'PAY_GROUP' BLANKS(20) AS 'GL_Account_No' BLANKS(20) AS 'PERIOD' DEC(WEEKLY_HOURS,2) AS 'Standard_WeeklyHours' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(V_PAY_CDE_DESC),1,15))) AS 'PayCode_Desc' 0.00 AS 'Num_Field3' 0.00 AS 'Num_Field4' 0.00 AS 'Num_Field5' payroll_date AS 'Prd_Dt' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field2' CTOD('', 'DD/MM/YYYY') AS 'Dt_Field3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'ForPrd' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(PER_YM),1,20))) AS 'InPrd' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\Payroll_Payments.FIL"
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:37:26 Payroll_Payments SET FILTER NOT FIND('Payroll Tax',PayCode_Desc) AND NOT FIND('Superannuation',PayCode_Desc) AND NOT FIND('Loading',PayCode_Desc)   AND NOT MATCH(EMF_TMP_Emp.Emp_Catg,'full time','ONGOING','PERM') AND PayCode <> '71861' AND NOT FIND('Payroll Tax',PayCode_Desc)
~.19/02/2016   14:37:26 Payroll_Payments EXTRACT FIELDS ALL ALL IF PayCode_Amount<>0 TO "Tmp_Files\TMP1" OPEN
~Input : Records:5801        Control Total:0                    
~Output: Records:5801        Control Total:0                    
~.19/02/2016   14:37:26 TMP1 SUMMARIZE ON CO Co_Emp_ID Emp_ID c_Prd_Dt OTHER Prd_Dt SUBTOTAL PayCode_Amount Pay_Hrs TO "Tmp_Files\TMP2.FIL" OPEN PRESORT
~Input : Records:5801        Control Total:0                    
~Output: Records:5786        Control Total:0                    
~.19/02/2016   14:37:26 TMP2 SET FILTER TMP3.Avg_PayCode_Amount<>0
~.19/02/2016   14:37:26 TMP2 EXTRACT FIELDS ALL TMP3.Avg_PayCode_Amount TMP3.Avg_PayCode_Hours DEC(PayCode_Amount/TMP3.Avg_PayCode_Amount,0) AS 'TIMES' IF DEC(PayCode_Amount/TMP3.Avg_PayCode_Amount,0) >=VALUE(ALLTRIM(TXT_PR009_Times),0) TO Tmp_Files\TMP4 OPEN
~Input : Records:5786        Control Total:0                    
~Output: Records:27          Control Total:0                    
~.19/02/2016   14:37:26 TMP4 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:27          Control Total:0                    
~Output: Records:27          Control Total:0                    
~.19/02/2016   14:37:26 TMP_Cur EXTRACT FIELDS Co Co_Emp_ID Emp_ID c_Prd_Dt PayCode_Amount Pay_Hrs COUNT Prd_Dt Avg_PayCode_Amount Avg_PayCode_Hours TIMES KEY ID_KEY IF ID_KEY<> PR009_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:27          Control Total:0                    
~Output: Records:27          Control Total:0                    
~.19/02/2016   14:37:26 TMP_Cur1 EXTRACT FIELDS ALL ALL TO Tmp_Files\TMP5 OPEN
~Input : Records:27          Control Total:0                    
~Output: Records:27          Control Total:0                    
~.19/02/2016   14:37:27 TMP5 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:27          Control Total:0                    
~Output: Records:27          Control Total:0                    
~.19/02/2016   14:37:27 TMP10 SORT ON SORT_KEY D TO "Results\PR009_Pay_2_Times_Avg"
~Input : Records:27          Control Total:0                    
~Output: Records:27          Control Total:0                    
^FORMAT   EM009_TFN_Invld_Frmt               EM009_TFN_Invld_Frmt             "Results" "EM009_TFN_Invld_Frmt.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:53 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:54 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:37:27 EMF_TMP_Emp EXTRACT ALL BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN c_Tax_Fle_Num IF Emp_Sts<>"I" AND LENGTH(ALLTRIM(c_Tax_Fle_Num))>1 AND (LENGTH(ALLTRIM(c_Tax_Fle_Num))<>9 OR Invalid_TFN="T" ) TO "Tmp_Files\TMP1" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:352         Control Total:0                    
~.19/02/2016   14:37:27 TMP1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:352         Control Total:0                    
~Output: Records:352         Control Total:0                    
~.19/02/2016   14:37:27 TMP10 SORT ON SORT_KEY D TO "Results\EM009_TFN_Invld_Frmt" OPEN
~Input : Records:352         Control Total:0                    
~Output: Records:352         Control Total:0                    
^REPORT   Default_View                       EM006_Mis_Details                D.T,
[SKIP] 0
[TLINES] 1
[RLINES] 1
[LINE] 1
EM006                PICTURE ""
[LINE] 1
Co_Emp_ID            WIDTH 11 PICTURE ""
[LINE] 1
Emp_ID               WIDTH 8 PICTURE ""
[LINE] 1
EM0062               WIDTH 9 PICTURE ""
[LINE] 1
COUNT                PICTURE ""
[LINE] 1
Co                   WIDTH 5 PICTURE ""
[LINE] 1
COST_CENTRE          WIDTH 13 PICTURE ""
[LINE] 1
EMP_Sts              WIDTH 9 PICTURE ""
[LINE] 1
Tax_Fle_Num          WIDTH 12 PICTURE ""
[LINE] 1
Tax_Scale            WIDTH 10 PICTURE ""
[LINE] 1
Title                WIDTH 6 PICTURE ""
[LINE] 1
Frst_Nme             WIDTH 10 PICTURE ""
[LINE] 1
Second_Given_Name    WIDTH 17 PICTURE ""
[LINE] 1
Sur_Nme              WIDTH 9 PICTURE ""
[LINE] 1
ADD1                 WIDTH 7 PICTURE ""
[LINE] 1
ADD2                 WIDTH 7 PICTURE ""
[LINE] 1
ADD3                 WIDTH 7 PICTURE ""
[LINE] 1
City                 WIDTH 6 PICTURE ""
[LINE] 1
State                WIDTH 7 PICTURE ""
[LINE] 1
Pcode                WIDTH 8 PICTURE ""
[LINE] 1
Cntry                WIDTH 7 PICTURE ""
[LINE] 1
TEL1                 WIDTH 7 PICTURE ""
[LINE] 1
TEL2                 WIDTH 7 PICTURE ""
[LINE] 1
TEL3                 WIDTH 7 PICTURE ""
[LINE] 1
Fax                  WIDTH 6 PICTURE ""
[LINE] 1
Email_Bus            WIDTH 10 PICTURE ""
[LINE] 1
Email_Privt          WIDTH 11 PICTURE ""
[LINE] 1
DOB                  WIDTH 6 PICTURE ""
[LINE] 1
Sex                  WIDTH 6 PICTURE ""
[LINE] 1
Hire_Dt              WIDTH 8 PICTURE ""
[LINE] 1
Trm_Dt               WIDTH 8 PICTURE ""
[LINE] 1
Term_Reason_Desc     WIDTH 16 PICTURE ""
[LINE] 1
Mrtl_Sts             WIDTH 9 PICTURE ""
[LINE] 1
Pref_Nme             WIDTH 10 PICTURE ""
[LINE] 1
Prev_Sur_Nme         WIDTH 13 PICTURE ""
[LINE] 1
PAY_CLASS_CODE       WIDTH 15 PICTURE ""
[LINE] 1
PAY_RATE             WIDTH 10 PICTURE ""
[LINE] 1
AVG_TRANS_RATE       WIDTH 16 PICTURE ""
[LINE] 1
YEARLY_SALARY        PICTURE ""
[LINE] 1
AUTOPAY_HOURS_DAYS   WIDTH 20 PICTURE ""
[LINE] 1
Emp_Catg             WIDTH 10 PICTURE ""
[LINE] 1
Created_Dt           WIDTH 11 PICTURE ""
[LINE] 1
Modf_Dt              WIDTH 9 PICTURE ""
[LINE] 1
Cha_Field1           WIDTH 11 PICTURE ""
[LINE] 1
Cha_Field2           WIDTH 11 PICTURE ""
[LINE] 1
Cha_Field3           WIDTH 11 PICTURE ""
[LINE] 1
Cha_Field4           WIDTH 11 PICTURE ""
[LINE] 1
Cha_Field5           WIDTH 11 PICTURE ""
[LINE] 1
Emp_Nme              WIDTH 10 PICTURE ""
[LINE] 1
c_Hire_Dt            WIDTH 10 PICTURE ""
[LINE] 1
BSB                  WIDTH 6 PICTURE ""
[LINE] 1
Bnk_Acc_Num          WIDTH 13 PICTURE ""
[LINE] 1
BSB_NAME             WIDTH 11 PICTURE ""
[LINE] 1
Bnk_Acc_Name         WIDTH 13 PICTURE ""
[LINE] 1
Total_PayAmt         WIDTH 13 PICTURE ""
[LINE] 1
Total_Pay_Num        WIDTH 14 PICTURE ""
[LINE] 1
c_Tax_Fle_Num        WIDTH 13 PICTURE ""
[LINE] 1
Invalid_TFN          WIDTH 11 PICTURE ""
[LINE] 1
c_Emp_Nme            WIDTH 11 PICTURE ""
[LINE] 1
c_Tel1               WIDTH 7 PICTURE ""
[LINE] 1
c_Tel2               WIDTH 7 PICTURE ""
[LINE] 1
c_Tel3               WIDTH 7 PICTURE ""
[LINE] 1
c_Fax                WIDTH 7 PICTURE ""
[LINE] 1
BSB2                 WIDTH 7 PICTURE ""
[LINE] 1
Bnk_Acc_Num2         WIDTH 14 PICTURE ""
[LINE] 1
Total_PayAmt2        WIDTH 13 PICTURE ""
[LINE] 1
Total_Pay_Num2       WIDTH 14 PICTURE ""
[LINE] 1
Invalid_TFN2         WIDTH 12 PICTURE ""
[LINE] 1
BSB3                 WIDTH 7 PICTURE ""
[LINE] 1
Bnk_Acc_Num3         WIDTH 14 PICTURE ""
[LINE] 1
Total_PayAmt3        WIDTH 13 PICTURE ""
[LINE] 1
Total_Pay_Num3       WIDTH 14 PICTURE ""
[LINE] 1
Invalid_TFN3         WIDTH 12 PICTURE ""
[LINE] 1
c_EM006              WIDTH 9 PICTURE ""
[LINE] 1
Test_Name            WIDTH 11 PICTURE ""
[LINE] 1
RptRunDate           WIDTH 11 PICTURE ""
[LINE] 1
BSB4                 WIDTH 7 PICTURE ""
[LINE] 1
Bnk_Acc_Num4         WIDTH 14 PICTURE ""
[LINE] 1
Total_PayAmt4        WIDTH 13 PICTURE ""
[LINE] 1
Total_Pay_Num4       WIDTH 14 PICTURE ""
[LINE] 1
Test_Name2           WIDTH 11 PICTURE ""
[LINE] 1
RptRunDate2          WIDTH 12 PICTURE ""
[LINE] 1
Invalid_TFN4         WIDTH 12 PICTURE ""
[LINE] 1
ID_KEY               WIDTH 8 PICTURE ""
[LINE] 1
SORT_KEY             WIDTH 10 PICTURE ""
[LINE] 1
SORT_KEY_Desc        WIDTH 14 PICTURE ""
[LINE] 1
Priority             WIDTH 8 PICTURE ""
^BATCH    New_Script4                        
[PARENT_FOLDER_ID] 1340167410
^FORMAT   EM006_Mis_Details                  EM006_Mis_Details                "Results" "EM006_Mis_Details.FIL" 0 ASCII 
[PARENT_FOLDER_ID] 1427252816
~.08/24/2015   11:12:14 Employees EXTRACT FIELDS employee_number first_name last_name ssn department position employee_type hire_date home_phone home_address1 home_city home_state home_zip hourly_rate salary created_by created_on updated_by updated_on approved_by approved_on                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               TO Employees_New
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:53 Employees IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Co_Emp_ID' BLANKS(20) AS 'Co' BLANKS(20) AS 'COST_CENTRE' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_type),1,1))) AS 'EMP_Sts' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(employee_number),1,20))) AS 'Emp_ID' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(ssn),1,20))) AS 'Tax_Fle_Num' BLANKS(9) AS 'Tax_Scale' BLANKS(5) AS 'Title' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(first_name),1,20))) AS 'Frst_Nme' BLANKS(20) AS 'Second_Given_Name' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(last_name),1,20))) AS 'Sur_Nme' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_address1),1,61))) AS 'ADD1' BLANKS(61) AS 'ADD2' BLANKS(61) AS 'ADD3' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_city),1,35))) AS 'City' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_state),1,29))) AS 'State' CLEAN(ALLTRIM(SUBSTR(ALLTRIM(home_zip),1,11))) AS 'Pcode' BLANKS(61) AS 'Cntry' BLANKS(21) AS 'TEL1' BLANKS(21) AS 'TEL2' BLANKS(21) AS 'TEL3' BLANKS(21) AS 'Fax' BLANKS(40) AS 'Email_Bus' BLANKS(36) AS 'Email_Privt' CTOD('', 'DD/MM/YYYY') AS 'DOB' BLANKS(3) AS 'Sex' hire_date AS 'Hire_Dt' CTOD('', 'DD/MM/YYYY') AS 'Trm_Dt' BLANKS(30) AS 'Term_Reason_Desc' BLANKS(14) AS 'Mrtl_Sts' BLANKS(22) AS 'Pref_Nme' BLANKS(16) AS 'Prev_Sur_Nme' BLANKS(14) AS 'PAY_CLASS_CODE' DEC(hourly_rate,4) AS 'PAY_RATE' 0.00 AS 'AVG_TRANS_RATE' 0.00 AS 'YEARLY_SALARY' BLANKS(15) AS 'AUTOPAY_HOURS_DAYS' BLANKS(40) AS 'Emp_Catg' created_on AS 'Created_Dt' updated_on AS 'Modf_Dt' BLANKS(20) AS 'Cha_Field1' BLANKS(20) AS 'Cha_Field2' BLANKS(20) AS 'Cha_Field3' BLANKS(20) AS 'Cha_Field4' BLANKS(20) AS 'Cha_Field5'   TO "Working_Files\EMF_Emp_Master_File.FIL"
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:35:54 EMF_Emp_Master_File IF FTYPE("EMF_BnkAcc")="y" AND FILESIZE("Working_Files\EMF_BnkAcc.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "Working_Files\EMF_TMP_Emp" OPEN
~Input : Records:592         Control Total:0                    
~Output: Records:592         Control Total:0                    
~.19/02/2016   14:36:06 EMF_TMP_Emp  EXTRACT 100000 AS "EM006" ALL BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN IF Emp_Sts="A" AND  LENGTH(ALLTRIM(c_Tel1))<6 AND LENGTH(ALLTRIM(c_Tel2))<6 AND LENGTH(ALLTRIM(c_Tel3))<6 AND LENGTH(ALLTRIM(c_Fax))<6 TO Tmp_Files\TMP1 FIRST 0
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:06 TMP1 SUMMARIZE ON Co_Emp_ID Emp_ID SUBTOTAL EM006 OTHER ALL BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Invalid_TFN TO "Tmp_Files\TMP2.FIL" OPEN PRESORT
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:06 TMP2 EXTRACT FIELDS c_EM006 AS "EM006" ALL BSB Bnk_Acc_Num Total_PayAmt Total_Pay_Num Test_Name RptRunDate Invalid_TFN TO "Tmp_Files\TMP3" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:07 TMP3 EXTRACT FIELDS ALL TO Tmp_Files\TMP_Cur OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:07 TMP_Cur EXTRACT FIELDS EM006 Co_Emp_ID Emp_ID EM0062 COUNT Co COST_CENTRE EMP_Sts Tax_Fle_Num Tax_Scale Title Frst_Nme Second_Given_Name Sur_Nme ADD1 ADD2 ADD3 City State Pcode Cntry TEL1 TEL2 TEL3 Fax Email_Bus Email_Privt DOB Sex Hire_Dt Trm_Dt Term_Reason_Desc Mrtl_Sts Pref_Nme Prev_Sur_Nme PAY_CLASS_CODE PAY_RATE AVG_TRANS_RATE YEARLY_SALARY AUTOPAY_HOURS_DAYS Emp_Catg Created_Dt Modf_Dt Cha_Field1 Cha_Field2 Cha_Field3 Cha_Field4 Cha_Field5 Emp_Nme c_Hire_Dt BSB Bnk_Acc_Num BSB_NAME Bnk_Acc_Name Total_PayAmt Total_Pay_Num c_Tax_Fle_Num Invalid_TFN c_Emp_Nme c_Tel1 c_Tel2 c_Tel3 c_Fax BSB2 Bnk_Acc_Num2 Total_PayAmt2 Total_Pay_Num2 Invalid_TFN2 BSB3 Bnk_Acc_Num3 Total_PayAmt3 Total_Pay_Num3 Invalid_TFN3 c_EM006 Test_Name RptRunDate BSB4 Bnk_Acc_Num4 Total_PayAmt4 Total_Pay_Num4 Test_Name2 RptRunDate2 Invalid_TFN4 ID_KEY IF ID_KEY<> EM006_History.ID_KEY TO Tmp_Files\TMP_Cur1 OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:07 TMP_Cur1 EXTRACT FIELDS ALL TO "Tmp_Files\TMP4" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:07 TMP4 EXTRACT FIELDS ALL TO "Tmp_Files\TMP10" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
~.19/02/2016   14:36:07 TMP10 SORT ON SORT_KEY D TO "Results\EM006_Mis_Details" OPEN
~Input : Records:0           Control Total:0                    
~Output: Records:0           Control Total:0                    
[LASTVIEW] "Default_View"
^BATCH    ___SATORI_EVA_VM                   RENT_FOLDER_ID] 0
[PARENT_FOLDER_ID] 0

COMMENT
VM ANALYTICS 
SET THEM TO TRUE OR FALSE TO RUN THE TEST
END

V_VM_ANALYTIC_501 = T
V_VM_ANALYTIC_502 = T
V_VM_ANALYTIC_503 = T
V_VM_ANALYTIC_504 = T
V_VM_ANALYTIC_505 = T
V_VM_ANALYTIC_506 = T
V_VM_ANALYTIC_507 = T
V_VM_ANALYTIC_508 = T
V_VM_ANALYTIC_509 = T
V_VM_ANALYTIC_510 = T

^BATCH    ___SATORI_EVA_PR                   RENT_FOLDER_ID] 0
[PARENT_FOLDER_ID] 0


COMMENT
PR ANALYTICS 
SET THEM TO TRUE OR FALSE TO RUN THE TEST
END

V_PR_ANALYTIC_501 = T
V_PR_ANALYTIC_502 = T
V_PR_ANALYTIC_503 = T
V_PR_ANALYTIC_504 = T
V_PR_ANALYTIC_505 = T
V_PR_ANALYTIC_506 = T
V_PR_ANALYTIC_507 = T
V_PR_ANALYTIC_508 = T
V_PR_ANALYTIC_509 = T
V_PR_ANALYTIC_510 = T


^BATCH    ___SATORI_EVA_AP                   RENT_FOLDER_ID] 0
[PARENT_FOLDER_ID] 0


COMMENT
AP ANALYTICS 
SET THEM TO TRUE OR FALSE TO RUN THE TEST
END

V_AP_ANALYTIC_501 = T
V_AP_ANALYTIC_502 = T
V_AP_ANALYTIC_503 = T
V_AP_ANALYTIC_504 = T
V_AP_ANALYTIC_505 = T
V_AP_ANALYTIC_506 = T
V_AP_ANALYTIC_507 = T
V_AP_ANALYTIC_508 = T
V_AP_ANALYTIC_509 = T
V_AP_ANALYTIC_510 = T

^BATCH    LE003_Imp_Mapping                  
[PARENT_FOLDER_ID] 1430796705
COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Load the data mapping information from Excel file - generate the relationship between Target Fields and Source Fields for the Standard Tables
COMM *** User can set the mapping in the excel file- DataMapping\DataMapping.xlsx
COMM *** IF source data is from popular ERP systems, then EVA will use the Default Mapping (e.g. SAP, ORACLE, PeopleSoft, JDE...). What you need to do just replace this excel file with the respective mapping.
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 5/07/2012
COMM***************************************************************************


SET SAFETY OFF

IF FTYPE("fld_DataMapping")="U" DO AA002_Variable_Setting

SET FOLDER /%fld_DataMapping%

IF FTYPE("LE_Excel_Add")="U" LE_Excel_Add="%fld_DataMapping%DataMapping.xlsx"
IF LE_Excel_Add="" LE_Excel_Add="%fld_DataMapping%DataMapping.xlsx"

IMPORT EXCEL TO DM_AP_Invoices "%fld_DataMapping%DM_AP_Invoices.fil" FROM "%LE_Excel_Add%" TABLE "AP_Invoices$" CHARMAX 50 KEEPTITLE
IMPORT EXCEL TO DM_AP_Payments "%fld_DataMapping%DM_AP_Payments.fil" FROM "%LE_Excel_Add%" TABLE "AP_Payments$" CHARMAX 50 KEEPTITLE
IMPORT EXCEL TO DM_AP_PO_Lines "%fld_DataMapping%DM_AP_PO_Lines.fil" FROM "%LE_Excel_Add%" TABLE "PO_Lines$" CHARMAX 50 KEEPTITLE
IMPORT EXCEL TO DM_AP_InvPO "%fld_DataMapping%DM_AP_InvPO.fil" FROM "%LE_Excel_Add%" TABLE "AP_InvPO$" CHARMAX 50 KEEPTITLE


IMPORT EXCEL TO DM_VMF_Vnd_Master_File "%fld_DataMapping%DM_VMF_Vnd_Master_File.fil" FROM "%LE_Excel_Add%" TABLE "VMF_Vnd_Master_File$" CHARMAX 50 KEEPTITLE
IMPORT EXCEL TO DM_VMF_Address "%fld_DataMapping%DM_VMF_Address.fil" FROM "%LE_Excel_Add%" TABLE "VMF_Address$" CHARMAX 50 KEEPTITLE
IMPORT EXCEL TO DM_VMF_BnkAcc "%fld_DataMapping%DM_VMF_BnkAcc.fil" FROM "%LE_Excel_Add%" TABLE "VMF_BnkAcc$" CHARMAX 50 KEEPTITLE
IMPORT EXCEL TO DM_VMF_InterCompany "%fld_DataMapping%DM_VMF_InterCompany.fil" FROM "%LE_Excel_Add%" TABLE "VMF_InterCompany$" CHARMAX 50 KEEPTITLE
IMPORT EXCEL TO DM_VMF_Vnd_OneTime "%fld_DataMapping%DM_VMF_Vnd_OneTime.fil" FROM "%LE_Excel_Add%" TABLE "VMF_Vnd_One_Time$" CHARMAX 50 KEEPTITLE

IMPORT EXCEL TO DM_Payroll_Payments "%fld_DataMapping%DM_Payroll_Payments.fil" FROM "%LE_Excel_Add%" TABLE "Payroll_Payments$" CHARMAX 50 KEEPTITLE
IMPORT EXCEL TO DM_EMF_Emp_Master_File "%fld_DataMapping%DM_EMF_Emp_Master_File.fil" FROM "%LE_Excel_Add%" TABLE "EMF_Emp_Master_File$" CHARMAX 50 KEEPTITLE
IMPORT EXCEL TO DM_EMF_BnkAcc "%fld_DataMapping%DM_EMF_BnkAcc.fil" FROM "%LE_Excel_Add%" TABLE "EMF_BnkAcc$" CHARMAX 50 KEEPTITLE
IMPORT EXCEL TO DM_EMF_Leaves "%fld_DataMapping%DM_EMF_Leaves.fil" FROM "%LE_Excel_Add%" TABLE "EMF_Leaves$" CHARMAX 50 KEEPTITLE

COMM IF DM_Flag=T PAUSE "Data Mapping Tables have been imported successfully. You can convert the data into standard tables now."

DM_Flag=T
SET FOLDER /%fld_Tmps%

SET SAFETY ON
^LOGFILE  SATORI_EVA_50                       "" "SATORI_EVA_50.LOG"
[PARENT_FOLDER_ID] 0
^BATCH    ____SATORI_EVA_START_HERE          
[PARENT_FOLDER_ID] 0
SET SAFETY OFF
SET DATE "YYYYMMDD"
CLOSE PRI SECOND

COMMENT
SET UP SYSTEM PATH VARIABLES
END

DELETE LOG OK

DELETE SCRIPT EVA_PATH OK
DO "C:\WINDOWS\SATORI\EVA_PATH.TXT"
DELETE SCRIPT EVA_PATH OK

SET SYSTEM 39 1
DELETE FOLDER /z_WORKING_DATA OK
SET SYSTEM 39 0


COMMENT
SET AN EVA MODULE TO RUN
END

V_AP_ANALYSIS = F
V_VM_ANALYSIS = F
V_HR_ANALYSIS = T
V_PR_ANALYSIS = F


COMMENT
CALL YOU DATA PREPARATION SCRIPTS HERE TO CREATE 
EVA STANDARDISED TABLE FOR ANALYSIS
END

COMM DO HR_DATA_PREP

COMMENT
DO NOT CHANGE CODE BELOW
END

IF V_AP_ANALYSIS = T DO "___SATORI_EVA_AP"
IF V_HR_ANALYSIS = T DO "___SATORI_EVA_HR"
IF V_PR_ANALYSIS = T DO "___SATORI_EVA_PR"
IF V_VM_ANALYSIS = T DO "___SATORI_EVA_VM"


^BATCH    ___SATORI_EVA_HR                   RENT_FOLDER_ID] 0
[PARENT_FOLDER_ID] 0


COMMENT
HR ANALYTICS 
SET THEM TO TRUE OR FALSE TO RUN THE TEST
END

V_EVA_MODULE = "HR"


V_HR_ANALYTIC_501 = T
V_HR_ANALYTIC_502 = T
V_HR_ANALYTIC_503 = T
V_HR_ANALYTIC_504 = T
V_HR_ANALYTIC_505 = T
V_HR_ANALYTIC_506 = T
V_HR_ANALYTIC_507 = T
V_HR_ANALYTIC_508 = T
V_HR_ANALYTIC_509 = T
V_HR_ANALYTIC_510 = T
























DELETE SCRIPT HR_SCR_ROUTE OK
SET FOLDER /z_WORKING_DATA/

DO "%V_EVA_PATH%\%V_EVA_MODULE%\%V_EVA_MODULE%_SCR_ROUTE.txt"
^FOLDER   z_WORKING_DATA                      1457988117
[PARENT_FOLDER_ID] 0
^BATCH    HR_SCR_ROUTE                   
[PARENT_FOLDER_ID] 1457988117

DELETE SCRIPT HR_SCR_ROUTE OK

SET FOLDER /z_WORKING_DATA

COMM
THIS CREATES A TEMP WINDOWS FOLDER FOR WORKING / TEMP FILES CREATED DURING THE ANALYSIS
END


CLOSE 
DELETE "%V_EVA_PATH%\SYSTEM\CREATE_%V_EVA_MODULE%_TMP_DIR.BAT" OK

DIR "%V_EVA_PATH%\*.*" TO TEMP SUB

OPEN TEMP
 EXPORT 'RMDIR "%V_EVA_PATH%\TEMP\%V_EVA_MODULE%_WORKING_DATA"  /s /q' TO "%V_EVA_PATH%\SYSTEM\CREATE_%V_EVA_MODULE%_TMP_DIR.BAT" FIRST 1
 EXPORT 'MD "%V_EVA_PATH%\TEMP\%V_EVA_MODULE%_WORKING_DATA"' TO "%V_EVA_PATH%\SYSTEM\CREATE_%V_EVA_MODULE%_TMP_DIR.BAT" FIRST 1 APPEND

CLOSE PRI SECOND

  EXECUTE 'CMD /C "%V_EVA_PATH%\SYSTEM\CREATE_%V_EVA_MODULE%_TMP_DIR.BAT"'

V_WINDOWS_WRK_PATH = "%V_EVA_PATH%\TEMP\%V_EVA_MODULE%_WORKING_DATA"

CLOSE PRI SECOND
SET SYSTEM 39 1
DELETE FORMAT TEMP OK
SET SYSTEM 39 0
DELETE "%V_EVA_PATH%\SYSTEM\CREATE_%V_EVA_MODULE%_TMP_DIR.BAT" OK

COMM
IMPORT THE EXCEL DATA MAPPING
END

SET FOLDER /z_WORKING_DATA

DELETE SCRIPT %V_EVA_MODULE%_MAP OK
DO "%V_EVA_PATH%\%V_EVA_MODULE%\%V_EVA_MODULE%_00_MAPPING\%V_EVA_MODULE%_MAP.txt"
DELETE SCRIPT %V_EVA_MODULE%_MAP OK

SET FOLDER /z_WORKING_DATA

DELETE SCRIPT MZ001_CONVERT OK
DELETE SCRIPT MZ002_Convert_Sub OK

DO "%V_EVA_PATH%\SYSTEM\MZ001_CONVERT.txt"

DELETE SCRIPT MZ001_CONVERT OK
DELETE SCRIPT MZ002_Convert_Sub OK


^FOLDER   DATA_MAP_IMPORT                     1457988118
[PARENT_FOLDER_ID] 1457988117
^FORMAT   DM_Payroll_Payments                DM_Payroll_Payments              "C:\SATORI\EVA\TEMP\HR_WORKING_DATA" "DM_Payroll_Payments.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1457988118
[RETRIEVE] 0
[REFRESH] EXCEL "C:\SATORI\EVA\TEMP\HR_WORKING_DATA\DM_Payroll_Payments.fil" FROM "DATA_MAPPING\DataMapping.xlsx" TABLE "Payroll_Payments$" KEEPTITLE
^FORMAT   DM_EMF_Emp_Master_File             DM_EMF_Emp_Master_File           "C:\SATORI\EVA\TEMP\HR_WORKING_DATA" "DM_EMF_Emp_Master_File.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1457988118
[RETRIEVE] 0
[REFRESH] EXCEL "C:\SATORI\EVA\TEMP\HR_WORKING_DATA\DM_EMF_Emp_Master_File.fil" FROM "DATA_MAPPING\DataMapping.xlsx" TABLE "EMF_Emp_Master_File$" KEEPTITLE
^FORMAT   DM_EMF_BnkAcc                      DM_EMF_BnkAcc                    "C:\SATORI\EVA\TEMP\HR_WORKING_DATA" "DM_EMF_BnkAcc.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1457988118
[RETRIEVE] 0
[REFRESH] EXCEL "C:\SATORI\EVA\TEMP\HR_WORKING_DATA\DM_EMF_BnkAcc.fil" FROM "DATA_MAPPING\DataMapping.xlsx" TABLE "EMF_BANKACC$" KEEPTITLE
^FORMAT   DM_EMF_Leaves                      DM_EMF_Leaves                    "C:\SATORI\EVA\TEMP\HR_WORKING_DATA" "DM_EMF_Leaves.fil" 0 ASCII 
[PARENT_FOLDER_ID] 1457988118
[RETRIEVE] 0
[REFRESH] EXCEL "C:\SATORI\EVA\TEMP\HR_WORKING_DATA\DM_EMF_Leaves.fil" FROM "DATA_MAPPING\DataMapping.xlsx" TABLE "EMF_Leaves$" KEEPTITLE
^BATCH    MZ001_CONVERT                  
[PARENT_FOLDER_ID] 1457988117
DELETE SCRIPT MZ001_CONVERT OK

COMM***************************************************************************
COMM *** SATORI EVA ACL APPLICATION
COMM *** Convert Source Data To Target Working File Tables: Employee Master File
COMM *** CREATED BY: NANCY LI FROM SATORI GROUP 0431 057 135
COMM *** DATE: 22/06/2012
COMM***************************************************************************


SET FOLDER /z_WORKING_DATA

COMM *** convert Employee master file ***

COMM *** Capture the linkage relationships for the data mapping, convert the source data into target standard table ***
OPEN DM_%trg_EMF%

COMM *** Extract the mapping information from the mapping file (e.g. DM_VMF_Vnd_Master_File)***
src_File_Name=BLANKS(1000)
v_Flds_Extract=BLANKS(2000)

v_COUNT=0
v_Flds_Type=BLANKS(10)

COUNT

SET FOLDER /z_WORKING_DATA/LOOP_SCR

v_counter=1
DO "%V_EVA_PATH%\SYSTEM\MZ002_Convert_Sub.txt" WHILE v_counter<=COUNT1

DELETE FOLDER /z_WORKING_DATA/LOOP_SCR OK

COMM *** IF relationship between source table and target table has not been build, need to build the relationship first, goto the menu "Link fields/Mapping" ***
%v_CCMJob% IF src_File_Name="" OR v_COUNT=0 OR v_Flds_Extract="" PAUSE "There is no data mapping information - Employee Master File, please link/map the source fields to the standard fields first."
IF src_File_Name="" OR v_COUNT=0 OR v_Flds_Extract="" DO LE001_Link_Menu

COMM *** IF relationship between source table and target table has been build, convert data directely. ***

IF src_File_Name<>"" AND v_Flds_Extract<>""  OPEN %src_File_Name%
IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS %v_Flds_Extract%  TO "%fld_Workings%%trg_EMF%.FIL"

%v_CCMJob% IF FILESIZE("%fld_Workings%%trg_EMF%.fil")<=0 PAUSE "Employee Master File Table has not been convert properly. Please check the fields mapping and convert it again."
IF FILESIZE("%fld_Workings%%trg_EMF%.fil")<=0 ESCAPE

COMM *** convert Employee Bank Accounts***
OPEN DM_%trg_EMF_BK%
DO MZ001_Convert
IF src_File_Name<>"" AND v_Flds_Extract<>""  OPEN %src_File_Name%
IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS %v_Flds_Extract% TO "%fld_Workings%%trg_EMF_BK%_Tmp.FIL" OPEN

EXTRACT FIELDS ALL IF INCLUDE(Bnk_Acc_Num,"0123456789") <>"" TO "%fld_Workings%%trg_EMF_BK%.FIL" 

COMM *** convert Employee Leaves***
v_cmtLv=""
%v_cmtLv% IF FTYPE("DM_%trg_EMF_Lv%")="U" v_cmtLv="COMMENT"
%v_cmtLv% OPEN DM_%trg_EMF_Lv%
%v_cmtLv% DO MZ001_Convert
%v_cmtLv% IF src_File_Name<>"" AND v_Flds_Extract<>""  OPEN %src_File_Name%
%v_cmtLv% IF src_File_Name<>"" AND v_Flds_Extract<>"" EXTRACT FIELDS %v_Flds_Extract% TO "%fld_Workings%%trg_EMF_Lv%.FIL" OPEN

COMM *** prepare Employee master file ***

OPEN %trg_EMF%
INDEX ON Co_Emp_ID TO IDX_Co_Emp_ID

DELETE FIELD Emp_Nme OK
DEFINE FIELD Emp_Nme COMPUTED SUBSTR(PROPER(ALLTRIM(Sur_Nme))+" " + ALLTRIM(UPPER(Second_Given_Name)) +" "+ PROPER(ALLTRIM(Frst_Nme)),1,65) 
 
DELETE FIELD c_Hire_Dt OK 
DEFINE FIELD c_Hire_Dt COMPUTED ALLTRIM(SUBSTR(DATE(Hire_Dt),7,4))+ALLTRIM(SUBSTR(DATE(Hire_Dt),4,2))+ALLTRIM(SUBSTR(DATE(Hire_Dt),1,2))

COMM *** Create relations between tables ***
IF FTYPE("%trg_EMF_BK%")="y" AND FILESIZE("%fld_Workings%%trg_EMF_BK%.fil") >= 0 OPEN %trg_EMF_BK%
IF FTYPE("%trg_EMF_BK%")="y" AND FILESIZE("%fld_Workings%%trg_EMF_BK%.fil") >= 0 DEFINE RELATION Co_Emp_ID WITH %trg_EMF% INDEX IDX_Co_Emp_ID
IF FTYPE("%trg_EMF_BK%")="y" AND FILESIZE("%fld_Workings%%trg_EMF_BK%.fil") >= 0 INDEX ON Co_Emp_ID TO IDX_Emp_BK_Co_Emp_ID

%v_cmtLv% OPEN %trg_EMF_Lv%
%v_cmtLv% DEFINE RELATION Co_Emp_ID WITH %trg_EMF% INDEX IDX_Co_Emp_ID

OPEN %trg_EMF%
IF FTYPE("%trg_EMF_BK%")="y" AND FILESIZE("%fld_Workings%%trg_EMF_BK%.fil") >= 0 DEFINE RELATION Co_Emp_ID WITH %trg_EMF_BK% INDEX IDX_Emp_BK_Co_Emp_ID
IF FTYPE("%trg_EMF_BK%")="y" AND FILESIZE("%fld_Workings%%trg_EMF_BK%.fil") >= 0 EXTRACT FIELDS ALL EMF_BnkAcc.BSB EMF_BnkAcc.Bnk_Acc_Num EMF_BnkAcc.BSB_Name EMF_BnkAcc.Bnk_Acc_Name TO "%fld_Workings%EMF_TMP_Emp" OPEN
 

INDEX ON Co_Emp_ID TO IDX_EMF_Co_Emp_ID

DELETE FIELD c_Tax_Fle_Num OK
DEFINE FIELD c_Tax_Fle_Num COMPUTED ALLTRIM(INCLUDE(Tax_Fle_Num, "0123456789"))

DELETE FIELD Invalid_TFN OK
DEFINE FIELD Invalid_TFN COMPUTED

"F" IF MOD( (((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 1 , 1 ),0)*1)) + ((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 2 , 1 ),0)*4)) + ((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 3 , 1 ),0)*3)) + ((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 4 , 1 ),0)*7)) + ((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 5 , 1 ),0)*5)) + ((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 6 , 1 ),0)*8)) + ((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 7 , 1 ),0)*6)) + ((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 8 , 1 ),0)*9)) + ((Value(SUBSTR( ALLTRIM(c_Tax_Fle_Num) , 9 , 1 ),0)*10))) , 11 ) = 0
"F" IF c_Tax_Fle_Num = "111111111"
"T"

IF FTYPE("Payroll_Sum_12m")="y" AND FILESIZE("%fld_Workings%Payroll_Sum_12m.fil") >= 0 OPEN EMF_TMP_Emp
IF FTYPE("Payroll_Sum_12m")="y" AND FILESIZE("%fld_Workings%Payroll_Sum_12m.fil") >= 0 DEFINE RELATION Co_Emp_ID WITH Payroll_Sum_12m INDEX IDX_Payroll_Sum_ID

IF FTYPE("Payroll_Sum_12m")="y" AND FILESIZE("%fld_Workings%Payroll_Sum_12m.fil") >= 0 OPEN EMF_TMP_Emp
IF FTYPE("Payroll_Sum_12m")="y" AND FILESIZE("%fld_Workings%Payroll_Sum_12m.fil") >= 0 DELETE FIELD Total_PayAmt OK
IF FTYPE("Payroll_Sum_12m")="y" AND FILESIZE("%fld_Workings%Payroll_Sum_12m.fil") >= 0 DEFINE FIELD Total_PayAmt COMPUTED Payroll_Sum_12m.ActPaidAmt
IF FTYPE("Payroll_Sum_12m")="y" AND FILESIZE("%fld_Workings%Payroll_Sum_12m.fil") >= 0 DELETE FIELD Total_Pay_Num OK
IF FTYPE("Payroll_Sum_12m")="y" AND FILESIZE("%fld_Workings%Payroll_Sum_12m.fil") >= 0 DEFINE FIELD Total_Pay_Num COMPUTED Payroll_Sum_12m.COUNT


COMMENT
SR ERR:
CREATED THIS FIELD
END


DELETE Standard_WeeklyHours OK
 DEFINE FIELD Standard_WeeklyHours COMPUTED 40






COMMENT
SR ADDED ERROR TRAP IF 12 MONTHS PAY DOES NOT EXISTS, TO CREATE THE FIELDS AND ZERO IT...
END

COMM
IF FTYPE("Payroll_Sum_12m")="U"  OPEN EMF_TMP_Emp
IF FTYPE("Payroll_Sum_12m")="U"  DELETE FIELD Total_PayAmt OK
IF FTYPE("Payroll_Sum_12m")="U"  DEFINE FIELD Total_PayAmt COMPUTED 0
IF FTYPE("Payroll_Sum_12m")="U"  DELETE FIELD Total_Pay_Num OK
IF FTYPE("Payroll_Sum_12m")="U"  DEFINE FIELD Total_Pay_Num COMPUTED 0
END
 
COMM *** BEGIN Save all EMF Bank Account changes into EMF_BnkAcc_Chg_History ***
IF FTYPE("%trg_EMF_BK%")="y" AND FTYPE("%trg_EMF_BK%_Tmp")="y" DO MZ005_EmpBk_Chg_His

COMM *** END Save all historical changes into VMF_Chg_History ***

IF FTYPE("%trg_EMF_BK%_Tmp")="y" DELETE FORMAT %trg_EMF_BK%_Tmp OK
IF FTYPE("%trg_EMF_BK%_Tmp")="y" DELETE "%fld_Workings%%trg_EMF_BK%_Tmp.FIL" OK

SET SAFETY ON
^OPEN 
^VARIABLE _Version "SATORI EVA V5.0"
^VARIABLE _FiscalYM "02/2016"
^VARIABLE _FiscalYear "2016"
^VARIABLE _CurrentDate `20160301`
^VARIABLE _PR_Data_End_Date `20160315`
^VARIABLE _PR_Data_Start_Date `20150316`
^VARIABLE _Data_Range_End_Date `20160315`
^VARIABLE _Data_Range_Start_Date `20140316`
^VARIABLE _Year "2016"
^VARIABLE _Last_Week "08/03/2016  "
^VARIABLE _Last_6Month "17/09/2015  "
^VARIABLE _Last_Month "14/02/2016  "
^VARIABLE _LastYearTranDt `20150316`
^VARIABLE _LastYearTranCha "16/03/2015  "
^VARIABLE _Last2YearTranDt `20140316`
^VARIABLE _Last2YearTranCha "16/03/2014  "
^VARIABLE _RptRunDateTime "15/03/2016 07:23:50"
^VARIABLE _RptRunDate `20160315`
